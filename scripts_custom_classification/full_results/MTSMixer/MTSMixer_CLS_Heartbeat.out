Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.679992198944092
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.2549331188201904
Epoch: 2, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
Validation loss decreased (-0.721945 --> -0.775605).  Saving model ...
Epoch: 3 cost time: 3.364997386932373
Epoch: 3, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.528 Vali Acc: 0.756 Test Loss: 0.528 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0964455604553223
Epoch: 4, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.545 Vali Acc: 0.717 Test Loss: 0.545 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.356046438217163
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2402448654174805
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.38116192817688
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.357626438140869
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.741 Test Loss: 0.640 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.429574489593506
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.499833583831787
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.737 Test Loss: 0.673 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0434563159942627
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.741466999053955
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.741 Test Loss: 0.683 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1821910
model size : 7.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.252634286880493
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.0063438415527344
Epoch: 2, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.499 Vali Acc: 0.746 Test Loss: 0.499 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.861389636993408
Epoch: 3, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.499 Vali Acc: 0.732 Test Loss: 0.499 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.404855728149414
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.546 Vali Acc: 0.771 Test Loss: 0.546 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 5 cost time: 3.371181011199951
Epoch: 5, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.534 Vali Acc: 0.727 Test Loss: 0.534 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.426976203918457
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.766 Test Loss: 0.618 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.460057258605957
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2248315811157227
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3377740383148193
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.214386224746704
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5875699520111084
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.732 Test Loss: 0.666 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2079672813415527
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.005080461502075
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.732 Test Loss: 0.677 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0347647666931152
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1801430
model size : 7.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.140434265136719
Epoch: 1, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.725874423980713
Epoch: 2, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.540 Vali Acc: 0.707 Test Loss: 0.540 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6480424404144287
Epoch: 3, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.511 Vali Acc: 0.737 Test Loss: 0.511 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.235504150390625
Epoch: 4, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.744860887527466
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.679 Vali Acc: 0.717 Test Loss: 0.679 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.94742751121521
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.691279888153076
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.717 Test Loss: 0.645 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0760934352874756
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.727 Test Loss: 0.652 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3850176334381104
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.741 Test Loss: 0.646 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 10 cost time: 2.733259916305542
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.732 Test Loss: 0.670 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.366694450378418
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.732 Test Loss: 0.678 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4838528633117676
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.741 Test Loss: 0.686 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6342949867248535
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.716683864593506
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.737 Test Loss: 0.698 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.625610828399658
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.732 Test Loss: 0.718 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6258060932159424
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.737 Test Loss: 0.711 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6536645889282227
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.248067617416382
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.732 Test Loss: 0.732 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.708033800125122
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.732 Test Loss: 0.727 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1780950
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.800903558731079
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.409757137298584
Epoch: 2, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.8631346225738525
Epoch: 3, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.527 Vali Acc: 0.732 Test Loss: 0.527 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8736834526062012
Epoch: 4, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8966329097747803
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.930640697479248
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6621026992797852
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.741 Test Loss: 0.690 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.917382001876831
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.732 Test Loss: 0.721 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8813390731811523
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.767 Vali Acc: 0.746 Test Loss: 0.767 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.770937204360962
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.751 Test Loss: 0.750 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9352240562438965
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8684067726135254
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.746 Test Loss: 0.783 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1760470
model size : 6.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0533154010772705
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.611618995666504
Epoch: 2, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.5016961097717285
Epoch: 3, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.4907605648040771
Epoch: 4, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.3278298377990723
Epoch: 5, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3832530975341797
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.741 Test Loss: 0.636 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 1.4251742362976074
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6327846050262451
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.737 Test Loss: 0.663 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.541355848312378
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.727 Test Loss: 0.711 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4658753871917725
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.612450361251831
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.727 Test Loss: 0.708 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6553609371185303
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.732 Test Loss: 0.730 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3963069915771484
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.727 Test Loss: 0.715 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.932981014251709
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.727 Test Loss: 0.730 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8470516204833984
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.727 Test Loss: 0.742 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8619542121887207
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.727 Test Loss: 0.746 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1744086
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3227174282073975
Epoch: 1, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.591 Vali Acc: 0.712 Test Loss: 0.591 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.6914036273956299
Epoch: 2, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
Validation loss decreased (-0.712189 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.5638477802276611
Epoch: 3, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8514070510864258
Epoch: 4, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.619 Vali Acc: 0.732 Test Loss: 0.619 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.413912057876587
Epoch: 5, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.579 Vali Acc: 0.707 Test Loss: 0.579 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5358607769012451
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.694 Vali Acc: 0.746 Test Loss: 0.694 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 1.31178617477417
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5126924514770508
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.741 Test Loss: 0.644 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5396578311920166
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.737 Test Loss: 0.698 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.54600191116333
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.737 Test Loss: 0.716 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.339005947113037
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.737 Test Loss: 0.708 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4585065841674805
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.741 Test Loss: 0.710 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3393909931182861
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.737 Test Loss: 0.731 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2257039546966553
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.737 Test Loss: 0.734 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3698770999908447
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3285999298095703
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.746 Test Loss: 0.742 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1735894
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1892261505126953
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.2175536155700684
Epoch: 2, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.508 Vali Acc: 0.756 Test Loss: 0.508 Test Acc: 0.756
Validation loss decreased (-0.726823 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.1231224536895752
Epoch: 3, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.516 Vali Acc: 0.732 Test Loss: 0.516 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2383513450622559
Epoch: 4, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.111384391784668
Epoch: 5, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1965742111206055
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.751 Test Loss: 0.636 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.248814582824707
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.766 Test Loss: 0.686 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 8 cost time: 1.2067170143127441
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.751 Test Loss: 0.647 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1032931804656982
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.059157371520996
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.570673942565918
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0938093662261963
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1195225715637207
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.761 Test Loss: 0.743 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4278523921966553
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4005186557769775
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.766 Test Loss: 0.751 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4548323154449463
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.761 Test Loss: 0.771 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2392077445983887
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1727702
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0329456329345703
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.598 Vali Acc: 0.712 Test Loss: 0.598 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0662014484405518
Epoch: 2, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 0.9763572216033936
Epoch: 3, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.546 Vali Acc: 0.683 Test Loss: 0.546 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1094434261322021
Epoch: 4, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.577 Vali Acc: 0.707 Test Loss: 0.577 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.986412525177002
Epoch: 5, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.817 Vali Acc: 0.732 Test Loss: 0.817 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731699).  Saving model ...
Epoch: 6 cost time: 0.9569578170776367
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.722 Test Loss: 0.643 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1893060207366943
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9728152751922607
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.727 Test Loss: 0.730 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9205191135406494
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.727 Test Loss: 0.744 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0875227451324463
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8488295078277588
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.722 Test Loss: 0.721 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0230062007904053
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9001336097717285
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.722 Test Loss: 0.753 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0118250846862793
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.722 Test Loss: 0.761 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.070577621459961
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.717 Test Loss: 0.758 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 1719510
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.798460960388184
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.526 Vali Acc: 0.756 Test Loss: 0.526 Test Acc: 0.756
Validation loss decreased (inf --> -0.756092).  Saving model ...
Epoch: 2 cost time: 4.880216360092163
Epoch: 2, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.576 Vali Acc: 0.756 Test Loss: 0.576 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.029153347015381
Epoch: 3, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.631 Vali Acc: 0.727 Test Loss: 0.631 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.573765993118286
Epoch: 4, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 4.327054262161255
Epoch: 5, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.554 Vali Acc: 0.756 Test Loss: 0.554 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.044877052307129
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.132867097854614
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.651 Vali Acc: 0.756 Test Loss: 0.651 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.145770311355591
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.761 Test Loss: 0.606 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 4.091324806213379
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.771 Test Loss: 0.652 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770725).  Saving model ...
Epoch: 10 cost time: 4.109995603561401
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.761 Test Loss: 0.647 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7091546058654785
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.766 Test Loss: 0.652 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.087467670440674
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4615578651428223
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.771 Test Loss: 0.675 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.281576156616211
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.761 Test Loss: 0.674 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.722104787826538
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.766 Test Loss: 0.693 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.9931416511535645
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.771 Test Loss: 0.703 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3126819133758545
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.756 Test Loss: 0.706 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8007171154022217
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.761 Test Loss: 0.704 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.410085916519165
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1817974
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.504403114318848
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 4.185537338256836
Epoch: 2, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 3.3676180839538574
Epoch: 3, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1009323596954346
Epoch: 4, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 3.4448294639587402
Epoch: 5, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.44014573097229
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.766 Test Loss: 0.599 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 3.372467279434204
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.527087688446045
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.756 Test Loss: 0.607 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5552632808685303
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.565434217453003
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.746 Test Loss: 0.647 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6639957427978516
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.756 Test Loss: 0.638 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.470060348510742
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.756 Test Loss: 0.648 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3922970294952393
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2959728240966797
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.741 Test Loss: 0.663 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.3697361946105957
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.756 Test Loss: 0.666 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.560847282409668
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1797494
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.990621566772461
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.559 Vali Acc: 0.702 Test Loss: 0.559 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 3.2112576961517334
Epoch: 2, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.545 Vali Acc: 0.712 Test Loss: 0.545 Test Acc: 0.712
Validation loss decreased (-0.702433 --> -0.712190).  Saving model ...
Epoch: 3 cost time: 2.5911059379577637
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
Validation loss decreased (-0.712190 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.8975167274475098
Epoch: 4, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.527 Vali Acc: 0.727 Test Loss: 0.527 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1815810203552246
Epoch: 5, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.430145502090454
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4118354320526123
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 8 cost time: 2.627983570098877
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.741 Test Loss: 0.703 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2652556896209717
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.746 Test Loss: 0.664 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9402260780334473
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.741 Test Loss: 0.694 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.725508213043213
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.741 Test Loss: 0.705 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7788407802581787
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.741 Test Loss: 0.707 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3369662761688232
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.741 Test Loss: 0.723 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.116453170776367
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.741 Test Loss: 0.724 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.234806776046753
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.741 Test Loss: 0.731 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.6884117126464844
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.741 Test Loss: 0.742 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.878692865371704
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.732 Test Loss: 0.757 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1777014
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9113001823425293
Epoch: 1, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8904078006744385
Epoch: 2, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.7788221836090088
Epoch: 3, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0889108180999756
Epoch: 4, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.386093854904175
Epoch: 5, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2671470642089844
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0304627418518066
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 8 cost time: 2.135756492614746
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.741 Test Loss: 0.698 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9786269664764404
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 10 cost time: 2.163982629776001
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1585371494293213
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.741 Test Loss: 0.718 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5531461238861084
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.741 Test Loss: 0.726 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.546166181564331
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.741 Test Loss: 0.738 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2078957557678223
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.737 Test Loss: 0.740 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8117213249206543
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.741 Test Loss: 0.745 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0960607528686523
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.741 Test Loss: 0.761 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.996333122253418
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.741 Test Loss: 0.768 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2958126068115234
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.459940195083618
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.741 Test Loss: 0.780 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1756534
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5859720706939697
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.687 Vali Acc: 0.727 Test Loss: 0.687 Test Acc: 0.727
Validation loss decreased (inf --> -0.726822).  Saving model ...
Epoch: 2 cost time: 1.628772497177124
Epoch: 2, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.534 Vali Acc: 0.717 Test Loss: 0.534 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4975943565368652
Epoch: 3, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.726822 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.4839580059051514
Epoch: 4, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.542 Vali Acc: 0.717 Test Loss: 0.542 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6131176948547363
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.553 Vali Acc: 0.746 Test Loss: 0.553 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.6544702053070068
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.626 Vali Acc: 0.741 Test Loss: 0.626 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6259686946868896
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.598 Vali Acc: 0.756 Test Loss: 0.598 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 1.7677741050720215
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7189929485321045
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8749783039093018
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.650909423828125
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.746 Test Loss: 0.669 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6005189418792725
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.741 Test Loss: 0.705 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8745489120483398
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.746 Test Loss: 0.687 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6537227630615234
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.741 Test Loss: 0.702 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7715034484863281
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.737 Test Loss: 0.704 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.404085636138916
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.737 Test Loss: 0.719 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8761591911315918
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1740150
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6548752784729004
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.4138357639312744
Epoch: 2, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.507 Vali Acc: 0.756 Test Loss: 0.507 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.4947264194488525
Epoch: 3, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.580 Vali Acc: 0.678 Test Loss: 0.580 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.755397081375122
Epoch: 4, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.522 Vali Acc: 0.751 Test Loss: 0.522 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6219398975372314
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.561 Vali Acc: 0.761 Test Loss: 0.561 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.5160529613494873
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6241719722747803
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.766 Test Loss: 0.605 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 1.7781894207000732
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.771 Test Loss: 0.641 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770725).  Saving model ...
Epoch: 9 cost time: 1.4292523860931396
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3704538345336914
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.766 Test Loss: 0.671 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6966416835784912
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.766 Test Loss: 0.679 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3951897621154785
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.766 Test Loss: 0.694 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6873464584350586
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.766 Test Loss: 0.708 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8792486190795898
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.766 Test Loss: 0.707 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6818430423736572
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.766 Test Loss: 0.717 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6566181182861328
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.766 Test Loss: 0.724 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5279557704925537
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.766 Test Loss: 0.730 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7094337940216064
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.766 Test Loss: 0.738 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1731958
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2717127799987793
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 1.49074125289917
Epoch: 2, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.1917526721954346
Epoch: 3, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0705478191375732
Epoch: 4, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.667 Vali Acc: 0.732 Test Loss: 0.667 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.108748435974121
Epoch: 5, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.575 Vali Acc: 0.756 Test Loss: 0.575 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.380544900894165
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.741 Test Loss: 0.716 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.224700689315796
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3317883014678955
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 9 cost time: 1.1443431377410889
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3935976028442383
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.756 Test Loss: 0.734 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2556242942810059
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.756 Test Loss: 0.744 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2149734497070312
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.756 Test Loss: 0.746 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1816961765289307
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.243535041809082
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.751 Test Loss: 0.778 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1543219089508057
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3620545864105225
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3812775611877441
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.751 Test Loss: 0.796 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0737500190734863
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.751 Test Loss: 0.801 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1723766
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1705870628356934
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.126880168914795
Epoch: 2, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.525 Vali Acc: 0.727 Test Loss: 0.525 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.0043342113494873
Epoch: 3, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.185004711151123
Epoch: 4, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.725 Vali Acc: 0.727 Test Loss: 0.725 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1296250820159912
Epoch: 5, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.833 Vali Acc: 0.732 Test Loss: 0.833 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1724083423614502
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1107189655303955
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.722 Test Loss: 0.863 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1606471538543701
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.732 Test Loss: 0.775 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.121845006942749
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 10 cost time: 0.9030182361602783
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.732 Test Loss: 0.764 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0608282089233398
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.727 Test Loss: 0.821 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2066147327423096
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.732 Test Loss: 0.810 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9789752960205078
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.732 Test Loss: 0.820 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0068035125732422
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.732 Test Loss: 0.821 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1996307373046875
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.732 Test Loss: 0.831 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1918115615844727
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.727 Test Loss: 0.849 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1390480995178223
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.737 Test Loss: 0.847 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.279576063156128
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.737 Test Loss: 0.854 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0259294509887695
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.737 Test Loss: 0.860 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1715574
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.2252607345581055
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 3.9778871536254883
Epoch: 2, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.065360069274902
Epoch: 3, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.525 Vali Acc: 0.737 Test Loss: 0.525 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.1641974449157715
Epoch: 4, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.902303695678711
Epoch: 5, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.546 Vali Acc: 0.707 Test Loss: 0.546 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8047666549682617
Epoch: 6, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.62036919593811
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9615352153778076
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.640 Vali Acc: 0.732 Test Loss: 0.640 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.111776351928711
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.722 Test Loss: 0.681 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.346973419189453
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.741 Test Loss: 0.678 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 11 cost time: 4.081724405288696
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.741 Test Loss: 0.697 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.795835018157959
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.823045253753662
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.732 Test Loss: 0.717 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.512711763381958
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.732 Test Loss: 0.721 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.911578416824341
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.732 Test Loss: 0.725 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.706082582473755
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.732 Test Loss: 0.723 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.118561267852783
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.732 Test Loss: 0.740 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.171132802963257
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.732 Test Loss: 0.741 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.482889413833618
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.732 Test Loss: 0.743 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.007609128952026
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.732 Test Loss: 0.753 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1816006
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.389532566070557
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.5136682987213135
Epoch: 2, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.509 Vali Acc: 0.771 Test Loss: 0.509 Test Acc: 0.771
Validation loss decreased (-0.721945 --> -0.770727).  Saving model ...
Epoch: 3 cost time: 3.414767265319824
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.506 Vali Acc: 0.732 Test Loss: 0.506 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9929561614990234
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4705543518066406
Epoch: 5, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8849363327026367
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2843852043151855
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1837637424468994
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.766 Test Loss: 0.629 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.6825389862060547
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.766 Test Loss: 0.679 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6081180572509766
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.756 Test Loss: 0.637 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3382160663604736
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.212150573730469
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.756 Test Loss: 0.677 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1795526
model size : 6.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.436974048614502
Epoch: 1, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
Validation loss decreased (inf --> -0.760970).  Saving model ...
Epoch: 2 cost time: 3.02325439453125
Epoch: 2, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.507 Vali Acc: 0.761 Test Loss: 0.507 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760971).  Saving model ...
Epoch: 3 cost time: 2.9649975299835205
Epoch: 3, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.94185471534729
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2781355381011963
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8396413326263428
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.657 Vali Acc: 0.732 Test Loss: 0.657 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.948695659637451
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.741 Test Loss: 0.598 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.4027838706970215
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.671 Vali Acc: 0.751 Test Loss: 0.671 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.395181655883789
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.746 Test Loss: 0.669 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.907965660095215
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.751 Test Loss: 0.660 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8669116497039795
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8332607746124268
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.741 Test Loss: 0.685 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1775046
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.0229692459106445
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.526 Vali Acc: 0.737 Test Loss: 0.526 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 2.7749381065368652
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.588 Vali Acc: 0.678 Test Loss: 0.588 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1282334327697754
Epoch: 3, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
Validation loss decreased (-0.736580 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 2.5297513008117676
Epoch: 4, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.514 Vali Acc: 0.746 Test Loss: 0.514 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7914040088653564
Epoch: 5, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.530 Vali Acc: 0.727 Test Loss: 0.530 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6311707496643066
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.751 Test Loss: 0.680 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7101151943206787
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.756 Test Loss: 0.582 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9470510482788086
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.572206974029541
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.756 Test Loss: 0.643 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6748220920562744
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.756 Test Loss: 0.647 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7933080196380615
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.756 Test Loss: 0.667 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.364598035812378
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.756 Test Loss: 0.674 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.73630690574646
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1754566
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.296839714050293
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8189976215362549
Epoch: 2, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.508 Vali Acc: 0.746 Test Loss: 0.508 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.9348254203796387
Epoch: 3, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.509 Vali Acc: 0.727 Test Loss: 0.509 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9596688747406006
Epoch: 4, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.528 Vali Acc: 0.756 Test Loss: 0.528 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.8929903507232666
Epoch: 5, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2673730850219727
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.762 Vali Acc: 0.727 Test Loss: 0.762 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1894588470458984
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0447463989257812
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.684 Vali Acc: 0.751 Test Loss: 0.684 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7136073112487793
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2997679710388184
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.746 Test Loss: 0.695 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4318835735321045
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.746 Test Loss: 0.707 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0842947959899902
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.756 Test Loss: 0.731 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6677241325378418
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1032638549804688
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1738182
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6721816062927246
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.5777831077575684
Epoch: 2, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.8078341484069824
Epoch: 3, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.618 Vali Acc: 0.673 Test Loss: 0.618 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7741725444793701
Epoch: 4, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.527 Vali Acc: 0.722 Test Loss: 0.527 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6792349815368652
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.607 Vali Acc: 0.702 Test Loss: 0.607 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.713076114654541
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.743 Vali Acc: 0.727 Test Loss: 0.743 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5858337879180908
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.608 Vali Acc: 0.741 Test Loss: 0.608 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 8 cost time: 1.6435997486114502
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5149667263031006
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.737 Test Loss: 0.742 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3561334609985352
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.737 Test Loss: 0.702 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.796154260635376
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.741 Test Loss: 0.701 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3988771438598633
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.741 Test Loss: 0.715 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5292248725891113
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.746 Test Loss: 0.738 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 14 cost time: 1.5176618099212646
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.741 Test Loss: 0.738 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7123360633850098
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.741 Test Loss: 0.746 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7003741264343262
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.741 Test Loss: 0.749 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.752370834350586
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.741 Test Loss: 0.755 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8051128387451172
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.741 Test Loss: 0.759 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6574506759643555
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.746 Test Loss: 0.771 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5101280212402344
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.746 Test Loss: 0.779 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6875278949737549
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.746 Test Loss: 0.783 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4545941352844238
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.746 Test Loss: 0.791 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.693922758102417
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.741 Test Loss: 0.793 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1729990
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5218117237091064
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.4323737621307373
Epoch: 2, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.521 Vali Acc: 0.712 Test Loss: 0.521 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.515580177307129
Epoch: 3, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.519 Vali Acc: 0.722 Test Loss: 0.519 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 1.7683625221252441
Epoch: 4, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.740 Vali Acc: 0.629 Test Loss: 0.740 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5494885444641113
Epoch: 5, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.609 Vali Acc: 0.741 Test Loss: 0.609 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 1.5603091716766357
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2986912727355957
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.667 Vali Acc: 0.756 Test Loss: 0.667 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 1.9324986934661865
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.766 Test Loss: 0.632 Test Acc: 0.766
Validation loss decreased (-0.756091 --> -0.765847).  Saving model ...
Epoch: 9 cost time: 1.6753101348876953
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.751 Test Loss: 0.713 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4611587524414062
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.751 Test Loss: 0.718 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6618926525115967
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.635493516921997
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.751 Test Loss: 0.715 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9635908603668213
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.751 Test Loss: 0.728 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.378140926361084
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3167641162872314
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.756 Test Loss: 0.732 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6598584651947021
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.756 Test Loss: 0.745 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6844096183776855
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.756 Test Loss: 0.757 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.343214988708496
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1721798
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9615495204925537
Epoch: 1, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.058495044708252
Epoch: 2, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.532 Vali Acc: 0.771 Test Loss: 0.532 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 3 cost time: 1.2756683826446533
Epoch: 3, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.511 Vali Acc: 0.737 Test Loss: 0.511 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1092016696929932
Epoch: 4, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.634 Vali Acc: 0.766 Test Loss: 0.634 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0486912727355957
Epoch: 5, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.627 Vali Acc: 0.766 Test Loss: 0.627 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.287712812423706
Epoch: 6, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1940193176269531
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.771 Test Loss: 0.667 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3450307846069336
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.766 Test Loss: 0.714 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0103991031646729
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.766 Test Loss: 0.720 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1242399215698242
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.761 Test Loss: 0.742 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2916231155395508
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.766 Test Loss: 0.765 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0301411151885986
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.761 Test Loss: 0.758 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1713606
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.286159992218018
Epoch: 1, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.305737257003784
Epoch: 2, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 5.06150221824646
Epoch: 3, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.525 Vali Acc: 0.722 Test Loss: 0.525 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.838526248931885
Epoch: 4, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 4.956100225448608
Epoch: 5, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.521 Vali Acc: 0.727 Test Loss: 0.521 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.481923341751099
Epoch: 6, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.552 Vali Acc: 0.702 Test Loss: 0.552 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.182251453399658
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.647 Vali Acc: 0.746 Test Loss: 0.647 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 8 cost time: 4.897669076919556
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.727 Test Loss: 0.627 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.363860845565796
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.649 Vali Acc: 0.741 Test Loss: 0.649 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.3778886795043945
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.985929250717163
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.741 Test Loss: 0.689 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.672664642333984
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.741 Test Loss: 0.695 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.6797614097595215
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.741 Test Loss: 0.701 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.957626581192017
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.195880174636841
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.1141393184661865
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.751 Test Loss: 0.737 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751212).  Saving model ...
Epoch: 17 cost time: 3.865206003189087
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.746 Test Loss: 0.743 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.49377703666687
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.2338786125183105
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.746 Test Loss: 0.751 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.6495044231414795
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.746 Test Loss: 0.759 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.674914360046387
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.746 Test Loss: 0.755 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.812450885772705
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.746 Test Loss: 0.768 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.8686206340789795
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.746 Test Loss: 0.776 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.5616583824157715
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.751 Test Loss: 0.767 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.456821441650391
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.741 Test Loss: 0.790 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.800215482711792
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.746 Test Loss: 0.787 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1815022
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.088454246520996
Epoch: 1, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.546 Vali Acc: 0.707 Test Loss: 0.546 Test Acc: 0.707
Validation loss decreased (inf --> -0.707312).  Saving model ...
Epoch: 2 cost time: 3.2786705493927
Epoch: 2, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.510 Vali Acc: 0.737 Test Loss: 0.510 Test Acc: 0.737
Validation loss decreased (-0.707312 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.571083307266235
Epoch: 3, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 3.750598430633545
Epoch: 4, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.554 Vali Acc: 0.751 Test Loss: 0.554 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 3.903029441833496
Epoch: 5, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7729945182800293
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.9241626262664795
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.737 Test Loss: 0.680 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7801599502563477
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.737 Test Loss: 0.692 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5510809421539307
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.737 Test Loss: 0.710 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2365882396698
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.732 Test Loss: 0.720 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.52716851234436
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.732 Test Loss: 0.749 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.514822006225586
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.732 Test Loss: 0.746 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.620603084564209
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.737 Test Loss: 0.772 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.702026844024658
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.737 Test Loss: 0.777 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1794542
model size : 6.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.0177247524261475
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 3.104675054550171
Epoch: 2, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.493 Vali Acc: 0.761 Test Loss: 0.493 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760971).  Saving model ...
Epoch: 3 cost time: 3.3428945541381836
Epoch: 3, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.509 Vali Acc: 0.717 Test Loss: 0.509 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1090569496154785
Epoch: 4, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.510 Vali Acc: 0.712 Test Loss: 0.510 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5260956287384033
Epoch: 5, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7257063388824463
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.639 Vali Acc: 0.756 Test Loss: 0.639 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.022479295730591
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0194008350372314
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.693922281265259
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.313410997390747
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.751 Test Loss: 0.656 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7798423767089844
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.0277719497680664
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.746 Test Loss: 0.657 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1774062
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.851702928543091
Epoch: 1, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 2.7906606197357178
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.512 Vali Acc: 0.737 Test Loss: 0.512 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2254207134246826
Epoch: 3, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.507 Vali Acc: 0.722 Test Loss: 0.507 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5294225215911865
Epoch: 4, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.579 Vali Acc: 0.702 Test Loss: 0.579 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0482113361358643
Epoch: 5, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.1605026721954346
Epoch: 6, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.745 Vali Acc: 0.751 Test Loss: 0.745 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4387199878692627
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.684 Vali Acc: 0.746 Test Loss: 0.684 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2099382877349854
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.756 Test Loss: 0.685 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 9 cost time: 2.0366835594177246
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760969).  Saving model ...
Epoch: 10 cost time: 2.7634079456329346
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.751 Test Loss: 0.790 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.45713472366333
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7235329151153564
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.751 Test Loss: 0.737 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3090014457702637
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.640942335128784
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.800323486328125
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3940443992614746
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3129100799560547
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.497178316116333
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.606804847717285
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1753582
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.046952724456787
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 2.458662748336792
Epoch: 2, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.303915500640869
Epoch: 3, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.666 Vali Acc: 0.741 Test Loss: 0.666 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0851821899414062
Epoch: 4, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.526158571243286
Epoch: 5, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.678 Vali Acc: 0.741 Test Loss: 0.678 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.031684398651123
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.128725051879883
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.665 Vali Acc: 0.707 Test Loss: 0.665 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8380274772644043
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3151848316192627
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.717 Test Loss: 0.725 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9104406833648682
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.707 Test Loss: 0.718 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.119812488555908
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.732 Test Loss: 0.740 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2552030086517334
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1737198
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.58079195022583
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8962390422821045
Epoch: 2, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.519 Vali Acc: 0.732 Test Loss: 0.519 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.8110103607177734
Epoch: 3, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4975168704986572
Epoch: 4, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4096312522888184
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.586 Vali Acc: 0.707 Test Loss: 0.586 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2735373973846436
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 7 cost time: 1.6925976276397705
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0869219303131104
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.732 Test Loss: 0.717 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6732244491577148
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.737 Test Loss: 0.714 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7553222179412842
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.727 Test Loss: 0.742 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6537084579467773
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.727 Test Loss: 0.742 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9081358909606934
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.727 Test Loss: 0.753 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8483083248138428
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.722 Test Loss: 0.768 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9959068298339844
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.722 Test Loss: 0.774 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4580824375152588
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.727 Test Loss: 0.780 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.545262336730957
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.727 Test Loss: 0.788 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1729006
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.609405040740967
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.5712816715240479
Epoch: 2, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.612 Vali Acc: 0.732 Test Loss: 0.612 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.2584733963012695
Epoch: 3, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.502 Vali Acc: 0.756 Test Loss: 0.502 Test Acc: 0.756
Validation loss decreased (-0.731701 --> -0.756093).  Saving model ...
Epoch: 4 cost time: 1.4693877696990967
Epoch: 4, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6341664791107178
Epoch: 5, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6165471076965332
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4238126277923584
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.741 Test Loss: 0.623 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6240589618682861
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.756 Test Loss: 0.735 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2329792976379395
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.741 Test Loss: 0.661 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6234643459320068
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5813188552856445
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.741 Test Loss: 0.731 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6942355632781982
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.741 Test Loss: 0.719 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.811034917831421
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1720814
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.027598857879639
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.521 Vali Acc: 0.741 Test Loss: 0.521 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 1.2743103504180908
Epoch: 2, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.494 Vali Acc: 0.756 Test Loss: 0.494 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756093).  Saving model ...
Epoch: 3 cost time: 1.2864704132080078
Epoch: 3, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.494 Vali Acc: 0.761 Test Loss: 0.494 Test Acc: 0.761
Validation loss decreased (-0.756093 --> -0.760971).  Saving model ...
Epoch: 4 cost time: 1.1712734699249268
Epoch: 4, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0773732662200928
Epoch: 5, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.143340826034546
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0219733715057373
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0607645511627197
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.727 Test Loss: 0.729 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3678793907165527
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.732 Test Loss: 0.742 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3208084106445312
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.732 Test Loss: 0.745 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3065776824951172
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.732 Test Loss: 0.758 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2061998844146729
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.732 Test Loss: 0.777 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.204108715057373
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.732 Test Loss: 0.783 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1712622
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.159137010574341
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.5506556034088135
Epoch: 2, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.6341392993927
Epoch: 3, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.724 Vali Acc: 0.732 Test Loss: 0.724 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.083207130432129
Epoch: 4, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.530 Vali Acc: 0.746 Test Loss: 0.530 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.543421030044556
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.563 Vali Acc: 0.756 Test Loss: 0.563 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 3.652801513671875
Epoch: 6, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.796 Vali Acc: 0.751 Test Loss: 0.796 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0601935386657715
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.799 Vali Acc: 0.746 Test Loss: 0.799 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.731987714767456
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.674 Vali Acc: 0.756 Test Loss: 0.674 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.281625747680664
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.785 Vali Acc: 0.741 Test Loss: 0.785 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.8369245529174805
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.20344090461731
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.737 Test Loss: 0.797 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.161532402038574
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.737 Test Loss: 0.812 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.248185873031616
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.727 Test Loss: 0.829 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.616509675979614
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.727 Test Loss: 0.837 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.019493579864502
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.727 Test Loss: 0.837 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1814530
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.633318185806274
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 3.7638332843780518
Epoch: 2, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 4.6000816822052
Epoch: 3, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6282458305358887
Epoch: 4, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.024 Vali Acc: 0.512 Test Loss: 1.024 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.62723445892334
Epoch: 5, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.651249885559082
Epoch: 6, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.094975233078003
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.650 Vali Acc: 0.761 Test Loss: 0.650 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.849116802215576
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.808 Vali Acc: 0.741 Test Loss: 0.808 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.650157928466797
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.693 Test Loss: 0.673 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.951211452484131
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.808 Vali Acc: 0.732 Test Loss: 0.808 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.812683582305908
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.6258883476257324
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.737 Test Loss: 0.768 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1794050
model size : 6.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.501967906951904
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 3.6262636184692383
Epoch: 2, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4280221462249756
Epoch: 3, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.501 Vali Acc: 0.751 Test Loss: 0.501 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751215).  Saving model ...
Epoch: 4 cost time: 3.0558485984802246
Epoch: 4, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
Validation loss decreased (-0.751215 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 3.2874302864074707
Epoch: 5, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.168571710586548
Epoch: 6, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0990729331970215
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.903 Vali Acc: 0.737 Test Loss: 0.903 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.132063150405884
Epoch: 8, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.758 Vali Acc: 0.766 Test Loss: 0.758 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765846).  Saving model ...
Epoch: 9 cost time: 3.4557156562805176
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.040199041366577
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.837 Vali Acc: 0.771 Test Loss: 0.837 Test Acc: 0.771
Validation loss decreased (-0.765846 --> -0.770723).  Saving model ...
Epoch: 11 cost time: 3.315349578857422
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.751 Test Loss: 0.772 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8590853214263916
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.741 Test Loss: 0.712 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.342615842819214
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0232579708099365
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.761 Test Loss: 0.785 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6356117725372314
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9279191493988037
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.381002426147461
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1115732192993164
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.756 Test Loss: 0.789 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.116671323776245
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.10262393951416
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.761 Test Loss: 0.795 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1773570
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.287736654281616
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.3880624771118164
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.500 Vali Acc: 0.771 Test Loss: 0.500 Test Acc: 0.771
Validation loss decreased (-0.721945 --> -0.770727).  Saving model ...
Epoch: 3 cost time: 2.3577284812927246
Epoch: 3, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.526 Vali Acc: 0.683 Test Loss: 0.526 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.450202465057373
Epoch: 4, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.501 Vali Acc: 0.756 Test Loss: 0.501 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.549058198928833
Epoch: 5, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.366114616394043
Epoch: 6, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.555 Vali Acc: 0.707 Test Loss: 0.555 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.918933629989624
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.609 Vali Acc: 0.727 Test Loss: 0.609 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3349194526672363
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2762393951416016
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.956 Vali Acc: 0.737 Test Loss: 0.956 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.516660451889038
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8638789653778076
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.752 Vali Acc: 0.746 Test Loss: 0.752 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.600364923477173
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.737 Test Loss: 0.782 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1753090
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.231639862060547
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.1100635528564453
Epoch: 2, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.693 Vali Acc: 0.717 Test Loss: 0.693 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.845989465713501
Epoch: 3, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.505 Vali Acc: 0.732 Test Loss: 0.505 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.3241689205169678
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.964 Vali Acc: 0.483 Test Loss: 0.964 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.194636106491089
Epoch: 5, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7949576377868652
Epoch: 6, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.662 Vali Acc: 0.644 Test Loss: 0.662 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5250093936920166
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.659 Vali Acc: 0.727 Test Loss: 0.659 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3905880451202393
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.645 Vali Acc: 0.727 Test Loss: 0.645 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3892204761505127
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.727 Test Loss: 0.675 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3603098392486572
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.732 Test Loss: 0.689 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7676222324371338
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.732 Test Loss: 0.706 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.01580548286438
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.741 Test Loss: 0.714 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741456).  Saving model ...
Epoch: 13 cost time: 2.2343366146087646
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.741 Test Loss: 0.726 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.169748306274414
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.741 Test Loss: 0.735 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8298704624176025
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.741 Test Loss: 0.740 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8619887828826904
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.741 Test Loss: 0.743 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7152304649353027
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.737 Test Loss: 0.753 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.030215263366699
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.741 Test Loss: 0.764 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.087033987045288
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.732 Test Loss: 0.763 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3552474975585938
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.732 Test Loss: 0.769 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5891354084014893
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.732 Test Loss: 0.778 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.16418194770813
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.732 Test Loss: 0.781 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1736706
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.610382080078125
Epoch: 1, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.736912488937378
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
Validation loss decreased (-0.736580 --> -0.775605).  Saving model ...
Epoch: 3 cost time: 1.4021806716918945
Epoch: 3, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.613 Vali Acc: 0.620 Test Loss: 0.613 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4928483963012695
Epoch: 4, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.540 Vali Acc: 0.707 Test Loss: 0.540 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4179320335388184
Epoch: 5, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7600111961364746
Epoch: 6, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.661 Vali Acc: 0.698 Test Loss: 0.661 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7580623626708984
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.771 Vali Acc: 0.663 Test Loss: 0.771 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5154304504394531
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.746 Test Loss: 0.802 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.393385410308838
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.727 Test Loss: 0.745 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5083956718444824
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.717 Test Loss: 0.754 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.577080249786377
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.741 Test Loss: 0.788 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4640512466430664
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.741 Test Loss: 0.797 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1728514
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.877582311630249
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.429858922958374
Epoch: 2, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.520 Vali Acc: 0.766 Test Loss: 0.520 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 1.4941649436950684
Epoch: 3, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.489 Vali Acc: 0.746 Test Loss: 0.489 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.459024429321289
Epoch: 4, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.504 Vali Acc: 0.780 Test Loss: 0.504 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780483).  Saving model ...
Epoch: 5 cost time: 1.5196688175201416
Epoch: 5, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.546 Vali Acc: 0.766 Test Loss: 0.546 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.787062644958496
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.606 Vali Acc: 0.761 Test Loss: 0.606 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5048608779907227
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.738 Vali Acc: 0.766 Test Loss: 0.738 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6433823108673096
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4432435035705566
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.746 Test Loss: 0.769 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5426304340362549
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.756 Test Loss: 0.800 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.390310287475586
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.766 Test Loss: 0.783 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5839989185333252
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.751 Test Loss: 0.838 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5938868522644043
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5528297424316406
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.756 Test Loss: 0.839 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 1720322
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3197340965270996
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.524 Vali Acc: 0.722 Test Loss: 0.524 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.1140644550323486
Epoch: 2, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.489 Vali Acc: 0.737 Test Loss: 0.489 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.0820393562316895
Epoch: 3, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0495100021362305
Epoch: 4, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.595 Vali Acc: 0.712 Test Loss: 0.595 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.074376106262207
Epoch: 5, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.627 Vali Acc: 0.727 Test Loss: 0.627 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.238903522491455
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.678 Vali Acc: 0.756 Test Loss: 0.678 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 1.0309855937957764
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.741 Test Loss: 0.839 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2276239395141602
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.732 Test Loss: 0.816 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1387701034545898
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.746 Test Loss: 0.812 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1395795345306396
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.732 Test Loss: 0.865 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.144655466079712
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.737 Test Loss: 0.886 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3320472240447998
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.737 Test Loss: 0.887 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0891129970550537
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.741 Test Loss: 0.887 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9143915176391602
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.741 Test Loss: 0.901 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1368961334228516
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.741 Test Loss: 0.916 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.964550256729126
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.737 Test Loss: 0.930 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1712130
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.822489023208618
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.575 Vali Acc: 0.712 Test Loss: 0.575 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.825160264968872
Epoch: 2, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.526 Vali Acc: 0.722 Test Loss: 0.526 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 5.222517967224121
Epoch: 3, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.531 Vali Acc: 0.722 Test Loss: 0.531 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.631809949874878
Epoch: 4, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.698 Test Loss: 0.545 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.438417673110962
Epoch: 5, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 4.989201307296753
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 5.490643501281738
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.066863775253296
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.732 Test Loss: 0.689 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.265906572341919
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.075730800628662
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.732 Test Loss: 0.703 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.378105878829956
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.571815013885498
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.737 Test Loss: 0.714 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.285017967224121
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.419951438903809
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.732 Test Loss: 0.734 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.689613342285156
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.732 Test Loss: 0.727 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.3582069873809814
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.732 Test Loss: 0.748 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1813916
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.317638874053955
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.089616775512695
Epoch: 2, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 3.4716005325317383
Epoch: 3, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 3.880237340927124
Epoch: 4, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.559 Vali Acc: 0.746 Test Loss: 0.559 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 3.653390407562256
Epoch: 5, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.576150417327881
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.741 Test Loss: 0.646 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.436766862869263
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.674 Vali Acc: 0.732 Test Loss: 0.674 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8167989253997803
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.691 Vali Acc: 0.727 Test Loss: 0.691 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.2552571296691895
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.737 Test Loss: 0.714 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2349324226379395
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.737 Test Loss: 0.729 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.7966113090515137
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.732 Test Loss: 0.727 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.443559408187866
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.751 Test Loss: 0.756 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 13 cost time: 3.603398084640503
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.737 Test Loss: 0.746 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.793840169906616
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6489837169647217
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.737 Test Loss: 0.767 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2496466636657715
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.737 Test Loss: 0.780 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7448320388793945
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.737 Test Loss: 0.783 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.235640525817871
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.737 Test Loss: 0.790 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.122010946273804
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.737 Test Loss: 0.792 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.547635793685913
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.737 Test Loss: 0.799 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4557721614837646
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.737 Test Loss: 0.795 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.598175287246704
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.737 Test Loss: 0.809 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1793436
model size : 6.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.843069076538086
Epoch: 1, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.7562992572784424
Epoch: 2, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.507 Vali Acc: 0.746 Test Loss: 0.507 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.7912561893463135
Epoch: 3, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.516 Vali Acc: 0.722 Test Loss: 0.516 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.112150192260742
Epoch: 4, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1324079036712646
Epoch: 5, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.608942985534668
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.741 Test Loss: 0.609 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.653083086013794
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7259795665740967
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.737 Test Loss: 0.710 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6012532711029053
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.806614398956299
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.732 Test Loss: 0.693 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1477463245391846
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.732 Test Loss: 0.719 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.0007920265197754
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.732 Test Loss: 0.715 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1772956
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.117514610290527
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.550 Vali Acc: 0.698 Test Loss: 0.550 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 1.7973809242248535
Epoch: 2, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.552 Vali Acc: 0.702 Test Loss: 0.552 Test Acc: 0.702
Validation loss decreased (-0.697555 --> -0.702434).  Saving model ...
Epoch: 3 cost time: 2.1722381114959717
Epoch: 3, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.568 Vali Acc: 0.702 Test Loss: 0.568 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1759378910064697
Epoch: 4, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
Validation loss decreased (-0.702434 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.2523038387298584
Epoch: 5, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.714 Vali Acc: 0.737 Test Loss: 0.714 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 6 cost time: 2.311307191848755
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8807384967803955
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0865814685821533
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.727 Test Loss: 0.718 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9176318645477295
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.722 Test Loss: 0.687 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.316521167755127
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.727 Test Loss: 0.692 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9575512409210205
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.722 Test Loss: 0.708 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1728672981262207
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.008995771408081
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.732 Test Loss: 0.732 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3418831825256348
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.737 Test Loss: 0.742 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.216059684753418
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.722 Test Loss: 0.724 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1752476
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2576184272766113
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7658205032348633
Epoch: 2, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.514 Vali Acc: 0.717 Test Loss: 0.514 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 2.0032007694244385
Epoch: 3, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.507 Vali Acc: 0.751 Test Loss: 0.507 Test Acc: 0.751
Validation loss decreased (-0.717068 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.840761661529541
Epoch: 4, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.601 Vali Acc: 0.766 Test Loss: 0.601 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 1.365234136581421
Epoch: 5, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5190613269805908
Epoch: 6, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.761 Test Loss: 0.704 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6908903121948242
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.684 Vali Acc: 0.751 Test Loss: 0.684 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.843242883682251
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.751 Test Loss: 0.708 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8083083629608154
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.751 Test Loss: 0.737 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6791386604309082
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.751 Test Loss: 0.743 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.436678171157837
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.756 Test Loss: 0.744 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5742216110229492
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.751 Test Loss: 0.755 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6649937629699707
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.751 Test Loss: 0.767 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6058897972106934
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.751 Test Loss: 0.775 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1736092
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.542513847351074
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.0216636657714844
Epoch: 2, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.536 Vali Acc: 0.751 Test Loss: 0.536 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.668654441833496
Epoch: 3, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.514 Vali Acc: 0.717 Test Loss: 0.514 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.522411823272705
Epoch: 4, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7893929481506348
Epoch: 5, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.674 Vali Acc: 0.766 Test Loss: 0.674 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765847).  Saving model ...
Epoch: 6 cost time: 1.7015178203582764
Epoch: 6, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3642754554748535
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5681824684143066
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3852417469024658
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.741 Test Loss: 0.702 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.513768196105957
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3395326137542725
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3855574131011963
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6774773597717285
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4827663898468018
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.741 Test Loss: 0.721 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8045594692230225
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.737 Test Loss: 0.731 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1727900
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8072774410247803
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.509 Vali Acc: 0.712 Test Loss: 0.509 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 1.1541202068328857
Epoch: 2, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.488 Vali Acc: 0.732 Test Loss: 0.488 Test Acc: 0.732
Validation loss decreased (-0.712190 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.3327090740203857
Epoch: 3, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.498 Vali Acc: 0.751 Test Loss: 0.498 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751215).  Saving model ...
Epoch: 4 cost time: 1.3434193134307861
Epoch: 4, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5180699825286865
Epoch: 5, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.741 Test Loss: 0.570 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3410027027130127
Epoch: 6, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.732 Test Loss: 0.663 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.168318510055542
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.732 Test Loss: 0.634 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3031964302062988
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.239711046218872
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2598531246185303
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3422441482543945
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.732 Test Loss: 0.674 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2300312519073486
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5957694053649902
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.737 Test Loss: 0.708 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1719708
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.674757957458496
Epoch: 1, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.513 Vali Acc: 0.746 Test Loss: 0.513 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.0915486812591553
Epoch: 2, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.519 Vali Acc: 0.737 Test Loss: 0.519 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0483644008636475
Epoch: 3, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.560 Vali Acc: 0.746 Test Loss: 0.560 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1332006454467773
Epoch: 4, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9112112522125244
Epoch: 5, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.741 Test Loss: 0.676 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8370475769042969
Epoch: 6, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.11808180809021
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.737 Test Loss: 0.655 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2191846370697021
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3911871910095215
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.737 Test Loss: 0.692 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1005234718322754
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1185195446014404
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1711516
model size : 6.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.422495365142822
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.524 Vali Acc: 0.722 Test Loss: 0.524 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 4.658017873764038
Epoch: 2, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.512 Vali Acc: 0.746 Test Loss: 0.512 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.450062274932861
Epoch: 3, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.521 Vali Acc: 0.727 Test Loss: 0.521 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.242324352264404
Epoch: 4, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.506 Vali Acc: 0.732 Test Loss: 0.506 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.393172979354858
Epoch: 5, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.892367362976074
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.019932985305786
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.822270154953003
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.205963373184204
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7688190937042236
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.674916505813599
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.671 Vali Acc: 0.741 Test Loss: 0.671 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.061643600463867
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 940246
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.384672403335571
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 3.4499237537384033
Epoch: 2, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.531 Vali Acc: 0.683 Test Loss: 0.531 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9290084838867188
Epoch: 3, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.748002529144287
Epoch: 4, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.563 Vali Acc: 0.766 Test Loss: 0.563 Test Acc: 0.766
Validation loss decreased (-0.736580 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 2.923684597015381
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.593 Vali Acc: 0.776 Test Loss: 0.593 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775604).  Saving model ...
Epoch: 6 cost time: 3.00696063041687
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.562 Vali Acc: 0.771 Test Loss: 0.562 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.370907783508301
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.635 Vali Acc: 0.771 Test Loss: 0.635 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0082790851593018
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.618 Vali Acc: 0.766 Test Loss: 0.618 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9267783164978027
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2500667572021484
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.756 Test Loss: 0.648 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4380671977996826
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.1935083866119385
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.761 Test Loss: 0.668 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3962748050689697
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.71515154838562
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.761 Test Loss: 0.686 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.084834575653076
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.766 Test Loss: 0.682 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 930006
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.989211082458496
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.7958202362060547
Epoch: 2, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.506 Vali Acc: 0.761 Test Loss: 0.506 Test Acc: 0.761
Validation loss decreased (-0.721946 --> -0.760971).  Saving model ...
Epoch: 3 cost time: 3.5224361419677734
Epoch: 3, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.175194263458252
Epoch: 4, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9238076210021973
Epoch: 5, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.839221715927124
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.566 Vali Acc: 0.751 Test Loss: 0.566 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.822004556655884
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.582470417022705
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.751 Test Loss: 0.625 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9979190826416016
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1157279014587402
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.751 Test Loss: 0.680 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5686848163604736
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.275895357131958
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.761 Test Loss: 0.682 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 919766
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.258960962295532
Epoch: 1, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.547 Vali Acc: 0.717 Test Loss: 0.547 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 2.634752035140991
Epoch: 2, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.507 Vali Acc: 0.746 Test Loss: 0.507 Test Acc: 0.746
Validation loss decreased (-0.717068 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.346668004989624
Epoch: 3, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.502 Vali Acc: 0.780 Test Loss: 0.502 Test Acc: 0.780
Validation loss decreased (-0.746336 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 2.4871103763580322
Epoch: 4, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.521 Vali Acc: 0.766 Test Loss: 0.521 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6732451915740967
Epoch: 5, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5269949436187744
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.780 Test Loss: 0.550 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.05960750579834
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.766 Test Loss: 0.546 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8138511180877686
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.766 Test Loss: 0.580 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.487048387527466
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1116271018981934
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.771 Test Loss: 0.588 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.640702724456787
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.766 Test Loss: 0.598 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.846961259841919
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4388108253479004
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.766 Test Loss: 0.610 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 909526
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8572115898132324
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 1.6810228824615479
Epoch: 2, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (-0.717066 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.6235826015472412
Epoch: 3, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5798327922821045
Epoch: 4, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.604 Vali Acc: 0.741 Test Loss: 0.604 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.4283294677734375
Epoch: 5, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5592987537384033
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.659 Vali Acc: 0.727 Test Loss: 0.659 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6675324440002441
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 8 cost time: 1.8280949592590332
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.746 Test Loss: 0.696 Test Acc: 0.746
Validation loss decreased (-0.746334 --> -0.746335).  Saving model ...
Epoch: 9 cost time: 1.905181646347046
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.741 Test Loss: 0.756 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7736821174621582
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.737 Test Loss: 0.724 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9559168815612793
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.741 Test Loss: 0.753 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7333226203918457
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.741 Test Loss: 0.756 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8678431510925293
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.741 Test Loss: 0.775 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.837144374847412
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.741 Test Loss: 0.784 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7909328937530518
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.746 Test Loss: 0.790 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.119018793106079
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.746 Test Loss: 0.803 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9997613430023193
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.746 Test Loss: 0.811 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9874217510223389
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.741 Test Loss: 0.806 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 901334
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.95613169670105
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.539 Vali Acc: 0.727 Test Loss: 0.539 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.7921631336212158
Epoch: 2, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.525 Vali Acc: 0.732 Test Loss: 0.525 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.5607860088348389
Epoch: 3, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.524 Vali Acc: 0.722 Test Loss: 0.524 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5962154865264893
Epoch: 4, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.529 Vali Acc: 0.717 Test Loss: 0.529 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7360429763793945
Epoch: 5, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.734071969985962
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.746 Test Loss: 0.637 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 1.371983289718628
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.737 Test Loss: 0.652 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6422288417816162
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.732 Test Loss: 0.648 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7276697158813477
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6141581535339355
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.715411901473999
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5321621894836426
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.732 Test Loss: 0.694 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5838887691497803
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5162100791931152
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.737 Test Loss: 0.713 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8562912940979004
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4807257652282715
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.741 Test Loss: 0.736 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 897238
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.921699285507202
Epoch: 1, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 1.241499423980713
Epoch: 2, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.525 Vali Acc: 0.702 Test Loss: 0.525 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3851690292358398
Epoch: 3, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.506 Vali Acc: 0.751 Test Loss: 0.506 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.2584583759307861
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.15525221824646
Epoch: 5, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.577 Vali Acc: 0.756 Test Loss: 0.577 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 0.989816427230835
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.756 Test Loss: 0.593 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8850228786468506
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 8 cost time: 1.1671957969665527
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.151984691619873
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.751 Test Loss: 0.647 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2709202766418457
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.491180181503296
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.751 Test Loss: 0.665 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3330729007720947
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2132000923156738
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4740064144134521
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.746 Test Loss: 0.701 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0977473258972168
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.751 Test Loss: 0.704 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0387322902679443
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1638853549957275
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.751 Test Loss: 0.724 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 893142
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0385029315948486
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.1728308200836182
Epoch: 2, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.0381872653961182
Epoch: 3, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.510 Vali Acc: 0.712 Test Loss: 0.510 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0836567878723145
Epoch: 4, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.500 Vali Acc: 0.732 Test Loss: 0.500 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1117792129516602
Epoch: 5, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.660 Vali Acc: 0.766 Test Loss: 0.660 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 6 cost time: 0.9770641326904297
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1920251846313477
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0345001220703125
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.771 Test Loss: 0.717 Test Acc: 0.771
Validation loss decreased (-0.765847 --> -0.770725).  Saving model ...
Epoch: 9 cost time: 1.0726087093353271
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.991325855255127
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.756 Test Loss: 0.634 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.049285650253296
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.756 Test Loss: 0.651 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0632164478302002
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.761 Test Loss: 0.662 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.113257884979248
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.761 Test Loss: 0.668 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2281043529510498
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.761 Test Loss: 0.670 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.107677936553955
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1724848747253418
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.761 Test Loss: 0.688 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0054211616516113
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.756 Test Loss: 0.687 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5097205638885498
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 889046
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.955390691757202
Epoch: 1, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 4.305916786193848
Epoch: 2, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 4.287981033325195
Epoch: 3, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.516 Vali Acc: 0.712 Test Loss: 0.516 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.206761837005615
Epoch: 4, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.533 Vali Acc: 0.717 Test Loss: 0.533 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.565206289291382
Epoch: 5, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.717 Test Loss: 0.549 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9517478942871094
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7591066360473633
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.4763150215148926
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3272266387939453
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.722 Test Loss: 0.643 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.01017689704895
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.663 Vali Acc: 0.727 Test Loss: 0.663 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.695572853088379
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.712 Test Loss: 0.658 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.7355148792266846
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.732 Test Loss: 0.688 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 936310
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.036456823348999
Epoch: 1, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 3.5206007957458496
Epoch: 2, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.3647797107696533
Epoch: 3, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 3.3006956577301025
Epoch: 4, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.678532361984253
Epoch: 5, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.652 Vali Acc: 0.751 Test Loss: 0.652 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 6 cost time: 3.4015719890594482
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.751 Test Loss: 0.584 Test Acc: 0.751
Validation loss decreased (-0.751213 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 3.5634052753448486
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 3.395908832550049
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.766 Test Loss: 0.652 Test Acc: 0.766
Validation loss decreased (-0.756091 --> -0.765847).  Saving model ...
Epoch: 9 cost time: 3.5790083408355713
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.680 Vali Acc: 0.766 Test Loss: 0.680 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4908249378204346
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.751 Test Loss: 0.679 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.646592617034912
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.766 Test Loss: 0.708 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.167659044265747
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.761 Test Loss: 0.710 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7815985679626465
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.756 Test Loss: 0.711 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9733846187591553
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.5862605571746826
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.761 Test Loss: 0.743 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0596354007720947
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8194289207458496
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4741289615631104
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.756 Test Loss: 0.756 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 926070
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.191766262054443
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.0549697875976562
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.520 Vali Acc: 0.727 Test Loss: 0.520 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.485419750213623
Epoch: 3, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.1773171424865723
Epoch: 4, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.5339651107788086
Epoch: 5, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6309635639190674
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.682 Vali Acc: 0.712 Test Loss: 0.682 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.031080484390259
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.605 Vali Acc: 0.732 Test Loss: 0.605 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9437334537506104
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.752302408218384
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.737 Test Loss: 0.641 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.339297294616699
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.732 Test Loss: 0.685 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7496583461761475
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.741 Test Loss: 0.678 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.472172737121582
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.741 Test Loss: 0.682 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9187893867492676
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.741 Test Loss: 0.695 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.834259510040283
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.741 Test Loss: 0.710 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 915830
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.305380821228027
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.0905697345733643
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.532 Vali Acc: 0.722 Test Loss: 0.532 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.9208016395568848
Epoch: 3, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.531 Vali Acc: 0.766 Test Loss: 0.531 Test Acc: 0.766
Validation loss decreased (-0.721946 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.8892219066619873
Epoch: 4, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.543 Vali Acc: 0.707 Test Loss: 0.543 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.180495500564575
Epoch: 5, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.605 Vali Acc: 0.678 Test Loss: 0.605 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.914207935333252
Epoch: 6, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.625 Vali Acc: 0.766 Test Loss: 0.625 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.917618989944458
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9362974166870117
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.771 Test Loss: 0.658 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770725).  Saving model ...
Epoch: 9 cost time: 1.9582271575927734
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.190884828567505
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.761 Test Loss: 0.675 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.26472806930542
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.677 Vali Acc: 0.756 Test Loss: 0.677 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1325266361236572
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.746 Test Loss: 0.681 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8494365215301514
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.746 Test Loss: 0.692 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.383678674697876
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.029723644256592
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8461120128631592
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.741 Test Loss: 0.714 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2045834064483643
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1052403450012207
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.741 Test Loss: 0.723 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 905590
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.643465757369995
Epoch: 1, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.627 Vali Acc: 0.732 Test Loss: 0.627 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.8718671798706055
Epoch: 2, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.7771456241607666
Epoch: 3, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.5497007369995117
Epoch: 4, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.566 Vali Acc: 0.761 Test Loss: 0.566 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.6884171962738037
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6048688888549805
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.645 Vali Acc: 0.756 Test Loss: 0.645 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.662261724472046
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6197912693023682
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8155229091644287
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.692 Vali Acc: 0.751 Test Loss: 0.692 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5866401195526123
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7646551132202148
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7132289409637451
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.751 Test Loss: 0.732 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6066014766693115
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.751 Test Loss: 0.740 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7606782913208008
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.751 Test Loss: 0.755 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 897398
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.541309118270874
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.3681871891021729
Epoch: 2, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.2950572967529297
Epoch: 3, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3584907054901123
Epoch: 4, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3472082614898682
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.638 Vali Acc: 0.746 Test Loss: 0.638 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7216525077819824
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2445974349975586
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.313467264175415
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.741 Test Loss: 0.679 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3521771430969238
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.741 Test Loss: 0.723 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.358093023300171
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.746 Test Loss: 0.711 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.416987419128418
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.741 Test Loss: 0.720 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3964948654174805
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 893302
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6875839233398438
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.556 Vali Acc: 0.712 Test Loss: 0.556 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 1.2287812232971191
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.537 Vali Acc: 0.771 Test Loss: 0.537 Test Acc: 0.771
Validation loss decreased (-0.712190 --> -0.770726).  Saving model ...
Epoch: 3 cost time: 1.8489100933074951
Epoch: 3, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.508 Vali Acc: 0.737 Test Loss: 0.508 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.296473503112793
Epoch: 4, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3522095680236816
Epoch: 5, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2486238479614258
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4130456447601318
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.746 Test Loss: 0.582 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3723888397216797
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.741 Test Loss: 0.639 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.256749153137207
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3234539031982422
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.741 Test Loss: 0.626 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2917256355285645
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.756 Test Loss: 0.648 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8065311908721924
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 889206
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2159008979797363
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2732305526733398
Epoch: 2, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.0608532428741455
Epoch: 3, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0658483505249023
Epoch: 4, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.605 Vali Acc: 0.698 Test Loss: 0.605 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9774646759033203
Epoch: 5, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.832 Vali Acc: 0.741 Test Loss: 0.832 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741455).  Saving model ...
Epoch: 6 cost time: 1.1996958255767822
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.741 Test Loss: 0.657 Test Acc: 0.741
Validation loss decreased (-0.741455 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 1.223724603652954
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.765 Vali Acc: 0.751 Test Loss: 0.765 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751212).  Saving model ...
Epoch: 8 cost time: 1.0602223873138428
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
Validation loss decreased (-0.751212 --> -0.756089).  Saving model ...
Epoch: 9 cost time: 0.975109338760376
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.751 Test Loss: 0.772 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9976005554199219
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.751 Test Loss: 0.787 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9638948440551758
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.741 Test Loss: 0.810 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9325509071350098
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.741 Test Loss: 0.821 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.845350980758667
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.746 Test Loss: 0.820 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.116098165512085
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.751 Test Loss: 0.833 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9805812835693359
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.741 Test Loss: 0.842 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.108410120010376
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.741 Test Loss: 0.845 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9143366813659668
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.741 Test Loss: 0.855 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0364611148834229
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.751 Test Loss: 0.859 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 885110
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.936786651611328
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.516 Vali Acc: 0.751 Test Loss: 0.516 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 3.492816925048828
Epoch: 2, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.504 Vali Acc: 0.771 Test Loss: 0.504 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770727).  Saving model ...
Epoch: 3 cost time: 3.921595811843872
Epoch: 3, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.523 Vali Acc: 0.761 Test Loss: 0.523 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5214617252349854
Epoch: 4, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.658449411392212
Epoch: 5, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.234115362167358
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.864361047744751
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.683 Vali Acc: 0.727 Test Loss: 0.683 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.390735149383545
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8697750568389893
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.703 Vali Acc: 0.732 Test Loss: 0.703 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.929063558578491
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.732 Test Loss: 0.702 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.270936965942383
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.732 Test Loss: 0.722 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.533726453781128
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.732 Test Loss: 0.745 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 934342
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.187147855758667
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.4088263511657715
Epoch: 2, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.507 Vali Acc: 0.751 Test Loss: 0.507 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.742872476577759
Epoch: 3, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.510 Vali Acc: 0.737 Test Loss: 0.510 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.307725667953491
Epoch: 4, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.856882095336914
Epoch: 5, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.578 Vali Acc: 0.756 Test Loss: 0.578 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.941124677658081
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0436666011810303
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.766 Test Loss: 0.651 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 8 cost time: 2.898710012435913
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8231427669525146
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.756 Test Loss: 0.707 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9643993377685547
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.766 Test Loss: 0.721 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9123518466949463
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.756 Test Loss: 0.724 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.24055814743042
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.761 Test Loss: 0.739 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.438971757888794
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.678642511367798
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.5383052825927734
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.756 Test Loss: 0.776 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.508652925491333
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.756 Test Loss: 0.784 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.563446044921875
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 924102
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.447062730789185
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 2.8675661087036133
Epoch: 2, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.524 Vali Acc: 0.761 Test Loss: 0.524 Test Acc: 0.761
Validation loss decreased (-0.717068 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 3.6794121265411377
Epoch: 3, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.604 Vali Acc: 0.639 Test Loss: 0.604 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7029969692230225
Epoch: 4, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.531 Vali Acc: 0.766 Test Loss: 0.531 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 2.8446385860443115
Epoch: 5, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9036366939544678
Epoch: 6, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.128896474838257
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.697 Vali Acc: 0.741 Test Loss: 0.697 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6142659187316895
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.684 Vali Acc: 0.732 Test Loss: 0.684 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.951387643814087
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.727 Test Loss: 0.701 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8868227005004883
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.732 Test Loss: 0.732 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2362632751464844
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.679638385772705
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.752 Vali Acc: 0.732 Test Loss: 0.752 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5177817344665527
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.737 Test Loss: 0.750 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.4565377235412598
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.737 Test Loss: 0.753 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 913862
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.508617162704468
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.9546782970428467
Epoch: 2, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.516 Vali Acc: 0.746 Test Loss: 0.516 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.5580966472625732
Epoch: 3, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.515 Vali Acc: 0.727 Test Loss: 0.515 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.402303695678711
Epoch: 4, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.541 Vali Acc: 0.751 Test Loss: 0.541 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.3438267707824707
Epoch: 5, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.603 Vali Acc: 0.756 Test Loss: 0.603 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.099888324737549
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3221871852874756
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 8 cost time: 2.141380548477173
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.751 Test Loss: 0.652 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0460093021392822
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.761 Test Loss: 0.697 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.246893882751465
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.761 Test Loss: 0.695 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.944070816040039
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5871527194976807
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.756 Test Loss: 0.722 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.325639486312866
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.321702241897583
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.761 Test Loss: 0.747 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.134523868560791
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.756 Test Loss: 0.756 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5167438983917236
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.761 Test Loss: 0.749 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.150909662246704
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.761 Test Loss: 0.765 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 903622
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.484323263168335
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (inf --> -0.756092).  Saving model ...
Epoch: 2 cost time: 1.8900995254516602
Epoch: 2, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.5780766010284424
Epoch: 3, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.507 Vali Acc: 0.756 Test Loss: 0.507 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.6559371948242188
Epoch: 4, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.512 Vali Acc: 0.751 Test Loss: 0.512 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8503894805908203
Epoch: 5, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.551 Vali Acc: 0.717 Test Loss: 0.551 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8088810443878174
Epoch: 6, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.675 Vali Acc: 0.771 Test Loss: 0.675 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770725).  Saving model ...
Epoch: 7 cost time: 1.671142578125
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7340786457061768
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.751 Test Loss: 0.637 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6966900825500488
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.751 Test Loss: 0.612 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6951196193695068
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.751 Test Loss: 0.678 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.920654058456421
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9419169425964355
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5898842811584473
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.756 Test Loss: 0.699 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8786308765411377
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.756 Test Loss: 0.711 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8232090473175049
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.018345594406128
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 895430
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.78560733795166
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.558 Vali Acc: 0.712 Test Loss: 0.558 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 1.6159451007843018
Epoch: 2, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.712190 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.4388329982757568
Epoch: 3, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.638 Vali Acc: 0.722 Test Loss: 0.638 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5622267723083496
Epoch: 4, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.551 Vali Acc: 0.761 Test Loss: 0.551 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.2798194885253906
Epoch: 5, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5723013877868652
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.681 Vali Acc: 0.746 Test Loss: 0.681 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.639155387878418
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.741 Test Loss: 0.619 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.515232801437378
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.725 Vali Acc: 0.751 Test Loss: 0.725 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3374862670898438
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.756 Test Loss: 0.721 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8902137279510498
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4417757987976074
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.751 Test Loss: 0.759 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2804415225982666
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.737 Test Loss: 0.725 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5399858951568604
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.746 Test Loss: 0.750 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6620509624481201
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.751 Test Loss: 0.778 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 891334
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6302835941314697
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.168555498123169
Epoch: 2, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2283029556274414
Epoch: 3, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.530 Vali Acc: 0.698 Test Loss: 0.530 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1959919929504395
Epoch: 4, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.580 Vali Acc: 0.732 Test Loss: 0.580 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3985090255737305
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.603 Vali Acc: 0.693 Test Loss: 0.603 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1048200130462646
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.617 Vali Acc: 0.698 Test Loss: 0.617 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2221572399139404
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.702 Test Loss: 0.649 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3139255046844482
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.707 Test Loss: 0.676 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2545740604400635
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.702 Test Loss: 0.699 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.089294195175171
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.707 Test Loss: 0.702 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3089606761932373
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.707 Test Loss: 0.711 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.274662733078003
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.712 Test Loss: 0.729 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 887238
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.885413408279419
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.104973316192627
Epoch: 2, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.610 Vali Acc: 0.751 Test Loss: 0.610 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 1.2418427467346191
Epoch: 3, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.670 Vali Acc: 0.727 Test Loss: 0.670 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.121062994003296
Epoch: 4, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9990968704223633
Epoch: 5, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.564 Vali Acc: 0.766 Test Loss: 0.564 Test Acc: 0.766
Validation loss decreased (-0.751213 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 0.9962639808654785
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.652 Vali Acc: 0.771 Test Loss: 0.652 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770725).  Saving model ...
Epoch: 7 cost time: 1.064572811126709
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.163264274597168
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.766 Test Loss: 0.712 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.372697353363037
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.766 Test Loss: 0.708 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2673792839050293
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.776 Test Loss: 0.730 Test Acc: 0.776
Validation loss decreased (-0.770725 --> -0.775602).  Saving model ...
Epoch: 11 cost time: 0.8941435813903809
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.776 Test Loss: 0.735 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0428144931793213
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.771 Test Loss: 0.738 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0870747566223145
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.771 Test Loss: 0.753 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9911863803863525
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.771 Test Loss: 0.765 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1972417831420898
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.771 Test Loss: 0.770 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8550195693969727
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.771 Test Loss: 0.782 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9050517082214355
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.771 Test Loss: 0.786 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.170949935913086
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.771 Test Loss: 0.790 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1377613544464111
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.771 Test Loss: 0.802 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1673719882965088
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.771 Test Loss: 0.806 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 883142
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.632668733596802
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.8412435054779053
Epoch: 2, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.526 Vali Acc: 0.727 Test Loss: 0.526 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.398792743682861
Epoch: 3, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.525 Vali Acc: 0.732 Test Loss: 0.525 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.149754524230957
Epoch: 4, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9276156425476074
Epoch: 5, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.086611032485962
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6880404949188232
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.679 Vali Acc: 0.727 Test Loss: 0.679 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.529805421829224
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.727 Test Loss: 0.688 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.2872841358184814
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.37296724319458
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.722 Test Loss: 0.751 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.139514923095703
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.722 Test Loss: 0.742 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.6152663230895996
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.763 Vali Acc: 0.722 Test Loss: 0.763 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.212106227874756
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.786 Vali Acc: 0.732 Test Loss: 0.786 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 933358
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.779783487319946
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.558 Vali Acc: 0.707 Test Loss: 0.558 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 3.3022823333740234
Epoch: 2, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
Validation loss decreased (-0.707311 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.3744053840637207
Epoch: 3, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.195976495742798
Epoch: 4, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3743178844451904
Epoch: 5, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.610 Vali Acc: 0.644 Test Loss: 0.610 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.904454231262207
Epoch: 6, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.542 Vali Acc: 0.756 Test Loss: 0.542 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 3.663940668106079
Epoch: 7, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.587 Vali Acc: 0.741 Test Loss: 0.587 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.645059823989868
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6352264881134033
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 3.6956403255462646
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6602976322174072
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.756 Test Loss: 0.607 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.31530237197876
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.222127437591553
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.761 Test Loss: 0.623 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.753441572189331
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.1910295486450195
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.766 Test Loss: 0.642 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 16 cost time: 3.6093709468841553
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.756 Test Loss: 0.652 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.229747772216797
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.756 Test Loss: 0.645 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.671440839767456
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.751 Test Loss: 0.655 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4571053981781006
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.751 Test Loss: 0.664 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9596261978149414
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.02290153503418
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.9888715744018555
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.751 Test Loss: 0.676 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.857886791229248
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.3872196674346924
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.751 Test Loss: 0.679 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.8376190662384033
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.751 Test Loss: 0.685 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 923118
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.374578952789307
Epoch: 1, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.75262713432312
Epoch: 2, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 2.592912435531616
Epoch: 3, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.019679307937622
Epoch: 4, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.523 Vali Acc: 0.732 Test Loss: 0.523 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9439549446105957
Epoch: 5, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.519 Vali Acc: 0.737 Test Loss: 0.519 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1583621501922607
Epoch: 6, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.146373987197876
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.633 Vali Acc: 0.751 Test Loss: 0.633 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9385409355163574
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.746 Test Loss: 0.660 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.578566551208496
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4672961235046387
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.756 Test Loss: 0.717 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8922204971313477
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.751 Test Loss: 0.709 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.607419967651367
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 912878
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.425262212753296
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.528 Vali Acc: 0.727 Test Loss: 0.528 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.4498350620269775
Epoch: 2, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.619105100631714
Epoch: 3, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.485 Vali Acc: 0.751 Test Loss: 0.485 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751215).  Saving model ...
Epoch: 4 cost time: 2.4549338817596436
Epoch: 4, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.486 Vali Acc: 0.766 Test Loss: 0.486 Test Acc: 0.766
Validation loss decreased (-0.751215 --> -0.765849).  Saving model ...
Epoch: 5 cost time: 2.490586757659912
Epoch: 5, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.502 Vali Acc: 0.761 Test Loss: 0.502 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1657073497772217
Epoch: 6, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9229624271392822
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.746 Test Loss: 0.619 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.296525716781616
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.235356569290161
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5786325931549072
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.741 Test Loss: 0.612 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.454058885574341
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1692309379577637
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.756 Test Loss: 0.656 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1911091804504395
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5511155128479004
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.751 Test Loss: 0.674 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 902638
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8698508739471436
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.594618320465088
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 2.463298797607422
Epoch: 3, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.1804845333099365
Epoch: 4, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.597 Vali Acc: 0.688 Test Loss: 0.597 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8680400848388672
Epoch: 5, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9691197872161865
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7779173851013184
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8299832344055176
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5850417613983154
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8516786098480225
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 11 cost time: 1.9646661281585693
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.751 Test Loss: 0.753 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5862061977386475
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0542643070220947
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.751 Test Loss: 0.752 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4907026290893555
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.751 Test Loss: 0.760 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.928490161895752
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.761 Test Loss: 0.759 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.964501142501831
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7956621646881104
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.756 Test Loss: 0.759 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7594578266143799
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9213263988494873
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.761 Test Loss: 0.797 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7749505043029785
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 894446
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5718472003936768
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 1.514953374862671
Epoch: 2, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.540 Vali Acc: 0.756 Test Loss: 0.540 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.2485551834106445
Epoch: 3, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6880507469177246
Epoch: 4, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 5 cost time: 1.6706044673919678
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6546733379364014
Epoch: 6, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.595 Vali Acc: 0.771 Test Loss: 0.595 Test Acc: 0.771
Validation loss decreased (-0.760969 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 1.5479352474212646
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.771 Test Loss: 0.666 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.830374002456665
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.648 Vali Acc: 0.780 Test Loss: 0.648 Test Acc: 0.780
Validation loss decreased (-0.770726 --> -0.780481).  Saving model ...
Epoch: 9 cost time: 1.3922574520111084
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.766 Test Loss: 0.769 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5024073123931885
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.776 Test Loss: 0.748 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5808391571044922
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.771 Test Loss: 0.748 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6299259662628174
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.776 Test Loss: 0.798 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5747125148773193
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.776 Test Loss: 0.796 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4002208709716797
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.776 Test Loss: 0.811 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6216528415679932
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.776 Test Loss: 0.826 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2599763870239258
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.776 Test Loss: 0.835 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3683686256408691
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.776 Test Loss: 0.844 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6110577583312988
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.776 Test Loss: 0.841 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 890350
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0095839500427246
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.551 Vali Acc: 0.717 Test Loss: 0.551 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.0787060260772705
Epoch: 2, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.0973310470581055
Epoch: 3, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.499 Vali Acc: 0.766 Test Loss: 0.499 Test Acc: 0.766
Validation loss decreased (-0.736580 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 1.1378026008605957
Epoch: 4, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.521 Vali Acc: 0.732 Test Loss: 0.521 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3006443977355957
Epoch: 5, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1440956592559814
Epoch: 6, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.162170171737671
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2523939609527588
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1769425868988037
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2001667022705078
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0326323509216309
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0394477844238281
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2453346252441406
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 886254
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8571479320526123
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.545 Vali Acc: 0.717 Test Loss: 0.545 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.9774668216705322
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.547 Vali Acc: 0.766 Test Loss: 0.547 Test Acc: 0.766
Validation loss decreased (-0.717068 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 0.8321855068206787
Epoch: 3, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.515 Vali Acc: 0.732 Test Loss: 0.515 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0974597930908203
Epoch: 4, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1521563529968262
Epoch: 5, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0531935691833496
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.607 Vali Acc: 0.766 Test Loss: 0.607 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2434883117675781
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.741 Vali Acc: 0.771 Test Loss: 0.741 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770724).  Saving model ...
Epoch: 8 cost time: 1.0108332633972168
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.756 Test Loss: 0.748 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9405841827392578
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.761 Test Loss: 0.689 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8774218559265137
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.761 Test Loss: 0.764 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9672830104827881
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.766 Test Loss: 0.796 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.069108247756958
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.761 Test Loss: 0.793 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0018031597137451
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0881831645965576
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.756 Test Loss: 0.811 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1383354663848877
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1001605987548828
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.761 Test Loss: 0.833 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9402201175689697
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 882158
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.64690899848938
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.529 Vali Acc: 0.727 Test Loss: 0.529 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 4.42716121673584
Epoch: 2, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.500 Vali Acc: 0.785 Test Loss: 0.500 Test Acc: 0.785
Validation loss decreased (-0.726824 --> -0.785361).  Saving model ...
Epoch: 3 cost time: 4.0435404777526855
Epoch: 3, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.493 Vali Acc: 0.746 Test Loss: 0.493 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6591832637786865
Epoch: 4, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.525 Vali Acc: 0.717 Test Loss: 0.525 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.3596882820129395
Epoch: 5, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.637 Vali Acc: 0.683 Test Loss: 0.637 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8499460220336914
Epoch: 6, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.171568155288696
Epoch: 7, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.766248941421509
Epoch: 8, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.660 Vali Acc: 0.712 Test Loss: 0.660 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.287552356719971
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.678 Vali Acc: 0.707 Test Loss: 0.678 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.120562791824341
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.165037155151367
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.040986061096191
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.722 Test Loss: 0.737 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 932866
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.876936674118042
Epoch: 1, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.519 Vali Acc: 0.751 Test Loss: 0.519 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 3.2770049571990967
Epoch: 2, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.669 Vali Acc: 0.620 Test Loss: 0.669 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2472500801086426
Epoch: 3, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.538 Vali Acc: 0.727 Test Loss: 0.538 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.73113751411438
Epoch: 4, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.495 Vali Acc: 0.771 Test Loss: 0.495 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770727).  Saving model ...
Epoch: 5 cost time: 3.5221669673919678
Epoch: 5, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.500 Vali Acc: 0.741 Test Loss: 0.500 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.104458808898926
Epoch: 6, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4932470321655273
Epoch: 7, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.668 Vali Acc: 0.766 Test Loss: 0.668 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.951716661453247
Epoch: 8, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.629 Vali Acc: 0.771 Test Loss: 0.629 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.481454372406006
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.751 Test Loss: 0.588 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.97322678565979
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.703 Vali Acc: 0.761 Test Loss: 0.703 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5189895629882812
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.900346279144287
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.771 Test Loss: 0.702 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.602954149246216
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.771 Test Loss: 0.706 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.9034111499786377
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.766 Test Loss: 0.720 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 922626
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.00964617729187
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.2161505222320557
Epoch: 2, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 3.0042223930358887
Epoch: 3, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.568 Vali Acc: 0.741 Test Loss: 0.568 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.3386330604553223
Epoch: 4, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.512 Vali Acc: 0.722 Test Loss: 0.512 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6065609455108643
Epoch: 5, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.963254451751709
Epoch: 6, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.814871311187744
Epoch: 7, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.639 Vali Acc: 0.751 Test Loss: 0.639 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 8 cost time: 3.0802745819091797
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.695 Vali Acc: 0.732 Test Loss: 0.695 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.72552490234375
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.736016273498535
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.731 Vali Acc: 0.746 Test Loss: 0.731 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6177902221679688
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.746 Test Loss: 0.743 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.423218250274658
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.751 Test Loss: 0.775 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.177175760269165
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.741 Test Loss: 0.781 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.865091562271118
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.741 Test Loss: 0.804 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1349692344665527
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.741 Test Loss: 0.800 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8447141647338867
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.737 Test Loss: 0.822 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.6176812648773193
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.741 Test Loss: 0.841 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 912386
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.589885950088501
Epoch: 1, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.582 Vali Acc: 0.707 Test Loss: 0.582 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.048675537109375
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.9538967609405518
Epoch: 3, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.514 Vali Acc: 0.746 Test Loss: 0.514 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.8774888515472412
Epoch: 4, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.509 Vali Acc: 0.756 Test Loss: 0.509 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.6719558238983154
Epoch: 5, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.701 Vali Acc: 0.722 Test Loss: 0.701 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9556725025177002
Epoch: 6, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.660 Vali Acc: 0.746 Test Loss: 0.660 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2402918338775635
Epoch: 7, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.305685520172119
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.767 Vali Acc: 0.761 Test Loss: 0.767 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760968).  Saving model ...
Epoch: 9 cost time: 2.2977256774902344
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.741 Test Loss: 0.641 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.117112874984741
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.727 Vali Acc: 0.751 Test Loss: 0.727 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1570358276367188
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.692 Vali Acc: 0.746 Test Loss: 0.692 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.191524028778076
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.756 Test Loss: 0.742 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.145571231842041
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0322906970977783
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.751 Test Loss: 0.759 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.64160418510437
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1521689891815186
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.756 Test Loss: 0.769 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9121830463409424
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.746 Test Loss: 0.788 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6950392723083496
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.756 Test Loss: 0.779 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 902146
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5880653858184814
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.3660225868225098
Epoch: 2, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.7562806606292725
Epoch: 3, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7902522087097168
Epoch: 4, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 1.7525396347045898
Epoch: 5, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.598 Vali Acc: 0.678 Test Loss: 0.598 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1327226161956787
Epoch: 6, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8352422714233398
Epoch: 7, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.630012035369873
Epoch: 8, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.875352382659912
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.693161964416504
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.741 Test Loss: 0.754 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.648982048034668
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.732 Test Loss: 0.759 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6050782203674316
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.751 Test Loss: 0.839 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7326099872589111
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.741 Test Loss: 0.809 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6643013954162598
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.746 Test Loss: 0.832 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 893954
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.889639377593994
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.545 Vali Acc: 0.722 Test Loss: 0.545 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.6853537559509277
Epoch: 2, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.2505934238433838
Epoch: 3, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.515 Vali Acc: 0.727 Test Loss: 0.515 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3629212379455566
Epoch: 4, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.511 Vali Acc: 0.707 Test Loss: 0.511 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.442699670791626
Epoch: 5, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.564 Vali Acc: 0.698 Test Loss: 0.564 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.408937931060791
Epoch: 6, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.580 Vali Acc: 0.698 Test Loss: 0.580 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4522154331207275
Epoch: 7, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.643 Vali Acc: 0.727 Test Loss: 0.643 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4974591732025146
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.698 Test Loss: 0.679 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0747489929199219
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.732 Test Loss: 0.783 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2889347076416016
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.792 Vali Acc: 0.732 Test Loss: 0.792 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3000283241271973
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.712 Test Loss: 0.791 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3265275955200195
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 889858
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.941786766052246
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.2287285327911377
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.595 Vali Acc: 0.663 Test Loss: 0.595 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3848483562469482
Epoch: 3, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.563 Vali Acc: 0.751 Test Loss: 0.563 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.2939918041229248
Epoch: 4, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2234086990356445
Epoch: 5, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3969261646270752
Epoch: 6, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4295895099639893
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1310641765594482
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.751 Test Loss: 0.736 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.144347906112671
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.727 Test Loss: 0.729 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0802946090698242
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.165001392364502
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.727 Test Loss: 0.749 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2089171409606934
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.732 Test Loss: 0.745 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0842947959899902
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.732 Test Loss: 0.765 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 885762
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.321836471557617
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0398876667022705
Epoch: 2, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.583 Vali Acc: 0.727 Test Loss: 0.583 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 0.9430334568023682
Epoch: 3, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.600 Vali Acc: 0.673 Test Loss: 0.600 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9257853031158447
Epoch: 4, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.595 Vali Acc: 0.683 Test Loss: 0.595 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9385907649993896
Epoch: 5, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8850722312927246
Epoch: 6, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.685 Vali Acc: 0.668 Test Loss: 0.685 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0711345672607422
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.701 Vali Acc: 0.737 Test Loss: 0.701 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736578).  Saving model ...
Epoch: 8 cost time: 1.003838300704956
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.031 Vali Acc: 0.737 Test Loss: 1.031 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8973362445831299
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.891 Vali Acc: 0.712 Test Loss: 0.891 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0070550441741943
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.861656665802002
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8878986835479736
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.727 Test Loss: 1.031 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0364024639129639
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.727 Test Loss: 1.025 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9719336032867432
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.727 Test Loss: 1.024 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9539599418640137
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.732 Test Loss: 1.037 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1213092803955078
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.732 Test Loss: 1.048 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9523558616638184
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.732 Test Loss: 1.060 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 881666
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.252658128738403
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.8075966835021973
Epoch: 2, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.543 Vali Acc: 0.702 Test Loss: 0.543 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.733168840408325
Epoch: 3, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.519 Vali Acc: 0.737 Test Loss: 0.519 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.7039272785186768
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.795499563217163
Epoch: 5, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4694957733154297
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.624 Vali Acc: 0.756 Test Loss: 0.624 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 4.033631801605225
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.974564790725708
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.746 Test Loss: 0.639 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8101015090942383
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.751 Test Loss: 0.655 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.457202196121216
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.751 Test Loss: 0.662 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.941399097442627
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9002685546875
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.751 Test Loss: 0.684 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.521041393280029
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.756 Test Loss: 0.696 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.366554021835327
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.741 Test Loss: 0.693 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.232870578765869
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.619405031204224
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760968).  Saving model ...
Epoch: 17 cost time: 3.936640977859497
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.741 Test Loss: 0.709 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6885435581207275
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7144830226898193
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.756 Test Loss: 0.733 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.415166139602661
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.751 Test Loss: 0.739 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1957294940948486
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.746 Test Loss: 0.734 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.7875146865844727
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6451897621154785
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.737 Test Loss: 0.742 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.156325101852417
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.751 Test Loss: 0.755 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.5428383350372314
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.7711048126220703
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.746 Test Loss: 0.760 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 932252
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.784916639328003
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.124206304550171
Epoch: 2, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.516 Vali Acc: 0.741 Test Loss: 0.516 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 3.3643651008605957
Epoch: 3, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.522 Vali Acc: 0.722 Test Loss: 0.522 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7479336261749268
Epoch: 4, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8065969944000244
Epoch: 5, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.541 Vali Acc: 0.751 Test Loss: 0.541 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.2172458171844482
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.751 Test Loss: 0.627 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1418333053588867
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.756 Test Loss: 0.607 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 2.897995710372925
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.634 Vali Acc: 0.751 Test Loss: 0.634 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.106661319732666
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8056647777557373
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7536346912384033
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.756 Test Loss: 0.671 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1563172340393066
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.761 Test Loss: 0.678 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760969).  Saving model ...
Epoch: 13 cost time: 3.0241284370422363
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.756 Test Loss: 0.694 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3079957962036133
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.756 Test Loss: 0.699 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9855451583862305
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.756 Test Loss: 0.710 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2064294815063477
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.756 Test Loss: 0.699 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.3448355197906494
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.756 Test Loss: 0.725 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1552047729492188
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4370951652526855
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.574937343597412
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9168245792388916
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.751 Test Loss: 0.737 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.309669256210327
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.756 Test Loss: 0.731 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 922012
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.537786483764648
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 3.2158467769622803
Epoch: 2, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.507 Vali Acc: 0.737 Test Loss: 0.507 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.613105058670044
Epoch: 3, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.495 Vali Acc: 0.737 Test Loss: 0.495 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.068357229232788
Epoch: 4, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.892502546310425
Epoch: 5, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.559 Vali Acc: 0.746 Test Loss: 0.559 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.0631027221679688
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8041493892669678
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 2.5774614810943604
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.746 Test Loss: 0.669 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6240243911743164
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 10 cost time: 3.0261471271514893
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.741 Test Loss: 0.651 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3309216499328613
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2555041313171387
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.761 Test Loss: 0.674 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0288262367248535
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0132246017456055
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.5727791786193848
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.761 Test Loss: 0.696 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2714641094207764
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.746 Test Loss: 0.711 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.996556282043457
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.761 Test Loss: 0.702 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.727771759033203
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2460074424743652
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 911772
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9151883125305176
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9330222606658936
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.534 Vali Acc: 0.673 Test Loss: 0.534 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7888062000274658
Epoch: 3, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.523 Vali Acc: 0.741 Test Loss: 0.523 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.931847333908081
Epoch: 4, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.529 Vali Acc: 0.717 Test Loss: 0.529 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.806739330291748
Epoch: 5, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.574 Vali Acc: 0.707 Test Loss: 0.574 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6812984943389893
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.737 Test Loss: 0.651 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7079548835754395
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1170108318328857
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7908308506011963
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.732 Test Loss: 0.695 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1600522994995117
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.737 Test Loss: 0.698 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9028968811035156
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.737 Test Loss: 0.673 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.235640048980713
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.737 Test Loss: 0.707 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.258561372756958
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.732 Test Loss: 0.709 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 901532
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.56956148147583
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.2965755462646484
Epoch: 2, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.550 Vali Acc: 0.707 Test Loss: 0.550 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.267456531524658
Epoch: 3, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.571 Vali Acc: 0.698 Test Loss: 0.571 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.125194549560547
Epoch: 4, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.9472613334655762
Epoch: 5, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.576 Vali Acc: 0.756 Test Loss: 0.576 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.903430461883545
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1356289386749268
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9092464447021484
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.741 Test Loss: 0.646 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9619760513305664
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.732 Test Loss: 0.685 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7568647861480713
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9483404159545898
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.741 Test Loss: 0.691 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8520679473876953
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.741 Test Loss: 0.696 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9430007934570312
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.741 Test Loss: 0.701 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.055208444595337
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.732 Test Loss: 0.721 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9736781120300293
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.741 Test Loss: 0.722 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 893340
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.549511671066284
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.546 Vali Acc: 0.707 Test Loss: 0.546 Test Acc: 0.707
Validation loss decreased (inf --> -0.707312).  Saving model ...
Epoch: 2 cost time: 1.3279125690460205
Epoch: 2, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
Validation loss decreased (-0.707312 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.314436674118042
Epoch: 3, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.515 Vali Acc: 0.766 Test Loss: 0.515 Test Acc: 0.766
Validation loss decreased (-0.721946 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 1.3307220935821533
Epoch: 4, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.737 Test Loss: 0.508 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3165297508239746
Epoch: 5, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2909927368164062
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.183274507522583
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4738810062408447
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2360754013061523
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2763645648956299
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.761 Test Loss: 0.653 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2701482772827148
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.751 Test Loss: 0.674 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4571213722229004
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.231909990310669
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 889244
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.047956705093384
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.216425895690918
Epoch: 2, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.504 Vali Acc: 0.741 Test Loss: 0.504 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.004995346069336
Epoch: 3, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.2976188659667969
Epoch: 4, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1828436851501465
Epoch: 5, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2673406600952148
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9640111923217773
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1101446151733398
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.732 Test Loss: 0.655 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9627885818481445
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2788853645324707
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.746 Test Loss: 0.699 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2583799362182617
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.746 Test Loss: 0.695 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.122973918914795
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.741 Test Loss: 0.699 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0815260410308838
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.741 Test Loss: 0.712 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 885148
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7486276626586914
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.1858165264129639
Epoch: 2, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.504 Vali Acc: 0.732 Test Loss: 0.504 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.9245009422302246
Epoch: 3, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.508 Vali Acc: 0.751 Test Loss: 0.508 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 0.9926199913024902
Epoch: 4, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0852296352386475
Epoch: 5, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.589 Vali Acc: 0.751 Test Loss: 0.589 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1796660423278809
Epoch: 6, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9937238693237305
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0053114891052246
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.741 Test Loss: 0.676 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.079348087310791
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.751 Test Loss: 0.694 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0680100917816162
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.751 Test Loss: 0.727 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2808573246002197
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.746 Test Loss: 0.724 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2181086540222168
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.751 Test Loss: 0.731 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9976949691772461
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.751 Test Loss: 0.734 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 881052
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.829768419265747
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.7887911796569824
Epoch: 2, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.535 Vali Acc: 0.698 Test Loss: 0.535 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.177376985549927
Epoch: 3, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.504 Vali Acc: 0.732 Test Loss: 0.504 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.2616448402404785
Epoch: 4, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.326672315597534
Epoch: 5, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.115509033203125
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.181815147399902
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8392231464385986
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.737 Test Loss: 0.640 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.2615883350372314
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.751 Test Loss: 0.621 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 10 cost time: 4.052764892578125
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.741 Test Loss: 0.623 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.917574167251587
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9390549659729004
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.751 Test Loss: 0.657 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.100472927093506
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.756 Test Loss: 0.647 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756091).  Saving model ...
Epoch: 14 cost time: 4.623027086257935
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.187167406082153
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.751 Test Loss: 0.675 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.969468355178833
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.751 Test Loss: 0.673 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.904725551605225
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.751 Test Loss: 0.680 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.705632209777832
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.756 Test Loss: 0.677 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.206624984741211
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.033663749694824
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.9270899295806885
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.756 Test Loss: 0.700 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5579705238342285
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8066680431365967
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.756 Test Loss: 0.706 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 499414
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.310056209564209
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.5148603916168213
Epoch: 2, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.553 Vali Acc: 0.678 Test Loss: 0.553 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.277587890625
Epoch: 3, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.548 Vali Acc: 0.693 Test Loss: 0.548 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1131246089935303
Epoch: 4, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.590 Vali Acc: 0.668 Test Loss: 0.590 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2430362701416016
Epoch: 5, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 3.2555418014526367
Epoch: 6, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.716 Vali Acc: 0.746 Test Loss: 0.716 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746334).  Saving model ...
Epoch: 7 cost time: 3.416689872741699
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.619 Vali Acc: 0.732 Test Loss: 0.619 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2923758029937744
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.647 Vali Acc: 0.741 Test Loss: 0.647 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.181180953979492
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.664 Vali Acc: 0.732 Test Loss: 0.664 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0443527698516846
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.732 Test Loss: 0.688 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.908418655395508
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.727 Test Loss: 0.696 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0559070110321045
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.732 Test Loss: 0.711 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.164665699005127
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.727 Test Loss: 0.726 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6367251873016357
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.727 Test Loss: 0.724 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.4206573963165283
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.727 Test Loss: 0.734 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9101223945617676
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.727 Test Loss: 0.749 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 494294
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.507397651672363
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.555 Vali Acc: 0.746 Test Loss: 0.555 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 2.352264404296875
Epoch: 2, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.666 Vali Acc: 0.741 Test Loss: 0.666 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4688100814819336
Epoch: 3, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.580 Vali Acc: 0.693 Test Loss: 0.580 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.898620367050171
Epoch: 4, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.534 Vali Acc: 0.717 Test Loss: 0.534 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2385752201080322
Epoch: 5, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0699665546417236
Epoch: 6, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.689 Vali Acc: 0.771 Test Loss: 0.689 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770725).  Saving model ...
Epoch: 7 cost time: 3.1423888206481934
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.607 Vali Acc: 0.766 Test Loss: 0.607 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0996153354644775
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.771 Test Loss: 0.704 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5665512084960938
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.771 Test Loss: 0.702 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.967036008834839
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.766 Test Loss: 0.718 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.470525026321411
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.776 Test Loss: 0.738 Test Acc: 0.776
Validation loss decreased (-0.770725 --> -0.775602).  Saving model ...
Epoch: 12 cost time: 2.959021806716919
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.766 Test Loss: 0.732 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.270963668823242
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.771 Test Loss: 0.758 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.736712694168091
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.771 Test Loss: 0.774 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9485230445861816
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.771 Test Loss: 0.774 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0357308387756348
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.771 Test Loss: 0.783 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6722147464752197
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.771 Test Loss: 0.792 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8814823627471924
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.771 Test Loss: 0.798 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.027432918548584
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.771 Test Loss: 0.810 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.186483860015869
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.771 Test Loss: 0.816 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.87302827835083
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.766 Test Loss: 0.826 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 489174
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.617844820022583
Epoch: 1, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.2205593585968018
Epoch: 2, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.516 Vali Acc: 0.746 Test Loss: 0.516 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.252357006072998
Epoch: 3, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.508 Vali Acc: 0.732 Test Loss: 0.508 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0751376152038574
Epoch: 4, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.004214286804199
Epoch: 5, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8623466491699219
Epoch: 6, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.133192300796509
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.3434789180755615
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.027843475341797
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.027796745300293
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.644 Vali Acc: 0.741 Test Loss: 0.644 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7667968273162842
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.746 Test Loss: 0.655 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3535022735595703
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.746 Test Loss: 0.656 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8229756355285645
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.746 Test Loss: 0.668 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.079378604888916
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8935878276824951
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.746 Test Loss: 0.691 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9075424671173096
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.746 Test Loss: 0.691 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8926846981048584
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.746 Test Loss: 0.701 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 484054
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.567850351333618
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.6892354488372803
Epoch: 2, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.540 Vali Acc: 0.756 Test Loss: 0.540 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.5800654888153076
Epoch: 3, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.17219614982605
Epoch: 4, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7685203552246094
Epoch: 5, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5689783096313477
Epoch: 6, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7155952453613281
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.756 Test Loss: 0.659 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6803200244903564
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4293560981750488
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.873112440109253
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.672 Vali Acc: 0.751 Test Loss: 0.672 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6156260967254639
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8848085403442383
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.756 Test Loss: 0.717 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 479958
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7744781970977783
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.583 Vali Acc: 0.727 Test Loss: 0.583 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.1376831531524658
Epoch: 2, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.726823 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.3039650917053223
Epoch: 3, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.528 Vali Acc: 0.717 Test Loss: 0.528 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.380859136581421
Epoch: 4, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.538 Vali Acc: 0.780 Test Loss: 0.538 Test Acc: 0.780
Validation loss decreased (-0.756092 --> -0.780482).  Saving model ...
Epoch: 5 cost time: 1.3498692512512207
Epoch: 5, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2545583248138428
Epoch: 6, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.678 Vali Acc: 0.741 Test Loss: 0.678 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1187732219696045
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.766 Test Loss: 0.627 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3348348140716553
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.707 Vali Acc: 0.756 Test Loss: 0.707 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2872314453125
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.771 Test Loss: 0.693 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4174189567565918
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.686 Vali Acc: 0.771 Test Loss: 0.686 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1254324913024902
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.766 Test Loss: 0.711 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1112446784973145
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.766 Test Loss: 0.715 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2685656547546387
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.766 Test Loss: 0.724 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3956079483032227
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.771 Test Loss: 0.747 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 477910
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1284029483795166
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.3304479122161865
Epoch: 2, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.527 Vali Acc: 0.737 Test Loss: 0.527 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.1404645442962646
Epoch: 3, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.517 Vali Acc: 0.741 Test Loss: 0.517 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.2119650840759277
Epoch: 4, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.2268033027648926
Epoch: 5, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.556 Vali Acc: 0.761 Test Loss: 0.556 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.2055015563964844
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4308419227600098
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.756 Test Loss: 0.641 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.087498664855957
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2606773376464844
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1129825115203857
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2437958717346191
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3049957752227783
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.756 Test Loss: 0.675 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.636317253112793
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1950490474700928
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.751 Test Loss: 0.689 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2404472827911377
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.756 Test Loss: 0.705 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 475862
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.004211664199829
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.0686285495758057
Epoch: 2, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.134394884109497
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.158578872680664
Epoch: 4, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9097504615783691
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9409785270690918
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9686410427093506
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.638 Vali Acc: 0.737 Test Loss: 0.638 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9682347774505615
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1652591228485107
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.741 Test Loss: 0.685 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3569908142089844
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.746 Test Loss: 0.691 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1526577472686768
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.751 Test Loss: 0.693 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 12 cost time: 0.922313928604126
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.746 Test Loss: 0.716 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0239238739013672
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1943731307983398
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.746 Test Loss: 0.725 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8879783153533936
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.746 Test Loss: 0.739 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0696489810943604
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.746 Test Loss: 0.742 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0291261672973633
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9904298782348633
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.746 Test Loss: 0.758 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.209214687347412
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.746 Test Loss: 0.771 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.175370693206787
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.746 Test Loss: 0.774 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.097367525100708
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 473814
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.412779331207275
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.688693046569824
Epoch: 2, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.553 Vali Acc: 0.702 Test Loss: 0.553 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.768340826034546
Epoch: 3, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.529 Vali Acc: 0.717 Test Loss: 0.529 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.220134258270264
Epoch: 4, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.580 Vali Acc: 0.673 Test Loss: 0.580 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.545251846313477
Epoch: 5, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 3.8231422901153564
Epoch: 6, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 4.104215621948242
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 8 cost time: 3.474851131439209
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.751 Test Loss: 0.629 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 9 cost time: 4.535370588302612
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.653 Vali Acc: 0.751 Test Loss: 0.653 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.607297897338867
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756091).  Saving model ...
Epoch: 11 cost time: 4.1588428020477295
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.751 Test Loss: 0.669 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7751548290252686
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.751 Test Loss: 0.687 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9683713912963867
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.756 Test Loss: 0.683 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.8621227741241455
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8438360691070557
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.751 Test Loss: 0.708 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.4494643211364746
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.689351797103882
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.751 Test Loss: 0.730 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.368649482727051
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.751 Test Loss: 0.721 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.068533897399902
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.751 Test Loss: 0.725 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.514909982681274
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.751 Test Loss: 0.742 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 495478
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.5098371505737305
Epoch: 1, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.6759743690490723
Epoch: 2, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.498 Vali Acc: 0.756 Test Loss: 0.498 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756093).  Saving model ...
Epoch: 3 cost time: 3.8115549087524414
Epoch: 3, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9378814697265625
Epoch: 4, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.498 Vali Acc: 0.761 Test Loss: 0.498 Test Acc: 0.761
Validation loss decreased (-0.756093 --> -0.760971).  Saving model ...
Epoch: 5 cost time: 3.2785937786102295
Epoch: 5, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.533 Vali Acc: 0.771 Test Loss: 0.533 Test Acc: 0.771
Validation loss decreased (-0.760971 --> -0.770726).  Saving model ...
Epoch: 6 cost time: 3.2749462127685547
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.586 Vali Acc: 0.766 Test Loss: 0.586 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5783798694610596
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.550 Vali Acc: 0.732 Test Loss: 0.550 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.536496877670288
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.766 Test Loss: 0.662 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5322835445404053
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.334604263305664
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.744521141052246
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.746 Test Loss: 0.645 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5292136669158936
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.751 Test Loss: 0.628 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.630887031555176
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5082411766052246
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.3672935962677
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.746 Test Loss: 0.664 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 490358
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.189436912536621
Epoch: 1, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.663586378097534
Epoch: 2, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.514 Vali Acc: 0.746 Test Loss: 0.514 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.735670566558838
Epoch: 3, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.501 Vali Acc: 0.751 Test Loss: 0.501 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751215).  Saving model ...
Epoch: 4 cost time: 2.8542726039886475
Epoch: 4, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.591 Vali Acc: 0.688 Test Loss: 0.591 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7193386554718018
Epoch: 5, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.513 Vali Acc: 0.727 Test Loss: 0.513 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0485446453094482
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.973207473754883
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.766 Test Loss: 0.602 Test Acc: 0.766
Validation loss decreased (-0.751215 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 2.8137245178222656
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.751 Test Loss: 0.577 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8186261653900146
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9602508544921875
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.746 Test Loss: 0.626 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6041293144226074
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.751 Test Loss: 0.630 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.3541946411132812
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.751 Test Loss: 0.637 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.26012921333313
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.741 Test Loss: 0.636 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.082097053527832
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.751 Test Loss: 0.652 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8491477966308594
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.751 Test Loss: 0.665 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.295452356338501
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.544645071029663
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 485238
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.072437524795532
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.20676851272583
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.514 Vali Acc: 0.741 Test Loss: 0.514 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.688425302505493
Epoch: 3, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.536 Vali Acc: 0.702 Test Loss: 0.536 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4042813777923584
Epoch: 4, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.525 Vali Acc: 0.702 Test Loss: 0.525 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5452890396118164
Epoch: 5, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.1665871143341064
Epoch: 6, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.553 Vali Acc: 0.766 Test Loss: 0.553 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 2.3405165672302246
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.27962327003479
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.776 Test Loss: 0.622 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775604).  Saving model ...
Epoch: 9 cost time: 2.718208074569702
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.751 Test Loss: 0.619 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3907690048217773
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.771 Test Loss: 0.643 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.538454294204712
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.776 Test Loss: 0.660 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.359077215194702
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.766 Test Loss: 0.655 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.260615587234497
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.692 Vali Acc: 0.776 Test Loss: 0.692 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.379199266433716
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.780 Test Loss: 0.696 Test Acc: 0.780
Validation loss decreased (-0.775604 --> -0.780481).  Saving model ...
Epoch: 15 cost time: 2.1979501247406006
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.756 Test Loss: 0.684 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.13202166557312
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.776 Test Loss: 0.705 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2305212020874023
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.425025701522827
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.771 Test Loss: 0.721 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2618868350982666
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8661880493164062
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.776 Test Loss: 0.735 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3535592555999756
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.771 Test Loss: 0.749 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5255286693573
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.761 Test Loss: 0.736 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1239781379699707
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.761 Test Loss: 0.750 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2561299800872803
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 480118
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.479827404022217
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6235039234161377
Epoch: 2, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.534 Vali Acc: 0.702 Test Loss: 0.534 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6405251026153564
Epoch: 3, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.529 Vali Acc: 0.717 Test Loss: 0.529 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5813262462615967
Epoch: 4, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.0420236587524414
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.475245475769043
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4479541778564453
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5307438373565674
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4948399066925049
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5176048278808594
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4331316947937012
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9995362758636475
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.660 Vali Acc: 0.732 Test Loss: 0.660 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.621410846710205
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7032442092895508
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.737 Test Loss: 0.684 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 476022
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.672436237335205
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5125186443328857
Epoch: 2, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.6480867862701416
Epoch: 3, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.508 Vali Acc: 0.756 Test Loss: 0.508 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.2629523277282715
Epoch: 4, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.516 Vali Acc: 0.751 Test Loss: 0.516 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5387685298919678
Epoch: 5, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5396831035614014
Epoch: 6, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.677 Vali Acc: 0.741 Test Loss: 0.677 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4835140705108643
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5139553546905518
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.776 Test Loss: 0.678 Test Acc: 0.776
Validation loss decreased (-0.756092 --> -0.775603).  Saving model ...
Epoch: 9 cost time: 1.3372201919555664
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.776 Test Loss: 0.679 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.720463752746582
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.756 Test Loss: 0.669 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6926445960998535
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.776 Test Loss: 0.704 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4777061939239502
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.756 Test Loss: 0.694 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5277156829833984
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.766 Test Loss: 0.704 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4458191394805908
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.771 Test Loss: 0.722 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8122279644012451
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6378488540649414
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.766 Test Loss: 0.728 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4117894172668457
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.766 Test Loss: 0.738 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3854615688323975
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.761 Test Loss: 0.742 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 473974
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7232632637023926
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.199798822402954
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.204235315322876
Epoch: 3, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2312772274017334
Epoch: 4, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.531 Vali Acc: 0.712 Test Loss: 0.531 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2798659801483154
Epoch: 5, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.570 Vali Acc: 0.707 Test Loss: 0.570 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1860406398773193
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.602 Vali Acc: 0.702 Test Loss: 0.602 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.031860113143921
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.694 Vali Acc: 0.732 Test Loss: 0.694 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1155803203582764
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.117356538772583
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.756 Test Loss: 0.751 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756090).  Saving model ...
Epoch: 10 cost time: 1.0667552947998047
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.722 Test Loss: 0.685 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3043274879455566
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.185009479522705
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.737 Test Loss: 0.735 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1218714714050293
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2488648891448975
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.741 Test Loss: 0.749 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2911605834960938
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.351076602935791
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.741 Test Loss: 0.768 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4388964176177979
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.741 Test Loss: 0.782 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0784988403320312
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.741 Test Loss: 0.779 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3626060485839844
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 471926
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8623812198638916
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 0.8547401428222656
Epoch: 2, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.512 Vali Acc: 0.722 Test Loss: 0.512 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9066662788391113
Epoch: 3, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.519 Vali Acc: 0.732 Test Loss: 0.519 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 0.8426718711853027
Epoch: 4, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.522 Vali Acc: 0.751 Test Loss: 0.522 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 0.9412646293640137
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.1105527877807617
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9500653743743896
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.056769609451294
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9896512031555176
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.751 Test Loss: 0.637 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1841366291046143
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.741 Test Loss: 0.644 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0287489891052246
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.741 Test Loss: 0.647 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9258830547332764
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.972477912902832
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9190318584442139
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.929194450378418
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.751 Test Loss: 0.689 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 469878
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.359771013259888
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 3.9291388988494873
Epoch: 2, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.506 Vali Acc: 0.727 Test Loss: 0.506 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.5215675830841064
Epoch: 3, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.588 Vali Acc: 0.683 Test Loss: 0.588 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.364253044128418
Epoch: 4, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.513 Vali Acc: 0.698 Test Loss: 0.513 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5786311626434326
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.619 Vali Acc: 0.746 Test Loss: 0.619 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 3.292607069015503
Epoch: 6, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.534 Vali Acc: 0.712 Test Loss: 0.534 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6518797874450684
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.517045974731445
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.574 Vali Acc: 0.707 Test Loss: 0.574 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.199831485748291
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2745466232299805
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.495152235031128
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.727 Test Loss: 0.629 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4074952602386475
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9268908500671387
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.365415096282959
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.319883346557617
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.722 Test Loss: 0.655 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 493510
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.006186246871948
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 2.963334321975708
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.525 Vali Acc: 0.737 Test Loss: 0.525 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 3.513735294342041
Epoch: 3, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.539 Vali Acc: 0.693 Test Loss: 0.539 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2007274627685547
Epoch: 4, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.0694572925567627
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.525 Vali Acc: 0.741 Test Loss: 0.525 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 3.1327836513519287
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8883559703826904
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.566 Vali Acc: 0.751 Test Loss: 0.566 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.9107069969177246
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.732 Test Loss: 0.618 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.191030740737915
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9873712062835693
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0856242179870605
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7302775382995605
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.727 Test Loss: 0.678 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9474923610687256
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.534471273422241
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.727 Test Loss: 0.712 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9673092365264893
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9488162994384766
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.737 Test Loss: 0.703 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.704655647277832
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.732 Test Loss: 0.715 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 488390
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.70981502532959
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.547 Vali Acc: 0.712 Test Loss: 0.547 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 3.260307550430298
Epoch: 2, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.529 Vali Acc: 0.683 Test Loss: 0.529 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.28027081489563
Epoch: 3, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.574 Vali Acc: 0.702 Test Loss: 0.574 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8778128623962402
Epoch: 4, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.571 Vali Acc: 0.688 Test Loss: 0.571 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0482876300811768
Epoch: 5, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.549 Vali Acc: 0.717 Test Loss: 0.549 Test Acc: 0.717
Validation loss decreased (-0.712190 --> -0.717068).  Saving model ...
Epoch: 6 cost time: 3.409087896347046
Epoch: 6, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726824).  Saving model ...
Epoch: 7 cost time: 3.4597716331481934
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.894512176513672
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.602 Vali Acc: 0.707 Test Loss: 0.602 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0614802837371826
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2119815349578857
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.712 Test Loss: 0.625 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.963660478591919
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6041290760040283
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9551663398742676
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7452001571655273
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.760145664215088
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.14229679107666
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.707 Test Loss: 0.673 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 483270
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.501886367797852
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 2.7836294174194336
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.729573965072632
Epoch: 3, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.511 Vali Acc: 0.727 Test Loss: 0.511 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6094794273376465
Epoch: 4, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.538 Vali Acc: 0.717 Test Loss: 0.538 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3150055408477783
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.541283130645752
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4957098960876465
Epoch: 7, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.607 Vali Acc: 0.741 Test Loss: 0.607 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5884485244750977
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.747 Vali Acc: 0.727 Test Loss: 0.747 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.039607524871826
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.732 Test Loss: 0.648 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4632487297058105
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746334).  Saving model ...
Epoch: 11 cost time: 2.0751469135284424
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1956593990325928
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.727 Test Loss: 0.737 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1091508865356445
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.722 Test Loss: 0.747 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7566299438476562
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.737 Test Loss: 0.779 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6980693340301514
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.727 Test Loss: 0.764 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.579777956008911
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.727 Test Loss: 0.769 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.608868360519409
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.727 Test Loss: 0.806 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7630038261413574
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.727 Test Loss: 0.805 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.187573194503784
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.732 Test Loss: 0.803 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5917046070098877
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.727 Test Loss: 0.817 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 478150
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.524223566055298
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.131690263748169
Epoch: 2, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.517 Vali Acc: 0.741 Test Loss: 0.517 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.5603995323181152
Epoch: 3, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.629272699356079
Epoch: 4, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.559 Vali Acc: 0.683 Test Loss: 0.559 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8610951900482178
Epoch: 5, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.528 Vali Acc: 0.722 Test Loss: 0.528 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.735231876373291
Epoch: 6, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.499 Vali Acc: 0.761 Test Loss: 0.499 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760971).  Saving model ...
Epoch: 7 cost time: 2.1003403663635254
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.549 Vali Acc: 0.780 Test Loss: 0.549 Test Acc: 0.780
Validation loss decreased (-0.760971 --> -0.780482).  Saving model ...
Epoch: 8 cost time: 1.6893465518951416
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.785 Test Loss: 0.595 Test Acc: 0.785
Validation loss decreased (-0.780482 --> -0.785360).  Saving model ...
Epoch: 9 cost time: 1.745934247970581
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.572 Vali Acc: 0.790 Test Loss: 0.572 Test Acc: 0.790
Validation loss decreased (-0.785360 --> -0.790238).  Saving model ...
Epoch: 10 cost time: 1.6936347484588623
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6038217544555664
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.790 Test Loss: 0.595 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8252010345458984
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.776 Test Loss: 0.632 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.003370523452759
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.790 Test Loss: 0.626 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8833725452423096
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.780 Test Loss: 0.640 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2741103172302246
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.780 Test Loss: 0.650 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6956548690795898
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.790 Test Loss: 0.643 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6710355281829834
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.790 Test Loss: 0.645 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5748610496520996
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.776 Test Loss: 0.672 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8267369270324707
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.790 Test Loss: 0.655 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 474054
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.465733051300049
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.5434701442718506
Epoch: 2, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.3997039794921875
Epoch: 3, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.513 Vali Acc: 0.761 Test Loss: 0.513 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 1.3582096099853516
Epoch: 4, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3721027374267578
Epoch: 5, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.661 Vali Acc: 0.761 Test Loss: 0.661 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2937207221984863
Epoch: 6, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2382643222808838
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.576 Vali Acc: 0.756 Test Loss: 0.576 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7109243869781494
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.741 Test Loss: 0.639 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3931019306182861
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.555389642715454
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.659 Vali Acc: 0.732 Test Loss: 0.659 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.443058967590332
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8448143005371094
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2086853981018066
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.727 Test Loss: 0.695 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 472006
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5243923664093018
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.5481057167053223
Epoch: 2, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.2803733348846436
Epoch: 3, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.530 Vali Acc: 0.746 Test Loss: 0.530 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.2729730606079102
Epoch: 4, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5982818603515625
Epoch: 5, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.484450101852417
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5044267177581787
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.741 Test Loss: 0.657 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4766404628753662
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2436168193817139
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2889130115509033
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.741 Test Loss: 0.707 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.59332275390625
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.737 Test Loss: 0.712 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2440314292907715
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.741 Test Loss: 0.747 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.246070146560669
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.741 Test Loss: 0.746 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 469958
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.007876396179199
Epoch: 1, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.260176181793213
Epoch: 2, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.1766397953033447
Epoch: 3, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2100789546966553
Epoch: 4, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0369987487792969
Epoch: 5, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.559 Vali Acc: 0.712 Test Loss: 0.559 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6955008506774902
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0845637321472168
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.751 Test Loss: 0.742 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0924556255340576
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.732 Test Loss: 0.723 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.145941972732544
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.746 Test Loss: 0.751 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2887988090515137
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.746 Test Loss: 0.777 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2546708583831787
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.746 Test Loss: 0.771 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1996452808380127
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.741 Test Loss: 0.773 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 467910
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.370232343673706
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.931633234024048
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.101388931274414
Epoch: 3, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 3.8424243927001953
Epoch: 4, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.577 Vali Acc: 0.702 Test Loss: 0.577 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.727267265319824
Epoch: 5, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.541 Vali Acc: 0.746 Test Loss: 0.541 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.2424867153167725
Epoch: 6, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.201639890670776
Epoch: 7, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.634 Vali Acc: 0.688 Test Loss: 0.634 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7902348041534424
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.668 Vali Acc: 0.693 Test Loss: 0.668 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.644237995147705
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.654 Vali Acc: 0.727 Test Loss: 0.654 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.519769191741943
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.300503730773926
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.727 Test Loss: 0.688 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.984774351119995
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.722 Test Loss: 0.707 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9386372566223145
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.727 Test Loss: 0.723 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 492526
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.777507543563843
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.037760257720947
Epoch: 2, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 3.6083600521087646
Epoch: 3, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.553851366043091
Epoch: 4, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9376375675201416
Epoch: 5, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.515 Vali Acc: 0.727 Test Loss: 0.515 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.890204906463623
Epoch: 6, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.562 Vali Acc: 0.693 Test Loss: 0.562 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.445793390274048
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.558 Vali Acc: 0.712 Test Loss: 0.558 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2990334033966064
Epoch: 8, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.642 Vali Acc: 0.751 Test Loss: 0.642 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 9 cost time: 3.3221240043640137
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.761 Test Loss: 0.658 Test Acc: 0.761
Validation loss decreased (-0.751213 --> -0.760969).  Saving model ...
Epoch: 10 cost time: 3.7809929847717285
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.462284088134766
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.749767541885376
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.74196720123291
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.727 Test Loss: 0.655 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.047587633132935
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.782167434692383
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.905914783477783
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.732 Test Loss: 0.687 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.832752227783203
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.727 Test Loss: 0.686 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.849705934524536
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.732 Test Loss: 0.700 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.385995149612427
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 487406
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.329891204833984
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.558 Vali Acc: 0.722 Test Loss: 0.558 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.5069873332977295
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7852206230163574
Epoch: 3, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.588 Vali Acc: 0.644 Test Loss: 0.588 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.578556537628174
Epoch: 4, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.629 Vali Acc: 0.639 Test Loss: 0.629 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.782043695449829
Epoch: 5, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.578 Vali Acc: 0.678 Test Loss: 0.578 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4137351512908936
Epoch: 6, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.615 Vali Acc: 0.663 Test Loss: 0.615 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8310623168945312
Epoch: 7, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 2.7626383304595947
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0108368396759033
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3392210006713867
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1073851585388184
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.727 Test Loss: 0.648 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9160313606262207
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7890195846557617
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.683387041091919
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.722 Test Loss: 0.665 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9699978828430176
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.987938642501831
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.722 Test Loss: 0.688 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1060001850128174
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.690 Vali Acc: 0.722 Test Loss: 0.690 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 482286
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.999979019165039
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 2.3399951457977295
Epoch: 2, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.522 Vali Acc: 0.727 Test Loss: 0.522 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1473584175109863
Epoch: 3, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.619 Vali Acc: 0.620 Test Loss: 0.619 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5712177753448486
Epoch: 4, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.538 Vali Acc: 0.722 Test Loss: 0.538 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2303032875061035
Epoch: 5, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.545 Vali Acc: 0.732 Test Loss: 0.545 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 2.2326314449310303
Epoch: 6, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1749227046966553
Epoch: 7, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.624 Vali Acc: 0.683 Test Loss: 0.624 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2949459552764893
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.640 Vali Acc: 0.741 Test Loss: 0.640 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 9 cost time: 2.557408094406128
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.737 Vali Acc: 0.746 Test Loss: 0.737 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 10 cost time: 2.1857428550720215
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.737 Test Loss: 0.676 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.171968698501587
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.746 Test Loss: 0.724 Test Acc: 0.746
Validation loss decreased (-0.746334 --> -0.746334).  Saving model ...
Epoch: 12 cost time: 2.040463924407959
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.737 Test Loss: 0.727 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.308671236038208
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.741 Test Loss: 0.728 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4542479515075684
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.737 Test Loss: 0.752 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2492408752441406
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.737 Test Loss: 0.759 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3647656440734863
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.737 Test Loss: 0.765 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2397055625915527
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.737 Test Loss: 0.781 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.785720109939575
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.737 Test Loss: 0.785 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3666999340057373
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.737 Test Loss: 0.793 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.151449680328369
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.737 Test Loss: 0.800 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.124239444732666
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.737 Test Loss: 0.802 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 477166
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.126513242721558
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 2.1380362510681152
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.532 Vali Acc: 0.732 Test Loss: 0.532 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9507405757904053
Epoch: 3, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 2.1524548530578613
Epoch: 4, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6140413284301758
Epoch: 5, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.543 Vali Acc: 0.771 Test Loss: 0.543 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 6 cost time: 1.7754912376403809
Epoch: 6, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.559 Vali Acc: 0.741 Test Loss: 0.559 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9709179401397705
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0417206287384033
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.756 Test Loss: 0.575 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9389300346374512
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.204312324523926
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.761 Test Loss: 0.610 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.30586576461792
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.771 Test Loss: 0.619 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.993539810180664
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0408570766448975
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.771 Test Loss: 0.636 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7851507663726807
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.771 Test Loss: 0.663 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.959749698638916
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775603).  Saving model ...
Epoch: 16 cost time: 1.7995150089263916
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.771 Test Loss: 0.653 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9356484413146973
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.776 Test Loss: 0.680 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6295435428619385
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.771 Test Loss: 0.676 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7266347408294678
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.771 Test Loss: 0.684 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8238680362701416
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.771 Test Loss: 0.704 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9965252876281738
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.771 Test Loss: 0.710 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8007524013519287
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.776 Test Loss: 0.692 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7301373481750488
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.771 Test Loss: 0.706 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.316214084625244
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.766 Test Loss: 0.730 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0886759757995605
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.761 Test Loss: 0.727 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 473070
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8141138553619385
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.568 Vali Acc: 0.702 Test Loss: 0.568 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 1.2117104530334473
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.509 Vali Acc: 0.756 Test Loss: 0.509 Test Acc: 0.756
Validation loss decreased (-0.702433 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.154552698135376
Epoch: 3, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.562 Vali Acc: 0.654 Test Loss: 0.562 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1804721355438232
Epoch: 4, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.524 Vali Acc: 0.702 Test Loss: 0.524 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3082196712493896
Epoch: 5, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.599 Vali Acc: 0.644 Test Loss: 0.599 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.482414960861206
Epoch: 6, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.528 Vali Acc: 0.722 Test Loss: 0.528 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2362017631530762
Epoch: 7, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4043328762054443
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.251143217086792
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.545790672302246
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.741 Test Loss: 0.616 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4897725582122803
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3413584232330322
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.737 Test Loss: 0.640 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 471022
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.996516704559326
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 1.1555378437042236
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.182983636856079
Epoch: 3, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.514 Vali Acc: 0.746 Test Loss: 0.514 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.2837305068969727
Epoch: 4, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.498 Vali Acc: 0.756 Test Loss: 0.498 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756093).  Saving model ...
Epoch: 5 cost time: 1.3696346282958984
Epoch: 5, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.515 Vali Acc: 0.741 Test Loss: 0.515 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1968214511871338
Epoch: 6, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.119086742401123
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.108156681060791
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.607 Vali Acc: 0.766 Test Loss: 0.607 Test Acc: 0.766
Validation loss decreased (-0.756093 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 1.3259532451629639
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2477688789367676
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.756 Test Loss: 0.650 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.328843593597412
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1312267780303955
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775603).  Saving model ...
Epoch: 13 cost time: 1.0495047569274902
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.776 Test Loss: 0.673 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1240417957305908
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.776 Test Loss: 0.683 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0315101146697998
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.771 Test Loss: 0.684 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0897271633148193
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.776 Test Loss: 0.700 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1281049251556396
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.771 Test Loss: 0.706 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0844416618347168
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.771 Test Loss: 0.718 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0358335971832275
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.776 Test Loss: 0.731 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0384442806243896
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.771 Test Loss: 0.725 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0430519580841064
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.771 Test Loss: 0.740 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0959348678588867
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.771 Test Loss: 0.746 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 468974
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.5699055194854736
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 0.8151693344116211
Epoch: 2, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.8959217071533203
Epoch: 3, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8774704933166504
Epoch: 4, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.913759708404541
Epoch: 5, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.634 Vali Acc: 0.639 Test Loss: 0.634 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9781172275543213
Epoch: 6, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.584 Vali Acc: 0.727 Test Loss: 0.584 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9405744075775146
Epoch: 7, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9319040775299072
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.732 Test Loss: 0.691 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0266609191894531
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.751 Test Loss: 0.716 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 10 cost time: 0.9228525161743164
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.732 Test Loss: 0.722 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9832684993743896
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.741 Test Loss: 0.764 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8974132537841797
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.741 Test Loss: 0.770 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0304386615753174
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.737 Test Loss: 0.782 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0226967334747314
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.737 Test Loss: 0.793 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0062472820281982
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.737 Test Loss: 0.809 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9942023754119873
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.737 Test Loss: 0.812 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9383203983306885
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.737 Test Loss: 0.822 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0958285331726074
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.737 Test Loss: 0.829 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0007288455963135
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.737 Test Loss: 0.835 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 466926
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.54445743560791
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.361191749572754
Epoch: 2, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 3.70737624168396
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.553 Vali Acc: 0.698 Test Loss: 0.553 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6915736198425293
Epoch: 4, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.603 Vali Acc: 0.673 Test Loss: 0.603 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9411869049072266
Epoch: 5, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.515 Vali Acc: 0.746 Test Loss: 0.515 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4699878692626953
Epoch: 6, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.517 Vali Acc: 0.732 Test Loss: 0.517 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8815858364105225
Epoch: 7, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.969938039779663
Epoch: 8, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.829735517501831
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7485766410827637
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.959000825881958
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.023154020309448
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.712 Test Loss: 0.616 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 492034
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.647151231765747
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.5722832679748535
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.270128011703491
Epoch: 3, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 2.9672818183898926
Epoch: 4, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 3.027777910232544
Epoch: 5, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0742814540863037
Epoch: 6, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.578 Vali Acc: 0.751 Test Loss: 0.578 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.277611255645752
Epoch: 7, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.582 Vali Acc: 0.771 Test Loss: 0.582 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770726).  Saving model ...
Epoch: 8 cost time: 3.1219253540039062
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.709 Vali Acc: 0.737 Test Loss: 0.709 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6828160285949707
Epoch: 9, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.615 Vali Acc: 0.766 Test Loss: 0.615 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.180694818496704
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.553217887878418
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.699 Vali Acc: 0.780 Test Loss: 0.699 Test Acc: 0.780
Validation loss decreased (-0.770726 --> -0.780481).  Saving model ...
Epoch: 12 cost time: 3.8573930263519287
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.766 Test Loss: 0.654 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0980985164642334
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.605355978012085
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.776 Test Loss: 0.680 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.676684856414795
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.776 Test Loss: 0.716 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.938138961791992
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.780 Test Loss: 0.699 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2251532077789307
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.776 Test Loss: 0.726 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2716658115386963
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.776 Test Loss: 0.742 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.296095609664917
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.780 Test Loss: 0.746 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.279184341430664
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.780 Test Loss: 0.756 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9366841316223145
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.780 Test Loss: 0.750 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 486914
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.63798451423645
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.4710779190063477
Epoch: 2, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6515674591064453
Epoch: 3, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.937335968017578
Epoch: 4, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0068752765655518
Epoch: 5, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.589 Vali Acc: 0.683 Test Loss: 0.589 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5164783000946045
Epoch: 6, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.598 Vali Acc: 0.712 Test Loss: 0.598 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6673269271850586
Epoch: 7, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.623 Vali Acc: 0.702 Test Loss: 0.623 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5670485496520996
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.648 Vali Acc: 0.717 Test Loss: 0.648 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7052531242370605
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.722 Test Loss: 0.674 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.600933790206909
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.707 Test Loss: 0.673 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.749225378036499
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.707 Test Loss: 0.696 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3042664527893066
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.702 Test Loss: 0.702 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7031736373901367
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.707 Test Loss: 0.712 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 481794
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.4584949016571045
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.9108080863952637
Epoch: 2, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 2.258471965789795
Epoch: 3, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
Validation loss decreased (-0.726823 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 2.041611433029175
Epoch: 4, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.516 Vali Acc: 0.722 Test Loss: 0.516 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.026596784591675
Epoch: 5, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.033438205718994
Epoch: 6, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.076939582824707
Epoch: 7, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1549978256225586
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3592708110809326
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.724 Vali Acc: 0.737 Test Loss: 0.724 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.17608380317688
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8774399757385254
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2446696758270264
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.762 Vali Acc: 0.722 Test Loss: 0.762 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0351829528808594
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.788 Vali Acc: 0.722 Test Loss: 0.788 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 476674
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3184633255004883
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.664043664932251
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.543 Vali Acc: 0.712 Test Loss: 0.543 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7561867237091064
Epoch: 3, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.515 Vali Acc: 0.732 Test Loss: 0.515 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.7462782859802246
Epoch: 4, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7861592769622803
Epoch: 5, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9638376235961914
Epoch: 6, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.525 Vali Acc: 0.741 Test Loss: 0.525 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.6764256954193115
Epoch: 7, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.668 Vali Acc: 0.756 Test Loss: 0.668 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 1.8402152061462402
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.685 Vali Acc: 0.756 Test Loss: 0.685 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1386282444000244
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9096338748931885
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.637 Vali Acc: 0.707 Test Loss: 0.637 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0828826427459717
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.732 Test Loss: 0.667 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8494055271148682
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.717 Test Loss: 0.667 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.747452974319458
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8599944114685059
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.722 Test Loss: 0.688 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7010021209716797
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.727 Test Loss: 0.704 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9761786460876465
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.722 Test Loss: 0.708 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8919613361358643
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.712 Test Loss: 0.708 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 472578
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1233839988708496
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.544 Vali Acc: 0.722 Test Loss: 0.544 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.8083090782165527
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.8116226196289062
Epoch: 3, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 1.5663280487060547
Epoch: 4, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9323227405548096
Epoch: 5, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.926201343536377
Epoch: 6, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7773404121398926
Epoch: 7, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7183258533477783
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.651 Vali Acc: 0.727 Test Loss: 0.651 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5835976600646973
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.732 Test Loss: 0.639 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9876573085784912
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.708 Vali Acc: 0.717 Test Loss: 0.708 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7696280479431152
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8401494026184082
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.727 Test Loss: 0.716 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.407461643218994
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 470530
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5141711235046387
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.1375846862792969
Epoch: 2, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.509 Vali Acc: 0.746 Test Loss: 0.509 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.1544930934906006
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.789 Vali Acc: 0.712 Test Loss: 0.789 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2240452766418457
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.673 Vali Acc: 0.727 Test Loss: 0.673 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1861705780029297
Epoch: 5, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.559 Vali Acc: 0.678 Test Loss: 0.559 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2807257175445557
Epoch: 6, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.500 Vali Acc: 0.751 Test Loss: 0.500 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751215).  Saving model ...
Epoch: 7 cost time: 1.1382672786712646
Epoch: 7, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2070817947387695
Epoch: 8, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.663 Vali Acc: 0.766 Test Loss: 0.663 Test Acc: 0.766
Validation loss decreased (-0.751215 --> -0.765847).  Saving model ...
Epoch: 9 cost time: 1.2371306419372559
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4730644226074219
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.295482873916626
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3808925151824951
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.741 Test Loss: 0.645 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3726060390472412
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.751 Test Loss: 0.676 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.168623924255371
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.751 Test Loss: 0.684 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1671090126037598
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.751 Test Loss: 0.679 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3634867668151855
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.751 Test Loss: 0.705 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3630445003509521
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5316050052642822
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.751 Test Loss: 0.709 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 468482
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9753174781799316
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.559 Vali Acc: 0.712 Test Loss: 0.559 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 1.1596190929412842
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
Validation loss decreased (-0.712190 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.2534821033477783
Epoch: 3, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2084767818450928
Epoch: 4, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.492311954498291
Epoch: 5, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0085580348968506
Epoch: 6, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5178544521331787
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.612 Vali Acc: 0.727 Test Loss: 0.612 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1537754535675049
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.676 Vali Acc: 0.727 Test Loss: 0.676 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1664631366729736
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741456).  Saving model ...
Epoch: 10 cost time: 0.9505236148834229
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.732 Test Loss: 0.766 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3614180088043213
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.722 Test Loss: 0.765 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.254065752029419
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.732 Test Loss: 0.820 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0292606353759766
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0240700244903564
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.722 Test Loss: 0.834 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.106773853302002
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.727 Test Loss: 0.863 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2370905876159668
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.727 Test Loss: 0.854 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9762265682220459
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.727 Test Loss: 0.877 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2930850982666016
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.727 Test Loss: 0.885 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1824076175689697
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.727 Test Loss: 0.900 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 466434
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.79367470741272
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.7023162841796875
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.524 Vali Acc: 0.722 Test Loss: 0.524 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.165494203567505
Epoch: 3, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.513 Vali Acc: 0.727 Test Loss: 0.513 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.075666666030884
Epoch: 4, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.505 Vali Acc: 0.727 Test Loss: 0.505 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 3.6882846355438232
Epoch: 5, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 3.658365488052368
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.688123464584351
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.721052646636963
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.470866918563843
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.562855958938599
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.741 Test Loss: 0.593 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.746549844741821
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.732 Test Loss: 0.636 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.625749588012695
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.751 Test Loss: 0.630 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.482505798339844
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.751 Test Loss: 0.637 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.657674551010132
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.746 Test Loss: 0.651 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.9729793071746826
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.746 Test Loss: 0.647 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 491420
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.894836902618408
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 3.3293561935424805
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.512 Vali Acc: 0.751 Test Loss: 0.512 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 3.2703819274902344
Epoch: 3, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.514 Vali Acc: 0.741 Test Loss: 0.514 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.763995409011841
Epoch: 4, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7264914512634277
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.590 Vali Acc: 0.766 Test Loss: 0.590 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 3.5576910972595215
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.756 Test Loss: 0.565 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.556811571121216
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.756 Test Loss: 0.593 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5956878662109375
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.756 Test Loss: 0.589 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6932144165039062
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.766 Test Loss: 0.633 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4853086471557617
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.761 Test Loss: 0.621 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.887685537338257
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.761 Test Loss: 0.649 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.134453058242798
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.766 Test Loss: 0.645 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.054947376251221
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.766 Test Loss: 0.651 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.557122468948364
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.766 Test Loss: 0.669 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.1516499519348145
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.766 Test Loss: 0.670 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 486300
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.76729416847229
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.629502058029175
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.562 Vali Acc: 0.678 Test Loss: 0.562 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6340270042419434
Epoch: 3, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.524 Vali Acc: 0.732 Test Loss: 0.524 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.5051138401031494
Epoch: 4, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.546 Vali Acc: 0.746 Test Loss: 0.546 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.5597546100616455
Epoch: 5, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3550007343292236
Epoch: 6, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7303130626678467
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.737 Test Loss: 0.743 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.373509407043457
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2365548610687256
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.751 Test Loss: 0.706 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 10 cost time: 2.586296796798706
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.741 Test Loss: 0.697 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2095675468444824
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.590583324432373
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.746 Test Loss: 0.722 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5831401348114014
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.746 Test Loss: 0.731 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4299068450927734
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.751 Test Loss: 0.732 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3218255043029785
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.751 Test Loss: 0.737 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.32120418548584
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.751 Test Loss: 0.749 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.213810920715332
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.751 Test Loss: 0.762 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.031012773513794
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.751 Test Loss: 0.764 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6040828227996826
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.746 Test Loss: 0.773 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 481180
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3215997219085693
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.6428945064544678
Epoch: 2, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.523 Vali Acc: 0.712 Test Loss: 0.523 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8666048049926758
Epoch: 3, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.536 Vali Acc: 0.707 Test Loss: 0.536 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.857407569885254
Epoch: 4, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.677 Vali Acc: 0.727 Test Loss: 0.677 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1612751483917236
Epoch: 5, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 1.969592571258545
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.916895866394043
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6073229312896729
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.732 Test Loss: 0.662 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.725113868713379
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.737 Test Loss: 0.651 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1797521114349365
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9025957584381104
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0878260135650635
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8980703353881836
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8334639072418213
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.732 Test Loss: 0.708 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8688757419586182
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.732 Test Loss: 0.721 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 476060
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.495149612426758
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3459630012512207
Epoch: 2, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.566 Vali Acc: 0.673 Test Loss: 0.566 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6578235626220703
Epoch: 3, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.7808210849761963
Epoch: 4, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.530 Vali Acc: 0.737 Test Loss: 0.530 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5376217365264893
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.726243019104004
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.554 Vali Acc: 0.751 Test Loss: 0.554 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.8566765785217285
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.722 Test Loss: 0.668 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5553536415100098
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.732 Test Loss: 0.651 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.013495445251465
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5157678127288818
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.690 Vali Acc: 0.717 Test Loss: 0.690 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0931129455566406
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8493804931640625
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.727 Test Loss: 0.686 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6544215679168701
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.727 Test Loss: 0.706 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7856905460357666
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.727 Test Loss: 0.708 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5215938091278076
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.727 Test Loss: 0.714 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.539562702178955
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.727 Test Loss: 0.720 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 471964
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2696051597595215
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.3811511993408203
Epoch: 2, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.510 Vali Acc: 0.751 Test Loss: 0.510 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.527541160583496
Epoch: 3, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.498 Vali Acc: 0.727 Test Loss: 0.498 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.799966812133789
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.505 Vali Acc: 0.751 Test Loss: 0.505 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.7822787761688232
Epoch: 5, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7814955711364746
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.771 Test Loss: 0.552 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 1.509056806564331
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.756 Test Loss: 0.606 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6520600318908691
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775604).  Saving model ...
Epoch: 9 cost time: 1.762979507446289
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.785 Test Loss: 0.607 Test Acc: 0.785
Validation loss decreased (-0.775604 --> -0.785360).  Saving model ...
Epoch: 10 cost time: 1.4962377548217773
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.780 Test Loss: 0.619 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9501924514770508
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.780 Test Loss: 0.622 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8171920776367188
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.771 Test Loss: 0.637 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7977945804595947
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2649927139282227
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.776 Test Loss: 0.653 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3427436351776123
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.771 Test Loss: 0.660 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6696574687957764
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.771 Test Loss: 0.675 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6160895824432373
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.776 Test Loss: 0.674 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2916786670684814
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2802705764770508
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.780 Test Loss: 0.671 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 469916
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1142759323120117
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 1.3145461082458496
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
Validation loss decreased (-0.717068 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.3495268821716309
Epoch: 3, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.506 Vali Acc: 0.766 Test Loss: 0.506 Test Acc: 0.766
Validation loss decreased (-0.731702 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 1.0677540302276611
Epoch: 4, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.514 Vali Acc: 0.771 Test Loss: 0.514 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770727).  Saving model ...
Epoch: 5 cost time: 0.9266023635864258
Epoch: 5, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.667 Vali Acc: 0.741 Test Loss: 0.667 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0983126163482666
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.552 Vali Acc: 0.766 Test Loss: 0.552 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1286227703094482
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.761 Test Loss: 0.617 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.828632116317749
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.662 Vali Acc: 0.756 Test Loss: 0.662 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9734199047088623
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.766 Test Loss: 0.623 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0816328525543213
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.761 Test Loss: 0.654 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5694832801818848
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.350261926651001
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.766 Test Loss: 0.671 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1733708381652832
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.761 Test Loss: 0.669 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3103208541870117
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.761 Test Loss: 0.679 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 467868
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9079604148864746
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1202666759490967
Epoch: 2, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.528 Vali Acc: 0.732 Test Loss: 0.528 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.8874483108520508
Epoch: 3, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1257846355438232
Epoch: 4, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 1.0598726272583008
Epoch: 5, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.112360954284668
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3441987037658691
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.04585862159729
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.737 Test Loss: 0.685 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2151639461517334
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.741 Test Loss: 0.728 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9230954647064209
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.751 Test Loss: 0.754 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0055427551269531
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.751 Test Loss: 0.743 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2229876518249512
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.746 Test Loss: 0.742 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0977442264556885
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.741 Test Loss: 0.755 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2427706718444824
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756090).  Saving model ...
Epoch: 15 cost time: 0.9108781814575195
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.746 Test Loss: 0.776 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8372855186462402
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.741 Test Loss: 0.782 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8374645709991455
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.746 Test Loss: 0.787 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8947110176086426
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.746 Test Loss: 0.801 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8633251190185547
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.746 Test Loss: 0.809 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7302370071411133
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8630924224853516
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0445914268493652
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.746 Test Loss: 0.825 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9783813953399658
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.746 Test Loss: 0.827 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8100981712341309
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 465820
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.663473844528198
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 4.7272069454193115
Epoch: 2, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.528 Vali Acc: 0.741 Test Loss: 0.528 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 4.078251123428345
Epoch: 3, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.516 Vali Acc: 0.737 Test Loss: 0.516 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.0067055225372314
Epoch: 4, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 4.545589208602905
Epoch: 5, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.738322973251343
Epoch: 6, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 7 cost time: 4.248610258102417
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.643293619155884
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.633 Vali Acc: 0.751 Test Loss: 0.633 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.133348226547241
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.235165596008301
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.663 Vali Acc: 0.751 Test Loss: 0.663 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.366236209869385
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.672 Vali Acc: 0.751 Test Loss: 0.672 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.291290760040283
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.751 Test Loss: 0.675 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.401381254196167
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.690 Vali Acc: 0.751 Test Loss: 0.690 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.360580921173096
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.751 Test Loss: 0.699 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.339541673660278
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.751 Test Loss: 0.704 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.876993179321289
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 278998
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.104190826416016
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.525 Vali Acc: 0.732 Test Loss: 0.525 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 3.9113099575042725
Epoch: 2, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.496 Vali Acc: 0.771 Test Loss: 0.496 Test Acc: 0.771
Validation loss decreased (-0.731702 --> -0.770727).  Saving model ...
Epoch: 3 cost time: 4.304171800613403
Epoch: 3, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.491 Vali Acc: 0.751 Test Loss: 0.491 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.978313684463501
Epoch: 4, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.174797534942627
Epoch: 5, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.422511100769043
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.23209810256958
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.207040309906006
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.585 Vali Acc: 0.756 Test Loss: 0.585 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2596559524536133
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.756 Test Loss: 0.601 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.5846245288848877
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.29999566078186
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.847641706466675
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 276438
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.114721059799194
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.537 Vali Acc: 0.727 Test Loss: 0.537 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.6291821002960205
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.518 Vali Acc: 0.766 Test Loss: 0.518 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 2.536975145339966
Epoch: 3, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.498 Vali Acc: 0.751 Test Loss: 0.498 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2377772331237793
Epoch: 4, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.495 Vali Acc: 0.751 Test Loss: 0.495 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4611356258392334
Epoch: 5, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.528 Vali Acc: 0.727 Test Loss: 0.528 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.44215989112854
Epoch: 6, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.133838653564453
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.577 Vali Acc: 0.761 Test Loss: 0.577 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2770421504974365
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.219447374343872
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.643949508666992
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.600275993347168
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1405346393585205
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.751 Test Loss: 0.623 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 273878
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.803409576416016
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.549 Vali Acc: 0.751 Test Loss: 0.549 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 2.6689612865448
Epoch: 2, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.557 Vali Acc: 0.766 Test Loss: 0.557 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 2.803352117538452
Epoch: 3, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.568 Vali Acc: 0.673 Test Loss: 0.568 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.714303493499756
Epoch: 4, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.546 Vali Acc: 0.707 Test Loss: 0.546 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.330230236053467
Epoch: 5, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.017408847808838
Epoch: 6, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.687 Vali Acc: 0.766 Test Loss: 0.687 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9704780578613281
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4087278842926025
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.690 Vali Acc: 0.771 Test Loss: 0.690 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770725).  Saving model ...
Epoch: 9 cost time: 2.765207290649414
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.426823616027832
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0486702919006348
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1996006965637207
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.677 Vali Acc: 0.737 Test Loss: 0.677 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2628378868103027
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1065783500671387
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.741 Test Loss: 0.717 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9429960250854492
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.737 Test Loss: 0.715 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.007270574569702
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.737 Test Loss: 0.716 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5516436100006104
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.741 Test Loss: 0.740 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.586461305618286
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.741 Test Loss: 0.745 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 271318
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8012895584106445
Epoch: 1, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8865115642547607
Epoch: 2, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.535 Vali Acc: 0.702 Test Loss: 0.535 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.298457622528076
Epoch: 3, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.535 Vali Acc: 0.717 Test Loss: 0.535 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9646058082580566
Epoch: 4, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.544 Vali Acc: 0.707 Test Loss: 0.544 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6499993801116943
Epoch: 5, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.575 Vali Acc: 0.698 Test Loss: 0.575 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2794108390808105
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.9770615100860596
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.622 Vali Acc: 0.751 Test Loss: 0.622 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7536742687225342
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.751 Test Loss: 0.636 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8398146629333496
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.651 Vali Acc: 0.746 Test Loss: 0.651 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.749528408050537
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.042529344558716
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.097351551055908
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.751 Test Loss: 0.694 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.044201374053955
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.751 Test Loss: 0.683 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.369645833969116
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.746 Test Loss: 0.706 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5639009475708008
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.746 Test Loss: 0.716 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.816885232925415
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.746 Test Loss: 0.717 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 269270
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3252413272857666
Epoch: 1, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.5360114574432373
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.510 Vali Acc: 0.732 Test Loss: 0.510 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.3996713161468506
Epoch: 3, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.497 Vali Acc: 0.737 Test Loss: 0.497 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.4498634338378906
Epoch: 4, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.504 Vali Acc: 0.756 Test Loss: 0.504 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756093).  Saving model ...
Epoch: 5 cost time: 1.4224717617034912
Epoch: 5, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4831981658935547
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.540 Vali Acc: 0.756 Test Loss: 0.540 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2635118961334229
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
Validation loss decreased (-0.756093 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 1.4845869541168213
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9658145904541016
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6910383701324463
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.128185510635376
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.756 Test Loss: 0.646 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.815826654434204
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.756 Test Loss: 0.644 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6228396892547607
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6729979515075684
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.677 Vali Acc: 0.761 Test Loss: 0.677 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4819157123565674
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.751 Test Loss: 0.675 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4919157028198242
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.761 Test Loss: 0.684 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4766533374786377
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.690 Vali Acc: 0.756 Test Loss: 0.690 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 268246
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0693867206573486
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.1949050426483154
Epoch: 2, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.530 Vali Acc: 0.717 Test Loss: 0.530 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4097716808319092
Epoch: 3, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.538 Vali Acc: 0.707 Test Loss: 0.538 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1293764114379883
Epoch: 4, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.489 Vali Acc: 0.746 Test Loss: 0.489 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746337).  Saving model ...
Epoch: 5 cost time: 1.119809865951538
Epoch: 5, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.514 Vali Acc: 0.751 Test Loss: 0.514 Test Acc: 0.751
Validation loss decreased (-0.746337 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.1231703758239746
Epoch: 6, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1753971576690674
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2725305557250977
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.766 Test Loss: 0.565 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 1.1047816276550293
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775604).  Saving model ...
Epoch: 10 cost time: 1.401418924331665
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0686240196228027
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1528630256652832
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3411874771118164
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1560206413269043
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3425307273864746
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.766 Test Loss: 0.628 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1955609321594238
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5359623432159424
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2207465171813965
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.761 Test Loss: 0.639 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.239051342010498
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 267222
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.481003522872925
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 1.0129215717315674
Epoch: 2, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2132039070129395
Epoch: 3, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.526 Vali Acc: 0.727 Test Loss: 0.526 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2012405395507812
Epoch: 4, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0172443389892578
Epoch: 5, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0664453506469727
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.614 Vali Acc: 0.727 Test Loss: 0.614 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0005295276641846
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.188788890838623
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0235676765441895
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.638 Vali Acc: 0.741 Test Loss: 0.638 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8549575805664062
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.741 Test Loss: 0.659 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2091357707977295
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.741 Test Loss: 0.662 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 266198
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.422495365142822
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.542 Vali Acc: 0.722 Test Loss: 0.542 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.8318333625793457
Epoch: 2, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.513 Vali Acc: 0.737 Test Loss: 0.513 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 3.7005982398986816
Epoch: 3, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.552 Vali Acc: 0.688 Test Loss: 0.552 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.074624538421631
Epoch: 4, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.858879327774048
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.533 Vali Acc: 0.771 Test Loss: 0.533 Test Acc: 0.771
Validation loss decreased (-0.741458 --> -0.770726).  Saving model ...
Epoch: 6 cost time: 3.748474359512329
Epoch: 6, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.578 Vali Acc: 0.766 Test Loss: 0.578 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8919835090637207
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.587 Vali Acc: 0.766 Test Loss: 0.587 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.507058620452881
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.600 Vali Acc: 0.771 Test Loss: 0.600 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8626482486724854
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.771 Test Loss: 0.636 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.362360954284668
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.641 Vali Acc: 0.771 Test Loss: 0.641 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.634864807128906
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.677 Vali Acc: 0.766 Test Loss: 0.677 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.206145763397217
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.771 Test Loss: 0.668 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.8803257942199707
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.766 Test Loss: 0.682 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.0164549350738525
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.771 Test Loss: 0.696 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.427328586578369
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.766 Test Loss: 0.696 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 275062
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.9549407958984375
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.856945276260376
Epoch: 2, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.093407869338989
Epoch: 3, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.4289796352386475
Epoch: 4, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.145125389099121
Epoch: 5, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 3.8189122676849365
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 7 cost time: 4.749572992324829
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.884935140609741
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6421239376068115
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9718234539031982
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.471698045730591
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.266944169998169
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.751 Test Loss: 0.713 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.724369764328003
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.751 Test Loss: 0.708 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7468514442443848
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.751 Test Loss: 0.723 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.261512279510498
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.751 Test Loss: 0.734 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.504974603652954
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.751 Test Loss: 0.742 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 272502
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9467639923095703
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 2.8287360668182373
Epoch: 2, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.503 Vali Acc: 0.737 Test Loss: 0.503 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4589335918426514
Epoch: 3, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.499 Vali Acc: 0.771 Test Loss: 0.499 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770727).  Saving model ...
Epoch: 4 cost time: 2.524275302886963
Epoch: 4, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6241097450256348
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.538 Vali Acc: 0.771 Test Loss: 0.538 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4437062740325928
Epoch: 6, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3550941944122314
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.536 Vali Acc: 0.761 Test Loss: 0.536 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.630950927734375
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.625 Vali Acc: 0.771 Test Loss: 0.625 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0753376483917236
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0188708305358887
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.627 Vali Acc: 0.766 Test Loss: 0.627 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.477020025253296
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.620 Vali Acc: 0.761 Test Loss: 0.620 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.643399953842163
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.766 Test Loss: 0.661 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7518346309661865
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.756 Test Loss: 0.636 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 269942
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.249932050704956
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.581 Vali Acc: 0.712 Test Loss: 0.581 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.4966752529144287
Epoch: 2, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.533 Vali Acc: 0.693 Test Loss: 0.533 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.129274368286133
Epoch: 3, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.543 Vali Acc: 0.707 Test Loss: 0.543 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4210097789764404
Epoch: 4, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.3550171852111816
Epoch: 5, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5737547874450684
Epoch: 6, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4830331802368164
Epoch: 7, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5245954990386963
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7889411449432373
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.741 Test Loss: 0.652 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.498384714126587
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.734302043914795
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.751 Test Loss: 0.660 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 12 cost time: 2.641781806945801
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.673 Vali Acc: 0.751 Test Loss: 0.673 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4628708362579346
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.741 Test Loss: 0.665 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5988895893096924
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756091).  Saving model ...
Epoch: 15 cost time: 2.602902889251709
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.618718147277832
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.751 Test Loss: 0.700 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1398699283599854
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.741 Test Loss: 0.701 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1032655239105225
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.741 Test Loss: 0.701 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2013256549835205
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5945169925689697
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.741 Test Loss: 0.719 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6311373710632324
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.741 Test Loss: 0.730 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.169156312942505
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.741 Test Loss: 0.734 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9411964416503906
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.741 Test Loss: 0.741 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6948935985565186
Epoch: 24, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.741 Test Loss: 0.739 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 267382
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.473764657974243
Epoch: 1, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7242155075073242
Epoch: 2, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.532 Vali Acc: 0.732 Test Loss: 0.532 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.4462831020355225
Epoch: 3, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6928696632385254
Epoch: 4, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.621028184890747
Epoch: 5, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.790001630783081
Epoch: 6, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5990662574768066
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 1.5392487049102783
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.700 Vali Acc: 0.727 Test Loss: 0.700 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3679320812225342
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4213056564331055
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.732 Test Loss: 0.715 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4497613906860352
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5104260444641113
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.737 Test Loss: 0.725 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7923731803894043
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5760891437530518
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.732 Test Loss: 0.743 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5521020889282227
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.732 Test Loss: 0.760 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.636643409729004
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.732 Test Loss: 0.773 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4434170722961426
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.732 Test Loss: 0.775 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 265334
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.96549916267395
Epoch: 1, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.565 Vali Acc: 0.722 Test Loss: 0.565 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.3365988731384277
Epoch: 2, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.1651251316070557
Epoch: 3, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.528691291809082
Epoch: 4, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.4048664569854736
Epoch: 5, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.665 Vali Acc: 0.644 Test Loss: 0.665 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.605729103088379
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.501600980758667
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5684115886688232
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.638 Vali Acc: 0.761 Test Loss: 0.638 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760969).  Saving model ...
Epoch: 9 cost time: 1.3281071186065674
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7847084999084473
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.756 Test Loss: 0.693 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2527506351470947
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.756 Test Loss: 0.713 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3354151248931885
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.751 Test Loss: 0.727 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3792736530303955
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.756 Test Loss: 0.728 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3517084121704102
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.751 Test Loss: 0.766 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2942163944244385
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.756 Test Loss: 0.740 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1863934993743896
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.236891746520996
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2638475894927979
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 264310
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.868295431137085
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.082312822341919
Epoch: 2, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
Validation loss decreased (-0.721945 --> -0.760971).  Saving model ...
Epoch: 3 cost time: 1.410261631011963
Epoch: 3, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.509 Vali Acc: 0.780 Test Loss: 0.509 Test Acc: 0.780
Validation loss decreased (-0.760971 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 1.3225207328796387
Epoch: 4, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.509 Vali Acc: 0.741 Test Loss: 0.509 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1951079368591309
Epoch: 5, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5196843147277832
Epoch: 6, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.609 Vali Acc: 0.776 Test Loss: 0.609 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.081176519393921
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.544 Vali Acc: 0.756 Test Loss: 0.544 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.005364179611206
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.610 Vali Acc: 0.751 Test Loss: 0.610 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2341413497924805
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0633316040039062
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.761 Test Loss: 0.610 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2337543964385986
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.761 Test Loss: 0.623 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2458219528198242
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.761 Test Loss: 0.621 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4515066146850586
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 263286
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.83719539642334
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.1116867065429688
Epoch: 2, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.595 Vali Acc: 0.654 Test Loss: 0.595 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0989243984222412
Epoch: 3, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.520 Vali Acc: 0.702 Test Loss: 0.520 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8204731941223145
Epoch: 4, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 0.8581206798553467
Epoch: 5, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9025452136993408
Epoch: 6, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.771 Vali Acc: 0.746 Test Loss: 0.771 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746334).  Saving model ...
Epoch: 7 cost time: 0.7943122386932373
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.647 Vali Acc: 0.741 Test Loss: 0.647 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.070723056793213
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.745 Vali Acc: 0.722 Test Loss: 0.745 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.093724012374878
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.734 Vali Acc: 0.732 Test Loss: 0.734 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9737949371337891
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.732 Test Loss: 0.753 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1064262390136719
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9496090412139893
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.737 Test Loss: 0.783 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9284892082214355
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.737 Test Loss: 0.799 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9225502014160156
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.737 Test Loss: 0.798 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.995267391204834
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.737 Test Loss: 0.807 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8456757068634033
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.737 Test Loss: 0.831 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 262262
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.121325969696045
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.29202938079834
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.510 Vali Acc: 0.727 Test Loss: 0.510 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.579800844192505
Epoch: 3, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.746301889419556
Epoch: 4, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.604 Vali Acc: 0.663 Test Loss: 0.604 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8417868614196777
Epoch: 5, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.493 Vali Acc: 0.761 Test Loss: 0.493 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760971).  Saving model ...
Epoch: 6 cost time: 4.765096426010132
Epoch: 6, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.697337627410889
Epoch: 7, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.70683217048645
Epoch: 8, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.407924175262451
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.630024671554565
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.108639240264893
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9153308868408203
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.195622444152832
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.160286903381348
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.741 Test Loss: 0.650 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.7887229919433594
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 273094
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.04270339012146
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.700 Vali Acc: 0.722 Test Loss: 0.700 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 3.2198379039764404
Epoch: 2, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.540 Vali Acc: 0.678 Test Loss: 0.540 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.722942590713501
Epoch: 3, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
Validation loss decreased (-0.721944 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.628420829772949
Epoch: 4, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.602 Vali Acc: 0.741 Test Loss: 0.602 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 2.8564558029174805
Epoch: 5, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.713515043258667
Epoch: 6, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.691563844680786
Epoch: 7, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.713 Vali Acc: 0.741 Test Loss: 0.713 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6810142993927
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.93312668800354
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.718 Vali Acc: 0.741 Test Loss: 0.718 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7933874130249023
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6599836349487305
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.743 Vali Acc: 0.737 Test Loss: 0.743 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.588460683822632
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.732 Test Loss: 0.753 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4489195346832275
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5948069095611572
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.732 Test Loss: 0.778 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 270534
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.80700421333313
Epoch: 1, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.8938860893249512
Epoch: 2, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.536 Vali Acc: 0.702 Test Loss: 0.536 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1783971786499023
Epoch: 3, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.508 Vali Acc: 0.732 Test Loss: 0.508 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.429030418395996
Epoch: 4, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.4699716567993164
Epoch: 5, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.241652727127075
Epoch: 6, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1139185428619385
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.067195415496826
Epoch: 8, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.614 Vali Acc: 0.722 Test Loss: 0.614 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2003660202026367
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.248857259750366
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.665 Vali Acc: 0.722 Test Loss: 0.665 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1789770126342773
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.727 Test Loss: 0.658 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.997375249862671
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.722 Test Loss: 0.679 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2543716430664062
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.722 Test Loss: 0.687 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0827136039733887
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.722 Test Loss: 0.701 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 267974
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.355875015258789
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.5610389709472656
Epoch: 2, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.5645439624786377
Epoch: 3, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.521 Vali Acc: 0.712 Test Loss: 0.521 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7814204692840576
Epoch: 4, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9093151092529297
Epoch: 5, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.688779354095459
Epoch: 6, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.609 Vali Acc: 0.766 Test Loss: 0.609 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 1.7472856044769287
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6312551498413086
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7480721473693848
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.661 Vali Acc: 0.741 Test Loss: 0.661 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7205736637115479
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.631221055984497
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.741 Test Loss: 0.677 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.847876787185669
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.741 Test Loss: 0.688 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7875800132751465
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.741 Test Loss: 0.703 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8043406009674072
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.741 Test Loss: 0.705 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7090556621551514
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.716219186782837
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.741 Test Loss: 0.719 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 265414
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7664527893066406
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.37800931930542
Epoch: 2, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.516 Vali Acc: 0.741 Test Loss: 0.516 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.297832727432251
Epoch: 3, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.510 Vali Acc: 0.737 Test Loss: 0.510 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2771704196929932
Epoch: 4, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.515 Vali Acc: 0.746 Test Loss: 0.515 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.3106799125671387
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.539 Vali Acc: 0.766 Test Loss: 0.539 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 1.2857353687286377
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.365687608718872
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2797231674194336
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.611 Vali Acc: 0.756 Test Loss: 0.611 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3757786750793457
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1852633953094482
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2605137825012207
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.746 Test Loss: 0.639 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2613630294799805
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.657 Vali Acc: 0.756 Test Loss: 0.657 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1807756423950195
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4134571552276611
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5465736389160156
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 263366
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.184941291809082
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.581 Vali Acc: 0.712 Test Loss: 0.581 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.4146308898925781
Epoch: 2, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.4440093040466309
Epoch: 3, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.528 Vali Acc: 0.771 Test Loss: 0.528 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 1.326552152633667
Epoch: 4, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.541 Vali Acc: 0.712 Test Loss: 0.541 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1283748149871826
Epoch: 5, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.121791124343872
Epoch: 6, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.588 Vali Acc: 0.756 Test Loss: 0.588 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2478115558624268
Epoch: 7, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3644731044769287
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.652 Vali Acc: 0.756 Test Loss: 0.652 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4059126377105713
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.700 Vali Acc: 0.761 Test Loss: 0.700 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2057478427886963
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.091261625289917
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1793200969696045
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.748 Vali Acc: 0.761 Test Loss: 0.748 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1532368659973145
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.761 Test Loss: 0.757 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 262342
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6388015747070312
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.0808753967285156
Epoch: 2, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.523 Vali Acc: 0.766 Test Loss: 0.523 Test Acc: 0.766
Validation loss decreased (-0.726823 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 1.0193252563476562
Epoch: 3, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.482 Vali Acc: 0.761 Test Loss: 0.482 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1397063732147217
Epoch: 4, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.477 Vali Acc: 0.776 Test Loss: 0.477 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775605).  Saving model ...
Epoch: 5 cost time: 1.0301272869110107
Epoch: 5, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.526 Vali Acc: 0.766 Test Loss: 0.526 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9254262447357178
Epoch: 6, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.571 Vali Acc: 0.766 Test Loss: 0.571 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.037339448928833
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.508 Vali Acc: 0.771 Test Loss: 0.508 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0566599369049072
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.528 Vali Acc: 0.771 Test Loss: 0.528 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1876659393310547
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0598859786987305
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.771 Test Loss: 0.556 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1959409713745117
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.771 Test Loss: 0.565 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9983561038970947
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.771 Test Loss: 0.574 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.027939796447754
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.771 Test Loss: 0.579 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1264355182647705
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.771 Test Loss: 0.580 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 261318
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4699032306671143
Epoch: 1, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 0.7254588603973389
Epoch: 2, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.506 Vali Acc: 0.746 Test Loss: 0.506 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.6679773330688477
Epoch: 3, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7426178455352783
Epoch: 4, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8572773933410645
Epoch: 5, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.552 Vali Acc: 0.751 Test Loss: 0.552 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 0.8280863761901855
Epoch: 6, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760969).  Saving model ...
Epoch: 7 cost time: 0.6645426750183105
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.766 Test Loss: 0.653 Test Acc: 0.766
Validation loss decreased (-0.760969 --> -0.765847).  Saving model ...
Epoch: 8 cost time: 0.6526787281036377
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.649 Vali Acc: 0.776 Test Loss: 0.649 Test Acc: 0.776
Validation loss decreased (-0.765847 --> -0.775603).  Saving model ...
Epoch: 9 cost time: 0.7573270797729492
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.773902416229248
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.780 Test Loss: 0.725 Test Acc: 0.780
Validation loss decreased (-0.775603 --> -0.780481).  Saving model ...
Epoch: 11 cost time: 0.74131178855896
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.780 Test Loss: 0.737 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8639307022094727
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.776 Test Loss: 0.754 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9473750591278076
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.780 Test Loss: 0.764 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7528512477874756
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.785 Test Loss: 0.769 Test Acc: 0.785
Validation loss decreased (-0.780481 --> -0.785358).  Saving model ...
Epoch: 15 cost time: 0.8698689937591553
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.785 Test Loss: 0.782 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8172364234924316
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.766 Test Loss: 0.810 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8567595481872559
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.780 Test Loss: 0.799 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8191947937011719
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.776 Test Loss: 0.817 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7854835987091064
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.785 Test Loss: 0.812 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.931065559387207
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.785 Test Loss: 0.826 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8585546016693115
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.776 Test Loss: 0.840 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7273354530334473
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.785 Test Loss: 0.845 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7901310920715332
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.780 Test Loss: 0.859 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0183396339416504
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.780 Test Loss: 0.862 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 260294
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.971482515335083
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 3.0815742015838623
Epoch: 2, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
Validation loss decreased (-0.717068 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 3.174485206604004
Epoch: 3, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.505 Vali Acc: 0.737 Test Loss: 0.505 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1545019149780273
Epoch: 4, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.531 Vali Acc: 0.722 Test Loss: 0.531 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8749217987060547
Epoch: 5, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.506 Vali Acc: 0.741 Test Loss: 0.506 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.8590428829193115
Epoch: 6, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.518 Vali Acc: 0.766 Test Loss: 0.518 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 2.9951913356781006
Epoch: 7, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.536 Vali Acc: 0.761 Test Loss: 0.536 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.891831874847412
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.555 Vali Acc: 0.756 Test Loss: 0.555 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7784345149993896
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.591 Vali Acc: 0.732 Test Loss: 0.591 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0855653285980225
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.580 Vali Acc: 0.761 Test Loss: 0.580 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9561097621917725
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1191940307617188
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.766 Test Loss: 0.614 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8335070610046387
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.637 Vali Acc: 0.741 Test Loss: 0.637 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.5848639011383057
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.756 Test Loss: 0.635 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.118738889694214
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.890805959701538
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 272110
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.426805734634399
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5340075492858887
Epoch: 2, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.6163432598114014
Epoch: 3, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.6565520763397217
Epoch: 4, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6948719024658203
Epoch: 5, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.697192907333374
Epoch: 6, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.678 Vali Acc: 0.741 Test Loss: 0.678 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3249096870422363
Epoch: 7, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.690 Vali Acc: 0.751 Test Loss: 0.690 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2893874645233154
Epoch: 8, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.673 Vali Acc: 0.732 Test Loss: 0.673 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3623220920562744
Epoch: 9, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.642 Vali Acc: 0.693 Test Loss: 0.642 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.718154191970825
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.716 Vali Acc: 0.732 Test Loss: 0.716 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2237467765808105
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.657 Vali Acc: 0.732 Test Loss: 0.657 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.439819097518921
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.737 Test Loss: 0.710 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.79814076423645
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.732 Test Loss: 0.695 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 269550
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.1416707038879395
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.549 Vali Acc: 0.717 Test Loss: 0.549 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 2.1494829654693604
Epoch: 2, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.512 Vali Acc: 0.722 Test Loss: 0.512 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.1966824531555176
Epoch: 3, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.2106246948242188
Epoch: 4, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4041333198547363
Epoch: 5, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.550 Vali Acc: 0.732 Test Loss: 0.550 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.191631317138672
Epoch: 6, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 2.885974645614624
Epoch: 7, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.630082845687866
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.997823715209961
Epoch: 9, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.734 Vali Acc: 0.732 Test Loss: 0.734 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0074503421783447
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.746 Test Loss: 0.647 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1108243465423584
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.163236618041992
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.722 Test Loss: 0.668 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9740064144134521
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.717 Test Loss: 0.667 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.537142276763916
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3165407180786133
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5543136596679688
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 266990
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6413841247558594
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.6554574966430664
Epoch: 2, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.538 Vali Acc: 0.722 Test Loss: 0.538 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.8955235481262207
Epoch: 3, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.0977799892425537
Epoch: 4, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.9534525871276855
Epoch: 5, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.863649845123291
Epoch: 6, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8260180950164795
Epoch: 7, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.621 Vali Acc: 0.741 Test Loss: 0.621 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1559064388275146
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.089402914047241
Epoch: 9, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.21883225440979
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.707 Vali Acc: 0.741 Test Loss: 0.707 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9662227630615234
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9160480499267578
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.02168345451355
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.741 Test Loss: 0.746 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9742136001586914
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.741 Test Loss: 0.750 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8927998542785645
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.732 Test Loss: 0.765 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 264430
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8306784629821777
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2633726596832275
Epoch: 2, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.510 Vali Acc: 0.732 Test Loss: 0.510 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.3750801086425781
Epoch: 3, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.5666718482971191
Epoch: 4, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.510 Vali Acc: 0.727 Test Loss: 0.510 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3278348445892334
Epoch: 5, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4209017753601074
Epoch: 6, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2962522506713867
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2870221138000488
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.636 Vali Acc: 0.727 Test Loss: 0.636 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5319924354553223
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.654 Vali Acc: 0.727 Test Loss: 0.654 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2290794849395752
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.727 Test Loss: 0.701 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4679696559906006
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3649945259094238
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.727 Test Loss: 0.719 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.316890001296997
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 262382
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7183573246002197
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.1671831607818604
Epoch: 2, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.550 Vali Acc: 0.668 Test Loss: 0.550 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1907060146331787
Epoch: 3, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.495 Vali Acc: 0.785 Test Loss: 0.495 Test Acc: 0.785
Validation loss decreased (-0.731702 --> -0.785361).  Saving model ...
Epoch: 4 cost time: 1.0726735591888428
Epoch: 4, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1113348007202148
Epoch: 5, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.562 Vali Acc: 0.688 Test Loss: 0.562 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.048368215560913
Epoch: 6, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.594 Vali Acc: 0.751 Test Loss: 0.594 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1223249435424805
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1780481338500977
Epoch: 8, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.588 Vali Acc: 0.756 Test Loss: 0.588 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0987842082977295
Epoch: 9, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.756 Test Loss: 0.607 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0958335399627686
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.086090326309204
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.746 Test Loss: 0.687 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3241899013519287
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.746 Test Loss: 0.701 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.161616563796997
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.751 Test Loss: 0.700 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 261358
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9572043418884277
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.2115676403045654
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.5926792621612549
Epoch: 3, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.503 Vali Acc: 0.737 Test Loss: 0.503 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.283693552017212
Epoch: 4, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2178325653076172
Epoch: 5, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.684 Vali Acc: 0.634 Test Loss: 0.684 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1490626335144043
Epoch: 6, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.100175142288208
Epoch: 7, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.622 Vali Acc: 0.756 Test Loss: 0.622 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 1.0610227584838867
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0891454219818115
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.761 Test Loss: 0.594 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 0.9856832027435303
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775603).  Saving model ...
Epoch: 11 cost time: 0.9669167995452881
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0604517459869385
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.677 Vali Acc: 0.771 Test Loss: 0.677 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9850811958312988
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.771 Test Loss: 0.685 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1638402938842773
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.756 Test Loss: 0.669 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1130540370941162
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.771 Test Loss: 0.703 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0016090869903564
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.766 Test Loss: 0.694 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.051093578338623
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1234204769134521
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.766 Test Loss: 0.724 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0745737552642822
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0825870037078857
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.761 Test Loss: 0.741 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 260334
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3218255043029785
Epoch: 1, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 0.7688853740692139
Epoch: 2, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.523 Vali Acc: 0.732 Test Loss: 0.523 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.7378649711608887
Epoch: 3, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.722935676574707
Epoch: 4, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7918920516967773
Epoch: 5, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8025777339935303
Epoch: 6, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.628 Vali Acc: 0.756 Test Loss: 0.628 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 0.8254053592681885
Epoch: 7, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.644 Vali Acc: 0.746 Test Loss: 0.644 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8092837333679199
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7345678806304932
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.756 Test Loss: 0.751 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8400378227233887
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760968).  Saving model ...
Epoch: 11 cost time: 0.7793395519256592
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.788 Vali Acc: 0.756 Test Loss: 0.788 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9214742183685303
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.786 Vali Acc: 0.751 Test Loss: 0.786 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8979356288909912
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9810879230499268
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.746 Test Loss: 0.821 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9213259220123291
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.751 Test Loss: 0.845 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7937157154083252
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.751 Test Loss: 0.835 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8567390441894531
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.751 Test Loss: 0.869 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.805351734161377
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.867 Vali Acc: 0.751 Test Loss: 0.867 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9421353340148926
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.756 Test Loss: 0.910 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8089578151702881
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.751 Test Loss: 0.898 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 259310
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.4073309898376465
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 3.549647092819214
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.516 Vali Acc: 0.751 Test Loss: 0.516 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 3.690307378768921
Epoch: 3, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.497 Vali Acc: 0.761 Test Loss: 0.497 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760971).  Saving model ...
Epoch: 4 cost time: 3.268202304840088
Epoch: 4, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.489 Vali Acc: 0.780 Test Loss: 0.489 Test Acc: 0.780
Validation loss decreased (-0.760971 --> -0.780483).  Saving model ...
Epoch: 5 cost time: 3.3248534202575684
Epoch: 5, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.516 Vali Acc: 0.737 Test Loss: 0.516 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2803807258605957
Epoch: 6, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.502 Vali Acc: 0.771 Test Loss: 0.502 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.188481092453003
Epoch: 7, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0599091053009033
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.326948404312134
Epoch: 9, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.452467203140259
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.650 Vali Acc: 0.746 Test Loss: 0.650 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.869760513305664
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.959822654724121
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.482929229736328
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.756 Test Loss: 0.626 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.576357126235962
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.766 Test Loss: 0.619 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 271618
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.008015155792236
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.729299306869507
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.523 Vali Acc: 0.732 Test Loss: 0.523 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.428612232208252
Epoch: 3, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.771 Vali Acc: 0.512 Test Loss: 0.771 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5283467769622803
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.517 Vali Acc: 0.751 Test Loss: 0.517 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.5181424617767334
Epoch: 5, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3901844024658203
Epoch: 6, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.377678394317627
Epoch: 7, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4758172035217285
Epoch: 8, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.678 Vali Acc: 0.737 Test Loss: 0.678 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4102089405059814
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.655 Vali Acc: 0.746 Test Loss: 0.655 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.484001398086548
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.661 Vali Acc: 0.722 Test Loss: 0.661 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5848374366760254
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.797100305557251
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.751 Vali Acc: 0.751 Test Loss: 0.751 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.674203872680664
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.365262508392334
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 269058
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8111047744750977
Epoch: 1, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.9422616958618164
Epoch: 2, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.508 Vali Acc: 0.746 Test Loss: 0.508 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.059377431869507
Epoch: 3, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.500 Vali Acc: 0.751 Test Loss: 0.500 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751215).  Saving model ...
Epoch: 4 cost time: 2.313647508621216
Epoch: 4, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.509 Vali Acc: 0.732 Test Loss: 0.509 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3162777423858643
Epoch: 5, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
Validation loss decreased (-0.751215 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.020475149154663
Epoch: 6, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.518 Vali Acc: 0.766 Test Loss: 0.518 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 2.0379273891448975
Epoch: 7, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.577 Vali Acc: 0.707 Test Loss: 0.577 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1934587955474854
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.202665328979492
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.583 Vali Acc: 0.746 Test Loss: 0.583 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2879347801208496
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.751 Test Loss: 0.624 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0626258850097656
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.746 Test Loss: 0.650 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.06152081489563
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0030341148376465
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.664 Vali Acc: 0.741 Test Loss: 0.664 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1499669551849365
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1006627082824707
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.751 Test Loss: 0.688 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9419066905975342
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.741 Test Loss: 0.698 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 266498
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4243664741516113
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 1.7281818389892578
Epoch: 2, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.542 Vali Acc: 0.698 Test Loss: 0.542 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7814295291900635
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.596 Vali Acc: 0.663 Test Loss: 0.596 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8538389205932617
Epoch: 4, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.553 Vali Acc: 0.683 Test Loss: 0.553 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8673639297485352
Epoch: 5, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.520 Vali Acc: 0.727 Test Loss: 0.520 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6890621185302734
Epoch: 6, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.643082618713379
Epoch: 7, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.559 Vali Acc: 0.702 Test Loss: 0.559 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6768524646759033
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 9 cost time: 1.8501086235046387
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.647 Vali Acc: 0.756 Test Loss: 0.647 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.694655179977417
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6879010200500488
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.705 Vali Acc: 0.727 Test Loss: 0.705 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1784121990203857
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.746 Test Loss: 0.736 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8140523433685303
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.732 Vali Acc: 0.717 Test Loss: 0.732 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7691080570220947
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.732 Test Loss: 0.756 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8481361865997314
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.727 Test Loss: 0.765 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.784519910812378
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.737 Test Loss: 0.790 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7094340324401855
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.788 Vali Acc: 0.727 Test Loss: 0.788 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7472553253173828
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.727 Test Loss: 0.801 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 263938
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9072110652923584
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 1.2443583011627197
Epoch: 2, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1848833560943604
Epoch: 3, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.498 Vali Acc: 0.746 Test Loss: 0.498 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3486287593841553
Epoch: 4, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.504 Vali Acc: 0.722 Test Loss: 0.504 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2634432315826416
Epoch: 5, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.570 Vali Acc: 0.693 Test Loss: 0.570 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.403095006942749
Epoch: 6, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.564 Vali Acc: 0.751 Test Loss: 0.564 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3410899639129639
Epoch: 7, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3996198177337646
Epoch: 8, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.644 Vali Acc: 0.746 Test Loss: 0.644 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3051562309265137
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2466340065002441
Epoch: 10, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.684 Vali Acc: 0.737 Test Loss: 0.684 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2990283966064453
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.809 Vali Acc: 0.727 Test Loss: 0.809 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 261890
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6537487506866455
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.580 Vali Acc: 0.702 Test Loss: 0.580 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 1.2081623077392578
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.523 Vali Acc: 0.737 Test Loss: 0.523 Test Acc: 0.737
Validation loss decreased (-0.702433 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.540278673171997
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3173027038574219
Epoch: 4, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 1.4166615009307861
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.063 Vali Acc: 0.722 Test Loss: 1.063 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3402512073516846
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.779 Vali Acc: 0.717 Test Loss: 0.779 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.305706262588501
Epoch: 7, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.291654109954834
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3057472705841064
Epoch: 9, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.611 Vali Acc: 0.751 Test Loss: 0.611 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.398494005203247
Epoch: 10, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.625 Vali Acc: 0.741 Test Loss: 0.625 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.492964744567871
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.644 Vali Acc: 0.756 Test Loss: 0.644 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.272639513015747
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2122175693511963
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.737 Test Loss: 0.715 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1768205165863037
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.746 Test Loss: 0.722 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 260866
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.3899261951446533
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.570 Vali Acc: 0.712 Test Loss: 0.570 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 0.9759445190429688
Epoch: 2, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.663 Vali Acc: 0.712 Test Loss: 0.663 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9838600158691406
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 0.9736924171447754
Epoch: 4, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.517 Vali Acc: 0.722 Test Loss: 0.517 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1414966583251953
Epoch: 5, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.521 Vali Acc: 0.756 Test Loss: 0.521 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 0.9534502029418945
Epoch: 6, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.535 Vali Acc: 0.761 Test Loss: 0.535 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 1.0702507495880127
Epoch: 7, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.626 Vali Acc: 0.741 Test Loss: 0.626 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9656457901000977
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.553 Vali Acc: 0.756 Test Loss: 0.553 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0810234546661377
Epoch: 9, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.761 Test Loss: 0.696 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1304640769958496
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.693 Vali Acc: 0.756 Test Loss: 0.693 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2413580417633057
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.751 Test Loss: 0.642 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2018442153930664
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0069339275360107
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.746 Test Loss: 0.699 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.206709861755371
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.756 Test Loss: 0.708 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1827495098114014
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.746 Test Loss: 0.707 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2596120834350586
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.746 Test Loss: 0.748 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 259842
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.4406840801239014
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.057408332824707
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.9115619659423828
Epoch: 3, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.665 Vali Acc: 0.722 Test Loss: 0.665 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8535821437835693
Epoch: 4, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.517 Vali Acc: 0.737 Test Loss: 0.517 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8025779724121094
Epoch: 5, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.564 Vali Acc: 0.702 Test Loss: 0.564 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9292173385620117
Epoch: 6, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.566 Vali Acc: 0.712 Test Loss: 0.566 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8480703830718994
Epoch: 7, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8715980052947998
Epoch: 8, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8577711582183838
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.742 Vali Acc: 0.737 Test Loss: 0.742 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8951447010040283
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.770 Vali Acc: 0.717 Test Loss: 0.770 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.887995719909668
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.826 Vali Acc: 0.727 Test Loss: 0.826 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8879811763763428
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.798 Vali Acc: 0.727 Test Loss: 0.798 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 258818
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.0054237842559814
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 3.317080497741699
Epoch: 2, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.519 Vali Acc: 0.727 Test Loss: 0.519 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 3.2960662841796875
Epoch: 3, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.501 Vali Acc: 0.746 Test Loss: 0.501 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.6243395805358887
Epoch: 4, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.513 Vali Acc: 0.741 Test Loss: 0.513 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3187198638916016
Epoch: 5, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4396185874938965
Epoch: 6, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.576 Vali Acc: 0.746 Test Loss: 0.576 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4674015045166016
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7690646648406982
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.5093181133270264
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.639 Vali Acc: 0.746 Test Loss: 0.639 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.0063958168029785
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 11 cost time: 3.465749502182007
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.675 Vali Acc: 0.741 Test Loss: 0.675 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5549025535583496
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.751 Test Loss: 0.638 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.400242567062378
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.462722063064575
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3294076919555664
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3387258052825928
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2715063095092773
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.746 Test Loss: 0.694 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.163123607635498
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.950711727142334
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.751 Test Loss: 0.709 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.241645574569702
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.751 Test Loss: 0.711 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w51_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 271004
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.317320108413696
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.072392702102661
Epoch: 2, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.519 Vali Acc: 0.722 Test Loss: 0.519 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6881954669952393
Epoch: 3, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.514 Vali Acc: 0.722 Test Loss: 0.514 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4051198959350586
Epoch: 4, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 5 cost time: 2.630633592605591
Epoch: 5, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.536 Vali Acc: 0.722 Test Loss: 0.536 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2115566730499268
Epoch: 6, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
Validation loss decreased (-0.731701 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 3.0524816513061523
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.741 Test Loss: 0.735 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2717649936676025
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9485902786254883
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1497256755828857
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.746 Test Loss: 0.690 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.192122220993042
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2759907245635986
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.741 Test Loss: 0.680 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3204970359802246
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.741 Test Loss: 0.693 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6685447692871094
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.741 Test Loss: 0.706 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0384559631347656
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.741 Test Loss: 0.704 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2232906818389893
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.741 Test Loss: 0.716 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w41_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 268444
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9089043140411377
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9284522533416748
Epoch: 2, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.157261610031128
Epoch: 3, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.521 Vali Acc: 0.741 Test Loss: 0.521 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.42529034614563
Epoch: 4, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.515 Vali Acc: 0.751 Test Loss: 0.515 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.2093148231506348
Epoch: 5, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.143228530883789
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.659 Vali Acc: 0.756 Test Loss: 0.659 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 1.9941966533660889
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.276094913482666
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.746 Test Loss: 0.637 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0209507942199707
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1073930263519287
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.209689140319824
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.285219669342041
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2236177921295166
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.732 Test Loss: 0.656 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.15470552444458
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.741 Test Loss: 0.688 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1791532039642334
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.086313486099243
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.732 Test Loss: 0.684 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w31_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 265884
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.243328332901001
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.5643362998962402
Epoch: 2, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.510 Vali Acc: 0.741 Test Loss: 0.510 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.6167588233947754
Epoch: 3, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.554 Vali Acc: 0.746 Test Loss: 0.554 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.6369993686676025
Epoch: 4, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.723600149154663
Epoch: 5, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.557 Vali Acc: 0.756 Test Loss: 0.557 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.686084508895874
Epoch: 6, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.526 Vali Acc: 0.756 Test Loss: 0.526 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.941502571105957
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9525647163391113
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.771 Test Loss: 0.585 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770726).  Saving model ...
Epoch: 9 cost time: 2.044633150100708
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.618 Vali Acc: 0.756 Test Loss: 0.618 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8106250762939453
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6926426887512207
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.766 Test Loss: 0.629 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7133541107177734
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.761 Test Loss: 0.650 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7003531455993652
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.00374174118042
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.761 Test Loss: 0.664 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.005682945251465
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.761 Test Loss: 0.673 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8037583827972412
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.766 Test Loss: 0.687 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9770410060882568
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.766 Test Loss: 0.692 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0558900833129883
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.761 Test Loss: 0.685 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 263324
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.671976327896118
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.557 Vali Acc: 0.712 Test Loss: 0.557 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 1.3659045696258545
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.524 Vali Acc: 0.717 Test Loss: 0.524 Test Acc: 0.717
Validation loss decreased (-0.712190 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 1.120177984237671
Epoch: 3, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.334329605102539
Epoch: 4, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.202650547027588
Epoch: 5, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0879056453704834
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.633 Vali Acc: 0.717 Test Loss: 0.633 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1829662322998047
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1184334754943848
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2031171321868896
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.722 Test Loss: 0.683 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1854300498962402
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.727 Test Loss: 0.661 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1204516887664795
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.722 Test Loss: 0.708 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0455775260925293
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.722 Test Loss: 0.695 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1091029644012451
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.722 Test Loss: 0.707 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.096221685409546
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.722 Test Loss: 0.723 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w13_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 261276
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.105241060256958
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 0.8667988777160645
Epoch: 2, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.517 Vali Acc: 0.727 Test Loss: 0.517 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8509855270385742
Epoch: 3, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.512 Vali Acc: 0.732 Test Loss: 0.512 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.958411455154419
Epoch: 4, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.525 Vali Acc: 0.741 Test Loss: 0.525 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 0.8934423923492432
Epoch: 5, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 0.895573616027832
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8817522525787354
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9065132141113281
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9454231262207031
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9439082145690918
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.741 Test Loss: 0.660 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9310572147369385
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9228036403656006
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.751 Test Loss: 0.672 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 13 cost time: 0.9391763210296631
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9544627666473389
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.746 Test Loss: 0.691 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.031278371810913
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.746 Test Loss: 0.703 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9522974491119385
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.746 Test Loss: 0.707 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8695199489593506
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.746 Test Loss: 0.707 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8877344131469727
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.746 Test Loss: 0.726 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.980191707611084
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.746 Test Loss: 0.726 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1251049041748047
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.746 Test Loss: 0.728 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0439791679382324
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9780404567718506
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 260252
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.2021756172180176
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.548 Vali Acc: 0.717 Test Loss: 0.548 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 0.9299919605255127
Epoch: 2, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.499 Vali Acc: 0.746 Test Loss: 0.499 Test Acc: 0.746
Validation loss decreased (-0.717068 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 0.9445953369140625
Epoch: 3, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.502 Vali Acc: 0.741 Test Loss: 0.502 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8221795558929443
Epoch: 4, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.494 Vali Acc: 0.776 Test Loss: 0.494 Test Acc: 0.776
Validation loss decreased (-0.746336 --> -0.775605).  Saving model ...
Epoch: 5 cost time: 0.7440052032470703
Epoch: 5, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.505 Vali Acc: 0.771 Test Loss: 0.505 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8931436538696289
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8063647747039795
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.873039960861206
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.746 Test Loss: 0.610 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8035504817962646
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8277990818023682
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.746 Test Loss: 0.621 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8457813262939453
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7840285301208496
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.741 Test Loss: 0.653 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7302401065826416
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.741 Test Loss: 0.650 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8532989025115967
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.741 Test Loss: 0.659 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 259228
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 1.9310965538024902
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.538 Vali Acc: 0.727 Test Loss: 0.538 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 0.6155836582183838
Epoch: 2, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.523 Vali Acc: 0.732 Test Loss: 0.523 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.6588821411132812
Epoch: 3, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.543 Vali Acc: 0.771 Test Loss: 0.543 Test Acc: 0.771
Validation loss decreased (-0.731702 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 0.6870331764221191
Epoch: 4, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.520 Vali Acc: 0.732 Test Loss: 0.520 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6624677181243896
Epoch: 5, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.552 Vali Acc: 0.751 Test Loss: 0.552 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6456425189971924
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.610 Vali Acc: 0.761 Test Loss: 0.610 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6702971458435059
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.84271240234375
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.756 Test Loss: 0.658 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7076058387756348
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.751 Test Loss: 0.676 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6629900932312012
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.756 Test Loss: 0.692 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.70467209815979
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.756 Test Loss: 0.699 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6906986236572266
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.756 Test Loss: 0.711 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7787935733795166
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_MTSMixer_UEA_ftM_sl405_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 258204
model size : 0.99MB
