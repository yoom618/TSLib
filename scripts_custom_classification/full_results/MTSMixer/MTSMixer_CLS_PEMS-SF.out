Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.748817920684814
Epoch: 1, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.334 Vali Acc: 0.514 Test Loss: 1.334 Test Acc: 0.514
Validation loss decreased (inf --> -0.514438).  Saving model ...
Epoch: 2 cost time: 5.876200199127197
Epoch: 2, Steps: 17 | Train Loss: 0.295 Vali Loss: 1.007 Vali Acc: 0.676 Test Loss: 1.007 Test Acc: 0.676
Validation loss decreased (-0.514438 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 5.653140544891357
Epoch: 3, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.729 Vali Acc: 0.723 Test Loss: 0.729 Test Acc: 0.723
Validation loss decreased (-0.676291 --> -0.722536).  Saving model ...
Epoch: 4 cost time: 5.32283878326416
Epoch: 4, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.802 Vali Acc: 0.728 Test Loss: 0.802 Test Acc: 0.728
Validation loss decreased (-0.722536 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 5.669629096984863
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.734 Test Loss: 1.016 Test Acc: 0.734
Validation loss decreased (-0.728316 --> -0.734094).  Saving model ...
Epoch: 6 cost time: 5.332190275192261
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.728 Test Loss: 1.050 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.319041728973389
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.717 Test Loss: 0.837 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.1271584033966064
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.734 Test Loss: 0.774 Test Acc: 0.734
Validation loss decreased (-0.734094 --> -0.734096).  Saving model ...
Epoch: 9 cost time: 5.908771753311157
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.734 Test Loss: 0.757 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 10 cost time: 5.682405233383179
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.734 Test Loss: 0.751 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734097).  Saving model ...
Epoch: 11 cost time: 5.4106621742248535
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.734 Test Loss: 0.751 Test Acc: 0.734
Validation loss decreased (-0.734097 --> -0.734097).  Saving model ...
Epoch: 12 cost time: 5.619313955307007
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.734 Test Loss: 0.749 Test Acc: 0.734
Validation loss decreased (-0.734097 --> -0.734097).  Saving model ...
Epoch: 13 cost time: 5.240581035614014
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.734 Test Loss: 0.753 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.956396102905273
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.734 Test Loss: 0.753 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.784270524978638
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.734 Test Loss: 0.752 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.4130895137786865
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.734 Test Loss: 0.752 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.604133605957031
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.734 Test Loss: 0.751 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.119673490524292
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.734 Test Loss: 0.753 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.418872356414795
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.740 Test Loss: 0.752 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739877).  Saving model ...
Epoch: 20 cost time: 5.7214696407318115
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.740 Test Loss: 0.752 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739877).  Saving model ...
Epoch: 21 cost time: 5.447624206542969
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.740 Test Loss: 0.753 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.682681322097778
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.740 Test Loss: 0.752 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.801578044891357
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.740 Test Loss: 0.754 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.559387445449829
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.740 Test Loss: 0.755 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.533247470855713
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.734 Test Loss: 0.755 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.8265910148620605
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.734 Test Loss: 0.756 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.7998046875
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.740 Test Loss: 0.756 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.5471765995025635
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.734 Test Loss: 0.756 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.71607518196106
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.740 Test Loss: 0.757 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.797184944152832
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.740 Test Loss: 0.757 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 2098703
model size : 8.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.741498231887817
Epoch: 1, Steps: 17 | Train Loss: 1.657 Vali Loss: 1.325 Vali Acc: 0.509 Test Loss: 1.325 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 5.152318954467773
Epoch: 2, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.955 Vali Acc: 0.688 Test Loss: 0.955 Test Acc: 0.688
Validation loss decreased (-0.508657 --> -0.687852).  Saving model ...
Epoch: 3 cost time: 5.146156549453735
Epoch: 3, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
Validation loss decreased (-0.687852 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 5.2046589851379395
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.974 Vali Acc: 0.769 Test Loss: 0.974 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.386167764663696
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.839 Vali Acc: 0.757 Test Loss: 0.839 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.852341175079346
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.751 Test Loss: 0.893 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.980935335159302
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.799 Vali Acc: 0.740 Test Loss: 0.799 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.318230867385864
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.82029128074646
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.896 Vali Acc: 0.740 Test Loss: 0.896 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.380449295043945
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.088 Vali Acc: 0.746 Test Loss: 1.088 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.361790418624878
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.303 Vali Acc: 0.728 Test Loss: 1.303 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.386868476867676
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.769 Test Loss: 0.898 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.326988697052002
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.786 Test Loss: 0.846 Test Acc: 0.786
Validation loss decreased (-0.774559 --> -0.786119).  Saving model ...
Epoch: 14 cost time: 4.7027130126953125
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.156 Vali Acc: 0.723 Test Loss: 1.156 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.742999076843262
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.102 Vali Acc: 0.734 Test Loss: 1.102 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.735255718231201
Epoch: 16, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.080 Vali Acc: 0.740 Test Loss: 1.080 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.308953285217285
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.173 Vali Acc: 0.717 Test Loss: 1.173 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.286378860473633
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.078 Vali Acc: 0.769 Test Loss: 1.078 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.1142823696136475
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.797 Vali Acc: 0.705 Test Loss: 1.797 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.077324628829956
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.417 Vali Acc: 0.740 Test Loss: 2.417 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.387711048126221
Epoch: 21, Steps: 17 | Train Loss: 0.182 Vali Loss: 2.685 Vali Acc: 0.688 Test Loss: 2.685 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.231841802597046
Epoch: 22, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.945 Vali Acc: 0.740 Test Loss: 2.945 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.896333456039429
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.897 Vali Acc: 0.734 Test Loss: 3.897 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 2092559
model size : 8.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.426163673400879
Epoch: 1, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.036 Vali Acc: 0.572 Test Loss: 1.036 Test Acc: 0.572
Validation loss decreased (inf --> -0.572244).  Saving model ...
Epoch: 2 cost time: 4.278035879135132
Epoch: 2, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.986 Vali Acc: 0.699 Test Loss: 0.986 Test Acc: 0.699
Validation loss decreased (-0.572244 --> -0.699412).  Saving model ...
Epoch: 3 cost time: 3.8680217266082764
Epoch: 3, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.868 Vali Acc: 0.763 Test Loss: 0.868 Test Acc: 0.763
Validation loss decreased (-0.699412 --> -0.762997).  Saving model ...
Epoch: 4 cost time: 4.266340732574463
Epoch: 4, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.866 Vali Acc: 0.746 Test Loss: 0.866 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.19460654258728
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.746 Test Loss: 0.960 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.220497369766235
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.734 Test Loss: 1.012 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.770749807357788
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.734 Test Loss: 0.992 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.083182096481323
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.746 Test Loss: 0.970 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.607177257537842
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.740 Test Loss: 0.956 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.8895747661590576
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.946 Vali Acc: 0.734 Test Loss: 0.946 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.8856451511383057
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.734 Test Loss: 0.941 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.909982204437256
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.728 Test Loss: 0.934 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.5931501388549805
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.734 Test Loss: 0.928 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 2084367
model size : 7.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.218930006027222
Epoch: 1, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
Validation loss decreased (inf --> -0.514439).  Saving model ...
Epoch: 2 cost time: 3.289886951446533
Epoch: 2, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.843 Vali Acc: 0.699 Test Loss: 0.843 Test Acc: 0.699
Validation loss decreased (-0.514439 --> -0.699414).  Saving model ...
Epoch: 3 cost time: 3.563093900680542
Epoch: 3, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.079 Vali Acc: 0.694 Test Loss: 1.079 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.286288261413574
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.775 Vali Acc: 0.740 Test Loss: 0.775 Test Acc: 0.740
Validation loss decreased (-0.699414 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 3.368948459625244
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.874 Vali Acc: 0.769 Test Loss: 0.874 Test Acc: 0.769
Validation loss decreased (-0.739877 --> -0.768777).  Saving model ...
Epoch: 6 cost time: 3.2285733222961426
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.740 Test Loss: 0.942 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2159481048583984
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.227 Vali Acc: 0.734 Test Loss: 1.227 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.195221185684204
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774557).  Saving model ...
Epoch: 9 cost time: 3.1636171340942383
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.746 Test Loss: 0.917 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8945183753967285
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.746 Test Loss: 0.893 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9295475482940674
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.757 Test Loss: 0.885 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9454071521759033
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.763 Test Loss: 0.884 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1325156688690186
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.751 Test Loss: 0.883 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3957934379577637
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.751 Test Loss: 0.883 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.104938268661499
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.751 Test Loss: 0.883 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9386563301086426
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.751 Test Loss: 0.886 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.103548049926758
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.751 Test Loss: 0.886 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.27526593208313
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.751 Test Loss: 0.888 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 2078223
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.821331024169922
Epoch: 1, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.039 Vali Acc: 0.618 Test Loss: 1.039 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 2.8338775634765625
Epoch: 2, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.913 Vali Acc: 0.682 Test Loss: 0.913 Test Acc: 0.682
Validation loss decreased (-0.618487 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 2.5131375789642334
Epoch: 3, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.321 Vali Acc: 0.705 Test Loss: 1.321 Test Acc: 0.705
Validation loss decreased (-0.682072 --> -0.705189).  Saving model ...
Epoch: 4 cost time: 2.6057512760162354
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.823 Vali Acc: 0.780 Test Loss: 0.823 Test Acc: 0.780
Validation loss decreased (-0.705189 --> -0.780339).  Saving model ...
Epoch: 5 cost time: 2.490048885345459
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.912 Vali Acc: 0.757 Test Loss: 0.912 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8230068683624268
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.717 Test Loss: 0.899 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8725903034210205
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.976 Vali Acc: 0.734 Test Loss: 0.976 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.001598358154297
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.746 Test Loss: 1.036 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8493406772613525
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.723 Test Loss: 0.847 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.696190595626831
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8458964824676514
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.723 Test Loss: 0.839 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8924167156219482
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.723 Test Loss: 0.840 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7080740928649902
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.784724712371826
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.717 Test Loss: 0.834 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 2072079
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.232862710952759
Epoch: 1, Steps: 17 | Train Loss: 1.658 Vali Loss: 1.243 Vali Acc: 0.532 Test Loss: 1.243 Test Acc: 0.532
Validation loss decreased (inf --> -0.531779).  Saving model ...
Epoch: 2 cost time: 2.677015781402588
Epoch: 2, Steps: 17 | Train Loss: 0.239 Vali Loss: 1.092 Vali Acc: 0.665 Test Loss: 1.092 Test Acc: 0.665
Validation loss decreased (-0.531779 --> -0.664729).  Saving model ...
Epoch: 3 cost time: 2.577141761779785
Epoch: 3, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.779 Vali Acc: 0.746 Test Loss: 0.779 Test Acc: 0.746
Validation loss decreased (-0.664729 --> -0.745657).  Saving model ...
Epoch: 4 cost time: 2.87105655670166
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.077 Vali Acc: 0.717 Test Loss: 1.077 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.852895498275757
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.092 Vali Acc: 0.740 Test Loss: 1.092 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.618380069732666
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.751 Test Loss: 1.003 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751435).  Saving model ...
Epoch: 7 cost time: 2.538322687149048
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.763 Test Loss: 1.028 Test Acc: 0.763
Validation loss decreased (-0.751435 --> -0.762995).  Saving model ...
Epoch: 8 cost time: 2.4557223320007324
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.763 Test Loss: 0.988 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762996).  Saving model ...
Epoch: 9 cost time: 2.3678650856018066
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.769 Test Loss: 0.964 Test Acc: 0.769
Validation loss decreased (-0.762996 --> -0.768776).  Saving model ...
Epoch: 10 cost time: 2.478929042816162
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.769 Test Loss: 0.942 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768777).  Saving model ...
Epoch: 11 cost time: 2.4802064895629883
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.769 Test Loss: 0.926 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 12 cost time: 2.6350855827331543
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.763 Test Loss: 0.914 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.774134397506714
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.763 Test Loss: 0.905 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.531712532043457
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.769 Test Loss: 0.898 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 15 cost time: 2.4122939109802246
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774558).  Saving model ...
Epoch: 16 cost time: 2.74064040184021
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.775 Test Loss: 0.885 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 17 cost time: 2.4878926277160645
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 18 cost time: 2.837376356124878
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 19 cost time: 2.8907501697540283
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.786 Test Loss: 0.873 Test Acc: 0.786
Validation loss decreased (-0.774558 --> -0.786118).  Saving model ...
Epoch: 20 cost time: 3.2848658561706543
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.786 Test Loss: 0.869 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 21 cost time: 2.9659841060638428
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.786 Test Loss: 0.867 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 22 cost time: 2.931032180786133
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.786 Test Loss: 0.864 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786119).  Saving model ...
Epoch: 23 cost time: 3.144019603729248
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.786 Test Loss: 0.859 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 24 cost time: 2.8082940578460693
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.786 Test Loss: 0.856 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 25 cost time: 3.1216742992401123
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.792 Test Loss: 0.854 Test Acc: 0.792
Validation loss decreased (-0.786119 --> -0.791899).  Saving model ...
Epoch: 26 cost time: 2.995126724243164
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.798 Test Loss: 0.853 Test Acc: 0.798
Validation loss decreased (-0.791899 --> -0.797679).  Saving model ...
Epoch: 27 cost time: 3.0127522945404053
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.798 Test Loss: 0.850 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 28 cost time: 3.0080647468566895
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.798 Test Loss: 0.850 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 29 cost time: 2.8914854526519775
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.798 Test Loss: 0.849 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 30 cost time: 3.285588026046753
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.798 Test Loss: 0.848 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 31 cost time: 2.9354186058044434
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.798 Test Loss: 0.846 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 32 cost time: 2.924004316329956
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.798 Test Loss: 0.845 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 33 cost time: 2.8503496646881104
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.798 Test Loss: 0.844 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 34 cost time: 2.933075189590454
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.798 Test Loss: 0.843 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 35 cost time: 2.678149461746216
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.798 Test Loss: 0.841 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 36 cost time: 3.021300792694092
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.798 Test Loss: 0.840 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 37 cost time: 3.0606002807617188
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.798 Test Loss: 0.840 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 38 cost time: 3.217593193054199
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.798 Test Loss: 0.838 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 39 cost time: 3.1018033027648926
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.798 Test Loss: 0.838 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 40 cost time: 3.061208724975586
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.798 Test Loss: 0.838 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 41 cost time: 3.164252519607544
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.798 Test Loss: 0.837 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 42 cost time: 3.558180570602417
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.798 Test Loss: 0.835 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797680).  Saving model ...
Epoch: 43 cost time: 2.9474215507507324
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.798 Test Loss: 0.835 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 44 cost time: 2.906769275665283
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.798 Test Loss: 0.834 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 45 cost time: 2.9158101081848145
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.798 Test Loss: 0.834 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.9959075450897217
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.798 Test Loss: 0.832 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 47 cost time: 2.951145648956299
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.798 Test Loss: 0.831 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 48 cost time: 2.741162061691284
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.798 Test Loss: 0.831 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 49 cost time: 2.885476589202881
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.798 Test Loss: 0.830 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 50 cost time: 2.9450862407684326
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.798 Test Loss: 0.830 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.1247501373291016
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.798 Test Loss: 0.829 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 52 cost time: 2.9499311447143555
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.798 Test Loss: 0.829 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 53 cost time: 2.5966808795928955
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.798 Test Loss: 0.828 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 54 cost time: 2.702126979827881
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.798 Test Loss: 0.828 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 55 cost time: 2.883615493774414
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.798 Test Loss: 0.826 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 56 cost time: 2.731599807739258
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.798 Test Loss: 0.825 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 57 cost time: 2.8407819271087646
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.798 Test Loss: 0.825 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 58 cost time: 2.7857563495635986
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.798 Test Loss: 0.824 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 59 cost time: 3.1400179862976074
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.798 Test Loss: 0.824 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.1017446517944336
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.798 Test Loss: 0.825 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.335508108139038
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.798 Test Loss: 0.824 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 62 cost time: 3.170050859451294
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.798 Test Loss: 0.823 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 63 cost time: 3.133345365524292
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.798 Test Loss: 0.823 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 64 cost time: 2.9402222633361816
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 65 cost time: 2.942504405975342
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 66 cost time: 3.482311248779297
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.749157190322876
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.798 Test Loss: 0.821 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 68 cost time: 2.6993772983551025
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.9701991081237793
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.791259765625
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 2.8346176147460938
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.302241325378418
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.798 Test Loss: 0.821 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 73 cost time: 2.56145977973938
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.4578163623809814
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.798 Test Loss: 0.821 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 75 cost time: 2.8611862659454346
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.798 Test Loss: 0.821 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 76 cost time: 2.5612244606018066
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.798 Test Loss: 0.820 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 77 cost time: 2.6037099361419678
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.798 Test Loss: 0.820 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.5510129928588867
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.798 Test Loss: 0.819 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 79 cost time: 2.886834144592285
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.798 Test Loss: 0.819 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 80 cost time: 2.571718454360962
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.798 Test Loss: 0.819 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 81 cost time: 2.5812647342681885
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.798 Test Loss: 0.819 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 3.1487324237823486
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.798 Test Loss: 0.819 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 3.0938239097595215
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.798 Test Loss: 0.818 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 84 cost time: 3.1368658542633057
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.798 Test Loss: 0.818 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 85 cost time: 2.737593650817871
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.798 Test Loss: 0.818 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 86 cost time: 3.167203426361084
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 87 cost time: 2.7096638679504395
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 88 cost time: 2.610743284225464
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 89 cost time: 2.5968120098114014
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.786691427230835
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 91 cost time: 2.4895973205566406
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 92 cost time: 2.6983163356781006
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.798 Test Loss: 0.816 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 93 cost time: 2.822270154953003
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.798 Test Loss: 0.816 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 94 cost time: 2.707239866256714
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.798 Test Loss: 0.816 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 3.0171632766723633
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.798 Test Loss: 0.816 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 2.972421884536743
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 2.9116785526275635
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 2.7611336708068848
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 2.8995344638824463
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 2.8182122707366943
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.798 Test Loss: 0.817 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 2067983
model size : 7.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.879589796066284
Epoch: 1, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.218 Vali Acc: 0.636 Test Loss: 1.218 Test Acc: 0.636
Validation loss decreased (inf --> -0.635826).  Saving model ...
Epoch: 2 cost time: 2.1982927322387695
Epoch: 2, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.924 Vali Acc: 0.740 Test Loss: 0.924 Test Acc: 0.740
Validation loss decreased (-0.635826 --> -0.739875).  Saving model ...
Epoch: 3 cost time: 2.204312324523926
Epoch: 3, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2322280406951904
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.260 Vali Acc: 0.682 Test Loss: 1.260 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.075608015060425
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.304 Vali Acc: 0.740 Test Loss: 1.304 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2951393127441406
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.271 Vali Acc: 0.728 Test Loss: 1.271 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2615811824798584
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.728 Test Loss: 1.288 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3013296127319336
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.728 Test Loss: 1.263 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5410501956939697
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.728 Test Loss: 1.242 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4684202671051025
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.728 Test Loss: 1.221 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5054569244384766
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.728 Test Loss: 1.203 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3760130405426025
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.728 Test Loss: 1.190 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 2065935
model size : 7.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.036104917526245
Epoch: 1, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.195 Vali Acc: 0.526 Test Loss: 1.195 Test Acc: 0.526
Validation loss decreased (inf --> -0.526000).  Saving model ...
Epoch: 2 cost time: 2.397958993911743
Epoch: 2, Steps: 17 | Train Loss: 0.333 Vali Loss: 1.012 Vali Acc: 0.676 Test Loss: 1.012 Test Acc: 0.676
Validation loss decreased (-0.526000 --> -0.676290).  Saving model ...
Epoch: 3 cost time: 2.2080626487731934
Epoch: 3, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.885 Vali Acc: 0.751 Test Loss: 0.885 Test Acc: 0.751
Validation loss decreased (-0.676290 --> -0.751436).  Saving model ...
Epoch: 4 cost time: 2.092846632003784
Epoch: 4, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.796 Vali Acc: 0.763 Test Loss: 0.796 Test Acc: 0.763
Validation loss decreased (-0.751436 --> -0.762998).  Saving model ...
Epoch: 5 cost time: 2.0791563987731934
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.705 Test Loss: 0.943 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.125110149383545
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.757 Test Loss: 0.908 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1917672157287598
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.769 Test Loss: 0.866 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768777).  Saving model ...
Epoch: 8 cost time: 1.9735193252563477
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.757 Test Loss: 0.799 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1142196655273438
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 2.1568591594696045
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.780 Test Loss: 0.789 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780339).  Saving model ...
Epoch: 11 cost time: 1.927297592163086
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.780 Test Loss: 0.795 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9708259105682373
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.780 Test Loss: 0.799 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3650760650634766
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.780 Test Loss: 0.801 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.980696439743042
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.780 Test Loss: 0.799 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.086916208267212
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.780 Test Loss: 0.800 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.188711166381836
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.780 Test Loss: 0.801 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.056015968322754
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.780 Test Loss: 0.799 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2807581424713135
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.780 Test Loss: 0.799 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9405176639556885
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.780 Test Loss: 0.800 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.992119550704956
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.780 Test Loss: 0.802 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 2063887
model size : 7.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.147682189941406
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.074 Vali Acc: 0.595 Test Loss: 1.074 Test Acc: 0.595
Validation loss decreased (inf --> -0.595365).  Saving model ...
Epoch: 2 cost time: 5.341207504272461
Epoch: 2, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.636 Vali Acc: 0.786 Test Loss: 0.636 Test Acc: 0.786
Validation loss decreased (-0.595365 --> -0.786121).  Saving model ...
Epoch: 3 cost time: 4.760533809661865
Epoch: 3, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.072 Vali Acc: 0.769 Test Loss: 1.072 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.951844930648804
Epoch: 4, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.50260853767395
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.891 Vali Acc: 0.746 Test Loss: 0.891 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.109027624130249
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.804 Vali Acc: 0.780 Test Loss: 0.804 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.055823564529419
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803461).  Saving model ...
Epoch: 8 cost time: 5.14935564994812
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.792 Test Loss: 0.685 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.7031073570251465
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.792 Test Loss: 0.686 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.4112935066223145
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.792 Test Loss: 0.687 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.0281593799591064
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.798 Test Loss: 0.687 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.780980825424194
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.798 Test Loss: 0.683 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.670435428619385
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.798 Test Loss: 0.684 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.310303211212158
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.798 Test Loss: 0.684 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.497246265411377
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.798 Test Loss: 0.682 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.081830739974976
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.703903436660767
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.798 Test Loss: 0.679 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1852047
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.57371973991394
Epoch: 1, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.020 Vali Acc: 0.618 Test Loss: 1.020 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 4.2536070346832275
Epoch: 2, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.948 Vali Acc: 0.682 Test Loss: 0.948 Test Acc: 0.682
Validation loss decreased (-0.618487 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 4.134693384170532
Epoch: 3, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.785 Vali Acc: 0.728 Test Loss: 0.785 Test Acc: 0.728
Validation loss decreased (-0.682071 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 4.5137128829956055
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.942 Vali Acc: 0.757 Test Loss: 0.942 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757216).  Saving model ...
Epoch: 5 cost time: 4.202514410018921
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.677 Vali Acc: 0.792 Test Loss: 0.677 Test Acc: 0.792
Validation loss decreased (-0.757216 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 4.5283849239349365
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.910 Vali Acc: 0.757 Test Loss: 0.910 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.222474575042725
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.746 Test Loss: 0.882 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.59850549697876
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.931 Vali Acc: 0.723 Test Loss: 0.931 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.531512498855591
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.723 Test Loss: 0.922 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.248838186264038
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.723 Test Loss: 0.900 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.513056039810181
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.734 Test Loss: 0.890 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.455533981323242
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.734 Test Loss: 0.883 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.565733432769775
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.734 Test Loss: 0.875 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.320934534072876
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.734 Test Loss: 0.870 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.229178190231323
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.734 Test Loss: 0.864 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1845903
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.671792030334473
Epoch: 1, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.104 Vali Acc: 0.497 Test Loss: 1.104 Test Acc: 0.497
Validation loss decreased (inf --> -0.497099).  Saving model ...
Epoch: 2 cost time: 4.067314386367798
Epoch: 2, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.899 Vali Acc: 0.671 Test Loss: 0.899 Test Acc: 0.671
Validation loss decreased (-0.497099 --> -0.670511).  Saving model ...
Epoch: 3 cost time: 3.9012699127197266
Epoch: 3, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
Validation loss decreased (-0.670511 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 4.334550380706787
Epoch: 4, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.176 Vali Acc: 0.711 Test Loss: 1.176 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.591301679611206
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.406 Vali Acc: 0.711 Test Loss: 1.406 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4661142826080322
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.578 Vali Acc: 0.728 Test Loss: 1.578 Test Acc: 0.728
Validation loss decreased (-0.716755 --> -0.728308).  Saving model ...
Epoch: 7 cost time: 3.5850837230682373
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.038 Vali Acc: 0.763 Test Loss: 1.038 Test Acc: 0.763
Validation loss decreased (-0.728308 --> -0.762995).  Saving model ...
Epoch: 8 cost time: 3.6317787170410156
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.340 Vali Acc: 0.751 Test Loss: 1.340 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7111499309539795
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.401 Vali Acc: 0.780 Test Loss: 1.401 Test Acc: 0.780
Validation loss decreased (-0.762995 --> -0.780333).  Saving model ...
Epoch: 10 cost time: 3.718247652053833
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.740 Test Loss: 1.433 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.940735101699829
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.723 Test Loss: 1.358 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.762681007385254
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.723 Test Loss: 1.324 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.045258522033691
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.303 Vali Acc: 0.723 Test Loss: 1.303 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.385405778884888
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.728 Test Loss: 1.288 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.193870782852173
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.728 Test Loss: 1.276 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.528644323348999
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.728 Test Loss: 1.270 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.3031206130981445
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.728 Test Loss: 1.263 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.7879743576049805
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.723 Test Loss: 1.257 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.8326261043548584
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.723 Test Loss: 1.252 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1837711
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.321213483810425
Epoch: 1, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.210 Vali Acc: 0.543 Test Loss: 1.210 Test Acc: 0.543
Validation loss decreased (inf --> -0.543340).  Saving model ...
Epoch: 2 cost time: 3.5297200679779053
Epoch: 2, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.932 Vali Acc: 0.705 Test Loss: 0.932 Test Acc: 0.705
Validation loss decreased (-0.543340 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 3.1851084232330322
Epoch: 3, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.855 Vali Acc: 0.746 Test Loss: 0.855 Test Acc: 0.746
Validation loss decreased (-0.705193 --> -0.745656).  Saving model ...
Epoch: 4 cost time: 3.2460360527038574
Epoch: 4, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.117 Vali Acc: 0.734 Test Loss: 1.117 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3768105506896973
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.454 Vali Acc: 0.728 Test Loss: 1.454 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1665453910827637
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.751 Test Loss: 0.960 Test Acc: 0.751
Validation loss decreased (-0.745656 --> -0.751435).  Saving model ...
Epoch: 7 cost time: 3.561427116394043
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.757 Test Loss: 0.944 Test Acc: 0.757
Validation loss decreased (-0.751435 --> -0.757216).  Saving model ...
Epoch: 8 cost time: 3.288825273513794
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.751 Test Loss: 0.889 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0971930027008057
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.751 Test Loss: 0.877 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.192812204360962
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.757 Test Loss: 0.871 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757217).  Saving model ...
Epoch: 11 cost time: 3.3681750297546387
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.757 Test Loss: 0.869 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 12 cost time: 3.2066497802734375
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.757 Test Loss: 0.867 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 13 cost time: 3.3301002979278564
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.757 Test Loss: 0.866 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 14 cost time: 2.992931604385376
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.751 Test Loss: 0.866 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4078221321105957
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.751 Test Loss: 0.866 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.207432746887207
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.751 Test Loss: 0.865 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.613868474960327
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.763 Test Loss: 0.864 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762997).  Saving model ...
Epoch: 18 cost time: 3.2502028942108154
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.308134078979492
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.763 Test Loss: 0.867 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7272117137908936
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.842885971069336
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.7889888286590576
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.763 Test Loss: 0.865 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.462757110595703
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.763 Test Loss: 0.867 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.4497122764587402
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.763 Test Loss: 0.868 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.408590078353882
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.763 Test Loss: 0.868 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.7028024196624756
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.763 Test Loss: 0.867 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.508082628250122
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.763 Test Loss: 0.868 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1831567
model size : 7.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.42640233039856
Epoch: 1, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.188 Vali Acc: 0.549 Test Loss: 1.188 Test Acc: 0.549
Validation loss decreased (inf --> -0.549121).  Saving model ...
Epoch: 2 cost time: 2.6611762046813965
Epoch: 2, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.397 Vali Acc: 0.624 Test Loss: 1.397 Test Acc: 0.624
Validation loss decreased (-0.549121 --> -0.624263).  Saving model ...
Epoch: 3 cost time: 2.9056990146636963
Epoch: 3, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.826 Vali Acc: 0.705 Test Loss: 0.826 Test Acc: 0.705
Validation loss decreased (-0.624263 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 2.607471466064453
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.537 Vali Acc: 0.717 Test Loss: 1.537 Test Acc: 0.717
Validation loss decreased (-0.705194 --> -0.716748).  Saving model ...
Epoch: 5 cost time: 2.7188496589660645
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.189 Vali Acc: 0.746 Test Loss: 1.189 Test Acc: 0.746
Validation loss decreased (-0.716748 --> -0.745653).  Saving model ...
Epoch: 6 cost time: 2.655139684677124
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.803 Test Loss: 1.048 Test Acc: 0.803
Validation loss decreased (-0.745653 --> -0.803458).  Saving model ...
Epoch: 7 cost time: 2.8757238388061523
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.786 Test Loss: 0.923 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.204549789428711
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.769 Test Loss: 0.916 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5549745559692383
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.769 Test Loss: 0.914 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.103212833404541
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.775 Test Loss: 0.914 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0918710231781006
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.775 Test Loss: 0.912 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.797213077545166
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2183642387390137
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.775 Test Loss: 0.909 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.0296831130981445
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.002423048019409
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9443318843841553
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1825423
model size : 6.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.614567995071411
Epoch: 1, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.393 Vali Acc: 0.538 Test Loss: 1.393 Test Acc: 0.538
Validation loss decreased (inf --> -0.537558).  Saving model ...
Epoch: 2 cost time: 1.9699008464813232
Epoch: 2, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.957 Vali Acc: 0.682 Test Loss: 0.957 Test Acc: 0.682
Validation loss decreased (-0.537558 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 1.8497381210327148
Epoch: 3, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.789 Vali Acc: 0.786 Test Loss: 0.789 Test Acc: 0.786
Validation loss decreased (-0.682071 --> -0.786119).  Saving model ...
Epoch: 4 cost time: 2.103710651397705
Epoch: 4, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.245 Vali Acc: 0.740 Test Loss: 1.245 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.245209217071533
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.488 Vali Acc: 0.751 Test Loss: 1.488 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9449820518493652
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.148 Vali Acc: 0.757 Test Loss: 1.148 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.089855670928955
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.746 Test Loss: 1.162 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.066115140914917
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.757 Test Loss: 1.042 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2299070358276367
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.757 Test Loss: 1.006 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7546675205230713
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.757 Test Loss: 0.999 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9215645790100098
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.757 Test Loss: 0.994 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8155231475830078
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.757 Test Loss: 0.990 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8742046356201172
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.757 Test Loss: 0.991 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1821327
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.76280951499939
Epoch: 1, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.069 Vali Acc: 0.630 Test Loss: 1.069 Test Acc: 0.630
Validation loss decreased (inf --> -0.630047).  Saving model ...
Epoch: 2 cost time: 2.1067378520965576
Epoch: 2, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.813 Vali Acc: 0.734 Test Loss: 0.813 Test Acc: 0.734
Validation loss decreased (-0.630047 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 2.1537282466888428
Epoch: 3, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.155 Vali Acc: 0.647 Test Loss: 1.155 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2160868644714355
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.805 Vali Acc: 0.757 Test Loss: 0.805 Test Acc: 0.757
Validation loss decreased (-0.734096 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 2.2514400482177734
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.734 Test Loss: 0.781 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.255009889602661
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.786 Test Loss: 0.781 Test Acc: 0.786
Validation loss decreased (-0.757217 --> -0.786119).  Saving model ...
Epoch: 7 cost time: 2.0237698554992676
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
Validation loss decreased (-0.786119 --> -0.803460).  Saving model ...
Epoch: 8 cost time: 2.016876459121704
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.798 Test Loss: 0.739 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3042609691619873
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.798 Test Loss: 0.722 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.146566867828369
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.798 Test Loss: 0.715 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2736246585845947
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.798 Test Loss: 0.709 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1130452156066895
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.798 Test Loss: 0.705 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4492650032043457
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.798 Test Loss: 0.703 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9949138164520264
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.798 Test Loss: 0.701 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1385178565979004
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8982658386230469
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1615352630615234
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803461).  Saving model ...
Epoch: 18 cost time: 2.276285171508789
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 19 cost time: 2.402287721633911
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 20 cost time: 2.079068422317505
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0330870151519775
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 22 cost time: 2.239455223083496
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 23 cost time: 2.1922402381896973
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2690351009368896
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.353621244430542
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5826351642608643
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.4072117805480957
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.822629690170288
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.5460965633392334
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.450098991394043
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.281721353530884
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.844003915786743
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1819279
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.165111780166626
Epoch: 1, Steps: 17 | Train Loss: 1.617 Vali Loss: 0.978 Vali Acc: 0.618 Test Loss: 0.978 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 2.078768491744995
Epoch: 2, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.703 Vali Acc: 0.780 Test Loss: 0.703 Test Acc: 0.780
Validation loss decreased (-0.618487 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 1.7422122955322266
Epoch: 3, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.763 Vali Acc: 0.717 Test Loss: 0.763 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1266186237335205
Epoch: 4, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0006659030914307
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.041489601135254
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.780 Test Loss: 0.590 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780341).  Saving model ...
Epoch: 7 cost time: 1.8991615772247314
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.792 Test Loss: 0.579 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791902).  Saving model ...
Epoch: 8 cost time: 2.17059063911438
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.780 Test Loss: 0.587 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0186049938201904
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.792 Test Loss: 0.575 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 2.0635294914245605
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 2.0046980381011963
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 2.087165594100952
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.798 Test Loss: 0.563 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0727217197418213
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.798 Test Loss: 0.562 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8544659614562988
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9406802654266357
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.798 Test Loss: 0.564 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.958099126815796
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.798 Test Loss: 0.563 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.11040997505188
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8056325912475586
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7876877784729004
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9090781211853027
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.780 Test Loss: 0.566 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0055391788482666
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.786 Test Loss: 0.568 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1817231
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.753702402114868
Epoch: 1, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
Validation loss decreased (inf --> -0.485537).  Saving model ...
Epoch: 2 cost time: 5.285502195358276
Epoch: 2, Steps: 17 | Train Loss: 0.279 Vali Loss: 1.041 Vali Acc: 0.671 Test Loss: 1.041 Test Acc: 0.671
Validation loss decreased (-0.485537 --> -0.670510).  Saving model ...
Epoch: 3 cost time: 5.9253644943237305
Epoch: 3, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.558 Vali Acc: 0.798 Test Loss: 0.558 Test Acc: 0.798
Validation loss decreased (-0.670510 --> -0.797682).  Saving model ...
Epoch: 4 cost time: 5.757573366165161
Epoch: 4, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.360 Vali Acc: 0.740 Test Loss: 1.360 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.846040964126587
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.836 Vali Acc: 0.728 Test Loss: 0.836 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.5704169273376465
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.732 Vali Acc: 0.775 Test Loss: 0.732 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.280606031417847
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.164 Vali Acc: 0.734 Test Loss: 1.164 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.441037893295288
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.734 Test Loss: 1.215 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.602673768997192
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.734 Test Loss: 1.061 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.9848151206970215
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.723 Test Loss: 1.030 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.047423839569092
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.734 Test Loss: 1.025 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.512584686279297
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.740 Test Loss: 1.025 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.351890325546265
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.740 Test Loss: 1.026 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1728719
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.1591575145721436
Epoch: 1, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.055 Vali Acc: 0.543 Test Loss: 1.055 Test Acc: 0.543
Validation loss decreased (inf --> -0.543342).  Saving model ...
Epoch: 2 cost time: 4.400492906570435
Epoch: 2, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.786 Vali Acc: 0.688 Test Loss: 0.786 Test Acc: 0.688
Validation loss decreased (-0.543342 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 4.428062438964844
Epoch: 3, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.737 Vali Acc: 0.757 Test Loss: 0.737 Test Acc: 0.757
Validation loss decreased (-0.687853 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 4.741346597671509
Epoch: 4, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.881 Vali Acc: 0.734 Test Loss: 0.881 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.352779150009155
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.933 Vali Acc: 0.705 Test Loss: 0.933 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.370251178741455
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.763 Test Loss: 0.803 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 4.814266920089722
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.941 Vali Acc: 0.723 Test Loss: 0.941 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.77970027923584
Epoch: 8, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.886 Vali Acc: 0.740 Test Loss: 0.886 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.876364707946777
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.987 Vali Acc: 0.717 Test Loss: 0.987 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.247159481048584
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.212 Vali Acc: 0.757 Test Loss: 1.212 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.184098482131958
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.769 Test Loss: 1.152 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768775).  Saving model ...
Epoch: 12 cost time: 4.737902641296387
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.746 Test Loss: 1.137 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.701934576034546
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.103 Vali Acc: 0.751 Test Loss: 1.103 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.758131504058838
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.757 Test Loss: 1.083 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.970361948013306
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.775 Test Loss: 1.074 Test Acc: 0.775
Validation loss decreased (-0.768775 --> -0.774556).  Saving model ...
Epoch: 16 cost time: 4.806069374084473
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.780 Test Loss: 1.067 Test Acc: 0.780
Validation loss decreased (-0.774556 --> -0.780336).  Saving model ...
Epoch: 17 cost time: 4.519102334976196
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.780 Test Loss: 1.062 Test Acc: 0.780
Validation loss decreased (-0.780336 --> -0.780336).  Saving model ...
Epoch: 18 cost time: 5.335430145263672
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.792 Test Loss: 1.059 Test Acc: 0.792
Validation loss decreased (-0.780336 --> -0.791897).  Saving model ...
Epoch: 19 cost time: 5.139066696166992
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.792 Test Loss: 1.057 Test Acc: 0.792
Validation loss decreased (-0.791897 --> -0.791897).  Saving model ...
Epoch: 20 cost time: 4.8778605461120605
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.792 Test Loss: 1.056 Test Acc: 0.792
Validation loss decreased (-0.791897 --> -0.791897).  Saving model ...
Epoch: 21 cost time: 4.74696683883667
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.798 Test Loss: 1.054 Test Acc: 0.798
Validation loss decreased (-0.791897 --> -0.797677).  Saving model ...
Epoch: 22 cost time: 5.008837461471558
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.798 Test Loss: 1.054 Test Acc: 0.798
Validation loss decreased (-0.797677 --> -0.797677).  Saving model ...
Epoch: 23 cost time: 5.159731149673462
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.792 Test Loss: 1.052 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.822045803070068
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.792 Test Loss: 1.051 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.368649005889893
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.792 Test Loss: 1.051 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.307469844818115
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.792 Test Loss: 1.050 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.131242752075195
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.792 Test Loss: 1.049 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.679017543792725
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.798 Test Loss: 1.049 Test Acc: 0.798
Validation loss decreased (-0.797677 --> -0.797677).  Saving model ...
Epoch: 29 cost time: 4.960482597351074
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.792 Test Loss: 1.048 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.944746971130371
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.792 Test Loss: 1.047 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.160902500152588
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.786 Test Loss: 1.046 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.118577718734741
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.792 Test Loss: 1.047 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.8017706871032715
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.792 Test Loss: 1.046 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.145258903503418
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.792 Test Loss: 1.046 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.052492141723633
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.792 Test Loss: 1.045 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.701231479644775
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.792 Test Loss: 1.047 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.72855019569397
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.792 Test Loss: 1.046 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.196669340133667
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.792 Test Loss: 1.047 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1722575
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.263484716415405
Epoch: 1, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.462 Vali Acc: 0.543 Test Loss: 1.462 Test Acc: 0.543
Validation loss decreased (inf --> -0.543338).  Saving model ...
Epoch: 2 cost time: 4.2667529582977295
Epoch: 2, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.180 Vali Acc: 0.688 Test Loss: 1.180 Test Acc: 0.688
Validation loss decreased (-0.543338 --> -0.687849).  Saving model ...
Epoch: 3 cost time: 4.035864591598511
Epoch: 3, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.887 Vali Acc: 0.676 Test Loss: 0.887 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.349536418914795
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.880 Vali Acc: 0.763 Test Loss: 0.880 Test Acc: 0.763
Validation loss decreased (-0.687849 --> -0.762997).  Saving model ...
Epoch: 5 cost time: 4.234241724014282
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.149 Vali Acc: 0.734 Test Loss: 1.149 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.37332820892334
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.786 Test Loss: 0.654 Test Acc: 0.786
Validation loss decreased (-0.762997 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 4.004785776138306
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.763 Test Loss: 0.758 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9053900241851807
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.751 Test Loss: 0.958 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.021691083908081
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.751 Test Loss: 0.825 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8080170154571533
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.746 Test Loss: 0.852 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6301870346069336
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.740 Test Loss: 0.844 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.429251670837402
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.740 Test Loss: 0.833 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.8113152980804443
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.740 Test Loss: 0.823 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.0352067947387695
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.751 Test Loss: 0.814 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.413666009902954
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.757 Test Loss: 0.809 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.121812343597412
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.757 Test Loss: 0.804 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1714383
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.558669328689575
Epoch: 1, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.260 Vali Acc: 0.555 Test Loss: 1.260 Test Acc: 0.555
Validation loss decreased (inf --> -0.554901).  Saving model ...
Epoch: 2 cost time: 3.6983087062835693
Epoch: 2, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
Validation loss decreased (-0.554901 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 3.4073965549468994
Epoch: 3, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
Validation loss decreased (-0.716755 --> -0.728315).  Saving model ...
Epoch: 4 cost time: 3.424806833267212
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.967 Vali Acc: 0.717 Test Loss: 0.967 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.419947862625122
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.215 Vali Acc: 0.717 Test Loss: 1.215 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9585649967193604
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.071 Vali Acc: 0.734 Test Loss: 1.071 Test Acc: 0.734
Validation loss decreased (-0.728315 --> -0.734093).  Saving model ...
Epoch: 7 cost time: 3.594561815261841
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.728 Test Loss: 1.355 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7541074752807617
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.740 Test Loss: 1.078 Test Acc: 0.740
Validation loss decreased (-0.734093 --> -0.739874).  Saving model ...
Epoch: 9 cost time: 3.2815041542053223
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.734 Test Loss: 1.329 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4854116439819336
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.728 Test Loss: 1.221 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.679919958114624
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.711 Test Loss: 1.045 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.711334466934204
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.711 Test Loss: 1.021 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.657406806945801
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.711 Test Loss: 1.014 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.695314884185791
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.717 Test Loss: 1.015 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.953218936920166
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.723 Test Loss: 1.014 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.600402593612671
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.717 Test Loss: 1.017 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.590008020401001
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.728 Test Loss: 1.018 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7866740226745605
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.728 Test Loss: 1.018 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 1708239
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.705925464630127
Epoch: 1, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.237 Vali Acc: 0.543 Test Loss: 1.237 Test Acc: 0.543
Validation loss decreased (inf --> -0.543340).  Saving model ...
Epoch: 2 cost time: 2.6545894145965576
Epoch: 2, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
Validation loss decreased (-0.543340 --> -0.774559).  Saving model ...
Epoch: 3 cost time: 2.5409951210021973
Epoch: 3, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.211 Vali Acc: 0.723 Test Loss: 1.211 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.736452579498291
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.024 Vali Acc: 0.705 Test Loss: 1.024 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.675126791000366
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.788 Vali Acc: 0.734 Test Loss: 0.788 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.523696184158325
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.209 Vali Acc: 0.671 Test Loss: 1.209 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9754700660705566
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.705 Test Loss: 0.996 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8312788009643555
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.746 Test Loss: 0.888 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.07478404045105
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.055 Vali Acc: 0.682 Test Loss: 2.055 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8403940200805664
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.982 Vali Acc: 0.682 Test Loss: 1.982 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.732041120529175
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.426 Vali Acc: 0.694 Test Loss: 2.426 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.472252368927002
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.614 Vali Acc: 0.705 Test Loss: 2.614 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1702095
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.094825744628906
Epoch: 1, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.138 Vali Acc: 0.590 Test Loss: 1.138 Test Acc: 0.590
Validation loss decreased (inf --> -0.589584).  Saving model ...
Epoch: 2 cost time: 2.30131196975708
Epoch: 2, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.723 Vali Acc: 0.688 Test Loss: 0.723 Test Acc: 0.688
Validation loss decreased (-0.589584 --> -0.687854).  Saving model ...
Epoch: 3 cost time: 2.489793539047241
Epoch: 3, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.769 Vali Acc: 0.728 Test Loss: 0.769 Test Acc: 0.728
Validation loss decreased (-0.687854 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.2879629135131836
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.885 Vali Acc: 0.751 Test Loss: 0.885 Test Acc: 0.751
Validation loss decreased (-0.728316 --> -0.751436).  Saving model ...
Epoch: 5 cost time: 2.421285390853882
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.169 Vali Acc: 0.717 Test Loss: 1.169 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.869335651397705
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.780 Test Loss: 0.782 Test Acc: 0.780
Validation loss decreased (-0.751436 --> -0.780339).  Saving model ...
Epoch: 7 cost time: 2.464841604232788
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.780 Test Loss: 0.713 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780340).  Saving model ...
Epoch: 8 cost time: 2.575531244277954
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.780 Test Loss: 0.761 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.991438865661621
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.780 Test Loss: 0.851 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6650915145874023
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4372618198394775
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6796350479125977
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.769 Test Loss: 0.802 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9533040523529053
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.769 Test Loss: 0.795 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.51496958732605
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.780 Test Loss: 0.791 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9513320922851562
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.780 Test Loss: 0.789 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1530282497406006
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.786 Test Loss: 0.787 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786119).  Saving model ...
Epoch: 17 cost time: 2.720850706100464
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.786 Test Loss: 0.785 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 18 cost time: 2.4933230876922607
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.786 Test Loss: 0.785 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 19 cost time: 2.629711151123047
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.786 Test Loss: 0.783 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 20 cost time: 2.708073377609253
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.786 Test Loss: 0.782 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 21 cost time: 2.622732639312744
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.786 Test Loss: 0.781 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 22 cost time: 2.6523897647857666
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.786 Test Loss: 0.780 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 23 cost time: 2.657193422317505
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.786 Test Loss: 0.780 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 24 cost time: 2.57694411277771
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.786 Test Loss: 0.779 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 25 cost time: 2.5504307746887207
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 26 cost time: 2.4278578758239746
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.786 Test Loss: 0.779 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.256012439727783
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 28 cost time: 2.6671321392059326
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 29 cost time: 2.5751845836639404
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.517531156539917
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.6297857761383057
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 32 cost time: 2.6204991340637207
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.786 Test Loss: 0.776 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 33 cost time: 2.695354700088501
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.786 Test Loss: 0.776 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.9429547786712646
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.786 Test Loss: 0.776 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 35 cost time: 2.81675386428833
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.8555524349212646
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.5836055278778076
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.7101519107818604
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.6882033348083496
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.574678659439087
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.6645374298095703
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.8838601112365723
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.6736905574798584
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.786 Test Loss: 0.776 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 44 cost time: 2.5660598278045654
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.5491912364959717
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.9117653369903564
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.908029079437256
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.6769654750823975
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.6031527519226074
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.786 Test Loss: 0.777 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.9282948970794678
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.492460250854492
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.786 Test Loss: 0.779 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.8907461166381836
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.786 Test Loss: 0.779 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.2923481464385986
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.786 Test Loss: 0.779 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1697999
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.572085380554199
Epoch: 1, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.425 Vali Acc: 0.526 Test Loss: 1.425 Test Acc: 0.526
Validation loss decreased (inf --> -0.525997).  Saving model ...
Epoch: 2 cost time: 2.1542258262634277
Epoch: 2, Steps: 17 | Train Loss: 0.325 Vali Loss: 1.099 Vali Acc: 0.659 Test Loss: 1.099 Test Acc: 0.659
Validation loss decreased (-0.525997 --> -0.658949).  Saving model ...
Epoch: 3 cost time: 1.965728759765625
Epoch: 3, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.868 Vali Acc: 0.740 Test Loss: 0.868 Test Acc: 0.740
Validation loss decreased (-0.658949 --> -0.739876).  Saving model ...
Epoch: 4 cost time: 2.299713373184204
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.974 Vali Acc: 0.763 Test Loss: 0.974 Test Acc: 0.763
Validation loss decreased (-0.739876 --> -0.762996).  Saving model ...
Epoch: 5 cost time: 2.2480640411376953
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.369 Vali Acc: 0.740 Test Loss: 1.369 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0837790966033936
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.746 Test Loss: 0.875 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.608678102493286
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.929 Vali Acc: 0.746 Test Loss: 0.929 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.365553855895996
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.740 Test Loss: 0.905 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.010819435119629
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.740 Test Loss: 0.883 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.411923408508301
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.740 Test Loss: 0.873 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2994279861450195
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.751 Test Loss: 0.865 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.375023365020752
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.751 Test Loss: 0.860 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.263800859451294
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.751 Test Loss: 0.857 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.539499521255493
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.751 Test Loss: 0.855 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1695951
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.899902820587158
Epoch: 1, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.079 Vali Acc: 0.607 Test Loss: 1.079 Test Acc: 0.607
Validation loss decreased (inf --> -0.606926).  Saving model ...
Epoch: 2 cost time: 1.8299541473388672
Epoch: 2, Steps: 17 | Train Loss: 0.338 Vali Loss: 1.293 Vali Acc: 0.647 Test Loss: 1.293 Test Acc: 0.647
Validation loss decreased (-0.606926 --> -0.647386).  Saving model ...
Epoch: 3 cost time: 1.8012139797210693
Epoch: 3, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.514 Vali Acc: 0.786 Test Loss: 0.514 Test Acc: 0.786
Validation loss decreased (-0.647386 --> -0.786122).  Saving model ...
Epoch: 4 cost time: 1.7619431018829346
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.867 Vali Acc: 0.751 Test Loss: 0.867 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.046628952026367
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.096 Vali Acc: 0.694 Test Loss: 1.096 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7885589599609375
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.055 Vali Acc: 0.746 Test Loss: 1.055 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9821531772613525
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.740 Test Loss: 0.841 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.773362636566162
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.734 Test Loss: 0.793 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0192458629608154
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.751 Test Loss: 0.786 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7373104095458984
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.763 Test Loss: 0.786 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.223271369934082
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.757 Test Loss: 0.784 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9163644313812256
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.763 Test Loss: 0.784 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0788092613220215
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.757 Test Loss: 0.783 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1693903
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.069571018218994
Epoch: 1, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.155 Vali Acc: 0.538 Test Loss: 1.155 Test Acc: 0.538
Validation loss decreased (inf --> -0.537561).  Saving model ...
Epoch: 2 cost time: 5.4999144077301025
Epoch: 2, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.686 Vali Acc: 0.798 Test Loss: 0.686 Test Acc: 0.798
Validation loss decreased (-0.537561 --> -0.797681).  Saving model ...
Epoch: 3 cost time: 5.2880120277404785
Epoch: 3, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.289 Vali Acc: 0.699 Test Loss: 1.289 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.348669052124023
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.223 Vali Acc: 0.711 Test Loss: 1.223 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.169567346572876
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.974 Vali Acc: 0.711 Test Loss: 0.974 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.76756739616394
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.717 Test Loss: 1.133 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.242201089859009
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.711 Test Loss: 0.994 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.482689619064331
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.717 Test Loss: 0.942 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.143737077713013
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.929 Vali Acc: 0.711 Test Loss: 0.929 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.080476522445679
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.711 Test Loss: 0.927 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.984988212585449
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.711 Test Loss: 0.925 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.445469617843628
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.711 Test Loss: 0.922 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1667055
model size : 6.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.517267465591431
Epoch: 1, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.061 Vali Acc: 0.590 Test Loss: 1.061 Test Acc: 0.590
Validation loss decreased (inf --> -0.589585).  Saving model ...
Epoch: 2 cost time: 4.655449867248535
Epoch: 2, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.774 Vali Acc: 0.705 Test Loss: 0.774 Test Acc: 0.705
Validation loss decreased (-0.589585 --> -0.705195).  Saving model ...
Epoch: 3 cost time: 4.292203664779663
Epoch: 3, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.041 Vali Acc: 0.705 Test Loss: 1.041 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.633324384689331
Epoch: 4, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.117 Vali Acc: 0.694 Test Loss: 1.117 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.3416218757629395
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.372 Vali Acc: 0.682 Test Loss: 1.372 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.488558769226074
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.185 Vali Acc: 0.717 Test Loss: 1.185 Test Acc: 0.717
Validation loss decreased (-0.705195 --> -0.716751).  Saving model ...
Epoch: 7 cost time: 4.4625184535980225
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.128 Vali Acc: 0.717 Test Loss: 1.128 Test Acc: 0.717
Validation loss decreased (-0.716751 --> -0.716752).  Saving model ...
Epoch: 8 cost time: 4.263328552246094
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.156 Vali Acc: 0.717 Test Loss: 1.156 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.400601387023926
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.740 Test Loss: 1.127 Test Acc: 0.740
Validation loss decreased (-0.716752 --> -0.739873).  Saving model ...
Epoch: 10 cost time: 4.397369384765625
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.740 Test Loss: 1.128 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.562850475311279
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.740 Test Loss: 1.118 Test Acc: 0.740
Validation loss decreased (-0.739873 --> -0.739873).  Saving model ...
Epoch: 12 cost time: 4.635117292404175
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.740 Test Loss: 1.108 Test Acc: 0.740
Validation loss decreased (-0.739873 --> -0.739873).  Saving model ...
Epoch: 13 cost time: 4.4073646068573
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.751 Test Loss: 1.100 Test Acc: 0.751
Validation loss decreased (-0.739873 --> -0.751434).  Saving model ...
Epoch: 14 cost time: 4.568290948867798
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.746 Test Loss: 1.094 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.961576700210571
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.746 Test Loss: 1.090 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.486918210983276
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.084 Vali Acc: 0.757 Test Loss: 1.084 Test Acc: 0.757
Validation loss decreased (-0.751434 --> -0.757215).  Saving model ...
Epoch: 17 cost time: 4.3320605754852295
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.757 Test Loss: 1.081 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 18 cost time: 4.819867134094238
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.757 Test Loss: 1.081 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 19 cost time: 4.380888223648071
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.751 Test Loss: 1.079 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.833764553070068
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.757 Test Loss: 1.076 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 21 cost time: 4.316166639328003
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.751 Test Loss: 1.076 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.120267629623413
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.751 Test Loss: 1.075 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.039870977401733
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.751 Test Loss: 1.074 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.432499170303345
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.751 Test Loss: 1.074 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.8780272006988525
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.751 Test Loss: 1.074 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.059768915176392
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.751 Test Loss: 1.074 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.56194806098938
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.751 Test Loss: 1.073 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.721917152404785
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.751 Test Loss: 1.073 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.135763168334961
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.751 Test Loss: 1.072 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.1890952587127686
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.751 Test Loss: 1.071 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1660911
model size : 6.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.090633869171143
Epoch: 1, Steps: 17 | Train Loss: 1.616 Vali Loss: 0.989 Vali Acc: 0.607 Test Loss: 0.989 Test Acc: 0.607
Validation loss decreased (inf --> -0.606927).  Saving model ...
Epoch: 2 cost time: 4.046551704406738
Epoch: 2, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.652 Vali Acc: 0.746 Test Loss: 0.652 Test Acc: 0.746
Validation loss decreased (-0.606927 --> -0.745658).  Saving model ...
Epoch: 3 cost time: 4.136082649230957
Epoch: 3, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.895 Vali Acc: 0.746 Test Loss: 0.895 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.248882532119751
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.904 Vali Acc: 0.757 Test Loss: 0.904 Test Acc: 0.757
Validation loss decreased (-0.745658 --> -0.757216).  Saving model ...
Epoch: 5 cost time: 4.061864852905273
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.937 Vali Acc: 0.751 Test Loss: 0.937 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.0909459590911865
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.923 Vali Acc: 0.751 Test Loss: 0.923 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.955822229385376
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.717 Test Loss: 0.998 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.312701225280762
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.723 Test Loss: 0.876 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.699084758758545
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.734 Test Loss: 0.810 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.633082628250122
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.746 Test Loss: 0.788 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.3351829051971436
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.751 Test Loss: 0.781 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.236702919006348
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.751 Test Loss: 0.781 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.311094760894775
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
Validation loss decreased (-0.757216 --> -0.762998).  Saving model ...
Epoch: 14 cost time: 4.318953037261963
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 15 cost time: 4.16858696937561
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.763 Test Loss: 0.775 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 16 cost time: 4.727313995361328
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
Validation loss decreased (-0.762998 --> -0.774559).  Saving model ...
Epoch: 17 cost time: 3.735410690307617
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774559).  Saving model ...
Epoch: 18 cost time: 4.172699213027954
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.2161266803741455
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.775 Test Loss: 0.769 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774559).  Saving model ...
Epoch: 20 cost time: 3.9175422191619873
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.133547782897949
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.600049734115601
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.972543954849243
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.775 Test Loss: 0.773 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.023674011230469
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.350384473800659
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.820335626602173
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.073148250579834
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.259320974349976
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.0673606395721436
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1652719
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.5348286628723145
Epoch: 1, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.205 Vali Acc: 0.538 Test Loss: 1.205 Test Acc: 0.538
Validation loss decreased (inf --> -0.537560).  Saving model ...
Epoch: 2 cost time: 3.3269143104553223
Epoch: 2, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.781 Vali Acc: 0.694 Test Loss: 0.781 Test Acc: 0.694
Validation loss decreased (-0.537560 --> -0.693634).  Saving model ...
Epoch: 3 cost time: 3.3859798908233643
Epoch: 3, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.091 Vali Acc: 0.682 Test Loss: 1.091 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.522348403930664
Epoch: 4, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.836 Vali Acc: 0.723 Test Loss: 0.836 Test Acc: 0.723
Validation loss decreased (-0.693634 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 3.0090010166168213
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.551 Vali Acc: 0.705 Test Loss: 1.551 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2956016063690186
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.180 Vali Acc: 0.723 Test Loss: 1.180 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.056232452392578
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.122 Vali Acc: 0.740 Test Loss: 1.122 Test Acc: 0.740
Validation loss decreased (-0.722535 --> -0.739873).  Saving model ...
Epoch: 8 cost time: 2.862523078918457
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.431 Vali Acc: 0.711 Test Loss: 1.431 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.992577075958252
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.261 Vali Acc: 0.746 Test Loss: 1.261 Test Acc: 0.746
Validation loss decreased (-0.739873 --> -0.745652).  Saving model ...
Epoch: 10 cost time: 3.05560302734375
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.040 Vali Acc: 0.775 Test Loss: 1.040 Test Acc: 0.775
Validation loss decreased (-0.745652 --> -0.774556).  Saving model ...
Epoch: 11 cost time: 3.1811604499816895
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.763 Test Loss: 1.022 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.977752447128296
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.775 Test Loss: 0.991 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774557).  Saving model ...
Epoch: 13 cost time: 3.078592300415039
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774557).  Saving model ...
Epoch: 14 cost time: 2.8611245155334473
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.780 Test Loss: 0.973 Test Acc: 0.780
Validation loss decreased (-0.774557 --> -0.780337).  Saving model ...
Epoch: 15 cost time: 3.378229856491089
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.780 Test Loss: 0.967 Test Acc: 0.780
Validation loss decreased (-0.780337 --> -0.780337).  Saving model ...
Epoch: 16 cost time: 3.4829468727111816
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.112557888031006
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.775 Test Loss: 0.959 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.43083119392395
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.775 Test Loss: 0.957 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.641810417175293
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.775 Test Loss: 0.955 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.398963689804077
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.775 Test Loss: 0.953 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.338515043258667
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.775 Test Loss: 0.950 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6018338203430176
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.775 Test Loss: 0.948 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.547991991043091
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.078759431838989
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.775 Test Loss: 0.944 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.1895623207092285
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.775 Test Loss: 0.941 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1646575
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.082204580307007
Epoch: 1, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.317 Vali Acc: 0.578 Test Loss: 1.317 Test Acc: 0.578
Validation loss decreased (inf --> -0.578022).  Saving model ...
Epoch: 2 cost time: 2.4587414264678955
Epoch: 2, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.015 Vali Acc: 0.694 Test Loss: 1.015 Test Acc: 0.694
Validation loss decreased (-0.578022 --> -0.693631).  Saving model ...
Epoch: 3 cost time: 2.4706766605377197
Epoch: 3, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.780 Vali Acc: 0.734 Test Loss: 0.780 Test Acc: 0.734
Validation loss decreased (-0.693631 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 2.4521100521087646
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.834 Vali Acc: 0.757 Test Loss: 0.834 Test Acc: 0.757
Validation loss decreased (-0.734096 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 2.3301479816436768
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.791 Vali Acc: 0.763 Test Loss: 0.791 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762998).  Saving model ...
Epoch: 6 cost time: 2.554194688796997
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.746 Test Loss: 0.762 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5485479831695557
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.757 Test Loss: 0.805 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.74977707862854
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.763 Test Loss: 0.845 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.871999740600586
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.751 Test Loss: 0.829 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.43284273147583
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.757 Test Loss: 0.778 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.420194625854492
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 12 cost time: 2.6026861667633057
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.769 Test Loss: 0.746 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768779).  Saving model ...
Epoch: 13 cost time: 2.3904755115509033
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.780 Test Loss: 0.740 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780339).  Saving model ...
Epoch: 14 cost time: 2.4060096740722656
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.780 Test Loss: 0.735 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 15 cost time: 2.545577049255371
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.780 Test Loss: 0.733 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 16 cost time: 2.4512624740600586
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.780 Test Loss: 0.732 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780340).  Saving model ...
Epoch: 17 cost time: 2.440182685852051
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.780 Test Loss: 0.731 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 18 cost time: 2.422917127609253
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.780 Test Loss: 0.728 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 19 cost time: 2.272188425064087
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.780 Test Loss: 0.730 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.396479845046997
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.780 Test Loss: 0.728 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.217302083969116
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.780 Test Loss: 0.726 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 22 cost time: 2.5910122394561768
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.780 Test Loss: 0.725 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 23 cost time: 2.403329849243164
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.780 Test Loss: 0.726 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4702577590942383
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.780 Test Loss: 0.722 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 25 cost time: 2.422029495239258
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.780 Test Loss: 0.723 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.520987033843994
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.780 Test Loss: 0.724 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4113640785217285
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.780 Test Loss: 0.723 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0470879077911377
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.780 Test Loss: 0.722 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.470566749572754
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.780 Test Loss: 0.722 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.610536813735962
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.780 Test Loss: 0.722 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.463469982147217
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.780 Test Loss: 0.724 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.262122392654419
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.780 Test Loss: 0.725 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4114580154418945
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.780 Test Loss: 0.724 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.486933708190918
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.780 Test Loss: 0.725 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1640431
model size : 6.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.274306297302246
Epoch: 1, Steps: 17 | Train Loss: 1.665 Vali Loss: 1.181 Vali Acc: 0.526 Test Loss: 1.181 Test Acc: 0.526
Validation loss decreased (inf --> -0.526000).  Saving model ...
Epoch: 2 cost time: 1.7514746189117432
Epoch: 2, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.827 Vali Acc: 0.717 Test Loss: 0.827 Test Acc: 0.717
Validation loss decreased (-0.526000 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 1.8011078834533691
Epoch: 3, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.122 Vali Acc: 0.682 Test Loss: 1.122 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9419445991516113
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.156 Vali Acc: 0.699 Test Loss: 1.156 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9606926441192627
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.820 Vali Acc: 0.746 Test Loss: 0.820 Test Acc: 0.746
Validation loss decreased (-0.716755 --> -0.745657).  Saving model ...
Epoch: 6 cost time: 1.920781135559082
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.642 Vali Acc: 0.717 Test Loss: 1.642 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.950958490371704
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.450 Vali Acc: 0.723 Test Loss: 1.450 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0179333686828613
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.416 Vali Acc: 0.717 Test Loss: 1.416 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.945342779159546
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.752 Vali Acc: 0.746 Test Loss: 1.752 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.873802900314331
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.757 Test Loss: 1.243 Test Acc: 0.757
Validation loss decreased (-0.745657 --> -0.757213).  Saving model ...
Epoch: 11 cost time: 1.8511850833892822
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.751 Test Loss: 1.087 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8520300388336182
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.757 Test Loss: 1.055 Test Acc: 0.757
Validation loss decreased (-0.757213 --> -0.757215).  Saving model ...
Epoch: 13 cost time: 2.0625579357147217
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.757 Test Loss: 1.051 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 14 cost time: 1.7991578578948975
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.757 Test Loss: 1.047 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 15 cost time: 1.8312532901763916
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.757 Test Loss: 1.046 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 16 cost time: 1.8975214958190918
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.757 Test Loss: 1.043 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 17 cost time: 1.7168455123901367
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.757 Test Loss: 1.040 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 18 cost time: 1.730102777481079
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.757 Test Loss: 1.039 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 19 cost time: 1.7822723388671875
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.757 Test Loss: 1.038 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 20 cost time: 1.753829002380371
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.757 Test Loss: 1.039 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.719191551208496
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.757 Test Loss: 1.037 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 22 cost time: 1.6658718585968018
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.757 Test Loss: 1.037 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 23 cost time: 1.6954278945922852
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.757 Test Loss: 1.037 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757215).  Saving model ...
Epoch: 24 cost time: 2.133071184158325
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.757 Test Loss: 1.037 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6515235900878906
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.757 Test Loss: 1.037 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7211418151855469
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.757 Test Loss: 1.038 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7171523571014404
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.757 Test Loss: 1.038 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7694916725158691
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.757 Test Loss: 1.039 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6194214820861816
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.751 Test Loss: 1.039 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8500239849090576
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.763 Test Loss: 1.039 Test Acc: 0.763
Validation loss decreased (-0.757215 --> -0.762995).  Saving model ...
Epoch: 31 cost time: 1.7883296012878418
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.763 Test Loss: 1.039 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8020823001861572
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.763 Test Loss: 1.039 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 33 cost time: 1.7119319438934326
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.763 Test Loss: 1.039 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.953476905822754
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.763 Test Loss: 1.038 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 35 cost time: 1.5456626415252686
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.763 Test Loss: 1.039 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6646714210510254
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.763 Test Loss: 1.039 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8923439979553223
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.775 Test Loss: 1.039 Test Acc: 0.775
Validation loss decreased (-0.762995 --> -0.774556).  Saving model ...
Epoch: 38 cost time: 1.742954969406128
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.775 Test Loss: 1.040 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8028314113616943
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.775 Test Loss: 1.041 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7538673877716064
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.775 Test Loss: 1.041 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7769577503204346
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.775 Test Loss: 1.041 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.7504758834838867
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.775 Test Loss: 1.041 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6804113388061523
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.763 Test Loss: 1.042 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.8725380897521973
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.763 Test Loss: 1.042 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.804739236831665
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.763 Test Loss: 1.042 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.0590262413024902
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.763 Test Loss: 1.042 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.8386650085449219
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.763 Test Loss: 1.043 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1636335
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.548565626144409
Epoch: 1, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.144 Vali Acc: 0.578 Test Loss: 1.144 Test Acc: 0.578
Validation loss decreased (inf --> -0.578023).  Saving model ...
Epoch: 2 cost time: 1.8685393333435059
Epoch: 2, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.909 Vali Acc: 0.694 Test Loss: 0.909 Test Acc: 0.694
Validation loss decreased (-0.578023 --> -0.693633).  Saving model ...
Epoch: 3 cost time: 1.881805419921875
Epoch: 3, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
Validation loss decreased (-0.693633 --> -0.774560).  Saving model ...
Epoch: 4 cost time: 2.0746891498565674
Epoch: 4, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.990 Vali Acc: 0.699 Test Loss: 0.990 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.991844892501831
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.762 Vali Acc: 0.757 Test Loss: 0.762 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8712141513824463
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.728 Test Loss: 0.893 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.816251277923584
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.751 Test Loss: 0.930 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9574191570281982
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.757 Test Loss: 0.923 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8368945121765137
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.763 Test Loss: 0.893 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9617061614990234
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.763 Test Loss: 0.878 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.114105224609375
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.769 Test Loss: 0.872 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7428479194641113
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.775 Test Loss: 0.869 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.879594326019287
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.775 Test Loss: 0.863 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1634287
model size : 6.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5996813774108887
Epoch: 1, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.480 Vali Acc: 0.509 Test Loss: 1.480 Test Acc: 0.509
Validation loss decreased (inf --> -0.508656).  Saving model ...
Epoch: 2 cost time: 1.5830755233764648
Epoch: 2, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.822 Vali Acc: 0.676 Test Loss: 0.822 Test Acc: 0.676
Validation loss decreased (-0.508656 --> -0.676292).  Saving model ...
Epoch: 3 cost time: 1.649362564086914
Epoch: 3, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.676292 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 1.6151485443115234
Epoch: 4, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.905 Vali Acc: 0.699 Test Loss: 0.905 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4868509769439697
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.176 Vali Acc: 0.717 Test Loss: 1.176 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5581536293029785
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.269 Vali Acc: 0.723 Test Loss: 1.269 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.606773853302002
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.740 Test Loss: 1.005 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6148552894592285
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.740 Test Loss: 0.877 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5243332386016846
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.751 Test Loss: 0.872 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6221470832824707
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.751 Test Loss: 0.874 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4574604034423828
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.751 Test Loss: 0.870 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6131794452667236
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.751 Test Loss: 0.873 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6338880062103271
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.751 Test Loss: 0.875 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1632239
model size : 6.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.564256906509399
Epoch: 1, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.160 Vali Acc: 0.572 Test Loss: 1.160 Test Acc: 0.572
Validation loss decreased (inf --> -0.572243).  Saving model ...
Epoch: 2 cost time: 5.323391437530518
Epoch: 2, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.977 Vali Acc: 0.601 Test Loss: 0.977 Test Acc: 0.601
Validation loss decreased (-0.572243 --> -0.601146).  Saving model ...
Epoch: 3 cost time: 5.4526519775390625
Epoch: 3, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.764 Vali Acc: 0.751 Test Loss: 0.764 Test Acc: 0.751
Validation loss decreased (-0.601146 --> -0.751437).  Saving model ...
Epoch: 4 cost time: 5.219027757644653
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.813 Vali Acc: 0.723 Test Loss: 0.813 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.456690073013306
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.901 Vali Acc: 0.728 Test Loss: 0.901 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.982325315475464
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.757 Test Loss: 0.888 Test Acc: 0.757
Validation loss decreased (-0.751437 --> -0.757217).  Saving model ...
Epoch: 7 cost time: 5.3817408084869385
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
Validation loss decreased (-0.757217 --> -0.774558).  Saving model ...
Epoch: 8 cost time: 4.758854150772095
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.775 Test Loss: 0.791 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774559).  Saving model ...
Epoch: 9 cost time: 4.781400442123413
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.775 Test Loss: 0.777 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 4.657304048538208
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774559).  Saving model ...
Epoch: 11 cost time: 4.511357545852661
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.786 Test Loss: 0.749 Test Acc: 0.786
Validation loss decreased (-0.774559 --> -0.786120).  Saving model ...
Epoch: 12 cost time: 4.6056530475616455
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.786 Test Loss: 0.740 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 13 cost time: 4.6180219650268555
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.792 Test Loss: 0.733 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791900).  Saving model ...
Epoch: 14 cost time: 4.8194358348846436
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.792 Test Loss: 0.727 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 15 cost time: 5.850606203079224
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.780 Test Loss: 0.723 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.862892150878906
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.780 Test Loss: 0.717 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.335962295532227
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.780 Test Loss: 0.714 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.228280544281006
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.780 Test Loss: 0.711 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.990103483200073
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.600326299667358
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.651177644729614
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.29173469543457
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.775 Test Loss: 0.702 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.093154430389404
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.823879241943359
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1636223
model size : 6.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.3238115310668945
Epoch: 1, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.117 Vali Acc: 0.538 Test Loss: 1.117 Test Acc: 0.538
Validation loss decreased (inf --> -0.537561).  Saving model ...
Epoch: 2 cost time: 5.084928512573242
Epoch: 2, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.737 Vali Acc: 0.711 Test Loss: 0.737 Test Acc: 0.711
Validation loss decreased (-0.537561 --> -0.710975).  Saving model ...
Epoch: 3 cost time: 5.293251037597656
Epoch: 3, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.080 Vali Acc: 0.653 Test Loss: 1.080 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.169599533081055
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.865 Vali Acc: 0.734 Test Loss: 0.865 Test Acc: 0.734
Validation loss decreased (-0.710975 --> -0.734095).  Saving model ...
Epoch: 5 cost time: 4.81922459602356
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.717 Test Loss: 0.963 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.021944046020508
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.751 Test Loss: 0.967 Test Acc: 0.751
Validation loss decreased (-0.734095 --> -0.751435).  Saving model ...
Epoch: 7 cost time: 5.20277738571167
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.757 Test Loss: 0.961 Test Acc: 0.757
Validation loss decreased (-0.751435 --> -0.757216).  Saving model ...
Epoch: 8 cost time: 4.922180414199829
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.746 Test Loss: 0.943 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.757163047790527
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.740 Test Loss: 0.925 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.150721311569214
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.734 Test Loss: 0.916 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.174342155456543
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.751 Test Loss: 0.908 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.074332237243652
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.746 Test Loss: 0.896 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.747701644897461
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.746 Test Loss: 0.891 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.10080623626709
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.746 Test Loss: 0.887 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.23757004737854
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.751 Test Loss: 0.884 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.380642890930176
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.740 Test Loss: 0.880 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.030205011367798
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.740 Test Loss: 0.879 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1630079
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.570840358734131
Epoch: 1, Steps: 17 | Train Loss: 1.645 Vali Loss: 1.069 Vali Acc: 0.624 Test Loss: 1.069 Test Acc: 0.624
Validation loss decreased (inf --> -0.624267).  Saving model ...
Epoch: 2 cost time: 4.203275442123413
Epoch: 2, Steps: 17 | Train Loss: 0.325 Vali Loss: 1.076 Vali Acc: 0.653 Test Loss: 1.076 Test Acc: 0.653
Validation loss decreased (-0.624267 --> -0.653168).  Saving model ...
Epoch: 3 cost time: 3.7438390254974365
Epoch: 3, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.186 Vali Acc: 0.711 Test Loss: 1.186 Test Acc: 0.711
Validation loss decreased (-0.653168 --> -0.710971).  Saving model ...
Epoch: 4 cost time: 3.9805123805999756
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.170 Vali Acc: 0.757 Test Loss: 1.170 Test Acc: 0.757
Validation loss decreased (-0.710971 --> -0.757214).  Saving model ...
Epoch: 5 cost time: 3.836158514022827
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.840 Vali Acc: 0.763 Test Loss: 0.840 Test Acc: 0.763
Validation loss decreased (-0.757214 --> -0.762997).  Saving model ...
Epoch: 6 cost time: 4.153167963027954
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
Validation loss decreased (-0.762997 --> -0.774558).  Saving model ...
Epoch: 7 cost time: 3.9265835285186768
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.763 Test Loss: 0.885 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.059415817260742
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.769 Test Loss: 0.920 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.853330612182617
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.769 Test Loss: 0.861 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.243998050689697
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.757 Test Loss: 0.831 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4016973972320557
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.780 Test Loss: 0.819 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780339).  Saving model ...
Epoch: 12 cost time: 3.623272657394409
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.780 Test Loss: 0.808 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 13 cost time: 3.2799060344696045
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.780 Test Loss: 0.801 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 14 cost time: 3.4651052951812744
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.786 Test Loss: 0.796 Test Acc: 0.786
Validation loss decreased (-0.780339 --> -0.786119).  Saving model ...
Epoch: 15 cost time: 3.3534090518951416
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.786 Test Loss: 0.789 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 16 cost time: 3.5722250938415527
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.780 Test Loss: 0.784 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.490602493286133
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.780 Test Loss: 0.782 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.857180595397949
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.780 Test Loss: 0.780 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.0339460372924805
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.780 Test Loss: 0.778 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.195501089096069
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.780 Test Loss: 0.775 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.901638984680176
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.780 Test Loss: 0.774 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.013219356536865
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.780 Test Loss: 0.772 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.242664098739624
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.780 Test Loss: 0.772 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.043686866760254
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.780 Test Loss: 0.771 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.293832778930664
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1621887
model size : 6.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.8314197063446045
Epoch: 1, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.237 Vali Acc: 0.480 Test Loss: 1.237 Test Acc: 0.480
Validation loss decreased (inf --> -0.479756).  Saving model ...
Epoch: 2 cost time: 3.3900089263916016
Epoch: 2, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.297 Vali Acc: 0.624 Test Loss: 1.297 Test Acc: 0.624
Validation loss decreased (-0.479756 --> -0.624264).  Saving model ...
Epoch: 3 cost time: 3.265505075454712
Epoch: 3, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.285 Vali Acc: 0.653 Test Loss: 1.285 Test Acc: 0.653
Validation loss decreased (-0.624264 --> -0.653166).  Saving model ...
Epoch: 4 cost time: 3.124757766723633
Epoch: 4, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.013 Vali Acc: 0.728 Test Loss: 1.013 Test Acc: 0.728
Validation loss decreased (-0.653166 --> -0.728314).  Saving model ...
Epoch: 5 cost time: 3.264709711074829
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.207 Vali Acc: 0.728 Test Loss: 1.207 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.321714401245117
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.288 Vali Acc: 0.705 Test Loss: 1.288 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.291168212890625
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.154 Vali Acc: 0.757 Test Loss: 1.154 Test Acc: 0.757
Validation loss decreased (-0.728314 --> -0.757214).  Saving model ...
Epoch: 8 cost time: 3.4357688426971436
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.751 Test Loss: 1.223 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.398421287536621
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.751 Test Loss: 1.158 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.563931465148926
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.746 Test Loss: 1.117 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.378751039505005
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.746 Test Loss: 1.083 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.410795211791992
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.751 Test Loss: 1.068 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.5493974685668945
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.751 Test Loss: 1.060 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6495118141174316
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.746 Test Loss: 1.055 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3675575256347656
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.740 Test Loss: 1.050 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.234862804412842
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.734 Test Loss: 1.045 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1693952083587646
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.734 Test Loss: 1.036 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1615743
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.409383296966553
Epoch: 1, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.471 Vali Acc: 0.474 Test Loss: 1.471 Test Acc: 0.474
Validation loss decreased (inf --> -0.473974).  Saving model ...
Epoch: 2 cost time: 2.4358718395233154
Epoch: 2, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.752 Vali Acc: 0.734 Test Loss: 0.752 Test Acc: 0.734
Validation loss decreased (-0.473974 --> -0.734097).  Saving model ...
Epoch: 3 cost time: 2.278048515319824
Epoch: 3, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.954 Vali Acc: 0.740 Test Loss: 0.954 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739875).  Saving model ...
Epoch: 4 cost time: 2.2924787998199463
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.188 Vali Acc: 0.717 Test Loss: 1.188 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.376467704772949
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.599 Vali Acc: 0.694 Test Loss: 1.599 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.293738842010498
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.167 Vali Acc: 0.775 Test Loss: 1.167 Test Acc: 0.775
Validation loss decreased (-0.739875 --> -0.774555).  Saving model ...
Epoch: 7 cost time: 2.337454319000244
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.142 Vali Acc: 0.740 Test Loss: 1.142 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.328958511352539
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.568 Vali Acc: 0.740 Test Loss: 1.568 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6187868118286133
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.105 Vali Acc: 0.763 Test Loss: 1.105 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4376649856567383
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.751 Test Loss: 1.011 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4265050888061523
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.115 Vali Acc: 0.763 Test Loss: 1.115 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.745459794998169
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.775 Test Loss: 1.017 Test Acc: 0.775
Validation loss decreased (-0.774555 --> -0.774556).  Saving model ...
Epoch: 13 cost time: 2.4382617473602295
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.769 Test Loss: 0.944 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5161492824554443
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.769 Test Loss: 0.918 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.403066873550415
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.775 Test Loss: 0.906 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774557).  Saving model ...
Epoch: 16 cost time: 2.5782456398010254
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774558).  Saving model ...
Epoch: 17 cost time: 2.6540088653564453
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.775 Test Loss: 0.886 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 18 cost time: 2.7704262733459473
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 19 cost time: 2.7263896465301514
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.775 Test Loss: 0.872 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 20 cost time: 2.6632916927337646
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 21 cost time: 3.058802366256714
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.775 Test Loss: 0.859 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 22 cost time: 3.02651047706604
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 23 cost time: 2.8686604499816895
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.775 Test Loss: 0.849 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 24 cost time: 2.8920416831970215
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 25 cost time: 2.714015483856201
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.775 Test Loss: 0.839 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 26 cost time: 2.8408429622650146
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 27 cost time: 3.0032002925872803
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.780 Test Loss: 0.832 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780338).  Saving model ...
Epoch: 28 cost time: 3.1326630115509033
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.786 Test Loss: 0.829 Test Acc: 0.786
Validation loss decreased (-0.780338 --> -0.786119).  Saving model ...
Epoch: 29 cost time: 2.9556524753570557
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.792 Test Loss: 0.825 Test Acc: 0.792
Validation loss decreased (-0.786119 --> -0.791899).  Saving model ...
Epoch: 30 cost time: 2.9189794063568115
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.792 Test Loss: 0.821 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791899).  Saving model ...
Epoch: 31 cost time: 3.03009295463562
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.792 Test Loss: 0.818 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791899).  Saving model ...
Epoch: 32 cost time: 2.565115213394165
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.798 Test Loss: 0.816 Test Acc: 0.798
Validation loss decreased (-0.791899 --> -0.797680).  Saving model ...
Epoch: 33 cost time: 2.5065033435821533
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.798 Test Loss: 0.814 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 34 cost time: 2.6163032054901123
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.798 Test Loss: 0.811 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 35 cost time: 2.6155004501342773
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.798 Test Loss: 0.808 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 36 cost time: 2.837869882583618
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.798 Test Loss: 0.805 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 37 cost time: 2.6439132690429688
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.798 Test Loss: 0.803 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 38 cost time: 2.758073329925537
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.798 Test Loss: 0.801 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 39 cost time: 2.6660375595092773
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.798 Test Loss: 0.799 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 40 cost time: 2.703559398651123
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.798 Test Loss: 0.797 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 41 cost time: 2.864804267883301
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.798 Test Loss: 0.795 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 42 cost time: 2.6489548683166504
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.798 Test Loss: 0.793 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 43 cost time: 2.7767162322998047
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.798 Test Loss: 0.792 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 44 cost time: 2.5593199729919434
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.798 Test Loss: 0.790 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 45 cost time: 2.575561761856079
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.798 Test Loss: 0.789 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 46 cost time: 2.485182523727417
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.798 Test Loss: 0.787 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 47 cost time: 2.4063265323638916
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.798 Test Loss: 0.786 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 48 cost time: 2.625823974609375
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.798 Test Loss: 0.785 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 49 cost time: 2.630078077316284
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.798 Test Loss: 0.784 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 50 cost time: 2.805551290512085
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.798 Test Loss: 0.783 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 51 cost time: 2.6588408946990967
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.798 Test Loss: 0.782 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 52 cost time: 2.7366831302642822
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.798 Test Loss: 0.781 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 53 cost time: 2.7681360244750977
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.798 Test Loss: 0.780 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 54 cost time: 2.5932037830352783
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.798 Test Loss: 0.779 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 55 cost time: 2.857661247253418
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.798 Test Loss: 0.778 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 56 cost time: 2.923217296600342
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.798 Test Loss: 0.777 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 57 cost time: 2.8714840412139893
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.798 Test Loss: 0.776 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 58 cost time: 2.6529147624969482
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.798 Test Loss: 0.776 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 59 cost time: 2.642315626144409
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.798 Test Loss: 0.775 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 60 cost time: 2.48183012008667
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.798 Test Loss: 0.774 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 61 cost time: 2.491842746734619
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.798 Test Loss: 0.773 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 62 cost time: 2.5745151042938232
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.798 Test Loss: 0.773 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 63 cost time: 2.3412327766418457
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.798 Test Loss: 0.772 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 64 cost time: 2.530658483505249
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.798 Test Loss: 0.771 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 65 cost time: 2.426365852355957
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.798 Test Loss: 0.771 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 66 cost time: 2.3874850273132324
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.798 Test Loss: 0.770 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 67 cost time: 2.3496499061584473
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.798 Test Loss: 0.770 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 68 cost time: 2.524223566055298
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.798 Test Loss: 0.769 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 69 cost time: 2.5044713020324707
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.798 Test Loss: 0.769 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 70 cost time: 2.3361356258392334
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.798 Test Loss: 0.768 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 71 cost time: 2.3681962490081787
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.798 Test Loss: 0.768 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 72 cost time: 2.4229652881622314
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.798 Test Loss: 0.768 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 73 cost time: 2.370053768157959
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.798 Test Loss: 0.767 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 74 cost time: 2.5839545726776123
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.798 Test Loss: 0.767 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 75 cost time: 2.5649027824401855
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.798 Test Loss: 0.766 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 76 cost time: 2.405170202255249
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.798 Test Loss: 0.766 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 77 cost time: 2.7185218334198
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.798 Test Loss: 0.765 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 78 cost time: 2.4736826419830322
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.798 Test Loss: 0.765 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 79 cost time: 2.265249729156494
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.798 Test Loss: 0.764 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 80 cost time: 2.3415374755859375
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.798 Test Loss: 0.764 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 81 cost time: 2.477409601211548
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.798 Test Loss: 0.764 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.5827274322509766
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.798 Test Loss: 0.763 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 83 cost time: 2.5469603538513184
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.798 Test Loss: 0.763 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 84 cost time: 2.1266515254974365
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.798 Test Loss: 0.763 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 85 cost time: 2.442784547805786
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.798 Test Loss: 0.763 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 86 cost time: 2.4882805347442627
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.798 Test Loss: 0.762 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 87 cost time: 2.583263874053955
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.798 Test Loss: 0.762 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 88 cost time: 2.763606548309326
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.798 Test Loss: 0.762 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 2.794184923171997
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.798 Test Loss: 0.761 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 90 cost time: 2.6362850666046143
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.798 Test Loss: 0.761 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 91 cost time: 2.577707529067993
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.798 Test Loss: 0.761 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 92 cost time: 2.5480666160583496
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.798 Test Loss: 0.761 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 2.5173704624176025
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803461).  Saving model ...
Epoch: 94 cost time: 2.665349006652832
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 2.5412631034851074
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 96 cost time: 2.732706308364868
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.803 Test Loss: 0.759 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 97 cost time: 2.707486391067505
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.803 Test Loss: 0.759 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.7179620265960693
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 2.3851699829101562
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 2.727524757385254
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1609599
model size : 6.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6879379749298096
Epoch: 1, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.051 Vali Acc: 0.671 Test Loss: 1.051 Test Acc: 0.671
Validation loss decreased (inf --> -0.670510).  Saving model ...
Epoch: 2 cost time: 1.8678195476531982
Epoch: 2, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.938 Vali Acc: 0.728 Test Loss: 0.938 Test Acc: 0.728
Validation loss decreased (-0.670510 --> -0.728314).  Saving model ...
Epoch: 3 cost time: 1.7511866092681885
Epoch: 3, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.224 Vali Acc: 0.699 Test Loss: 1.224 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.844139575958252
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.687 Vali Acc: 0.798 Test Loss: 0.687 Test Acc: 0.798
Validation loss decreased (-0.728314 --> -0.797681).  Saving model ...
Epoch: 5 cost time: 1.7365081310272217
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.202 Vali Acc: 0.763 Test Loss: 1.202 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7887375354766846
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.757 Test Loss: 0.949 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8625082969665527
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.557 Vali Acc: 0.734 Test Loss: 1.557 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5799586772918701
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.935 Vali Acc: 0.751 Test Loss: 0.935 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9113616943359375
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.042 Vali Acc: 0.757 Test Loss: 1.042 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.007167100906372
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.740 Test Loss: 0.988 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9310340881347656
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8517677783966064
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.786 Test Loss: 0.956 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8694229125976562
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.786 Test Loss: 0.950 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.870600700378418
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.786 Test Loss: 0.940 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1605503
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2494630813598633
Epoch: 1, Steps: 17 | Train Loss: 1.680 Vali Loss: 0.986 Vali Acc: 0.630 Test Loss: 0.986 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 1.6743717193603516
Epoch: 2, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.896 Vali Acc: 0.705 Test Loss: 0.896 Test Acc: 0.705
Validation loss decreased (-0.630048 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 1.7259633541107178
Epoch: 3, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.727 Vali Acc: 0.757 Test Loss: 0.727 Test Acc: 0.757
Validation loss decreased (-0.705193 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 2.0448808670043945
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.032 Vali Acc: 0.746 Test Loss: 1.032 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7059125900268555
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.069 Vali Acc: 0.751 Test Loss: 1.069 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8558096885681152
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.705 Test Loss: 1.062 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7417771816253662
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.694 Test Loss: 0.965 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6482443809509277
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.723 Test Loss: 0.940 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5603771209716797
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.723 Test Loss: 0.939 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.722170114517212
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.740 Test Loss: 0.940 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7704951763153076
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.937 Vali Acc: 0.740 Test Loss: 0.937 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.525345802307129
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.746 Test Loss: 0.934 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.605297565460205
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.746 Test Loss: 0.933 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1603455
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.680816173553467
Epoch: 1, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.395 Vali Acc: 0.451 Test Loss: 1.395 Test Acc: 0.451
Validation loss decreased (inf --> -0.450853).  Saving model ...
Epoch: 2 cost time: 1.6903090476989746
Epoch: 2, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
Validation loss decreased (-0.450853 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 1.7826461791992188
Epoch: 3, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.071 Vali Acc: 0.699 Test Loss: 1.071 Test Acc: 0.699
Validation loss decreased (-0.676291 --> -0.699411).  Saving model ...
Epoch: 4 cost time: 1.7999279499053955
Epoch: 4, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.284 Vali Acc: 0.717 Test Loss: 1.284 Test Acc: 0.717
Validation loss decreased (-0.699411 --> -0.716750).  Saving model ...
Epoch: 5 cost time: 1.8358352184295654
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.824 Vali Acc: 0.763 Test Loss: 0.824 Test Acc: 0.763
Validation loss decreased (-0.716750 --> -0.762998).  Saving model ...
Epoch: 6 cost time: 1.5671310424804688
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.132 Vali Acc: 0.775 Test Loss: 1.132 Test Acc: 0.775
Validation loss decreased (-0.762998 --> -0.774555).  Saving model ...
Epoch: 7 cost time: 1.6360270977020264
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.863 Vali Acc: 0.757 Test Loss: 0.863 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7064054012298584
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.768 Vali Acc: 0.723 Test Loss: 1.768 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5844614505767822
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.864 Vali Acc: 0.792 Test Loss: 0.864 Test Acc: 0.792
Validation loss decreased (-0.774555 --> -0.791899).  Saving model ...
Epoch: 10 cost time: 1.608431100845337
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.077 Vali Acc: 0.763 Test Loss: 1.077 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5988564491271973
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.851 Vali Acc: 0.694 Test Loss: 1.851 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6927554607391357
Epoch: 12, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.572 Vali Acc: 0.757 Test Loss: 1.572 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4889633655548096
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.591 Vali Acc: 0.757 Test Loss: 1.591 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5059049129486084
Epoch: 14, Steps: 17 | Train Loss: 0.250 Vali Loss: 2.227 Vali Acc: 0.786 Test Loss: 2.227 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6865813732147217
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 2.867 Vali Acc: 0.676 Test Loss: 2.867 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5579230785369873
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 3.145 Vali Acc: 0.676 Test Loss: 3.145 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6282634735107422
Epoch: 17, Steps: 17 | Train Loss: 0.101 Vali Loss: 3.778 Vali Acc: 0.717 Test Loss: 3.778 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6648311614990234
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 3.228 Vali Acc: 0.711 Test Loss: 3.228 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.601358413696289
Epoch: 19, Steps: 17 | Train Loss: 0.069 Vali Loss: 3.069 Vali Acc: 0.711 Test Loss: 3.069 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1601407
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.521801233291626
Epoch: 1, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.540 Vali Acc: 0.439 Test Loss: 1.540 Test Acc: 0.439
Validation loss decreased (inf --> -0.439291).  Saving model ...
Epoch: 2 cost time: 5.047388315200806
Epoch: 2, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.014 Vali Acc: 0.676 Test Loss: 1.014 Test Acc: 0.676
Validation loss decreased (-0.439291 --> -0.676290).  Saving model ...
Epoch: 3 cost time: 5.054477691650391
Epoch: 3, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.964 Vali Acc: 0.694 Test Loss: 0.964 Test Acc: 0.694
Validation loss decreased (-0.676290 --> -0.693632).  Saving model ...
Epoch: 4 cost time: 5.192674398422241
Epoch: 4, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.955 Vali Acc: 0.746 Test Loss: 0.955 Test Acc: 0.746
Validation loss decreased (-0.693632 --> -0.745655).  Saving model ...
Epoch: 5 cost time: 4.9568023681640625
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.544 Vali Acc: 0.671 Test Loss: 1.544 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.904549598693848
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.952 Vali Acc: 0.763 Test Loss: 0.952 Test Acc: 0.763
Validation loss decreased (-0.745655 --> -0.762996).  Saving model ...
Epoch: 7 cost time: 5.265997409820557
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.757 Test Loss: 1.055 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.6139678955078125
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.763 Test Loss: 1.005 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.619595766067505
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.769 Test Loss: 0.981 Test Acc: 0.769
Validation loss decreased (-0.762996 --> -0.768776).  Saving model ...
Epoch: 10 cost time: 5.705273151397705
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.757 Test Loss: 0.976 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.575674772262573
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.763 Test Loss: 0.972 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.440336465835571
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.763 Test Loss: 0.966 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.509665250778198
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.769 Test Loss: 0.961 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768777).  Saving model ...
Epoch: 14 cost time: 5.736376762390137
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.769 Test Loss: 0.958 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 15 cost time: 5.523403882980347
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.769 Test Loss: 0.955 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 16 cost time: 5.318036317825317
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.769 Test Loss: 0.952 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 17 cost time: 4.860214471817017
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.769 Test Loss: 0.949 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 18 cost time: 5.020676136016846
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.769 Test Loss: 0.949 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 19 cost time: 5.11163592338562
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.769 Test Loss: 0.947 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 20 cost time: 4.995894193649292
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.946 Vali Acc: 0.769 Test Loss: 0.946 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 21 cost time: 5.062169313430786
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.769 Test Loss: 0.943 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 22 cost time: 4.989774703979492
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.769 Test Loss: 0.942 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 23 cost time: 5.070320129394531
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.769 Test Loss: 0.941 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 24 cost time: 5.037161588668823
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.769 Test Loss: 0.940 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 25 cost time: 4.975468873977661
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.769 Test Loss: 0.938 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 26 cost time: 5.1154162883758545
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.769 Test Loss: 0.938 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 27 cost time: 5.170702219009399
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.769 Test Loss: 0.935 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 28 cost time: 4.928158760070801
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.769 Test Loss: 0.935 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 29 cost time: 5.116591215133667
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.769 Test Loss: 0.934 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 30 cost time: 4.864043712615967
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.769 Test Loss: 0.933 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 31 cost time: 5.3403589725494385
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.769 Test Loss: 0.933 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.482929229736328
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.769 Test Loss: 0.932 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 33 cost time: 4.872496604919434
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.769 Test Loss: 0.930 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 34 cost time: 4.786056995391846
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.769 Test Loss: 0.930 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.900301218032837
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.929 Vali Acc: 0.769 Test Loss: 0.929 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 36 cost time: 5.022219657897949
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.929 Vali Acc: 0.769 Test Loss: 0.929 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.971502780914307
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.769 Test Loss: 0.928 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 38 cost time: 5.638382911682129
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.769 Test Loss: 0.927 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 39 cost time: 4.924416780471802
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.769 Test Loss: 0.926 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 40 cost time: 5.071709871292114
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.769 Test Loss: 0.927 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.065967082977295
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.769 Test Loss: 0.927 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.851984262466431
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.769 Test Loss: 0.925 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 43 cost time: 5.038146018981934
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.769 Test Loss: 0.924 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 44 cost time: 4.870270252227783
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.769 Test Loss: 0.925 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.075304985046387
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.769 Test Loss: 0.924 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 46 cost time: 5.016387701034546
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.769 Test Loss: 0.924 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 4.635130882263184
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.769 Test Loss: 0.924 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.324840784072876
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.769 Test Loss: 0.924 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 49 cost time: 4.790005683898926
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 50 cost time: 5.077533483505249
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.037980794906616
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 52 cost time: 4.918952703475952
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.13840126991272
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 54 cost time: 5.774192571640015
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.609796524047852
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.745929956436157
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.359803199768066
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.601219654083252
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 5.6190032958984375
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 5.590550422668457
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 5.668602705001831
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 62 cost time: 5.254297494888306
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.0003135204315186
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.038968801498413
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 4.737916469573975
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 4.702914476394653
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 5.222887992858887
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 5.0020506381988525
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 5.0719969272613525
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 70 cost time: 4.596520662307739
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 71 cost time: 5.282783269882202
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 5.054337501525879
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 5.339484214782715
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 74 cost time: 4.9323930740356445
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 75 cost time: 5.709317445755005
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.235366106033325
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 5.850732088088989
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 5.533227920532227
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 5.788960695266724
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 5.435591459274292
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 5.745214223861694
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 5.446789503097534
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 5.713514566421509
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.769 Test Loss: 0.922 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 4.86977219581604
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.769 Test Loss: 0.924 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1620807
model size : 6.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.558381795883179
Epoch: 1, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.203 Vali Acc: 0.509 Test Loss: 1.203 Test Acc: 0.509
Validation loss decreased (inf --> -0.508658).  Saving model ...
Epoch: 2 cost time: 3.6066582202911377
Epoch: 2, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.821 Vali Acc: 0.723 Test Loss: 0.821 Test Acc: 0.723
Validation loss decreased (-0.508658 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 3.432365655899048
Epoch: 3, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.339 Vali Acc: 0.682 Test Loss: 1.339 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.504495620727539
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.920 Vali Acc: 0.751 Test Loss: 0.920 Test Acc: 0.751
Validation loss decreased (-0.722535 --> -0.751436).  Saving model ...
Epoch: 5 cost time: 3.7536463737487793
Epoch: 5, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.955 Vali Acc: 0.717 Test Loss: 0.955 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.725205898284912
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.924 Vali Acc: 0.809 Test Loss: 0.924 Test Acc: 0.809
Validation loss decreased (-0.751436 --> -0.809239).  Saving model ...
Epoch: 7 cost time: 3.579224109649658
Epoch: 7, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.751 Vali Acc: 0.803 Test Loss: 0.751 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.761943817138672
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.803 Test Loss: 0.800 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.89766788482666
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.786 Test Loss: 0.848 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7050890922546387
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.786 Test Loss: 0.855 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.5740089416503906
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.786 Test Loss: 0.849 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6817374229431152
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.786 Test Loss: 0.843 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.799537181854248
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.786 Test Loss: 0.837 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.6481871604919434
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.786 Test Loss: 0.832 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.516494512557983
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.786 Test Loss: 0.829 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.55642032623291
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.786 Test Loss: 0.827 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1614663
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.663785934448242
Epoch: 1, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.406 Vali Acc: 0.555 Test Loss: 1.406 Test Acc: 0.555
Validation loss decreased (inf --> -0.554899).  Saving model ...
Epoch: 2 cost time: 3.204596996307373
Epoch: 2, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.937 Vali Acc: 0.694 Test Loss: 0.937 Test Acc: 0.694
Validation loss decreased (-0.554899 --> -0.693632).  Saving model ...
Epoch: 3 cost time: 3.396348714828491
Epoch: 3, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.577 Vali Acc: 0.665 Test Loss: 1.577 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.524756669998169
Epoch: 4, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.505 Vali Acc: 0.717 Test Loss: 1.505 Test Acc: 0.717
Validation loss decreased (-0.693632 --> -0.716748).  Saving model ...
Epoch: 5 cost time: 3.3913064002990723
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.158 Vali Acc: 0.751 Test Loss: 1.158 Test Acc: 0.751
Validation loss decreased (-0.716748 --> -0.751434).  Saving model ...
Epoch: 6 cost time: 3.220630407333374
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.071 Vali Acc: 0.723 Test Loss: 1.071 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.592939615249634
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.751 Test Loss: 0.942 Test Acc: 0.751
Validation loss decreased (-0.751434 --> -0.751436).  Saving model ...
Epoch: 8 cost time: 3.6163806915283203
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.780 Test Loss: 0.987 Test Acc: 0.780
Validation loss decreased (-0.751436 --> -0.780337).  Saving model ...
Epoch: 9 cost time: 3.576660394668579
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.780 Test Loss: 0.989 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.954413890838623
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.775 Test Loss: 0.972 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5590877532958984
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.786 Test Loss: 0.964 Test Acc: 0.786
Validation loss decreased (-0.780337 --> -0.786118).  Saving model ...
Epoch: 12 cost time: 4.019963026046753
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.775 Test Loss: 0.957 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.939094066619873
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.775 Test Loss: 0.951 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.565263032913208
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.786 Test Loss: 0.948 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 15 cost time: 3.7903130054473877
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.786 Test Loss: 0.944 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 16 cost time: 3.9186489582061768
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.775 Test Loss: 0.939 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.049419164657593
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.775 Test Loss: 0.936 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7871241569519043
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.786 Test Loss: 0.932 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 19 cost time: 3.8795547485351562
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.775 Test Loss: 0.930 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.674891948699951
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.786 Test Loss: 0.926 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 21 cost time: 3.0099613666534424
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.786 Test Loss: 0.924 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 22 cost time: 3.1988229751586914
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.786 Test Loss: 0.922 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 23 cost time: 3.0846500396728516
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.786 Test Loss: 0.920 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 24 cost time: 3.131654739379883
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.786 Test Loss: 0.918 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 25 cost time: 3.72582745552063
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.786 Test Loss: 0.916 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 26 cost time: 3.6582653522491455
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.786 Test Loss: 0.914 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786118).  Saving model ...
Epoch: 27 cost time: 3.3979570865631104
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.780 Test Loss: 0.913 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.607969284057617
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.780 Test Loss: 0.912 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.5550665855407715
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.780 Test Loss: 0.910 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.431330680847168
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.780 Test Loss: 0.909 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.29556941986084
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.780 Test Loss: 0.908 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.3727126121520996
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.780 Test Loss: 0.907 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.6890251636505127
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.780 Test Loss: 0.905 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.4882724285125732
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.780 Test Loss: 0.905 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.6389787197113037
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.780 Test Loss: 0.903 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.8355560302734375
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.780 Test Loss: 0.902 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1606471
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.521301031112671
Epoch: 1, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.106 Vali Acc: 0.584 Test Loss: 1.106 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 3.0253798961639404
Epoch: 2, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.583804 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 3.2539074420928955
Epoch: 3, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.074 Vali Acc: 0.676 Test Loss: 1.074 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.398341417312622
Epoch: 4, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.824 Vali Acc: 0.751 Test Loss: 0.824 Test Acc: 0.751
Validation loss decreased (-0.716755 --> -0.751437).  Saving model ...
Epoch: 5 cost time: 3.074803113937378
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.403 Vali Acc: 0.705 Test Loss: 1.403 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7225141525268555
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.712 Vali Acc: 0.734 Test Loss: 1.712 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.029848098754883
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.728 Test Loss: 1.146 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0282366275787354
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.734 Test Loss: 1.068 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8957865238189697
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.740 Test Loss: 0.915 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.752296209335327
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.740 Test Loss: 0.890 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7847371101379395
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.740 Test Loss: 0.888 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.903998613357544
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.740 Test Loss: 0.885 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0366969108581543
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.740 Test Loss: 0.889 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.806844711303711
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.740 Test Loss: 0.888 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1600327
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.978952646255493
Epoch: 1, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.323 Vali Acc: 0.480 Test Loss: 1.323 Test Acc: 0.480
Validation loss decreased (inf --> -0.479756).  Saving model ...
Epoch: 2 cost time: 2.3223743438720703
Epoch: 2, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.659 Vali Acc: 0.757 Test Loss: 0.659 Test Acc: 0.757
Validation loss decreased (-0.479756 --> -0.757219).  Saving model ...
Epoch: 3 cost time: 2.365466833114624
Epoch: 3, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.012 Vali Acc: 0.723 Test Loss: 1.012 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4089739322662354
Epoch: 4, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.842 Vali Acc: 0.769 Test Loss: 0.842 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768778).  Saving model ...
Epoch: 5 cost time: 2.3809916973114014
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.976 Vali Acc: 0.740 Test Loss: 0.976 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3365914821624756
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.084 Vali Acc: 0.775 Test Loss: 1.084 Test Acc: 0.775
Validation loss decreased (-0.768778 --> -0.774556).  Saving model ...
Epoch: 7 cost time: 2.2760910987854004
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.356 Vali Acc: 0.757 Test Loss: 1.356 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.45904541015625
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.364 Vali Acc: 0.723 Test Loss: 1.364 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3379557132720947
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.103 Vali Acc: 0.757 Test Loss: 1.103 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2603511810302734
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.757 Test Loss: 1.665 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.307159662246704
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.792 Test Loss: 1.418 Test Acc: 0.792
Validation loss decreased (-0.774556 --> -0.791893).  Saving model ...
Epoch: 12 cost time: 2.3757708072662354
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.792 Test Loss: 1.328 Test Acc: 0.792
Validation loss decreased (-0.791893 --> -0.791894).  Saving model ...
Epoch: 13 cost time: 2.2443225383758545
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.792 Test Loss: 1.310 Test Acc: 0.792
Validation loss decreased (-0.791894 --> -0.791894).  Saving model ...
Epoch: 14 cost time: 2.266846179962158
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.792 Test Loss: 1.304 Test Acc: 0.792
Validation loss decreased (-0.791894 --> -0.791894).  Saving model ...
Epoch: 15 cost time: 2.11590576171875
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.792 Test Loss: 1.301 Test Acc: 0.792
Validation loss decreased (-0.791894 --> -0.791895).  Saving model ...
Epoch: 16 cost time: 1.9794397354125977
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.792 Test Loss: 1.298 Test Acc: 0.792
Validation loss decreased (-0.791895 --> -0.791895).  Saving model ...
Epoch: 17 cost time: 1.9669663906097412
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.792 Test Loss: 1.295 Test Acc: 0.792
Validation loss decreased (-0.791895 --> -0.791895).  Saving model ...
Epoch: 18 cost time: 1.9142975807189941
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.792 Test Loss: 1.291 Test Acc: 0.792
Validation loss decreased (-0.791895 --> -0.791895).  Saving model ...
Epoch: 19 cost time: 1.8933608531951904
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.792 Test Loss: 1.288 Test Acc: 0.792
Validation loss decreased (-0.791895 --> -0.791895).  Saving model ...
Epoch: 20 cost time: 2.0786988735198975
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.798 Test Loss: 1.285 Test Acc: 0.798
Validation loss decreased (-0.791895 --> -0.797675).  Saving model ...
Epoch: 21 cost time: 1.9155213832855225
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.798 Test Loss: 1.283 Test Acc: 0.798
Validation loss decreased (-0.797675 --> -0.797675).  Saving model ...
Epoch: 22 cost time: 2.287431240081787
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.798 Test Loss: 1.280 Test Acc: 0.798
Validation loss decreased (-0.797675 --> -0.797675).  Saving model ...
Epoch: 23 cost time: 2.2684326171875
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.798 Test Loss: 1.278 Test Acc: 0.798
Validation loss decreased (-0.797675 --> -0.797675).  Saving model ...
Epoch: 24 cost time: 2.234466552734375
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.798 Test Loss: 1.276 Test Acc: 0.798
Validation loss decreased (-0.797675 --> -0.797675).  Saving model ...
Epoch: 25 cost time: 2.091691017150879
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.798 Test Loss: 1.273 Test Acc: 0.798
Validation loss decreased (-0.797675 --> -0.797675).  Saving model ...
Epoch: 26 cost time: 2.2541067600250244
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.798 Test Loss: 1.269 Test Acc: 0.798
Validation loss decreased (-0.797675 --> -0.797675).  Saving model ...
Epoch: 27 cost time: 2.1087300777435303
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.798 Test Loss: 1.267 Test Acc: 0.798
Validation loss decreased (-0.797675 --> -0.797675).  Saving model ...
Epoch: 28 cost time: 2.1220319271087646
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.786 Test Loss: 1.265 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0666956901550293
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.261 Vali Acc: 0.786 Test Loss: 1.261 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3128249645233154
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.786 Test Loss: 1.259 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.0791282653808594
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.786 Test Loss: 1.258 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.34173583984375
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.786 Test Loss: 1.256 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.2851133346557617
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.786 Test Loss: 1.254 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.232090711593628
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.786 Test Loss: 1.251 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.1790575981140137
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.786 Test Loss: 1.249 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.216825485229492
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.786 Test Loss: 1.247 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.1886215209960938
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.786 Test Loss: 1.245 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1594183
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.19297456741333
Epoch: 1, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.274 Vali Acc: 0.532 Test Loss: 1.274 Test Acc: 0.532
Validation loss decreased (inf --> -0.531779).  Saving model ...
Epoch: 2 cost time: 1.4836180210113525
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.993 Vali Acc: 0.688 Test Loss: 0.993 Test Acc: 0.688
Validation loss decreased (-0.531779 --> -0.687851).  Saving model ...
Epoch: 3 cost time: 1.6348700523376465
Epoch: 3, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.768 Vali Acc: 0.815 Test Loss: 0.768 Test Acc: 0.815
Validation loss decreased (-0.687851 --> -0.815021).  Saving model ...
Epoch: 4 cost time: 1.662362813949585
Epoch: 4, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.011 Vali Acc: 0.734 Test Loss: 1.011 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6581482887268066
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.025 Vali Acc: 0.723 Test Loss: 1.025 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6449933052062988
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.288 Vali Acc: 0.699 Test Loss: 1.288 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.675966739654541
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.717 Vali Acc: 0.688 Test Loss: 1.717 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5349690914154053
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.495 Vali Acc: 0.723 Test Loss: 1.495 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.509122610092163
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.239 Vali Acc: 0.780 Test Loss: 1.239 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6540858745574951
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.597 Vali Acc: 0.751 Test Loss: 1.597 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7031090259552002
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.115 Vali Acc: 0.769 Test Loss: 1.115 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7027792930603027
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.147 Vali Acc: 0.763 Test Loss: 1.147 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.677898645401001
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.763 Test Loss: 1.058 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1590087
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3188467025756836
Epoch: 1, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.147 Vali Acc: 0.572 Test Loss: 1.147 Test Acc: 0.572
Validation loss decreased (inf --> -0.572243).  Saving model ...
Epoch: 2 cost time: 1.6157679557800293
Epoch: 2, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.783 Vali Acc: 0.671 Test Loss: 0.783 Test Acc: 0.671
Validation loss decreased (-0.572243 --> -0.670512).  Saving model ...
Epoch: 3 cost time: 1.6920781135559082
Epoch: 3, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
Validation loss decreased (-0.670512 --> -0.791900).  Saving model ...
Epoch: 4 cost time: 1.5821661949157715
Epoch: 4, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.871 Vali Acc: 0.751 Test Loss: 0.871 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5771534442901611
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.878 Vali Acc: 0.786 Test Loss: 0.878 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5738275051116943
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.911 Vali Acc: 0.786 Test Loss: 0.911 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5005602836608887
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.506 Vali Acc: 0.763 Test Loss: 1.506 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.688009262084961
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.874 Vali Acc: 0.740 Test Loss: 1.874 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5927600860595703
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.757 Test Loss: 1.595 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4820027351379395
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.751 Test Loss: 1.500 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4265308380126953
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.757 Test Loss: 1.409 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5847108364105225
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.769 Test Loss: 1.375 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.445678472518921
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.763 Test Loss: 1.354 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1588039
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.643880844116211
Epoch: 1, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
Validation loss decreased (inf --> -0.595365).  Saving model ...
Epoch: 2 cost time: 1.1200976371765137
Epoch: 2, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.799 Vali Acc: 0.659 Test Loss: 0.799 Test Acc: 0.659
Validation loss decreased (-0.595365 --> -0.658952).  Saving model ...
Epoch: 3 cost time: 1.2234628200531006
Epoch: 3, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.703 Vali Acc: 0.780 Test Loss: 0.703 Test Acc: 0.780
Validation loss decreased (-0.658952 --> -0.780340).  Saving model ...
Epoch: 4 cost time: 1.1905086040496826
Epoch: 4, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.217 Vali Acc: 0.728 Test Loss: 1.217 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1332006454467773
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.956 Vali Acc: 0.717 Test Loss: 0.956 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.094294548034668
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.786 Test Loss: 0.888 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786118).  Saving model ...
Epoch: 7 cost time: 1.2417354583740234
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.763 Test Loss: 0.818 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3320796489715576
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.757 Test Loss: 0.779 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3159446716308594
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.769 Test Loss: 0.774 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2824592590332031
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.769 Test Loss: 0.774 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2730724811553955
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.775 Test Loss: 0.777 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.233731985092163
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.775 Test Loss: 0.773 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2233812808990479
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.775 Test Loss: 0.769 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3423621654510498
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3146381378173828
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4283647537231445
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.775 Test Loss: 0.770 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1585991
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.906975746154785
Epoch: 1, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.230 Vali Acc: 0.509 Test Loss: 1.230 Test Acc: 0.509
Validation loss decreased (inf --> -0.508658).  Saving model ...
Epoch: 2 cost time: 4.383621454238892
Epoch: 2, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.874 Vali Acc: 0.671 Test Loss: 0.874 Test Acc: 0.671
Validation loss decreased (-0.508658 --> -0.670511).  Saving model ...
Epoch: 3 cost time: 4.74178409576416
Epoch: 3, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.306 Vali Acc: 0.682 Test Loss: 1.306 Test Acc: 0.682
Validation loss decreased (-0.670511 --> -0.682068).  Saving model ...
Epoch: 4 cost time: 4.197775840759277
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.159 Vali Acc: 0.728 Test Loss: 1.159 Test Acc: 0.728
Validation loss decreased (-0.682068 --> -0.728312).  Saving model ...
Epoch: 5 cost time: 4.522045135498047
Epoch: 5, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.476 Vali Acc: 0.734 Test Loss: 1.476 Test Acc: 0.734
Validation loss decreased (-0.728312 --> -0.734089).  Saving model ...
Epoch: 6 cost time: 4.117846727371216
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.269 Vali Acc: 0.751 Test Loss: 1.269 Test Acc: 0.751
Validation loss decreased (-0.734089 --> -0.751432).  Saving model ...
Epoch: 7 cost time: 4.2098658084869385
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.711 Vali Acc: 0.682 Test Loss: 1.711 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.403247356414795
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.163 Vali Acc: 0.757 Test Loss: 1.163 Test Acc: 0.757
Validation loss decreased (-0.751432 --> -0.757214).  Saving model ...
Epoch: 9 cost time: 4.196907997131348
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.734 Test Loss: 1.228 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.449867248535156
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.149 Vali Acc: 0.751 Test Loss: 1.149 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.194153547286987
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.854 Vali Acc: 0.705 Test Loss: 1.854 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9768078327178955
Epoch: 12, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.982 Vali Acc: 0.728 Test Loss: 1.982 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6880955696105957
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.780 Test Loss: 1.036 Test Acc: 0.780
Validation loss decreased (-0.757214 --> -0.780336).  Saving model ...
Epoch: 14 cost time: 3.8538522720336914
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.780 Test Loss: 0.998 Test Acc: 0.780
Validation loss decreased (-0.780336 --> -0.780337).  Saving model ...
Epoch: 15 cost time: 4.059921503067017
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.780 Test Loss: 0.989 Test Acc: 0.780
Validation loss decreased (-0.780337 --> -0.780337).  Saving model ...
Epoch: 16 cost time: 4.350406169891357
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.775 Test Loss: 0.980 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.663339614868164
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.775 Test Loss: 0.971 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.924923419952393
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.775 Test Loss: 0.965 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.663922071456909
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.775 Test Loss: 0.961 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.193070888519287
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.775 Test Loss: 0.957 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.499023914337158
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.775 Test Loss: 0.952 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.92328953742981
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.519753932952881
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.775 Test Loss: 0.945 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.798568964004517
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.775 Test Loss: 0.943 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.713176250457764
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.775 Test Loss: 0.939 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1613099
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.26991868019104
Epoch: 1, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.375 Vali Acc: 0.428 Test Loss: 1.375 Test Acc: 0.428
Validation loss decreased (inf --> -0.427732).  Saving model ...
Epoch: 2 cost time: 4.5388312339782715
Epoch: 2, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.097 Vali Acc: 0.647 Test Loss: 1.097 Test Acc: 0.647
Validation loss decreased (-0.427732 --> -0.647388).  Saving model ...
Epoch: 3 cost time: 4.017906188964844
Epoch: 3, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.826 Vali Acc: 0.705 Test Loss: 0.826 Test Acc: 0.705
Validation loss decreased (-0.647388 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 4.285474538803101
Epoch: 4, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.011 Vali Acc: 0.740 Test Loss: 1.011 Test Acc: 0.740
Validation loss decreased (-0.705194 --> -0.739874).  Saving model ...
Epoch: 5 cost time: 4.103342771530151
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.889 Vali Acc: 0.717 Test Loss: 0.889 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.431745767593384
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.763 Test Loss: 0.933 Test Acc: 0.763
Validation loss decreased (-0.739874 --> -0.762996).  Saving model ...
Epoch: 7 cost time: 4.19244909286499
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.763 Test Loss: 0.801 Test Acc: 0.763
Validation loss decreased (-0.762996 --> -0.762998).  Saving model ...
Epoch: 8 cost time: 4.466149806976318
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.705 Test Loss: 1.689 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9732367992401123
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.105 Vali Acc: 0.717 Test Loss: 1.105 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.7792158126831055
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.740 Test Loss: 0.886 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.466834783554077
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.128 Vali Acc: 0.705 Test Loss: 2.128 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.139427423477173
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.405 Vali Acc: 0.694 Test Loss: 2.405 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.319935083389282
Epoch: 13, Steps: 17 | Train Loss: 0.130 Vali Loss: 2.471 Vali Acc: 0.734 Test Loss: 2.471 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.841505765914917
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.791 Vali Acc: 0.728 Test Loss: 2.791 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.336003303527832
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 3.413 Vali Acc: 0.705 Test Loss: 3.413 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.042683124542236
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.495 Vali Acc: 0.688 Test Loss: 2.495 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.899518966674805
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.614 Vali Acc: 0.740 Test Loss: 2.614 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1606955
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.975246906280518
Epoch: 1, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.366 Vali Acc: 0.486 Test Loss: 1.366 Test Acc: 0.486
Validation loss decreased (inf --> -0.485535).  Saving model ...
Epoch: 2 cost time: 3.6671199798583984
Epoch: 2, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.995 Vali Acc: 0.659 Test Loss: 0.995 Test Acc: 0.659
Validation loss decreased (-0.485535 --> -0.658950).  Saving model ...
Epoch: 3 cost time: 3.723853349685669
Epoch: 3, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.979 Vali Acc: 0.723 Test Loss: 0.979 Test Acc: 0.723
Validation loss decreased (-0.658950 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 3.743176221847534
Epoch: 4, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.251 Vali Acc: 0.746 Test Loss: 1.251 Test Acc: 0.746
Validation loss decreased (-0.722534 --> -0.745652).  Saving model ...
Epoch: 5 cost time: 3.489657402038574
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.315 Vali Acc: 0.757 Test Loss: 1.315 Test Acc: 0.757
Validation loss decreased (-0.745652 --> -0.757212).  Saving model ...
Epoch: 6 cost time: 3.730966091156006
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.123 Vali Acc: 0.751 Test Loss: 1.123 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.768855094909668
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.746 Test Loss: 1.105 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7724156379699707
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.134 Vali Acc: 0.757 Test Loss: 1.134 Test Acc: 0.757
Validation loss decreased (-0.757212 --> -0.757214).  Saving model ...
Epoch: 9 cost time: 3.710745096206665
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.397 Vali Acc: 0.717 Test Loss: 1.397 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7250564098358154
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.371 Vali Acc: 0.740 Test Loss: 1.371 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7479045391082764
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.396 Vali Acc: 0.740 Test Loss: 1.396 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.088977813720703
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.533 Vali Acc: 0.740 Test Loss: 1.533 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.144174814224243
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.728 Test Loss: 1.690 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9072818756103516
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.992 Vali Acc: 0.705 Test Loss: 1.992 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.037445306777954
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.734 Test Loss: 2.055 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.844564437866211
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.648 Vali Acc: 0.746 Test Loss: 1.648 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.967033624649048
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.497 Vali Acc: 0.705 Test Loss: 2.497 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.0242578983306885
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.236 Vali Acc: 0.751 Test Loss: 2.236 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1598763
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.020188331604004
Epoch: 1, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.279 Vali Acc: 0.491 Test Loss: 1.279 Test Acc: 0.491
Validation loss decreased (inf --> -0.491317).  Saving model ...
Epoch: 2 cost time: 2.7691478729248047
Epoch: 2, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.867 Vali Acc: 0.659 Test Loss: 0.867 Test Acc: 0.659
Validation loss decreased (-0.491317 --> -0.658951).  Saving model ...
Epoch: 3 cost time: 3.008460283279419
Epoch: 3, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.222 Vali Acc: 0.711 Test Loss: 1.222 Test Acc: 0.711
Validation loss decreased (-0.658951 --> -0.710970).  Saving model ...
Epoch: 4 cost time: 2.8767240047454834
Epoch: 4, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.923 Vali Acc: 0.705 Test Loss: 0.923 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8605892658233643
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.237 Vali Acc: 0.723 Test Loss: 1.237 Test Acc: 0.723
Validation loss decreased (-0.710970 --> -0.722531).  Saving model ...
Epoch: 6 cost time: 2.879326581954956
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.114 Vali Acc: 0.734 Test Loss: 1.114 Test Acc: 0.734
Validation loss decreased (-0.722531 --> -0.734093).  Saving model ...
Epoch: 7 cost time: 2.906285285949707
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.751 Test Loss: 1.045 Test Acc: 0.751
Validation loss decreased (-0.734093 --> -0.751435).  Saving model ...
Epoch: 8 cost time: 2.9757535457611084
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.711 Test Loss: 1.139 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.12103533744812
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.717 Test Loss: 1.151 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9739327430725098
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.723 Test Loss: 1.141 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.781100034713745
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.723 Test Loss: 1.132 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9408655166625977
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.723 Test Loss: 1.124 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.074110984802246
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.728 Test Loss: 1.117 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8193342685699463
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.112 Vali Acc: 0.728 Test Loss: 1.112 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.223919630050659
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.728 Test Loss: 1.104 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1009116172790527
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.728 Test Loss: 1.097 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.2630577087402344
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.728 Test Loss: 1.096 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1592619
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8863654136657715
Epoch: 1, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.329 Vali Acc: 0.509 Test Loss: 1.329 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 2.3758225440979004
Epoch: 2, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.024 Vali Acc: 0.630 Test Loss: 1.024 Test Acc: 0.630
Validation loss decreased (-0.508657 --> -0.630048).  Saving model ...
Epoch: 3 cost time: 2.3988304138183594
Epoch: 3, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.827 Vali Acc: 0.705 Test Loss: 0.827 Test Acc: 0.705
Validation loss decreased (-0.630048 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 2.433673143386841
Epoch: 4, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.492 Vali Acc: 0.694 Test Loss: 1.492 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0729682445526123
Epoch: 5, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.462 Vali Acc: 0.740 Test Loss: 1.462 Test Acc: 0.740
Validation loss decreased (-0.705194 --> -0.739870).  Saving model ...
Epoch: 6 cost time: 2.135802745819092
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.477 Vali Acc: 0.740 Test Loss: 1.477 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.094597101211548
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.049 Vali Acc: 0.751 Test Loss: 1.049 Test Acc: 0.751
Validation loss decreased (-0.739870 --> -0.751435).  Saving model ...
Epoch: 8 cost time: 2.252631425857544
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.027 Vali Acc: 0.717 Test Loss: 2.027 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.215247869491577
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.380 Vali Acc: 0.769 Test Loss: 1.380 Test Acc: 0.769
Validation loss decreased (-0.751435 --> -0.768772).  Saving model ...
Epoch: 10 cost time: 2.2361133098602295
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.973 Vali Acc: 0.780 Test Loss: 0.973 Test Acc: 0.780
Validation loss decreased (-0.768772 --> -0.780337).  Saving model ...
Epoch: 11 cost time: 2.3532397747039795
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.707 Vali Acc: 0.798 Test Loss: 1.707 Test Acc: 0.798
Validation loss decreased (-0.780337 --> -0.797671).  Saving model ...
Epoch: 12 cost time: 2.2898802757263184
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.478 Vali Acc: 0.786 Test Loss: 1.478 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.256955623626709
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.746 Test Loss: 1.404 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2142624855041504
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.593 Vali Acc: 0.803 Test Loss: 1.593 Test Acc: 0.803
Validation loss decreased (-0.797671 --> -0.803452).  Saving model ...
Epoch: 15 cost time: 2.2943015098571777
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.798 Test Loss: 1.735 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2081546783447266
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.798 Test Loss: 1.704 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.308119773864746
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.798 Test Loss: 1.621 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.379955291748047
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.798 Test Loss: 1.604 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2226712703704834
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.798 Test Loss: 1.596 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.249870538711548
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.798 Test Loss: 1.592 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.183389902114868
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.798 Test Loss: 1.589 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.097914934158325
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.798 Test Loss: 1.586 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.167410135269165
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.792 Test Loss: 1.583 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.426311492919922
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.792 Test Loss: 1.581 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1586475
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3243355751037598
Epoch: 1, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.204 Vali Acc: 0.572 Test Loss: 1.204 Test Acc: 0.572
Validation loss decreased (inf --> -0.572242).  Saving model ...
Epoch: 2 cost time: 1.6959490776062012
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 1.162 Vali Acc: 0.659 Test Loss: 1.162 Test Acc: 0.659
Validation loss decreased (-0.572242 --> -0.658948).  Saving model ...
Epoch: 3 cost time: 1.6163740158081055
Epoch: 3, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
Validation loss decreased (-0.658948 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 1.6627895832061768
Epoch: 4, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.437 Vali Acc: 0.653 Test Loss: 1.437 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.686950445175171
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.063 Vali Acc: 0.763 Test Loss: 1.063 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6935691833496094
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.255 Vali Acc: 0.763 Test Loss: 1.255 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5733959674835205
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.744 Vali Acc: 0.688 Test Loss: 1.744 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7411530017852783
Epoch: 8, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.790 Vali Acc: 0.671 Test Loss: 1.790 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5663552284240723
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.156 Vali Acc: 0.740 Test Loss: 1.156 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6590452194213867
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.655 Vali Acc: 0.717 Test Loss: 1.655 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5925793647766113
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.826 Vali Acc: 0.740 Test Loss: 1.826 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6393048763275146
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.657 Vali Acc: 0.757 Test Loss: 1.657 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7305431365966797
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.184 Vali Acc: 0.746 Test Loss: 2.184 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1582379
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7565674781799316
Epoch: 1, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.423 Vali Acc: 0.434 Test Loss: 1.423 Test Acc: 0.434
Validation loss decreased (inf --> -0.433512).  Saving model ...
Epoch: 2 cost time: 2.487738847732544
Epoch: 2, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.768 Vali Acc: 0.728 Test Loss: 0.768 Test Acc: 0.728
Validation loss decreased (-0.433512 --> -0.728316).  Saving model ...
Epoch: 3 cost time: 2.362044095993042
Epoch: 3, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.330 Vali Acc: 0.682 Test Loss: 1.330 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.091280937194824
Epoch: 4, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.364 Vali Acc: 0.671 Test Loss: 1.364 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2180492877960205
Epoch: 5, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.582 Vali Acc: 0.671 Test Loss: 1.582 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2581136226654053
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.632 Vali Acc: 0.786 Test Loss: 0.632 Test Acc: 0.786
Validation loss decreased (-0.728316 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 1.8332154750823975
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.794 Vali Acc: 0.757 Test Loss: 0.794 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.042539358139038
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.544 Vali Acc: 0.740 Test Loss: 1.544 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9608275890350342
Epoch: 9, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.684 Vali Acc: 0.688 Test Loss: 2.684 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.892599105834961
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.769 Vali Acc: 0.757 Test Loss: 1.769 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.006441116333008
Epoch: 11, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.410 Vali Acc: 0.728 Test Loss: 2.410 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9565186500549316
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.621 Vali Acc: 0.740 Test Loss: 1.621 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9536371231079102
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.317 Vali Acc: 0.711 Test Loss: 2.317 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.716564655303955
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.293 Vali Acc: 0.740 Test Loss: 2.293 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.886718511581421
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.173 Vali Acc: 0.734 Test Loss: 2.173 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8404512405395508
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.728 Test Loss: 1.571 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1580331
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.665215492248535
Epoch: 1, Steps: 17 | Train Loss: 1.923 Vali Loss: 1.453 Vali Acc: 0.491 Test Loss: 1.453 Test Acc: 0.491
Validation loss decreased (inf --> -0.491315).  Saving model ...
Epoch: 2 cost time: 1.524531602859497
Epoch: 2, Steps: 17 | Train Loss: 0.819 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
Validation loss decreased (-0.491315 --> -0.595365).  Saving model ...
Epoch: 3 cost time: 1.5166316032409668
Epoch: 3, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.921 Vali Acc: 0.751 Test Loss: 0.921 Test Acc: 0.751
Validation loss decreased (-0.595365 --> -0.751436).  Saving model ...
Epoch: 4 cost time: 1.3316686153411865
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.333 Vali Acc: 0.728 Test Loss: 1.333 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5840773582458496
Epoch: 5, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.204 Vali Acc: 0.734 Test Loss: 1.204 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5108685493469238
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.502 Vali Acc: 0.746 Test Loss: 1.502 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3903052806854248
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.439 Vali Acc: 0.751 Test Loss: 1.439 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.533797025680542
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.769 Test Loss: 1.106 Test Acc: 0.769
Validation loss decreased (-0.751436 --> -0.768775).  Saving model ...
Epoch: 9 cost time: 1.4012980461120605
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.809 Test Loss: 0.842 Test Acc: 0.809
Validation loss decreased (-0.768775 --> -0.809240).  Saving model ...
Epoch: 10 cost time: 1.3873133659362793
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.786 Test Loss: 0.814 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6868679523468018
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.786 Test Loss: 0.804 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6299362182617188
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.780 Test Loss: 0.810 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8297202587127686
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.792 Test Loss: 0.816 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6914293766021729
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.798 Test Loss: 0.820 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6381664276123047
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.762986183166504
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.798 Test Loss: 0.825 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5237510204315186
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.798 Test Loss: 0.829 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7543785572052002
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.798 Test Loss: 0.832 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.667332410812378
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.798 Test Loss: 0.834 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1578283
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.44145393371582
Epoch: 1, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.099 Vali Acc: 0.590 Test Loss: 1.099 Test Acc: 0.590
Validation loss decreased (inf --> -0.589584).  Saving model ...
Epoch: 2 cost time: 3.3114635944366455
Epoch: 2, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.886 Vali Acc: 0.699 Test Loss: 0.886 Test Acc: 0.699
Validation loss decreased (-0.589584 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 3.3683784008026123
Epoch: 3, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.888 Vali Acc: 0.723 Test Loss: 0.888 Test Acc: 0.723
Validation loss decreased (-0.699413 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 3.368697166442871
Epoch: 4, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.039 Vali Acc: 0.734 Test Loss: 1.039 Test Acc: 0.734
Validation loss decreased (-0.722534 --> -0.734094).  Saving model ...
Epoch: 5 cost time: 3.3413825035095215
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.008 Vali Acc: 0.751 Test Loss: 1.008 Test Acc: 0.751
Validation loss decreased (-0.734094 --> -0.751435).  Saving model ...
Epoch: 6 cost time: 3.383507490158081
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.723 Test Loss: 1.004 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3684780597686768
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.723 Test Loss: 0.908 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.352931022644043
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.746 Test Loss: 1.100 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.484419107437134
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.740 Test Loss: 0.939 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3852388858795166
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.740 Test Loss: 0.943 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4462618827819824
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.740 Test Loss: 0.943 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.421072483062744
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.740 Test Loss: 0.942 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.4125418663024902
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.740 Test Loss: 0.941 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.4772210121154785
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.740 Test Loss: 0.938 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.458881139755249
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.740 Test Loss: 0.936 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1603465
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.0445966720581055
Epoch: 1, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.034 Vali Acc: 0.636 Test Loss: 1.034 Test Acc: 0.636
Validation loss decreased (inf --> -0.635828).  Saving model ...
Epoch: 2 cost time: 3.008549451828003
Epoch: 2, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.856 Vali Acc: 0.688 Test Loss: 0.856 Test Acc: 0.688
Validation loss decreased (-0.635828 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 3.0283405780792236
Epoch: 3, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.023 Vali Acc: 0.682 Test Loss: 1.023 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.006479024887085
Epoch: 4, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.746 Test Loss: 0.821 Test Acc: 0.746
Validation loss decreased (-0.687853 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 3.0831656455993652
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.895 Vali Acc: 0.734 Test Loss: 0.895 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0982418060302734
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.769 Test Loss: 0.899 Test Acc: 0.769
Validation loss decreased (-0.745657 --> -0.768777).  Saving model ...
Epoch: 7 cost time: 2.913242816925049
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.780 Test Loss: 0.889 Test Acc: 0.780
Validation loss decreased (-0.768777 --> -0.780338).  Saving model ...
Epoch: 8 cost time: 3.276320219039917
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.746 Test Loss: 0.885 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.337041139602661
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.746 Test Loss: 0.883 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2310476303100586
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.746 Test Loss: 0.881 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2586605548858643
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.734 Test Loss: 0.881 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.340527296066284
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.746 Test Loss: 0.880 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2757787704467773
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.746 Test Loss: 0.879 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.2990775108337402
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.746 Test Loss: 0.880 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3177754878997803
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.746 Test Loss: 0.879 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1999762058258057
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.740 Test Loss: 0.879 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.295610189437866
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1597321
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.063653469085693
Epoch: 1, Steps: 17 | Train Loss: 1.666 Vali Loss: 0.984 Vali Acc: 0.659 Test Loss: 0.984 Test Acc: 0.659
Validation loss decreased (inf --> -0.658950).  Saving model ...
Epoch: 2 cost time: 4.233848333358765
Epoch: 2, Steps: 17 | Train Loss: 0.230 Vali Loss: 1.010 Vali Acc: 0.711 Test Loss: 1.010 Test Acc: 0.711
Validation loss decreased (-0.658950 --> -0.710973).  Saving model ...
Epoch: 3 cost time: 4.686519145965576
Epoch: 3, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.739 Vali Acc: 0.734 Test Loss: 0.739 Test Acc: 0.734
Validation loss decreased (-0.710973 --> -0.734097).  Saving model ...
Epoch: 4 cost time: 4.120354652404785
Epoch: 4, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.147364377975464
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.705 Test Loss: 1.124 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.067370891571045
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.717 Test Loss: 1.120 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9731578826904297
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.717 Test Loss: 1.037 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.171382665634155
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.717 Test Loss: 1.010 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.334415674209595
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.717 Test Loss: 0.995 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.9818615913391113
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.717 Test Loss: 0.985 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.2101850509643555
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.157737731933594
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.717 Test Loss: 0.968 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.163242340087891
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.717 Test Loss: 0.961 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7341040462427746
model parameter : 1589129
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.9010703563690186
Epoch: 1, Steps: 17 | Train Loss: 1.658 Vali Loss: 1.098 Vali Acc: 0.561 Test Loss: 1.098 Test Acc: 0.561
Validation loss decreased (inf --> -0.560683).  Saving model ...
Epoch: 2 cost time: 3.6240110397338867
Epoch: 2, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.726 Vali Acc: 0.757 Test Loss: 0.726 Test Acc: 0.757
Validation loss decreased (-0.560683 --> -0.757218).  Saving model ...
Epoch: 3 cost time: 3.9087235927581787
Epoch: 3, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.636274576187134
Epoch: 4, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.734 Test Loss: 0.790 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3379411697387695
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.763 Test Loss: 0.740 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762998).  Saving model ...
Epoch: 6 cost time: 3.157954692840576
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.769 Test Loss: 0.743 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768779).  Saving model ...
Epoch: 7 cost time: 3.2858195304870605
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.763 Test Loss: 0.750 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1552867889404297
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.763 Test Loss: 0.753 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0778119564056396
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.25748348236084
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.37798547744751
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.763 Test Loss: 0.758 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.159438610076904
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3581058979034424
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.9626307487487793
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.2274105548858643
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.241894006729126
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1582985
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3091344833374023
Epoch: 1, Steps: 17 | Train Loss: 1.665 Vali Loss: 1.119 Vali Acc: 0.613 Test Loss: 1.119 Test Acc: 0.613
Validation loss decreased (inf --> -0.612706).  Saving model ...
Epoch: 2 cost time: 2.3412392139434814
Epoch: 2, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.707 Vali Acc: 0.734 Test Loss: 0.707 Test Acc: 0.734
Validation loss decreased (-0.612706 --> -0.734097).  Saving model ...
Epoch: 3 cost time: 2.124396324157715
Epoch: 3, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.115 Vali Acc: 0.671 Test Loss: 1.115 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.216353178024292
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.058 Vali Acc: 0.740 Test Loss: 1.058 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739874).  Saving model ...
Epoch: 5 cost time: 2.1055562496185303
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.734 Test Loss: 1.004 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1847727298736572
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.728 Test Loss: 1.055 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.207897186279297
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.751 Test Loss: 1.214 Test Acc: 0.751
Validation loss decreased (-0.739874 --> -0.751433).  Saving model ...
Epoch: 8 cost time: 2.2151401042938232
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.152 Vali Acc: 0.751 Test Loss: 1.152 Test Acc: 0.751
Validation loss decreased (-0.751433 --> -0.751434).  Saving model ...
Epoch: 9 cost time: 1.976982593536377
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.740 Test Loss: 1.092 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3715157508850098
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.728 Test Loss: 1.070 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3029096126556396
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.734 Test Loss: 1.054 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1705992221832275
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.734 Test Loss: 1.042 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2184832096099854
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.734 Test Loss: 1.035 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.245465040206909
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.734 Test Loss: 1.030 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2234249114990234
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.734 Test Loss: 1.025 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2438530921936035
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.734 Test Loss: 1.022 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5304148197174072
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.734 Test Loss: 1.017 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.141404390335083
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.734 Test Loss: 1.015 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1576841
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9994096755981445
Epoch: 1, Steps: 17 | Train Loss: 1.710 Vali Loss: 1.160 Vali Acc: 0.607 Test Loss: 1.160 Test Acc: 0.607
Validation loss decreased (inf --> -0.606925).  Saving model ...
Epoch: 2 cost time: 1.6225802898406982
Epoch: 2, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.813 Vali Acc: 0.734 Test Loss: 0.813 Test Acc: 0.734
Validation loss decreased (-0.606925 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 1.63810396194458
Epoch: 3, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.881 Vali Acc: 0.734 Test Loss: 0.881 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.587317943572998
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.823 Vali Acc: 0.757 Test Loss: 0.823 Test Acc: 0.757
Validation loss decreased (-0.734096 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 1.5043704509735107
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.519775390625
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.734 Test Loss: 0.765 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4870235919952393
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.763 Test Loss: 0.740 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762998).  Saving model ...
Epoch: 8 cost time: 1.4607152938842773
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.763 Test Loss: 0.733 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 9 cost time: 1.6458759307861328
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.769 Test Loss: 0.734 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768779).  Saving model ...
Epoch: 10 cost time: 1.5162065029144287
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774559).  Saving model ...
Epoch: 11 cost time: 1.518782377243042
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5397088527679443
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.775 Test Loss: 0.745 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5453014373779297
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4956951141357422
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5090537071228027
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6128919124603271
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.576936960220337
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.565772533416748
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7347784042358398
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.775 Test Loss: 0.759 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8697082996368408
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1572745
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.919123411178589
Epoch: 1, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.003 Vali Acc: 0.613 Test Loss: 1.003 Test Acc: 0.613
Validation loss decreased (inf --> -0.612707).  Saving model ...
Epoch: 2 cost time: 1.5948529243469238
Epoch: 2, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.766 Vali Acc: 0.734 Test Loss: 0.766 Test Acc: 0.734
Validation loss decreased (-0.612707 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 1.80938720703125
Epoch: 3, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
Validation loss decreased (-0.734096 --> -0.803461).  Saving model ...
Epoch: 4 cost time: 1.3739280700683594
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.030 Vali Acc: 0.688 Test Loss: 1.030 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9900822639465332
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.094 Vali Acc: 0.676 Test Loss: 1.094 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9223263263702393
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.723 Test Loss: 1.027 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8441874980926514
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.134 Vali Acc: 0.705 Test Loss: 1.134 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6632416248321533
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.699 Test Loss: 1.160 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6772634983062744
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.705 Test Loss: 1.117 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.66837477684021
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.711 Test Loss: 1.100 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7013988494873047
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.717 Test Loss: 1.091 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.579162836074829
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.086 Vali Acc: 0.717 Test Loss: 1.086 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9117729663848877
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.740 Test Loss: 1.081 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1570697
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.587116003036499
Epoch: 1, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
Validation loss decreased (inf --> -0.595365).  Saving model ...
Epoch: 2 cost time: 1.5111639499664307
Epoch: 2, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.800 Vali Acc: 0.694 Test Loss: 0.800 Test Acc: 0.694
Validation loss decreased (-0.595365 --> -0.693634).  Saving model ...
Epoch: 3 cost time: 1.2900958061218262
Epoch: 3, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.797 Vali Acc: 0.717 Test Loss: 0.797 Test Acc: 0.717
Validation loss decreased (-0.693634 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 1.2570827007293701
Epoch: 4, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.723 Test Loss: 0.818 Test Acc: 0.723
Validation loss decreased (-0.716755 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 1.302008867263794
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.734 Test Loss: 0.761 Test Acc: 0.734
Validation loss decreased (-0.722535 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 1.6670713424682617
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.734 Test Loss: 0.747 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734097).  Saving model ...
Epoch: 7 cost time: 1.5256297588348389
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.746 Test Loss: 0.744 Test Acc: 0.746
Validation loss decreased (-0.734097 --> -0.745657).  Saving model ...
Epoch: 8 cost time: 1.4440736770629883
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 1.3959031105041504
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.746 Test Loss: 0.737 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 1.6340663433074951
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.746 Test Loss: 0.731 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745657).  Saving model ...
Epoch: 11 cost time: 1.6341052055358887
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.746 Test Loss: 0.729 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745657).  Saving model ...
Epoch: 12 cost time: 1.592381477355957
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.746 Test Loss: 0.727 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745657).  Saving model ...
Epoch: 13 cost time: 1.6877484321594238
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.746 Test Loss: 0.726 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745657).  Saving model ...
Epoch: 14 cost time: 1.5420074462890625
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.757 Test Loss: 0.724 Test Acc: 0.757
Validation loss decreased (-0.745657 --> -0.757218).  Saving model ...
Epoch: 15 cost time: 1.5034828186035156
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
Validation loss decreased (-0.757218 --> -0.757218).  Saving model ...
Epoch: 16 cost time: 1.6679027080535889
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4711840152740479
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4984009265899658
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
Validation loss decreased (-0.757218 --> -0.757218).  Saving model ...
Epoch: 19 cost time: 1.6402802467346191
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.595179557800293
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.757 Test Loss: 0.723 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.320310354232788
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.620023250579834
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4141592979431152
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.590479850769043
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.494990348815918
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4516661167144775
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3043830394744873
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4726741313934326
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.751 Test Loss: 0.723 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1568649
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.244920492172241
Epoch: 1, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.020 Vali Acc: 0.642 Test Loss: 1.020 Test Acc: 0.642
Validation loss decreased (inf --> -0.641608).  Saving model ...
Epoch: 2 cost time: 3.8799071311950684
Epoch: 2, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.845 Vali Acc: 0.699 Test Loss: 0.845 Test Acc: 0.699
Validation loss decreased (-0.641608 --> -0.699414).  Saving model ...
Epoch: 3 cost time: 4.083958387374878
Epoch: 3, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.059 Vali Acc: 0.734 Test Loss: 1.059 Test Acc: 0.734
Validation loss decreased (-0.699414 --> -0.734093).  Saving model ...
Epoch: 4 cost time: 3.9532134532928467
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.309 Vali Acc: 0.711 Test Loss: 1.309 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8927359580993652
Epoch: 5, Steps: 17 | Train Loss: 0.086 Vali Loss: 2.405 Vali Acc: 0.653 Test Loss: 2.405 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.538362741470337
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.062 Vali Acc: 0.763 Test Loss: 1.062 Test Acc: 0.763
Validation loss decreased (-0.734093 --> -0.762995).  Saving model ...
Epoch: 7 cost time: 3.748253345489502
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.740 Test Loss: 1.059 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.155634880065918
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.740 Test Loss: 1.109 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.800943374633789
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.757 Test Loss: 1.109 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7521860599517822
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.763 Test Loss: 1.046 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 11 cost time: 3.881690740585327
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.763 Test Loss: 1.042 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 12 cost time: 3.7830915451049805
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.763 Test Loss: 1.041 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 13 cost time: 3.5789709091186523
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.769 Test Loss: 1.040 Test Acc: 0.769
Validation loss decreased (-0.762995 --> -0.768776).  Saving model ...
Epoch: 14 cost time: 3.0974812507629395
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.769 Test Loss: 1.040 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 15 cost time: 3.053673267364502
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.769 Test Loss: 1.039 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 16 cost time: 3.0175859928131104
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.769 Test Loss: 1.040 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8567490577697754
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.769 Test Loss: 1.039 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7687597274780273
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.769 Test Loss: 1.038 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 19 cost time: 2.8293819427490234
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.769 Test Loss: 1.039 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9299209117889404
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.769 Test Loss: 1.038 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 21 cost time: 2.904463052749634
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.769 Test Loss: 1.037 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 22 cost time: 2.9023356437683105
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.769 Test Loss: 1.035 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 23 cost time: 2.9617371559143066
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.769 Test Loss: 1.036 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9229531288146973
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.769 Test Loss: 1.037 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3065547943115234
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.769 Test Loss: 1.037 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0042996406555176
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.769 Test Loss: 1.035 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 27 cost time: 3.032780408859253
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.769 Test Loss: 1.034 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 28 cost time: 3.3091423511505127
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.769 Test Loss: 1.033 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 29 cost time: 2.915776014328003
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.769 Test Loss: 1.033 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 30 cost time: 4.036585092544556
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.769 Test Loss: 1.032 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 31 cost time: 3.811697006225586
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.769 Test Loss: 1.032 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 32 cost time: 4.201456785202026
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.769 Test Loss: 1.032 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 33 cost time: 4.082180023193359
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.769 Test Loss: 1.030 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 34 cost time: 4.07900595664978
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.769 Test Loss: 1.029 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 35 cost time: 4.163831472396851
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.769 Test Loss: 1.029 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 36 cost time: 4.248932361602783
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.769 Test Loss: 1.029 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.896596670150757
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.769 Test Loss: 1.029 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 38 cost time: 4.457257032394409
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.769 Test Loss: 1.028 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 39 cost time: 4.134502649307251
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.769 Test Loss: 1.028 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.7405667304992676
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.769 Test Loss: 1.028 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 41 cost time: 4.047888517379761
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.769 Test Loss: 1.027 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 42 cost time: 3.813253879547119
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.769 Test Loss: 1.026 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 43 cost time: 3.7659919261932373
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.769 Test Loss: 1.026 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 44 cost time: 4.166765928268433
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.769 Test Loss: 1.025 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 45 cost time: 3.8118340969085693
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.769 Test Loss: 1.024 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 46 cost time: 3.958897113800049
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.769 Test Loss: 1.024 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 47 cost time: 3.999971628189087
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.769 Test Loss: 1.025 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.769371271133423
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.769 Test Loss: 1.023 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 49 cost time: 4.055386543273926
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.769 Test Loss: 1.023 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 50 cost time: 3.887394428253174
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.769 Test Loss: 1.022 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 51 cost time: 3.797091484069824
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.769 Test Loss: 1.023 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.7858569622039795
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.769 Test Loss: 1.023 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.7632555961608887
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.769 Test Loss: 1.023 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 4.037164211273193
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.769 Test Loss: 1.022 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 55 cost time: 3.756615161895752
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.769 Test Loss: 1.022 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 56 cost time: 3.967803716659546
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.769 Test Loss: 1.021 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 57 cost time: 4.346352577209473
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.769 Test Loss: 1.021 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 58 cost time: 4.023984670639038
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.769 Test Loss: 1.020 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 59 cost time: 3.8972301483154297
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.769 Test Loss: 1.020 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.543691873550415
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.769 Test Loss: 1.020 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 61 cost time: 3.9529802799224854
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.769 Test Loss: 1.020 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 62 cost time: 3.8237061500549316
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.769 Test Loss: 1.019 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 63 cost time: 3.689126491546631
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.769 Test Loss: 1.019 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 64 cost time: 3.699925661087036
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.769 Test Loss: 1.019 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 65 cost time: 3.8868634700775146
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.769 Test Loss: 1.019 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.6083872318267822
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.769 Test Loss: 1.018 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 67 cost time: 3.613205909729004
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.769 Test Loss: 1.018 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.6038217544555664
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.769 Test Loss: 1.018 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.60219407081604
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.769 Test Loss: 1.019 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.6097605228424072
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.769 Test Loss: 1.018 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 71 cost time: 3.336371660232544
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.769 Test Loss: 1.018 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.6159870624542236
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 73 cost time: 3.4660205841064453
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 74 cost time: 3.286576986312866
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 75 cost time: 3.3775129318237305
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 76 cost time: 3.5547890663146973
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 77 cost time: 3.0795440673828125
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 78 cost time: 3.3116300106048584
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 3.0171196460723877
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.769 Test Loss: 1.016 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 80 cost time: 3.258283853530884
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.769 Test Loss: 1.016 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 81 cost time: 3.3967061042785645
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.769 Test Loss: 1.016 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 82 cost time: 3.2038309574127197
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.769 Test Loss: 1.016 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 3.452113151550293
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.769 Test Loss: 1.016 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 3.4089908599853516
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.769 Test Loss: 1.015 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 85 cost time: 4.040442228317261
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.769 Test Loss: 1.016 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 3.981102705001831
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.769 Test Loss: 1.015 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 87 cost time: 4.080521583557129
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.769 Test Loss: 1.015 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 88 cost time: 4.300605297088623
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.769 Test Loss: 1.015 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 3.9291722774505615
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.769 Test Loss: 1.015 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 90 cost time: 3.9606785774230957
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.769 Test Loss: 1.015 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 91 cost time: 3.688277244567871
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.769 Test Loss: 1.014 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 92 cost time: 3.882702589035034
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.769 Test Loss: 1.014 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 93 cost time: 3.80790114402771
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 94 cost time: 3.7380213737487793
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 95 cost time: 3.818993091583252
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 3.8461222648620605
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 3.8229615688323975
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 98 cost time: 3.7690067291259766
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 99 cost time: 3.8944945335388184
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.769 Test Loss: 1.012 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 100 cost time: 3.9677963256835938
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.769 Test Loss: 1.012 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1785359
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.243757009506226
Epoch: 1, Steps: 17 | Train Loss: 1.708 Vali Loss: 1.151 Vali Acc: 0.549 Test Loss: 1.151 Test Acc: 0.549
Validation loss decreased (inf --> -0.549121).  Saving model ...
Epoch: 2 cost time: 3.28230357170105
Epoch: 2, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.944 Vali Acc: 0.699 Test Loss: 0.944 Test Acc: 0.699
Validation loss decreased (-0.549121 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 3.6798276901245117
Epoch: 3, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.046 Vali Acc: 0.751 Test Loss: 1.046 Test Acc: 0.751
Validation loss decreased (-0.699413 --> -0.751435).  Saving model ...
Epoch: 4 cost time: 3.7601022720336914
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.881 Vali Acc: 0.786 Test Loss: 0.881 Test Acc: 0.786
Validation loss decreased (-0.751435 --> -0.786118).  Saving model ...
Epoch: 5 cost time: 3.4957973957061768
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.188 Vali Acc: 0.711 Test Loss: 1.188 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.70037841796875
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.746 Test Loss: 0.851 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.887099027633667
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.780 Test Loss: 0.800 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.29833722114563
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.898744583129883
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.780 Test Loss: 0.815 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.672788381576538
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9462714195251465
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.769 Test Loss: 0.827 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.584465503692627
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.769 Test Loss: 0.828 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.2500367164611816
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.769 Test Loss: 0.827 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0509417057037354
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.769 Test Loss: 0.828 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1782287
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.712141513824463
Epoch: 1, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.100 Vali Acc: 0.549 Test Loss: 1.100 Test Acc: 0.549
Validation loss decreased (inf --> -0.549122).  Saving model ...
Epoch: 2 cost time: 2.5786447525024414
Epoch: 2, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.762 Vali Acc: 0.717 Test Loss: 0.762 Test Acc: 0.717
Validation loss decreased (-0.549122 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 2.6194238662719727
Epoch: 3, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.796 Vali Acc: 0.682 Test Loss: 0.796 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.759474754333496
Epoch: 4, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.845 Vali Acc: 0.740 Test Loss: 0.845 Test Acc: 0.740
Validation loss decreased (-0.716755 --> -0.739876).  Saving model ...
Epoch: 5 cost time: 3.115340232849121
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.746 Test Loss: 0.750 Test Acc: 0.746
Validation loss decreased (-0.739876 --> -0.745657).  Saving model ...
Epoch: 6 cost time: 2.7512168884277344
Epoch: 6, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.224 Vali Acc: 0.711 Test Loss: 1.224 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9718198776245117
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.154 Vali Acc: 0.751 Test Loss: 1.154 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751434).  Saving model ...
Epoch: 8 cost time: 3.046802282333374
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.402 Vali Acc: 0.717 Test Loss: 1.402 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.648362636566162
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.340 Vali Acc: 0.711 Test Loss: 1.340 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.068493366241455
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.188 Vali Acc: 0.723 Test Loss: 1.188 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.970686674118042
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.740 Test Loss: 0.958 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8981950283050537
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.734 Test Loss: 0.988 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6521801948547363
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.746 Test Loss: 0.969 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3499767780303955
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.751 Test Loss: 0.949 Test Acc: 0.751
Validation loss decreased (-0.751434 --> -0.751436).  Saving model ...
Epoch: 15 cost time: 2.369781732559204
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.751 Test Loss: 0.942 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 16 cost time: 2.4289093017578125
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.751 Test Loss: 0.938 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 17 cost time: 2.4016809463500977
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.751 Test Loss: 0.930 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 18 cost time: 2.6269431114196777
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.751 Test Loss: 0.927 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 19 cost time: 2.5655412673950195
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.757 Test Loss: 0.927 Test Acc: 0.757
Validation loss decreased (-0.751436 --> -0.757216).  Saving model ...
Epoch: 20 cost time: 2.4658010005950928
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.757 Test Loss: 0.927 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 21 cost time: 2.5020127296447754
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.746 Test Loss: 0.925 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0783371925354004
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.746 Test Loss: 0.923 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8885884284973145
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.746 Test Loss: 0.923 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.953584671020508
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.763 Test Loss: 0.922 Test Acc: 0.763
Validation loss decreased (-0.757216 --> -0.762997).  Saving model ...
Epoch: 25 cost time: 2.756570339202881
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.763 Test Loss: 0.921 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 26 cost time: 3.0506539344787598
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.763 Test Loss: 0.919 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 27 cost time: 2.9152374267578125
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.763 Test Loss: 0.917 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 28 cost time: 3.0777902603149414
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 29 cost time: 2.9745428562164307
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.763 Test Loss: 0.917 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.799088716506958
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.8528172969818115
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.172855854034424
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 33 cost time: 3.0933706760406494
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.763 Test Loss: 0.915 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 34 cost time: 3.1629414558410645
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.763 Test Loss: 0.915 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 35 cost time: 2.932513952255249
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.763 Test Loss: 0.915 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.249584436416626
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.763 Test Loss: 0.915 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.9694437980651855
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.0842599868774414
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.0099380016326904
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.1687405109405518
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.763 Test Loss: 0.916 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.1937060356140137
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.763 Test Loss: 0.917 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.226315498352051
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.763 Test Loss: 0.918 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.978247880935669
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.751 Test Loss: 0.919 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.7721261978149414
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.757 Test Loss: 0.919 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1778191
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.765679359436035
Epoch: 1, Steps: 17 | Train Loss: 1.650 Vali Loss: 0.983 Vali Acc: 0.607 Test Loss: 0.983 Test Acc: 0.607
Validation loss decreased (inf --> -0.606927).  Saving model ...
Epoch: 2 cost time: 2.090017795562744
Epoch: 2, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.995 Vali Acc: 0.636 Test Loss: 0.995 Test Acc: 0.636
Validation loss decreased (-0.606927 --> -0.635828).  Saving model ...
Epoch: 3 cost time: 2.572450637817383
Epoch: 3, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.138 Vali Acc: 0.751 Test Loss: 1.138 Test Acc: 0.751
Validation loss decreased (-0.635828 --> -0.751434).  Saving model ...
Epoch: 4 cost time: 2.1384081840515137
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.053 Vali Acc: 0.734 Test Loss: 1.053 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5981836318969727
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
Validation loss decreased (-0.751434 --> -0.757217).  Saving model ...
Epoch: 6 cost time: 2.5670971870422363
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.859 Vali Acc: 0.728 Test Loss: 0.859 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9743309020996094
Epoch: 7, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.768 Vali Acc: 0.809 Test Loss: 0.768 Test Acc: 0.809
Validation loss decreased (-0.757217 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 2.7180092334747314
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.458 Vali Acc: 0.746 Test Loss: 1.458 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.186295509338379
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.099 Vali Acc: 0.746 Test Loss: 1.099 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.590414047241211
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.746 Test Loss: 1.028 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2155933380126953
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.751 Test Loss: 0.949 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.638566493988037
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.763 Test Loss: 0.920 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0502073764801025
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.757 Test Loss: 0.905 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.524299144744873
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.763 Test Loss: 0.895 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.860224962234497
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.763 Test Loss: 0.886 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9711620807647705
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.769 Test Loss: 0.879 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9652752876281738
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.763 Test Loss: 0.872 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1775119
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6860547065734863
Epoch: 1, Steps: 17 | Train Loss: 1.628 Vali Loss: 0.967 Vali Acc: 0.630 Test Loss: 0.967 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 1.9248242378234863
Epoch: 2, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.112 Vali Acc: 0.728 Test Loss: 1.112 Test Acc: 0.728
Validation loss decreased (-0.630048 --> -0.728313).  Saving model ...
Epoch: 3 cost time: 2.002572774887085
Epoch: 3, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.156 Vali Acc: 0.682 Test Loss: 1.156 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2884316444396973
Epoch: 4, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.003 Vali Acc: 0.728 Test Loss: 1.003 Test Acc: 0.728
Validation loss decreased (-0.728313 --> -0.728314).  Saving model ...
Epoch: 5 cost time: 1.7941913604736328
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.957 Vali Acc: 0.780 Test Loss: 0.957 Test Acc: 0.780
Validation loss decreased (-0.728314 --> -0.780337).  Saving model ...
Epoch: 6 cost time: 2.283517360687256
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.784 Vali Acc: 0.734 Test Loss: 1.784 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9194927215576172
Epoch: 7, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.930 Vali Acc: 0.757 Test Loss: 0.930 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7936105728149414
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.792 Test Loss: 0.903 Test Acc: 0.792
Validation loss decreased (-0.780337 --> -0.791898).  Saving model ...
Epoch: 9 cost time: 2.2821438312530518
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.780 Test Loss: 0.819 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9001274108886719
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.780 Test Loss: 0.808 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.163747549057007
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.780 Test Loss: 0.806 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.00835919380188
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.792 Test Loss: 0.805 Test Acc: 0.792
Validation loss decreased (-0.791898 --> -0.791899).  Saving model ...
Epoch: 13 cost time: 1.8699586391448975
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.792 Test Loss: 0.803 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791899).  Saving model ...
Epoch: 14 cost time: 2.2672195434570312
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.792 Test Loss: 0.801 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791900).  Saving model ...
Epoch: 15 cost time: 1.878040075302124
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.792 Test Loss: 0.800 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 16 cost time: 2.4697535037994385
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.792 Test Loss: 0.799 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 17 cost time: 1.6342065334320068
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.792 Test Loss: 0.797 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 18 cost time: 1.8094439506530762
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.792 Test Loss: 0.795 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 19 cost time: 1.8800690174102783
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.792 Test Loss: 0.794 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 20 cost time: 1.6609959602355957
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.792 Test Loss: 0.794 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5774433612823486
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.792 Test Loss: 0.793 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 22 cost time: 1.806776523590088
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.792 Test Loss: 0.792 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 23 cost time: 1.8205249309539795
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.786 Test Loss: 0.792 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.953897476196289
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.786 Test Loss: 0.790 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9142909049987793
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.786 Test Loss: 0.790 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8384461402893066
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.786 Test Loss: 0.790 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7729246616363525
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.786 Test Loss: 0.789 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9086921215057373
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.786 Test Loss: 0.788 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8517160415649414
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.786 Test Loss: 0.788 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9287219047546387
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.786 Test Loss: 0.787 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8352463245391846
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.786 Test Loss: 0.787 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.943068265914917
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.786 Test Loss: 0.787 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1772047
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.914072275161743
Epoch: 1, Steps: 17 | Train Loss: 1.694 Vali Loss: 0.982 Vali Acc: 0.607 Test Loss: 0.982 Test Acc: 0.607
Validation loss decreased (inf --> -0.606927).  Saving model ...
Epoch: 2 cost time: 1.6164875030517578
Epoch: 2, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.711 Vali Acc: 0.717 Test Loss: 0.711 Test Acc: 0.717
Validation loss decreased (-0.606927 --> -0.716756).  Saving model ...
Epoch: 3 cost time: 1.6009812355041504
Epoch: 3, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.944 Vali Acc: 0.769 Test Loss: 0.944 Test Acc: 0.769
Validation loss decreased (-0.716756 --> -0.768777).  Saving model ...
Epoch: 4 cost time: 1.5814485549926758
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.207 Vali Acc: 0.688 Test Loss: 1.207 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.777048110961914
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.907 Vali Acc: 0.746 Test Loss: 0.907 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8370702266693115
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.859 Vali Acc: 0.763 Test Loss: 0.859 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.789660930633545
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.688 Test Loss: 0.862 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6164729595184326
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.751 Test Loss: 0.869 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5578534603118896
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.734 Test Loss: 0.860 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8554399013519287
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7343244552612305
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.734 Test Loss: 0.801 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7324645519256592
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.740 Test Loss: 0.788 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5904631614685059
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.740 Test Loss: 0.779 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1769999
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.423492908477783
Epoch: 1, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.285 Vali Acc: 0.526 Test Loss: 1.285 Test Acc: 0.526
Validation loss decreased (inf --> -0.525999).  Saving model ...
Epoch: 2 cost time: 1.31099534034729
Epoch: 2, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.906 Vali Acc: 0.705 Test Loss: 0.906 Test Acc: 0.705
Validation loss decreased (-0.525999 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 1.4908645153045654
Epoch: 3, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.928 Vali Acc: 0.717 Test Loss: 0.928 Test Acc: 0.717
Validation loss decreased (-0.705193 --> -0.716754).  Saving model ...
Epoch: 4 cost time: 1.45609712600708
Epoch: 4, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.960 Vali Acc: 0.757 Test Loss: 0.960 Test Acc: 0.757
Validation loss decreased (-0.716754 --> -0.757216).  Saving model ...
Epoch: 5 cost time: 1.157984733581543
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.079 Vali Acc: 0.723 Test Loss: 1.079 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4382071495056152
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.757216 --> -0.774557).  Saving model ...
Epoch: 7 cost time: 1.4159693717956543
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.181 Vali Acc: 0.740 Test Loss: 1.181 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3902382850646973
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.746 Test Loss: 0.896 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4103178977966309
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.746 Test Loss: 0.848 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3781297206878662
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.751 Test Loss: 0.842 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0788321495056152
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3340046405792236
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3679676055908203
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3235392570495605
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5535006523132324
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3155300617218018
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1768975
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5137076377868652
Epoch: 1, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.211 Vali Acc: 0.566 Test Loss: 1.211 Test Acc: 0.566
Validation loss decreased (inf --> -0.566462).  Saving model ...
Epoch: 2 cost time: 1.3745627403259277
Epoch: 2, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.566462 --> -0.716756).  Saving model ...
Epoch: 3 cost time: 1.3226392269134521
Epoch: 3, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.011 Vali Acc: 0.723 Test Loss: 1.011 Test Acc: 0.723
Validation loss decreased (-0.716756 --> -0.722533).  Saving model ...
Epoch: 4 cost time: 1.3446295261383057
Epoch: 4, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.978 Vali Acc: 0.711 Test Loss: 0.978 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2883648872375488
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.582 Vali Acc: 0.665 Test Loss: 1.582 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2178382873535156
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.951 Vali Acc: 0.763 Test Loss: 0.951 Test Acc: 0.763
Validation loss decreased (-0.722533 --> -0.762996).  Saving model ...
Epoch: 7 cost time: 1.2817513942718506
Epoch: 7, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.374 Vali Acc: 0.642 Test Loss: 2.374 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1275417804718018
Epoch: 8, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.851 Vali Acc: 0.780 Test Loss: 0.851 Test Acc: 0.780
Validation loss decreased (-0.762996 --> -0.780338).  Saving model ...
Epoch: 9 cost time: 1.200441598892212
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.095 Vali Acc: 0.734 Test Loss: 1.095 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1824519634246826
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.740 Test Loss: 1.136 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2509181499481201
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.746 Test Loss: 1.163 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2106049060821533
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.751 Test Loss: 1.150 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2352955341339111
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.751 Test Loss: 1.128 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.127821683883667
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.751 Test Loss: 1.116 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.147193193435669
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.751 Test Loss: 1.106 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2017602920532227
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.751 Test Loss: 1.096 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.189054012298584
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.088 Vali Acc: 0.751 Test Loss: 1.088 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3594379425048828
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.740 Test Loss: 1.082 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1767951
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.370481967926025
Epoch: 1, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.026 Vali Acc: 0.607 Test Loss: 1.026 Test Acc: 0.607
Validation loss decreased (inf --> -0.606926).  Saving model ...
Epoch: 2 cost time: 3.814626455307007
Epoch: 2, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.864 Vali Acc: 0.717 Test Loss: 0.864 Test Acc: 0.717
Validation loss decreased (-0.606926 --> -0.716754).  Saving model ...
Epoch: 3 cost time: 4.05326247215271
Epoch: 3, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.231 Vali Acc: 0.705 Test Loss: 1.231 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.807164430618286
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.371 Vali Acc: 0.711 Test Loss: 1.371 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.032524108886719
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.161 Vali Acc: 0.746 Test Loss: 1.161 Test Acc: 0.746
Validation loss decreased (-0.716754 --> -0.745653).  Saving model ...
Epoch: 6 cost time: 4.058716773986816
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.671 Vali Acc: 0.780 Test Loss: 0.671 Test Acc: 0.780
Validation loss decreased (-0.745653 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 4.017639875411987
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.786 Test Loss: 0.793 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786119).  Saving model ...
Epoch: 8 cost time: 4.056885719299316
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.792 Test Loss: 0.772 Test Acc: 0.792
Validation loss decreased (-0.786119 --> -0.791900).  Saving model ...
Epoch: 9 cost time: 4.074406862258911
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.792 Test Loss: 0.748 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 10 cost time: 4.443074464797974
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 11 cost time: 4.52783465385437
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.792 Test Loss: 0.729 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 12 cost time: 4.288058519363403
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.792 Test Loss: 0.725 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 13 cost time: 4.491556167602539
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.786 Test Loss: 0.720 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.336734771728516
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.786 Test Loss: 0.717 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6747617721557617
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.786 Test Loss: 0.715 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.6960508823394775
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.786 Test Loss: 0.714 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.8292107582092285
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.786 Test Loss: 0.713 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.7244553565979
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.786 Test Loss: 0.710 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.667760133743286
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.780 Test Loss: 0.709 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.793912649154663
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.8104639053344727
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.5330870151519775
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.780 Test Loss: 0.707 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1538703
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.276289939880371
Epoch: 1, Steps: 17 | Train Loss: 1.765 Vali Loss: 0.984 Vali Acc: 0.618 Test Loss: 0.984 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 3.1901307106018066
Epoch: 2, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.808 Vali Acc: 0.734 Test Loss: 0.808 Test Acc: 0.734
Validation loss decreased (-0.618487 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 3.047600269317627
Epoch: 3, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.970 Vali Acc: 0.757 Test Loss: 0.970 Test Acc: 0.757
Validation loss decreased (-0.734096 --> -0.757216).  Saving model ...
Epoch: 4 cost time: 3.0071494579315186
Epoch: 4, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.873 Vali Acc: 0.740 Test Loss: 0.873 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2444982528686523
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.757 Test Loss: 0.872 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757217).  Saving model ...
Epoch: 6 cost time: 3.2646660804748535
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.740 Test Loss: 0.844 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2303671836853027
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.803 Test Loss: 0.843 Test Acc: 0.803
Validation loss decreased (-0.757217 --> -0.803460).  Saving model ...
Epoch: 8 cost time: 3.0294864177703857
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803460).  Saving model ...
Epoch: 9 cost time: 3.0191755294799805
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.821 Test Loss: 0.710 Test Acc: 0.821
Validation loss decreased (-0.803460 --> -0.820802).  Saving model ...
Epoch: 10 cost time: 3.2110707759857178
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.815 Test Loss: 0.682 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1327033042907715
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9265599250793457
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.798 Test Loss: 0.659 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0613319873809814
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.792 Test Loss: 0.655 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0881502628326416
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.792 Test Loss: 0.650 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.1618363857269287
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.792 Test Loss: 0.649 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.202942371368408
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.792 Test Loss: 0.646 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.225877523422241
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1413145065307617
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.959041118621826
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.786 Test Loss: 0.644 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1535631
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.887974262237549
Epoch: 1, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.147 Vali Acc: 0.601 Test Loss: 1.147 Test Acc: 0.601
Validation loss decreased (inf --> -0.601145).  Saving model ...
Epoch: 2 cost time: 2.313342809677124
Epoch: 2, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.845 Vali Acc: 0.671 Test Loss: 0.845 Test Acc: 0.671
Validation loss decreased (-0.601145 --> -0.670512).  Saving model ...
Epoch: 3 cost time: 2.2508111000061035
Epoch: 3, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.936 Vali Acc: 0.780 Test Loss: 0.936 Test Acc: 0.780
Validation loss decreased (-0.670512 --> -0.780337).  Saving model ...
Epoch: 4 cost time: 2.302614688873291
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.909 Vali Acc: 0.769 Test Loss: 0.909 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.344538927078247
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.045 Vali Acc: 0.746 Test Loss: 1.045 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4263298511505127
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.305 Vali Acc: 0.728 Test Loss: 1.305 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5598678588867188
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.962 Vali Acc: 0.740 Test Loss: 0.962 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.424221992492676
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.699 Test Loss: 1.507 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0379676818847656
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.849 Vali Acc: 0.740 Test Loss: 0.849 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.031449317932129
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.746 Test Loss: 0.935 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.0499043464660645
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.717 Test Loss: 1.121 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9916157722473145
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.209 Vali Acc: 0.723 Test Loss: 1.209 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9293112754821777
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.763 Test Loss: 1.232 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1531535
model size : 5.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.195164680480957
Epoch: 1, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.068 Vali Acc: 0.572 Test Loss: 1.068 Test Acc: 0.572
Validation loss decreased (inf --> -0.572244).  Saving model ...
Epoch: 2 cost time: 2.784423828125
Epoch: 2, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.141 Vali Acc: 0.694 Test Loss: 1.141 Test Acc: 0.694
Validation loss decreased (-0.572244 --> -0.693630).  Saving model ...
Epoch: 3 cost time: 2.7688558101654053
Epoch: 3, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.853 Vali Acc: 0.786 Test Loss: 0.853 Test Acc: 0.786
Validation loss decreased (-0.693630 --> -0.786119).  Saving model ...
Epoch: 4 cost time: 2.532970666885376
Epoch: 4, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.142 Vali Acc: 0.734 Test Loss: 1.142 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.283252000808716
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.864 Vali Acc: 0.803 Test Loss: 0.864 Test Acc: 0.803
Validation loss decreased (-0.786119 --> -0.803460).  Saving model ...
Epoch: 6 cost time: 2.850778818130493
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.479 Vali Acc: 0.711 Test Loss: 1.479 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8560898303985596
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.270 Vali Acc: 0.746 Test Loss: 1.270 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.791823625564575
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.092 Vali Acc: 0.751 Test Loss: 1.092 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.650956392288208
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.987 Vali Acc: 0.763 Test Loss: 0.987 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9028494358062744
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.166 Vali Acc: 0.740 Test Loss: 1.166 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.918998956680298
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.280 Vali Acc: 0.775 Test Loss: 1.280 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8080124855041504
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.769 Test Loss: 1.140 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0176005363464355
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.769 Test Loss: 1.104 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.873149871826172
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.086 Vali Acc: 0.780 Test Loss: 1.086 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8039915561676025
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.780 Test Loss: 1.078 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1528463
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.232465982437134
Epoch: 1, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.350 Vali Acc: 0.514 Test Loss: 1.350 Test Acc: 0.514
Validation loss decreased (inf --> -0.514437).  Saving model ...
Epoch: 2 cost time: 2.0216023921966553
Epoch: 2, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.928 Vali Acc: 0.740 Test Loss: 0.928 Test Acc: 0.740
Validation loss decreased (-0.514437 --> -0.739875).  Saving model ...
Epoch: 3 cost time: 1.690194845199585
Epoch: 3, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.011 Vali Acc: 0.711 Test Loss: 1.011 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6961767673492432
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.949 Vali Acc: 0.734 Test Loss: 0.949 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6973178386688232
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.350 Vali Acc: 0.740 Test Loss: 1.350 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6213030815124512
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.922 Vali Acc: 0.757 Test Loss: 0.922 Test Acc: 0.757
Validation loss decreased (-0.739875 --> -0.757216).  Saving model ...
Epoch: 7 cost time: 1.6128160953521729
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.802 Vali Acc: 0.751 Test Loss: 0.802 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4964699745178223
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.082 Vali Acc: 0.740 Test Loss: 1.082 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.538219690322876
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.757 Test Loss: 0.782 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757218).  Saving model ...
Epoch: 10 cost time: 1.69407320022583
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.746 Test Loss: 1.141 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0061304569244385
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.763 Test Loss: 0.735 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762998).  Saving model ...
Epoch: 12 cost time: 2.0569636821746826
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.746 Test Loss: 0.836 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.07586407661438
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.751 Test Loss: 0.932 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1780083179473877
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.751 Test Loss: 0.930 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.059652328491211
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.757 Test Loss: 0.916 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2571020126342773
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.757 Test Loss: 0.908 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.63267183303833
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.746 Test Loss: 0.900 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.161155939102173
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.746 Test Loss: 0.896 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1285533905029297
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.746 Test Loss: 0.892 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1358413696289062
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.746 Test Loss: 0.891 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.05222487449646
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.746 Test Loss: 0.890 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1525391
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.872544288635254
Epoch: 1, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.342 Vali Acc: 0.491 Test Loss: 1.342 Test Acc: 0.491
Validation loss decreased (inf --> -0.491316).  Saving model ...
Epoch: 2 cost time: 1.5515730381011963
Epoch: 2, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
Validation loss decreased (-0.491316 --> -0.716754).  Saving model ...
Epoch: 3 cost time: 1.599172592163086
Epoch: 3, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.113 Vali Acc: 0.740 Test Loss: 1.113 Test Acc: 0.740
Validation loss decreased (-0.716754 --> -0.739873).  Saving model ...
Epoch: 4 cost time: 1.7266929149627686
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.723 Vali Acc: 0.751 Test Loss: 0.723 Test Acc: 0.751
Validation loss decreased (-0.739873 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 1.6441495418548584
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.958 Vali Acc: 0.769 Test Loss: 0.958 Test Acc: 0.769
Validation loss decreased (-0.751438 --> -0.768777).  Saving model ...
Epoch: 6 cost time: 1.4426560401916504
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.929 Vali Acc: 0.751 Test Loss: 0.929 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6645309925079346
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.740 Test Loss: 0.972 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6107356548309326
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.763 Test Loss: 0.940 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7147729396820068
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774557).  Saving model ...
Epoch: 10 cost time: 1.7281756401062012
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774557).  Saving model ...
Epoch: 11 cost time: 1.5073583126068115
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774558).  Saving model ...
Epoch: 12 cost time: 1.7831130027770996
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 13 cost time: 1.622762680053711
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 14 cost time: 1.8923425674438477
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 15 cost time: 1.6443793773651123
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 16 cost time: 1.7508790493011475
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 17 cost time: 1.7896661758422852
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 18 cost time: 1.7325143814086914
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.763 Test Loss: 0.869 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5962090492248535
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.763 Test Loss: 0.867 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7299129962921143
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7991628646850586
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5938570499420166
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.763 Test Loss: 0.863 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9251205921173096
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.775 Test Loss: 0.862 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 24 cost time: 1.7410004138946533
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.763 Test Loss: 0.861 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7576401233673096
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.763 Test Loss: 0.859 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6178481578826904
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.763 Test Loss: 0.860 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7821838855743408
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.763 Test Loss: 0.858 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5614240169525146
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.763 Test Loss: 0.858 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.623497486114502
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.763 Test Loss: 0.856 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6720874309539795
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.763 Test Loss: 0.855 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.616060495376587
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6415011882781982
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.763 Test Loss: 0.855 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7620587348937988
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1523343
model size : 5.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8559188842773438
Epoch: 1, Steps: 17 | Train Loss: 1.594 Vali Loss: 1.116 Vali Acc: 0.607 Test Loss: 1.116 Test Acc: 0.607
Validation loss decreased (inf --> -0.606925).  Saving model ...
Epoch: 2 cost time: 1.5067265033721924
Epoch: 2, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.008 Vali Acc: 0.688 Test Loss: 1.008 Test Acc: 0.688
Validation loss decreased (-0.606925 --> -0.687851).  Saving model ...
Epoch: 3 cost time: 1.3806650638580322
Epoch: 3, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.972 Vali Acc: 0.723 Test Loss: 0.972 Test Acc: 0.723
Validation loss decreased (-0.687851 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 1.3841989040374756
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.985 Vali Acc: 0.723 Test Loss: 0.985 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4407217502593994
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.930 Vali Acc: 0.769 Test Loss: 0.930 Test Acc: 0.769
Validation loss decreased (-0.722534 --> -0.768777).  Saving model ...
Epoch: 6 cost time: 1.3448398113250732
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.803 Test Loss: 0.789 Test Acc: 0.803
Validation loss decreased (-0.768777 --> -0.803460).  Saving model ...
Epoch: 7 cost time: 1.429701805114746
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5017964839935303
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803461).  Saving model ...
Epoch: 9 cost time: 1.2505300045013428
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 10 cost time: 1.5620677471160889
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
Validation loss decreased (-0.803461 --> -0.809241).  Saving model ...
Epoch: 11 cost time: 1.5278427600860596
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4341373443603516
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.786 Test Loss: 0.724 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.453838586807251
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.792 Test Loss: 0.723 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6105694770812988
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.792 Test Loss: 0.724 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.509610891342163
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.792 Test Loss: 0.723 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5540449619293213
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.792 Test Loss: 0.722 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.681626558303833
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.792 Test Loss: 0.722 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2674217224121094
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.792 Test Loss: 0.723 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4376397132873535
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.792 Test Loss: 0.723 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.593245267868042
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.780 Test Loss: 0.723 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1522319
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.336735963821411
Epoch: 1, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.461 Vali Acc: 0.445 Test Loss: 1.461 Test Acc: 0.445
Validation loss decreased (inf --> -0.445072).  Saving model ...
Epoch: 2 cost time: 1.1667518615722656
Epoch: 2, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.872 Vali Acc: 0.676 Test Loss: 0.872 Test Acc: 0.676
Validation loss decreased (-0.445072 --> -0.676292).  Saving model ...
Epoch: 3 cost time: 1.0854694843292236
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.829 Vali Acc: 0.734 Test Loss: 0.829 Test Acc: 0.734
Validation loss decreased (-0.676292 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 1.2479586601257324
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.165 Vali Acc: 0.682 Test Loss: 1.165 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1537768840789795
Epoch: 5, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.265 Vali Acc: 0.711 Test Loss: 1.265 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1520357131958008
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.049 Vali Acc: 0.734 Test Loss: 1.049 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1280393600463867
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.392 Vali Acc: 0.676 Test Loss: 1.392 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.380601167678833
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.934 Vali Acc: 0.705 Test Loss: 0.934 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.121190071105957
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.746 Test Loss: 0.839 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745656).  Saving model ...
Epoch: 10 cost time: 1.1665306091308594
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.711 Test Loss: 0.958 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.209369421005249
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.740 Test Loss: 0.957 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1617794036865234
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.746 Test Loss: 0.930 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2149507999420166
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.717 Test Loss: 0.917 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1364872455596924
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.740 Test Loss: 0.904 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.158750057220459
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.746 Test Loss: 0.897 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.182180404663086
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.746 Test Loss: 0.892 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.18833327293396
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.746 Test Loss: 0.887 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1074340343475342
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.734 Test Loss: 0.884 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.092416524887085
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.734 Test Loss: 0.881 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 1521295
model size : 5.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.010246753692627
Epoch: 1, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.218 Vali Acc: 0.520 Test Loss: 1.218 Test Acc: 0.520
Validation loss decreased (inf --> -0.520219).  Saving model ...
Epoch: 2 cost time: 3.8866207599639893
Epoch: 2, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.912 Vali Acc: 0.699 Test Loss: 0.912 Test Acc: 0.699
Validation loss decreased (-0.520219 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 3.899869441986084
Epoch: 3, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.077 Vali Acc: 0.705 Test Loss: 1.077 Test Acc: 0.705
Validation loss decreased (-0.699413 --> -0.705192).  Saving model ...
Epoch: 4 cost time: 3.811260938644409
Epoch: 4, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.079 Vali Acc: 0.728 Test Loss: 1.079 Test Acc: 0.728
Validation loss decreased (-0.705192 --> -0.728313).  Saving model ...
Epoch: 5 cost time: 3.6524410247802734
Epoch: 5, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.309 Vali Acc: 0.717 Test Loss: 1.309 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.661496639251709
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.229 Vali Acc: 0.734 Test Loss: 1.229 Test Acc: 0.734
Validation loss decreased (-0.728313 --> -0.734092).  Saving model ...
Epoch: 7 cost time: 3.5561628341674805
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.746 Test Loss: 1.180 Test Acc: 0.746
Validation loss decreased (-0.734092 --> -0.745653).  Saving model ...
Epoch: 8 cost time: 3.939380645751953
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.757 Test Loss: 1.080 Test Acc: 0.757
Validation loss decreased (-0.745653 --> -0.757215).  Saving model ...
Epoch: 9 cost time: 3.6958212852478027
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.763 Test Loss: 1.064 Test Acc: 0.763
Validation loss decreased (-0.757215 --> -0.762995).  Saving model ...
Epoch: 10 cost time: 3.688016653060913
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.763 Test Loss: 1.058 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 11 cost time: 4.169430255889893
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.763 Test Loss: 1.055 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 12 cost time: 4.51886248588562
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.763 Test Loss: 1.055 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 13 cost time: 4.019702911376953
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.763 Test Loss: 1.055 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 14 cost time: 4.249112367630005
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.763 Test Loss: 1.052 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 15 cost time: 4.06723427772522
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.763 Test Loss: 1.051 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 16 cost time: 4.209390878677368
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.763 Test Loss: 1.047 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 17 cost time: 3.812288761138916
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.763 Test Loss: 1.045 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762995).  Saving model ...
Epoch: 18 cost time: 4.252126693725586
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.775 Test Loss: 1.041 Test Acc: 0.775
Validation loss decreased (-0.762995 --> -0.774556).  Saving model ...
Epoch: 19 cost time: 3.7961132526397705
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.775 Test Loss: 1.037 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774556).  Saving model ...
Epoch: 20 cost time: 4.027841806411743
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.775 Test Loss: 1.036 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774556).  Saving model ...
Epoch: 21 cost time: 3.9939141273498535
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.775 Test Loss: 1.033 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774556).  Saving model ...
Epoch: 22 cost time: 4.075862646102905
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.775 Test Loss: 1.031 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774556).  Saving model ...
Epoch: 23 cost time: 4.310338735580444
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.775 Test Loss: 1.031 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774556).  Saving model ...
Epoch: 24 cost time: 4.0564048290252686
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774556).  Saving model ...
Epoch: 25 cost time: 4.294664144515991
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.775 Test Loss: 1.027 Test Acc: 0.775
Validation loss decreased (-0.774556 --> -0.774556).  Saving model ...
Epoch: 26 cost time: 3.7100095748901367
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.769 Test Loss: 1.026 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.442749261856079
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.769 Test Loss: 1.025 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4664602279663086
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.769 Test Loss: 1.024 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.417126178741455
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.769 Test Loss: 1.022 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1555488109588623
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.769 Test Loss: 1.020 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2360007762908936
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.769 Test Loss: 1.018 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.3111205101013184
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.769 Test Loss: 1.018 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.256160259246826
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.769 Test Loss: 1.015 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.181087493896484
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.0927040576934814
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1415375
model size : 5.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.451232433319092
Epoch: 1, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.184 Vali Acc: 0.584 Test Loss: 1.184 Test Acc: 0.584
Validation loss decreased (inf --> -0.583803).  Saving model ...
Epoch: 2 cost time: 3.283285140991211
Epoch: 2, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.845 Vali Acc: 0.682 Test Loss: 0.845 Test Acc: 0.682
Validation loss decreased (-0.583803 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 3.3488523960113525
Epoch: 3, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.997 Vali Acc: 0.682 Test Loss: 0.997 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.480186939239502
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.259 Vali Acc: 0.740 Test Loss: 1.259 Test Acc: 0.740
Validation loss decreased (-0.682072 --> -0.739872).  Saving model ...
Epoch: 5 cost time: 3.48696231842041
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.208 Vali Acc: 0.775 Test Loss: 1.208 Test Acc: 0.775
Validation loss decreased (-0.739872 --> -0.774554).  Saving model ...
Epoch: 6 cost time: 3.5930306911468506
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.763 Vali Acc: 0.740 Test Loss: 1.763 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.555691957473755
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.507 Vali Acc: 0.723 Test Loss: 1.507 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3971035480499268
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.396 Vali Acc: 0.757 Test Loss: 1.396 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6357696056365967
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.711 Test Loss: 1.672 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2944467067718506
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.406 Vali Acc: 0.746 Test Loss: 1.406 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4203414916992188
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.751 Test Loss: 1.322 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5664985179901123
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.740 Test Loss: 1.299 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.567626714706421
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.740 Test Loss: 1.288 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5413317680358887
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.740 Test Loss: 1.281 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.342636823654175
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.740 Test Loss: 1.276 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1412303
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.1456756591796875
Epoch: 1, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.002 Vali Acc: 0.590 Test Loss: 1.002 Test Acc: 0.590
Validation loss decreased (inf --> -0.589585).  Saving model ...
Epoch: 2 cost time: 2.9779841899871826
Epoch: 2, Steps: 17 | Train Loss: 0.324 Vali Loss: 1.000 Vali Acc: 0.642 Test Loss: 1.000 Test Acc: 0.642
Validation loss decreased (-0.589585 --> -0.641608).  Saving model ...
Epoch: 3 cost time: 3.093780994415283
Epoch: 3, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.169 Vali Acc: 0.699 Test Loss: 1.169 Test Acc: 0.699
Validation loss decreased (-0.641608 --> -0.699410).  Saving model ...
Epoch: 4 cost time: 2.767418622970581
Epoch: 4, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.881 Vali Acc: 0.723 Test Loss: 0.881 Test Acc: 0.723
Validation loss decreased (-0.699410 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 2.916966438293457
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.926 Vali Acc: 0.705 Test Loss: 0.926 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0532753467559814
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.019 Vali Acc: 0.746 Test Loss: 1.019 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745655).  Saving model ...
Epoch: 7 cost time: 2.88081955909729
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.723 Test Loss: 1.163 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0056333541870117
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.740 Test Loss: 0.928 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.801806926727295
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.746 Test Loss: 0.873 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745656).  Saving model ...
Epoch: 10 cost time: 2.854361057281494
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.746 Test Loss: 0.853 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745656).  Saving model ...
Epoch: 11 cost time: 3.0641238689422607
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.746 Test Loss: 0.841 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745656).  Saving model ...
Epoch: 12 cost time: 2.8704075813293457
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.740 Test Loss: 0.831 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.86286997795105
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.746 Test Loss: 0.822 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745657).  Saving model ...
Epoch: 14 cost time: 2.8335111141204834
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.740 Test Loss: 0.816 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8634753227233887
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.740 Test Loss: 0.810 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.587745428085327
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.740 Test Loss: 0.805 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5989911556243896
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.740 Test Loss: 0.802 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5542492866516113
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.740 Test Loss: 0.796 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7794437408447266
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.740 Test Loss: 0.794 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.8727686405181885
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.740 Test Loss: 0.791 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0211493968963623
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.740 Test Loss: 0.788 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.2010562419891357
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.740 Test Loss: 0.785 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2933499813079834
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.740 Test Loss: 0.783 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 1408207
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.353132724761963
Epoch: 1, Steps: 17 | Train Loss: 1.691 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
Validation loss decreased (inf --> -0.595365).  Saving model ...
Epoch: 2 cost time: 2.1869447231292725
Epoch: 2, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.954 Vali Acc: 0.711 Test Loss: 0.954 Test Acc: 0.711
Validation loss decreased (-0.595365 --> -0.710973).  Saving model ...
Epoch: 3 cost time: 2.2145819664001465
Epoch: 3, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.781 Vali Acc: 0.763 Test Loss: 0.781 Test Acc: 0.763
Validation loss decreased (-0.710973 --> -0.762998).  Saving model ...
Epoch: 4 cost time: 2.0674116611480713
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.174 Vali Acc: 0.728 Test Loss: 1.174 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1356284618377686
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.763 Test Loss: 0.942 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.139784574508667
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.798 Test Loss: 0.722 Test Acc: 0.798
Validation loss decreased (-0.762998 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 1.8342564105987549
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.809 Test Loss: 0.763 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 2.1912224292755127
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 9 cost time: 2.8317248821258545
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809242).  Saving model ...
Epoch: 10 cost time: 2.8380424976348877
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.89426589012146
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.809 Test Loss: 0.706 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.841705560684204
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8405849933624268
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.93841814994812
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.809 Test Loss: 0.706 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.920788526535034
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.792426824569702
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8829126358032227
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9307236671447754
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.821 Test Loss: 0.703 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820802).  Saving model ...
Epoch: 19 cost time: 2.8271098136901855
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.821 Test Loss: 0.702 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820802).  Saving model ...
Epoch: 20 cost time: 2.42447566986084
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.821 Test Loss: 0.703 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7749648094177246
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.821 Test Loss: 0.701 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820802).  Saving model ...
Epoch: 22 cost time: 2.9398601055145264
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.821 Test Loss: 0.702 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7923688888549805
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.821 Test Loss: 0.701 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.81394624710083
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.821 Test Loss: 0.700 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820802).  Saving model ...
Epoch: 25 cost time: 2.707106351852417
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.821 Test Loss: 0.700 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.779402732849121
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.821 Test Loss: 0.699 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820802).  Saving model ...
Epoch: 27 cost time: 2.950841188430786
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.821 Test Loss: 0.699 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.846937894821167
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820802).  Saving model ...
Epoch: 29 cost time: 2.6327648162841797
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.821 Test Loss: 0.699 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7866322994232178
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.821 Test Loss: 0.699 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.000162124633789
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820802).  Saving model ...
Epoch: 32 cost time: 2.9738471508026123
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.821 Test Loss: 0.697 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820802).  Saving model ...
Epoch: 33 cost time: 2.7255241870880127
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.9300143718719482
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.821 Test Loss: 0.697 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.893599510192871
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.9328200817108154
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.660339832305908
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.821 Test Loss: 0.700 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.0303237438201904
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.96351957321167
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.863223075866699
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.7490344047546387
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.821 Test Loss: 0.699 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.8930022716522217
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.821 Test Loss: 0.699 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1405135
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9329686164855957
Epoch: 1, Steps: 17 | Train Loss: 1.665 Vali Loss: 1.255 Vali Acc: 0.566 Test Loss: 1.255 Test Acc: 0.566
Validation loss decreased (inf --> -0.566461).  Saving model ...
Epoch: 2 cost time: 1.6728191375732422
Epoch: 2, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.876 Vali Acc: 0.751 Test Loss: 0.876 Test Acc: 0.751
Validation loss decreased (-0.566461 --> -0.751436).  Saving model ...
Epoch: 3 cost time: 1.6491954326629639
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.914 Vali Acc: 0.769 Test Loss: 0.914 Test Acc: 0.769
Validation loss decreased (-0.751436 --> -0.768777).  Saving model ...
Epoch: 4 cost time: 1.386977195739746
Epoch: 4, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.554 Vali Acc: 0.688 Test Loss: 1.554 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8840868473052979
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.114 Vali Acc: 0.757 Test Loss: 1.114 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9217064380645752
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.780 Test Loss: 0.925 Test Acc: 0.780
Validation loss decreased (-0.768777 --> -0.780338).  Saving model ...
Epoch: 7 cost time: 2.343446969985962
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9522593021392822
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.786 Test Loss: 0.824 Test Acc: 0.786
Validation loss decreased (-0.780338 --> -0.786119).  Saving model ...
Epoch: 9 cost time: 1.5466022491455078
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.786 Test Loss: 0.815 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 10 cost time: 1.916475534439087
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.786 Test Loss: 0.809 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 11 cost time: 1.6043317317962646
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.786 Test Loss: 0.806 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 12 cost time: 1.9582228660583496
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.786 Test Loss: 0.803 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 13 cost time: 1.7734673023223877
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.786 Test Loss: 0.801 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 14 cost time: 1.6028697490692139
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.786 Test Loss: 0.798 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 15 cost time: 1.8484838008880615
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.786 Test Loss: 0.794 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 16 cost time: 1.9570879936218262
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.786 Test Loss: 0.793 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 17 cost time: 1.7862505912780762
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.786 Test Loss: 0.792 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 18 cost time: 2.058802366256714
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.786 Test Loss: 0.791 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 19 cost time: 1.800154685974121
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.786 Test Loss: 0.790 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 20 cost time: 1.6009533405303955
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.786 Test Loss: 0.787 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 21 cost time: 2.0475854873657227
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.786 Test Loss: 0.786 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 22 cost time: 1.8183581829071045
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.786 Test Loss: 0.784 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 23 cost time: 1.9447600841522217
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.786 Test Loss: 0.782 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 24 cost time: 2.04483699798584
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.775 Test Loss: 0.782 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6255226135253906
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1723039150238037
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1528871059417725
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9369480609893799
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.266927719116211
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.892848014831543
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.129979133605957
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.763 Test Loss: 0.775 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.0789623260498047
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.763 Test Loss: 0.774 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0419223308563232
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.763 Test Loss: 0.774 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1402063
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9131722450256348
Epoch: 1, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.245 Vali Acc: 0.514 Test Loss: 1.245 Test Acc: 0.514
Validation loss decreased (inf --> -0.514438).  Saving model ...
Epoch: 2 cost time: 1.7142229080200195
Epoch: 2, Steps: 17 | Train Loss: 0.262 Vali Loss: 1.190 Vali Acc: 0.642 Test Loss: 1.190 Test Acc: 0.642
Validation loss decreased (-0.514438 --> -0.641607).  Saving model ...
Epoch: 3 cost time: 1.7213032245635986
Epoch: 3, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.836 Vali Acc: 0.734 Test Loss: 0.836 Test Acc: 0.734
Validation loss decreased (-0.641607 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 1.671304702758789
Epoch: 4, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.943 Vali Acc: 0.734 Test Loss: 0.943 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7369554042816162
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.323 Vali Acc: 0.717 Test Loss: 1.323 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6901283264160156
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.935 Vali Acc: 0.740 Test Loss: 0.935 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739875).  Saving model ...
Epoch: 7 cost time: 1.7930147647857666
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.896 Vali Acc: 0.746 Test Loss: 0.896 Test Acc: 0.746
Validation loss decreased (-0.739875 --> -0.745656).  Saving model ...
Epoch: 8 cost time: 1.7046535015106201
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.867 Vali Acc: 0.780 Test Loss: 0.867 Test Acc: 0.780
Validation loss decreased (-0.745656 --> -0.780338).  Saving model ...
Epoch: 9 cost time: 1.3197486400604248
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.717 Test Loss: 1.265 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.682347059249878
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.769 Test Loss: 0.945 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3919551372528076
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.780 Test Loss: 0.968 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4314305782318115
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.780 Test Loss: 0.936 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.385678768157959
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.780 Test Loss: 0.918 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3321969509124756
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.780 Test Loss: 0.910 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4866697788238525
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.792 Test Loss: 0.904 Test Acc: 0.792
Validation loss decreased (-0.780338 --> -0.791898).  Saving model ...
Epoch: 16 cost time: 1.385481834411621
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.780 Test Loss: 0.899 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6747605800628662
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.780 Test Loss: 0.895 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6865670680999756
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.780 Test Loss: 0.894 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5526823997497559
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.775 Test Loss: 0.892 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8689022064208984
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.775 Test Loss: 0.889 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3816187381744385
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.775 Test Loss: 0.889 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7184312343597412
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.763 Test Loss: 0.886 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8667263984680176
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.763 Test Loss: 0.885 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.588782787322998
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.769 Test Loss: 0.884 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6910841464996338
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.769 Test Loss: 0.884 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1400015
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.716660737991333
Epoch: 1, Steps: 17 | Train Loss: 1.597 Vali Loss: 1.196 Vali Acc: 0.526 Test Loss: 1.196 Test Acc: 0.526
Validation loss decreased (inf --> -0.526000).  Saving model ...
Epoch: 2 cost time: 1.3696558475494385
Epoch: 2, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.734 Vali Acc: 0.740 Test Loss: 0.734 Test Acc: 0.740
Validation loss decreased (-0.526000 --> -0.739877).  Saving model ...
Epoch: 3 cost time: 1.5184931755065918
Epoch: 3, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.947 Vali Acc: 0.682 Test Loss: 0.947 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.341207504272461
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.558 Vali Acc: 0.636 Test Loss: 1.558 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4317080974578857
Epoch: 5, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.816 Vali Acc: 0.751 Test Loss: 0.816 Test Acc: 0.751
Validation loss decreased (-0.739877 --> -0.751437).  Saving model ...
Epoch: 6 cost time: 1.4077422618865967
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.659 Test Loss: 1.011 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.359922170639038
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.723 Test Loss: 1.103 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4462356567382812
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.694 Test Loss: 1.014 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3441615104675293
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.682 Test Loss: 1.173 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4890711307525635
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.699 Test Loss: 1.089 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4836575984954834
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.694 Test Loss: 1.038 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4143965244293213
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.694 Test Loss: 1.019 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.413672685623169
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.705 Test Loss: 1.007 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3352766036987305
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.711 Test Loss: 0.998 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4575517177581787
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.711 Test Loss: 0.990 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1398991
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3517162799835205
Epoch: 1, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.200 Vali Acc: 0.566 Test Loss: 1.200 Test Acc: 0.566
Validation loss decreased (inf --> -0.566462).  Saving model ...
Epoch: 2 cost time: 1.1330478191375732
Epoch: 2, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.929 Vali Acc: 0.723 Test Loss: 0.929 Test Acc: 0.723
Validation loss decreased (-0.566462 --> -0.722534).  Saving model ...
Epoch: 3 cost time: 1.127657175064087
Epoch: 3, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.829 Vali Acc: 0.769 Test Loss: 0.829 Test Acc: 0.769
Validation loss decreased (-0.722534 --> -0.768778).  Saving model ...
Epoch: 4 cost time: 1.0586397647857666
Epoch: 4, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.893 Vali Acc: 0.740 Test Loss: 0.893 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0865044593811035
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.769 Test Loss: 0.800 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768778).  Saving model ...
Epoch: 6 cost time: 1.024937391281128
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.763 Test Loss: 0.921 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9390738010406494
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.757 Test Loss: 0.885 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0494544506072998
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.775 Test Loss: 0.845 Test Acc: 0.775
Validation loss decreased (-0.768778 --> -0.774558).  Saving model ...
Epoch: 9 cost time: 1.0893619060516357
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 10 cost time: 0.984074592590332
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.769 Test Loss: 0.820 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1369750499725342
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.780 Test Loss: 0.813 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780339).  Saving model ...
Epoch: 12 cost time: 1.173759937286377
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.775 Test Loss: 0.806 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2594976425170898
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.775 Test Loss: 0.799 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1315512657165527
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3207354545593262
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2615480422973633
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.775 Test Loss: 0.790 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.249730110168457
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2181284427642822
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0361731052398682
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.775 Test Loss: 0.786 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1911346912384033
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0523419380187988
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1397967
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.030761957168579
Epoch: 1, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.130 Vali Acc: 0.653 Test Loss: 1.130 Test Acc: 0.653
Validation loss decreased (inf --> -0.653168).  Saving model ...
Epoch: 2 cost time: 4.228158712387085
Epoch: 2, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.968 Vali Acc: 0.676 Test Loss: 0.968 Test Acc: 0.676
Validation loss decreased (-0.653168 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 3.5173983573913574
Epoch: 3, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.676291 --> -0.774558).  Saving model ...
Epoch: 4 cost time: 3.793480634689331
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.093 Vali Acc: 0.757 Test Loss: 1.093 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5907976627349854
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.442 Vali Acc: 0.746 Test Loss: 1.442 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9613020420074463
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.114 Vali Acc: 0.717 Test Loss: 1.114 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2982184886932373
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.280 Vali Acc: 0.740 Test Loss: 1.280 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.937652826309204
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.262 Vali Acc: 0.757 Test Loss: 1.262 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.234722137451172
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.596 Vali Acc: 0.694 Test Loss: 1.596 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.197345018386841
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.395 Vali Acc: 0.775 Test Loss: 1.395 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.7801923751831055
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.193 Vali Acc: 0.769 Test Loss: 1.193 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9977822303771973
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.039 Vali Acc: 0.798 Test Loss: 1.039 Test Acc: 0.798
Validation loss decreased (-0.774558 --> -0.797677).  Saving model ...
Epoch: 13 cost time: 3.3277156352996826
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.904 Vali Acc: 0.775 Test Loss: 1.904 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.123489141464233
Epoch: 14, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.455 Vali Acc: 0.728 Test Loss: 2.455 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7910549640655518
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.949 Vali Acc: 0.757 Test Loss: 1.949 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.791931390762329
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.295 Vali Acc: 0.711 Test Loss: 3.295 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8208000659942627
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.894 Vali Acc: 0.775 Test Loss: 1.894 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.024686098098755
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.780 Test Loss: 1.801 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.028289079666138
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.780 Test Loss: 1.773 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.376049280166626
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.780 Test Loss: 1.761 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.671834945678711
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.780 Test Loss: 1.753 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.2065165042877197
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.780 Test Loss: 1.746 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1353711
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.802772521972656
Epoch: 1, Steps: 17 | Train Loss: 1.709 Vali Loss: 1.097 Vali Acc: 0.526 Test Loss: 1.097 Test Acc: 0.526
Validation loss decreased (inf --> -0.526001).  Saving model ...
Epoch: 2 cost time: 3.899578332901001
Epoch: 2, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.860 Vali Acc: 0.746 Test Loss: 0.860 Test Acc: 0.746
Validation loss decreased (-0.526001 --> -0.745656).  Saving model ...
Epoch: 3 cost time: 3.810271739959717
Epoch: 3, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.312 Vali Acc: 0.694 Test Loss: 1.312 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6695926189422607
Epoch: 4, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.969 Vali Acc: 0.711 Test Loss: 0.969 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6996471881866455
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.892 Vali Acc: 0.757 Test Loss: 0.892 Test Acc: 0.757
Validation loss decreased (-0.745656 --> -0.757217).  Saving model ...
Epoch: 6 cost time: 3.5411243438720703
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.964 Vali Acc: 0.780 Test Loss: 0.964 Test Acc: 0.780
Validation loss decreased (-0.757217 --> -0.780337).  Saving model ...
Epoch: 7 cost time: 3.3335154056549072
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.111 Vali Acc: 0.780 Test Loss: 1.111 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2482495307922363
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.763 Test Loss: 0.819 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.279913902282715
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.780 Test Loss: 0.814 Test Acc: 0.780
Validation loss decreased (-0.780337 --> -0.780339).  Saving model ...
Epoch: 10 cost time: 3.336806297302246
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.212601900100708
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6645755767822266
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4093501567840576
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.775 Test Loss: 0.799 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.65779185295105
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.775 Test Loss: 0.797 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7881853580474854
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.782987117767334
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5282392501831055
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.6454968452453613
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.6719753742218018
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1350639
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.150303363800049
Epoch: 1, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.246 Vali Acc: 0.480 Test Loss: 1.246 Test Acc: 0.480
Validation loss decreased (inf --> -0.479756).  Saving model ...
Epoch: 2 cost time: 3.1554999351501465
Epoch: 2, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.151 Vali Acc: 0.659 Test Loss: 1.151 Test Acc: 0.659
Validation loss decreased (-0.479756 --> -0.658948).  Saving model ...
Epoch: 3 cost time: 2.8607258796691895
Epoch: 3, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.721 Vali Acc: 0.769 Test Loss: 0.721 Test Acc: 0.769
Validation loss decreased (-0.658948 --> -0.768779).  Saving model ...
Epoch: 4 cost time: 2.8706347942352295
Epoch: 4, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774559).  Saving model ...
Epoch: 5 cost time: 2.7773914337158203
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.074 Vali Acc: 0.792 Test Loss: 1.074 Test Acc: 0.792
Validation loss decreased (-0.774559 --> -0.791897).  Saving model ...
Epoch: 6 cost time: 2.891521453857422
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.763 Test Loss: 1.037 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.955038547515869
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.763 Test Loss: 0.961 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2309930324554443
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.780 Test Loss: 0.930 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.737252950668335
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.786 Test Loss: 0.918 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.230473041534424
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.792 Test Loss: 0.908 Test Acc: 0.792
Validation loss decreased (-0.791897 --> -0.791898).  Saving model ...
Epoch: 11 cost time: 2.9195964336395264
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.792 Test Loss: 0.898 Test Acc: 0.792
Validation loss decreased (-0.791898 --> -0.791899).  Saving model ...
Epoch: 12 cost time: 3.0436654090881348
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.792 Test Loss: 0.891 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791899).  Saving model ...
Epoch: 13 cost time: 2.9627928733825684
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.792 Test Loss: 0.884 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791899).  Saving model ...
Epoch: 14 cost time: 2.9969422817230225
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.792 Test Loss: 0.880 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791899).  Saving model ...
Epoch: 15 cost time: 2.891690969467163
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.798 Test Loss: 0.873 Test Acc: 0.798
Validation loss decreased (-0.791899 --> -0.797679).  Saving model ...
Epoch: 16 cost time: 2.9452879428863525
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.792 Test Loss: 0.871 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5308327674865723
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.798 Test Loss: 0.866 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 18 cost time: 2.727245569229126
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.798 Test Loss: 0.862 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 19 cost time: 2.8466947078704834
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.798 Test Loss: 0.859 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 20 cost time: 2.95723819732666
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.798 Test Loss: 0.858 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 21 cost time: 2.9879143238067627
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.792 Test Loss: 0.855 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9241294860839844
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.792 Test Loss: 0.853 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9142913818359375
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.792 Test Loss: 0.851 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.988530158996582
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.792 Test Loss: 0.848 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.961543321609497
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.792 Test Loss: 0.845 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.030441999435425
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.792 Test Loss: 0.843 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.0183043479919434
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.792 Test Loss: 0.842 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.0176267623901367
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.792 Test Loss: 0.841 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.8192598819732666
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.792 Test Loss: 0.840 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.9568324089050293
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.792 Test Loss: 0.837 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1346543
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7190158367156982
Epoch: 1, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.069 Vali Acc: 0.572 Test Loss: 1.069 Test Acc: 0.572
Validation loss decreased (inf --> -0.572244).  Saving model ...
Epoch: 2 cost time: 2.784902572631836
Epoch: 2, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.806 Vali Acc: 0.688 Test Loss: 0.806 Test Acc: 0.688
Validation loss decreased (-0.572244 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 2.4632956981658936
Epoch: 3, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
Validation loss decreased (-0.687853 --> -0.710972).  Saving model ...
Epoch: 4 cost time: 2.437889575958252
Epoch: 4, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.951 Vali Acc: 0.809 Test Loss: 0.951 Test Acc: 0.809
Validation loss decreased (-0.710972 --> -0.809239).  Saving model ...
Epoch: 5 cost time: 2.5071682929992676
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.757 Test Loss: 0.955 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4805030822753906
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.728 Test Loss: 1.009 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4737303256988525
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.723 Test Loss: 0.964 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3399813175201416
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.740 Test Loss: 0.934 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.745849847793579
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.751 Test Loss: 0.920 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8241724967956543
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.751 Test Loss: 0.910 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2612147331237793
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.751 Test Loss: 0.904 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2396271228790283
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.751 Test Loss: 0.899 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2386064529418945
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.751 Test Loss: 0.896 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0897932052612305
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.751 Test Loss: 0.891 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1343471
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.201876401901245
Epoch: 1, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.182 Vali Acc: 0.549 Test Loss: 1.182 Test Acc: 0.549
Validation loss decreased (inf --> -0.549121).  Saving model ...
Epoch: 2 cost time: 1.938441514968872
Epoch: 2, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.791 Vali Acc: 0.757 Test Loss: 0.791 Test Acc: 0.757
Validation loss decreased (-0.549121 --> -0.757218).  Saving model ...
Epoch: 3 cost time: 2.0043880939483643
Epoch: 3, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.111 Vali Acc: 0.699 Test Loss: 1.111 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.107715129852295
Epoch: 4, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.703 Vali Acc: 0.792 Test Loss: 0.703 Test Acc: 0.792
Validation loss decreased (-0.757218 --> -0.791900).  Saving model ...
Epoch: 5 cost time: 2.1606764793395996
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.745 Vali Acc: 0.751 Test Loss: 0.745 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.776334285736084
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.902 Vali Acc: 0.734 Test Loss: 0.902 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7111754417419434
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.757 Test Loss: 0.857 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.023671865463257
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1405951976776123
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.769 Test Loss: 0.792 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.983130693435669
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.763 Test Loss: 0.814 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0316162109375
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.763 Test Loss: 0.825 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9309601783752441
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.763 Test Loss: 0.832 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0726237297058105
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.763 Test Loss: 0.837 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8235478401184082
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.763 Test Loss: 0.841 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1340399
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.509328842163086
Epoch: 1, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.017 Vali Acc: 0.584 Test Loss: 1.017 Test Acc: 0.584
Validation loss decreased (inf --> -0.583805).  Saving model ...
Epoch: 2 cost time: 1.6199090480804443
Epoch: 2, Steps: 17 | Train Loss: 0.307 Vali Loss: 1.107 Vali Acc: 0.647 Test Loss: 1.107 Test Acc: 0.647
Validation loss decreased (-0.583805 --> -0.647388).  Saving model ...
Epoch: 3 cost time: 1.5306134223937988
Epoch: 3, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.649 Vali Acc: 0.821 Test Loss: 0.649 Test Acc: 0.821
Validation loss decreased (-0.647388 --> -0.820803).  Saving model ...
Epoch: 4 cost time: 1.6607060432434082
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.929 Vali Acc: 0.728 Test Loss: 0.929 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.675926923751831
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.882 Vali Acc: 0.757 Test Loss: 0.882 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6242520809173584
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.042 Vali Acc: 0.734 Test Loss: 1.042 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6604864597320557
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.934 Vali Acc: 0.723 Test Loss: 0.934 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4874229431152344
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.308 Vali Acc: 0.728 Test Loss: 1.308 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7141180038452148
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.302 Vali Acc: 0.723 Test Loss: 1.302 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5903844833374023
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.587 Vali Acc: 0.763 Test Loss: 1.587 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6293954849243164
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.740 Test Loss: 1.428 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6352953910827637
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.574 Vali Acc: 0.728 Test Loss: 1.574 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6551573276519775
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.723 Test Loss: 0.969 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1338351
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4015166759490967
Epoch: 1, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.410 Vali Acc: 0.543 Test Loss: 1.410 Test Acc: 0.543
Validation loss decreased (inf --> -0.543339).  Saving model ...
Epoch: 2 cost time: 1.338578224182129
Epoch: 2, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.996 Vali Acc: 0.711 Test Loss: 0.996 Test Acc: 0.711
Validation loss decreased (-0.543339 --> -0.710973).  Saving model ...
Epoch: 3 cost time: 1.3878166675567627
Epoch: 3, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.677 Vali Acc: 0.757 Test Loss: 0.677 Test Acc: 0.757
Validation loss decreased (-0.710973 --> -0.757219).  Saving model ...
Epoch: 4 cost time: 1.579714059829712
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.076 Vali Acc: 0.740 Test Loss: 1.076 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1971421241760254
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.830 Vali Acc: 0.786 Test Loss: 0.830 Test Acc: 0.786
Validation loss decreased (-0.757219 --> -0.786119).  Saving model ...
Epoch: 6 cost time: 1.3053584098815918
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.728 Vali Acc: 0.786 Test Loss: 0.728 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 1.4513657093048096
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
Validation loss decreased (-0.786120 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 1.4717085361480713
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.798 Test Loss: 0.604 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.49247145652771
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3378174304962158
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.792 Test Loss: 0.664 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2152352333068848
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.821 Test Loss: 0.651 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 1.3290185928344727
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.148 Vali Acc: 0.751 Test Loss: 1.148 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2012085914611816
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.961 Vali Acc: 0.780 Test Loss: 0.961 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.226461410522461
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.195 Vali Acc: 0.809 Test Loss: 1.195 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2952179908752441
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.798 Test Loss: 0.848 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2337989807128906
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.769 Test Loss: 0.874 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3113124370574951
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.751 Test Loss: 0.873 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2851603031158447
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.746 Test Loss: 0.858 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.444218397140503
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.746 Test Loss: 0.847 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.389974594116211
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.746 Test Loss: 0.841 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5871312618255615
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.740 Test Loss: 0.836 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1337327
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.2297415733337402
Epoch: 1, Steps: 17 | Train Loss: 1.658 Vali Loss: 1.094 Vali Acc: 0.578 Test Loss: 1.094 Test Acc: 0.578
Validation loss decreased (inf --> -0.578024).  Saving model ...
Epoch: 2 cost time: 1.2781319618225098
Epoch: 2, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.717 Vali Acc: 0.751 Test Loss: 0.717 Test Acc: 0.751
Validation loss decreased (-0.578024 --> -0.751438).  Saving model ...
Epoch: 3 cost time: 1.2794897556304932
Epoch: 3, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.184 Vali Acc: 0.717 Test Loss: 1.184 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1401846408843994
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.043 Vali Acc: 0.723 Test Loss: 1.043 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1156086921691895
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
Validation loss decreased (-0.751438 --> -0.774558).  Saving model ...
Epoch: 6 cost time: 1.0342926979064941
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.751 Test Loss: 0.889 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2730329036712646
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.019 Vali Acc: 0.746 Test Loss: 1.019 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1197960376739502
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.025 Vali Acc: 0.763 Test Loss: 1.025 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.104957103729248
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.746 Test Loss: 1.087 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1281144618988037
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.769 Test Loss: 0.965 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0542421340942383
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.769 Test Loss: 0.906 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.24298095703125
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0484676361083984
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.769 Test Loss: 0.882 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1428325176239014
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.769 Test Loss: 0.875 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0304391384124756
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.769 Test Loss: 0.872 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1336303
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.828300952911377
Epoch: 1, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.365 Vali Acc: 0.474 Test Loss: 1.365 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 3.328951120376587
Epoch: 2, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.063 Vali Acc: 0.723 Test Loss: 1.063 Test Acc: 0.723
Validation loss decreased (-0.473975 --> -0.722533).  Saving model ...
Epoch: 3 cost time: 3.1848816871643066
Epoch: 3, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.739 Vali Acc: 0.786 Test Loss: 0.739 Test Acc: 0.786
Validation loss decreased (-0.722533 --> -0.786120).  Saving model ...
Epoch: 4 cost time: 3.5067176818847656
Epoch: 4, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.197 Vali Acc: 0.746 Test Loss: 1.197 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.228586196899414
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.127 Vali Acc: 0.746 Test Loss: 1.127 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.194484233856201
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.096 Vali Acc: 0.717 Test Loss: 1.096 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4343698024749756
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.711 Test Loss: 1.490 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4477343559265137
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.586 Vali Acc: 0.699 Test Loss: 1.586 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.652346134185791
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.280 Vali Acc: 0.717 Test Loss: 1.280 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.1056647300720215
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.640 Vali Acc: 0.694 Test Loss: 1.640 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.634267568588257
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.438 Vali Acc: 0.671 Test Loss: 2.438 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.820726156234741
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.018 Vali Acc: 0.717 Test Loss: 2.018 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.900681734085083
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.698 Vali Acc: 0.682 Test Loss: 1.698 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1322879
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.658281326293945
Epoch: 1, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.314 Vali Acc: 0.514 Test Loss: 1.314 Test Acc: 0.514
Validation loss decreased (inf --> -0.514438).  Saving model ...
Epoch: 2 cost time: 3.3439204692840576
Epoch: 2, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.727 Vali Acc: 0.751 Test Loss: 0.727 Test Acc: 0.751
Validation loss decreased (-0.514438 --> -0.751438).  Saving model ...
Epoch: 3 cost time: 3.544414758682251
Epoch: 3, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.347 Vali Acc: 0.723 Test Loss: 1.347 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5837481021881104
Epoch: 4, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.806 Vali Acc: 0.792 Test Loss: 0.806 Test Acc: 0.792
Validation loss decreased (-0.751438 --> -0.791899).  Saving model ...
Epoch: 5 cost time: 3.58132266998291
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.104 Vali Acc: 0.769 Test Loss: 1.104 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.867408037185669
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.949 Vali Acc: 0.769 Test Loss: 1.949 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5470356941223145
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.374 Vali Acc: 0.803 Test Loss: 1.374 Test Acc: 0.803
Validation loss decreased (-0.791899 --> -0.803454).  Saving model ...
Epoch: 8 cost time: 3.392760753631592
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.931 Vali Acc: 0.775 Test Loss: 0.931 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.445371627807617
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.763 Test Loss: 0.986 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3647122383117676
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.763 Test Loss: 0.994 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3894264698028564
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.769 Test Loss: 0.994 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1708123683929443
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.769 Test Loss: 0.992 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3089113235473633
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.769 Test Loss: 0.988 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5848724842071533
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.757 Test Loss: 0.985 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.393712043762207
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.757 Test Loss: 0.983 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.6194183826446533
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.757 Test Loss: 0.982 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.449247360229492
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.757 Test Loss: 0.979 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1319807
model size : 5.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.855088710784912
Epoch: 1, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.264 Vali Acc: 0.601 Test Loss: 1.264 Test Acc: 0.601
Validation loss decreased (inf --> -0.601143).  Saving model ...
Epoch: 2 cost time: 2.6242165565490723
Epoch: 2, Steps: 17 | Train Loss: 0.455 Vali Loss: 1.147 Vali Acc: 0.595 Test Loss: 1.147 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6240086555480957
Epoch: 3, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.223 Vali Acc: 0.630 Test Loss: 1.223 Test Acc: 0.630
Validation loss decreased (-0.601143 --> -0.630046).  Saving model ...
Epoch: 4 cost time: 2.7779176235198975
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.941 Vali Acc: 0.740 Test Loss: 0.941 Test Acc: 0.740
Validation loss decreased (-0.630046 --> -0.739875).  Saving model ...
Epoch: 5 cost time: 2.995293617248535
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.924 Vali Acc: 0.763 Test Loss: 0.924 Test Acc: 0.763
Validation loss decreased (-0.739875 --> -0.762997).  Saving model ...
Epoch: 6 cost time: 2.3755412101745605
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.912 Vali Acc: 0.659 Test Loss: 1.912 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2901124954223633
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.297 Vali Acc: 0.717 Test Loss: 1.297 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4749937057495117
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.757 Test Loss: 0.932 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5533370971679688
Epoch: 9, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
Validation loss decreased (-0.762997 --> -0.774557).  Saving model ...
Epoch: 10 cost time: 2.5178864002227783
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.243 Vali Acc: 0.775 Test Loss: 1.243 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4997777938842773
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.985 Vali Acc: 0.740 Test Loss: 1.985 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.199288845062256
Epoch: 12, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.074 Vali Acc: 0.757 Test Loss: 1.074 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.093423366546631
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.494 Vali Acc: 0.775 Test Loss: 1.494 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0534629821777344
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.413 Vali Acc: 0.705 Test Loss: 2.413 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.901183605194092
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.728 Test Loss: 1.995 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.748542308807373
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.071 Vali Acc: 0.740 Test Loss: 2.071 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.9353737831115723
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.085 Vali Acc: 0.740 Test Loss: 2.085 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.915461301803589
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.081 Vali Acc: 0.746 Test Loss: 2.081 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.9622440338134766
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.074 Vali Acc: 0.746 Test Loss: 2.074 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1315711
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.02605414390564
Epoch: 1, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.266 Vali Acc: 0.520 Test Loss: 1.266 Test Acc: 0.520
Validation loss decreased (inf --> -0.520219).  Saving model ...
Epoch: 2 cost time: 2.8132524490356445
Epoch: 2, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.599 Vali Acc: 0.746 Test Loss: 0.599 Test Acc: 0.746
Validation loss decreased (-0.520219 --> -0.745659).  Saving model ...
Epoch: 3 cost time: 2.7301363945007324
Epoch: 3, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.862 Vali Acc: 0.763 Test Loss: 0.862 Test Acc: 0.763
Validation loss decreased (-0.745659 --> -0.762997).  Saving model ...
Epoch: 4 cost time: 2.7936975955963135
Epoch: 4, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.189 Vali Acc: 0.723 Test Loss: 1.189 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8751254081726074
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.253 Vali Acc: 0.757 Test Loss: 1.253 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5955445766448975
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.139 Vali Acc: 0.728 Test Loss: 1.139 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.290832281112671
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.540 Vali Acc: 0.699 Test Loss: 1.540 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.584099292755127
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.089 Vali Acc: 0.728 Test Loss: 1.089 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.627310276031494
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.763 Test Loss: 1.042 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7263121604919434
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.740 Test Loss: 1.029 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5920486450195312
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.746 Test Loss: 0.988 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5438480377197266
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.751 Test Loss: 0.973 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5421431064605713
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.740 Test Loss: 0.968 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1312639
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4152021408081055
Epoch: 1, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.199 Vali Acc: 0.532 Test Loss: 1.199 Test Acc: 0.532
Validation loss decreased (inf --> -0.531780).  Saving model ...
Epoch: 2 cost time: 2.0986344814300537
Epoch: 2, Steps: 17 | Train Loss: 0.386 Vali Loss: 1.116 Vali Acc: 0.682 Test Loss: 1.116 Test Acc: 0.682
Validation loss decreased (-0.531780 --> -0.682070).  Saving model ...
Epoch: 3 cost time: 2.098567247390747
Epoch: 3, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.562 Vali Acc: 0.798 Test Loss: 0.562 Test Acc: 0.798
Validation loss decreased (-0.682070 --> -0.797682).  Saving model ...
Epoch: 4 cost time: 2.1727514266967773
Epoch: 4, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.551 Vali Acc: 0.705 Test Loss: 1.551 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.033538341522217
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.164 Vali Acc: 0.728 Test Loss: 1.164 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.021326780319214
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.427 Vali Acc: 0.740 Test Loss: 1.427 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9758973121643066
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.555 Vali Acc: 0.746 Test Loss: 1.555 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1243999004364014
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.012 Vali Acc: 0.711 Test Loss: 2.012 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.132998466491699
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.419 Vali Acc: 0.740 Test Loss: 1.419 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.97074294090271
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.613 Vali Acc: 0.723 Test Loss: 1.613 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.105940103530884
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.517 Vali Acc: 0.728 Test Loss: 1.517 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0874931812286377
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.296 Vali Acc: 0.775 Test Loss: 1.296 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9872283935546875
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.491 Vali Acc: 0.717 Test Loss: 1.491 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1309567
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.693695545196533
Epoch: 1, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.153 Vali Acc: 0.555 Test Loss: 1.153 Test Acc: 0.555
Validation loss decreased (inf --> -0.554902).  Saving model ...
Epoch: 2 cost time: 1.5901296138763428
Epoch: 2, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.672 Vali Acc: 0.780 Test Loss: 0.672 Test Acc: 0.780
Validation loss decreased (-0.554902 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 1.6858751773834229
Epoch: 3, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.932 Vali Acc: 0.705 Test Loss: 0.932 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5300798416137695
Epoch: 4, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.995 Vali Acc: 0.751 Test Loss: 0.995 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6194884777069092
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.553 Vali Acc: 0.769 Test Loss: 1.553 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.624932050704956
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.081 Vali Acc: 0.780 Test Loss: 1.081 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5605926513671875
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.005 Vali Acc: 0.769 Test Loss: 1.005 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4872167110443115
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.786 Test Loss: 1.060 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786117).  Saving model ...
Epoch: 9 cost time: 1.6096692085266113
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.792 Test Loss: 0.947 Test Acc: 0.792
Validation loss decreased (-0.786117 --> -0.791898).  Saving model ...
Epoch: 10 cost time: 1.534435510635376
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.792 Test Loss: 0.908 Test Acc: 0.792
Validation loss decreased (-0.791898 --> -0.791898).  Saving model ...
Epoch: 11 cost time: 1.4899282455444336
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.798 Test Loss: 0.889 Test Acc: 0.798
Validation loss decreased (-0.791898 --> -0.797679).  Saving model ...
Epoch: 12 cost time: 1.4324769973754883
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.792 Test Loss: 0.873 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4423706531524658
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.792 Test Loss: 0.865 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4358797073364258
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.792 Test Loss: 0.861 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7185323238372803
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.798 Test Loss: 0.856 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 16 cost time: 1.5950500965118408
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.798 Test Loss: 0.850 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 17 cost time: 1.5991384983062744
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.798 Test Loss: 0.846 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 18 cost time: 1.5843994617462158
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.803 Test Loss: 0.843 Test Acc: 0.803
Validation loss decreased (-0.797679 --> -0.803460).  Saving model ...
Epoch: 19 cost time: 1.5847277641296387
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.803 Test Loss: 0.842 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803460).  Saving model ...
Epoch: 20 cost time: 1.63034987449646
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.809 Test Loss: 0.840 Test Acc: 0.809
Validation loss decreased (-0.803460 --> -0.809240).  Saving model ...
Epoch: 21 cost time: 1.9969666004180908
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.809 Test Loss: 0.839 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809240).  Saving model ...
Epoch: 22 cost time: 1.5001306533813477
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.809 Test Loss: 0.837 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809240).  Saving model ...
Epoch: 23 cost time: 1.6208398342132568
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.809 Test Loss: 0.834 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809240).  Saving model ...
Epoch: 24 cost time: 1.4807705879211426
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.809 Test Loss: 0.832 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809240).  Saving model ...
Epoch: 25 cost time: 1.4596483707427979
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.809 Test Loss: 0.830 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809240).  Saving model ...
Epoch: 26 cost time: 1.5295672416687012
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.809 Test Loss: 0.829 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809240).  Saving model ...
Epoch: 27 cost time: 1.336846113204956
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.803 Test Loss: 0.830 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4732818603515625
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.803 Test Loss: 0.829 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.469064474105835
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.803 Test Loss: 0.828 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4851105213165283
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.803 Test Loss: 0.825 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4948811531066895
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.803 Test Loss: 0.825 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6149122714996338
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.803 Test Loss: 0.825 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5103158950805664
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6144323348999023
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.803 Test Loss: 0.822 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6168286800384521
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.803 Test Loss: 0.822 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6709699630737305
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1307519
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.681281566619873
Epoch: 1, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.235 Vali Acc: 0.509 Test Loss: 1.235 Test Acc: 0.509
Validation loss decreased (inf --> -0.508658).  Saving model ...
Epoch: 2 cost time: 1.6769700050354004
Epoch: 2, Steps: 17 | Train Loss: 0.363 Vali Loss: 1.016 Vali Acc: 0.653 Test Loss: 1.016 Test Acc: 0.653
Validation loss decreased (-0.508658 --> -0.653169).  Saving model ...
Epoch: 3 cost time: 1.4744350910186768
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.161 Vali Acc: 0.682 Test Loss: 1.161 Test Acc: 0.682
Validation loss decreased (-0.653169 --> -0.682069).  Saving model ...
Epoch: 4 cost time: 1.4784514904022217
Epoch: 4, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.306 Vali Acc: 0.717 Test Loss: 1.306 Test Acc: 0.717
Validation loss decreased (-0.682069 --> -0.716750).  Saving model ...
Epoch: 5 cost time: 1.6420955657958984
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.372 Vali Acc: 0.740 Test Loss: 1.372 Test Acc: 0.740
Validation loss decreased (-0.716750 --> -0.739871).  Saving model ...
Epoch: 6 cost time: 1.340707778930664
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.330 Vali Acc: 0.763 Test Loss: 1.330 Test Acc: 0.763
Validation loss decreased (-0.739871 --> -0.762992).  Saving model ...
Epoch: 7 cost time: 1.4515562057495117
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.174 Vali Acc: 0.740 Test Loss: 1.174 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4418387413024902
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.728 Test Loss: 1.671 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3183588981628418
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.763 Test Loss: 1.484 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4669914245605469
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.746 Test Loss: 1.454 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.459808111190796
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.740 Test Loss: 1.369 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4369657039642334
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.751 Test Loss: 1.352 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4554612636566162
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.751 Test Loss: 1.346 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5469164848327637
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.751 Test Loss: 1.341 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6371469497680664
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.751 Test Loss: 1.337 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2186686992645264
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.751 Test Loss: 1.332 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1306495
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.39984393119812
Epoch: 1, Steps: 17 | Train Loss: 1.710 Vali Loss: 1.343 Vali Acc: 0.468 Test Loss: 1.343 Test Acc: 0.468
Validation loss decreased (inf --> -0.468195).  Saving model ...
Epoch: 2 cost time: 1.2890503406524658
Epoch: 2, Steps: 17 | Train Loss: 0.353 Vali Loss: 1.137 Vali Acc: 0.613 Test Loss: 1.137 Test Acc: 0.613
Validation loss decreased (-0.468195 --> -0.612705).  Saving model ...
Epoch: 3 cost time: 1.303652286529541
Epoch: 3, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.648 Vali Acc: 0.792 Test Loss: 0.648 Test Acc: 0.792
Validation loss decreased (-0.612705 --> -0.791901).  Saving model ...
Epoch: 4 cost time: 1.0325865745544434
Epoch: 4, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.186 Vali Acc: 0.728 Test Loss: 1.186 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4544415473937988
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.843 Vali Acc: 0.734 Test Loss: 0.843 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2192118167877197
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.728 Test Loss: 0.875 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2130835056304932
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.642 Vali Acc: 0.792 Test Loss: 0.642 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 1.2826824188232422
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.780 Test Loss: 0.618 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1224684715270996
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.757 Test Loss: 0.871 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.204643964767456
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.757 Test Loss: 0.855 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2555055618286133
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2834157943725586
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.740 Test Loss: 0.778 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3930072784423828
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.740 Test Loss: 0.764 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2560794353485107
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.751 Test Loss: 0.755 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2265114784240723
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.751 Test Loss: 0.749 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3045506477355957
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.751 Test Loss: 0.745 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.197749376296997
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.751 Test Loss: 0.743 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1305471
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.5799126625061035
Epoch: 1, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.084 Vali Acc: 0.584 Test Loss: 1.084 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 3.5043678283691406
Epoch: 2, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.828 Vali Acc: 0.688 Test Loss: 0.828 Test Acc: 0.688
Validation loss decreased (-0.583804 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 4.237292289733887
Epoch: 3, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.120 Vali Acc: 0.705 Test Loss: 1.120 Test Acc: 0.705
Validation loss decreased (-0.687853 --> -0.705191).  Saving model ...
Epoch: 4 cost time: 4.2033960819244385
Epoch: 4, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.128 Vali Acc: 0.746 Test Loss: 1.128 Test Acc: 0.746
Validation loss decreased (-0.705191 --> -0.745653).  Saving model ...
Epoch: 5 cost time: 4.440582275390625
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.943 Vali Acc: 0.786 Test Loss: 0.943 Test Acc: 0.786
Validation loss decreased (-0.745653 --> -0.786118).  Saving model ...
Epoch: 6 cost time: 4.302271366119385
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.027 Vali Acc: 0.751 Test Loss: 1.027 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.28254508972168
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.093 Vali Acc: 0.763 Test Loss: 1.093 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.859708309173584
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.196 Vali Acc: 0.717 Test Loss: 1.196 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.162193059921265
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.751 Test Loss: 0.985 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.2884979248046875
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.081252813339233
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.786 Test Loss: 0.834 Test Acc: 0.786
Validation loss decreased (-0.786118 --> -0.786119).  Saving model ...
Epoch: 12 cost time: 4.1853110790252686
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.786 Test Loss: 0.845 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0846240520477295
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.786 Test Loss: 0.850 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.399143218994141
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.786 Test Loss: 0.850 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.3942649364471436
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.786 Test Loss: 0.851 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.081276178359985
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.786 Test Loss: 0.850 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.725945234298706
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.786 Test Loss: 0.850 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.762592077255249
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.786 Test Loss: 0.849 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5062999725341797
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.786 Test Loss: 0.850 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.5643296241760254
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.786 Test Loss: 0.850 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.041005849838257
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.786 Test Loss: 0.851 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1307463
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.881083011627197
Epoch: 1, Steps: 17 | Train Loss: 1.709 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
Validation loss decreased (inf --> -0.520219).  Saving model ...
Epoch: 2 cost time: 3.404691696166992
Epoch: 2, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.777 Vali Acc: 0.723 Test Loss: 0.777 Test Acc: 0.723
Validation loss decreased (-0.520219 --> -0.722536).  Saving model ...
Epoch: 3 cost time: 4.123043775558472
Epoch: 3, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.971 Vali Acc: 0.694 Test Loss: 0.971 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.199389696121216
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774558).  Saving model ...
Epoch: 5 cost time: 3.989211082458496
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.891 Vali Acc: 0.763 Test Loss: 0.891 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.004812717437744
Epoch: 6, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.832 Vali Acc: 0.780 Test Loss: 0.832 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780338).  Saving model ...
Epoch: 7 cost time: 4.048737049102783
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.113 Vali Acc: 0.734 Test Loss: 1.113 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.055665493011475
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.952 Vali Acc: 0.751 Test Loss: 0.952 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8718998432159424
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.844 Vali Acc: 0.751 Test Loss: 0.844 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3703277111053467
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.129 Vali Acc: 0.734 Test Loss: 1.129 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.432171583175659
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.343 Vali Acc: 0.751 Test Loss: 1.343 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4932212829589844
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.668 Vali Acc: 0.746 Test Loss: 1.668 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.257575273513794
Epoch: 13, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.531 Vali Acc: 0.763 Test Loss: 1.531 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.969733715057373
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.982 Vali Acc: 0.723 Test Loss: 1.982 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6771061420440674
Epoch: 15, Steps: 17 | Train Loss: 0.174 Vali Loss: 2.976 Vali Acc: 0.717 Test Loss: 2.976 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.17192530632019
Epoch: 16, Steps: 17 | Train Loss: 0.027 Vali Loss: 2.237 Vali Acc: 0.711 Test Loss: 2.237 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1304391
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.579775333404541
Epoch: 1, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.419 Vali Acc: 0.445 Test Loss: 1.419 Test Acc: 0.445
Validation loss decreased (inf --> -0.445073).  Saving model ...
Epoch: 2 cost time: 3.09128475189209
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.731 Vali Acc: 0.734 Test Loss: 0.731 Test Acc: 0.734
Validation loss decreased (-0.445073 --> -0.734097).  Saving model ...
Epoch: 3 cost time: 2.913839340209961
Epoch: 3, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.905 Vali Acc: 0.740 Test Loss: 0.905 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739875).  Saving model ...
Epoch: 4 cost time: 3.128187417984009
Epoch: 4, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.662 Vali Acc: 0.682 Test Loss: 1.662 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.218755006790161
Epoch: 5, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.093 Vali Acc: 0.775 Test Loss: 1.093 Test Acc: 0.775
Validation loss decreased (-0.739875 --> -0.774556).  Saving model ...
Epoch: 6 cost time: 3.170034408569336
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.051 Vali Acc: 0.740 Test Loss: 1.051 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1828079223632812
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.985 Vali Acc: 0.763 Test Loss: 0.985 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3762738704681396
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.174 Vali Acc: 0.757 Test Loss: 1.174 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.457642078399658
Epoch: 9, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.476 Vali Acc: 0.728 Test Loss: 1.476 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8852577209472656
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.395 Vali Acc: 0.728 Test Loss: 1.395 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.296433448791504
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.296 Vali Acc: 0.763 Test Loss: 1.296 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4240529537200928
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.780 Test Loss: 1.140 Test Acc: 0.780
Validation loss decreased (-0.774556 --> -0.780335).  Saving model ...
Epoch: 13 cost time: 3.0556154251098633
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.769 Test Loss: 1.178 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3096535205841064
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.775 Test Loss: 1.188 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6675987243652344
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.775 Test Loss: 1.186 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1751277446746826
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.775 Test Loss: 1.182 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7993407249450684
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.775 Test Loss: 1.179 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.5368340015411377
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.775 Test Loss: 1.176 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.75063157081604
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.775 Test Loss: 1.175 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.5289196968078613
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.775 Test Loss: 1.173 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5558838844299316
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.780 Test Loss: 1.172 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.524958848953247
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.780 Test Loss: 1.171 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1300295
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.392630100250244
Epoch: 1, Steps: 17 | Train Loss: 1.672 Vali Loss: 1.082 Vali Acc: 0.561 Test Loss: 1.082 Test Acc: 0.561
Validation loss decreased (inf --> -0.560683).  Saving model ...
Epoch: 2 cost time: 2.587074041366577
Epoch: 2, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
Validation loss decreased (-0.560683 --> -0.774559).  Saving model ...
Epoch: 3 cost time: 1.9980316162109375
Epoch: 3, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.992 Vali Acc: 0.705 Test Loss: 0.992 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0959694385528564
Epoch: 4, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.952 Vali Acc: 0.763 Test Loss: 0.952 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.345365524291992
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.969 Vali Acc: 0.723 Test Loss: 0.969 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3737239837646484
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.773 Vali Acc: 0.786 Test Loss: 0.773 Test Acc: 0.786
Validation loss decreased (-0.774559 --> -0.786119).  Saving model ...
Epoch: 7 cost time: 2.4560039043426514
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.734 Test Loss: 0.875 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2339026927948
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1683616638183594
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.746 Test Loss: 0.845 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5109519958496094
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.757 Test Loss: 0.818 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0398643016815186
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.757 Test Loss: 0.811 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.894298791885376
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.757 Test Loss: 0.806 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3876760005950928
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.757 Test Loss: 0.805 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.601689338684082
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.757 Test Loss: 0.804 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3002941608428955
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.757 Test Loss: 0.803 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.84118914604187
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1297223
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3957512378692627
Epoch: 1, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.099 Vali Acc: 0.561 Test Loss: 1.099 Test Acc: 0.561
Validation loss decreased (inf --> -0.560683).  Saving model ...
Epoch: 2 cost time: 2.39436936378479
Epoch: 2, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
Validation loss decreased (-0.560683 --> -0.762998).  Saving model ...
Epoch: 3 cost time: 2.028395414352417
Epoch: 3, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.738 Vali Acc: 0.728 Test Loss: 0.738 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.297039747238159
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.275 Vali Acc: 0.699 Test Loss: 1.275 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1007461547851562
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.145 Vali Acc: 0.728 Test Loss: 1.145 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4343113899230957
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.875 Vali Acc: 0.682 Test Loss: 1.875 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3967909812927246
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.024 Vali Acc: 0.711 Test Loss: 2.024 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7336628437042236
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.723 Test Loss: 1.276 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1367504596710205
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.303 Vali Acc: 0.728 Test Loss: 1.303 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6978561878204346
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.734 Test Loss: 1.193 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4860727787017822
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.740 Test Loss: 1.182 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.328432321548462
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.740 Test Loss: 1.172 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1294151
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.723656177520752
Epoch: 1, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.359 Vali Acc: 0.514 Test Loss: 1.359 Test Acc: 0.514
Validation loss decreased (inf --> -0.514437).  Saving model ...
Epoch: 2 cost time: 1.4520690441131592
Epoch: 2, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.879 Vali Acc: 0.699 Test Loss: 0.879 Test Acc: 0.699
Validation loss decreased (-0.514437 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 1.4860939979553223
Epoch: 3, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.394 Vali Acc: 0.647 Test Loss: 1.394 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8894293308258057
Epoch: 4, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.801 Vali Acc: 0.746 Test Loss: 0.801 Test Acc: 0.746
Validation loss decreased (-0.699413 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 1.6765918731689453
Epoch: 5, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.778 Vali Acc: 0.751 Test Loss: 0.778 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751437).  Saving model ...
Epoch: 6 cost time: 1.9465656280517578
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.780 Test Loss: 0.679 Test Acc: 0.780
Validation loss decreased (-0.751437 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 1.455230951309204
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.757 Test Loss: 0.825 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8323616981506348
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5547113418579102
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.763 Test Loss: 0.680 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9220893383026123
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7258057594299316
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.763 Test Loss: 0.697 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5588877201080322
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.763 Test Loss: 0.698 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2553527355194092
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.763 Test Loss: 0.698 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6931064128875732
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.763 Test Loss: 0.699 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3617234230041504
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.763 Test Loss: 0.697 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8080601692199707
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1292103
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9135024547576904
Epoch: 1, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.201 Vali Acc: 0.549 Test Loss: 1.201 Test Acc: 0.549
Validation loss decreased (inf --> -0.549121).  Saving model ...
Epoch: 2 cost time: 1.5926868915557861
Epoch: 2, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.007 Vali Acc: 0.676 Test Loss: 1.007 Test Acc: 0.676
Validation loss decreased (-0.549121 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 1.4506804943084717
Epoch: 3, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.809 Vali Acc: 0.746 Test Loss: 0.809 Test Acc: 0.746
Validation loss decreased (-0.676291 --> -0.745657).  Saving model ...
Epoch: 4 cost time: 1.640472650527954
Epoch: 4, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.853 Vali Acc: 0.769 Test Loss: 0.853 Test Acc: 0.769
Validation loss decreased (-0.745657 --> -0.768778).  Saving model ...
Epoch: 5 cost time: 1.4989004135131836
Epoch: 5, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.982 Vali Acc: 0.757 Test Loss: 0.982 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5158164501190186
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.272 Vali Acc: 0.728 Test Loss: 1.272 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3291511535644531
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.091 Vali Acc: 0.763 Test Loss: 1.091 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3791580200195312
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.775 Test Loss: 0.966 Test Acc: 0.775
Validation loss decreased (-0.768778 --> -0.774557).  Saving model ...
Epoch: 9 cost time: 1.1877169609069824
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.769 Test Loss: 0.999 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.569751262664795
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.780 Test Loss: 0.959 Test Acc: 0.780
Validation loss decreased (-0.774557 --> -0.780337).  Saving model ...
Epoch: 11 cost time: 1.427717685699463
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.798 Test Loss: 0.930 Test Acc: 0.798
Validation loss decreased (-0.780337 --> -0.797679).  Saving model ...
Epoch: 12 cost time: 1.5370934009552002
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.792 Test Loss: 0.913 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2787940502166748
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.798 Test Loss: 0.903 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 14 cost time: 1.6632881164550781
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.798 Test Loss: 0.893 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 15 cost time: 1.3230857849121094
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.798 Test Loss: 0.892 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 16 cost time: 1.3566317558288574
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.792 Test Loss: 0.882 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6753714084625244
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.798 Test Loss: 0.878 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 18 cost time: 1.4354212284088135
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.798 Test Loss: 0.873 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 19 cost time: 1.6069905757904053
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.798 Test Loss: 0.868 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 20 cost time: 1.3674542903900146
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.798 Test Loss: 0.864 Test Acc: 0.798
Validation loss decreased (-0.797679 --> -0.797679).  Saving model ...
Epoch: 21 cost time: 1.4285340309143066
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.803 Test Loss: 0.861 Test Acc: 0.803
Validation loss decreased (-0.797679 --> -0.803460).  Saving model ...
Epoch: 22 cost time: 1.4036684036254883
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.803 Test Loss: 0.858 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803460).  Saving model ...
Epoch: 23 cost time: 1.5392992496490479
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.803 Test Loss: 0.855 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803460).  Saving model ...
Epoch: 24 cost time: 1.5008039474487305
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.803 Test Loss: 0.854 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803460).  Saving model ...
Epoch: 25 cost time: 1.6697132587432861
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.803 Test Loss: 0.852 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803460).  Saving model ...
Epoch: 26 cost time: 1.316511631011963
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.798 Test Loss: 0.847 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.464259386062622
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.798 Test Loss: 0.844 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3235125541687012
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.798 Test Loss: 0.843 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5492029190063477
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.798 Test Loss: 0.842 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2505548000335693
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.798 Test Loss: 0.841 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2835679054260254
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.798 Test Loss: 0.839 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4628219604492188
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.798 Test Loss: 0.838 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1886053085327148
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.798 Test Loss: 0.836 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5722441673278809
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.798 Test Loss: 0.834 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4944305419921875
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.798 Test Loss: 0.834 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1291079
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6122212409973145
Epoch: 1, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.293 Vali Acc: 0.480 Test Loss: 1.293 Test Acc: 0.480
Validation loss decreased (inf --> -0.479756).  Saving model ...
Epoch: 2 cost time: 1.2644660472869873
Epoch: 2, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.816 Vali Acc: 0.723 Test Loss: 0.816 Test Acc: 0.723
Validation loss decreased (-0.479756 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.2241778373718262
Epoch: 3, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.483 Vali Acc: 0.642 Test Loss: 1.483 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4847538471221924
Epoch: 4, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.032 Vali Acc: 0.699 Test Loss: 1.032 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3157238960266113
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.346 Vali Acc: 0.682 Test Loss: 1.346 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1947479248046875
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.901 Vali Acc: 0.763 Test Loss: 0.901 Test Acc: 0.763
Validation loss decreased (-0.722535 --> -0.762997).  Saving model ...
Epoch: 7 cost time: 1.169971227645874
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.985 Vali Acc: 0.763 Test Loss: 0.985 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3728511333465576
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.723 Test Loss: 0.853 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5788943767547607
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.746 Test Loss: 1.000 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2951395511627197
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.711 Test Loss: 0.910 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4299006462097168
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.717 Test Loss: 0.884 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2883484363555908
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.717 Test Loss: 0.877 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2449424266815186
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.717 Test Loss: 0.870 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4659199714660645
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2719645500183105
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.605546474456787
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.717 Test Loss: 0.850 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1290055
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.139918565750122
Epoch: 1, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.144 Vali Acc: 0.584 Test Loss: 1.144 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 4.346595287322998
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.985 Vali Acc: 0.688 Test Loss: 0.985 Test Acc: 0.688
Validation loss decreased (-0.583804 --> -0.687851).  Saving model ...
Epoch: 3 cost time: 4.087371587753296
Epoch: 3, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.839 Vali Acc: 0.734 Test Loss: 0.839 Test Acc: 0.734
Validation loss decreased (-0.687851 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 4.180774688720703
Epoch: 4, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.370 Vali Acc: 0.624 Test Loss: 2.370 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.526867628097534
Epoch: 5, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.239 Vali Acc: 0.757 Test Loss: 1.239 Test Acc: 0.757
Validation loss decreased (-0.734096 --> -0.757213).  Saving model ...
Epoch: 6 cost time: 3.243774652481079
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.174 Vali Acc: 0.746 Test Loss: 1.174 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.264388084411621
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.183 Vali Acc: 0.740 Test Loss: 1.183 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4267160892486572
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.364 Vali Acc: 0.746 Test Loss: 1.364 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6053404808044434
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.751 Test Loss: 0.996 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7102484703063965
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.331 Vali Acc: 0.746 Test Loss: 1.331 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.0076446533203125
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.723 Test Loss: 1.370 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.337003469467163
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.728 Test Loss: 1.299 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.254454851150513
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.728 Test Loss: 1.257 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.128494024276733
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.728 Test Loss: 1.227 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.425433874130249
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.734 Test Loss: 1.210 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1299755
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.745558977127075
Epoch: 1, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.239 Vali Acc: 0.520 Test Loss: 1.239 Test Acc: 0.520
Validation loss decreased (inf --> -0.520219).  Saving model ...
Epoch: 2 cost time: 3.9042141437530518
Epoch: 2, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.719 Vali Acc: 0.705 Test Loss: 0.719 Test Acc: 0.705
Validation loss decreased (-0.520219 --> -0.705195).  Saving model ...
Epoch: 3 cost time: 3.7822346687316895
Epoch: 3, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.738 Vali Acc: 0.757 Test Loss: 0.738 Test Acc: 0.757
Validation loss decreased (-0.705195 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 3.9091570377349854
Epoch: 4, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.246 Vali Acc: 0.734 Test Loss: 1.246 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8597583770751953
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.035 Vali Acc: 0.740 Test Loss: 1.035 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6925010681152344
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.111 Vali Acc: 0.734 Test Loss: 1.111 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.437411069869995
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.359 Vali Acc: 0.728 Test Loss: 1.359 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.622605562210083
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.808 Vali Acc: 0.786 Test Loss: 0.808 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786119).  Saving model ...
Epoch: 9 cost time: 3.713087797164917
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.571317434310913
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.327 Vali Acc: 0.740 Test Loss: 1.327 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7489781379699707
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.763 Test Loss: 0.982 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.701179027557373
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.769 Test Loss: 0.997 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.724740505218506
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.746 Test Loss: 0.924 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.178330183029175
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.757 Test Loss: 0.919 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.641493797302246
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.751 Test Loss: 0.915 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6406309604644775
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.746 Test Loss: 0.903 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.698570489883423
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.763 Test Loss: 0.901 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.5233592987060547
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.763 Test Loss: 0.902 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1296683
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.37821626663208
Epoch: 1, Steps: 17 | Train Loss: 1.739 Vali Loss: 1.094 Vali Acc: 0.561 Test Loss: 1.094 Test Acc: 0.561
Validation loss decreased (inf --> -0.560683).  Saving model ...
Epoch: 2 cost time: 3.2089507579803467
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.914 Vali Acc: 0.671 Test Loss: 0.914 Test Acc: 0.671
Validation loss decreased (-0.560683 --> -0.670511).  Saving model ...
Epoch: 3 cost time: 2.8376383781433105
Epoch: 3, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.994 Vali Acc: 0.705 Test Loss: 0.994 Test Acc: 0.705
Validation loss decreased (-0.670511 --> -0.705192).  Saving model ...
Epoch: 4 cost time: 3.116398334503174
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.152 Vali Acc: 0.665 Test Loss: 1.152 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3236939907073975
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.153 Vali Acc: 0.717 Test Loss: 1.153 Test Acc: 0.717
Validation loss decreased (-0.705192 --> -0.716751).  Saving model ...
Epoch: 6 cost time: 3.052778482437134
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.132 Vali Acc: 0.757 Test Loss: 1.132 Test Acc: 0.757
Validation loss decreased (-0.716751 --> -0.757214).  Saving model ...
Epoch: 7 cost time: 3.2468204498291016
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.837 Vali Acc: 0.694 Test Loss: 1.837 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9305429458618164
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.778 Vali Acc: 0.734 Test Loss: 1.778 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8517651557922363
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.095 Vali Acc: 0.671 Test Loss: 2.095 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.821413516998291
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.688 Test Loss: 1.650 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.133733034133911
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.447 Vali Acc: 0.734 Test Loss: 1.447 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1794309616088867
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 2.427 Vali Acc: 0.728 Test Loss: 2.427 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.356045961380005
Epoch: 13, Steps: 17 | Train Loss: 0.258 Vali Loss: 2.269 Vali Acc: 0.740 Test Loss: 2.269 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.885721445083618
Epoch: 14, Steps: 17 | Train Loss: 0.474 Vali Loss: 3.234 Vali Acc: 0.751 Test Loss: 3.234 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0933759212493896
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.606 Vali Acc: 0.740 Test Loss: 2.606 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.291478395462036
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 3.253 Vali Acc: 0.734 Test Loss: 3.253 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1292587
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.4001264572143555
Epoch: 1, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.364 Vali Acc: 0.520 Test Loss: 1.364 Test Acc: 0.520
Validation loss decreased (inf --> -0.520218).  Saving model ...
Epoch: 2 cost time: 2.9670400619506836
Epoch: 2, Steps: 17 | Train Loss: 0.580 Vali Loss: 1.864 Vali Acc: 0.543 Test Loss: 1.864 Test Acc: 0.543
Validation loss decreased (-0.520218 --> -0.543334).  Saving model ...
Epoch: 3 cost time: 2.5188727378845215
Epoch: 3, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.755 Vali Acc: 0.723 Test Loss: 0.755 Test Acc: 0.723
Validation loss decreased (-0.543334 --> -0.722536).  Saving model ...
Epoch: 4 cost time: 2.4083430767059326
Epoch: 4, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.696 Vali Acc: 0.659 Test Loss: 1.696 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7914602756500244
Epoch: 5, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.343 Vali Acc: 0.694 Test Loss: 1.343 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8687429428100586
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.497 Vali Acc: 0.757 Test Loss: 1.497 Test Acc: 0.757
Validation loss decreased (-0.722536 --> -0.757210).  Saving model ...
Epoch: 7 cost time: 2.8802897930145264
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.905 Vali Acc: 0.642 Test Loss: 2.905 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2843286991119385
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.276 Vali Acc: 0.746 Test Loss: 1.276 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1249964237213135
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.400 Vali Acc: 0.688 Test Loss: 2.400 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.134803295135498
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.769 Test Loss: 1.103 Test Acc: 0.769
Validation loss decreased (-0.757210 --> -0.768775).  Saving model ...
Epoch: 11 cost time: 3.1601905822753906
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.734 Test Loss: 1.183 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.717987060546875
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.728 Test Loss: 1.185 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.885741949081421
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.728 Test Loss: 1.172 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.496220588684082
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.711 Test Loss: 1.154 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7741429805755615
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.146 Vali Acc: 0.717 Test Loss: 1.146 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.647083044052124
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.717 Test Loss: 1.139 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.343039035797119
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.723 Test Loss: 1.132 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.155344247817993
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.723 Test Loss: 1.127 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.997126817703247
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.723 Test Loss: 1.124 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8881795406341553
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.723 Test Loss: 1.122 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1289515
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6372268199920654
Epoch: 1, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.328 Vali Acc: 0.543 Test Loss: 1.328 Test Acc: 0.543
Validation loss decreased (inf --> -0.543339).  Saving model ...
Epoch: 2 cost time: 2.2272138595581055
Epoch: 2, Steps: 17 | Train Loss: 0.650 Vali Loss: 1.145 Vali Acc: 0.578 Test Loss: 1.145 Test Acc: 0.578
Validation loss decreased (-0.543339 --> -0.578023).  Saving model ...
Epoch: 3 cost time: 2.3579676151275635
Epoch: 3, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
Validation loss decreased (-0.578023 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 2.195272445678711
Epoch: 4, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.689 Vali Acc: 0.751 Test Loss: 0.689 Test Acc: 0.751
Validation loss decreased (-0.716755 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 1.9013261795043945
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.037 Vali Acc: 0.757 Test Loss: 1.037 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757215).  Saving model ...
Epoch: 6 cost time: 1.9489665031433105
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.778 Vali Acc: 0.746 Test Loss: 0.778 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6438448429107666
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.757215 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 2.0528972148895264
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.763 Test Loss: 1.032 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2597150802612305
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.107 Vali Acc: 0.792 Test Loss: 1.107 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1110661029815674
Epoch: 10, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.162 Vali Acc: 0.659 Test Loss: 2.162 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2169973850250244
Epoch: 11, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.301 Vali Acc: 0.786 Test Loss: 1.301 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2148351669311523
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.824 Vali Acc: 0.751 Test Loss: 1.824 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.269141912460327
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.595 Vali Acc: 0.809 Test Loss: 1.595 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809233).  Saving model ...
Epoch: 14 cost time: 2.0929629802703857
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.034 Vali Acc: 0.757 Test Loss: 2.034 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6134047508239746
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.414 Vali Acc: 0.809 Test Loss: 1.414 Test Acc: 0.809
Validation loss decreased (-0.809233 --> -0.809234).  Saving model ...
Epoch: 16 cost time: 1.9969902038574219
Epoch: 16, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.528 Vali Acc: 0.798 Test Loss: 1.528 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2935330867767334
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.759 Vali Acc: 0.711 Test Loss: 2.759 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0818190574645996
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 3.061 Vali Acc: 0.699 Test Loss: 3.061 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8589372634887695
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 2.098 Vali Acc: 0.757 Test Loss: 2.098 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.016016960144043
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.695 Vali Acc: 0.711 Test Loss: 2.695 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.146646738052368
Epoch: 21, Steps: 17 | Train Loss: 0.203 Vali Loss: 3.038 Vali Acc: 0.711 Test Loss: 3.038 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5687665939331055
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.461 Vali Acc: 0.780 Test Loss: 2.461 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3869123458862305
Epoch: 23, Steps: 17 | Train Loss: 0.110 Vali Loss: 3.863 Vali Acc: 0.705 Test Loss: 3.863 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0483663082122803
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 3.039 Vali Acc: 0.746 Test Loss: 3.039 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.084740161895752
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.783 Vali Acc: 0.705 Test Loss: 2.783 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1286443
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.229355573654175
Epoch: 1, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.679 Vali Acc: 0.347 Test Loss: 1.679 Test Acc: 0.347
Validation loss decreased (inf --> -0.346804).  Saving model ...
Epoch: 2 cost time: 1.6453726291656494
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.875 Vali Acc: 0.688 Test Loss: 0.875 Test Acc: 0.688
Validation loss decreased (-0.346804 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 1.7637605667114258
Epoch: 3, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
Validation loss decreased (-0.687853 --> -0.716754).  Saving model ...
Epoch: 4 cost time: 1.6921634674072266
Epoch: 4, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.300 Vali Acc: 0.740 Test Loss: 1.300 Test Acc: 0.740
Validation loss decreased (-0.716754 --> -0.739871).  Saving model ...
Epoch: 5 cost time: 1.656066656112671
Epoch: 5, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.879 Vali Acc: 0.786 Test Loss: 0.879 Test Acc: 0.786
Validation loss decreased (-0.739871 --> -0.786118).  Saving model ...
Epoch: 6 cost time: 1.7377543449401855
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.158 Vali Acc: 0.705 Test Loss: 1.158 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9171526432037354
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.496 Vali Acc: 0.751 Test Loss: 1.496 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.524979591369629
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.005 Vali Acc: 0.775 Test Loss: 1.005 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6122868061065674
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.662 Vali Acc: 0.699 Test Loss: 1.662 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6882450580596924
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.542 Vali Acc: 0.746 Test Loss: 1.542 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7054336071014404
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.951 Vali Acc: 0.699 Test Loss: 1.951 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7391254901885986
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.699 Test Loss: 1.534 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.78361177444458
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.705 Test Loss: 1.490 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7238359451293945
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.711 Test Loss: 1.452 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7599773406982422
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.699 Test Loss: 1.414 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1284395
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0686726570129395
Epoch: 1, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.487 Vali Acc: 0.451 Test Loss: 1.487 Test Acc: 0.451
Validation loss decreased (inf --> -0.450852).  Saving model ...
Epoch: 2 cost time: 1.5312480926513672
Epoch: 2, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.947 Vali Acc: 0.636 Test Loss: 0.947 Test Acc: 0.636
Validation loss decreased (-0.450852 --> -0.635829).  Saving model ...
Epoch: 3 cost time: 1.4130887985229492
Epoch: 3, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.726 Vali Acc: 0.728 Test Loss: 0.726 Test Acc: 0.728
Validation loss decreased (-0.635829 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 1.3456227779388428
Epoch: 4, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.677 Vali Acc: 0.786 Test Loss: 0.677 Test Acc: 0.786
Validation loss decreased (-0.728316 --> -0.786120).  Saving model ...
Epoch: 5 cost time: 1.4432001113891602
Epoch: 5, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.562 Vali Acc: 0.717 Test Loss: 1.562 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4215917587280273
Epoch: 6, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.309 Vali Acc: 0.728 Test Loss: 1.309 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4640936851501465
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.980 Vali Acc: 0.751 Test Loss: 0.980 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.575075626373291
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.731 Vali Acc: 0.699 Test Loss: 1.731 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5442638397216797
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.111 Vali Acc: 0.757 Test Loss: 1.111 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5466272830963135
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.112 Vali Acc: 0.694 Test Loss: 2.112 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5937066078186035
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.894 Vali Acc: 0.740 Test Loss: 1.894 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4880709648132324
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.586 Vali Acc: 0.659 Test Loss: 2.586 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5504968166351318
Epoch: 13, Steps: 17 | Train Loss: 0.057 Vali Loss: 2.795 Vali Acc: 0.671 Test Loss: 2.795 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4364001750946045
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.579 Vali Acc: 0.798 Test Loss: 1.579 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797672).  Saving model ...
Epoch: 15 cost time: 1.3664391040802002
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.731 Vali Acc: 0.769 Test Loss: 1.731 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5029489994049072
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.734 Test Loss: 2.225 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4730970859527588
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.007 Vali Acc: 0.746 Test Loss: 2.007 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5905303955078125
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.751 Test Loss: 1.932 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.520280361175537
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.751 Test Loss: 1.908 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5067570209503174
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.751 Test Loss: 1.898 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5656559467315674
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.891 Vali Acc: 0.751 Test Loss: 1.891 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6617159843444824
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.746 Test Loss: 1.884 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5804569721221924
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.757 Test Loss: 1.878 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3447623252868652
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.757 Test Loss: 1.871 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1283371
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5082406997680664
Epoch: 1, Steps: 17 | Train Loss: 1.785 Vali Loss: 1.353 Vali Acc: 0.474 Test Loss: 1.353 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 0.9695956707000732
Epoch: 2, Steps: 17 | Train Loss: 0.478 Vali Loss: 1.162 Vali Acc: 0.618 Test Loss: 1.162 Test Acc: 0.618
Validation loss decreased (-0.473975 --> -0.618485).  Saving model ...
Epoch: 3 cost time: 1.1858761310577393
Epoch: 3, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.148 Vali Acc: 0.630 Test Loss: 1.148 Test Acc: 0.630
Validation loss decreased (-0.618485 --> -0.630046).  Saving model ...
Epoch: 4 cost time: 1.1929771900177002
Epoch: 4, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.928 Vali Acc: 0.723 Test Loss: 0.928 Test Acc: 0.723
Validation loss decreased (-0.630046 --> -0.722534).  Saving model ...
Epoch: 5 cost time: 1.1102468967437744
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.234 Vali Acc: 0.728 Test Loss: 1.234 Test Acc: 0.728
Validation loss decreased (-0.722534 --> -0.728311).  Saving model ...
Epoch: 6 cost time: 1.1088979244232178
Epoch: 6, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.159 Vali Acc: 0.740 Test Loss: 1.159 Test Acc: 0.740
Validation loss decreased (-0.728311 --> -0.739873).  Saving model ...
Epoch: 7 cost time: 1.0225811004638672
Epoch: 7, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.782 Vali Acc: 0.711 Test Loss: 1.782 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.325632095336914
Epoch: 8, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.576 Vali Acc: 0.723 Test Loss: 1.576 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1298828125
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.074 Vali Acc: 0.676 Test Loss: 2.074 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1380500793457031
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 2.974 Vali Acc: 0.647 Test Loss: 2.974 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.264775037765503
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.438 Vali Acc: 0.751 Test Loss: 1.438 Test Acc: 0.751
Validation loss decreased (-0.739873 --> -0.751431).  Saving model ...
Epoch: 12 cost time: 1.1916751861572266
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.705 Test Loss: 1.267 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.308725118637085
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.694 Test Loss: 1.449 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2108378410339355
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.688 Test Loss: 1.533 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.312812328338623
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.694 Test Loss: 1.543 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2539527416229248
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.694 Test Loss: 1.524 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.289825439453125
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.699 Test Loss: 1.508 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0479066371917725
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.705 Test Loss: 1.495 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0444648265838623
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.705 Test Loss: 1.484 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0737016201019287
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.711 Test Loss: 1.473 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3108205795288086
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.711 Test Loss: 1.462 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1282347
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.234294414520264
Epoch: 1, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.222 Vali Acc: 0.543 Test Loss: 1.222 Test Acc: 0.543
Validation loss decreased (inf --> -0.543340).  Saving model ...
Epoch: 2 cost time: 4.243274927139282
Epoch: 2, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.543340 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 4.501136302947998
Epoch: 3, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.745 Vali Acc: 0.763 Test Loss: 0.745 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.762998).  Saving model ...
Epoch: 4 cost time: 4.315224647521973
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
Validation loss decreased (-0.762998 --> -0.774558).  Saving model ...
Epoch: 5 cost time: 4.454537868499756
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.987 Vali Acc: 0.746 Test Loss: 0.987 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.191562652587891
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.728 Test Loss: 0.988 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.944972038269043
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.728 Test Loss: 0.940 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.359557628631592
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.751 Test Loss: 0.764 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1558611392974854
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.757 Test Loss: 0.758 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.1787469387054443
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.751 Test Loss: 0.760 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.070673704147339
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.151195764541626
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.751 Test Loss: 0.767 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.3484764099121094
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.740 Test Loss: 0.769 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.108493804931641
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.740 Test Loss: 0.768 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1290121
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.135981798171997
Epoch: 1, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.090 Vali Acc: 0.566 Test Loss: 1.090 Test Acc: 0.566
Validation loss decreased (inf --> -0.566463).  Saving model ...
Epoch: 2 cost time: 2.9347870349884033
Epoch: 2, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.841 Vali Acc: 0.688 Test Loss: 0.841 Test Acc: 0.688
Validation loss decreased (-0.566463 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 3.0142643451690674
Epoch: 3, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
Validation loss decreased (-0.687853 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 3.2731497287750244
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.769 Test Loss: 0.843 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.310803174972534
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.211436986923218
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7840962409973145
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.751 Test Loss: 0.716 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.836033582687378
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.746 Test Loss: 0.717 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6558802127838135
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.746 Test Loss: 0.718 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.642629384994507
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.751 Test Loss: 0.720 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.11823296546936
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.751 Test Loss: 0.720 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.106963157653809
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.751 Test Loss: 0.724 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9168014526367188
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.751 Test Loss: 0.727 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1287049
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.3095057010650635
Epoch: 1, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.055 Vali Acc: 0.682 Test Loss: 1.055 Test Acc: 0.682
Validation loss decreased (inf --> -0.682070).  Saving model ...
Epoch: 2 cost time: 2.978588342666626
Epoch: 2, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
Validation loss decreased (-0.682070 --> -0.728315).  Saving model ...
Epoch: 3 cost time: 2.89790940284729
Epoch: 3, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.088 Vali Acc: 0.705 Test Loss: 1.088 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7829062938690186
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.808 Vali Acc: 0.734 Test Loss: 0.808 Test Acc: 0.734
Validation loss decreased (-0.728315 --> -0.734096).  Saving model ...
Epoch: 5 cost time: 2.9627413749694824
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.326029062271118
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.740 Test Loss: 0.756 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739877).  Saving model ...
Epoch: 7 cost time: 2.8863604068756104
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.876 Vali Acc: 0.694 Test Loss: 0.876 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.052405834197998
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.723 Test Loss: 0.759 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9589691162109375
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.740 Test Loss: 0.751 Test Acc: 0.740
Validation loss decreased (-0.739877 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 3.129640817642212
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.728 Test Loss: 0.745 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.163095235824585
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.728 Test Loss: 0.752 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2343039512634277
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.728 Test Loss: 0.755 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.933204174041748
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.728 Test Loss: 0.755 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5800817012786865
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.728 Test Loss: 0.759 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.617638349533081
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.728 Test Loss: 0.759 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.919834613800049
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.728 Test Loss: 0.760 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.158442974090576
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.835111618041992
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.175198554992676
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 1282953
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.14004921913147
Epoch: 1, Steps: 17 | Train Loss: 1.736 Vali Loss: 0.990 Vali Acc: 0.647 Test Loss: 0.990 Test Acc: 0.647
Validation loss decreased (inf --> -0.647389).  Saving model ...
Epoch: 2 cost time: 3.015343189239502
Epoch: 2, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.894 Vali Acc: 0.717 Test Loss: 0.894 Test Acc: 0.717
Validation loss decreased (-0.647389 --> -0.716754).  Saving model ...
Epoch: 3 cost time: 2.9278717041015625
Epoch: 3, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.780 Test Loss: 0.699 Test Acc: 0.780
Validation loss decreased (-0.716754 --> -0.780340).  Saving model ...
Epoch: 4 cost time: 2.980733633041382
Epoch: 4, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.723 Test Loss: 0.738 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.932612180709839
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.746 Test Loss: 0.936 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7933545112609863
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.751 Test Loss: 0.782 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7595279216766357
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.740 Test Loss: 0.758 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9245481491088867
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.740 Test Loss: 0.760 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7414321899414062
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.751 Test Loss: 0.762 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8237345218658447
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.757 Test Loss: 0.765 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9303877353668213
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.746 Test Loss: 0.768 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6948819160461426
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.746 Test Loss: 0.771 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8129615783691406
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.746 Test Loss: 0.773 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1279881
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3736014366149902
Epoch: 1, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.139 Vali Acc: 0.584 Test Loss: 1.139 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 1.6960997581481934
Epoch: 2, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.754 Vali Acc: 0.717 Test Loss: 0.754 Test Acc: 0.717
Validation loss decreased (-0.583804 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 2.3768019676208496
Epoch: 3, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.737 Vali Acc: 0.728 Test Loss: 0.737 Test Acc: 0.728
Validation loss decreased (-0.716755 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.1881625652313232
Epoch: 4, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.740 Test Loss: 0.719 Test Acc: 0.740
Validation loss decreased (-0.728316 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 2.0649917125701904
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.740 Test Loss: 0.737 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.131533622741699
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 2.098421096801758
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 2.0402534008026123
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
Validation loss decreased (-0.745658 --> -0.757219).  Saving model ...
Epoch: 9 cost time: 1.703275203704834
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.751 Test Loss: 0.669 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8937458992004395
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.757 Test Loss: 0.665 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 11 cost time: 1.8388965129852295
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 12 cost time: 1.9734115600585938
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.751 Test Loss: 0.664 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.969801664352417
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.769 Test Loss: 0.661 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 14 cost time: 1.9692823886871338
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.242962598800659
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.769 Test Loss: 0.661 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 16 cost time: 2.049147844314575
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.769 Test Loss: 0.662 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0188636779785156
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 1.6870691776275635
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3097903728485107
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3313848972320557
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.769 Test Loss: 0.660 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.267334222793579
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.082561492919922
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.769 Test Loss: 0.663 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.23242449760437
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.769 Test Loss: 0.664 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9595627784729004
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.769 Test Loss: 0.663 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9908158779144287
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.769 Test Loss: 0.662 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.887488842010498
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.980701208114624
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.763 Test Loss: 0.665 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1276809
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.996176242828369
Epoch: 1, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.191 Vali Acc: 0.572 Test Loss: 1.191 Test Acc: 0.572
Validation loss decreased (inf --> -0.572242).  Saving model ...
Epoch: 2 cost time: 1.7658352851867676
Epoch: 2, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.814 Vali Acc: 0.711 Test Loss: 0.814 Test Acc: 0.711
Validation loss decreased (-0.572242 --> -0.710975).  Saving model ...
Epoch: 3 cost time: 1.7257416248321533
Epoch: 3, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.058 Vali Acc: 0.705 Test Loss: 1.058 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4825005531311035
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.933 Vali Acc: 0.734 Test Loss: 0.933 Test Acc: 0.734
Validation loss decreased (-0.710975 --> -0.734095).  Saving model ...
Epoch: 5 cost time: 1.6822938919067383
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.128 Vali Acc: 0.717 Test Loss: 1.128 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5206305980682373
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.769 Test Loss: 0.793 Test Acc: 0.769
Validation loss decreased (-0.734095 --> -0.768778).  Saving model ...
Epoch: 7 cost time: 1.7922637462615967
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.746 Test Loss: 0.744 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6789469718933105
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.751 Test Loss: 0.731 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.591146469116211
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.751 Test Loss: 0.728 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7246754169464111
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7586100101470947
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.757 Test Loss: 0.730 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5968830585479736
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.757 Test Loss: 0.731 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6587474346160889
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.757 Test Loss: 0.732 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3521206378936768
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.757 Test Loss: 0.734 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9460930824279785
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.769 Test Loss: 0.736 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768779).  Saving model ...
Epoch: 16 cost time: 1.6779849529266357
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.769 Test Loss: 0.737 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.867145299911499
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.769 Test Loss: 0.738 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.738276720046997
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774559).  Saving model ...
Epoch: 19 cost time: 1.6162641048431396
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774559).  Saving model ...
Epoch: 20 cost time: 1.5343379974365234
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.775 Test Loss: 0.742 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6164681911468506
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4407174587249756
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.775 Test Loss: 0.745 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6690599918365479
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7301971912384033
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.775 Test Loss: 0.747 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6991865634918213
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6289479732513428
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6593687534332275
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8019216060638428
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6832726001739502
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1274761
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8098700046539307
Epoch: 1, Steps: 17 | Train Loss: 1.597 Vali Loss: 0.991 Vali Acc: 0.630 Test Loss: 0.991 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 1.4590210914611816
Epoch: 2, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.731 Vali Acc: 0.734 Test Loss: 0.731 Test Acc: 0.734
Validation loss decreased (-0.630048 --> -0.734097).  Saving model ...
Epoch: 3 cost time: 1.201737642288208
Epoch: 3, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.618 Vali Acc: 0.792 Test Loss: 0.618 Test Acc: 0.792
Validation loss decreased (-0.734097 --> -0.791901).  Saving model ...
Epoch: 4 cost time: 1.458115816116333
Epoch: 4, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.780 Test Loss: 0.644 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.465735912322998
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809242).  Saving model ...
Epoch: 6 cost time: 1.4597795009613037
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.792 Test Loss: 0.632 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4915151596069336
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.792 Test Loss: 0.636 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4975013732910156
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.798 Test Loss: 0.641 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.408083438873291
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.798 Test Loss: 0.643 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2337701320648193
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.798 Test Loss: 0.645 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3964025974273682
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.798 Test Loss: 0.645 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3931949138641357
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.798 Test Loss: 0.648 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4911489486694336
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3818767070770264
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.798 Test Loss: 0.653 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4006671905517578
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.798 Test Loss: 0.654 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1273737
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3761444091796875
Epoch: 1, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.055 Vali Acc: 0.601 Test Loss: 1.055 Test Acc: 0.601
Validation loss decreased (inf --> -0.601146).  Saving model ...
Epoch: 2 cost time: 1.155085802078247
Epoch: 2, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.667 Vali Acc: 0.780 Test Loss: 0.667 Test Acc: 0.780
Validation loss decreased (-0.601146 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 1.2261364459991455
Epoch: 3, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.908 Vali Acc: 0.740 Test Loss: 0.908 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.160325288772583
Epoch: 4, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.699 Test Loss: 0.797 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3085870742797852
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.740 Test Loss: 0.733 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4218077659606934
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.763 Test Loss: 0.742 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0807867050170898
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.757 Test Loss: 0.727 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0671191215515137
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.751 Test Loss: 0.715 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.267608642578125
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.751 Test Loss: 0.710 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0977239608764648
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.751 Test Loss: 0.707 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.034123420715332
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.751 Test Loss: 0.704 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.004556655883789
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1272713
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.575971841812134
Epoch: 1, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.186 Vali Acc: 0.526 Test Loss: 1.186 Test Acc: 0.526
Validation loss decreased (inf --> -0.526000).  Saving model ...
Epoch: 2 cost time: 2.8243248462677
Epoch: 2, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.192 Vali Acc: 0.647 Test Loss: 1.192 Test Acc: 0.647
Validation loss decreased (-0.526000 --> -0.647387).  Saving model ...
Epoch: 3 cost time: 3.2035655975341797
Epoch: 3, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.902 Vali Acc: 0.757 Test Loss: 0.902 Test Acc: 0.757
Validation loss decreased (-0.647387 --> -0.757216).  Saving model ...
Epoch: 4 cost time: 3.3082942962646484
Epoch: 4, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.785 Vali Acc: 0.769 Test Loss: 0.785 Test Acc: 0.769
Validation loss decreased (-0.757216 --> -0.768778).  Saving model ...
Epoch: 5 cost time: 3.440850019454956
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.179 Vali Acc: 0.694 Test Loss: 1.179 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.875511407852173
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.711 Test Loss: 0.928 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.765334367752075
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.763 Test Loss: 0.990 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2315049171447754
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.763 Test Loss: 0.960 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.440873384475708
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.757 Test Loss: 0.923 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8588056564331055
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.757 Test Loss: 0.902 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0059547424316406
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.5501186847686768
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.757 Test Loss: 0.880 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.6381030082702637
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.757 Test Loss: 0.873 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.243929147720337
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.757 Test Loss: 0.868 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1628687
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.0331714153289795
Epoch: 1, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.077 Vali Acc: 0.601 Test Loss: 1.077 Test Acc: 0.601
Validation loss decreased (inf --> -0.601145).  Saving model ...
Epoch: 2 cost time: 2.746591567993164
Epoch: 2, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.033 Vali Acc: 0.688 Test Loss: 1.033 Test Acc: 0.688
Validation loss decreased (-0.601145 --> -0.687851).  Saving model ...
Epoch: 3 cost time: 2.7784440517425537
Epoch: 3, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.246 Vali Acc: 0.717 Test Loss: 1.246 Test Acc: 0.717
Validation loss decreased (-0.687851 --> -0.716751).  Saving model ...
Epoch: 4 cost time: 2.7374305725097656
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.898 Vali Acc: 0.780 Test Loss: 0.898 Test Acc: 0.780
Validation loss decreased (-0.716751 --> -0.780338).  Saving model ...
Epoch: 5 cost time: 3.1166911125183105
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.757 Test Loss: 0.774 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.021895170211792
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.694 Test Loss: 1.020 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.192159652709961
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.711 Test Loss: 0.913 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.127976894378662
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.694 Test Loss: 0.882 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.207947015762329
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.711 Test Loss: 0.873 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.309037685394287
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.711 Test Loss: 0.858 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2734534740448
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.723 Test Loss: 0.840 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9190051555633545
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.723 Test Loss: 0.829 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8759162425994873
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.723 Test Loss: 0.821 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0179848670959473
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.723 Test Loss: 0.812 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1627151
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.454258680343628
Epoch: 1, Steps: 17 | Train Loss: 1.675 Vali Loss: 1.044 Vali Acc: 0.566 Test Loss: 1.044 Test Acc: 0.566
Validation loss decreased (inf --> -0.566464).  Saving model ...
Epoch: 2 cost time: 2.3187167644500732
Epoch: 2, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
Validation loss decreased (-0.566464 --> -0.774559).  Saving model ...
Epoch: 3 cost time: 2.0678658485412598
Epoch: 3, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.925 Vali Acc: 0.728 Test Loss: 0.925 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4125630855560303
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.985 Vali Acc: 0.734 Test Loss: 0.985 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7472262382507324
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.872 Vali Acc: 0.728 Test Loss: 0.872 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2748425006866455
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2379517555236816
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.780 Test Loss: 0.762 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780339).  Saving model ...
Epoch: 8 cost time: 2.3444440364837646
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.786 Test Loss: 0.766 Test Acc: 0.786
Validation loss decreased (-0.780339 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 1.8897817134857178
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.786 Test Loss: 0.762 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 10 cost time: 1.7933719158172607
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9222075939178467
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8861446380615234
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.245086669921875
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.200305223464966
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.212703227996826
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.746884346008301
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.75811505317688
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7712152004241943
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.780 Test Loss: 0.743 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8580613136291504
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.780 Test Loss: 0.746 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1625103
model size : 6.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9248433113098145
Epoch: 1, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.057 Vali Acc: 0.624 Test Loss: 1.057 Test Acc: 0.624
Validation loss decreased (inf --> -0.624267).  Saving model ...
Epoch: 2 cost time: 2.659254789352417
Epoch: 2, Steps: 17 | Train Loss: 0.293 Vali Loss: 1.178 Vali Acc: 0.688 Test Loss: 1.178 Test Acc: 0.688
Validation loss decreased (-0.624267 --> -0.687849).  Saving model ...
Epoch: 3 cost time: 2.514829397201538
Epoch: 3, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.673 Vali Acc: 0.769 Test Loss: 0.673 Test Acc: 0.769
Validation loss decreased (-0.687849 --> -0.768779).  Saving model ...
Epoch: 4 cost time: 2.783001184463501
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.773500919342041
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.920 Vali Acc: 0.746 Test Loss: 0.920 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4854743480682373
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5664594173431396
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.734 Test Loss: 0.740 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.573604106903076
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.734 Test Loss: 0.704 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.627814292907715
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.763 Test Loss: 0.689 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3211922645568848
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.763 Test Loss: 0.676 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1101009845733643
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.769 Test Loss: 0.664 Test Acc: 0.769
Validation loss decreased (-0.768779 --> -0.768779).  Saving model ...
Epoch: 12 cost time: 2.726738929748535
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.769 Test Loss: 0.657 Test Acc: 0.769
Validation loss decreased (-0.768779 --> -0.768780).  Saving model ...
Epoch: 13 cost time: 2.7104687690734863
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.769 Test Loss: 0.651 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 14 cost time: 2.447655439376831
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.769 Test Loss: 0.643 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 15 cost time: 2.4401869773864746
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.769 Test Loss: 0.638 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 16 cost time: 3.053791046142578
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774560).  Saving model ...
Epoch: 17 cost time: 2.999126672744751
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.775 Test Loss: 0.632 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774560).  Saving model ...
Epoch: 18 cost time: 2.719568967819214
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.780 Test Loss: 0.629 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 19 cost time: 2.575193166732788
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8347790241241455
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.780 Test Loss: 0.623 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 21 cost time: 2.9719512462615967
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.792 Test Loss: 0.621 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791901).  Saving model ...
Epoch: 22 cost time: 2.744394063949585
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.792 Test Loss: 0.621 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791901).  Saving model ...
Epoch: 23 cost time: 3.0177972316741943
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803462).  Saving model ...
Epoch: 24 cost time: 2.7659401893615723
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 25 cost time: 2.8404111862182617
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 26 cost time: 2.791349411010742
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 27 cost time: 2.7682907581329346
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 28 cost time: 2.944437026977539
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7229013442993164
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 30 cost time: 2.6053900718688965
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 31 cost time: 2.7006890773773193
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 32 cost time: 2.6803386211395264
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 33 cost time: 2.8010215759277344
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 34 cost time: 2.281933307647705
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.809 Test Loss: 0.607 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809242).  Saving model ...
Epoch: 35 cost time: 2.4494810104370117
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 36 cost time: 2.484748125076294
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 37 cost time: 2.065481424331665
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 38 cost time: 2.250732183456421
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3960208892822266
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 40 cost time: 1.8869538307189941
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 41 cost time: 2.0312342643737793
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 42 cost time: 2.1232686042785645
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9902369976043701
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.9776890277862549
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 45 cost time: 2.300579786300659
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 46 cost time: 2.5825867652893066
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 47 cost time: 2.059692621231079
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 48 cost time: 2.297456741333008
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.596658229827881
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.2510836124420166
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 51 cost time: 2.630031108856201
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.4844906330108643
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.239718437194824
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.891634941101074
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.40482234954834
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.881162405014038
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.635930061340332
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 58 cost time: 2.5870919227600098
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 59 cost time: 1.9437634944915771
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.914017915725708
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.412005662918091
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.3148226737976074
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 63 cost time: 3.208177328109741
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 64 cost time: 2.5024139881134033
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.899723768234253
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.024996042251587
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.393526554107666
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.356339454650879
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.798 Test Loss: 0.601 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 2.523885488510132
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.798 Test Loss: 0.601 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 2.5409421920776367
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.798 Test Loss: 0.601 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 3.077091932296753
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.798 Test Loss: 0.601 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.920504093170166
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.792 Test Loss: 0.601 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 2.1780426502227783
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.798 Test Loss: 0.602 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1623567
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4712061882019043
Epoch: 1, Steps: 17 | Train Loss: 1.611 Vali Loss: 0.925 Vali Acc: 0.676 Test Loss: 0.925 Test Acc: 0.676
Validation loss decreased (inf --> -0.676291).  Saving model ...
Epoch: 2 cost time: 1.7659685611724854
Epoch: 2, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.755 Vali Acc: 0.694 Test Loss: 0.755 Test Acc: 0.694
Validation loss decreased (-0.676291 --> -0.693634).  Saving model ...
Epoch: 3 cost time: 1.8855149745941162
Epoch: 3, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.101 Vali Acc: 0.671 Test Loss: 1.101 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0635616779327393
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.229 Vali Acc: 0.647 Test Loss: 1.229 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.619112253189087
Epoch: 5, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.886 Vali Acc: 0.723 Test Loss: 0.886 Test Acc: 0.723
Validation loss decreased (-0.693634 --> -0.722534).  Saving model ...
Epoch: 6 cost time: 1.8308186531066895
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.765 Vali Acc: 0.786 Test Loss: 0.765 Test Acc: 0.786
Validation loss decreased (-0.722534 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 2.020291805267334
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8142030239105225
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.094 Vali Acc: 0.763 Test Loss: 1.094 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6945092678070068
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9511289596557617
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7676644325256348
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.786 Test Loss: 0.710 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 12 cost time: 1.783637285232544
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.798 Test Loss: 0.711 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797681).  Saving model ...
Epoch: 13 cost time: 1.9127483367919922
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.798 Test Loss: 0.712 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9576852321624756
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.792 Test Loss: 0.713 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.579824686050415
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.792 Test Loss: 0.715 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0659303665161133
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.798 Test Loss: 0.716 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.11179518699646
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.798 Test Loss: 0.717 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8441550731658936
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.798 Test Loss: 0.718 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6524035930633545
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.798 Test Loss: 0.720 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6672379970550537
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.798 Test Loss: 0.720 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5096886157989502
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.798 Test Loss: 0.720 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6366674900054932
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.798 Test Loss: 0.721 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1622031
model size : 6.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2021355628967285
Epoch: 1, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
Validation loss decreased (inf --> -0.520220).  Saving model ...
Epoch: 2 cost time: 1.7276465892791748
Epoch: 2, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.967 Vali Acc: 0.705 Test Loss: 0.967 Test Acc: 0.705
Validation loss decreased (-0.520220 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 1.865046501159668
Epoch: 3, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.763 Vali Acc: 0.717 Test Loss: 0.763 Test Acc: 0.717
Validation loss decreased (-0.705193 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 1.924752950668335
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.111 Vali Acc: 0.757 Test Loss: 1.111 Test Acc: 0.757
Validation loss decreased (-0.716755 --> -0.757214).  Saving model ...
Epoch: 5 cost time: 1.6332921981811523
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.168 Vali Acc: 0.728 Test Loss: 1.168 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.879878044128418
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.874 Vali Acc: 0.728 Test Loss: 0.874 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5032527446746826
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.700 Vali Acc: 0.780 Test Loss: 0.700 Test Acc: 0.780
Validation loss decreased (-0.757214 --> -0.780340).  Saving model ...
Epoch: 8 cost time: 1.6514694690704346
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.066 Vali Acc: 0.728 Test Loss: 1.066 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8139946460723877
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.717 Test Loss: 0.938 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5568938255310059
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.717 Test Loss: 0.866 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.821380376815796
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.728 Test Loss: 0.859 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7834796905517578
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.728 Test Loss: 0.860 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6071138381958008
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.728 Test Loss: 0.862 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8271894454956055
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.728 Test Loss: 0.862 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7963759899139404
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.757763147354126
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.699265956878662
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.728 Test Loss: 0.862 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1621007
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.684194803237915
Epoch: 1, Steps: 17 | Train Loss: 1.763 Vali Loss: 0.935 Vali Acc: 0.618 Test Loss: 0.935 Test Acc: 0.618
Validation loss decreased (inf --> -0.618488).  Saving model ...
Epoch: 2 cost time: 1.3816959857940674
Epoch: 2, Steps: 17 | Train Loss: 0.293 Vali Loss: 1.208 Vali Acc: 0.607 Test Loss: 1.208 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1554126739501953
Epoch: 3, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.039 Vali Acc: 0.763 Test Loss: 1.039 Test Acc: 0.763
Validation loss decreased (-0.618488 --> -0.762995).  Saving model ...
Epoch: 4 cost time: 1.4309403896331787
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.404 Vali Acc: 0.734 Test Loss: 1.404 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2312498092651367
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.872 Vali Acc: 0.769 Test Loss: 0.872 Test Acc: 0.769
Validation loss decreased (-0.762995 --> -0.768777).  Saving model ...
Epoch: 6 cost time: 1.2089338302612305
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.734 Test Loss: 0.931 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1891074180603027
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.751 Test Loss: 0.811 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.211836814880371
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.763 Test Loss: 0.797 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.326474905014038
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.780 Test Loss: 0.760 Test Acc: 0.780
Validation loss decreased (-0.768777 --> -0.780339).  Saving model ...
Epoch: 10 cost time: 1.1635797023773193
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.780 Test Loss: 0.755 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 11 cost time: 1.3028593063354492
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.780 Test Loss: 0.753 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 12 cost time: 1.5522782802581787
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.769 Test Loss: 0.750 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2162823677062988
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.769 Test Loss: 0.746 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.576047420501709
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.769 Test Loss: 0.745 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3485734462738037
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.769 Test Loss: 0.744 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7745003700256348
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.769 Test Loss: 0.744 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4100532531738281
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.769 Test Loss: 0.742 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6224212646484375
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.769 Test Loss: 0.743 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3794777393341064
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.769 Test Loss: 0.742 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.397491216659546
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.769 Test Loss: 0.741 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6106414794921875
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.769 Test Loss: 0.741 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1620495
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4873461723327637
Epoch: 1, Steps: 17 | Train Loss: 1.736 Vali Loss: 0.991 Vali Acc: 0.613 Test Loss: 0.991 Test Acc: 0.613
Validation loss decreased (inf --> -0.612707).  Saving model ...
Epoch: 2 cost time: 1.220522165298462
Epoch: 2, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.783 Vali Acc: 0.734 Test Loss: 0.783 Test Acc: 0.734
Validation loss decreased (-0.612707 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 1.194852590560913
Epoch: 3, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.710 Vali Acc: 0.653 Test Loss: 1.710 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4535784721374512
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.087 Vali Acc: 0.751 Test Loss: 1.087 Test Acc: 0.751
Validation loss decreased (-0.734096 --> -0.751434).  Saving model ...
Epoch: 5 cost time: 1.2418906688690186
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.740 Test Loss: 1.056 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1816082000732422
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.723 Test Loss: 1.239 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2388298511505127
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.728 Test Loss: 1.044 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1541557312011719
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.751 Test Loss: 0.972 Test Acc: 0.751
Validation loss decreased (-0.751434 --> -0.751435).  Saving model ...
Epoch: 9 cost time: 1.208827018737793
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.751 Test Loss: 0.951 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751436).  Saving model ...
Epoch: 10 cost time: 1.1966259479522705
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.751 Test Loss: 0.939 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 11 cost time: 1.1286094188690186
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.751 Test Loss: 0.932 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 12 cost time: 1.1462652683258057
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.751 Test Loss: 0.925 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 13 cost time: 1.2340242862701416
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.751 Test Loss: 0.918 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 14 cost time: 1.1132299900054932
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.751 Test Loss: 0.913 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 15 cost time: 1.1824960708618164
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.751 Test Loss: 0.908 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 16 cost time: 1.1931989192962646
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.751 Test Loss: 0.904 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 17 cost time: 1.3915596008300781
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.751 Test Loss: 0.901 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 18 cost time: 1.2853617668151855
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.751 Test Loss: 0.897 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 19 cost time: 1.400526762008667
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.751 Test Loss: 0.895 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 20 cost time: 1.497588872909546
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.751 Test Loss: 0.891 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 21 cost time: 1.394261360168457
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.751 Test Loss: 0.887 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 22 cost time: 1.3131868839263916
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.751 Test Loss: 0.885 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 23 cost time: 1.2735817432403564
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.751 Test Loss: 0.883 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 24 cost time: 1.5162501335144043
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.751 Test Loss: 0.881 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 25 cost time: 1.4129364490509033
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.751 Test Loss: 0.879 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 26 cost time: 1.1580908298492432
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.751 Test Loss: 0.876 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 27 cost time: 1.3034632205963135
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.751 Test Loss: 0.875 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 28 cost time: 1.1480169296264648
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.751 Test Loss: 0.874 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 29 cost time: 1.183833122253418
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.751 Test Loss: 0.871 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 30 cost time: 1.2655575275421143
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.751 Test Loss: 0.869 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 31 cost time: 1.0086572170257568
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.751 Test Loss: 0.867 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 32 cost time: 1.123142957687378
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.751 Test Loss: 0.865 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 33 cost time: 1.116706371307373
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.751 Test Loss: 0.864 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 34 cost time: 1.0444772243499756
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.751 Test Loss: 0.861 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 35 cost time: 1.009631872177124
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.751 Test Loss: 0.860 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 36 cost time: 1.0870916843414307
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.751 Test Loss: 0.859 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751437).  Saving model ...
Epoch: 37 cost time: 1.0928449630737305
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.751 Test Loss: 0.857 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 38 cost time: 1.2322180271148682
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.751 Test Loss: 0.856 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 39 cost time: 1.2105050086975098
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.751 Test Loss: 0.855 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 40 cost time: 1.0951104164123535
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.751 Test Loss: 0.853 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 41 cost time: 1.1885929107666016
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.751 Test Loss: 0.852 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 42 cost time: 1.0677244663238525
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.751 Test Loss: 0.852 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1539793014526367
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.751 Test Loss: 0.851 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 44 cost time: 1.2230620384216309
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.751 Test Loss: 0.851 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 45 cost time: 1.1136579513549805
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.751 Test Loss: 0.850 Test Acc: 0.751
Validation loss decreased (-0.751437 --> -0.751437).  Saving model ...
Epoch: 46 cost time: 1.1236686706542969
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.757 Test Loss: 0.849 Test Acc: 0.757
Validation loss decreased (-0.751437 --> -0.757217).  Saving model ...
Epoch: 47 cost time: 1.2681000232696533
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.757 Test Loss: 0.848 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 48 cost time: 1.2740898132324219
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.757 Test Loss: 0.848 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 49 cost time: 1.1380853652954102
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.757 Test Loss: 0.846 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 50 cost time: 1.203134298324585
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.757 Test Loss: 0.846 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 51 cost time: 1.264294147491455
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.757 Test Loss: 0.845 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 52 cost time: 1.3337256908416748
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.757 Test Loss: 0.843 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 53 cost time: 1.2394442558288574
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.307823657989502
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3751444816589355
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.333193063735962
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.757 Test Loss: 0.843 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 57 cost time: 1.4250450134277344
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.757 Test Loss: 0.842 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 58 cost time: 1.4075374603271484
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.757 Test Loss: 0.842 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 59 cost time: 1.4695725440979004
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.757 Test Loss: 0.841 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 60 cost time: 1.296919822692871
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.757 Test Loss: 0.840 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 61 cost time: 1.3776025772094727
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.757 Test Loss: 0.840 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3110291957855225
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.757 Test Loss: 0.840 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.2484047412872314
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.757 Test Loss: 0.840 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.346147060394287
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.757 Test Loss: 0.839 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 65 cost time: 1.3030712604522705
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.763 Test Loss: 0.838 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762997).  Saving model ...
Epoch: 66 cost time: 1.2769489288330078
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.4451606273651123
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.5080235004425049
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.2936217784881592
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.290360689163208
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.3810601234436035
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.2979021072387695
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.763 Test Loss: 0.838 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 73 cost time: 1.3542654514312744
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.769 Test Loss: 0.838 Test Acc: 0.769
Validation loss decreased (-0.762997 --> -0.768778).  Saving model ...
Epoch: 74 cost time: 1.2701725959777832
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.769 Test Loss: 0.837 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768778).  Saving model ...
Epoch: 75 cost time: 1.1937875747680664
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.769 Test Loss: 0.837 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768778).  Saving model ...
Epoch: 76 cost time: 1.1590194702148438
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.769 Test Loss: 0.837 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.2037627696990967
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.769 Test Loss: 0.837 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768778).  Saving model ...
Epoch: 78 cost time: 1.2063419818878174
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.768778 --> -0.774558).  Saving model ...
Epoch: 79 cost time: 1.2728211879730225
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 80 cost time: 1.07600998878479
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.769 Test Loss: 0.836 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.1421663761138916
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.769 Test Loss: 0.837 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.407926082611084
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.2814691066741943
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 84 cost time: 1.1388702392578125
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 85 cost time: 1.2629384994506836
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 86 cost time: 1.2913260459899902
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 87 cost time: 1.2715394496917725
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.2786288261413574
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 89 cost time: 1.25535249710083
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 90 cost time: 1.0801167488098145
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 91 cost time: 1.1529467105865479
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.1849651336669922
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 93 cost time: 1.250262975692749
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1715335845947266
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.763 Test Loss: 0.834 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.2372100353240967
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.775 Test Loss: 0.833 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 96 cost time: 1.1049580574035645
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.763 Test Loss: 0.834 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.2832584381103516
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.763 Test Loss: 0.833 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.3237802982330322
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.763 Test Loss: 0.833 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.3048524856567383
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.763 Test Loss: 0.832 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.3594963550567627
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.763 Test Loss: 0.832 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1619983
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.233304738998413
Epoch: 1, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.005 Vali Acc: 0.642 Test Loss: 1.005 Test Acc: 0.642
Validation loss decreased (inf --> -0.641608).  Saving model ...
Epoch: 2 cost time: 3.760632276535034
Epoch: 2, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.742 Vali Acc: 0.728 Test Loss: 0.742 Test Acc: 0.728
Validation loss decreased (-0.641608 --> -0.728316).  Saving model ...
Epoch: 3 cost time: 4.348676681518555
Epoch: 3, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.891 Vali Acc: 0.746 Test Loss: 0.891 Test Acc: 0.746
Validation loss decreased (-0.728316 --> -0.745656).  Saving model ...
Epoch: 4 cost time: 3.73465895652771
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.163 Vali Acc: 0.723 Test Loss: 1.163 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9790282249450684
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.238 Vali Acc: 0.705 Test Loss: 1.238 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.616950511932373
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.728 Test Loss: 1.164 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5012192726135254
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.711 Test Loss: 1.218 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7395286560058594
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.159 Vali Acc: 0.711 Test Loss: 1.159 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.936769962310791
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.723 Test Loss: 1.101 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.235246896743774
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.723 Test Loss: 1.064 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.102829456329346
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.723 Test Loss: 1.042 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.993541955947876
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.734 Test Loss: 1.022 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8883447647094727
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.740 Test Loss: 1.008 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 1382031
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.360318183898926
Epoch: 1, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.363 Vali Acc: 0.509 Test Loss: 1.363 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 3.017273187637329
Epoch: 2, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.733 Vali Acc: 0.763 Test Loss: 0.733 Test Acc: 0.763
Validation loss decreased (-0.508657 --> -0.762998).  Saving model ...
Epoch: 3 cost time: 3.1997010707855225
Epoch: 3, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.882 Vali Acc: 0.688 Test Loss: 0.882 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.139711380004883
Epoch: 4, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.027 Vali Acc: 0.723 Test Loss: 1.027 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.371133327484131
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.977 Vali Acc: 0.734 Test Loss: 0.977 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0417768955230713
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.740 Test Loss: 0.896 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.354635238647461
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.734 Test Loss: 0.881 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.433162212371826
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.734 Test Loss: 0.868 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.16847562789917
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.728 Test Loss: 0.858 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0949342250823975
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.740 Test Loss: 0.850 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8551547527313232
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.751 Test Loss: 0.841 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9148621559143066
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.751 Test Loss: 0.837 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1380495
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.056412696838379
Epoch: 1, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.275 Vali Acc: 0.509 Test Loss: 1.275 Test Acc: 0.509
Validation loss decreased (inf --> -0.508658).  Saving model ...
Epoch: 2 cost time: 2.7605888843536377
Epoch: 2, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.783 Vali Acc: 0.740 Test Loss: 0.783 Test Acc: 0.740
Validation loss decreased (-0.508658 --> -0.739877).  Saving model ...
Epoch: 3 cost time: 3.139791488647461
Epoch: 3, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.337 Vali Acc: 0.717 Test Loss: 1.337 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.020023822784424
Epoch: 4, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.823 Vali Acc: 0.757 Test Loss: 0.823 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 2.9706339836120605
Epoch: 5, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.776 Vali Acc: 0.751 Test Loss: 0.776 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.013390064239502
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.163 Vali Acc: 0.717 Test Loss: 1.163 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.960099935531616
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.757 Test Loss: 0.814 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 8 cost time: 3.0722203254699707
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
Validation loss decreased (-0.757217 --> -0.774559).  Saving model ...
Epoch: 9 cost time: 3.216679096221924
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.763 Test Loss: 0.699 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9758107662200928
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.769 Test Loss: 0.695 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4396848678588867
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.88370680809021
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9597008228302
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.757 Test Loss: 0.695 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.099355936050415
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.757 Test Loss: 0.695 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.9442214965820312
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.818908929824829
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.757 Test Loss: 0.697 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1166672706604004
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8562283515930176
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.757 Test Loss: 0.697 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1378447
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9699058532714844
Epoch: 1, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.119 Vali Acc: 0.543 Test Loss: 1.119 Test Acc: 0.543
Validation loss decreased (inf --> -0.543341).  Saving model ...
Epoch: 2 cost time: 2.418553113937378
Epoch: 2, Steps: 17 | Train Loss: 0.313 Vali Loss: 1.020 Vali Acc: 0.711 Test Loss: 1.020 Test Acc: 0.711
Validation loss decreased (-0.543341 --> -0.710972).  Saving model ...
Epoch: 3 cost time: 2.8050310611724854
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.210 Vali Acc: 0.717 Test Loss: 1.210 Test Acc: 0.717
Validation loss decreased (-0.710972 --> -0.716751).  Saving model ...
Epoch: 4 cost time: 2.6714701652526855
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.699 Vali Acc: 0.815 Test Loss: 0.699 Test Acc: 0.815
Validation loss decreased (-0.716751 --> -0.815022).  Saving model ...
Epoch: 5 cost time: 2.6086041927337646
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.780 Test Loss: 0.959 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.780203104019165
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.786 Test Loss: 0.749 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.346804141998291
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.780 Test Loss: 0.693 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.455148458480835
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.775 Test Loss: 0.677 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.482478618621826
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.775 Test Loss: 0.670 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.387181282043457
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.775 Test Loss: 0.668 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.622314691543579
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.775 Test Loss: 0.667 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4464640617370605
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.697404384613037
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.786 Test Loss: 0.665 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.649980068206787
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.786 Test Loss: 0.663 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1376911
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0776684284210205
Epoch: 1, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.406 Vali Acc: 0.503 Test Loss: 1.406 Test Acc: 0.503
Validation loss decreased (inf --> -0.502876).  Saving model ...
Epoch: 2 cost time: 1.7862319946289062
Epoch: 2, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.223 Vali Acc: 0.659 Test Loss: 1.223 Test Acc: 0.659
Validation loss decreased (-0.502876 --> -0.658947).  Saving model ...
Epoch: 3 cost time: 1.8586235046386719
Epoch: 3, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.246 Vali Acc: 0.665 Test Loss: 1.246 Test Acc: 0.665
Validation loss decreased (-0.658947 --> -0.664727).  Saving model ...
Epoch: 4 cost time: 2.0021162033081055
Epoch: 4, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.869 Vali Acc: 0.763 Test Loss: 0.869 Test Acc: 0.763
Validation loss decreased (-0.664727 --> -0.762997).  Saving model ...
Epoch: 5 cost time: 1.8429524898529053
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.658 Vali Acc: 0.775 Test Loss: 0.658 Test Acc: 0.775
Validation loss decreased (-0.762997 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 1.8188350200653076
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.671 Test Loss: 1.433 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1964797973632812
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.898 Vali Acc: 0.699 Test Loss: 0.898 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9847016334533691
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.009 Vali Acc: 0.717 Test Loss: 1.009 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6955335140228271
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.751 Test Loss: 0.908 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.147960901260376
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0196080207824707
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.775 Test Loss: 0.784 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9779436588287354
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.763 Test Loss: 0.761 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8997981548309326
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.763 Test Loss: 0.747 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8877663612365723
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.763 Test Loss: 0.739 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.182161331176758
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.769 Test Loss: 0.729 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1375375
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.451789617538452
Epoch: 1, Steps: 17 | Train Loss: 1.709 Vali Loss: 1.009 Vali Acc: 0.607 Test Loss: 1.009 Test Acc: 0.607
Validation loss decreased (inf --> -0.606926).  Saving model ...
Epoch: 2 cost time: 1.5159616470336914
Epoch: 2, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.971 Vali Acc: 0.728 Test Loss: 0.971 Test Acc: 0.728
Validation loss decreased (-0.606926 --> -0.728314).  Saving model ...
Epoch: 3 cost time: 1.5936336517333984
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.831 Vali Acc: 0.734 Test Loss: 0.831 Test Acc: 0.734
Validation loss decreased (-0.728314 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 1.5735094547271729
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.257 Vali Acc: 0.717 Test Loss: 1.257 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5105431079864502
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.928 Vali Acc: 0.763 Test Loss: 0.928 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.762997).  Saving model ...
Epoch: 6 cost time: 1.566481113433838
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.964 Vali Acc: 0.740 Test Loss: 0.964 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5518455505371094
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.763 Test Loss: 0.896 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 8 cost time: 1.608459234237671
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.769 Test Loss: 0.865 Test Acc: 0.769
Validation loss decreased (-0.762997 --> -0.768777).  Saving model ...
Epoch: 9 cost time: 1.640455722808838
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.769 Test Loss: 0.841 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768778).  Saving model ...
Epoch: 10 cost time: 1.629636287689209
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.757 Test Loss: 0.827 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.774702548980713
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.757 Test Loss: 0.818 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7361540794372559
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.763 Test Loss: 0.815 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8197882175445557
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.763 Test Loss: 0.811 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.10563325881958
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.763 Test Loss: 0.811 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1553537845611572
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.763 Test Loss: 0.808 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2155110836029053
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.763 Test Loss: 0.806 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.196974992752075
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.763 Test Loss: 0.804 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9934751987457275
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.763 Test Loss: 0.805 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7704505920410156
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.769 Test Loss: 0.808 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768778).  Saving model ...
Epoch: 20 cost time: 1.926818609237671
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.757 Test Loss: 0.805 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9433627128601074
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.757 Test Loss: 0.805 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.164196491241455
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.740 Test Loss: 0.806 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.037506103515625
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.751 Test Loss: 0.805 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2118418216705322
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.146599054336548
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.746 Test Loss: 0.809 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.024182081222534
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.746 Test Loss: 0.808 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2016549110412598
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.740 Test Loss: 0.808 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9472146034240723
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.746 Test Loss: 0.809 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0204663276672363
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.746 Test Loss: 0.809 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1374351
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4331932067871094
Epoch: 1, Steps: 17 | Train Loss: 1.754 Vali Loss: 1.128 Vali Acc: 0.624 Test Loss: 1.128 Test Acc: 0.624
Validation loss decreased (inf --> -0.624266).  Saving model ...
Epoch: 2 cost time: 1.366931438446045
Epoch: 2, Steps: 17 | Train Loss: 0.267 Vali Loss: 1.255 Vali Acc: 0.642 Test Loss: 1.255 Test Acc: 0.642
Validation loss decreased (-0.624266 --> -0.641606).  Saving model ...
Epoch: 3 cost time: 1.8358948230743408
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.993 Vali Acc: 0.757 Test Loss: 0.993 Test Acc: 0.757
Validation loss decreased (-0.641606 --> -0.757216).  Saving model ...
Epoch: 4 cost time: 1.822392463684082
Epoch: 4, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.063 Vali Acc: 0.740 Test Loss: 1.063 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8216874599456787
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.102 Vali Acc: 0.775 Test Loss: 1.102 Test Acc: 0.775
Validation loss decreased (-0.757216 --> -0.774555).  Saving model ...
Epoch: 6 cost time: 1.721376895904541
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.149 Vali Acc: 0.763 Test Loss: 1.149 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6467280387878418
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.769 Test Loss: 1.267 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7376785278320312
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.792 Test Loss: 1.066 Test Acc: 0.792
Validation loss decreased (-0.774555 --> -0.791897).  Saving model ...
Epoch: 9 cost time: 1.7167580127716064
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.798 Test Loss: 1.033 Test Acc: 0.798
Validation loss decreased (-0.791897 --> -0.797678).  Saving model ...
Epoch: 10 cost time: 1.635993480682373
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.798 Test Loss: 1.026 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 11 cost time: 1.6865696907043457
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.798 Test Loss: 1.023 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 12 cost time: 1.7393436431884766
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.798 Test Loss: 1.016 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 13 cost time: 1.6269848346710205
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.798 Test Loss: 1.017 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5303359031677246
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.798 Test Loss: 1.014 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 15 cost time: 1.6677143573760986
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.798 Test Loss: 1.009 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 16 cost time: 1.66888427734375
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.798 Test Loss: 1.008 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 17 cost time: 2.0098071098327637
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.798 Test Loss: 1.006 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 18 cost time: 1.6487536430358887
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.798 Test Loss: 1.004 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 19 cost time: 1.8931033611297607
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.798 Test Loss: 1.000 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 20 cost time: 1.6892175674438477
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.798 Test Loss: 0.998 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 21 cost time: 1.7096080780029297
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.798 Test Loss: 0.996 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 22 cost time: 1.6567931175231934
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.798 Test Loss: 0.993 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 23 cost time: 1.622117519378662
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.798 Test Loss: 0.992 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 24 cost time: 1.603771448135376
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.798 Test Loss: 0.990 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 25 cost time: 1.4881112575531006
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.798 Test Loss: 0.988 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 26 cost time: 1.7475476264953613
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.798 Test Loss: 0.985 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 27 cost time: 1.752366542816162
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.798 Test Loss: 0.985 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 28 cost time: 1.684072732925415
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.798 Test Loss: 0.984 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 29 cost time: 1.6613588333129883
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.798 Test Loss: 0.981 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 30 cost time: 1.5922985076904297
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.798 Test Loss: 0.980 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 31 cost time: 1.581848382949829
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.798 Test Loss: 0.978 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 32 cost time: 1.5195667743682861
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.798 Test Loss: 0.978 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 33 cost time: 1.431668758392334
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.798 Test Loss: 0.976 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 34 cost time: 1.507364273071289
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.798 Test Loss: 0.976 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 35 cost time: 1.8062007427215576
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.798 Test Loss: 0.974 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 36 cost time: 1.718482494354248
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.798 Test Loss: 0.972 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 37 cost time: 1.646411657333374
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.798 Test Loss: 0.972 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8799645900726318
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.798 Test Loss: 0.972 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 39 cost time: 1.8235230445861816
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.798 Test Loss: 0.971 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 40 cost time: 1.6627795696258545
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.798 Test Loss: 0.970 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 41 cost time: 1.4038047790527344
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.798 Test Loss: 0.969 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 42 cost time: 2.0065953731536865
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.798 Test Loss: 0.969 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 43 cost time: 1.3636229038238525
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.798 Test Loss: 0.969 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6135423183441162
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.798 Test Loss: 0.969 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.6528258323669434
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.798 Test Loss: 0.967 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 46 cost time: 1.7416985034942627
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.798 Test Loss: 0.966 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 47 cost time: 1.7101736068725586
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.798 Test Loss: 0.966 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 48 cost time: 1.7169761657714844
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.798 Test Loss: 0.965 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 49 cost time: 1.6240572929382324
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.798 Test Loss: 0.966 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.822767972946167
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.798 Test Loss: 0.966 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.432131052017212
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.798 Test Loss: 0.967 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.759272575378418
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.798 Test Loss: 0.965 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.6536352634429932
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.798 Test Loss: 0.965 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 54 cost time: 1.6495022773742676
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.798 Test Loss: 0.963 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 55 cost time: 1.6920521259307861
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.798 Test Loss: 0.963 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 56 cost time: 1.6607520580291748
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.798 Test Loss: 0.963 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.6238946914672852
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.798 Test Loss: 0.964 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.7928168773651123
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.798 Test Loss: 0.964 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.3982176780700684
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.798 Test Loss: 0.963 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 60 cost time: 1.3490869998931885
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.798 Test Loss: 0.963 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 61 cost time: 1.3424012660980225
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.798 Test Loss: 0.962 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 62 cost time: 1.4650745391845703
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.798 Test Loss: 0.962 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 63 cost time: 1.409489631652832
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.798 Test Loss: 0.961 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 64 cost time: 1.4861736297607422
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.798 Test Loss: 0.961 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.4748587608337402
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.798 Test Loss: 0.960 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 66 cost time: 1.4744422435760498
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.798 Test Loss: 0.960 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 67 cost time: 1.349242925643921
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.798 Test Loss: 0.960 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.3029100894927979
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.798 Test Loss: 0.959 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 69 cost time: 1.4177637100219727
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 70 cost time: 1.4049971103668213
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 71 cost time: 1.4980554580688477
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.5326998233795166
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 73 cost time: 1.5736207962036133
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.798 Test Loss: 0.957 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 74 cost time: 1.5237276554107666
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.5859315395355225
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.798 Test Loss: 0.957 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 76 cost time: 1.7705376148223877
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.90443754196167
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.7156927585601807
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.798 Test Loss: 0.958 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.8059003353118896
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.798 Test Loss: 0.957 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.7962713241577148
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.798 Test Loss: 0.957 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.73714017868042
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 82 cost time: 1.7353510856628418
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 83 cost time: 1.828129768371582
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.807262897491455
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.8129160404205322
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.7634086608886719
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.6867165565490723
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 1.4982380867004395
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 1.7885897159576416
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 1.7474546432495117
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 1.7159028053283691
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 1.8089971542358398
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 93 cost time: 1.8349719047546387
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 94 cost time: 1.4219462871551514
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 95 cost time: 1.6087985038757324
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.798 Test Loss: 0.954 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 96 cost time: 1.6178359985351562
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.798 Test Loss: 0.954 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 97 cost time: 1.5823261737823486
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.798 Test Loss: 0.954 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.6638309955596924
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.5454859733581543
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.798 Test Loss: 0.954 Test Acc: 0.798
Validation loss decreased (-0.797678 --> -0.797678).  Saving model ...
Epoch: 100 cost time: 1.4105052947998047
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.798 Test Loss: 0.955 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1373839
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5787978172302246
Epoch: 1, Steps: 17 | Train Loss: 1.719 Vali Loss: 0.995 Vali Acc: 0.618 Test Loss: 0.995 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 1.1282954216003418
Epoch: 2, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.909 Vali Acc: 0.728 Test Loss: 0.909 Test Acc: 0.728
Validation loss decreased (-0.618487 --> -0.728315).  Saving model ...
Epoch: 3 cost time: 1.1868705749511719
Epoch: 3, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.025 Vali Acc: 0.682 Test Loss: 1.025 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2158665657043457
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.869 Vali Acc: 0.751 Test Loss: 0.869 Test Acc: 0.751
Validation loss decreased (-0.728315 --> -0.751436).  Saving model ...
Epoch: 5 cost time: 1.2972502708435059
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.906 Vali Acc: 0.763 Test Loss: 0.906 Test Acc: 0.763
Validation loss decreased (-0.751436 --> -0.762997).  Saving model ...
Epoch: 6 cost time: 1.290916919708252
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.877 Vali Acc: 0.728 Test Loss: 0.877 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.256988286972046
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.734 Test Loss: 0.951 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.433976173400879
Epoch: 8, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.298 Vali Acc: 0.728 Test Loss: 1.298 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1296427249908447
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.345 Vali Acc: 0.734 Test Loss: 1.345 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.450965166091919
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.368 Vali Acc: 0.705 Test Loss: 1.368 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.33491849899292
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.591 Vali Acc: 0.711 Test Loss: 1.591 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2209608554840088
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.837 Vali Acc: 0.705 Test Loss: 1.837 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4651203155517578
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.742 Vali Acc: 0.728 Test Loss: 1.742 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5233042240142822
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.646 Vali Acc: 0.705 Test Loss: 2.646 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5341804027557373
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.323 Vali Acc: 0.717 Test Loss: 2.323 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1373327
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.755322456359863
Epoch: 1, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.116 Vali Acc: 0.549 Test Loss: 1.116 Test Acc: 0.549
Validation loss decreased (inf --> -0.549122).  Saving model ...
Epoch: 2 cost time: 2.9720542430877686
Epoch: 2, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.814 Vali Acc: 0.705 Test Loss: 0.814 Test Acc: 0.705
Validation loss decreased (-0.549122 --> -0.705194).  Saving model ...
Epoch: 3 cost time: 3.5158324241638184
Epoch: 3, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.059 Vali Acc: 0.705 Test Loss: 1.059 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6578598022460938
Epoch: 4, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.869 Vali Acc: 0.757 Test Loss: 0.869 Test Acc: 0.757
Validation loss decreased (-0.705194 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 3.4682581424713135
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.124 Vali Acc: 0.757 Test Loss: 1.124 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5402841567993164
Epoch: 6, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.053 Vali Acc: 0.769 Test Loss: 1.053 Test Acc: 0.769
Validation loss decreased (-0.757217 --> -0.768776).  Saving model ...
Epoch: 7 cost time: 3.420889377593994
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.970 Vali Acc: 0.763 Test Loss: 0.970 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5963823795318604
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.809 Test Loss: 0.843 Test Acc: 0.809
Validation loss decreased (-0.768776 --> -0.809240).  Saving model ...
Epoch: 9 cost time: 3.976010322570801
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.798 Test Loss: 0.729 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.024818420410156
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.798 Test Loss: 0.721 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5957558155059814
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.414149761199951
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3591701984405518
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3554346561431885
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.282599687576294
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.4476356506347656
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809241).  Saving model ...
Epoch: 17 cost time: 3.5832512378692627
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.809 Test Loss: 0.734 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.564838171005249
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 19 cost time: 3.2181031703948975
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1051368713378906
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.809 Test Loss: 0.734 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.503629207611084
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.809 Test Loss: 0.735 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.634873390197754
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.809 Test Loss: 0.736 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4910731315612793
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.815 Test Loss: 0.737 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815022).  Saving model ...
Epoch: 24 cost time: 3.319305419921875
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.815 Test Loss: 0.739 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6209402084350586
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.815 Test Loss: 0.739 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.55244517326355
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.815 Test Loss: 0.739 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.4276058673858643
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.815 Test Loss: 0.740 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.134037733078003
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.815 Test Loss: 0.741 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3950202465057373
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.383247137069702
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.803 Test Loss: 0.743 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.482147216796875
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.5226523876190186
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.3319318294525146
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.803 Test Loss: 0.745 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1258703
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.755279064178467
Epoch: 1, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.741 Vali Acc: 0.376 Test Loss: 1.741 Test Acc: 0.376
Validation loss decreased (inf --> -0.375705).  Saving model ...
Epoch: 2 cost time: 2.674098253250122
Epoch: 2, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.984 Vali Acc: 0.636 Test Loss: 0.984 Test Acc: 0.636
Validation loss decreased (-0.375705 --> -0.635828).  Saving model ...
Epoch: 3 cost time: 2.7006473541259766
Epoch: 3, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.905 Vali Acc: 0.723 Test Loss: 0.905 Test Acc: 0.723
Validation loss decreased (-0.635828 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 2.954944610595703
Epoch: 4, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.668 Vali Acc: 0.665 Test Loss: 1.668 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8764476776123047
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.054 Vali Acc: 0.728 Test Loss: 1.054 Test Acc: 0.728
Validation loss decreased (-0.722534 --> -0.728313).  Saving model ...
Epoch: 6 cost time: 2.680149793624878
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.506 Vali Acc: 0.728 Test Loss: 1.506 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9769418239593506
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.905 Vali Acc: 0.671 Test Loss: 1.905 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.892059803009033
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.694 Test Loss: 1.787 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9954400062561035
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.723 Test Loss: 1.668 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8697731494903564
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.723 Test Loss: 1.645 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7020764350891113
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.728 Test Loss: 1.638 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.734938621520996
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.746 Test Loss: 1.633 Test Acc: 0.746
Validation loss decreased (-0.728313 --> -0.745648).  Saving model ...
Epoch: 13 cost time: 3.7494137287139893
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.734 Test Loss: 1.630 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4594171047210693
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.746 Test Loss: 1.629 Test Acc: 0.746
Validation loss decreased (-0.745648 --> -0.745648).  Saving model ...
Epoch: 15 cost time: 3.1842288970947266
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.746 Test Loss: 1.627 Test Acc: 0.746
Validation loss decreased (-0.745648 --> -0.745648).  Saving model ...
Epoch: 16 cost time: 3.3580639362335205
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.746 Test Loss: 1.624 Test Acc: 0.746
Validation loss decreased (-0.745648 --> -0.745649).  Saving model ...
Epoch: 17 cost time: 3.162647008895874
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.746 Test Loss: 1.623 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 18 cost time: 2.5014631748199463
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.746 Test Loss: 1.623 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 19 cost time: 2.8660478591918945
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.746 Test Loss: 1.620 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 20 cost time: 3.0496809482574463
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.746 Test Loss: 1.620 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 21 cost time: 3.2640902996063232
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.746 Test Loss: 1.619 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 22 cost time: 3.364269733428955
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.746 Test Loss: 1.617 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 23 cost time: 3.36458683013916
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.746 Test Loss: 1.616 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 24 cost time: 3.089019536972046
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.746 Test Loss: 1.618 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0783140659332275
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.746 Test Loss: 1.616 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.992790699005127
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.746 Test Loss: 1.614 Test Acc: 0.746
Validation loss decreased (-0.745649 --> -0.745649).  Saving model ...
Epoch: 27 cost time: 2.979806423187256
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.734 Test Loss: 1.614 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9473862648010254
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.734 Test Loss: 1.614 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0368216037750244
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.734 Test Loss: 1.613 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1192023754119873
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.734 Test Loss: 1.611 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.7849748134613037
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.734 Test Loss: 1.610 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.018470287322998
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.734 Test Loss: 1.611 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.3957788944244385
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.734 Test Loss: 1.610 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.134611129760742
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.734 Test Loss: 1.608 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.2815194129943848
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.734 Test Loss: 1.606 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.2224035263061523
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.734 Test Loss: 1.605 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 1257167
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.166676044464111
Epoch: 1, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.025 Vali Acc: 0.647 Test Loss: 1.025 Test Acc: 0.647
Validation loss decreased (inf --> -0.647389).  Saving model ...
Epoch: 2 cost time: 2.916377067565918
Epoch: 2, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.861 Vali Acc: 0.682 Test Loss: 0.861 Test Acc: 0.682
Validation loss decreased (-0.647389 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 2.8284199237823486
Epoch: 3, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.106 Vali Acc: 0.682 Test Loss: 1.106 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9656260013580322
Epoch: 4, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.025 Vali Acc: 0.717 Test Loss: 1.025 Test Acc: 0.717
Validation loss decreased (-0.682072 --> -0.716753).  Saving model ...
Epoch: 5 cost time: 2.777592420578003
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
Validation loss decreased (-0.716753 --> -0.809241).  Saving model ...
Epoch: 6 cost time: 2.6876282691955566
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.786 Test Loss: 0.792 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.794100522994995
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.190 Vali Acc: 0.740 Test Loss: 1.190 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8293278217315674
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.775 Test Loss: 0.892 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8752105236053467
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.909 Vali Acc: 0.780 Test Loss: 0.909 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8372669219970703
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.095 Vali Acc: 0.775 Test Loss: 1.095 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4398961067199707
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.769 Test Loss: 0.991 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7183735370635986
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.769 Test Loss: 0.959 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.26080584526062
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.769 Test Loss: 0.947 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1529414653778076
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.780 Test Loss: 0.942 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2182204723358154
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.786 Test Loss: 0.938 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1255119
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9391512870788574
Epoch: 1, Steps: 17 | Train Loss: 1.652 Vali Loss: 1.202 Vali Acc: 0.566 Test Loss: 1.202 Test Acc: 0.566
Validation loss decreased (inf --> -0.566462).  Saving model ...
Epoch: 2 cost time: 2.4695839881896973
Epoch: 2, Steps: 17 | Train Loss: 0.309 Vali Loss: 1.084 Vali Acc: 0.659 Test Loss: 1.084 Test Acc: 0.659
Validation loss decreased (-0.566462 --> -0.658949).  Saving model ...
Epoch: 3 cost time: 2.5792007446289062
Epoch: 3, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.995 Vali Acc: 0.723 Test Loss: 0.995 Test Acc: 0.723
Validation loss decreased (-0.658949 --> -0.722533).  Saving model ...
Epoch: 4 cost time: 2.4652047157287598
Epoch: 4, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.847 Vali Acc: 0.780 Test Loss: 0.847 Test Acc: 0.780
Validation loss decreased (-0.722533 --> -0.780338).  Saving model ...
Epoch: 5 cost time: 2.1447298526763916
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.574 Vali Acc: 0.688 Test Loss: 1.574 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.674921751022339
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.746 Test Loss: 1.204 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.624739170074463
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.757 Test Loss: 1.077 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.483088254928589
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.746 Test Loss: 1.228 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7079334259033203
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.751 Test Loss: 1.216 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.363171339035034
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.757 Test Loss: 1.174 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6659634113311768
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.751 Test Loss: 1.154 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6366052627563477
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.138 Vali Acc: 0.751 Test Loss: 1.138 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5174717903137207
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.757 Test Loss: 1.125 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7673680782318115
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.757 Test Loss: 1.116 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1253583
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0994255542755127
Epoch: 1, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.097 Vali Acc: 0.624 Test Loss: 1.097 Test Acc: 0.624
Validation loss decreased (inf --> -0.624266).  Saving model ...
Epoch: 2 cost time: 1.974888563156128
Epoch: 2, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.000 Vali Acc: 0.694 Test Loss: 1.000 Test Acc: 0.694
Validation loss decreased (-0.624266 --> -0.693632).  Saving model ...
Epoch: 3 cost time: 2.174959897994995
Epoch: 3, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.981 Vali Acc: 0.723 Test Loss: 0.981 Test Acc: 0.723
Validation loss decreased (-0.693632 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 1.9130356311798096
Epoch: 4, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.680 Vali Acc: 0.665 Test Loss: 1.680 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2257044315338135
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.606 Vali Acc: 0.705 Test Loss: 1.606 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2610623836517334
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.856 Vali Acc: 0.711 Test Loss: 1.856 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9206371307373047
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.853 Vali Acc: 0.699 Test Loss: 1.853 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2155373096466064
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.711 Test Loss: 1.960 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.186424493789673
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.728 Test Loss: 1.871 Test Acc: 0.728
Validation loss decreased (-0.722534 --> -0.728305).  Saving model ...
Epoch: 10 cost time: 1.737962245941162
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.728 Test Loss: 1.813 Test Acc: 0.728
Validation loss decreased (-0.728305 --> -0.728306).  Saving model ...
Epoch: 11 cost time: 2.211196184158325
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.728 Test Loss: 1.786 Test Acc: 0.728
Validation loss decreased (-0.728306 --> -0.728306).  Saving model ...
Epoch: 12 cost time: 2.115816593170166
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.728 Test Loss: 1.770 Test Acc: 0.728
Validation loss decreased (-0.728306 --> -0.728306).  Saving model ...
Epoch: 13 cost time: 1.8802204132080078
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.759 Vali Acc: 0.728 Test Loss: 1.759 Test Acc: 0.728
Validation loss decreased (-0.728306 --> -0.728306).  Saving model ...
Epoch: 14 cost time: 1.655470848083496
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.728 Test Loss: 1.750 Test Acc: 0.728
Validation loss decreased (-0.728306 --> -0.728306).  Saving model ...
Epoch: 15 cost time: 1.542391061782837
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.728 Test Loss: 1.741 Test Acc: 0.728
Validation loss decreased (-0.728306 --> -0.728306).  Saving model ...
Epoch: 16 cost time: 1.5403797626495361
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.733 Vali Acc: 0.728 Test Loss: 1.733 Test Acc: 0.728
Validation loss decreased (-0.728306 --> -0.728306).  Saving model ...
Epoch: 17 cost time: 1.5754590034484863
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.728 Test Loss: 1.726 Test Acc: 0.728
Validation loss decreased (-0.728306 --> -0.728306).  Saving model ...
Epoch: 18 cost time: 1.6340041160583496
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.734 Test Loss: 1.718 Test Acc: 0.734
Validation loss decreased (-0.728306 --> -0.734087).  Saving model ...
Epoch: 19 cost time: 1.5805237293243408
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.734 Test Loss: 1.711 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 20 cost time: 1.8431811332702637
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.734 Test Loss: 1.704 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 21 cost time: 1.9223182201385498
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.734 Test Loss: 1.700 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 22 cost time: 2.526250123977661
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.734 Test Loss: 1.694 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 23 cost time: 2.4734275341033936
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.734 Test Loss: 1.688 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 24 cost time: 2.4734699726104736
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.734 Test Loss: 1.683 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 25 cost time: 2.670811414718628
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.734 Test Loss: 1.677 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 26 cost time: 1.7728893756866455
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.671 Vali Acc: 0.734 Test Loss: 1.671 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 27 cost time: 2.02211856842041
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.734 Test Loss: 1.667 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 28 cost time: 1.5855956077575684
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.734 Test Loss: 1.662 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 29 cost time: 2.018315553665161
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.734 Test Loss: 1.658 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734087).  Saving model ...
Epoch: 30 cost time: 1.5394692420959473
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.734 Test Loss: 1.654 Test Acc: 0.734
Validation loss decreased (-0.734087 --> -0.734088).  Saving model ...
Epoch: 31 cost time: 1.8558413982391357
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.734 Test Loss: 1.651 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 32 cost time: 1.6851024627685547
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.734 Test Loss: 1.647 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 33 cost time: 2.0977230072021484
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.734 Test Loss: 1.643 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 34 cost time: 1.948239803314209
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.734 Test Loss: 1.640 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 35 cost time: 2.021242380142212
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.734 Test Loss: 1.637 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 36 cost time: 1.8089230060577393
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.734 Test Loss: 1.632 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 37 cost time: 2.2454559803009033
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.734 Test Loss: 1.629 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 38 cost time: 1.9157142639160156
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.734 Test Loss: 1.626 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 39 cost time: 1.9914343357086182
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.734 Test Loss: 1.623 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 40 cost time: 1.8209140300750732
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.734 Test Loss: 1.619 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 41 cost time: 2.074239492416382
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.734 Test Loss: 1.615 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 42 cost time: 1.8473093509674072
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.734 Test Loss: 1.612 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 43 cost time: 2.2843894958496094
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.734 Test Loss: 1.610 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 44 cost time: 1.9015321731567383
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.734 Test Loss: 1.608 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 45 cost time: 2.1472980976104736
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.734 Test Loss: 1.607 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 46 cost time: 2.164987802505493
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.734 Test Loss: 1.604 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 47 cost time: 1.7705013751983643
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.734 Test Loss: 1.601 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 48 cost time: 2.0041158199310303
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.734 Test Loss: 1.597 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 49 cost time: 1.8077082633972168
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.734 Test Loss: 1.596 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 50 cost time: 2.1244826316833496
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.734 Test Loss: 1.594 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 51 cost time: 1.612351417541504
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.734 Test Loss: 1.590 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 52 cost time: 1.943939447402954
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.734 Test Loss: 1.588 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 53 cost time: 1.697157382965088
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.734 Test Loss: 1.586 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 54 cost time: 2.1872904300689697
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.734 Test Loss: 1.582 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 55 cost time: 1.919640302658081
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.734 Test Loss: 1.580 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 56 cost time: 1.5546135902404785
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.734 Test Loss: 1.578 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 57 cost time: 2.0477538108825684
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.734 Test Loss: 1.576 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 58 cost time: 1.7821800708770752
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.734 Test Loss: 1.575 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 59 cost time: 2.144773006439209
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.734 Test Loss: 1.572 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 60 cost time: 1.7711029052734375
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.734 Test Loss: 1.570 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 61 cost time: 2.2697060108184814
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.734 Test Loss: 1.567 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 62 cost time: 1.644963026046753
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.734 Test Loss: 1.566 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 63 cost time: 2.1353089809417725
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.734 Test Loss: 1.564 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 64 cost time: 2.070352554321289
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.734 Test Loss: 1.562 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 65 cost time: 1.7305521965026855
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.734 Test Loss: 1.560 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 66 cost time: 1.8542125225067139
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.734 Test Loss: 1.558 Test Acc: 0.734
Validation loss decreased (-0.734088 --> -0.734088).  Saving model ...
Epoch: 67 cost time: 2.18796706199646
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.740 Test Loss: 1.555 Test Acc: 0.740
Validation loss decreased (-0.734088 --> -0.739869).  Saving model ...
Epoch: 68 cost time: 1.854933738708496
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.740 Test Loss: 1.553 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 69 cost time: 2.3602733612060547
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.740 Test Loss: 1.551 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 70 cost time: 2.262664794921875
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.740 Test Loss: 1.549 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 71 cost time: 1.8470220565795898
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.740 Test Loss: 1.548 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 72 cost time: 2.217320442199707
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.740 Test Loss: 1.546 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 73 cost time: 1.7183263301849365
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.740 Test Loss: 1.544 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 74 cost time: 2.351644515991211
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.740 Test Loss: 1.542 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 75 cost time: 1.6898775100708008
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.740 Test Loss: 1.541 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 76 cost time: 2.1500556468963623
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.740 Test Loss: 1.539 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 77 cost time: 1.9016239643096924
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.740 Test Loss: 1.538 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 78 cost time: 1.794694423675537
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.740 Test Loss: 1.536 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 79 cost time: 1.7237207889556885
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.740 Test Loss: 1.534 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 80 cost time: 1.5472197532653809
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.740 Test Loss: 1.532 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 81 cost time: 1.5285561084747314
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.740 Test Loss: 1.531 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 82 cost time: 1.7301239967346191
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.740 Test Loss: 1.529 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 83 cost time: 1.6021478176116943
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.740 Test Loss: 1.526 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 84 cost time: 2.349539279937744
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.740 Test Loss: 1.525 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 85 cost time: 1.8885138034820557
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.740 Test Loss: 1.523 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 86 cost time: 1.9313242435455322
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.740 Test Loss: 1.522 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 87 cost time: 2.0521907806396484
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.740 Test Loss: 1.520 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 88 cost time: 1.760162115097046
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.740 Test Loss: 1.519 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 89 cost time: 2.365497589111328
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.740 Test Loss: 1.517 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 90 cost time: 2.230318307876587
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.740 Test Loss: 1.516 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 91 cost time: 1.8255538940429688
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.740 Test Loss: 1.515 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 92 cost time: 2.0954012870788574
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.740 Test Loss: 1.513 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 93 cost time: 2.1635444164276123
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.740 Test Loss: 1.511 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 94 cost time: 1.8846137523651123
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.740 Test Loss: 1.510 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 95 cost time: 2.1452457904815674
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.740 Test Loss: 1.508 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 96 cost time: 2.230837106704712
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.740 Test Loss: 1.506 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 97 cost time: 2.155672788619995
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.740 Test Loss: 1.505 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 98 cost time: 2.2584798336029053
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.740 Test Loss: 1.502 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 99 cost time: 2.4151039123535156
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.740 Test Loss: 1.501 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
Epoch: 100 cost time: 1.941788673400879
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.740 Test Loss: 1.500 Test Acc: 0.740
Validation loss decreased (-0.739869 --> -0.739869).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 1252047
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4960577487945557
Epoch: 1, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.262 Vali Acc: 0.509 Test Loss: 1.262 Test Acc: 0.509
Validation loss decreased (inf --> -0.508658).  Saving model ...
Epoch: 2 cost time: 1.7341127395629883
Epoch: 2, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.020 Vali Acc: 0.723 Test Loss: 1.020 Test Acc: 0.723
Validation loss decreased (-0.508658 --> -0.722533).  Saving model ...
Epoch: 3 cost time: 1.910780668258667
Epoch: 3, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.770 Vali Acc: 0.746 Test Loss: 0.770 Test Acc: 0.746
Validation loss decreased (-0.722533 --> -0.745657).  Saving model ...
Epoch: 4 cost time: 1.6611747741699219
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.418 Vali Acc: 0.688 Test Loss: 1.418 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.019672155380249
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.763 Test Loss: 0.705 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 1.4137845039367676
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.659 Test Loss: 1.105 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7338366508483887
Epoch: 7, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768777).  Saving model ...
Epoch: 8 cost time: 1.733168601989746
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.267 Vali Acc: 0.734 Test Loss: 1.267 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3214902877807617
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.404 Vali Acc: 0.734 Test Loss: 1.404 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.484405517578125
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.060 Vali Acc: 0.699 Test Loss: 2.060 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1901240348815918
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.928 Vali Acc: 0.746 Test Loss: 1.928 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3419768810272217
Epoch: 12, Steps: 17 | Train Loss: 0.063 Vali Loss: 2.050 Vali Acc: 0.734 Test Loss: 2.050 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4373044967651367
Epoch: 13, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.763 Vali Acc: 0.682 Test Loss: 2.763 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4919652938842773
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 3.552 Vali Acc: 0.653 Test Loss: 3.552 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4601027965545654
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.461 Vali Acc: 0.746 Test Loss: 2.461 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4990081787109375
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 2.672 Vali Acc: 0.746 Test Loss: 2.672 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3080406188964844
Epoch: 17, Steps: 17 | Train Loss: 0.308 Vali Loss: 2.823 Vali Acc: 0.711 Test Loss: 2.823 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1251023
model size : 4.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8620195388793945
Epoch: 1, Steps: 17 | Train Loss: 1.645 Vali Loss: 1.100 Vali Acc: 0.549 Test Loss: 1.100 Test Acc: 0.549
Validation loss decreased (inf --> -0.549122).  Saving model ...
Epoch: 2 cost time: 1.73115873336792
Epoch: 2, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.549122 --> -0.710975).  Saving model ...
Epoch: 3 cost time: 1.22288179397583
Epoch: 3, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.269 Vali Acc: 0.688 Test Loss: 1.269 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4444825649261475
Epoch: 4, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.435 Vali Acc: 0.676 Test Loss: 1.435 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3133010864257812
Epoch: 5, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.914 Vali Acc: 0.780 Test Loss: 0.914 Test Acc: 0.780
Validation loss decreased (-0.710975 --> -0.780338).  Saving model ...
Epoch: 6 cost time: 1.5294461250305176
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.988 Vali Acc: 0.734 Test Loss: 0.988 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.430746078491211
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.009 Vali Acc: 0.751 Test Loss: 1.009 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.406179666519165
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.740 Test Loss: 0.952 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.301039695739746
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.751 Test Loss: 0.934 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3417346477508545
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.751 Test Loss: 0.911 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6104505062103271
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.751 Test Loss: 0.892 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5811867713928223
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.763 Test Loss: 0.875 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5175988674163818
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.763 Test Loss: 0.863 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4228734970092773
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.388366460800171
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.757 Test Loss: 0.846 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1250511
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6968863010406494
Epoch: 1, Steps: 17 | Train Loss: 1.614 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
Validation loss decreased (inf --> -0.514439).  Saving model ...
Epoch: 2 cost time: 1.4226727485656738
Epoch: 2, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.162 Vali Acc: 0.676 Test Loss: 1.162 Test Acc: 0.676
Validation loss decreased (-0.514439 --> -0.676289).  Saving model ...
Epoch: 3 cost time: 1.5246999263763428
Epoch: 3, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
Validation loss decreased (-0.676289 --> -0.803462).  Saving model ...
Epoch: 4 cost time: 1.2558579444885254
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.831 Vali Acc: 0.775 Test Loss: 0.831 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2591519355773926
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.970 Vali Acc: 0.746 Test Loss: 0.970 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2892897129058838
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.786 Test Loss: 0.798 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2943544387817383
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.157 Vali Acc: 0.751 Test Loss: 1.157 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3140084743499756
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.746 Test Loss: 0.773 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3284540176391602
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.775 Test Loss: 0.679 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.413787603378296
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.775 Test Loss: 0.654 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2510926723480225
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.775 Test Loss: 0.654 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3695814609527588
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.775 Test Loss: 0.651 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6253373622894287
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.775 Test Loss: 0.652 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1249999
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.249971151351929
Epoch: 1, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.213 Vali Acc: 0.549 Test Loss: 1.213 Test Acc: 0.549
Validation loss decreased (inf --> -0.549121).  Saving model ...
Epoch: 2 cost time: 3.8739054203033447
Epoch: 2, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.909 Vali Acc: 0.699 Test Loss: 0.909 Test Acc: 0.699
Validation loss decreased (-0.549121 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 3.857084274291992
Epoch: 3, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.824 Vali Acc: 0.763 Test Loss: 0.824 Test Acc: 0.763
Validation loss decreased (-0.699413 --> -0.762998).  Saving model ...
Epoch: 4 cost time: 3.8066318035125732
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.780 Test Loss: 0.599 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780341).  Saving model ...
Epoch: 5 cost time: 3.869227647781372
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
Validation loss decreased (-0.780341 --> -0.803461).  Saving model ...
Epoch: 6 cost time: 3.622467517852783
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.609107732772827
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.798 Test Loss: 0.769 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.089995622634888
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.792 Test Loss: 0.761 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.139735221862793
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.792 Test Loss: 0.747 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.8209214210510254
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.792 Test Loss: 0.740 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7233786582946777
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.089030742645264
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.1452202796936035
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.792 Test Loss: 0.736 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.4967808723449707
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.792 Test Loss: 0.736 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.502572774887085
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1197039
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.120613098144531
Epoch: 1, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.046 Vali Acc: 0.601 Test Loss: 1.046 Test Acc: 0.601
Validation loss decreased (inf --> -0.601146).  Saving model ...
Epoch: 2 cost time: 3.012005567550659
Epoch: 2, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.830 Vali Acc: 0.688 Test Loss: 0.830 Test Acc: 0.688
Validation loss decreased (-0.601146 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 2.773435592651367
Epoch: 3, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.813 Vali Acc: 0.734 Test Loss: 0.813 Test Acc: 0.734
Validation loss decreased (-0.687853 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 2.579801559448242
Epoch: 4, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.898 Vali Acc: 0.723 Test Loss: 0.898 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5356667041778564
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.794 Vali Acc: 0.786 Test Loss: 0.794 Test Acc: 0.786
Validation loss decreased (-0.734096 --> -0.786119).  Saving model ...
Epoch: 6 cost time: 2.5597684383392334
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.786 Test Loss: 0.749 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 2.639927387237549
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.786 Test Loss: 0.721 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 8 cost time: 2.968003511428833
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.798 Test Loss: 0.707 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797681).  Saving model ...
Epoch: 9 cost time: 2.909149169921875
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.798 Test Loss: 0.701 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 10 cost time: 3.0280442237854004
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.798 Test Loss: 0.701 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 11 cost time: 3.0417604446411133
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.798 Test Loss: 0.702 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1564114093780518
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.798 Test Loss: 0.703 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0737011432647705
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.798 Test Loss: 0.702 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.926382064819336
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.798 Test Loss: 0.705 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.701115846633911
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.798 Test Loss: 0.705 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.73832368850708
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.798 Test Loss: 0.706 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.5202224254608154
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.798 Test Loss: 0.710 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.604512929916382
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.798 Test Loss: 0.714 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.220498561859131
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.798 Test Loss: 0.713 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.289839029312134
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.798 Test Loss: 0.715 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1195503
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.421589136123657
Epoch: 1, Steps: 17 | Train Loss: 1.794 Vali Loss: 1.320 Vali Acc: 0.503 Test Loss: 1.320 Test Acc: 0.503
Validation loss decreased (inf --> -0.502877).  Saving model ...
Epoch: 2 cost time: 2.9099321365356445
Epoch: 2, Steps: 17 | Train Loss: 0.374 Vali Loss: 1.130 Vali Acc: 0.636 Test Loss: 1.130 Test Acc: 0.636
Validation loss decreased (-0.502877 --> -0.635827).  Saving model ...
Epoch: 3 cost time: 2.8273239135742188
Epoch: 3, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.072 Vali Acc: 0.705 Test Loss: 1.072 Test Acc: 0.705
Validation loss decreased (-0.635827 --> -0.705192).  Saving model ...
Epoch: 4 cost time: 2.8514516353607178
Epoch: 4, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.113 Vali Acc: 0.705 Test Loss: 1.113 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7413322925567627
Epoch: 5, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.103 Vali Acc: 0.688 Test Loss: 1.103 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7420096397399902
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.724 Vali Acc: 0.671 Test Loss: 1.724 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2935791015625
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.067 Vali Acc: 0.734 Test Loss: 1.067 Test Acc: 0.734
Validation loss decreased (-0.705192 --> -0.734093).  Saving model ...
Epoch: 8 cost time: 2.6904098987579346
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.723 Test Loss: 1.295 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6137242317199707
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.734 Test Loss: 1.104 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4445738792419434
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.746 Test Loss: 1.024 Test Acc: 0.746
Validation loss decreased (-0.734093 --> -0.745654).  Saving model ...
Epoch: 11 cost time: 2.514475107192993
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.746 Test Loss: 1.006 Test Acc: 0.746
Validation loss decreased (-0.745654 --> -0.745655).  Saving model ...
Epoch: 12 cost time: 2.407715320587158
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.746 Test Loss: 1.000 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745655).  Saving model ...
Epoch: 13 cost time: 2.7411105632781982
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.746 Test Loss: 0.993 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745655).  Saving model ...
Epoch: 14 cost time: 2.7291598320007324
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.746 Test Loss: 0.991 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745655).  Saving model ...
Epoch: 15 cost time: 2.620645523071289
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.746 Test Loss: 0.986 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745655).  Saving model ...
Epoch: 16 cost time: 2.694941759109497
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.746 Test Loss: 0.983 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745655).  Saving model ...
Epoch: 17 cost time: 2.748234510421753
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.746 Test Loss: 0.982 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745655).  Saving model ...
Epoch: 18 cost time: 2.657400608062744
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.751 Test Loss: 0.980 Test Acc: 0.751
Validation loss decreased (-0.745655 --> -0.751435).  Saving model ...
Epoch: 19 cost time: 2.646254777908325
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.751 Test Loss: 0.979 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 20 cost time: 2.523838996887207
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.751 Test Loss: 0.978 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 21 cost time: 2.691741943359375
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.751 Test Loss: 0.979 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6954405307769775
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.751 Test Loss: 0.976 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 23 cost time: 2.553123950958252
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.751 Test Loss: 0.975 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 24 cost time: 2.7115318775177
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.751 Test Loss: 0.978 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9107677936553955
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.977 Vali Acc: 0.751 Test Loss: 0.977 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4937450885772705
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.751 Test Loss: 0.978 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.520334005355835
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.751 Test Loss: 0.976 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5931546688079834
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.751 Test Loss: 0.974 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 29 cost time: 2.6007347106933594
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.751 Test Loss: 0.972 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 30 cost time: 2.4383959770202637
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.757 Test Loss: 0.973 Test Acc: 0.757
Validation loss decreased (-0.751435 --> -0.757216).  Saving model ...
Epoch: 31 cost time: 2.446023941040039
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.757 Test Loss: 0.972 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 32 cost time: 2.6157610416412354
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.757 Test Loss: 0.970 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 33 cost time: 2.7358503341674805
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.757 Test Loss: 0.971 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.9185848236083984
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.757 Test Loss: 0.969 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 35 cost time: 2.9094138145446777
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.757 Test Loss: 0.968 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 36 cost time: 3.0593783855438232
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.757 Test Loss: 0.969 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.947685956954956
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.757 Test Loss: 0.972 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.8137991428375244
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.757 Test Loss: 0.971 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.9481287002563477
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.757 Test Loss: 0.971 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.8246872425079346
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.757 Test Loss: 0.971 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.0684831142425537
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.757 Test Loss: 0.971 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.64217209815979
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.757 Test Loss: 0.970 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.7737927436828613
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.757 Test Loss: 0.970 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.793865919113159
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.763 Test Loss: 0.971 Test Acc: 0.763
Validation loss decreased (-0.757216 --> -0.762996).  Saving model ...
Epoch: 45 cost time: 2.8216359615325928
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.763 Test Loss: 0.973 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.7100155353546143
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
Validation loss decreased (-0.762996 --> -0.768776).  Saving model ...
Epoch: 47 cost time: 2.894993543624878
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.974900484085083
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.11289644241333
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 50 cost time: 2.892089605331421
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 51 cost time: 2.5944502353668213
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.6719777584075928
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.6893539428710938
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.674363136291504
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.631094455718994
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.7597546577453613
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.7919270992279053
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 58 cost time: 2.7600104808807373
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.230102300643921
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.5577502250671387
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.0961098670959473
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.171478033065796
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.1431472301483154
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.2527952194213867
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 65 cost time: 2.230424642562866
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.6624813079833984
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.691270351409912
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.7533955574035645
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768776).  Saving model ...
Epoch: 69 cost time: 2.7124176025390625
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.792076826095581
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.6079301834106445
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 2.213027238845825
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 2.4050028324127197
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 2.7711710929870605
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.769 Test Loss: 0.973 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 3.026043653488159
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.769 Test Loss: 0.971 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 2.9504241943359375
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 3.0815463066101074
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 2.9689414501190186
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.972 Vali Acc: 0.769 Test Loss: 0.972 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1193455
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9548451900482178
Epoch: 1, Steps: 17 | Train Loss: 1.681 Vali Loss: 1.389 Vali Acc: 0.514 Test Loss: 1.389 Test Acc: 0.514
Validation loss decreased (inf --> -0.514437).  Saving model ...
Epoch: 2 cost time: 2.734699010848999
Epoch: 2, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
Validation loss decreased (-0.514437 --> -0.757218).  Saving model ...
Epoch: 3 cost time: 2.5303189754486084
Epoch: 3, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.954 Vali Acc: 0.705 Test Loss: 0.954 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.08180570602417
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.946 Vali Acc: 0.723 Test Loss: 0.946 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7170403003692627
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.315 Vali Acc: 0.734 Test Loss: 1.315 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.367638349533081
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4319021701812744
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.188 Vali Acc: 0.723 Test Loss: 1.188 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6554453372955322
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.204 Vali Acc: 0.751 Test Loss: 1.204 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5342702865600586
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.723 Test Loss: 1.234 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.570085287094116
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.717 Test Loss: 1.076 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.703634738922119
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.042 Vali Acc: 0.728 Test Loss: 1.042 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6448521614074707
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.740 Test Loss: 0.991 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1191919
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.04247784614563
Epoch: 1, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.185 Vali Acc: 0.543 Test Loss: 1.185 Test Acc: 0.543
Validation loss decreased (inf --> -0.543341).  Saving model ...
Epoch: 2 cost time: 1.8853142261505127
Epoch: 2, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.856 Vali Acc: 0.699 Test Loss: 0.856 Test Acc: 0.699
Validation loss decreased (-0.543341 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 1.9104423522949219
Epoch: 3, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.936 Vali Acc: 0.740 Test Loss: 0.936 Test Acc: 0.740
Validation loss decreased (-0.699413 --> -0.739875).  Saving model ...
Epoch: 4 cost time: 1.9853804111480713
Epoch: 4, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.722 Vali Acc: 0.659 Test Loss: 1.722 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.064781665802002
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.330 Vali Acc: 0.688 Test Loss: 1.330 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.109328269958496
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.988 Vali Acc: 0.757 Test Loss: 0.988 Test Acc: 0.757
Validation loss decreased (-0.739875 --> -0.757216).  Saving model ...
Epoch: 7 cost time: 2.023371458053589
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.133 Vali Acc: 0.775 Test Loss: 1.133 Test Acc: 0.775
Validation loss decreased (-0.757216 --> -0.774555).  Saving model ...
Epoch: 8 cost time: 1.8499629497528076
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.245 Vali Acc: 0.757 Test Loss: 1.245 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1247668266296387
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.780 Test Loss: 1.118 Test Acc: 0.780
Validation loss decreased (-0.774555 --> -0.780336).  Saving model ...
Epoch: 10 cost time: 2.062980890274048
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.775 Test Loss: 1.127 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.025728225708008
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.775 Test Loss: 1.113 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.035665273666382
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.103 Vali Acc: 0.775 Test Loss: 1.103 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.049962282180786
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.786 Test Loss: 1.094 Test Acc: 0.786
Validation loss decreased (-0.780336 --> -0.786116).  Saving model ...
Epoch: 14 cost time: 2.2076220512390137
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.084 Vali Acc: 0.786 Test Loss: 1.084 Test Acc: 0.786
Validation loss decreased (-0.786116 --> -0.786116).  Saving model ...
Epoch: 15 cost time: 1.7608304023742676
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.786 Test Loss: 1.075 Test Acc: 0.786
Validation loss decreased (-0.786116 --> -0.786116).  Saving model ...
Epoch: 16 cost time: 1.5548489093780518
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.786 Test Loss: 1.069 Test Acc: 0.786
Validation loss decreased (-0.786116 --> -0.786116).  Saving model ...
Epoch: 17 cost time: 1.9080121517181396
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.775 Test Loss: 1.064 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.051725387573242
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.775 Test Loss: 1.058 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.256321668624878
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.775 Test Loss: 1.052 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.349436044692993
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.780 Test Loss: 1.050 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2193546295166016
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.775 Test Loss: 1.047 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8567841053009033
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9026882648468018
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.775 Test Loss: 1.040 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.223719835281372
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.775 Test Loss: 1.036 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.060539722442627
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.780 Test Loss: 1.033 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.298233985900879
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.780 Test Loss: 1.030 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1190383
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9542717933654785
Epoch: 1, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.333 Vali Acc: 0.480 Test Loss: 1.333 Test Acc: 0.480
Validation loss decreased (inf --> -0.479755).  Saving model ...
Epoch: 2 cost time: 1.7485334873199463
Epoch: 2, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.967 Vali Acc: 0.699 Test Loss: 0.967 Test Acc: 0.699
Validation loss decreased (-0.479755 --> -0.699412).  Saving model ...
Epoch: 3 cost time: 1.7639589309692383
Epoch: 3, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.018 Vali Acc: 0.671 Test Loss: 1.018 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7846181392669678
Epoch: 4, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.843 Vali Acc: 0.740 Test Loss: 0.843 Test Acc: 0.740
Validation loss decreased (-0.699412 --> -0.739876).  Saving model ...
Epoch: 5 cost time: 1.7191615104675293
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.763 Vali Acc: 0.769 Test Loss: 0.763 Test Acc: 0.769
Validation loss decreased (-0.739876 --> -0.768778).  Saving model ...
Epoch: 6 cost time: 2.054072380065918
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.605 Vali Acc: 0.786 Test Loss: 0.605 Test Acc: 0.786
Validation loss decreased (-0.768778 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 1.982029914855957
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.793 Vali Acc: 0.751 Test Loss: 0.793 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.042597532272339
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 1.9390194416046143
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.786 Test Loss: 0.584 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.980163812637329
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.792 Test Loss: 0.569 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9482440948486328
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.798 Test Loss: 0.561 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9580779075622559
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.792 Test Loss: 0.558 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2913262844085693
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9750967025756836
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9432063102722168
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6978585720062256
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9259376525878906
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8154923915863037
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1189359
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.659543514251709
Epoch: 1, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.222 Vali Acc: 0.538 Test Loss: 1.222 Test Acc: 0.538
Validation loss decreased (inf --> -0.537560).  Saving model ...
Epoch: 2 cost time: 1.6608004570007324
Epoch: 2, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.979 Vali Acc: 0.723 Test Loss: 0.979 Test Acc: 0.723
Validation loss decreased (-0.537560 --> -0.722534).  Saving model ...
Epoch: 3 cost time: 1.5288760662078857
Epoch: 3, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.967 Vali Acc: 0.740 Test Loss: 0.967 Test Acc: 0.740
Validation loss decreased (-0.722534 --> -0.739875).  Saving model ...
Epoch: 4 cost time: 1.4137353897094727
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.240 Vali Acc: 0.757 Test Loss: 1.240 Test Acc: 0.757
Validation loss decreased (-0.739875 --> -0.757213).  Saving model ...
Epoch: 5 cost time: 1.9794275760650635
Epoch: 5, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.275 Vali Acc: 0.723 Test Loss: 1.275 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.387070894241333
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.055 Vali Acc: 0.763 Test Loss: 1.055 Test Acc: 0.763
Validation loss decreased (-0.757213 --> -0.762995).  Saving model ...
Epoch: 7 cost time: 1.3821265697479248
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.116 Vali Acc: 0.717 Test Loss: 1.116 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4725830554962158
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.943 Vali Acc: 0.740 Test Loss: 0.943 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.486816644668579
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.740 Test Loss: 0.853 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4182498455047607
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.746 Test Loss: 1.033 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3691704273223877
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.740 Test Loss: 0.996 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3716232776641846
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.757 Test Loss: 0.941 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.312734603881836
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.757 Test Loss: 0.909 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5999832153320312
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4986705780029297
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.757 Test Loss: 0.876 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.664245843887329
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.757 Test Loss: 0.864 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1188847
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.336155652999878
Epoch: 1, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.437 Vali Acc: 0.457 Test Loss: 1.437 Test Acc: 0.457
Validation loss decreased (inf --> -0.456633).  Saving model ...
Epoch: 2 cost time: 1.237288475036621
Epoch: 2, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.669 Vali Acc: 0.723 Test Loss: 0.669 Test Acc: 0.723
Validation loss decreased (-0.456633 --> -0.722537).  Saving model ...
Epoch: 3 cost time: 1.1166877746582031
Epoch: 3, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.033 Vali Acc: 0.694 Test Loss: 1.033 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2900683879852295
Epoch: 4, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.023 Vali Acc: 0.717 Test Loss: 1.023 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0451862812042236
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
Validation loss decreased (-0.722537 --> -0.803460).  Saving model ...
Epoch: 6 cost time: 1.2786190509796143
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.064 Vali Acc: 0.757 Test Loss: 1.064 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2102572917938232
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.775 Test Loss: 0.957 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.12725830078125
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.763 Test Loss: 1.023 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2385447025299072
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.786 Test Loss: 0.936 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.252958059310913
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.786 Test Loss: 0.814 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1726980209350586
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.792 Test Loss: 0.799 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.01790189743042
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.792 Test Loss: 0.789 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.448498010635376
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.792 Test Loss: 0.783 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2120494842529297
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.792 Test Loss: 0.781 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3183505535125732
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.798 Test Loss: 0.780 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1188335
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.788093566894531
Epoch: 1, Steps: 17 | Train Loss: 1.694 Vali Loss: 1.092 Vali Acc: 0.572 Test Loss: 1.092 Test Acc: 0.572
Validation loss decreased (inf --> -0.572243).  Saving model ...
Epoch: 2 cost time: 3.0006210803985596
Epoch: 2, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.961 Vali Acc: 0.676 Test Loss: 0.961 Test Acc: 0.676
Validation loss decreased (-0.572243 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 3.112652063369751
Epoch: 3, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.150 Vali Acc: 0.705 Test Loss: 1.150 Test Acc: 0.705
Validation loss decreased (-0.676291 --> -0.705191).  Saving model ...
Epoch: 4 cost time: 2.911391019821167
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.173 Vali Acc: 0.740 Test Loss: 1.173 Test Acc: 0.740
Validation loss decreased (-0.705191 --> -0.739873).  Saving model ...
Epoch: 5 cost time: 3.5289337635040283
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.784 Vali Acc: 0.746 Test Loss: 0.784 Test Acc: 0.746
Validation loss decreased (-0.739873 --> -0.745657).  Saving model ...
Epoch: 6 cost time: 3.462853193283081
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.011 Vali Acc: 0.751 Test Loss: 1.011 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751435).  Saving model ...
Epoch: 7 cost time: 3.192697525024414
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.682 Test Loss: 1.801 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0672225952148438
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.792 Test Loss: 0.909 Test Acc: 0.792
Validation loss decreased (-0.751435 --> -0.791898).  Saving model ...
Epoch: 9 cost time: 3.321840524673462
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.803 Test Loss: 0.820 Test Acc: 0.803
Validation loss decreased (-0.791898 --> -0.803460).  Saving model ...
Epoch: 10 cost time: 3.2434539794921875
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.798 Test Loss: 0.800 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.689242124557495
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.798 Test Loss: 0.798 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.84421443939209
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.809 Test Loss: 0.800 Test Acc: 0.809
Validation loss decreased (-0.803460 --> -0.809241).  Saving model ...
Epoch: 13 cost time: 3.0792601108551025
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.809 Test Loss: 0.799 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 14 cost time: 3.3216636180877686
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.809 Test Loss: 0.798 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 15 cost time: 3.7351582050323486
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.72815203666687
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.809 Test Loss: 0.800 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9935741424560547
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.809 Test Loss: 0.798 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 18 cost time: 3.756483316421509
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.809 Test Loss: 0.796 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 19 cost time: 3.2352283000946045
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.809 Test Loss: 0.795 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 20 cost time: 3.1278610229492188
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.809 Test Loss: 0.793 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 21 cost time: 2.9865219593048096
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 22 cost time: 2.9763855934143066
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.809 Test Loss: 0.791 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 23 cost time: 3.512950897216797
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 24 cost time: 3.6904079914093018
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 25 cost time: 3.50573992729187
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2246575355529785
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9632856845855713
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.809 Test Loss: 0.791 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2304904460906982
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.346280336380005
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.3195972442626953
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.267674446105957
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.298534870147705
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 33 cost time: 3.52156662940979
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.809 Test Loss: 0.788 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.432697057723999
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.809 Test Loss: 0.788 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.2336041927337646
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.745377540588379
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 37 cost time: 3.0995469093322754
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.370929002761841
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.408116340637207
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.4780492782592773
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 41 cost time: 3.275308132171631
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 42 cost time: 3.445634365081787
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.558303117752075
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.588843584060669
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.4023900032043457
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.467731237411499
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.809 Test Loss: 0.788 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.6541318893432617
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.7389910221099854
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.4529683589935303
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.8162877559661865
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.61950945854187
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1166207
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.056393146514893
Epoch: 1, Steps: 17 | Train Loss: 1.761 Vali Loss: 1.318 Vali Acc: 0.555 Test Loss: 1.318 Test Acc: 0.555
Validation loss decreased (inf --> -0.554900).  Saving model ...
Epoch: 2 cost time: 2.6431989669799805
Epoch: 2, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.822 Vali Acc: 0.659 Test Loss: 0.822 Test Acc: 0.659
Validation loss decreased (-0.554900 --> -0.658951).  Saving model ...
Epoch: 3 cost time: 2.703226089477539
Epoch: 3, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.810 Vali Acc: 0.711 Test Loss: 0.810 Test Acc: 0.711
Validation loss decreased (-0.658951 --> -0.710975).  Saving model ...
Epoch: 4 cost time: 2.846271276473999
Epoch: 4, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.335 Vali Acc: 0.676 Test Loss: 1.335 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9408931732177734
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.581 Vali Acc: 0.699 Test Loss: 1.581 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.935317039489746
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.257 Vali Acc: 0.746 Test Loss: 1.257 Test Acc: 0.746
Validation loss decreased (-0.710975 --> -0.745652).  Saving model ...
Epoch: 7 cost time: 2.821115732192993
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.145 Vali Acc: 0.740 Test Loss: 1.145 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.925997257232666
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.711 Test Loss: 1.552 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8973419666290283
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.734 Test Loss: 1.407 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0952796936035156
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.740 Test Loss: 1.296 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.642948627471924
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.740 Test Loss: 1.511 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8623337745666504
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.757 Test Loss: 1.351 Test Acc: 0.757
Validation loss decreased (-0.745652 --> -0.757212).  Saving model ...
Epoch: 13 cost time: 2.957571268081665
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.769 Test Loss: 1.290 Test Acc: 0.769
Validation loss decreased (-0.757212 --> -0.768773).  Saving model ...
Epoch: 14 cost time: 2.9081945419311523
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.769 Test Loss: 1.264 Test Acc: 0.769
Validation loss decreased (-0.768773 --> -0.768773).  Saving model ...
Epoch: 15 cost time: 2.2328734397888184
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.769 Test Loss: 1.252 Test Acc: 0.769
Validation loss decreased (-0.768773 --> -0.768774).  Saving model ...
Epoch: 16 cost time: 2.422694683074951
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.769 Test Loss: 1.241 Test Acc: 0.769
Validation loss decreased (-0.768774 --> -0.768774).  Saving model ...
Epoch: 17 cost time: 2.387286901473999
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.769 Test Loss: 1.233 Test Acc: 0.769
Validation loss decreased (-0.768774 --> -0.768774).  Saving model ...
Epoch: 18 cost time: 2.5028390884399414
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.763 Test Loss: 1.224 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.440194845199585
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.763 Test Loss: 1.217 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.373595952987671
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.763 Test Loss: 1.210 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2974486351013184
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.763 Test Loss: 1.203 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.460811138153076
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.763 Test Loss: 1.197 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.858236789703369
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.763 Test Loss: 1.192 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.963042736053467
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.763 Test Loss: 1.186 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.9194254875183105
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.763 Test Loss: 1.180 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.836214542388916
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.763 Test Loss: 1.175 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6482255458831787
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.763 Test Loss: 1.170 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1164671
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5410404205322266
Epoch: 1, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.206 Vali Acc: 0.590 Test Loss: 1.206 Test Acc: 0.590
Validation loss decreased (inf --> -0.589583).  Saving model ...
Epoch: 2 cost time: 2.3717405796051025
Epoch: 2, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.902 Vali Acc: 0.699 Test Loss: 0.902 Test Acc: 0.699
Validation loss decreased (-0.589583 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 2.3079190254211426
Epoch: 3, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.102 Vali Acc: 0.682 Test Loss: 1.102 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3407444953918457
Epoch: 4, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.223 Vali Acc: 0.699 Test Loss: 1.223 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4456448554992676
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.095 Vali Acc: 0.705 Test Loss: 1.095 Test Acc: 0.705
Validation loss decreased (-0.699413 --> -0.705191).  Saving model ...
Epoch: 6 cost time: 2.468545436859131
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.394 Vali Acc: 0.734 Test Loss: 1.394 Test Acc: 0.734
Validation loss decreased (-0.705191 --> -0.734090).  Saving model ...
Epoch: 7 cost time: 2.5925607681274414
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.158 Vali Acc: 0.769 Test Loss: 1.158 Test Acc: 0.769
Validation loss decreased (-0.734090 --> -0.768775).  Saving model ...
Epoch: 8 cost time: 2.5340816974639893
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.751 Test Loss: 1.208 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5578014850616455
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.746 Test Loss: 1.188 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.260727643966675
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.746 Test Loss: 1.181 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.55936598777771
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.746 Test Loss: 1.177 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4113893508911133
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.746 Test Loss: 1.177 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.379082441329956
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.746 Test Loss: 1.174 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4404754638671875
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.746 Test Loss: 1.177 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.531048536300659
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.746 Test Loss: 1.174 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4688267707824707
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.751 Test Loss: 1.173 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.132504940032959
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.751 Test Loss: 1.173 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1162623
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.141511678695679
Epoch: 1, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.349 Vali Acc: 0.497 Test Loss: 1.349 Test Acc: 0.497
Validation loss decreased (inf --> -0.497096).  Saving model ...
Epoch: 2 cost time: 2.352128505706787
Epoch: 2, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.094 Vali Acc: 0.642 Test Loss: 1.094 Test Acc: 0.642
Validation loss decreased (-0.497096 --> -0.641608).  Saving model ...
Epoch: 3 cost time: 2.4694478511810303
Epoch: 3, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.728 Vali Acc: 0.769 Test Loss: 0.728 Test Acc: 0.769
Validation loss decreased (-0.641608 --> -0.768779).  Saving model ...
Epoch: 4 cost time: 2.663419485092163
Epoch: 4, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.092 Vali Acc: 0.763 Test Loss: 1.092 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.497267723083496
Epoch: 5, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.515 Vali Acc: 0.671 Test Loss: 1.515 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.396977186203003
Epoch: 6, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.276 Vali Acc: 0.717 Test Loss: 1.276 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8714442253112793
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.313 Vali Acc: 0.676 Test Loss: 1.313 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7519266605377197
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.419 Vali Acc: 0.694 Test Loss: 1.419 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2658822536468506
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.717 Test Loss: 1.463 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.270653009414673
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.717 Test Loss: 1.389 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.652557134628296
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.711 Test Loss: 1.380 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4592068195343018
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.374 Vali Acc: 0.699 Test Loss: 1.374 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4653775691986084
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.705 Test Loss: 1.357 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1161087
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9217400550842285
Epoch: 1, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.133 Vali Acc: 0.572 Test Loss: 1.133 Test Acc: 0.572
Validation loss decreased (inf --> -0.572243).  Saving model ...
Epoch: 2 cost time: 1.6526072025299072
Epoch: 2, Steps: 17 | Train Loss: 0.386 Vali Loss: 1.241 Vali Acc: 0.624 Test Loss: 1.241 Test Acc: 0.624
Validation loss decreased (-0.572243 --> -0.624265).  Saving model ...
Epoch: 3 cost time: 1.4492182731628418
Epoch: 3, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.895 Vali Acc: 0.705 Test Loss: 0.895 Test Acc: 0.705
Validation loss decreased (-0.624265 --> -0.705193).  Saving model ...
Epoch: 4 cost time: 1.422436237335205
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.067 Vali Acc: 0.763 Test Loss: 1.067 Test Acc: 0.763
Validation loss decreased (-0.705193 --> -0.762995).  Saving model ...
Epoch: 5 cost time: 1.7049236297607422
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.207 Vali Acc: 0.751 Test Loss: 1.207 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7960989475250244
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.952 Vali Acc: 0.740 Test Loss: 0.952 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7374019622802734
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.162 Vali Acc: 0.740 Test Loss: 1.162 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6280128955841064
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.751 Test Loss: 1.101 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.699899673461914
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.552 Vali Acc: 0.717 Test Loss: 1.552 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6757197380065918
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.939 Vali Acc: 0.763 Test Loss: 0.939 Test Acc: 0.763
Validation loss decreased (-0.762995 --> -0.762996).  Saving model ...
Epoch: 11 cost time: 1.7829244136810303
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.717 Test Loss: 1.028 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.737905740737915
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.717 Test Loss: 1.000 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7937333583831787
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.937 Vali Acc: 0.734 Test Loss: 0.937 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9313805103302002
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.734 Test Loss: 0.920 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8095550537109375
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.734 Test Loss: 0.914 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8623278141021729
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.728 Test Loss: 0.909 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.700371503829956
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.728 Test Loss: 0.911 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7929911613464355
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.734 Test Loss: 0.910 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6885621547698975
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.734 Test Loss: 0.908 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8265180587768555
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.734 Test Loss: 0.906 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1159551
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8886735439300537
Epoch: 1, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.018 Vali Acc: 0.630 Test Loss: 1.018 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 1.5843408107757568
Epoch: 2, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.789 Vali Acc: 0.723 Test Loss: 0.789 Test Acc: 0.723
Validation loss decreased (-0.630048 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.6389379501342773
Epoch: 3, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.887 Vali Acc: 0.757 Test Loss: 0.887 Test Acc: 0.757
Validation loss decreased (-0.722535 --> -0.757217).  Saving model ...
Epoch: 4 cost time: 1.3390839099884033
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.928 Vali Acc: 0.798 Test Loss: 0.928 Test Acc: 0.798
Validation loss decreased (-0.757217 --> -0.797679).  Saving model ...
Epoch: 5 cost time: 1.3752026557922363
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
Validation loss decreased (-0.797679 --> -0.803462).  Saving model ...
Epoch: 6 cost time: 1.3871324062347412
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.106 Vali Acc: 0.769 Test Loss: 1.106 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3057434558868408
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.375 Vali Acc: 0.723 Test Loss: 1.375 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2572381496429443
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.146 Vali Acc: 0.780 Test Loss: 1.146 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4313485622406006
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.213 Vali Acc: 0.740 Test Loss: 1.213 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3528764247894287
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.715 Vali Acc: 0.803 Test Loss: 0.715 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3873662948608398
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.746 Test Loss: 1.300 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.598278284072876
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.128 Vali Acc: 0.769 Test Loss: 1.128 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6265578269958496
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.319 Vali Acc: 0.780 Test Loss: 1.319 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7042460441589355
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.423 Vali Acc: 0.723 Test Loss: 1.423 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.262585163116455
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.768 Vali Acc: 0.740 Test Loss: 1.768 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1158527
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.60737943649292
Epoch: 1, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.222 Vali Acc: 0.526 Test Loss: 1.222 Test Acc: 0.526
Validation loss decreased (inf --> -0.525999).  Saving model ...
Epoch: 2 cost time: 1.1604430675506592
Epoch: 2, Steps: 17 | Train Loss: 0.402 Vali Loss: 1.120 Vali Acc: 0.618 Test Loss: 1.120 Test Acc: 0.618
Validation loss decreased (-0.525999 --> -0.618486).  Saving model ...
Epoch: 3 cost time: 1.258279800415039
Epoch: 3, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.836 Vali Acc: 0.734 Test Loss: 0.836 Test Acc: 0.734
Validation loss decreased (-0.618486 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 1.3464264869689941
Epoch: 4, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.331 Vali Acc: 0.751 Test Loss: 1.331 Test Acc: 0.751
Validation loss decreased (-0.734096 --> -0.751432).  Saving model ...
Epoch: 5 cost time: 1.3912806510925293
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.535 Vali Acc: 0.734 Test Loss: 1.535 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2210032939910889
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.778 Vali Acc: 0.717 Test Loss: 1.778 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3529341220855713
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.922 Vali Acc: 0.711 Test Loss: 1.922 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.344465970993042
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.348 Vali Acc: 0.723 Test Loss: 1.348 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.161376714706421
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.036 Vali Acc: 0.705 Test Loss: 2.036 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4396111965179443
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.723 Test Loss: 2.131 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.427602767944336
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.917 Vali Acc: 0.671 Test Loss: 1.917 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2474029064178467
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.952 Vali Acc: 0.676 Test Loss: 1.952 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3549201488494873
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.845 Vali Acc: 0.711 Test Loss: 1.845 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2301244735717773
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.194 Vali Acc: 0.624 Test Loss: 3.194 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1158015
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7240140438079834
Epoch: 1, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.311 Vali Acc: 0.503 Test Loss: 1.311 Test Acc: 0.503
Validation loss decreased (inf --> -0.502877).  Saving model ...
Epoch: 2 cost time: 1.0095365047454834
Epoch: 2, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.883 Vali Acc: 0.740 Test Loss: 0.883 Test Acc: 0.740
Validation loss decreased (-0.502877 --> -0.739876).  Saving model ...
Epoch: 3 cost time: 1.22945237159729
Epoch: 3, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.902 Vali Acc: 0.751 Test Loss: 0.902 Test Acc: 0.751
Validation loss decreased (-0.739876 --> -0.751436).  Saving model ...
Epoch: 4 cost time: 1.367891788482666
Epoch: 4, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.775 Vali Acc: 0.786 Test Loss: 0.775 Test Acc: 0.786
Validation loss decreased (-0.751436 --> -0.786119).  Saving model ...
Epoch: 5 cost time: 1.1990993022918701
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.782 Vali Acc: 0.618 Test Loss: 1.782 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2257671356201172
Epoch: 6, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.602 Vali Acc: 0.624 Test Loss: 2.602 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.314934253692627
Epoch: 7, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.006 Vali Acc: 0.757 Test Loss: 1.006 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2219963073730469
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.769 Test Loss: 0.854 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.117581844329834
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.792 Test Loss: 0.671 Test Acc: 0.792
Validation loss decreased (-0.786119 --> -0.791901).  Saving model ...
Epoch: 10 cost time: 1.3287127017974854
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803462).  Saving model ...
Epoch: 11 cost time: 1.3260383605957031
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.792 Test Loss: 0.639 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1910631656646729
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.792 Test Loss: 0.644 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3189220428466797
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3241939544677734
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.792 Test Loss: 0.646 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3698711395263672
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.207453966140747
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.208463191986084
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.792 Test Loss: 0.646 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.221062183380127
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.792 Test Loss: 0.647 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1212801933288574
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2489700317382812
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1157503
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.512226104736328
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.313 Vali Acc: 0.474 Test Loss: 1.313 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 2.845008373260498
Epoch: 2, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.719 Vali Acc: 0.728 Test Loss: 0.719 Test Acc: 0.728
Validation loss decreased (-0.473975 --> -0.728317).  Saving model ...
Epoch: 3 cost time: 3.173518419265747
Epoch: 3, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.391 Vali Acc: 0.624 Test Loss: 1.391 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2586991786956787
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.141 Vali Acc: 0.746 Test Loss: 1.141 Test Acc: 0.746
Validation loss decreased (-0.728317 --> -0.745653).  Saving model ...
Epoch: 5 cost time: 3.2513763904571533
Epoch: 5, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.909 Vali Acc: 0.711 Test Loss: 1.909 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3432631492614746
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.812 Vali Acc: 0.723 Test Loss: 1.812 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8412094116210938
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.535 Vali Acc: 0.717 Test Loss: 1.535 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6892921924591064
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.823 Vali Acc: 0.711 Test Loss: 1.823 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9817988872528076
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.065 Vali Acc: 0.786 Test Loss: 1.065 Test Acc: 0.786
Validation loss decreased (-0.745653 --> -0.786117).  Saving model ...
Epoch: 10 cost time: 3.496964454650879
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.740 Test Loss: 1.390 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3098106384277344
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.399 Vali Acc: 0.717 Test Loss: 1.399 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.580230712890625
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.977 Vali Acc: 0.705 Test Loss: 1.977 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8961493968963623
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.369 Vali Acc: 0.740 Test Loss: 1.369 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.449815511703491
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.775 Test Loss: 1.140 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.825815200805664
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.763 Test Loss: 1.047 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.975337266921997
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.769 Test Loss: 1.034 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8139808177948
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.775 Test Loss: 1.036 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7154946327209473
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.424166679382324
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.786 Test Loss: 1.048 Test Acc: 0.786
Validation loss decreased (-0.786117 --> -0.786117).  Saving model ...
Epoch: 20 cost time: 2.5307841300964355
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.786 Test Loss: 1.052 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2740535736083984
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.792 Test Loss: 1.056 Test Acc: 0.792
Validation loss decreased (-0.786117 --> -0.791897).  Saving model ...
Epoch: 22 cost time: 3.2198636531829834
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.786 Test Loss: 1.058 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.474151611328125
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.786 Test Loss: 1.060 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0564236640930176
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.786 Test Loss: 1.062 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.504274845123291
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.786 Test Loss: 1.064 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2072954177856445
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.786 Test Loss: 1.067 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.968588352203369
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.786 Test Loss: 1.068 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.549560308456421
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.786 Test Loss: 1.070 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.030031681060791
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.786 Test Loss: 1.071 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.6008334159851074
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.786 Test Loss: 1.072 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.4470314979553223
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.786 Test Loss: 1.072 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1150791
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.472562789916992
Epoch: 1, Steps: 17 | Train Loss: 1.754 Vali Loss: 1.252 Vali Acc: 0.468 Test Loss: 1.252 Test Acc: 0.468
Validation loss decreased (inf --> -0.468196).  Saving model ...
Epoch: 2 cost time: 2.8314225673675537
Epoch: 2, Steps: 17 | Train Loss: 0.471 Vali Loss: 1.355 Vali Acc: 0.578 Test Loss: 1.355 Test Acc: 0.578
Validation loss decreased (-0.468196 --> -0.578021).  Saving model ...
Epoch: 3 cost time: 2.6673085689544678
Epoch: 3, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.791 Vali Acc: 0.728 Test Loss: 0.791 Test Acc: 0.728
Validation loss decreased (-0.578021 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.4989657402038574
Epoch: 4, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.187 Vali Acc: 0.694 Test Loss: 1.187 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5036003589630127
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.599 Vali Acc: 0.688 Test Loss: 1.599 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4963810443878174
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.484 Vali Acc: 0.746 Test Loss: 1.484 Test Acc: 0.746
Validation loss decreased (-0.728316 --> -0.745650).  Saving model ...
Epoch: 7 cost time: 2.678544521331787
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.064 Vali Acc: 0.705 Test Loss: 2.064 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1164352893829346
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.220 Vali Acc: 0.723 Test Loss: 2.220 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2200284004211426
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 2.484 Vali Acc: 0.705 Test Loss: 2.484 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4334428310394287
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.724 Vali Acc: 0.653 Test Loss: 2.724 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4497838020324707
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.553 Vali Acc: 0.717 Test Loss: 2.553 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.917323589324951
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.273 Vali Acc: 0.751 Test Loss: 2.273 Test Acc: 0.751
Validation loss decreased (-0.745650 --> -0.751422).  Saving model ...
Epoch: 13 cost time: 2.9646801948547363
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.764 Vali Acc: 0.769 Test Loss: 1.764 Test Acc: 0.769
Validation loss decreased (-0.751422 --> -0.768768).  Saving model ...
Epoch: 14 cost time: 2.9583041667938232
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.104 Vali Acc: 0.746 Test Loss: 2.104 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.348349094390869
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.951 Vali Acc: 0.734 Test Loss: 1.951 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9586141109466553
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.746 Test Loss: 2.090 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.207845687866211
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.184 Vali Acc: 0.746 Test Loss: 2.184 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.136409282684326
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.740 Test Loss: 2.131 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9266879558563232
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.740 Test Loss: 2.098 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7649765014648438
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.728 Test Loss: 2.075 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4440267086029053
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.060 Vali Acc: 0.728 Test Loss: 2.060 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5672402381896973
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.046 Vali Acc: 0.728 Test Loss: 2.046 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.532675266265869
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.033 Vali Acc: 0.728 Test Loss: 2.033 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1149255
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4676826000213623
Epoch: 1, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.110 Vali Acc: 0.590 Test Loss: 1.110 Test Acc: 0.590
Validation loss decreased (inf --> -0.589584).  Saving model ...
Epoch: 2 cost time: 2.3300609588623047
Epoch: 2, Steps: 17 | Train Loss: 0.430 Vali Loss: 1.222 Vali Acc: 0.601 Test Loss: 1.222 Test Acc: 0.601
Validation loss decreased (-0.589584 --> -0.601144).  Saving model ...
Epoch: 3 cost time: 2.851410150527954
Epoch: 3, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.132 Vali Acc: 0.659 Test Loss: 1.132 Test Acc: 0.659
Validation loss decreased (-0.601144 --> -0.658948).  Saving model ...
Epoch: 4 cost time: 2.5597829818725586
Epoch: 4, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.160 Vali Acc: 0.688 Test Loss: 1.160 Test Acc: 0.688
Validation loss decreased (-0.658948 --> -0.687850).  Saving model ...
Epoch: 5 cost time: 2.1574223041534424
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.874 Vali Acc: 0.746 Test Loss: 0.874 Test Acc: 0.746
Validation loss decreased (-0.687850 --> -0.745656).  Saving model ...
Epoch: 6 cost time: 2.2553353309631348
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.296 Vali Acc: 0.671 Test Loss: 1.296 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1310830116271973
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.715 Vali Acc: 0.682 Test Loss: 1.715 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4025819301605225
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.854 Vali Acc: 0.699 Test Loss: 1.854 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2052111625671387
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 3.134 Vali Acc: 0.665 Test Loss: 3.134 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1826653480529785
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.299 Vali Acc: 0.723 Test Loss: 1.299 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.102778911590576
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.282 Vali Acc: 0.728 Test Loss: 1.282 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5775859355926514
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.310 Vali Acc: 0.711 Test Loss: 1.310 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4806511402130127
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.688 Vali Acc: 0.728 Test Loss: 1.688 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.690950393676758
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.717 Test Loss: 1.957 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7220427989959717
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.705 Test Loss: 1.964 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 1147207
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9680497646331787
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.261 Vali Acc: 0.526 Test Loss: 1.261 Test Acc: 0.526
Validation loss decreased (inf --> -0.525999).  Saving model ...
Epoch: 2 cost time: 1.914128065109253
Epoch: 2, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.893 Vali Acc: 0.653 Test Loss: 0.893 Test Acc: 0.653
Validation loss decreased (-0.525999 --> -0.653170).  Saving model ...
Epoch: 3 cost time: 2.1094233989715576
Epoch: 3, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.849 Vali Acc: 0.728 Test Loss: 0.849 Test Acc: 0.728
Validation loss decreased (-0.653170 --> -0.728315).  Saving model ...
Epoch: 4 cost time: 2.07346773147583
Epoch: 4, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.452 Vali Acc: 0.711 Test Loss: 1.452 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0801401138305664
Epoch: 5, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.496 Vali Acc: 0.734 Test Loss: 1.496 Test Acc: 0.734
Validation loss decreased (-0.728315 --> -0.734089).  Saving model ...
Epoch: 6 cost time: 1.8577542304992676
Epoch: 6, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.820 Vali Acc: 0.682 Test Loss: 1.820 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.060685634613037
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.368 Vali Acc: 0.676 Test Loss: 1.368 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0271799564361572
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.680 Vali Acc: 0.740 Test Loss: 1.680 Test Acc: 0.740
Validation loss decreased (-0.734089 --> -0.739868).  Saving model ...
Epoch: 9 cost time: 1.5696275234222412
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.260 Vali Acc: 0.757 Test Loss: 1.260 Test Acc: 0.757
Validation loss decreased (-0.739868 --> -0.757213).  Saving model ...
Epoch: 10 cost time: 1.8728008270263672
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.405 Vali Acc: 0.746 Test Loss: 1.405 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6818864345550537
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.627 Vali Acc: 0.705 Test Loss: 1.627 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.264716148376465
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.042 Vali Acc: 0.653 Test Loss: 2.042 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3675308227539062
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.122 Vali Acc: 0.699 Test Loss: 2.122 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.372298240661621
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 3.369 Vali Acc: 0.717 Test Loss: 3.369 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.279256582260132
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.574 Vali Acc: 0.705 Test Loss: 2.574 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0633983612060547
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.563 Vali Acc: 0.682 Test Loss: 3.563 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4507253170013428
Epoch: 17, Steps: 17 | Train Loss: 0.174 Vali Loss: 3.884 Vali Acc: 0.694 Test Loss: 3.884 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4058680534362793
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.864 Vali Acc: 0.751 Test Loss: 2.864 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.402855634689331
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.865 Vali Acc: 0.740 Test Loss: 2.865 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1145671
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6396937370300293
Epoch: 1, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.107 Vali Acc: 0.543 Test Loss: 1.107 Test Acc: 0.543
Validation loss decreased (inf --> -0.543342).  Saving model ...
Epoch: 2 cost time: 1.3321053981781006
Epoch: 2, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.938 Vali Acc: 0.636 Test Loss: 0.938 Test Acc: 0.636
Validation loss decreased (-0.543342 --> -0.635829).  Saving model ...
Epoch: 3 cost time: 1.650146722793579
Epoch: 3, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.334 Vali Acc: 0.694 Test Loss: 1.334 Test Acc: 0.694
Validation loss decreased (-0.635829 --> -0.693628).  Saving model ...
Epoch: 4 cost time: 1.6416492462158203
Epoch: 4, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.773 Vali Acc: 0.740 Test Loss: 0.773 Test Acc: 0.740
Validation loss decreased (-0.693628 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 1.6410372257232666
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.116 Vali Acc: 0.723 Test Loss: 1.116 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8962302207946777
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.732 Vali Acc: 0.688 Test Loss: 1.732 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7771565914154053
Epoch: 7, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.270 Vali Acc: 0.694 Test Loss: 1.270 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0711374282836914
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.326 Vali Acc: 0.705 Test Loss: 1.326 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8416650295257568
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.283 Vali Acc: 0.717 Test Loss: 1.283 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9128360748291016
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.711 Test Loss: 1.074 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8118085861206055
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.746 Test Loss: 1.302 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745652).  Saving model ...
Epoch: 12 cost time: 1.94956636428833
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.740 Test Loss: 1.211 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.444605827331543
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.740 Test Loss: 1.170 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8806276321411133
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.734 Test Loss: 1.143 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0625972747802734
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.734 Test Loss: 1.125 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0199387073516846
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.734 Test Loss: 1.110 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9771907329559326
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.734 Test Loss: 1.099 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.905104637145996
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.734 Test Loss: 1.090 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6829462051391602
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.734 Test Loss: 1.082 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8407807350158691
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.076 Vali Acc: 0.734 Test Loss: 1.076 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9880247116088867
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.734 Test Loss: 1.070 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 1144135
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.999545097351074
Epoch: 1, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.139 Vali Acc: 0.503 Test Loss: 1.139 Test Acc: 0.503
Validation loss decreased (inf --> -0.502879).  Saving model ...
Epoch: 2 cost time: 1.4405179023742676
Epoch: 2, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.923 Vali Acc: 0.653 Test Loss: 0.923 Test Acc: 0.653
Validation loss decreased (-0.502879 --> -0.653170).  Saving model ...
Epoch: 3 cost time: 1.6947932243347168
Epoch: 3, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.126 Vali Acc: 0.682 Test Loss: 1.126 Test Acc: 0.682
Validation loss decreased (-0.653170 --> -0.682070).  Saving model ...
Epoch: 4 cost time: 1.4968605041503906
Epoch: 4, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
Validation loss decreased (-0.682070 --> -0.774559).  Saving model ...
Epoch: 5 cost time: 1.548154354095459
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.938 Vali Acc: 0.751 Test Loss: 0.938 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5233020782470703
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.016 Vali Acc: 0.798 Test Loss: 1.016 Test Acc: 0.798
Validation loss decreased (-0.774559 --> -0.797678).  Saving model ...
Epoch: 7 cost time: 1.6013100147247314
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.746 Test Loss: 1.068 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5100650787353516
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.137 Vali Acc: 0.734 Test Loss: 1.137 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.509178876876831
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.590 Vali Acc: 0.682 Test Loss: 1.590 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4365019798278809
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.604 Vali Acc: 0.728 Test Loss: 1.604 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.41703462600708
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.961 Vali Acc: 0.734 Test Loss: 0.961 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4460408687591553
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.033 Vali Acc: 0.746 Test Loss: 1.033 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5429365634918213
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.945 Vali Acc: 0.699 Test Loss: 1.945 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5798096656799316
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.355 Vali Acc: 0.763 Test Loss: 1.355 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6209540367126465
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.649 Vali Acc: 0.688 Test Loss: 2.649 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.696995496749878
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.366 Vali Acc: 0.717 Test Loss: 2.366 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1143111
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6159346103668213
Epoch: 1, Steps: 17 | Train Loss: 1.708 Vali Loss: 1.401 Vali Acc: 0.480 Test Loss: 1.401 Test Acc: 0.480
Validation loss decreased (inf --> -0.479755).  Saving model ...
Epoch: 2 cost time: 1.280040979385376
Epoch: 2, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.845 Vali Acc: 0.723 Test Loss: 0.845 Test Acc: 0.723
Validation loss decreased (-0.479755 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.4962024688720703
Epoch: 3, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.227 Vali Acc: 0.653 Test Loss: 1.227 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4503791332244873
Epoch: 4, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.856 Vali Acc: 0.769 Test Loss: 0.856 Test Acc: 0.769
Validation loss decreased (-0.722535 --> -0.768778).  Saving model ...
Epoch: 5 cost time: 1.40238618850708
Epoch: 5, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.840 Vali Acc: 0.642 Test Loss: 1.840 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5238661766052246
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.929 Vali Acc: 0.769 Test Loss: 0.929 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.458556890487671
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.956 Vali Acc: 0.676 Test Loss: 1.956 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5386805534362793
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.208 Vali Acc: 0.740 Test Loss: 1.208 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4940993785858154
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.746 Test Loss: 1.255 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3418302536010742
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.275 Vali Acc: 0.780 Test Loss: 1.275 Test Acc: 0.780
Validation loss decreased (-0.768778 --> -0.780334).  Saving model ...
Epoch: 11 cost time: 1.5875771045684814
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.098 Vali Acc: 0.769 Test Loss: 1.098 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5048327445983887
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.757 Test Loss: 1.258 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3933329582214355
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.757 Test Loss: 1.148 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.503680944442749
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.757 Test Loss: 1.108 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3813831806182861
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.757 Test Loss: 1.150 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2899813652038574
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.746 Test Loss: 1.144 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3705151081085205
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.746 Test Loss: 1.127 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3662083148956299
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.751 Test Loss: 1.113 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3514838218688965
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.763 Test Loss: 1.102 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.258528709411621
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.763 Test Loss: 1.091 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1142599
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.2563037872314453
Epoch: 1, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.307 Vali Acc: 0.543 Test Loss: 1.307 Test Acc: 0.543
Validation loss decreased (inf --> -0.543340).  Saving model ...
Epoch: 2 cost time: 1.3409345149993896
Epoch: 2, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.813 Vali Acc: 0.746 Test Loss: 0.813 Test Acc: 0.746
Validation loss decreased (-0.543340 --> -0.745657).  Saving model ...
Epoch: 3 cost time: 1.2449846267700195
Epoch: 3, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.701 Vali Acc: 0.676 Test Loss: 1.701 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2780654430389404
Epoch: 4, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.157 Vali Acc: 0.728 Test Loss: 1.157 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2184770107269287
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.448 Vali Acc: 0.705 Test Loss: 1.448 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1392982006072998
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.656 Vali Acc: 0.694 Test Loss: 1.656 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.275796890258789
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.315 Vali Acc: 0.728 Test Loss: 1.315 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3461298942565918
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.466 Vali Acc: 0.711 Test Loss: 1.466 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3831279277801514
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.148 Vali Acc: 0.694 Test Loss: 2.148 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4247515201568604
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.181 Vali Acc: 0.763 Test Loss: 1.181 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762994).  Saving model ...
Epoch: 11 cost time: 1.3534557819366455
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.746 Vali Acc: 0.734 Test Loss: 1.746 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2803847789764404
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.770 Vali Acc: 0.792 Test Loss: 1.770 Test Acc: 0.792
Validation loss decreased (-0.762994 --> -0.791890).  Saving model ...
Epoch: 13 cost time: 1.4222965240478516
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.265 Vali Acc: 0.740 Test Loss: 2.265 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3946309089660645
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.663 Vali Acc: 0.694 Test Loss: 2.663 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3890001773834229
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.900 Vali Acc: 0.763 Test Loss: 1.900 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4589476585388184
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.242 Vali Acc: 0.751 Test Loss: 2.242 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2612245082855225
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.051 Vali Acc: 0.740 Test Loss: 2.051 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.358924150466919
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.946 Vali Acc: 0.746 Test Loss: 1.946 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.374572992324829
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.740 Test Loss: 1.929 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4823825359344482
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.740 Test Loss: 1.919 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3619589805603027
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.740 Test Loss: 1.913 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4686622619628906
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.740 Test Loss: 1.908 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1142087
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8012988567352295
Epoch: 1, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.536 Vali Acc: 0.451 Test Loss: 1.536 Test Acc: 0.451
Validation loss decreased (inf --> -0.450852).  Saving model ...
Epoch: 2 cost time: 2.4327163696289062
Epoch: 2, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.866 Vali Acc: 0.659 Test Loss: 0.866 Test Acc: 0.659
Validation loss decreased (-0.450852 --> -0.658951).  Saving model ...
Epoch: 3 cost time: 2.3752801418304443
Epoch: 3, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.179 Vali Acc: 0.647 Test Loss: 1.179 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4456541538238525
Epoch: 4, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.775 Vali Acc: 0.751 Test Loss: 0.775 Test Acc: 0.751
Validation loss decreased (-0.658951 --> -0.751437).  Saving model ...
Epoch: 5 cost time: 2.798752546310425
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.913 Vali Acc: 0.740 Test Loss: 0.913 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.336463451385498
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.437 Vali Acc: 0.728 Test Loss: 1.437 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.18620228767395
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.637 Vali Acc: 0.682 Test Loss: 1.637 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1284120082855225
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.604 Vali Acc: 0.769 Test Loss: 1.604 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768770).  Saving model ...
Epoch: 9 cost time: 3.066131353378296
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.333 Vali Acc: 0.711 Test Loss: 2.333 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.743492364883423
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.780 Vali Acc: 0.746 Test Loss: 1.780 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7806384563446045
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.780 Test Loss: 1.324 Test Acc: 0.780
Validation loss decreased (-0.768770 --> -0.780334).  Saving model ...
Epoch: 12 cost time: 3.440737009048462
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.792 Test Loss: 1.274 Test Acc: 0.792
Validation loss decreased (-0.780334 --> -0.791895).  Saving model ...
Epoch: 13 cost time: 3.283080577850342
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.786 Test Loss: 1.283 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5140767097473145
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.786 Test Loss: 1.285 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.783926248550415
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.786 Test Loss: 1.284 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.427122116088867
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.786 Test Loss: 1.283 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5380828380584717
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.786 Test Loss: 1.283 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.6730120182037354
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.786 Test Loss: 1.281 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.496856689453125
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.786 Test Loss: 1.279 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4874050617218018
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.786 Test Loss: 1.278 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.235243082046509
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.786 Test Loss: 1.276 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.223043441772461
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.775 Test Loss: 1.274 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1143083
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.2251317501068115
Epoch: 1, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.428 Vali Acc: 0.445 Test Loss: 1.428 Test Acc: 0.445
Validation loss decreased (inf --> -0.445072).  Saving model ...
Epoch: 2 cost time: 3.0128839015960693
Epoch: 2, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.962 Vali Acc: 0.630 Test Loss: 0.962 Test Acc: 0.630
Validation loss decreased (-0.445072 --> -0.630048).  Saving model ...
Epoch: 3 cost time: 2.946955680847168
Epoch: 3, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.842 Vali Acc: 0.728 Test Loss: 0.842 Test Acc: 0.728
Validation loss decreased (-0.630048 --> -0.728315).  Saving model ...
Epoch: 4 cost time: 2.812697649002075
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.056 Vali Acc: 0.746 Test Loss: 1.056 Test Acc: 0.746
Validation loss decreased (-0.728315 --> -0.745654).  Saving model ...
Epoch: 5 cost time: 2.8035690784454346
Epoch: 5, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.875 Vali Acc: 0.815 Test Loss: 0.875 Test Acc: 0.815
Validation loss decreased (-0.745654 --> -0.815020).  Saving model ...
Epoch: 6 cost time: 2.890998601913452
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.246 Vali Acc: 0.751 Test Loss: 1.246 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.81895112991333
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.304 Vali Acc: 0.699 Test Loss: 1.304 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.916450023651123
Epoch: 8, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.344 Vali Acc: 0.676 Test Loss: 2.344 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0679104328155518
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 2.162 Vali Acc: 0.659 Test Loss: 2.162 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9347245693206787
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 2.933 Vali Acc: 0.647 Test Loss: 2.933 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8165946006774902
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.753 Vali Acc: 0.780 Test Loss: 1.753 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8140721321105957
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.746 Vali Acc: 0.734 Test Loss: 1.746 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7601404190063477
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.740 Test Loss: 1.654 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.520350456237793
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.734 Test Loss: 1.853 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0467779636383057
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.337 Vali Acc: 0.671 Test Loss: 3.337 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1141547
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.889895439147949
Epoch: 1, Steps: 17 | Train Loss: 1.823 Vali Loss: 1.709 Vali Acc: 0.405 Test Loss: 1.709 Test Acc: 0.405
Validation loss decreased (inf --> -0.404607).  Saving model ...
Epoch: 2 cost time: 2.5313990116119385
Epoch: 2, Steps: 17 | Train Loss: 0.797 Vali Loss: 1.206 Vali Acc: 0.590 Test Loss: 1.206 Test Acc: 0.590
Validation loss decreased (-0.404607 --> -0.589583).  Saving model ...
Epoch: 3 cost time: 2.471269369125366
Epoch: 3, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.982 Vali Acc: 0.723 Test Loss: 0.982 Test Acc: 0.723
Validation loss decreased (-0.589583 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 2.3883891105651855
Epoch: 4, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.844 Vali Acc: 0.659 Test Loss: 1.844 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.412245750427246
Epoch: 5, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.862 Vali Acc: 0.746 Test Loss: 0.862 Test Acc: 0.746
Validation loss decreased (-0.722534 --> -0.745656).  Saving model ...
Epoch: 6 cost time: 2.263667583465576
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.057354211807251
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.211 Vali Acc: 0.728 Test Loss: 1.211 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3879430294036865
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.110 Vali Acc: 0.717 Test Loss: 1.110 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2963194847106934
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.021 Vali Acc: 0.728 Test Loss: 1.021 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3566436767578125
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.596 Vali Acc: 0.723 Test Loss: 1.596 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.187072277069092
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.025 Vali Acc: 0.734 Test Loss: 1.025 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.239377975463867
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.699 Test Loss: 1.305 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2771952152252197
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.259 Vali Acc: 0.711 Test Loss: 1.259 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.989511489868164
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.699 Test Loss: 1.181 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.473613977432251
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.156 Vali Acc: 0.705 Test Loss: 1.156 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 1139499
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0228066444396973
Epoch: 1, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.084 Vali Acc: 0.532 Test Loss: 1.084 Test Acc: 0.532
Validation loss decreased (inf --> -0.531781).  Saving model ...
Epoch: 2 cost time: 2.130885601043701
Epoch: 2, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.303 Vali Acc: 0.613 Test Loss: 1.303 Test Acc: 0.613
Validation loss decreased (-0.531781 --> -0.612704).  Saving model ...
Epoch: 3 cost time: 2.0172479152679443
Epoch: 3, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.943 Vali Acc: 0.734 Test Loss: 0.943 Test Acc: 0.734
Validation loss decreased (-0.612704 --> -0.734095).  Saving model ...
Epoch: 4 cost time: 2.245609998703003
Epoch: 4, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.105 Vali Acc: 0.717 Test Loss: 1.105 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.206763982772827
Epoch: 5, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.759 Vali Acc: 0.786 Test Loss: 0.759 Test Acc: 0.786
Validation loss decreased (-0.734095 --> -0.786120).  Saving model ...
Epoch: 6 cost time: 2.1250088214874268
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0642285346984863
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.191 Vali Acc: 0.734 Test Loss: 1.191 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2938873767852783
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.055 Vali Acc: 0.694 Test Loss: 1.055 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.419250249862671
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.738 Vali Acc: 0.676 Test Loss: 1.738 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3289029598236084
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.218 Vali Acc: 0.740 Test Loss: 1.218 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.36234188079834
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.723 Test Loss: 1.468 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3900697231292725
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.342 Vali Acc: 0.757 Test Loss: 1.342 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3839850425720215
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.200 Vali Acc: 0.757 Test Loss: 1.200 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.384756088256836
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.563 Vali Acc: 0.717 Test Loss: 1.563 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.150451898574829
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.763 Test Loss: 1.415 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1137963
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6598899364471436
Epoch: 1, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.386 Vali Acc: 0.491 Test Loss: 1.386 Test Acc: 0.491
Validation loss decreased (inf --> -0.491316).  Saving model ...
Epoch: 2 cost time: 1.6869723796844482
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.129 Vali Acc: 0.566 Test Loss: 1.129 Test Acc: 0.566
Validation loss decreased (-0.491316 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 1.7626724243164062
Epoch: 3, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.135 Vali Acc: 0.694 Test Loss: 1.135 Test Acc: 0.694
Validation loss decreased (-0.566463 --> -0.693630).  Saving model ...
Epoch: 4 cost time: 1.7265641689300537
Epoch: 4, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.711 Vali Acc: 0.786 Test Loss: 0.711 Test Acc: 0.786
Validation loss decreased (-0.693630 --> -0.786120).  Saving model ...
Epoch: 5 cost time: 1.7963998317718506
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.464 Vali Acc: 0.694 Test Loss: 1.464 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7185356616973877
Epoch: 6, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.274 Vali Acc: 0.699 Test Loss: 1.274 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9381418228149414
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.656 Vali Acc: 0.682 Test Loss: 1.656 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9115204811096191
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.886 Vali Acc: 0.694 Test Loss: 1.886 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5479958057403564
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.495 Vali Acc: 0.734 Test Loss: 1.495 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4577741622924805
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.671 Test Loss: 1.673 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5063450336456299
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.119 Vali Acc: 0.711 Test Loss: 2.119 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5617733001708984
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.455 Vali Acc: 0.746 Test Loss: 1.455 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.539846420288086
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.723 Test Loss: 1.530 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6493513584136963
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.746 Test Loss: 1.361 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1136427
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.943783760070801
Epoch: 1, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.210 Vali Acc: 0.538 Test Loss: 1.210 Test Acc: 0.538
Validation loss decreased (inf --> -0.537560).  Saving model ...
Epoch: 2 cost time: 1.5052587985992432
Epoch: 2, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.768 Vali Acc: 0.699 Test Loss: 0.768 Test Acc: 0.699
Validation loss decreased (-0.537560 --> -0.699414).  Saving model ...
Epoch: 3 cost time: 1.5545525550842285
Epoch: 3, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.178 Vali Acc: 0.694 Test Loss: 1.178 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.482579231262207
Epoch: 4, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.110 Vali Acc: 0.717 Test Loss: 1.110 Test Acc: 0.717
Validation loss decreased (-0.699414 --> -0.716752).  Saving model ...
Epoch: 5 cost time: 1.3710777759552002
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.056 Vali Acc: 0.734 Test Loss: 1.056 Test Acc: 0.734
Validation loss decreased (-0.716752 --> -0.734093).  Saving model ...
Epoch: 6 cost time: 1.6488327980041504
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.839 Vali Acc: 0.665 Test Loss: 1.839 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5862541198730469
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.784 Vali Acc: 0.780 Test Loss: 0.784 Test Acc: 0.780
Validation loss decreased (-0.734093 --> -0.780339).  Saving model ...
Epoch: 8 cost time: 1.5038492679595947
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.968 Vali Acc: 0.751 Test Loss: 0.968 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6450059413909912
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.799 Vali Acc: 0.757 Test Loss: 0.799 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.425405502319336
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.746 Test Loss: 1.328 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3843493461608887
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.717 Test Loss: 1.470 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3671603202819824
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.723 Test Loss: 1.456 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5730133056640625
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.728 Test Loss: 1.431 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5017740726470947
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.728 Test Loss: 1.421 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5252785682678223
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.734 Test Loss: 1.413 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5457968711853027
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.734 Test Loss: 1.412 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4159529209136963
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.410 Vali Acc: 0.734 Test Loss: 1.410 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1135403
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6527462005615234
Epoch: 1, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.357 Vali Acc: 0.509 Test Loss: 1.357 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 1.3231613636016846
Epoch: 2, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.803 Vali Acc: 0.694 Test Loss: 0.803 Test Acc: 0.694
Validation loss decreased (-0.508657 --> -0.693634).  Saving model ...
Epoch: 3 cost time: 1.328918218612671
Epoch: 3, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.804 Vali Acc: 0.757 Test Loss: 0.804 Test Acc: 0.757
Validation loss decreased (-0.693634 --> -0.757217).  Saving model ...
Epoch: 4 cost time: 1.5608487129211426
Epoch: 4, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.267 Vali Acc: 0.705 Test Loss: 1.267 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.216113805770874
Epoch: 5, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.349 Vali Acc: 0.682 Test Loss: 1.349 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4193613529205322
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.248 Vali Acc: 0.682 Test Loss: 1.248 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3725128173828125
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.139 Vali Acc: 0.723 Test Loss: 1.139 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3363966941833496
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.265 Vali Acc: 0.705 Test Loss: 1.265 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4795849323272705
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.728 Test Loss: 1.208 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4704618453979492
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.734 Test Loss: 1.220 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.326822280883789
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.734 Test Loss: 1.194 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.597135066986084
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.746 Test Loss: 1.173 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2689476013183594
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.746 Test Loss: 1.153 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1134891
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.502331018447876
Epoch: 1, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.325 Vali Acc: 0.439 Test Loss: 1.325 Test Acc: 0.439
Validation loss decreased (inf --> -0.439293).  Saving model ...
Epoch: 2 cost time: 1.3625164031982422
Epoch: 2, Steps: 17 | Train Loss: 0.515 Vali Loss: 1.109 Vali Acc: 0.590 Test Loss: 1.109 Test Acc: 0.590
Validation loss decreased (-0.439293 --> -0.589584).  Saving model ...
Epoch: 3 cost time: 1.3145461082458496
Epoch: 3, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.000 Vali Acc: 0.705 Test Loss: 1.000 Test Acc: 0.705
Validation loss decreased (-0.589584 --> -0.705192).  Saving model ...
Epoch: 4 cost time: 1.203381061553955
Epoch: 4, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.270 Vali Acc: 0.711 Test Loss: 1.270 Test Acc: 0.711
Validation loss decreased (-0.705192 --> -0.710970).  Saving model ...
Epoch: 5 cost time: 1.2006797790527344
Epoch: 5, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.772 Vali Acc: 0.798 Test Loss: 0.772 Test Acc: 0.798
Validation loss decreased (-0.710970 --> -0.797680).  Saving model ...
Epoch: 6 cost time: 1.1095964908599854
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.086 Vali Acc: 0.740 Test Loss: 1.086 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1325101852416992
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.399 Vali Acc: 0.676 Test Loss: 2.399 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.039050579071045
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 2.104 Vali Acc: 0.705 Test Loss: 2.104 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2364091873168945
Epoch: 9, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.133 Vali Acc: 0.734 Test Loss: 1.133 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.120882272720337
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.392 Vali Acc: 0.746 Test Loss: 1.392 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0815887451171875
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.430 Vali Acc: 0.769 Test Loss: 1.430 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1380646228790283
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.740 Test Loss: 1.665 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2003693580627441
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.769 Test Loss: 1.471 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1231019496917725
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.734 Test Loss: 1.189 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2510662078857422
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.145 Vali Acc: 0.740 Test Loss: 1.145 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1134379
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.243818521499634
Epoch: 1, Steps: 17 | Train Loss: 1.626 Vali Loss: 0.996 Vali Acc: 0.647 Test Loss: 0.996 Test Acc: 0.647
Validation loss decreased (inf --> -0.647389).  Saving model ...
Epoch: 2 cost time: 2.9582321643829346
Epoch: 2, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.616 Vali Acc: 0.780 Test Loss: 0.616 Test Acc: 0.780
Validation loss decreased (-0.647389 --> -0.780341).  Saving model ...
Epoch: 3 cost time: 3.2202982902526855
Epoch: 3, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.01351261138916
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.845426321029663
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
Validation loss decreased (-0.780341 --> -0.809242).  Saving model ...
Epoch: 6 cost time: 3.1001498699188232
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.815 Test Loss: 0.635 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815023).  Saving model ...
Epoch: 7 cost time: 3.214282989501953
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.13938045501709
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.798 Test Loss: 0.632 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.672086715698242
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1548519134521484
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.2272651195526123
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.786 Test Loss: 0.636 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1628100872039795
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.786 Test Loss: 0.640 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.675987958908081
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.786 Test Loss: 0.641 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.240391492843628
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.786 Test Loss: 0.642 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1796176433563232
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.786 Test Loss: 0.644 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7158236503601074
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.786 Test Loss: 0.648 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1133449
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8512115478515625
Epoch: 1, Steps: 17 | Train Loss: 1.662 Vali Loss: 1.060 Vali Acc: 0.613 Test Loss: 1.060 Test Acc: 0.613
Validation loss decreased (inf --> -0.612706).  Saving model ...
Epoch: 2 cost time: 2.703568458557129
Epoch: 2, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.849 Vali Acc: 0.728 Test Loss: 0.849 Test Acc: 0.728
Validation loss decreased (-0.612706 --> -0.728315).  Saving model ...
Epoch: 3 cost time: 2.6947171688079834
Epoch: 3, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.812 Vali Acc: 0.792 Test Loss: 0.812 Test Acc: 0.792
Validation loss decreased (-0.728315 --> -0.791899).  Saving model ...
Epoch: 4 cost time: 2.6134886741638184
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.914 Vali Acc: 0.723 Test Loss: 0.914 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.792354106903076
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.236 Vali Acc: 0.717 Test Loss: 1.236 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4790291786193848
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.734 Test Loss: 0.841 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.311424970626831
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.723 Test Loss: 0.820 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.609523296356201
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.746 Test Loss: 0.778 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5586345195770264
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.757 Test Loss: 0.757 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4783313274383545
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.746 Test Loss: 0.747 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.264601469039917
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.763 Test Loss: 0.741 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.524116039276123
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.769 Test Loss: 0.737 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.441710948944092
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.769 Test Loss: 0.733 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1131913
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5836122035980225
Epoch: 1, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
Validation loss decreased (inf --> -0.520220).  Saving model ...
Epoch: 2 cost time: 2.2548961639404297
Epoch: 2, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.668 Vali Acc: 0.757 Test Loss: 0.668 Test Acc: 0.757
Validation loss decreased (-0.520220 --> -0.757219).  Saving model ...
Epoch: 3 cost time: 1.953364372253418
Epoch: 3, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.724 Vali Acc: 0.740 Test Loss: 0.724 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2085795402526855
Epoch: 4, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.746 Test Loss: 0.738 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3223159313201904
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.740 Test Loss: 0.742 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2974839210510254
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.757 Test Loss: 0.759 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.290238618850708
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.780 Test Loss: 0.738 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780339).  Saving model ...
Epoch: 8 cost time: 2.008641481399536
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.786 Test Loss: 0.728 Test Acc: 0.786
Validation loss decreased (-0.780339 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.2710354328155518
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.786 Test Loss: 0.723 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 10 cost time: 2.211549758911133
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.786 Test Loss: 0.717 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 11 cost time: 2.0717999935150146
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.786 Test Loss: 0.712 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 12 cost time: 2.271315574645996
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2284109592437744
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.26273775100708
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.336228370666504
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.786 Test Loss: 0.704 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 16 cost time: 1.7014901638031006
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.786 Test Loss: 0.701 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 17 cost time: 1.6293001174926758
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.786 Test Loss: 0.699 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 18 cost time: 1.6574242115020752
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7556777000427246
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.775 Test Loss: 0.698 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.853055477142334
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8277482986450195
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.852583885192871
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.851867914199829
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8320579528808594
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.763 Test Loss: 0.694 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8356468677520752
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.763 Test Loss: 0.692 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9078090190887451
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.757 Test Loss: 0.692 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.124393939971924
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1129865
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3211543560028076
Epoch: 1, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.295 Vali Acc: 0.514 Test Loss: 1.295 Test Acc: 0.514
Validation loss decreased (inf --> -0.514438).  Saving model ...
Epoch: 2 cost time: 1.712606430053711
Epoch: 2, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.940 Vali Acc: 0.751 Test Loss: 0.940 Test Acc: 0.751
Validation loss decreased (-0.514438 --> -0.751436).  Saving model ...
Epoch: 3 cost time: 1.7685647010803223
Epoch: 3, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.987 Vali Acc: 0.688 Test Loss: 0.987 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0083580017089844
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.875 Vali Acc: 0.763 Test Loss: 0.875 Test Acc: 0.763
Validation loss decreased (-0.751436 --> -0.762997).  Saving model ...
Epoch: 5 cost time: 1.9162094593048096
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.929 Vali Acc: 0.751 Test Loss: 0.929 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.052629232406616
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.746 Test Loss: 0.955 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.867908239364624
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.763 Test Loss: 1.093 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1934897899627686
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.746 Test Loss: 0.884 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0426735877990723
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.751 Test Loss: 0.877 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7966458797454834
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.751 Test Loss: 0.875 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9900844097137451
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.751 Test Loss: 0.880 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.332770586013794
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.751 Test Loss: 0.883 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1300034523010254
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.740 Test Loss: 0.885 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.02801513671875
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.740 Test Loss: 0.885 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1128329
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9405155181884766
Epoch: 1, Steps: 17 | Train Loss: 1.621 Vali Loss: 0.998 Vali Acc: 0.607 Test Loss: 0.998 Test Acc: 0.607
Validation loss decreased (inf --> -0.606926).  Saving model ...
Epoch: 2 cost time: 1.4226467609405518
Epoch: 2, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.932 Vali Acc: 0.751 Test Loss: 0.932 Test Acc: 0.751
Validation loss decreased (-0.606926 --> -0.751436).  Saving model ...
Epoch: 3 cost time: 1.8097829818725586
Epoch: 3, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.830 Vali Acc: 0.746 Test Loss: 0.830 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8368825912475586
Epoch: 4, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.143 Vali Acc: 0.740 Test Loss: 1.143 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.778092861175537
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.769 Test Loss: 0.734 Test Acc: 0.769
Validation loss decreased (-0.751436 --> -0.768779).  Saving model ...
Epoch: 6 cost time: 1.6926448345184326
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.740 Test Loss: 0.718 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7710473537445068
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.728 Test Loss: 1.006 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7954151630401611
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.699 Test Loss: 0.855 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.664682388305664
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.734 Test Loss: 0.809 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6948301792144775
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.757 Test Loss: 0.760 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7948663234710693
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.757 Test Loss: 0.761 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7311608791351318
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.757 Test Loss: 0.762 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.799095630645752
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.757 Test Loss: 0.768 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4664103984832764
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.757 Test Loss: 0.771 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7846312522888184
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.757 Test Loss: 0.772 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1126793
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4487972259521484
Epoch: 1, Steps: 17 | Train Loss: 1.710 Vali Loss: 1.156 Vali Acc: 0.526 Test Loss: 1.156 Test Acc: 0.526
Validation loss decreased (inf --> -0.526000).  Saving model ...
Epoch: 2 cost time: 1.3146991729736328
Epoch: 2, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.727 Vali Acc: 0.728 Test Loss: 0.727 Test Acc: 0.728
Validation loss decreased (-0.526000 --> -0.728316).  Saving model ...
Epoch: 3 cost time: 1.303116798400879
Epoch: 3, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.717 Vali Acc: 0.786 Test Loss: 0.717 Test Acc: 0.786
Validation loss decreased (-0.728316 --> -0.786120).  Saving model ...
Epoch: 4 cost time: 1.3442604541778564
Epoch: 4, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.757 Test Loss: 0.820 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3048186302185059
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.734 Test Loss: 0.824 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3374099731445312
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.740 Test Loss: 0.768 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2948524951934814
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.763 Test Loss: 0.744 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.345515251159668
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3024282455444336
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.775 Test Loss: 0.729 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4889066219329834
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.775 Test Loss: 0.724 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.595897912979126
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.775 Test Loss: 0.722 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3888976573944092
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5075006484985352
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1125769
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.386265754699707
Epoch: 1, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.196 Vali Acc: 0.526 Test Loss: 1.196 Test Acc: 0.526
Validation loss decreased (inf --> -0.526000).  Saving model ...
Epoch: 2 cost time: 1.4078617095947266
Epoch: 2, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.907 Vali Acc: 0.711 Test Loss: 0.907 Test Acc: 0.711
Validation loss decreased (-0.526000 --> -0.710974).  Saving model ...
Epoch: 3 cost time: 1.320608139038086
Epoch: 3, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.820 Vali Acc: 0.723 Test Loss: 0.820 Test Acc: 0.723
Validation loss decreased (-0.710974 --> -0.722535).  Saving model ...
Epoch: 4 cost time: 1.155735731124878
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.746 Test Loss: 0.851 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 1.149681568145752
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.792 Test Loss: 0.763 Test Acc: 0.792
Validation loss decreased (-0.745656 --> -0.791900).  Saving model ...
Epoch: 6 cost time: 1.1976056098937988
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.798 Test Loss: 0.713 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 1.2246735095977783
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.786 Test Loss: 0.710 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3135631084442139
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.786 Test Loss: 0.709 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2192506790161133
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.780 Test Loss: 0.710 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3270812034606934
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.780 Test Loss: 0.710 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2147984504699707
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.780 Test Loss: 0.711 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2667372226715088
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.780 Test Loss: 0.712 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2627673149108887
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.786 Test Loss: 0.712 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.393542766571045
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.786 Test Loss: 0.713 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.063713788986206
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.786 Test Loss: 0.712 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2186059951782227
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.786 Test Loss: 0.713 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1125257
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6557393074035645
Epoch: 1, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.120 Vali Acc: 0.566 Test Loss: 1.120 Test Acc: 0.566
Validation loss decreased (inf --> -0.566463).  Saving model ...
Epoch: 2 cost time: 1.0290477275848389
Epoch: 2, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.772 Vali Acc: 0.671 Test Loss: 0.772 Test Acc: 0.671
Validation loss decreased (-0.566463 --> -0.670513).  Saving model ...
Epoch: 3 cost time: 1.0156455039978027
Epoch: 3, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.031 Vali Acc: 0.699 Test Loss: 1.031 Test Acc: 0.699
Validation loss decreased (-0.670513 --> -0.699412).  Saving model ...
Epoch: 4 cost time: 0.9892094135284424
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.036 Vali Acc: 0.723 Test Loss: 1.036 Test Acc: 0.723
Validation loss decreased (-0.699412 --> -0.722533).  Saving model ...
Epoch: 5 cost time: 1.0632119178771973
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.167 Vali Acc: 0.682 Test Loss: 1.167 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0954511165618896
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.682 Test Loss: 0.915 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0340440273284912
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.705 Test Loss: 1.130 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.029862403869629
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.126 Vali Acc: 0.671 Test Loss: 1.126 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.064215898513794
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.717 Test Loss: 1.039 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9844198226928711
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.027 Vali Acc: 0.717 Test Loss: 1.027 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0172064304351807
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.717 Test Loss: 1.020 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0753448009490967
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.717 Test Loss: 1.012 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9959311485290527
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.717 Test Loss: 1.007 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1165375709533691
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.717 Test Loss: 1.001 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7225433526011561
model parameter : 1124745
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8850412368774414
Epoch: 1, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.578 Vali Acc: 0.509 Test Loss: 1.578 Test Acc: 0.509
Validation loss decreased (inf --> -0.508655).  Saving model ...
Epoch: 2 cost time: 2.96659517288208
Epoch: 2, Steps: 17 | Train Loss: 0.382 Vali Loss: 1.012 Vali Acc: 0.694 Test Loss: 1.012 Test Acc: 0.694
Validation loss decreased (-0.508655 --> -0.693632).  Saving model ...
Epoch: 3 cost time: 2.8054616451263428
Epoch: 3, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.898 Vali Acc: 0.705 Test Loss: 0.898 Test Acc: 0.705
Validation loss decreased (-0.693632 --> -0.705193).  Saving model ...
Epoch: 4 cost time: 2.757734537124634
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.365 Vali Acc: 0.711 Test Loss: 1.365 Test Acc: 0.711
Validation loss decreased (-0.705193 --> -0.710969).  Saving model ...
Epoch: 5 cost time: 2.9996449947357178
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.316 Vali Acc: 0.734 Test Loss: 1.316 Test Acc: 0.734
Validation loss decreased (-0.710969 --> -0.734091).  Saving model ...
Epoch: 6 cost time: 2.3549208641052246
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.935 Vali Acc: 0.751 Test Loss: 0.935 Test Acc: 0.751
Validation loss decreased (-0.734091 --> -0.751436).  Saving model ...
Epoch: 7 cost time: 2.8212056159973145
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.728 Test Loss: 1.158 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.420755624771118
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.174 Vali Acc: 0.734 Test Loss: 1.174 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1711061000823975
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.539 Vali Acc: 0.705 Test Loss: 1.539 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1482863426208496
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.368 Vali Acc: 0.734 Test Loss: 1.368 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7871510982513428
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.407 Vali Acc: 0.728 Test Loss: 1.407 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1897871494293213
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.368 Vali Acc: 0.717 Test Loss: 2.368 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7628486156463623
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.863 Vali Acc: 0.751 Test Loss: 1.863 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.282519578933716
Epoch: 14, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.680 Vali Acc: 0.740 Test Loss: 2.680 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.353883743286133
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 3.310 Vali Acc: 0.636 Test Loss: 3.310 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.962007522583008
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.931 Vali Acc: 0.734 Test Loss: 1.931 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1550351
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2988452911376953
Epoch: 1, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.114 Vali Acc: 0.503 Test Loss: 1.114 Test Acc: 0.503
Validation loss decreased (inf --> -0.502879).  Saving model ...
Epoch: 2 cost time: 2.0577139854431152
Epoch: 2, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.032 Vali Acc: 0.734 Test Loss: 1.032 Test Acc: 0.734
Validation loss decreased (-0.502879 --> -0.734094).  Saving model ...
Epoch: 3 cost time: 1.9716517925262451
Epoch: 3, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.113 Vali Acc: 0.751 Test Loss: 1.113 Test Acc: 0.751
Validation loss decreased (-0.734094 --> -0.751434).  Saving model ...
Epoch: 4 cost time: 2.5671768188476562
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.437 Vali Acc: 0.688 Test Loss: 1.437 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0644941329956055
Epoch: 5, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.160 Vali Acc: 0.728 Test Loss: 1.160 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.150656223297119
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.986 Vali Acc: 0.740 Test Loss: 0.986 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.482221841812134
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.717 Test Loss: 1.097 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2170495986938477
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.728 Test Loss: 0.917 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.170698881149292
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.734 Test Loss: 0.855 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3093600273132324
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.734 Test Loss: 0.833 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6170551776885986
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.734 Test Loss: 0.823 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2067220211029053
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.734 Test Loss: 0.816 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0638208389282227
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.734 Test Loss: 0.811 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1549583
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0918142795562744
Epoch: 1, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.208 Vali Acc: 0.566 Test Loss: 1.208 Test Acc: 0.566
Validation loss decreased (inf --> -0.566462).  Saving model ...
Epoch: 2 cost time: 1.788194179534912
Epoch: 2, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.847 Vali Acc: 0.746 Test Loss: 0.847 Test Acc: 0.746
Validation loss decreased (-0.566462 --> -0.745656).  Saving model ...
Epoch: 3 cost time: 1.8745672702789307
Epoch: 3, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.845 Vali Acc: 0.763 Test Loss: 0.845 Test Acc: 0.763
Validation loss decreased (-0.745656 --> -0.762997).  Saving model ...
Epoch: 4 cost time: 1.913576602935791
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.000 Vali Acc: 0.740 Test Loss: 1.000 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.864969253540039
Epoch: 5, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.081 Vali Acc: 0.746 Test Loss: 1.081 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.812351942062378
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.762997 --> -0.774558).  Saving model ...
Epoch: 7 cost time: 1.6986453533172607
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.763 Test Loss: 0.812 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8786630630493164
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.219 Vali Acc: 0.694 Test Loss: 1.219 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9105472564697266
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.757 Test Loss: 0.747 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.93617582321167
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.763 Test Loss: 0.853 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3886659145355225
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.769 Test Loss: 0.808 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.276463747024536
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.751 Test Loss: 0.789 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.039858341217041
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.751 Test Loss: 0.781 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2472128868103027
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.763 Test Loss: 0.778 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.139491319656372
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.757 Test Loss: 0.777 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.07940936088562
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.757 Test Loss: 0.775 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1548559
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1379384994506836
Epoch: 1, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.036 Vali Acc: 0.613 Test Loss: 1.036 Test Acc: 0.613
Validation loss decreased (inf --> -0.612706).  Saving model ...
Epoch: 2 cost time: 1.790210247039795
Epoch: 2, Steps: 17 | Train Loss: 0.288 Vali Loss: 1.218 Vali Acc: 0.676 Test Loss: 1.218 Test Acc: 0.676
Validation loss decreased (-0.612706 --> -0.676288).  Saving model ...
Epoch: 3 cost time: 1.7592451572418213
Epoch: 3, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.795 Vali Acc: 0.751 Test Loss: 0.795 Test Acc: 0.751
Validation loss decreased (-0.676288 --> -0.751437).  Saving model ...
Epoch: 4 cost time: 1.7643773555755615
Epoch: 4, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.985 Vali Acc: 0.688 Test Loss: 0.985 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8686707019805908
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.610 Vali Acc: 0.705 Test Loss: 1.610 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5694580078125
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.728 Test Loss: 1.266 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6678507328033447
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.402 Vali Acc: 0.717 Test Loss: 1.402 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7814021110534668
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.249 Vali Acc: 0.705 Test Loss: 1.249 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8694005012512207
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.353 Vali Acc: 0.694 Test Loss: 1.353 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7636024951934814
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.291 Vali Acc: 0.763 Test Loss: 1.291 Test Acc: 0.763
Validation loss decreased (-0.751437 --> -0.762993).  Saving model ...
Epoch: 11 cost time: 2.326963186264038
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.964 Vali Acc: 0.757 Test Loss: 0.964 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2463862895965576
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.113 Vali Acc: 0.734 Test Loss: 1.113 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.214064121246338
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.723 Test Loss: 1.211 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1180837154388428
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.723 Test Loss: 1.128 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.463458776473999
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.728 Test Loss: 1.100 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.247131586074829
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.728 Test Loss: 1.090 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.067336320877075
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.728 Test Loss: 1.080 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.167057991027832
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.728 Test Loss: 1.073 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8639805316925049
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.728 Test Loss: 1.066 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.240251064300537
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.728 Test Loss: 1.063 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1547791
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1434662342071533
Epoch: 1, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
Validation loss decreased (inf --> -0.514440).  Saving model ...
Epoch: 2 cost time: 2.0084855556488037
Epoch: 2, Steps: 17 | Train Loss: 0.337 Vali Loss: 1.084 Vali Acc: 0.659 Test Loss: 1.084 Test Acc: 0.659
Validation loss decreased (-0.514440 --> -0.658949).  Saving model ...
Epoch: 3 cost time: 2.0675723552703857
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.065 Vali Acc: 0.705 Test Loss: 1.065 Test Acc: 0.705
Validation loss decreased (-0.658949 --> -0.705192).  Saving model ...
Epoch: 4 cost time: 1.536393642425537
Epoch: 4, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.012 Vali Acc: 0.728 Test Loss: 1.012 Test Acc: 0.728
Validation loss decreased (-0.705192 --> -0.728314).  Saving model ...
Epoch: 5 cost time: 1.4476838111877441
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.848 Vali Acc: 0.659 Test Loss: 1.848 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4390573501586914
Epoch: 6, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.323 Vali Acc: 0.763 Test Loss: 1.323 Test Acc: 0.763
Validation loss decreased (-0.728314 --> -0.762993).  Saving model ...
Epoch: 7 cost time: 1.517395257949829
Epoch: 7, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.945 Vali Acc: 0.775 Test Loss: 0.945 Test Acc: 0.775
Validation loss decreased (-0.762993 --> -0.774557).  Saving model ...
Epoch: 8 cost time: 1.6276578903198242
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.746 Test Loss: 1.113 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4512686729431152
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.757 Test Loss: 0.982 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3291795253753662
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.734 Test Loss: 1.106 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6449036598205566
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.740 Test Loss: 1.089 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4423346519470215
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.757 Test Loss: 1.047 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.489210844039917
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.757 Test Loss: 1.021 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5964701175689697
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.769 Test Loss: 1.005 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3944807052612305
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.757 Test Loss: 0.994 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4013886451721191
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.763 Test Loss: 0.990 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6180341243743896
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.763 Test Loss: 0.984 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1547023
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7928073406219482
Epoch: 1, Steps: 17 | Train Loss: 1.691 Vali Loss: 1.339 Vali Acc: 0.618 Test Loss: 1.339 Test Acc: 0.618
Validation loss decreased (inf --> -0.618484).  Saving model ...
Epoch: 2 cost time: 1.424215316772461
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 1.093 Vali Acc: 0.688 Test Loss: 1.093 Test Acc: 0.688
Validation loss decreased (-0.618484 --> -0.687850).  Saving model ...
Epoch: 3 cost time: 1.4813246726989746
Epoch: 3, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.192 Vali Acc: 0.699 Test Loss: 1.192 Test Acc: 0.699
Validation loss decreased (-0.687850 --> -0.699410).  Saving model ...
Epoch: 4 cost time: 1.5481815338134766
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.866 Vali Acc: 0.751 Test Loss: 0.866 Test Acc: 0.751
Validation loss decreased (-0.699410 --> -0.751436).  Saving model ...
Epoch: 5 cost time: 1.4826323986053467
Epoch: 5, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.911 Vali Acc: 0.763 Test Loss: 0.911 Test Acc: 0.763
Validation loss decreased (-0.751436 --> -0.762997).  Saving model ...
Epoch: 6 cost time: 1.522122859954834
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.765 Vali Acc: 0.751 Test Loss: 0.765 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4721648693084717
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.972 Vali Acc: 0.740 Test Loss: 0.972 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5213518142700195
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.803 Vali Acc: 0.786 Test Loss: 0.803 Test Acc: 0.786
Validation loss decreased (-0.762997 --> -0.786119).  Saving model ...
Epoch: 9 cost time: 1.4347753524780273
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.297 Vali Acc: 0.757 Test Loss: 1.297 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5002193450927734
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.869 Vali Acc: 0.780 Test Loss: 0.869 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.265873670578003
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.886 Vali Acc: 0.769 Test Loss: 0.886 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5240204334259033
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.746 Test Loss: 0.916 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5350000858306885
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.769 Test Loss: 0.852 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5602810382843018
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.780 Test Loss: 0.839 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5423142910003662
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.780 Test Loss: 0.832 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5259969234466553
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.780 Test Loss: 0.829 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6324784755706787
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.769 Test Loss: 0.826 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4892535209655762
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.769 Test Loss: 0.825 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1546511
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7227256298065186
Epoch: 1, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.134 Vali Acc: 0.566 Test Loss: 1.134 Test Acc: 0.566
Validation loss decreased (inf --> -0.566463).  Saving model ...
Epoch: 2 cost time: 1.419797420501709
Epoch: 2, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.826 Vali Acc: 0.723 Test Loss: 0.826 Test Acc: 0.723
Validation loss decreased (-0.566463 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.289957046508789
Epoch: 3, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.177 Vali Acc: 0.740 Test Loss: 1.177 Test Acc: 0.740
Validation loss decreased (-0.722535 --> -0.739873).  Saving model ...
Epoch: 4 cost time: 1.3735718727111816
Epoch: 4, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.078 Vali Acc: 0.705 Test Loss: 1.078 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.320199728012085
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.437 Vali Acc: 0.723 Test Loss: 1.437 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.38960862159729
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.368 Vali Acc: 0.757 Test Loss: 1.368 Test Acc: 0.757
Validation loss decreased (-0.739873 --> -0.757212).  Saving model ...
Epoch: 7 cost time: 1.3333847522735596
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.363 Vali Acc: 0.746 Test Loss: 1.363 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3563764095306396
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.252 Vali Acc: 0.723 Test Loss: 1.252 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4318296909332275
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.171 Vali Acc: 0.728 Test Loss: 1.171 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.38505220413208
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.728 Test Loss: 1.131 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4750914573669434
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.746 Test Loss: 1.075 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2812819480895996
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.746 Test Loss: 1.043 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.420546054840088
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.746 Test Loss: 1.023 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4051940441131592
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.746 Test Loss: 1.013 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3959863185882568
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.746 Test Loss: 1.005 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3921542167663574
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.751 Test Loss: 0.999 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1546255
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3759207725524902
Epoch: 1, Steps: 17 | Train Loss: 1.687 Vali Loss: 1.047 Vali Acc: 0.624 Test Loss: 1.047 Test Acc: 0.624
Validation loss decreased (inf --> -0.624267).  Saving model ...
Epoch: 2 cost time: 1.0248825550079346
Epoch: 2, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.950 Vali Acc: 0.717 Test Loss: 0.950 Test Acc: 0.717
Validation loss decreased (-0.624267 --> -0.716754).  Saving model ...
Epoch: 3 cost time: 1.040388584136963
Epoch: 3, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.901 Vali Acc: 0.705 Test Loss: 0.901 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0036582946777344
Epoch: 4, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.058 Vali Acc: 0.740 Test Loss: 1.058 Test Acc: 0.740
Validation loss decreased (-0.716754 --> -0.739874).  Saving model ...
Epoch: 5 cost time: 1.0432047843933105
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.980 Vali Acc: 0.763 Test Loss: 0.980 Test Acc: 0.763
Validation loss decreased (-0.739874 --> -0.762996).  Saving model ...
Epoch: 6 cost time: 1.143458366394043
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.780 Test Loss: 0.823 Test Acc: 0.780
Validation loss decreased (-0.762996 --> -0.780339).  Saving model ...
Epoch: 7 cost time: 1.1515097618103027
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2503292560577393
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.723 Test Loss: 0.928 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0450294017791748
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.757 Test Loss: 0.823 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.189857006072998
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.751 Test Loss: 0.773 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.179703712463379
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.751 Test Loss: 0.756 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.174119472503662
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.751 Test Loss: 0.751 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1371009349822998
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.751 Test Loss: 0.747 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1432995796203613
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.746 Test Loss: 0.744 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1527533531188965
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.746 Test Loss: 0.741 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1844723224639893
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.751 Test Loss: 0.737 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df128_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1545999
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.240032911300659
Epoch: 1, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.128 Vali Acc: 0.578 Test Loss: 1.128 Test Acc: 0.578
Validation loss decreased (inf --> -0.578023).  Saving model ...
Epoch: 2 cost time: 2.8534092903137207
Epoch: 2, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.061 Vali Acc: 0.659 Test Loss: 1.061 Test Acc: 0.659
Validation loss decreased (-0.578023 --> -0.658949).  Saving model ...
Epoch: 3 cost time: 3.0162670612335205
Epoch: 3, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.961 Vali Acc: 0.711 Test Loss: 0.961 Test Acc: 0.711
Validation loss decreased (-0.658949 --> -0.710973).  Saving model ...
Epoch: 4 cost time: 2.962470054626465
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.919 Vali Acc: 0.740 Test Loss: 0.919 Test Acc: 0.740
Validation loss decreased (-0.710973 --> -0.739875).  Saving model ...
Epoch: 5 cost time: 2.6814539432525635
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.296 Vali Acc: 0.728 Test Loss: 1.296 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6973960399627686
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.180 Vali Acc: 0.757 Test Loss: 1.180 Test Acc: 0.757
Validation loss decreased (-0.739875 --> -0.757214).  Saving model ...
Epoch: 7 cost time: 2.6678669452667236
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.952 Vali Acc: 0.769 Test Loss: 0.952 Test Acc: 0.769
Validation loss decreased (-0.757214 --> -0.768777).  Saving model ...
Epoch: 8 cost time: 2.3437650203704834
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.139 Vali Acc: 0.769 Test Loss: 1.139 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.656297445297241
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 2.143 Vali Acc: 0.688 Test Loss: 2.143 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4812440872192383
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.460 Vali Acc: 0.705 Test Loss: 2.460 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.918912172317505
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.400 Vali Acc: 0.775 Test Loss: 1.400 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774552).  Saving model ...
Epoch: 12 cost time: 2.925992727279663
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.893 Vali Acc: 0.740 Test Loss: 1.893 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8653934001922607
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.728 Test Loss: 1.997 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8808200359344482
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.751 Test Loss: 1.688 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6548919677734375
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.763 Test Loss: 1.579 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5924808979034424
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.775 Test Loss: 1.554 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0381009578704834
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.775 Test Loss: 1.547 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0812129974365234
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.775 Test Loss: 1.544 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.093017578125
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.775 Test Loss: 1.541 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.941073417663574
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.775 Test Loss: 1.539 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.172438383102417
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.775 Test Loss: 1.538 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1303695
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9626967906951904
Epoch: 1, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.123 Vali Acc: 0.584 Test Loss: 1.123 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 2.173858642578125
Epoch: 2, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.840 Vali Acc: 0.746 Test Loss: 0.840 Test Acc: 0.746
Validation loss decreased (-0.583804 --> -0.745656).  Saving model ...
Epoch: 3 cost time: 2.5176851749420166
Epoch: 3, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.658 Vali Acc: 0.815 Test Loss: 0.658 Test Acc: 0.815
Validation loss decreased (-0.745656 --> -0.815022).  Saving model ...
Epoch: 4 cost time: 2.10506272315979
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.325 Vali Acc: 0.694 Test Loss: 1.325 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2058539390563965
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.262 Vali Acc: 0.734 Test Loss: 1.262 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.032557964324951
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.746 Test Loss: 0.994 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0598294734954834
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.751 Test Loss: 0.918 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1090281009674072
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.769 Test Loss: 0.847 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.033846855163574
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.769 Test Loss: 0.829 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2619009017944336
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.769 Test Loss: 0.823 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.563138723373413
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5868396759033203
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7498695850372314
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1302927
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.46431827545166
Epoch: 1, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.144 Vali Acc: 0.561 Test Loss: 1.144 Test Acc: 0.561
Validation loss decreased (inf --> -0.560682).  Saving model ...
Epoch: 2 cost time: 2.1244008541107178
Epoch: 2, Steps: 17 | Train Loss: 0.364 Vali Loss: 1.001 Vali Acc: 0.665 Test Loss: 1.001 Test Acc: 0.665
Validation loss decreased (-0.560682 --> -0.664730).  Saving model ...
Epoch: 3 cost time: 2.320716381072998
Epoch: 3, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.906 Vali Acc: 0.740 Test Loss: 0.906 Test Acc: 0.740
Validation loss decreased (-0.664730 --> -0.739875).  Saving model ...
Epoch: 4 cost time: 2.3155558109283447
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.978 Vali Acc: 0.769 Test Loss: 0.978 Test Acc: 0.769
Validation loss decreased (-0.739875 --> -0.768776).  Saving model ...
Epoch: 5 cost time: 2.155302047729492
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.010 Vali Acc: 0.728 Test Loss: 1.010 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0951473712921143
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.946 Vali Acc: 0.769 Test Loss: 0.946 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768777).  Saving model ...
Epoch: 7 cost time: 2.3200767040252686
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.780 Test Loss: 0.951 Test Acc: 0.780
Validation loss decreased (-0.768777 --> -0.780337).  Saving model ...
Epoch: 8 cost time: 2.162539005279541
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.480602979660034
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.780 Test Loss: 0.796 Test Acc: 0.780
Validation loss decreased (-0.780337 --> -0.780339).  Saving model ...
Epoch: 10 cost time: 2.3999664783477783
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.780 Test Loss: 0.780 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 11 cost time: 2.3881282806396484
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.780 Test Loss: 0.773 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 12 cost time: 2.466245651245117
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.780 Test Loss: 0.770 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 13 cost time: 2.1898717880249023
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.780 Test Loss: 0.767 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 14 cost time: 2.198206663131714
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.780 Test Loss: 0.765 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 15 cost time: 1.7115871906280518
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.780 Test Loss: 0.760 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 16 cost time: 2.1095056533813477
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.780 Test Loss: 0.761 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0706088542938232
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.780 Test Loss: 0.760 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 18 cost time: 2.203230857849121
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.780 Test Loss: 0.757 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 19 cost time: 1.942751169204712
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.794079065322876
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.775 Test Loss: 0.754 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9630515575408936
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9897100925445557
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9047324657440186
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9278345108032227
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.146209239959717
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.775 Test Loss: 0.747 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0286481380462646
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.0841002464294434
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.103688955307007
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.775 Test Loss: 0.745 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1301903
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.694692850112915
Epoch: 1, Steps: 17 | Train Loss: 1.665 Vali Loss: 0.976 Vali Acc: 0.694 Test Loss: 0.976 Test Acc: 0.694
Validation loss decreased (inf --> -0.693632).  Saving model ...
Epoch: 2 cost time: 2.3329203128814697
Epoch: 2, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.894 Vali Acc: 0.728 Test Loss: 0.894 Test Acc: 0.728
Validation loss decreased (-0.693632 --> -0.728315).  Saving model ...
Epoch: 3 cost time: 1.9425959587097168
Epoch: 3, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.736 Vali Acc: 0.740 Test Loss: 0.736 Test Acc: 0.740
Validation loss decreased (-0.728315 --> -0.739877).  Saving model ...
Epoch: 4 cost time: 2.1322851181030273
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.909 Vali Acc: 0.728 Test Loss: 0.909 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.214816093444824
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.084 Vali Acc: 0.740 Test Loss: 1.084 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4139060974121094
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.029 Vali Acc: 0.757 Test Loss: 1.029 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757215).  Saving model ...
Epoch: 7 cost time: 2.1817626953125
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.757 Test Loss: 0.846 Test Acc: 0.757
Validation loss decreased (-0.757215 --> -0.757217).  Saving model ...
Epoch: 8 cost time: 2.3285014629364014
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
Validation loss decreased (-0.757217 --> -0.774560).  Saving model ...
Epoch: 9 cost time: 1.9967315196990967
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
Validation loss decreased (-0.774560 --> -0.809242).  Saving model ...
Epoch: 10 cost time: 1.7308447360992432
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.191398859024048
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.27325439453125
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.798 Test Loss: 0.668 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.516899824142456
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.798 Test Loss: 0.672 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3906924724578857
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.798 Test Loss: 0.674 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.009166717529297
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.798 Test Loss: 0.673 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.302985668182373
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.798 Test Loss: 0.676 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3063607215881348
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.792 Test Loss: 0.675 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4087462425231934
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.798 Test Loss: 0.674 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.490245819091797
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.798 Test Loss: 0.676 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1301135
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9833478927612305
Epoch: 1, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.039 Vali Acc: 0.618 Test Loss: 1.039 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 1.5076348781585693
Epoch: 2, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.684 Vali Acc: 0.780 Test Loss: 0.684 Test Acc: 0.780
Validation loss decreased (-0.618487 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 1.6074755191802979
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.347 Vali Acc: 0.734 Test Loss: 1.347 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4289391040802002
Epoch: 4, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.481 Vali Acc: 0.653 Test Loss: 1.481 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5481071472167969
Epoch: 5, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.900 Vali Acc: 0.763 Test Loss: 0.900 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6286044120788574
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.249 Vali Acc: 0.728 Test Loss: 1.249 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.685349702835083
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.607072353363037
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.969 Vali Acc: 0.728 Test Loss: 0.969 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7247354984283447
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.769 Test Loss: 0.843 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6392738819122314
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.567962646484375
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.666808843612671
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1300367
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8443961143493652
Epoch: 1, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.372 Vali Acc: 0.509 Test Loss: 1.372 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 1.2712228298187256
Epoch: 2, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.798 Vali Acc: 0.717 Test Loss: 0.798 Test Acc: 0.717
Validation loss decreased (-0.508657 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 1.4737091064453125
Epoch: 3, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.697 Vali Acc: 0.740 Test Loss: 0.697 Test Acc: 0.740
Validation loss decreased (-0.716755 --> -0.739877).  Saving model ...
Epoch: 4 cost time: 1.440894603729248
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.306 Vali Acc: 0.699 Test Loss: 1.306 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4929547309875488
Epoch: 5, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.341 Vali Acc: 0.711 Test Loss: 1.341 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4996058940887451
Epoch: 6, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.512 Vali Acc: 0.699 Test Loss: 1.512 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.521585464477539
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.249 Vali Acc: 0.723 Test Loss: 1.249 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5189311504364014
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.609 Vali Acc: 0.746 Test Loss: 1.609 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745649).  Saving model ...
Epoch: 9 cost time: 1.257033348083496
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.462 Vali Acc: 0.671 Test Loss: 1.462 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4537568092346191
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.446 Vali Acc: 0.728 Test Loss: 1.446 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2020659446716309
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.723 Test Loss: 1.498 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.327293872833252
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.763 Test Loss: 1.173 Test Acc: 0.763
Validation loss decreased (-0.745649 --> -0.762994).  Saving model ...
Epoch: 13 cost time: 1.408968210220337
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.728 Test Loss: 1.609 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2041096687316895
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.392 Vali Acc: 0.723 Test Loss: 1.392 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3769946098327637
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.728 Test Loss: 1.620 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.228883981704712
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.769 Test Loss: 1.047 Test Acc: 0.769
Validation loss decreased (-0.762994 --> -0.768776).  Saving model ...
Epoch: 17 cost time: 1.3676836490631104
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.769 Test Loss: 1.048 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.389955997467041
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.746 Test Loss: 1.069 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3115873336791992
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.740 Test Loss: 1.074 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4928138256072998
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.740 Test Loss: 1.074 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3667094707489014
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.740 Test Loss: 1.073 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3848876953125
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.740 Test Loss: 1.073 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5042176246643066
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.072 Vali Acc: 0.740 Test Loss: 1.072 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.558567762374878
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.740 Test Loss: 1.071 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.557713508605957
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.740 Test Loss: 1.070 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5081801414489746
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.740 Test Loss: 1.069 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1299855
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.63188099861145
Epoch: 1, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.150 Vali Acc: 0.601 Test Loss: 1.150 Test Acc: 0.601
Validation loss decreased (inf --> -0.601145).  Saving model ...
Epoch: 2 cost time: 1.378251552581787
Epoch: 2, Steps: 17 | Train Loss: 0.332 Vali Loss: 1.220 Vali Acc: 0.659 Test Loss: 1.220 Test Acc: 0.659
Validation loss decreased (-0.601145 --> -0.658947).  Saving model ...
Epoch: 3 cost time: 1.3577609062194824
Epoch: 3, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.802 Vali Acc: 0.757 Test Loss: 0.802 Test Acc: 0.757
Validation loss decreased (-0.658947 --> -0.757217).  Saving model ...
Epoch: 4 cost time: 1.4325380325317383
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.767 Vali Acc: 0.780 Test Loss: 0.767 Test Acc: 0.780
Validation loss decreased (-0.757217 --> -0.780339).  Saving model ...
Epoch: 5 cost time: 1.4794692993164062
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.130 Vali Acc: 0.757 Test Loss: 1.130 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2080214023590088
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.289 Vali Acc: 0.682 Test Loss: 1.289 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5155024528503418
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.723 Test Loss: 1.359 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4389979839324951
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.273 Vali Acc: 0.746 Test Loss: 1.273 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4553954601287842
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.775 Test Loss: 1.130 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3528990745544434
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.048 Vali Acc: 0.723 Test Loss: 1.048 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5689795017242432
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.740 Test Loss: 1.539 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.554504156112671
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.296 Vali Acc: 0.728 Test Loss: 1.296 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4824912548065186
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.746 Test Loss: 1.276 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5124454498291016
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.734 Test Loss: 1.273 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1299599
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5637989044189453
Epoch: 1, Steps: 17 | Train Loss: 1.655 Vali Loss: 1.210 Vali Acc: 0.538 Test Loss: 1.210 Test Acc: 0.538
Validation loss decreased (inf --> -0.537560).  Saving model ...
Epoch: 2 cost time: 1.2758185863494873
Epoch: 2, Steps: 17 | Train Loss: 0.292 Vali Loss: 1.081 Vali Acc: 0.682 Test Loss: 1.081 Test Acc: 0.682
Validation loss decreased (-0.537560 --> -0.682070).  Saving model ...
Epoch: 3 cost time: 1.297943353652954
Epoch: 3, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.936 Vali Acc: 0.751 Test Loss: 0.936 Test Acc: 0.751
Validation loss decreased (-0.682070 --> -0.751436).  Saving model ...
Epoch: 4 cost time: 1.2888436317443848
Epoch: 4, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.819 Vali Acc: 0.734 Test Loss: 0.819 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2294156551361084
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.987 Vali Acc: 0.734 Test Loss: 0.987 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1950066089630127
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.941 Vali Acc: 0.723 Test Loss: 0.941 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3002235889434814
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.751 Test Loss: 0.888 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 8 cost time: 1.26008939743042
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.746 Test Loss: 0.829 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2944443225860596
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.746 Test Loss: 0.830 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2369985580444336
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.746 Test Loss: 0.828 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.342677116394043
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.746 Test Loss: 0.826 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3378639221191406
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.763 Test Loss: 0.817 Test Acc: 0.763
Validation loss decreased (-0.751436 --> -0.762998).  Saving model ...
Epoch: 13 cost time: 1.2390692234039307
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.763 Test Loss: 0.812 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 14 cost time: 1.347858190536499
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.763 Test Loss: 0.811 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 15 cost time: 1.2420403957366943
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.757 Test Loss: 0.810 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1654975414276123
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.757 Test Loss: 0.813 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1775403022766113
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.757 Test Loss: 0.811 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3173224925994873
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.769 Test Loss: 0.809 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768778).  Saving model ...
Epoch: 19 cost time: 1.0843055248260498
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.757 Test Loss: 0.810 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2539355754852295
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.757 Test Loss: 0.812 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.186582088470459
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.769 Test Loss: 0.811 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1449086666107178
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.769 Test Loss: 0.810 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2819950580596924
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.769 Test Loss: 0.810 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.200394630432129
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.769 Test Loss: 0.810 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2697727680206299
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.769 Test Loss: 0.810 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.232436180114746
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.769 Test Loss: 0.811 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.198627233505249
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.769 Test Loss: 0.811 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2070503234863281
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.763 Test Loss: 0.812 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df64_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1299343
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.1551196575164795
Epoch: 1, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.335 Vali Acc: 0.526 Test Loss: 1.335 Test Acc: 0.526
Validation loss decreased (inf --> -0.525998).  Saving model ...
Epoch: 2 cost time: 2.86159086227417
Epoch: 2, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.193 Vali Acc: 0.688 Test Loss: 1.193 Test Acc: 0.688
Validation loss decreased (-0.525998 --> -0.687849).  Saving model ...
Epoch: 3 cost time: 2.5923407077789307
Epoch: 3, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.083 Vali Acc: 0.711 Test Loss: 1.083 Test Acc: 0.711
Validation loss decreased (-0.687849 --> -0.710972).  Saving model ...
Epoch: 4 cost time: 2.751340627670288
Epoch: 4, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.883 Vali Acc: 0.746 Test Loss: 0.883 Test Acc: 0.746
Validation loss decreased (-0.710972 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 2.8775827884674072
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.863 Vali Acc: 0.728 Test Loss: 0.863 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.849390983581543
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.751 Test Loss: 0.787 Test Acc: 0.751
Validation loss decreased (-0.745656 --> -0.751437).  Saving model ...
Epoch: 7 cost time: 2.8265018463134766
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.769 Test Loss: 0.767 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768778).  Saving model ...
Epoch: 8 cost time: 2.7163147926330566
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.780 Test Loss: 0.760 Test Acc: 0.780
Validation loss decreased (-0.768778 --> -0.780339).  Saving model ...
Epoch: 9 cost time: 2.8296570777893066
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.780 Test Loss: 0.767 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.84211802482605
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.780 Test Loss: 0.766 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6242547035217285
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.780 Test Loss: 0.763 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4163780212402344
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.780 Test Loss: 0.761 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8264944553375244
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.786 Test Loss: 0.760 Test Acc: 0.786
Validation loss decreased (-0.780339 --> -0.786120).  Saving model ...
Epoch: 14 cost time: 2.693528652191162
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.786 Test Loss: 0.758 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 15 cost time: 2.804241180419922
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.786 Test Loss: 0.758 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4119668006896973
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.786 Test Loss: 0.757 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 17 cost time: 2.595928907394409
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.786 Test Loss: 0.756 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 18 cost time: 2.772066831588745
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 19 cost time: 2.657733917236328
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4043333530426025
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6912648677825928
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.870649576187134
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.786 Test Loss: 0.753 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 23 cost time: 2.847698211669922
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.786 Test Loss: 0.751 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 24 cost time: 2.655719041824341
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.786 Test Loss: 0.750 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 25 cost time: 2.3915514945983887
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.786 Test Loss: 0.749 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 26 cost time: 2.1929047107696533
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.786 Test Loss: 0.745 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 27 cost time: 2.267042398452759
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.786 Test Loss: 0.746 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.33400559425354
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.786 Test Loss: 0.746 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.341700315475464
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.786 Test Loss: 0.746 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1483988761901855
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.786 Test Loss: 0.745 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.239025115966797
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.786 Test Loss: 0.745 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 32 cost time: 2.5358777046203613
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 33 cost time: 2.584573745727539
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2731010913848877
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.786 Test Loss: 0.742 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 35 cost time: 2.5976736545562744
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.786 Test Loss: 0.742 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 36 cost time: 2.7868223190307617
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.786 Test Loss: 0.742 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 37 cost time: 2.3893229961395264
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.786 Test Loss: 0.742 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.57820463180542
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.6625804901123047
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.786 Test Loss: 0.743 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.526933193206787
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.0751047134399414
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.786 Test Loss: 0.742 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.8063313961029053
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.0385537147521973
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.246074676513672
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.786 Test Loss: 0.744 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.2303576469421387
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.786 Test Loss: 0.745 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.889885663986206
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.786 Test Loss: 0.743 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1180367
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6469950675964355
Epoch: 1, Steps: 17 | Train Loss: 1.612 Vali Loss: 0.995 Vali Acc: 0.566 Test Loss: 0.995 Test Acc: 0.566
Validation loss decreased (inf --> -0.566464).  Saving model ...
Epoch: 2 cost time: 1.9377977848052979
Epoch: 2, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.016 Vali Acc: 0.717 Test Loss: 1.016 Test Acc: 0.717
Validation loss decreased (-0.566464 --> -0.716753).  Saving model ...
Epoch: 3 cost time: 2.3880293369293213
Epoch: 3, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.923 Vali Acc: 0.757 Test Loss: 0.923 Test Acc: 0.757
Validation loss decreased (-0.716753 --> -0.757216).  Saving model ...
Epoch: 4 cost time: 2.327953577041626
Epoch: 4, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.096 Vali Acc: 0.740 Test Loss: 1.096 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0236616134643555
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.875 Vali Acc: 0.740 Test Loss: 0.875 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3628270626068115
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.087 Vali Acc: 0.757 Test Loss: 1.087 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3017475605010986
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.740 Test Loss: 0.813 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1661012172698975
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.989 Vali Acc: 0.740 Test Loss: 0.989 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0583200454711914
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.746 Test Loss: 0.928 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.093512535095215
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.763 Test Loss: 0.872 Test Acc: 0.763
Validation loss decreased (-0.757216 --> -0.762997).  Saving model ...
Epoch: 11 cost time: 1.9979631900787354
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.746 Test Loss: 1.013 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.002702474594116
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.763 Test Loss: 0.954 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9609017372131348
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.757 Test Loss: 0.926 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9819576740264893
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.757 Test Loss: 0.916 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.457805633544922
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.757 Test Loss: 0.902 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2179291248321533
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.769 Test Loss: 0.892 Test Acc: 0.769
Validation loss decreased (-0.762997 --> -0.768777).  Saving model ...
Epoch: 17 cost time: 2.058884620666504
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.763 Test Loss: 0.885 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.360227108001709
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.763 Test Loss: 0.880 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1632626056671143
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.763 Test Loss: 0.876 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4198107719421387
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.763 Test Loss: 0.873 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4485738277435303
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.757 Test Loss: 0.871 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1667301654815674
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.751 Test Loss: 0.867 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4789676666259766
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.757 Test Loss: 0.867 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2352797985076904
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.757 Test Loss: 0.866 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.448159694671631
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.757 Test Loss: 0.862 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0629308223724365
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.763 Test Loss: 0.861 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1179599
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.055567979812622
Epoch: 1, Steps: 17 | Train Loss: 1.712 Vali Loss: 0.975 Vali Acc: 0.613 Test Loss: 0.975 Test Acc: 0.613
Validation loss decreased (inf --> -0.612707).  Saving model ...
Epoch: 2 cost time: 1.997283935546875
Epoch: 2, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.855 Vali Acc: 0.682 Test Loss: 0.855 Test Acc: 0.682
Validation loss decreased (-0.612707 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 1.8871021270751953
Epoch: 3, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.387 Vali Acc: 0.665 Test Loss: 1.387 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9421625137329102
Epoch: 4, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.044 Vali Acc: 0.757 Test Loss: 1.044 Test Acc: 0.757
Validation loss decreased (-0.682072 --> -0.757215).  Saving model ...
Epoch: 5 cost time: 2.0271005630493164
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.970 Vali Acc: 0.763 Test Loss: 0.970 Test Acc: 0.763
Validation loss decreased (-0.757215 --> -0.762996).  Saving model ...
Epoch: 6 cost time: 1.783644199371338
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.043 Vali Acc: 0.746 Test Loss: 1.043 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6355295181274414
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.021 Vali Acc: 0.740 Test Loss: 1.021 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8473684787750244
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.699 Test Loss: 1.068 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8403892517089844
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.807 Vali Acc: 0.734 Test Loss: 0.807 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8064661026000977
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.751 Test Loss: 0.777 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8681459426879883
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.746 Test Loss: 0.766 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7791402339935303
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.746 Test Loss: 0.759 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2503662109375
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.751 Test Loss: 0.755 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.014469861984253
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.751 Test Loss: 0.753 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2620255947113037
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.757 Test Loss: 0.751 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1178575
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7575337886810303
Epoch: 1, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.097 Vali Acc: 0.584 Test Loss: 1.097 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 1.6842989921569824
Epoch: 2, Steps: 17 | Train Loss: 0.301 Vali Loss: 1.041 Vali Acc: 0.653 Test Loss: 1.041 Test Acc: 0.653
Validation loss decreased (-0.583804 --> -0.653169).  Saving model ...
Epoch: 3 cost time: 2.042231321334839
Epoch: 3, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.916 Vali Acc: 0.723 Test Loss: 0.916 Test Acc: 0.723
Validation loss decreased (-0.653169 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 1.7324631214141846
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.794 Vali Acc: 0.728 Test Loss: 0.794 Test Acc: 0.728
Validation loss decreased (-0.722534 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 2.009058952331543
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.037 Vali Acc: 0.694 Test Loss: 1.037 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9673993587493896
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.053 Vali Acc: 0.717 Test Loss: 1.053 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2603352069854736
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.711 Test Loss: 0.870 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8442504405975342
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2873284816741943
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.728 Test Loss: 0.809 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.890226125717163
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.804 Vali Acc: 0.734 Test Loss: 0.804 Test Acc: 0.734
Validation loss decreased (-0.728316 --> -0.734096).  Saving model ...
Epoch: 11 cost time: 2.1371407508850098
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.734 Test Loss: 0.794 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 12 cost time: 1.6149308681488037
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.734 Test Loss: 0.787 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 13 cost time: 1.6412250995635986
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.734 Test Loss: 0.780 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 14 cost time: 1.5023534297943115
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.734 Test Loss: 0.777 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 15 cost time: 1.5142827033996582
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.734 Test Loss: 0.777 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6341607570648193
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.734 Test Loss: 0.776 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 17 cost time: 1.6445915699005127
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.734 Test Loss: 0.776 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.695432186126709
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.734 Test Loss: 0.771 Test Acc: 0.734
Validation loss decreased (-0.734096 --> -0.734096).  Saving model ...
Epoch: 19 cost time: 1.6483495235443115
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.740 Test Loss: 0.768 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739877).  Saving model ...
Epoch: 20 cost time: 1.6753058433532715
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.740 Test Loss: 0.768 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.609628677368164
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.740 Test Loss: 0.769 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2710041999816895
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.763 Test Loss: 0.765 Test Acc: 0.763
Validation loss decreased (-0.739877 --> -0.762998).  Saving model ...
Epoch: 23 cost time: 2.2558209896087646
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.763 Test Loss: 0.765 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9270310401916504
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.763 Test Loss: 0.767 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.786245346069336
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.763 Test Loss: 0.766 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.317256212234497
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.763 Test Loss: 0.764 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 27 cost time: 1.9118201732635498
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.763 Test Loss: 0.763 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762998).  Saving model ...
Epoch: 28 cost time: 1.802760362625122
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.763 Test Loss: 0.764 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4712741374969482
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.769 Test Loss: 0.760 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768779).  Saving model ...
Epoch: 30 cost time: 2.5653178691864014
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.769 Test Loss: 0.762 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7177019119262695
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.769 Test Loss: 0.762 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8462741374969482
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.769 Test Loss: 0.759 Test Acc: 0.769
Validation loss decreased (-0.768779 --> -0.768779).  Saving model ...
Epoch: 33 cost time: 2.2426249980926514
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.769 Test Loss: 0.759 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2615232467651367
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.769 Test Loss: 0.761 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7516002655029297
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.769 Test Loss: 0.761 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8130571842193604
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.769 Test Loss: 0.761 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.0211329460144043
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.769 Test Loss: 0.760 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.225856304168701
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.769 Test Loss: 0.760 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.8485560417175293
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.757 Test Loss: 0.764 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6711792945861816
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.757 Test Loss: 0.762 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.1983494758605957
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.757 Test Loss: 0.765 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.9138262271881104
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.757 Test Loss: 0.764 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1177807
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.855844736099243
Epoch: 1, Steps: 17 | Train Loss: 1.550 Vali Loss: 1.101 Vali Acc: 0.561 Test Loss: 1.101 Test Acc: 0.561
Validation loss decreased (inf --> -0.560683).  Saving model ...
Epoch: 2 cost time: 1.3133482933044434
Epoch: 2, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.734 Vali Acc: 0.746 Test Loss: 0.734 Test Acc: 0.746
Validation loss decreased (-0.560683 --> -0.745657).  Saving model ...
Epoch: 3 cost time: 1.3020026683807373
Epoch: 3, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.568 Vali Acc: 0.659 Test Loss: 1.568 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3446836471557617
Epoch: 4, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.596 Vali Acc: 0.751 Test Loss: 1.596 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751429).  Saving model ...
Epoch: 5 cost time: 1.3506379127502441
Epoch: 5, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.027 Vali Acc: 0.763 Test Loss: 1.027 Test Acc: 0.763
Validation loss decreased (-0.751429 --> -0.762996).  Saving model ...
Epoch: 6 cost time: 1.366990566253662
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.249 Vali Acc: 0.780 Test Loss: 1.249 Test Acc: 0.780
Validation loss decreased (-0.762996 --> -0.780334).  Saving model ...
Epoch: 7 cost time: 1.4012572765350342
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.775 Test Loss: 1.431 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3360772132873535
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.751 Test Loss: 1.440 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.443404197692871
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.751 Test Loss: 1.419 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3394920825958252
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.757 Test Loss: 1.399 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4212288856506348
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.763 Test Loss: 1.383 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3561387062072754
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.769 Test Loss: 1.373 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6045517921447754
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.769 Test Loss: 1.366 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4816906452178955
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.769 Test Loss: 1.358 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7415263652801514
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.769 Test Loss: 1.352 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5555448532104492
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.769 Test Loss: 1.347 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1177039
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7171106338500977
Epoch: 1, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.113 Vali Acc: 0.601 Test Loss: 1.113 Test Acc: 0.601
Validation loss decreased (inf --> -0.601145).  Saving model ...
Epoch: 2 cost time: 1.2973346710205078
Epoch: 2, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.857 Vali Acc: 0.746 Test Loss: 0.857 Test Acc: 0.746
Validation loss decreased (-0.601145 --> -0.745656).  Saving model ...
Epoch: 3 cost time: 1.1812827587127686
Epoch: 3, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.080 Vali Acc: 0.728 Test Loss: 1.080 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0636842250823975
Epoch: 4, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.011 Vali Acc: 0.757 Test Loss: 1.011 Test Acc: 0.757
Validation loss decreased (-0.745656 --> -0.757215).  Saving model ...
Epoch: 5 cost time: 1.23362135887146
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.883 Vali Acc: 0.740 Test Loss: 0.883 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1798617839813232
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.921 Vali Acc: 0.734 Test Loss: 0.921 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.187579870223999
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.953 Vali Acc: 0.723 Test Loss: 0.953 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.301335096359253
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.164 Vali Acc: 0.682 Test Loss: 1.164 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2822842597961426
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.769 Test Loss: 0.758 Test Acc: 0.769
Validation loss decreased (-0.757215 --> -0.768779).  Saving model ...
Epoch: 10 cost time: 1.1862242221832275
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.792 Test Loss: 0.683 Test Acc: 0.792
Validation loss decreased (-0.768779 --> -0.791901).  Saving model ...
Epoch: 11 cost time: 1.2153377532958984
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.798 Test Loss: 0.667 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797681).  Saving model ...
Epoch: 12 cost time: 1.0210809707641602
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.798 Test Loss: 0.659 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 13 cost time: 1.2274134159088135
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.798 Test Loss: 0.653 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 14 cost time: 1.2731575965881348
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.798 Test Loss: 0.650 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 15 cost time: 1.370074987411499
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803462).  Saving model ...
Epoch: 16 cost time: 1.2425847053527832
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 17 cost time: 1.2437293529510498
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 18 cost time: 1.2685620784759521
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809242).  Saving model ...
Epoch: 19 cost time: 1.3036153316497803
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 20 cost time: 1.300544023513794
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 21 cost time: 1.3198485374450684
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 22 cost time: 1.2086763381958008
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 23 cost time: 1.3012287616729736
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3438050746917725
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815023).  Saving model ...
Epoch: 25 cost time: 1.3039796352386475
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 26 cost time: 1.3127830028533936
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.815 Test Loss: 0.635 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 27 cost time: 1.265392541885376
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2040860652923584
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3676939010620117
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.815 Test Loss: 0.635 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 30 cost time: 1.3307697772979736
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.815 Test Loss: 0.635 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 31 cost time: 1.409966230392456
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.815 Test Loss: 0.637 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2944154739379883
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.815 Test Loss: 0.637 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2641534805297852
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.307469129562378
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2990655899047852
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4535706043243408
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.815 Test Loss: 0.635 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4028739929199219
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.815 Test Loss: 0.635 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3706297874450684
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.386631727218628
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.433997392654419
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1176527
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5325992107391357
Epoch: 1, Steps: 17 | Train Loss: 1.710 Vali Loss: 1.028 Vali Acc: 0.572 Test Loss: 1.028 Test Acc: 0.572
Validation loss decreased (inf --> -0.572244).  Saving model ...
Epoch: 2 cost time: 1.3614094257354736
Epoch: 2, Steps: 17 | Train Loss: 0.331 Vali Loss: 1.045 Vali Acc: 0.676 Test Loss: 1.045 Test Acc: 0.676
Validation loss decreased (-0.572244 --> -0.676290).  Saving model ...
Epoch: 3 cost time: 1.2488908767700195
Epoch: 3, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.441 Vali Acc: 0.653 Test Loss: 1.441 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2412896156311035
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.996 Vali Acc: 0.757 Test Loss: 0.996 Test Acc: 0.757
Validation loss decreased (-0.676290 --> -0.757215).  Saving model ...
Epoch: 5 cost time: 1.189603567123413
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.296 Vali Acc: 0.705 Test Loss: 1.296 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0296430587768555
Epoch: 6, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.398 Vali Acc: 0.734 Test Loss: 1.398 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1900780200958252
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.385 Vali Acc: 0.734 Test Loss: 1.385 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.216320514678955
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.443 Vali Acc: 0.717 Test Loss: 1.443 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.295248031616211
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.110 Vali Acc: 0.728 Test Loss: 1.110 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2847225666046143
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.201 Vali Acc: 0.711 Test Loss: 1.201 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.222914695739746
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.176 Vali Acc: 0.711 Test Loss: 1.176 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3023653030395508
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.694 Test Loss: 1.518 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2202658653259277
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.694 Test Loss: 1.450 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1621499061584473
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.694 Test Loss: 1.418 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1176271
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.0879859924316406
Epoch: 1, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.092 Vali Acc: 0.566 Test Loss: 1.092 Test Acc: 0.566
Validation loss decreased (inf --> -0.566463).  Saving model ...
Epoch: 2 cost time: 1.173858642578125
Epoch: 2, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.058 Vali Acc: 0.711 Test Loss: 1.058 Test Acc: 0.711
Validation loss decreased (-0.566463 --> -0.710972).  Saving model ...
Epoch: 3 cost time: 0.9737341403961182
Epoch: 3, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.629 Vali Acc: 0.786 Test Loss: 0.629 Test Acc: 0.786
Validation loss decreased (-0.710972 --> -0.786121).  Saving model ...
Epoch: 4 cost time: 0.8512997627258301
Epoch: 4, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.017 Vali Acc: 0.751 Test Loss: 1.017 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8842592239379883
Epoch: 5, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.358 Vali Acc: 0.740 Test Loss: 1.358 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9459896087646484
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.402 Vali Acc: 0.757 Test Loss: 1.402 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0938968658447266
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.763 Test Loss: 1.617 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.007171392440796
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.130 Vali Acc: 0.740 Test Loss: 1.130 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.001880407333374
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.757 Test Loss: 1.066 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9972054958343506
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.037 Vali Acc: 0.775 Test Loss: 1.037 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0725555419921875
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.786 Test Loss: 1.024 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0592467784881592
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.786 Test Loss: 1.018 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0487298965454102
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.780 Test Loss: 1.012 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df32_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1176015
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5589873790740967
Epoch: 1, Steps: 17 | Train Loss: 1.710 Vali Loss: 1.102 Vali Acc: 0.566 Test Loss: 1.102 Test Acc: 0.566
Validation loss decreased (inf --> -0.566463).  Saving model ...
Epoch: 2 cost time: 2.614858388900757
Epoch: 2, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.694 Vali Acc: 0.740 Test Loss: 0.694 Test Acc: 0.740
Validation loss decreased (-0.566463 --> -0.739877).  Saving model ...
Epoch: 3 cost time: 2.6573891639709473
Epoch: 3, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.991 Vali Acc: 0.728 Test Loss: 0.991 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1959381103515625
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.077 Vali Acc: 0.711 Test Loss: 1.077 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.597689628601074
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.308 Vali Acc: 0.688 Test Loss: 1.308 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4969708919525146
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.091 Vali Acc: 0.705 Test Loss: 1.091 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.467606544494629
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.409 Vali Acc: 0.711 Test Loss: 1.409 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.492377996444702
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.774 Vali Acc: 0.699 Test Loss: 1.774 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5028114318847656
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.517 Vali Acc: 0.728 Test Loss: 1.517 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.588613986968994
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.229 Vali Acc: 0.711 Test Loss: 1.229 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4971327781677246
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.792 Vali Acc: 0.728 Test Loss: 2.792 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.376859426498413
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 1.405 Vali Acc: 0.792 Test Loss: 1.405 Test Acc: 0.792
Validation loss decreased (-0.739877 --> -0.791893).  Saving model ...
Epoch: 13 cost time: 2.4104373455047607
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.573 Vali Acc: 0.705 Test Loss: 1.573 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.429650068283081
Epoch: 14, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.000 Vali Acc: 0.717 Test Loss: 2.000 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5919277667999268
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.832 Vali Acc: 0.711 Test Loss: 1.832 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.525554656982422
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.724 Vali Acc: 0.705 Test Loss: 1.724 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6226632595062256
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.705 Test Loss: 1.721 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6701321601867676
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.699 Test Loss: 1.717 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.363030433654785
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.699 Test Loss: 1.714 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2495579719543457
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.699 Test Loss: 1.712 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.302504301071167
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.699 Test Loss: 1.709 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.420220375061035
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.699 Test Loss: 1.706 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1118703
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.666341781616211
Epoch: 1, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.031 Vali Acc: 0.584 Test Loss: 1.031 Test Acc: 0.584
Validation loss decreased (inf --> -0.583805).  Saving model ...
Epoch: 2 cost time: 2.1430869102478027
Epoch: 2, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.979 Vali Acc: 0.647 Test Loss: 0.979 Test Acc: 0.647
Validation loss decreased (-0.583805 --> -0.647389).  Saving model ...
Epoch: 3 cost time: 2.2547364234924316
Epoch: 3, Steps: 17 | Train Loss: 0.191 Vali Loss: 1.078 Vali Acc: 0.699 Test Loss: 1.078 Test Acc: 0.699
Validation loss decreased (-0.647389 --> -0.699411).  Saving model ...
Epoch: 4 cost time: 2.431598663330078
Epoch: 4, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.878 Vali Acc: 0.757 Test Loss: 0.878 Test Acc: 0.757
Validation loss decreased (-0.699411 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 2.2551188468933105
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.083 Vali Acc: 0.763 Test Loss: 1.083 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762995).  Saving model ...
Epoch: 6 cost time: 2.1124072074890137
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.979 Vali Acc: 0.746 Test Loss: 0.979 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.482052803039551
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.379 Vali Acc: 0.694 Test Loss: 1.379 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1037967205047607
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.151 Vali Acc: 0.723 Test Loss: 1.151 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0178840160369873
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.769 Test Loss: 0.983 Test Acc: 0.769
Validation loss decreased (-0.762995 --> -0.768776).  Saving model ...
Epoch: 10 cost time: 1.9633851051330566
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.946 Vali Acc: 0.769 Test Loss: 0.946 Test Acc: 0.769
Validation loss decreased (-0.768776 --> -0.768777).  Saving model ...
Epoch: 11 cost time: 2.0243284702301025
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.763 Test Loss: 0.992 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9139955043792725
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.763 Test Loss: 0.990 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.328075885772705
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.968 Vali Acc: 0.763 Test Loss: 0.968 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3293886184692383
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.763 Test Loss: 0.957 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3372175693511963
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.757 Test Loss: 0.950 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4955191612243652
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.757 Test Loss: 0.945 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.485107660293579
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.769 Test Loss: 0.941 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 18 cost time: 2.3089091777801514
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.769 Test Loss: 0.938 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 19 cost time: 2.094568967819214
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.769 Test Loss: 0.932 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 20 cost time: 2.188211441040039
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.769 Test Loss: 0.930 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 21 cost time: 1.9020054340362549
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.769 Test Loss: 0.928 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 22 cost time: 2.0647308826446533
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.769 Test Loss: 0.925 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 23 cost time: 1.9989662170410156
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 24 cost time: 1.9569358825683594
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 25 cost time: 1.978668212890625
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.769 Test Loss: 0.918 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 26 cost time: 1.99483323097229
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.769 Test Loss: 0.916 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 27 cost time: 2.0503334999084473
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774557).  Saving model ...
Epoch: 28 cost time: 1.9966251850128174
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774557).  Saving model ...
Epoch: 29 cost time: 2.3531932830810547
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774557).  Saving model ...
Epoch: 30 cost time: 2.5272884368896484
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.769 Test Loss: 0.909 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.4120423793792725
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.775 Test Loss: 0.907 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774557).  Saving model ...
Epoch: 32 cost time: 2.337570905685425
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774557).  Saving model ...
Epoch: 33 cost time: 2.2925071716308594
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.769 Test Loss: 0.904 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2618632316589355
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.769 Test Loss: 0.901 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.486145496368408
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.769 Test Loss: 0.900 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.3438217639923096
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.775 Test Loss: 0.898 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774557).  Saving model ...
Epoch: 37 cost time: 2.412088394165039
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.366358757019043
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
Validation loss decreased (-0.774557 --> -0.774558).  Saving model ...
Epoch: 39 cost time: 2.381669044494629
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.200596332550049
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 41 cost time: 2.316988229751587
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 42 cost time: 2.3946831226348877
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.775 Test Loss: 0.894 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 43 cost time: 2.378901958465576
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.008657693862915
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 45 cost time: 2.105234146118164
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 46 cost time: 2.498727321624756
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.775 Test Loss: 0.892 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 47 cost time: 2.566425323486328
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 48 cost time: 2.522352457046509
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.775 Test Loss: 0.889 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 49 cost time: 2.542558431625366
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.314863681793213
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.775 Test Loss: 0.889 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.4003307819366455
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 52 cost time: 2.131852149963379
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 53 cost time: 2.166459083557129
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.775 Test Loss: 0.887 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 54 cost time: 2.400726079940796
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.775 Test Loss: 0.887 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 55 cost time: 2.4450621604919434
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.775 Test Loss: 0.886 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 56 cost time: 2.313394069671631
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 57 cost time: 2.3078651428222656
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 58 cost time: 2.609398603439331
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 59 cost time: 2.256511926651001
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 60 cost time: 2.4058594703674316
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 61 cost time: 2.483010768890381
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 62 cost time: 2.4710941314697266
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 63 cost time: 2.421050548553467
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.4027743339538574
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 65 cost time: 2.195812463760376
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.775 Test Loss: 0.880 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 66 cost time: 2.293926477432251
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.775 Test Loss: 0.880 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.230343818664551
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 68 cost time: 2.2918143272399902
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 69 cost time: 2.397528886795044
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 2.3471744060516357
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 2.6046271324157715
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 2.37699818611145
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 73 cost time: 2.4286248683929443
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 74 cost time: 2.4686543941497803
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.774558 --> -0.774558).  Saving model ...
Epoch: 75 cost time: 2.237713098526001
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.410041570663452
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.461656332015991
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 2.5675344467163086
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.780 Test Loss: 0.877 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780338).  Saving model ...
Epoch: 79 cost time: 2.4885177612304688
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.780 Test Loss: 0.877 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 2.4467358589172363
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.780 Test Loss: 0.877 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 2.544144630432129
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.780 Test Loss: 0.877 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 82 cost time: 2.5233705043792725
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.780 Test Loss: 0.876 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 83 cost time: 2.444861650466919
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.780 Test Loss: 0.876 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 84 cost time: 2.446836471557617
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.780 Test Loss: 0.876 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 2.2769722938537598
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.780 Test Loss: 0.876 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 86 cost time: 2.3495538234710693
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.780 Test Loss: 0.875 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 87 cost time: 2.1394741535186768
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.780 Test Loss: 0.875 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 2.0844027996063232
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.9978938102722168
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 90 cost time: 2.0755257606506348
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 91 cost time: 1.982071876525879
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 92 cost time: 2.068448781967163
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 93 cost time: 2.491823673248291
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 2.4638917446136475
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 95 cost time: 2.367021083831787
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 96 cost time: 2.292133331298828
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.780 Test Loss: 0.873 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
Epoch: 97 cost time: 2.4590485095977783
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.780 Test Loss: 0.873 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.3389506340026855
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 2.397503137588501
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.780 Test Loss: 0.873 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 2.4267427921295166
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.780 Test Loss: 0.873 Test Acc: 0.780
Validation loss decreased (-0.780338 --> -0.780338).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1117935
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1616289615631104
Epoch: 1, Steps: 17 | Train Loss: 1.645 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
Validation loss decreased (inf --> -0.514439).  Saving model ...
Epoch: 2 cost time: 1.9663095474243164
Epoch: 2, Steps: 17 | Train Loss: 0.333 Vali Loss: 1.001 Vali Acc: 0.688 Test Loss: 1.001 Test Acc: 0.688
Validation loss decreased (-0.514439 --> -0.687851).  Saving model ...
Epoch: 3 cost time: 1.9621539115905762
Epoch: 3, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
Validation loss decreased (-0.687851 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 2.0950918197631836
Epoch: 4, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.970 Vali Acc: 0.728 Test Loss: 0.970 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7656819820404053
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.984 Vali Acc: 0.694 Test Loss: 1.984 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6225969791412354
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.086 Vali Acc: 0.757 Test Loss: 1.086 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.914823055267334
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.537 Vali Acc: 0.705 Test Loss: 1.537 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8336408138275146
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.786 Test Loss: 0.936 Test Acc: 0.786
Validation loss decreased (-0.762999 --> -0.786118).  Saving model ...
Epoch: 9 cost time: 1.9097142219543457
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.775 Test Loss: 0.839 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6795752048492432
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.763 Test Loss: 0.850 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7676270008087158
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.763 Test Loss: 0.841 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.872889757156372
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.751 Test Loss: 0.826 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.843743085861206
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.751 Test Loss: 0.818 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0124130249023438
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.751 Test Loss: 0.813 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.897428274154663
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.809 Vali Acc: 0.751 Test Loss: 0.809 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9214789867401123
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.751 Test Loss: 0.805 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8749334812164307
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.751 Test Loss: 0.802 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1369078159332275
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.751 Test Loss: 0.801 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1116911
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7492175102233887
Epoch: 1, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.386 Vali Acc: 0.503 Test Loss: 1.386 Test Acc: 0.503
Validation loss decreased (inf --> -0.502876).  Saving model ...
Epoch: 2 cost time: 1.7669425010681152
Epoch: 2, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.759 Vali Acc: 0.705 Test Loss: 0.759 Test Acc: 0.705
Validation loss decreased (-0.502876 --> -0.705195).  Saving model ...
Epoch: 3 cost time: 1.630631446838379
Epoch: 3, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.883 Vali Acc: 0.688 Test Loss: 0.883 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8824577331542969
Epoch: 4, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.307 Vali Acc: 0.717 Test Loss: 1.307 Test Acc: 0.717
Validation loss decreased (-0.705195 --> -0.716750).  Saving model ...
Epoch: 5 cost time: 1.8864762783050537
Epoch: 5, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.061 Vali Acc: 0.740 Test Loss: 1.061 Test Acc: 0.740
Validation loss decreased (-0.716750 --> -0.739874).  Saving model ...
Epoch: 6 cost time: 1.5909512042999268
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.132 Vali Acc: 0.723 Test Loss: 1.132 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7806954383850098
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.338 Vali Acc: 0.705 Test Loss: 1.338 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.882683515548706
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.836 Vali Acc: 0.746 Test Loss: 0.836 Test Acc: 0.746
Validation loss decreased (-0.739874 --> -0.745656).  Saving model ...
Epoch: 9 cost time: 2.0054330825805664
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.907 Vali Acc: 0.769 Test Loss: 0.907 Test Acc: 0.769
Validation loss decreased (-0.745656 --> -0.768777).  Saving model ...
Epoch: 10 cost time: 1.8113455772399902
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.363 Vali Acc: 0.705 Test Loss: 1.363 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6212193965911865
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.140 Vali Acc: 0.728 Test Loss: 1.140 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0124387741088867
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.219 Vali Acc: 0.728 Test Loss: 1.219 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0559558868408203
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.818 Vali Acc: 0.711 Test Loss: 1.818 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9400432109832764
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.584 Vali Acc: 0.676 Test Loss: 2.584 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9024674892425537
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.977 Vali Acc: 0.723 Test Loss: 1.977 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8588142395019531
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.294 Vali Acc: 0.775 Test Loss: 1.294 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774554).  Saving model ...
Epoch: 17 cost time: 1.5310802459716797
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.764 Vali Acc: 0.728 Test Loss: 1.764 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4638965129852295
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.955 Vali Acc: 0.705 Test Loss: 1.955 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5142691135406494
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.820 Vali Acc: 0.728 Test Loss: 1.820 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4144973754882812
Epoch: 20, Steps: 17 | Train Loss: 0.138 Vali Loss: 4.401 Vali Acc: 0.671 Test Loss: 4.401 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4090113639831543
Epoch: 21, Steps: 17 | Train Loss: 0.268 Vali Loss: 4.366 Vali Acc: 0.699 Test Loss: 4.366 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5338432788848877
Epoch: 22, Steps: 17 | Train Loss: 0.102 Vali Loss: 3.252 Vali Acc: 0.740 Test Loss: 3.252 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5138604640960693
Epoch: 23, Steps: 17 | Train Loss: 0.286 Vali Loss: 4.227 Vali Acc: 0.711 Test Loss: 4.227 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.488515853881836
Epoch: 24, Steps: 17 | Train Loss: 0.151 Vali Loss: 5.527 Vali Acc: 0.717 Test Loss: 5.527 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5228204727172852
Epoch: 25, Steps: 17 | Train Loss: 0.206 Vali Loss: 4.462 Vali Acc: 0.734 Test Loss: 4.462 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4253835678100586
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 4.357 Vali Acc: 0.694 Test Loss: 4.357 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1116143
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7319819927215576
Epoch: 1, Steps: 17 | Train Loss: 1.601 Vali Loss: 1.066 Vali Acc: 0.555 Test Loss: 1.066 Test Acc: 0.555
Validation loss decreased (inf --> -0.554903).  Saving model ...
Epoch: 2 cost time: 1.1985340118408203
Epoch: 2, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.907 Vali Acc: 0.740 Test Loss: 0.907 Test Acc: 0.740
Validation loss decreased (-0.554903 --> -0.739875).  Saving model ...
Epoch: 3 cost time: 1.578721523284912
Epoch: 3, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.299 Vali Acc: 0.682 Test Loss: 1.299 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5354633331298828
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.934 Vali Acc: 0.792 Test Loss: 0.934 Test Acc: 0.792
Validation loss decreased (-0.739875 --> -0.791898).  Saving model ...
Epoch: 5 cost time: 1.6114158630371094
Epoch: 5, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.167 Vali Acc: 0.734 Test Loss: 1.167 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5752143859863281
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.099 Vali Acc: 0.775 Test Loss: 1.099 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5935873985290527
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.769 Test Loss: 1.057 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.551919937133789
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.694 Test Loss: 1.591 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6782565116882324
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.098 Vali Acc: 0.757 Test Loss: 1.098 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4191582202911377
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.775 Test Loss: 1.060 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4121301174163818
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.022 Vali Acc: 0.775 Test Loss: 1.022 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4377689361572266
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.780 Test Loss: 1.009 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4784541130065918
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.997 Vali Acc: 0.780 Test Loss: 0.997 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2587435245513916
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.780 Test Loss: 0.994 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1115375
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5043258666992188
Epoch: 1, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.131 Vali Acc: 0.561 Test Loss: 1.131 Test Acc: 0.561
Validation loss decreased (inf --> -0.560682).  Saving model ...
Epoch: 2 cost time: 1.2328956127166748
Epoch: 2, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.991 Vali Acc: 0.676 Test Loss: 0.991 Test Acc: 0.676
Validation loss decreased (-0.560682 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 1.3334860801696777
Epoch: 3, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.252 Vali Acc: 0.711 Test Loss: 1.252 Test Acc: 0.711
Validation loss decreased (-0.676291 --> -0.710970).  Saving model ...
Epoch: 4 cost time: 1.3224539756774902
Epoch: 4, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.093 Vali Acc: 0.717 Test Loss: 1.093 Test Acc: 0.717
Validation loss decreased (-0.710970 --> -0.716752).  Saving model ...
Epoch: 5 cost time: 1.3840789794921875
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.951 Vali Acc: 0.786 Test Loss: 0.951 Test Acc: 0.786
Validation loss decreased (-0.716752 --> -0.786118).  Saving model ...
Epoch: 6 cost time: 1.3405420780181885
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.005 Vali Acc: 0.734 Test Loss: 1.005 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0418834686279297
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.966 Vali Acc: 0.775 Test Loss: 0.966 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1521515846252441
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.757 Test Loss: 1.033 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3104095458984375
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.763 Test Loss: 1.049 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3225431442260742
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.261214256286621
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.769 Test Loss: 0.991 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1010758876800537
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.769 Test Loss: 0.979 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2728769779205322
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.780 Test Loss: 0.969 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2727909088134766
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.775 Test Loss: 0.963 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2201423645019531
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.775 Test Loss: 0.956 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1114863
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4078176021575928
Epoch: 1, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.195 Vali Acc: 0.520 Test Loss: 1.195 Test Acc: 0.520
Validation loss decreased (inf --> -0.520219).  Saving model ...
Epoch: 2 cost time: 1.124297857284546
Epoch: 2, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.822 Vali Acc: 0.665 Test Loss: 0.822 Test Acc: 0.665
Validation loss decreased (-0.520219 --> -0.664732).  Saving model ...
Epoch: 3 cost time: 1.050173044204712
Epoch: 3, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.922 Vali Acc: 0.734 Test Loss: 0.922 Test Acc: 0.734
Validation loss decreased (-0.664732 --> -0.734095).  Saving model ...
Epoch: 4 cost time: 1.0041875839233398
Epoch: 4, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.087 Vali Acc: 0.711 Test Loss: 1.087 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1650118827819824
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.089 Vali Acc: 0.734 Test Loss: 1.089 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2162811756134033
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.028 Vali Acc: 0.734 Test Loss: 1.028 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.207855463027954
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.751 Test Loss: 1.041 Test Acc: 0.751
Validation loss decreased (-0.734095 --> -0.751435).  Saving model ...
Epoch: 8 cost time: 1.1168301105499268
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.740 Test Loss: 1.220 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1243915557861328
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.734 Test Loss: 1.212 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2603967189788818
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.746 Test Loss: 1.056 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2047171592712402
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.746 Test Loss: 1.029 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1538200378417969
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.746 Test Loss: 1.006 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1776576042175293
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.746 Test Loss: 0.994 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.011195182800293
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.734 Test Loss: 0.988 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.205542802810669
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.740 Test Loss: 0.981 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1923022270202637
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.751 Test Loss: 0.976 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 17 cost time: 1.1935439109802246
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.751 Test Loss: 0.971 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 18 cost time: 1.1299800872802734
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.751 Test Loss: 0.969 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 19 cost time: 1.0414950847625732
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.751 Test Loss: 0.969 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 20 cost time: 1.0876057147979736
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.751 Test Loss: 0.967 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 21 cost time: 1.0951457023620605
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.751 Test Loss: 0.965 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 22 cost time: 1.094304084777832
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.751 Test Loss: 0.963 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 23 cost time: 1.147282361984253
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.751 Test Loss: 0.959 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751435).  Saving model ...
Epoch: 24 cost time: 1.1918799877166748
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.751 Test Loss: 0.960 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0173964500427246
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.751 Test Loss: 0.959 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.923534631729126
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.751 Test Loss: 0.960 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0218751430511475
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.751 Test Loss: 0.959 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0730056762695312
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.751 Test Loss: 0.960 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.14225435256958
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.751 Test Loss: 0.961 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2135815620422363
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.751 Test Loss: 0.958 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751436).  Saving model ...
Epoch: 31 cost time: 1.1165413856506348
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.751 Test Loss: 0.958 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2771034240722656
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.751 Test Loss: 0.958 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 33 cost time: 1.2661409378051758
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.751 Test Loss: 0.957 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 34 cost time: 1.3515379428863525
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.751 Test Loss: 0.957 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2573957443237305
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.751 Test Loss: 0.957 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 36 cost time: 1.1728274822235107
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.751 Test Loss: 0.957 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 37 cost time: 1.1963832378387451
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.751 Test Loss: 0.958 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2407383918762207
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.751 Test Loss: 0.957 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1785531044006348
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.746 Test Loss: 0.956 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.217515230178833
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.746 Test Loss: 0.956 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2196085453033447
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.746 Test Loss: 0.956 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.175084114074707
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.746 Test Loss: 0.955 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0892698764801025
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.746 Test Loss: 0.954 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2044990062713623
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.746 Test Loss: 0.954 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.140702486038208
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.746 Test Loss: 0.952 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1198594570159912
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.746 Test Loss: 0.953 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1114607
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.2877135276794434
Epoch: 1, Steps: 17 | Train Loss: 1.711 Vali Loss: 1.307 Vali Acc: 0.491 Test Loss: 1.307 Test Acc: 0.491
Validation loss decreased (inf --> -0.491316).  Saving model ...
Epoch: 2 cost time: 1.0029754638671875
Epoch: 2, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.907 Vali Acc: 0.694 Test Loss: 0.907 Test Acc: 0.694
Validation loss decreased (-0.491316 --> -0.693633).  Saving model ...
Epoch: 3 cost time: 0.9751191139221191
Epoch: 3, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.892 Vali Acc: 0.723 Test Loss: 0.892 Test Acc: 0.723
Validation loss decreased (-0.693633 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 0.921828031539917
Epoch: 4, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.974 Vali Acc: 0.728 Test Loss: 0.974 Test Acc: 0.728
Validation loss decreased (-0.722534 --> -0.728314).  Saving model ...
Epoch: 5 cost time: 0.9691195487976074
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.221 Vali Acc: 0.682 Test Loss: 1.221 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1875746250152588
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.919 Vali Acc: 0.723 Test Loss: 0.919 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9982235431671143
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.061 Vali Acc: 0.699 Test Loss: 1.061 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0478262901306152
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.103 Vali Acc: 0.728 Test Loss: 1.103 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.139646291732788
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.728 Test Loss: 1.018 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9460194110870361
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.734 Test Loss: 0.936 Test Acc: 0.734
Validation loss decreased (-0.728314 --> -0.734095).  Saving model ...
Epoch: 11 cost time: 0.9248816967010498
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.734 Test Loss: 0.918 Test Acc: 0.734
Validation loss decreased (-0.734095 --> -0.734095).  Saving model ...
Epoch: 12 cost time: 0.9879550933837891
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.740 Test Loss: 0.904 Test Acc: 0.740
Validation loss decreased (-0.734095 --> -0.739875).  Saving model ...
Epoch: 13 cost time: 1.0722427368164062
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.740 Test Loss: 0.899 Test Acc: 0.740
Validation loss decreased (-0.739875 --> -0.739875).  Saving model ...
Epoch: 14 cost time: 0.9673998355865479
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.746 Test Loss: 0.893 Test Acc: 0.746
Validation loss decreased (-0.739875 --> -0.745656).  Saving model ...
Epoch: 15 cost time: 1.1124579906463623
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.757 Test Loss: 0.894 Test Acc: 0.757
Validation loss decreased (-0.745656 --> -0.757216).  Saving model ...
Epoch: 16 cost time: 1.066612958908081
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757217).  Saving model ...
Epoch: 17 cost time: 1.0704138278961182
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.763 Test Loss: 0.884 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762997).  Saving model ...
Epoch: 18 cost time: 1.0549440383911133
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.763 Test Loss: 0.878 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 19 cost time: 0.9922096729278564
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.763 Test Loss: 0.876 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 20 cost time: 1.1094856262207031
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.763 Test Loss: 0.873 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 21 cost time: 1.0254435539245605
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.763 Test Loss: 0.872 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 22 cost time: 1.0339784622192383
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.763 Test Loss: 0.869 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 23 cost time: 0.9781839847564697
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.763 Test Loss: 0.868 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 24 cost time: 1.10707426071167
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.763 Test Loss: 0.867 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 25 cost time: 1.112926959991455
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 26 cost time: 1.104738473892212
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.763 Test Loss: 0.865 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 27 cost time: 0.9360709190368652
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.763 Test Loss: 0.863 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 28 cost time: 0.9114713668823242
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.763 Test Loss: 0.861 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 29 cost time: 1.004554271697998
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.763 Test Loss: 0.860 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 30 cost time: 0.9262254238128662
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.763 Test Loss: 0.860 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 31 cost time: 0.8821840286254883
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.763 Test Loss: 0.859 Test Acc: 0.763
Validation loss decreased (-0.762997 --> -0.762997).  Saving model ...
Epoch: 32 cost time: 1.096247911453247
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.769 Test Loss: 0.857 Test Acc: 0.769
Validation loss decreased (-0.762997 --> -0.768778).  Saving model ...
Epoch: 33 cost time: 1.0241851806640625
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.769 Test Loss: 0.857 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768778).  Saving model ...
Epoch: 34 cost time: 0.9518148899078369
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.769 Test Loss: 0.857 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0340962409973145
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1002042293548584
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0225672721862793
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9623153209686279
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0973138809204102
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.763 Test Loss: 0.855 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.062063455581665
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.769 Test Loss: 0.855 Test Acc: 0.769
Validation loss decreased (-0.768778 --> -0.768778).  Saving model ...
Epoch: 41 cost time: 0.9518320560455322
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.763 Test Loss: 0.855 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.105961799621582
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0538289546966553
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.763 Test Loss: 0.855 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1388700008392334
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1343669891357422
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0777180194854736
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.763 Test Loss: 0.853 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0312905311584473
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.763 Test Loss: 0.853 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9197518825531006
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.763 Test Loss: 0.852 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8376200199127197
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.763 Test Loss: 0.852 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0211665630340576
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.763 Test Loss: 0.853 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df16_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1114351
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3188443183898926
Epoch: 1, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.215 Vali Acc: 0.543 Test Loss: 1.215 Test Acc: 0.543
Validation loss decreased (inf --> -0.543340).  Saving model ...
Epoch: 2 cost time: 2.33906626701355
Epoch: 2, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.037 Vali Acc: 0.682 Test Loss: 1.037 Test Acc: 0.682
Validation loss decreased (-0.543340 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 1.9971914291381836
Epoch: 3, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.139 Vali Acc: 0.671 Test Loss: 1.139 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1271121501922607
Epoch: 4, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.026 Vali Acc: 0.694 Test Loss: 1.026 Test Acc: 0.694
Validation loss decreased (-0.682071 --> -0.693631).  Saving model ...
Epoch: 5 cost time: 2.3485639095306396
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.996 Vali Acc: 0.705 Test Loss: 1.996 Test Acc: 0.705
Validation loss decreased (-0.693631 --> -0.705182).  Saving model ...
Epoch: 6 cost time: 2.080601215362549
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.636 Vali Acc: 0.769 Test Loss: 1.636 Test Acc: 0.769
Validation loss decreased (-0.705182 --> -0.768770).  Saving model ...
Epoch: 7 cost time: 2.5125927925109863
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.269 Vali Acc: 0.723 Test Loss: 2.269 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.274552583694458
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.891 Vali Acc: 0.746 Test Loss: 1.891 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5603795051574707
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.228 Vali Acc: 0.746 Test Loss: 2.228 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1546201705932617
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.051 Vali Acc: 0.746 Test Loss: 2.051 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.668116807937622
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.728 Test Loss: 1.906 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1445071697235107
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.717 Test Loss: 1.871 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9552569389343262
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.711 Test Loss: 1.848 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9493749141693115
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.723 Test Loss: 1.830 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8506083488464355
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.723 Test Loss: 1.819 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8737411499023438
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.723 Test Loss: 1.810 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1087871
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.273423194885254
Epoch: 1, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.393 Vali Acc: 0.439 Test Loss: 1.393 Test Acc: 0.439
Validation loss decreased (inf --> -0.439292).  Saving model ...
Epoch: 2 cost time: 2.3627102375030518
Epoch: 2, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
Validation loss decreased (-0.439292 --> -0.745657).  Saving model ...
Epoch: 3 cost time: 1.8930366039276123
Epoch: 3, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.754 Vali Acc: 0.769 Test Loss: 0.754 Test Acc: 0.769
Validation loss decreased (-0.745657 --> -0.768779).  Saving model ...
Epoch: 4 cost time: 2.0460469722747803
Epoch: 4, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.829 Vali Acc: 0.803 Test Loss: 0.829 Test Acc: 0.803
Validation loss decreased (-0.768779 --> -0.803460).  Saving model ...
Epoch: 5 cost time: 2.235175371170044
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.745 Vali Acc: 0.746 Test Loss: 0.745 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.825986623764038
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.932 Vali Acc: 0.763 Test Loss: 0.932 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.854128360748291
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.740 Test Loss: 0.707 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0894925594329834
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0058650970458984
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.751 Test Loss: 1.351 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.750349521636963
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.867 Vali Acc: 0.734 Test Loss: 1.867 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8292059898376465
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.506 Vali Acc: 0.671 Test Loss: 2.506 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2352569103240967
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 2.035 Vali Acc: 0.775 Test Loss: 2.035 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8994293212890625
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 3.365 Vali Acc: 0.705 Test Loss: 3.365 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7478604316711426
Epoch: 14, Steps: 17 | Train Loss: 0.185 Vali Loss: 3.188 Vali Acc: 0.740 Test Loss: 3.188 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1087103
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.4859459400177
Epoch: 1, Steps: 17 | Train Loss: 1.672 Vali Loss: 1.183 Vali Acc: 0.509 Test Loss: 1.183 Test Acc: 0.509
Validation loss decreased (inf --> -0.508659).  Saving model ...
Epoch: 2 cost time: 1.8415915966033936
Epoch: 2, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.752 Vali Acc: 0.723 Test Loss: 0.752 Test Acc: 0.723
Validation loss decreased (-0.508659 --> -0.722536).  Saving model ...
Epoch: 3 cost time: 1.802696704864502
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.571 Vali Acc: 0.792 Test Loss: 0.571 Test Acc: 0.792
Validation loss decreased (-0.722536 --> -0.791902).  Saving model ...
Epoch: 4 cost time: 1.5366568565368652
Epoch: 4, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.023 Vali Acc: 0.728 Test Loss: 1.023 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6858599185943604
Epoch: 5, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.056 Vali Acc: 0.723 Test Loss: 1.056 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6528184413909912
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.002 Vali Acc: 0.728 Test Loss: 2.002 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.587989330291748
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.268 Vali Acc: 0.821 Test Loss: 1.268 Test Acc: 0.821
Validation loss decreased (-0.791902 --> -0.820797).  Saving model ...
Epoch: 8 cost time: 1.7713892459869385
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.065 Vali Acc: 0.786 Test Loss: 1.065 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6907355785369873
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.366 Vali Acc: 0.780 Test Loss: 1.366 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7389416694641113
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.734 Test Loss: 1.779 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0055325031280518
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.763 Test Loss: 1.669 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2195935249328613
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.769 Test Loss: 1.578 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9839704036712646
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.769 Test Loss: 1.539 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8278443813323975
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.769 Test Loss: 1.519 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6529567241668701
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.498 Vali Acc: 0.769 Test Loss: 1.498 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7477424144744873
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.769 Test Loss: 1.482 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8984756469726562
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.769 Test Loss: 1.467 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1086079
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.017507314682007
Epoch: 1, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.424 Vali Acc: 0.526 Test Loss: 1.424 Test Acc: 0.526
Validation loss decreased (inf --> -0.525997).  Saving model ...
Epoch: 2 cost time: 1.5911548137664795
Epoch: 2, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.828 Vali Acc: 0.751 Test Loss: 0.828 Test Acc: 0.751
Validation loss decreased (-0.525997 --> -0.751437).  Saving model ...
Epoch: 3 cost time: 1.5465927124023438
Epoch: 3, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.793 Vali Acc: 0.734 Test Loss: 0.793 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.444610357284546
Epoch: 4, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.224 Vali Acc: 0.728 Test Loss: 1.224 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5429341793060303
Epoch: 5, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.387 Vali Acc: 0.688 Test Loss: 1.387 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.54414963722229
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.347 Vali Acc: 0.694 Test Loss: 1.347 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.566744327545166
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.360 Vali Acc: 0.734 Test Loss: 1.360 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5662200450897217
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.160 Vali Acc: 0.711 Test Loss: 1.160 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5529048442840576
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.734 Test Loss: 1.139 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6333863735198975
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.728 Test Loss: 1.171 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9746325016021729
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.740 Test Loss: 1.106 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8578639030456543
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.740 Test Loss: 1.081 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1085311
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.977069616317749
Epoch: 1, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.077 Vali Acc: 0.532 Test Loss: 1.077 Test Acc: 0.532
Validation loss decreased (inf --> -0.531781).  Saving model ...
Epoch: 2 cost time: 1.4155545234680176
Epoch: 2, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.840 Vali Acc: 0.699 Test Loss: 0.840 Test Acc: 0.699
Validation loss decreased (-0.531781 --> -0.699414).  Saving model ...
Epoch: 3 cost time: 1.2624495029449463
Epoch: 3, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.022 Vali Acc: 0.688 Test Loss: 1.022 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2414765357971191
Epoch: 4, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.044 Vali Acc: 0.740 Test Loss: 1.044 Test Acc: 0.740
Validation loss decreased (-0.699414 --> -0.739874).  Saving model ...
Epoch: 5 cost time: 1.541815996170044
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.526 Vali Acc: 0.699 Test Loss: 1.526 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5538756847381592
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.615 Vali Acc: 0.705 Test Loss: 1.615 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5134363174438477
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.331 Vali Acc: 0.740 Test Loss: 1.331 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5339555740356445
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.695 Vali Acc: 0.676 Test Loss: 1.695 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4210751056671143
Epoch: 9, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.459 Vali Acc: 0.699 Test Loss: 1.459 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.336686134338379
Epoch: 10, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.743 Vali Acc: 0.699 Test Loss: 1.743 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.547825813293457
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.355 Vali Acc: 0.734 Test Loss: 1.355 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2170898914337158
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.950 Vali Acc: 0.676 Test Loss: 1.950 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4755239486694336
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.694 Vali Acc: 0.682 Test Loss: 2.694 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5747673511505127
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.421 Vali Acc: 0.757 Test Loss: 1.421 Test Acc: 0.757
Validation loss decreased (-0.739874 --> -0.757211).  Saving model ...
Epoch: 15 cost time: 1.564479112625122
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.098 Vali Acc: 0.682 Test Loss: 2.098 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5255231857299805
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.711 Test Loss: 1.876 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4181575775146484
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.736 Vali Acc: 0.699 Test Loss: 2.736 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4883372783660889
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 3.306 Vali Acc: 0.694 Test Loss: 3.306 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.258540153503418
Epoch: 19, Steps: 17 | Train Loss: 0.098 Vali Loss: 3.115 Vali Acc: 0.682 Test Loss: 3.115 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3776772022247314
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.700 Vali Acc: 0.694 Test Loss: 3.700 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2520561218261719
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.708 Vali Acc: 0.694 Test Loss: 3.708 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2706646919250488
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.719 Vali Acc: 0.694 Test Loss: 3.719 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3717026710510254
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.690 Vali Acc: 0.694 Test Loss: 3.690 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3467803001403809
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.672 Vali Acc: 0.694 Test Loss: 3.672 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1084543
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5177955627441406
Epoch: 1, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.254 Vali Acc: 0.428 Test Loss: 1.254 Test Acc: 0.428
Validation loss decreased (inf --> -0.427733).  Saving model ...
Epoch: 2 cost time: 1.2473580837249756
Epoch: 2, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.945 Vali Acc: 0.642 Test Loss: 0.945 Test Acc: 0.642
Validation loss decreased (-0.427733 --> -0.641609).  Saving model ...
Epoch: 3 cost time: 1.3911550045013428
Epoch: 3, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.783 Vali Acc: 0.775 Test Loss: 0.783 Test Acc: 0.775
Validation loss decreased (-0.641609 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 1.1428894996643066
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.274 Vali Acc: 0.699 Test Loss: 1.274 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1678800582885742
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.594 Vali Acc: 0.694 Test Loss: 1.594 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1235270500183105
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.490 Vali Acc: 0.769 Test Loss: 1.490 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1259517669677734
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.443 Vali Acc: 0.740 Test Loss: 1.443 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3618261814117432
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.588 Vali Acc: 0.717 Test Loss: 1.588 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2739205360412598
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.054 Vali Acc: 0.659 Test Loss: 2.054 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.210092544555664
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.279 Vali Acc: 0.757 Test Loss: 1.279 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1564083099365234
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 3.036 Vali Acc: 0.671 Test Loss: 3.036 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2958617210388184
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.740 Vali Acc: 0.705 Test Loss: 1.740 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.328796148300171
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.136 Vali Acc: 0.688 Test Loss: 2.136 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1084031
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.477203130722046
Epoch: 1, Steps: 17 | Train Loss: 1.785 Vali Loss: 1.144 Vali Acc: 0.497 Test Loss: 1.144 Test Acc: 0.497
Validation loss decreased (inf --> -0.497098).  Saving model ...
Epoch: 2 cost time: 1.1870100498199463
Epoch: 2, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.847 Vali Acc: 0.717 Test Loss: 0.847 Test Acc: 0.717
Validation loss decreased (-0.497098 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 1.2354671955108643
Epoch: 3, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.070 Vali Acc: 0.705 Test Loss: 1.070 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0697503089904785
Epoch: 4, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.732 Vali Acc: 0.780 Test Loss: 0.732 Test Acc: 0.780
Validation loss decreased (-0.716755 --> -0.780340).  Saving model ...
Epoch: 5 cost time: 1.035076379776001
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.494 Vali Acc: 0.734 Test Loss: 1.494 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1695661544799805
Epoch: 6, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.206 Vali Acc: 0.757 Test Loss: 1.206 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1796748638153076
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.028 Vali Acc: 0.798 Test Loss: 1.028 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797678).  Saving model ...
Epoch: 8 cost time: 1.1454453468322754
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.202 Vali Acc: 0.746 Test Loss: 1.202 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1079800128936768
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.619 Vali Acc: 0.728 Test Loss: 1.619 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1477396488189697
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.426 Vali Acc: 0.734 Test Loss: 1.426 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2420217990875244
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.324 Vali Acc: 0.763 Test Loss: 1.324 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.230893850326538
Epoch: 12, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.913 Vali Acc: 0.705 Test Loss: 1.913 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.135974407196045
Epoch: 13, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.930 Vali Acc: 0.763 Test Loss: 1.930 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1532773971557617
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 2.271 Vali Acc: 0.740 Test Loss: 2.271 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1665339469909668
Epoch: 15, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.956 Vali Acc: 0.734 Test Loss: 1.956 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.267897367477417
Epoch: 16, Steps: 17 | Train Loss: 0.129 Vali Loss: 2.714 Vali Acc: 0.751 Test Loss: 2.714 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1736702919006348
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.761 Vali Acc: 0.751 Test Loss: 2.761 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1083775
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.0464205741882324
Epoch: 1, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.203 Vali Acc: 0.538 Test Loss: 1.203 Test Acc: 0.538
Validation loss decreased (inf --> -0.537560).  Saving model ...
Epoch: 2 cost time: 0.9497642517089844
Epoch: 2, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.868 Vali Acc: 0.723 Test Loss: 0.868 Test Acc: 0.723
Validation loss decreased (-0.537560 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 0.9774079322814941
Epoch: 3, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
Validation loss decreased (-0.722535 --> -0.751438).  Saving model ...
Epoch: 4 cost time: 0.9828574657440186
Epoch: 4, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.989 Vali Acc: 0.723 Test Loss: 0.989 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.019399881362915
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.263 Vali Acc: 0.717 Test Loss: 1.263 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9492588043212891
Epoch: 6, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.223 Vali Acc: 0.786 Test Loss: 1.223 Test Acc: 0.786
Validation loss decreased (-0.751438 --> -0.786115).  Saving model ...
Epoch: 7 cost time: 0.9278032779693604
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.490 Vali Acc: 0.728 Test Loss: 1.490 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.003664493560791
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.807 Vali Acc: 0.734 Test Loss: 1.807 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8697922229766846
Epoch: 9, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.389 Vali Acc: 0.775 Test Loss: 1.389 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9565370082855225
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.998 Vali Acc: 0.717 Test Loss: 1.998 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0348224639892578
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.681 Vali Acc: 0.740 Test Loss: 1.681 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9631834030151367
Epoch: 12, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.574 Vali Acc: 0.734 Test Loss: 1.574 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.033752679824829
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.239 Vali Acc: 0.763 Test Loss: 1.239 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0029890537261963
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.775 Test Loss: 1.165 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0786452293395996
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.775 Test Loss: 1.166 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9548909664154053
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.763 Test Loss: 1.167 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1083519
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5959792137145996
Epoch: 1, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.222 Vali Acc: 0.578 Test Loss: 1.222 Test Acc: 0.578
Validation loss decreased (inf --> -0.578022).  Saving model ...
Epoch: 2 cost time: 2.3851425647735596
Epoch: 2, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.693 Vali Acc: 0.705 Test Loss: 0.693 Test Acc: 0.705
Validation loss decreased (-0.578022 --> -0.705195).  Saving model ...
Epoch: 3 cost time: 2.22119402885437
Epoch: 3, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.045 Vali Acc: 0.688 Test Loss: 1.045 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1215078830718994
Epoch: 4, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.879 Vali Acc: 0.746 Test Loss: 0.879 Test Acc: 0.746
Validation loss decreased (-0.705195 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 2.0152719020843506
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.175 Vali Acc: 0.682 Test Loss: 1.175 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2139437198638916
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.965 Vali Acc: 0.798 Test Loss: 0.965 Test Acc: 0.798
Validation loss decreased (-0.745656 --> -0.797678).  Saving model ...
Epoch: 7 cost time: 2.439107894897461
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.853 Vali Acc: 0.659 Test Loss: 1.853 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4276461601257324
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.220 Vali Acc: 0.734 Test Loss: 1.220 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4960052967071533
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.850 Vali Acc: 0.659 Test Loss: 1.850 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.491486072540283
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.089 Vali Acc: 0.763 Test Loss: 1.089 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.192891836166382
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.888 Vali Acc: 0.803 Test Loss: 0.888 Test Acc: 0.803
Validation loss decreased (-0.797678 --> -0.803459).  Saving model ...
Epoch: 12 cost time: 2.384962558746338
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.523 Vali Acc: 0.659 Test Loss: 2.523 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.172866106033325
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 2.552 Vali Acc: 0.659 Test Loss: 2.552 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3274011611938477
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 2.308 Vali Acc: 0.665 Test Loss: 2.308 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2493553161621094
Epoch: 15, Steps: 17 | Train Loss: 0.166 Vali Loss: 2.037 Vali Acc: 0.740 Test Loss: 2.037 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2948157787323
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.489 Vali Acc: 0.763 Test Loss: 1.489 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.483347177505493
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 2.121 Vali Acc: 0.705 Test Loss: 2.121 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.504706859588623
Epoch: 18, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.785 Vali Acc: 0.757 Test Loss: 1.785 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.251783609390259
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.769 Test Loss: 1.686 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2890467643737793
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.814 Vali Acc: 0.728 Test Loss: 1.814 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.076753616333008
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.099 Vali Acc: 0.746 Test Loss: 2.099 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1072455
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0717146396636963
Epoch: 1, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.411 Vali Acc: 0.474 Test Loss: 1.411 Test Acc: 0.474
Validation loss decreased (inf --> -0.473974).  Saving model ...
Epoch: 2 cost time: 1.9706909656524658
Epoch: 2, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.960 Vali Acc: 0.653 Test Loss: 0.960 Test Acc: 0.653
Validation loss decreased (-0.473974 --> -0.653170).  Saving model ...
Epoch: 3 cost time: 2.0998709201812744
Epoch: 3, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.949 Vali Acc: 0.688 Test Loss: 0.949 Test Acc: 0.688
Validation loss decreased (-0.653170 --> -0.687852).  Saving model ...
Epoch: 4 cost time: 2.0848946571350098
Epoch: 4, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.763 Vali Acc: 0.792 Test Loss: 0.763 Test Acc: 0.792
Validation loss decreased (-0.687852 --> -0.791900).  Saving model ...
Epoch: 5 cost time: 1.8903288841247559
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.751 Test Loss: 0.910 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9285762310028076
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0191543102264404
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.750 Vali Acc: 0.798 Test Loss: 0.750 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797680).  Saving model ...
Epoch: 8 cost time: 2.243271589279175
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.011 Vali Acc: 0.734 Test Loss: 1.011 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9267361164093018
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.207962989807129
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.769 Test Loss: 0.803 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2109386920928955
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.775 Test Loss: 0.780 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1760847568511963
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.792 Test Loss: 0.758 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0454607009887695
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.792 Test Loss: 0.750 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0544564723968506
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.792 Test Loss: 0.745 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.941950798034668
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.792 Test Loss: 0.742 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9644598960876465
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.792 Test Loss: 0.741 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8667142391204834
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.792 Test Loss: 0.739 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1071687
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8771109580993652
Epoch: 1, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.453 Vali Acc: 0.457 Test Loss: 1.453 Test Acc: 0.457
Validation loss decreased (inf --> -0.456633).  Saving model ...
Epoch: 2 cost time: 1.4418058395385742
Epoch: 2, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.963 Vali Acc: 0.636 Test Loss: 0.963 Test Acc: 0.636
Validation loss decreased (-0.456633 --> -0.635829).  Saving model ...
Epoch: 3 cost time: 1.7405505180358887
Epoch: 3, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.084 Vali Acc: 0.699 Test Loss: 1.084 Test Acc: 0.699
Validation loss decreased (-0.635829 --> -0.699411).  Saving model ...
Epoch: 4 cost time: 1.8143155574798584
Epoch: 4, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.863 Vali Acc: 0.757 Test Loss: 0.863 Test Acc: 0.757
Validation loss decreased (-0.699411 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 1.7738559246063232
Epoch: 5, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.839 Vali Acc: 0.723 Test Loss: 1.839 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7586243152618408
Epoch: 6, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.038 Vali Acc: 0.728 Test Loss: 2.038 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7904014587402344
Epoch: 7, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.848 Vali Acc: 0.694 Test Loss: 1.848 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.661954402923584
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.343 Vali Acc: 0.711 Test Loss: 1.343 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9386672973632812
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.752 Vali Acc: 0.792 Test Loss: 1.752 Test Acc: 0.792
Validation loss decreased (-0.757217 --> -0.791890).  Saving model ...
Epoch: 10 cost time: 1.6690716743469238
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.190 Vali Acc: 0.780 Test Loss: 1.190 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8814680576324463
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.757 Test Loss: 1.691 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9914326667785645
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.693 Vali Acc: 0.746 Test Loss: 1.693 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.18153977394104
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.757 Test Loss: 1.679 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.001206159591675
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.757 Test Loss: 1.588 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9925925731658936
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.757 Test Loss: 1.551 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9332280158996582
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.757 Test Loss: 1.530 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1510400772094727
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.757 Test Loss: 1.516 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.190645933151245
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.757 Test Loss: 1.503 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1571316719055176
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.757 Test Loss: 1.493 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1070663
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.958822250366211
Epoch: 1, Steps: 17 | Train Loss: 1.736 Vali Loss: 1.377 Vali Acc: 0.462 Test Loss: 1.377 Test Acc: 0.462
Validation loss decreased (inf --> -0.462414).  Saving model ...
Epoch: 2 cost time: 1.8190083503723145
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.898 Vali Acc: 0.717 Test Loss: 0.898 Test Acc: 0.717
Validation loss decreased (-0.462414 --> -0.716754).  Saving model ...
Epoch: 3 cost time: 1.4436309337615967
Epoch: 3, Steps: 17 | Train Loss: 0.258 Vali Loss: 1.455 Vali Acc: 0.676 Test Loss: 1.455 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4028048515319824
Epoch: 4, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.408 Vali Acc: 0.717 Test Loss: 1.408 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6606721878051758
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.309 Vali Acc: 0.694 Test Loss: 1.309 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7487845420837402
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.108 Vali Acc: 0.757 Test Loss: 1.108 Test Acc: 0.757
Validation loss decreased (-0.716754 --> -0.757214).  Saving model ...
Epoch: 7 cost time: 1.928276777267456
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.537 Vali Acc: 0.676 Test Loss: 1.537 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7696576118469238
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.477 Vali Acc: 0.723 Test Loss: 1.477 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.81280517578125
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.690 Vali Acc: 0.717 Test Loss: 1.690 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.700622797012329
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.723 Test Loss: 1.519 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6786694526672363
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.751 Test Loss: 1.087 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8184833526611328
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.757 Test Loss: 1.049 Test Acc: 0.757
Validation loss decreased (-0.757214 --> -0.757215).  Saving model ...
Epoch: 13 cost time: 1.6115446090698242
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.769 Test Loss: 1.141 Test Acc: 0.769
Validation loss decreased (-0.757215 --> -0.768775).  Saving model ...
Epoch: 14 cost time: 1.7599642276763916
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.769 Test Loss: 1.151 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5784733295440674
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.769 Test Loss: 1.149 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6261568069458008
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.769 Test Loss: 1.141 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5255556106567383
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.769 Test Loss: 1.137 Test Acc: 0.769
Validation loss decreased (-0.768775 --> -0.768775).  Saving model ...
Epoch: 18 cost time: 1.4117565155029297
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.769 Test Loss: 1.135 Test Acc: 0.769
Validation loss decreased (-0.768775 --> -0.768775).  Saving model ...
Epoch: 19 cost time: 1.770108699798584
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.769 Test Loss: 1.133 Test Acc: 0.769
Validation loss decreased (-0.768775 --> -0.768775).  Saving model ...
Epoch: 20 cost time: 1.7232463359832764
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.757 Test Loss: 1.132 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6701595783233643
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.757 Test Loss: 1.131 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6337409019470215
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.757 Test Loss: 1.128 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8996307849884033
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.757 Test Loss: 1.130 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6382484436035156
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.757 Test Loss: 1.128 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7775917053222656
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.757 Test Loss: 1.124 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8217730522155762
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.757 Test Loss: 1.124 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9154057502746582
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.123 Vali Acc: 0.757 Test Loss: 1.123 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7358486652374268
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.757 Test Loss: 1.122 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6661639213562012
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.757 Test Loss: 1.122 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1069895
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7697885036468506
Epoch: 1, Steps: 17 | Train Loss: 1.652 Vali Loss: 1.275 Vali Acc: 0.497 Test Loss: 1.275 Test Acc: 0.497
Validation loss decreased (inf --> -0.497097).  Saving model ...
Epoch: 2 cost time: 1.501760482788086
Epoch: 2, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.803 Vali Acc: 0.705 Test Loss: 0.803 Test Acc: 0.705
Validation loss decreased (-0.497097 --> -0.705194).  Saving model ...
Epoch: 3 cost time: 1.3606641292572021
Epoch: 3, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.705194 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 1.5730955600738525
Epoch: 4, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.842 Vali Acc: 0.792 Test Loss: 0.842 Test Acc: 0.792
Validation loss decreased (-0.774559 --> -0.791899).  Saving model ...
Epoch: 5 cost time: 1.553056240081787
Epoch: 5, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.397 Vali Acc: 0.676 Test Loss: 1.397 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5712671279907227
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.543 Vali Acc: 0.751 Test Loss: 1.543 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5698504447937012
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.487 Vali Acc: 0.769 Test Loss: 1.487 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4439632892608643
Epoch: 8, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.544 Vali Acc: 0.711 Test Loss: 1.544 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.48459792137146
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.490 Vali Acc: 0.751 Test Loss: 1.490 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3160316944122314
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.228 Vali Acc: 0.763 Test Loss: 1.228 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5825691223144531
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.757 Test Loss: 1.092 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3401968479156494
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.746 Test Loss: 1.090 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3689525127410889
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.757 Test Loss: 1.082 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3441798686981201
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.757 Test Loss: 1.075 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1069127
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4971325397491455
Epoch: 1, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.303 Vali Acc: 0.474 Test Loss: 1.303 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 1.1673846244812012
Epoch: 2, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.863 Vali Acc: 0.699 Test Loss: 0.863 Test Acc: 0.699
Validation loss decreased (-0.473975 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 1.1685903072357178
Epoch: 3, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.872 Vali Acc: 0.769 Test Loss: 0.872 Test Acc: 0.769
Validation loss decreased (-0.699413 --> -0.768777).  Saving model ...
Epoch: 4 cost time: 1.2373876571655273
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.220 Vali Acc: 0.682 Test Loss: 1.220 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2851850986480713
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.965 Vali Acc: 0.723 Test Loss: 0.965 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2715110778808594
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.940 Vali Acc: 0.775 Test Loss: 0.940 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774557).  Saving model ...
Epoch: 7 cost time: 1.2329776287078857
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.286 Vali Acc: 0.734 Test Loss: 1.286 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.20743727684021
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.015 Vali Acc: 0.717 Test Loss: 1.015 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2109699249267578
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.546 Vali Acc: 0.757 Test Loss: 1.546 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1568045616149902
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.084 Vali Acc: 0.769 Test Loss: 1.084 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1742897033691406
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.775 Test Loss: 0.964 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.092806100845337
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.786 Test Loss: 0.924 Test Acc: 0.786
Validation loss decreased (-0.774557 --> -0.786118).  Saving model ...
Epoch: 13 cost time: 1.3217170238494873
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.792 Test Loss: 0.907 Test Acc: 0.792
Validation loss decreased (-0.786118 --> -0.791898).  Saving model ...
Epoch: 14 cost time: 1.1398820877075195
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.792 Test Loss: 0.896 Test Acc: 0.792
Validation loss decreased (-0.791898 --> -0.791899).  Saving model ...
Epoch: 15 cost time: 1.2373127937316895
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.792 Test Loss: 0.886 Test Acc: 0.792
Validation loss decreased (-0.791899 --> -0.791899).  Saving model ...
Epoch: 16 cost time: 1.2237050533294678
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.786 Test Loss: 0.879 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3313565254211426
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.780 Test Loss: 0.874 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1836740970611572
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.780 Test Loss: 0.869 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.214179515838623
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.780 Test Loss: 0.864 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2168855667114258
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.775 Test Loss: 0.860 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9855048656463623
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1405584812164307
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1854760646820068
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2395226955413818
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2806084156036377
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1068615
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4089531898498535
Epoch: 1, Steps: 17 | Train Loss: 1.723 Vali Loss: 1.369 Vali Acc: 0.520 Test Loss: 1.369 Test Acc: 0.520
Validation loss decreased (inf --> -0.520218).  Saving model ...
Epoch: 2 cost time: 1.2040977478027344
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.706 Vali Acc: 0.746 Test Loss: 0.706 Test Acc: 0.746
Validation loss decreased (-0.520218 --> -0.745658).  Saving model ...
Epoch: 3 cost time: 1.2364733219146729
Epoch: 3, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.853 Vali Acc: 0.734 Test Loss: 0.853 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1170063018798828
Epoch: 4, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.745658 --> -0.774557).  Saving model ...
Epoch: 5 cost time: 1.110816240310669
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.118 Vali Acc: 0.734 Test Loss: 1.118 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.196124792098999
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.967 Vali Acc: 0.798 Test Loss: 0.967 Test Acc: 0.798
Validation loss decreased (-0.774557 --> -0.797678).  Saving model ...
Epoch: 7 cost time: 1.026432991027832
Epoch: 7, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.414 Vali Acc: 0.723 Test Loss: 1.414 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1431291103363037
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.251 Vali Acc: 0.723 Test Loss: 1.251 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0932867527008057
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.224 Vali Acc: 0.763 Test Loss: 1.224 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1581881046295166
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.492 Vali Acc: 0.717 Test Loss: 1.492 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.051198959350586
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.070 Vali Acc: 0.803 Test Loss: 1.070 Test Acc: 0.803
Validation loss decreased (-0.797678 --> -0.803458).  Saving model ...
Epoch: 12 cost time: 1.0504872798919678
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.757 Test Loss: 1.124 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0852100849151611
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.740 Test Loss: 1.276 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1252882480621338
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.751 Test Loss: 1.271 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1561415195465088
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.751 Test Loss: 1.226 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1604771614074707
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.751 Test Loss: 1.208 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1767070293426514
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.751 Test Loss: 1.198 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2448906898498535
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.775 Test Loss: 1.192 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.12978196144104
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.775 Test Loss: 1.187 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1690545082092285
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.775 Test Loss: 1.183 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.119152545928955
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.775 Test Loss: 1.177 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1068359
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 1.874743938446045
Epoch: 1, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.098 Vali Acc: 0.543 Test Loss: 1.098 Test Acc: 0.543
Validation loss decreased (inf --> -0.543342).  Saving model ...
Epoch: 2 cost time: 0.9710550308227539
Epoch: 2, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.854 Vali Acc: 0.723 Test Loss: 0.854 Test Acc: 0.723
Validation loss decreased (-0.543342 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 0.9054605960845947
Epoch: 3, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.743 Vali Acc: 0.740 Test Loss: 0.743 Test Acc: 0.740
Validation loss decreased (-0.722535 --> -0.739877).  Saving model ...
Epoch: 4 cost time: 0.9756197929382324
Epoch: 4, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.086 Vali Acc: 0.717 Test Loss: 1.086 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9756159782409668
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.936 Vali Acc: 0.746 Test Loss: 0.936 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745655).  Saving model ...
Epoch: 6 cost time: 0.9778075218200684
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.063 Vali Acc: 0.688 Test Loss: 1.063 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8697803020477295
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.705 Test Loss: 1.359 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.972257137298584
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.067 Vali Acc: 0.717 Test Loss: 1.067 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9286160469055176
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.928 Vali Acc: 0.751 Test Loss: 0.928 Test Acc: 0.751
Validation loss decreased (-0.745655 --> -0.751436).  Saving model ...
Epoch: 10 cost time: 0.9804947376251221
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.752 Vali Acc: 0.694 Test Loss: 1.752 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9774951934814453
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.292 Vali Acc: 0.723 Test Loss: 1.292 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9751255512237549
Epoch: 12, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.955 Vali Acc: 0.757 Test Loss: 1.955 Test Acc: 0.757
Validation loss decreased (-0.751436 --> -0.757206).  Saving model ...
Epoch: 13 cost time: 0.9689135551452637
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 2.202 Vali Acc: 0.711 Test Loss: 2.202 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8753073215484619
Epoch: 14, Steps: 17 | Train Loss: 0.265 Vali Loss: 3.022 Vali Acc: 0.671 Test Loss: 3.022 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0235106945037842
Epoch: 15, Steps: 17 | Train Loss: 0.273 Vali Loss: 3.517 Vali Acc: 0.607 Test Loss: 3.517 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0300629138946533
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 4.088 Vali Acc: 0.665 Test Loss: 4.088 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8824479579925537
Epoch: 17, Steps: 17 | Train Loss: 0.420 Vali Loss: 2.572 Vali Acc: 0.751 Test Loss: 2.572 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.953498125076294
Epoch: 18, Steps: 17 | Train Loss: 0.063 Vali Loss: 4.086 Vali Acc: 0.688 Test Loss: 4.086 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8217110633850098
Epoch: 19, Steps: 17 | Train Loss: 0.131 Vali Loss: 3.794 Vali Acc: 0.769 Test Loss: 3.794 Test Acc: 0.769
Validation loss decreased (-0.757206 --> -0.768748).  Saving model ...
Epoch: 20 cost time: 0.9801592826843262
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.395 Vali Acc: 0.757 Test Loss: 2.395 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9563226699829102
Epoch: 21, Steps: 17 | Train Loss: 0.051 Vali Loss: 3.626 Vali Acc: 0.734 Test Loss: 3.626 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9247076511383057
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 3.672 Vali Acc: 0.769 Test Loss: 3.672 Test Acc: 0.769
Validation loss decreased (-0.768748 --> -0.768749).  Saving model ...
Epoch: 23 cost time: 0.9373204708099365
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.642 Vali Acc: 0.763 Test Loss: 3.642 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0346968173980713
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.671 Vali Acc: 0.751 Test Loss: 3.671 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0029399394989014
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.659 Vali Acc: 0.751 Test Loss: 3.659 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0592460632324219
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.647 Vali Acc: 0.751 Test Loss: 3.647 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9885358810424805
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.643 Vali Acc: 0.751 Test Loss: 3.643 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.106879472732544
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.642 Vali Acc: 0.751 Test Loss: 3.642 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0008172988891602
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.640 Vali Acc: 0.751 Test Loss: 3.640 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0659782886505127
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.751 Test Loss: 3.638 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9971535205841064
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.751 Test Loss: 3.637 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9867672920227051
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.636 Vali Acc: 0.751 Test Loss: 3.636 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1068103
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7757458686828613
Epoch: 1, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.170 Vali Acc: 0.509 Test Loss: 1.170 Test Acc: 0.509
Validation loss decreased (inf --> -0.508659).  Saving model ...
Epoch: 2 cost time: 2.4701414108276367
Epoch: 2, Steps: 17 | Train Loss: 0.467 Vali Loss: 1.296 Vali Acc: 0.647 Test Loss: 1.296 Test Acc: 0.647
Validation loss decreased (-0.508659 --> -0.647386).  Saving model ...
Epoch: 3 cost time: 2.325429677963257
Epoch: 3, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.706 Vali Acc: 0.757 Test Loss: 0.706 Test Acc: 0.757
Validation loss decreased (-0.647386 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 2.5869786739349365
Epoch: 4, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.081 Vali Acc: 0.740 Test Loss: 1.081 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5371387004852295
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.431 Vali Acc: 0.705 Test Loss: 1.431 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5221290588378906
Epoch: 6, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.594 Vali Acc: 0.665 Test Loss: 2.594 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.466817855834961
Epoch: 7, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.072 Vali Acc: 0.728 Test Loss: 2.072 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6898162364959717
Epoch: 8, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.819 Vali Acc: 0.740 Test Loss: 1.819 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.628594160079956
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 2.377 Vali Acc: 0.734 Test Loss: 2.377 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5066728591918945
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.951 Vali Acc: 0.717 Test Loss: 1.951 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7460999488830566
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.865 Vali Acc: 0.740 Test Loss: 1.865 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8458454608917236
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.985 Vali Acc: 0.711 Test Loss: 1.985 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8764917850494385
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.749 Vali Acc: 0.728 Test Loss: 1.749 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1064747
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3178443908691406
Epoch: 1, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.446 Vali Acc: 0.434 Test Loss: 1.446 Test Acc: 0.434
Validation loss decreased (inf --> -0.433512).  Saving model ...
Epoch: 2 cost time: 1.9604053497314453
Epoch: 2, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.871 Vali Acc: 0.723 Test Loss: 0.871 Test Acc: 0.723
Validation loss decreased (-0.433512 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.9809467792510986
Epoch: 3, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.652 Vali Acc: 0.705 Test Loss: 0.652 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0154497623443604
Epoch: 4, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.281 Vali Acc: 0.699 Test Loss: 1.281 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4200751781463623
Epoch: 5, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.400 Vali Acc: 0.653 Test Loss: 1.400 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5010735988616943
Epoch: 6, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.843 Vali Acc: 0.647 Test Loss: 1.843 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5764007568359375
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.637 Vali Acc: 0.717 Test Loss: 1.637 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3710532188415527
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.144 Vali Acc: 0.751 Test Loss: 2.144 Test Acc: 0.751
Validation loss decreased (-0.722535 --> -0.751424).  Saving model ...
Epoch: 9 cost time: 2.395951986312866
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.382 Vali Acc: 0.682 Test Loss: 2.382 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4870808124542236
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.861 Vali Acc: 0.746 Test Loss: 1.861 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2331416606903076
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.282 Vali Acc: 0.676 Test Loss: 2.282 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3930163383483887
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.826 Vali Acc: 0.723 Test Loss: 1.826 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3714966773986816
Epoch: 13, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.940 Vali Acc: 0.659 Test Loss: 2.940 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5480399131774902
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.835 Vali Acc: 0.636 Test Loss: 2.835 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4038009643554688
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.809 Vali Acc: 0.728 Test Loss: 1.809 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4740970134735107
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.740 Test Loss: 1.866 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.457991361618042
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.430 Vali Acc: 0.775 Test Loss: 1.430 Test Acc: 0.775
Validation loss decreased (-0.751424 --> -0.774552).  Saving model ...
Epoch: 18 cost time: 2.1952521800994873
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.021 Vali Acc: 0.694 Test Loss: 3.021 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.459552526473999
Epoch: 19, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.866 Vali Acc: 0.757 Test Loss: 1.866 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6190881729125977
Epoch: 20, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.559 Vali Acc: 0.740 Test Loss: 1.559 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.452301025390625
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.840 Vali Acc: 0.740 Test Loss: 1.840 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5105478763580322
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.450 Vali Acc: 0.780 Test Loss: 1.450 Test Acc: 0.780
Validation loss decreased (-0.774552 --> -0.780332).  Saving model ...
Epoch: 23 cost time: 2.5035200119018555
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 3.401 Vali Acc: 0.705 Test Loss: 3.401 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.372025728225708
Epoch: 24, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.005 Vali Acc: 0.705 Test Loss: 2.005 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.454721212387085
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.763 Test Loss: 1.594 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4526875019073486
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.792 Test Loss: 1.626 Test Acc: 0.792
Validation loss decreased (-0.780332 --> -0.791891).  Saving model ...
Epoch: 27 cost time: 2.3556156158447266
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.682 Vali Acc: 0.792 Test Loss: 1.682 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.322280168533325
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.792 Test Loss: 1.691 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.475132465362549
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.692 Vali Acc: 0.792 Test Loss: 1.692 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.6220784187316895
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.792 Test Loss: 1.694 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.5439348220825195
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.792 Test Loss: 1.694 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.890895128250122
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.786 Test Loss: 1.695 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.7116200923919678
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.786 Test Loss: 1.695 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.7260987758636475
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.786 Test Loss: 1.696 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.7667641639709473
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.786 Test Loss: 1.695 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.920631170272827
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.786 Test Loss: 1.696 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1063979
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.172938585281372
Epoch: 1, Steps: 17 | Train Loss: 1.758 Vali Loss: 1.273 Vali Acc: 0.509 Test Loss: 1.273 Test Acc: 0.509
Validation loss decreased (inf --> -0.508658).  Saving model ...
Epoch: 2 cost time: 1.7799558639526367
Epoch: 2, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.768 Vali Acc: 0.723 Test Loss: 0.768 Test Acc: 0.723
Validation loss decreased (-0.508658 --> -0.722536).  Saving model ...
Epoch: 3 cost time: 1.7718541622161865
Epoch: 3, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.844 Vali Acc: 0.757 Test Loss: 0.844 Test Acc: 0.757
Validation loss decreased (-0.722536 --> -0.757217).  Saving model ...
Epoch: 4 cost time: 1.853898048400879
Epoch: 4, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.343 Vali Acc: 0.711 Test Loss: 1.343 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.153754234313965
Epoch: 5, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.580 Vali Acc: 0.711 Test Loss: 1.580 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0458555221557617
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.778 Vali Acc: 0.694 Test Loss: 1.778 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8578746318817139
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.450 Vali Acc: 0.659 Test Loss: 2.450 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0296976566314697
Epoch: 8, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.787 Vali Acc: 0.705 Test Loss: 1.787 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0442721843719482
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.267 Vali Acc: 0.734 Test Loss: 2.267 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9034652709960938
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 2.373 Vali Acc: 0.688 Test Loss: 2.373 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0202629566192627
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.539 Vali Acc: 0.734 Test Loss: 1.539 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0132479667663574
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.593 Vali Acc: 0.734 Test Loss: 1.593 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7351710796356201
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 3.805 Vali Acc: 0.578 Test Loss: 3.805 Test Acc: 0.578
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 1062955
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1987171173095703
Epoch: 1, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.308 Vali Acc: 0.509 Test Loss: 1.308 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 1.7870194911956787
Epoch: 2, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.127 Vali Acc: 0.618 Test Loss: 1.127 Test Acc: 0.618
Validation loss decreased (-0.508657 --> -0.618486).  Saving model ...
Epoch: 3 cost time: 2.023420572280884
Epoch: 3, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.385 Vali Acc: 0.671 Test Loss: 1.385 Test Acc: 0.671
Validation loss decreased (-0.618486 --> -0.670506).  Saving model ...
Epoch: 4 cost time: 1.976811170578003
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.207 Vali Acc: 0.682 Test Loss: 1.207 Test Acc: 0.682
Validation loss decreased (-0.670506 --> -0.682069).  Saving model ...
Epoch: 5 cost time: 1.7133970260620117
Epoch: 5, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.447 Vali Acc: 0.676 Test Loss: 1.447 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9846084117889404
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.249 Vali Acc: 0.717 Test Loss: 1.249 Test Acc: 0.717
Validation loss decreased (-0.682069 --> -0.716751).  Saving model ...
Epoch: 7 cost time: 1.934617042541504
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.588 Vali Acc: 0.659 Test Loss: 2.588 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7016246318817139
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.363 Vali Acc: 0.740 Test Loss: 1.363 Test Acc: 0.740
Validation loss decreased (-0.716751 --> -0.739871).  Saving model ...
Epoch: 9 cost time: 2.030532121658325
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 4.690 Vali Acc: 0.595 Test Loss: 4.690 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8968429565429688
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 3.009 Vali Acc: 0.636 Test Loss: 3.009 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6308250427246094
Epoch: 11, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.552 Vali Acc: 0.665 Test Loss: 2.552 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9541754722595215
Epoch: 12, Steps: 17 | Train Loss: 0.079 Vali Loss: 2.587 Vali Acc: 0.705 Test Loss: 2.587 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6299829483032227
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.393 Vali Acc: 0.699 Test Loss: 2.393 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6503958702087402
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 2.269 Vali Acc: 0.705 Test Loss: 2.269 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7080585956573486
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.810 Vali Acc: 0.694 Test Loss: 2.810 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8252604007720947
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.595 Vali Acc: 0.717 Test Loss: 2.595 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3586854934692383
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.328 Vali Acc: 0.682 Test Loss: 2.328 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1982431411743164
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.246 Vali Acc: 0.705 Test Loss: 2.246 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 1062187
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7319624423980713
Epoch: 1, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.366 Vali Acc: 0.514 Test Loss: 1.366 Test Acc: 0.514
Validation loss decreased (inf --> -0.514437).  Saving model ...
Epoch: 2 cost time: 1.2599637508392334
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.990 Vali Acc: 0.636 Test Loss: 0.990 Test Acc: 0.636
Validation loss decreased (-0.514437 --> -0.635828).  Saving model ...
Epoch: 3 cost time: 1.2399060726165771
Epoch: 3, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.052 Vali Acc: 0.723 Test Loss: 1.052 Test Acc: 0.723
Validation loss decreased (-0.635828 --> -0.722533).  Saving model ...
Epoch: 4 cost time: 1.3022832870483398
Epoch: 4, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.002 Vali Acc: 0.723 Test Loss: 1.002 Test Acc: 0.723
Validation loss decreased (-0.722533 --> -0.722533).  Saving model ...
Epoch: 5 cost time: 1.317232608795166
Epoch: 5, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.487 Vali Acc: 0.694 Test Loss: 1.487 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.33134126663208
Epoch: 6, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.208 Vali Acc: 0.734 Test Loss: 1.208 Test Acc: 0.734
Validation loss decreased (-0.722533 --> -0.734092).  Saving model ...
Epoch: 7 cost time: 1.397942304611206
Epoch: 7, Steps: 17 | Train Loss: 0.291 Vali Loss: 2.363 Vali Acc: 0.682 Test Loss: 2.363 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3972995281219482
Epoch: 8, Steps: 17 | Train Loss: 0.170 Vali Loss: 2.010 Vali Acc: 0.717 Test Loss: 2.010 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.458589792251587
Epoch: 9, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.536 Vali Acc: 0.688 Test Loss: 2.536 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5079493522644043
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.383 Vali Acc: 0.740 Test Loss: 2.383 Test Acc: 0.740
Validation loss decreased (-0.734092 --> -0.739861).  Saving model ...
Epoch: 11 cost time: 1.4604828357696533
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.559 Vali Acc: 0.676 Test Loss: 2.559 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6517448425292969
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.952 Vali Acc: 0.705 Test Loss: 2.952 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5801122188568115
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.206 Vali Acc: 0.717 Test Loss: 2.206 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.642596960067749
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.101 Vali Acc: 0.740 Test Loss: 3.101 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5588023662567139
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.732 Vali Acc: 0.653 Test Loss: 2.732 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7742412090301514
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 3.772 Vali Acc: 0.699 Test Loss: 3.772 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6463325023651123
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 3.394 Vali Acc: 0.705 Test Loss: 3.394 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4108476638793945
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.854 Vali Acc: 0.734 Test Loss: 2.854 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.620051383972168
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 3.863 Vali Acc: 0.723 Test Loss: 3.863 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4889678955078125
Epoch: 20, Steps: 17 | Train Loss: 0.050 Vali Loss: 4.098 Vali Acc: 0.699 Test Loss: 4.098 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 1061419
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.657978057861328
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.289 Vali Acc: 0.410 Test Loss: 1.289 Test Acc: 0.410
Validation loss decreased (inf --> -0.410392).  Saving model ...
Epoch: 2 cost time: 1.2558176517486572
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.973 Vali Acc: 0.647 Test Loss: 0.973 Test Acc: 0.647
Validation loss decreased (-0.410392 --> -0.647389).  Saving model ...
Epoch: 3 cost time: 1.3495936393737793
Epoch: 3, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.982 Vali Acc: 0.746 Test Loss: 0.982 Test Acc: 0.746
Validation loss decreased (-0.647389 --> -0.745655).  Saving model ...
Epoch: 4 cost time: 1.3873977661132812
Epoch: 4, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.076 Vali Acc: 0.723 Test Loss: 1.076 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1524112224578857
Epoch: 5, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.915 Vali Acc: 0.740 Test Loss: 0.915 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3059747219085693
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.303 Vali Acc: 0.728 Test Loss: 1.303 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.308661699295044
Epoch: 7, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.842 Vali Acc: 0.786 Test Loss: 0.842 Test Acc: 0.786
Validation loss decreased (-0.745655 --> -0.786119).  Saving model ...
Epoch: 8 cost time: 1.1761295795440674
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.054 Vali Acc: 0.775 Test Loss: 1.054 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2989935874938965
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.178 Vali Acc: 0.763 Test Loss: 1.178 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1822254657745361
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.384 Vali Acc: 0.763 Test Loss: 1.384 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3098094463348389
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.233 Vali Acc: 0.786 Test Loss: 1.233 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3398382663726807
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.156 Vali Acc: 0.763 Test Loss: 1.156 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3473010063171387
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.786 Test Loss: 0.789 Test Acc: 0.786
Validation loss decreased (-0.786119 --> -0.786119).  Saving model ...
Epoch: 14 cost time: 1.5576183795928955
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.798 Test Loss: 0.788 Test Acc: 0.798
Validation loss decreased (-0.786119 --> -0.797680).  Saving model ...
Epoch: 15 cost time: 1.4553756713867188
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.786 Test Loss: 0.761 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.478285312652588
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.798 Test Loss: 0.750 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 17 cost time: 1.4129860401153564
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.798 Test Loss: 0.742 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 18 cost time: 1.468817949295044
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.786 Test Loss: 0.738 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5434887409210205
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.786 Test Loss: 0.735 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.366549015045166
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.786 Test Loss: 0.732 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4795417785644531
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.786 Test Loss: 0.729 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4725301265716553
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.786 Test Loss: 0.727 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3124871253967285
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.786 Test Loss: 0.724 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2995145320892334
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.786 Test Loss: 0.723 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4033398628234863
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.786 Test Loss: 0.721 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4644043445587158
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.798 Test Loss: 0.720 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797681).  Saving model ...
Epoch: 27 cost time: 1.4770936965942383
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.798 Test Loss: 0.719 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 28 cost time: 1.3404552936553955
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.798 Test Loss: 0.717 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 29 cost time: 1.520691156387329
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.798 Test Loss: 0.715 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 30 cost time: 1.2488536834716797
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.798 Test Loss: 0.714 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 31 cost time: 1.4670829772949219
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.798 Test Loss: 0.713 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 32 cost time: 1.3402996063232422
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.798 Test Loss: 0.711 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 33 cost time: 1.4951488971710205
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.798 Test Loss: 0.710 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 34 cost time: 1.398756742477417
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.798 Test Loss: 0.708 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 35 cost time: 1.3046114444732666
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.786 Test Loss: 0.706 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.341432809829712
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.786 Test Loss: 0.705 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4291901588439941
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.786 Test Loss: 0.704 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2449345588684082
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.798 Test Loss: 0.702 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 39 cost time: 1.374711036682129
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.798 Test Loss: 0.701 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 40 cost time: 1.1914639472961426
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.798 Test Loss: 0.700 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 41 cost time: 1.4107882976531982
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 42 cost time: 1.2733592987060547
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.798 Test Loss: 0.697 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 43 cost time: 1.426098346710205
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 44 cost time: 1.407740831375122
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 45 cost time: 1.1994917392730713
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 46 cost time: 1.3633954524993896
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.798 Test Loss: 0.694 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 47 cost time: 1.21278715133667
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 48 cost time: 1.4049363136291504
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.798 Test Loss: 0.692 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 49 cost time: 1.1785311698913574
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.798 Test Loss: 0.691 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 50 cost time: 1.3210339546203613
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.798 Test Loss: 0.690 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 51 cost time: 1.3350324630737305
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.786 Test Loss: 0.689 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2642872333526611
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.786 Test Loss: 0.688 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2965986728668213
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.786 Test Loss: 0.687 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3703460693359375
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.786 Test Loss: 0.686 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.3597657680511475
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.786 Test Loss: 0.685 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2650058269500732
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.786 Test Loss: 0.684 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2699639797210693
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.798 Test Loss: 0.683 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 58 cost time: 1.3416268825531006
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.798 Test Loss: 0.683 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 59 cost time: 1.3617732524871826
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.798 Test Loss: 0.682 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 60 cost time: 1.2127916812896729
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 61 cost time: 1.0784757137298584
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 62 cost time: 1.0584237575531006
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1557819843292236
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.798 Test Loss: 0.680 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 64 cost time: 1.0514743328094482
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.798 Test Loss: 0.680 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 65 cost time: 1.050748586654663
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.798 Test Loss: 0.679 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 66 cost time: 1.2979624271392822
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.798 Test Loss: 0.679 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 67 cost time: 1.3123185634613037
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.798 Test Loss: 0.678 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 68 cost time: 1.5600275993347168
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.798 Test Loss: 0.678 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 69 cost time: 1.350280523300171
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.798 Test Loss: 0.677 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 70 cost time: 1.5471107959747314
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.798 Test Loss: 0.676 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 71 cost time: 1.3746883869171143
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.798 Test Loss: 0.676 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 72 cost time: 1.574643611907959
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.798 Test Loss: 0.675 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 73 cost time: 1.2739269733428955
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.798 Test Loss: 0.675 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 74 cost time: 1.565986156463623
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.798 Test Loss: 0.675 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.4146220684051514
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.798 Test Loss: 0.674 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 76 cost time: 1.2841591835021973
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.798 Test Loss: 0.674 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 77 cost time: 1.5103485584259033
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.798 Test Loss: 0.674 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 78 cost time: 1.3664326667785645
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.798 Test Loss: 0.674 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 79 cost time: 1.6185302734375
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.798 Test Loss: 0.673 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 80 cost time: 1.4021155834197998
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.798 Test Loss: 0.672 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 81 cost time: 1.5876257419586182
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.798 Test Loss: 0.671 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 82 cost time: 1.4557921886444092
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.798 Test Loss: 0.670 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 83 cost time: 1.416417121887207
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.798 Test Loss: 0.670 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 84 cost time: 1.5849969387054443
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.798 Test Loss: 0.670 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 85 cost time: 1.4445202350616455
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.798 Test Loss: 0.670 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.5476384162902832
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.798 Test Loss: 0.670 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.309319257736206
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.798 Test Loss: 0.670 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 88 cost time: 1.1205024719238281
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 89 cost time: 1.350450038909912
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 90 cost time: 1.199779748916626
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 91 cost time: 1.3190827369689941
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.2145891189575195
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 93 cost time: 1.3668267726898193
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.798 Test Loss: 0.668 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 94 cost time: 1.4304554462432861
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.798 Test Loss: 0.668 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 95 cost time: 1.293058156967163
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.798 Test Loss: 0.668 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 96 cost time: 1.3840172290802002
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.798 Test Loss: 0.668 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 97 cost time: 1.1524546146392822
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.798 Test Loss: 0.668 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 98 cost time: 1.4125821590423584
Epoch: 98, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.798 Test Loss: 0.667 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 99 cost time: 1.2535324096679688
Epoch: 99, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.798 Test Loss: 0.667 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.4408988952636719
Epoch: 100, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.798 Test Loss: 0.667 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1060907
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.214639663696289
Epoch: 1, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.530 Vali Acc: 0.405 Test Loss: 1.530 Test Acc: 0.405
Validation loss decreased (inf --> -0.404609).  Saving model ...
Epoch: 2 cost time: 1.0548861026763916
Epoch: 2, Steps: 17 | Train Loss: 0.735 Vali Loss: 1.372 Vali Acc: 0.595 Test Loss: 1.372 Test Acc: 0.595
Validation loss decreased (-0.404609 --> -0.595362).  Saving model ...
Epoch: 3 cost time: 1.173410415649414
Epoch: 3, Steps: 17 | Train Loss: 0.191 Vali Loss: 1.127 Vali Acc: 0.711 Test Loss: 1.127 Test Acc: 0.711
Validation loss decreased (-0.595362 --> -0.710971).  Saving model ...
Epoch: 4 cost time: 1.1699624061584473
Epoch: 4, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.474 Vali Acc: 0.665 Test Loss: 1.474 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.290212869644165
Epoch: 5, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.373 Vali Acc: 0.682 Test Loss: 1.373 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.396986484527588
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.676 Vali Acc: 0.711 Test Loss: 1.676 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.191809892654419
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.517 Vali Acc: 0.723 Test Loss: 1.517 Test Acc: 0.723
Validation loss decreased (-0.710971 --> -0.722528).  Saving model ...
Epoch: 8 cost time: 1.0986907482147217
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.961 Vali Acc: 0.711 Test Loss: 1.961 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3542263507843018
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.325 Vali Acc: 0.734 Test Loss: 1.325 Test Acc: 0.734
Validation loss decreased (-0.722528 --> -0.734091).  Saving model ...
Epoch: 10 cost time: 1.2789766788482666
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.751 Test Loss: 1.055 Test Acc: 0.751
Validation loss decreased (-0.734091 --> -0.751435).  Saving model ...
Epoch: 11 cost time: 1.526362657546997
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.798 Test Loss: 0.758 Test Acc: 0.798
Validation loss decreased (-0.751435 --> -0.797680).  Saving model ...
Epoch: 12 cost time: 1.4158318042755127
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.786 Test Loss: 0.782 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4330472946166992
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803461).  Saving model ...
Epoch: 14 cost time: 1.3637633323669434
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.809 Test Loss: 0.728 Test Acc: 0.809
Validation loss decreased (-0.803461 --> -0.809241).  Saving model ...
Epoch: 15 cost time: 1.3960578441619873
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4201841354370117
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.45290207862854
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3381149768829346
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4286386966705322
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3984317779541016
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5346240997314453
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3402605056762695
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.803 Test Loss: 0.676 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.454289436340332
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.386704921722412
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1060651
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 1.8324322700500488
Epoch: 1, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.283 Vali Acc: 0.549 Test Loss: 1.283 Test Acc: 0.549
Validation loss decreased (inf --> -0.549120).  Saving model ...
Epoch: 2 cost time: 0.88983154296875
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 1.161 Vali Acc: 0.613 Test Loss: 1.161 Test Acc: 0.613
Validation loss decreased (-0.549120 --> -0.612705).  Saving model ...
Epoch: 3 cost time: 1.0163145065307617
Epoch: 3, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.572 Vali Acc: 0.815 Test Loss: 0.572 Test Acc: 0.815
Validation loss decreased (-0.612705 --> -0.815023).  Saving model ...
Epoch: 4 cost time: 0.939382791519165
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.841 Vali Acc: 0.746 Test Loss: 0.841 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.853111982345581
Epoch: 5, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.502 Vali Acc: 0.676 Test Loss: 1.502 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8734138011932373
Epoch: 6, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.994 Vali Acc: 0.717 Test Loss: 0.994 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9105443954467773
Epoch: 7, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.895 Vali Acc: 0.624 Test Loss: 1.895 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9629771709442139
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9693949222564697
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.786 Test Loss: 0.726 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.003023624420166
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.798 Test Loss: 0.744 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0324890613555908
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.792 Test Loss: 0.722 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9769046306610107
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.792 Test Loss: 0.698 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9889030456542969
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.798 Test Loss: 0.686 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1060395
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.472733736038208
Epoch: 1, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.046 Vali Acc: 0.601 Test Loss: 1.046 Test Acc: 0.601
Validation loss decreased (inf --> -0.601146).  Saving model ...
Epoch: 2 cost time: 2.3652591705322266
Epoch: 2, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.842 Vali Acc: 0.653 Test Loss: 0.842 Test Acc: 0.653
Validation loss decreased (-0.601146 --> -0.653171).  Saving model ...
Epoch: 3 cost time: 2.394338846206665
Epoch: 3, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.860 Vali Acc: 0.769 Test Loss: 0.860 Test Acc: 0.769
Validation loss decreased (-0.653171 --> -0.768778).  Saving model ...
Epoch: 4 cost time: 2.530545949935913
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.840 Vali Acc: 0.734 Test Loss: 0.840 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.471867322921753
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.780 Test Loss: 0.832 Test Acc: 0.780
Validation loss decreased (-0.768778 --> -0.780339).  Saving model ...
Epoch: 6 cost time: 2.6677114963531494
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.819 Vali Acc: 0.780 Test Loss: 0.819 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 7 cost time: 2.557856321334839
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.751 Test Loss: 0.843 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5373570919036865
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.807 Vali Acc: 0.751 Test Loss: 0.807 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7152247428894043
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.789 Vali Acc: 0.740 Test Loss: 0.789 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7378768920898438
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.746 Test Loss: 0.778 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7450506687164307
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.746 Test Loss: 0.771 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.707810163497925
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.751 Test Loss: 0.767 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7167539596557617
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.751 Test Loss: 0.765 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6655259132385254
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.751 Test Loss: 0.761 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.783949851989746
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.763 Test Loss: 0.759 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6160316467285156
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w18_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1055113
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2395434379577637
Epoch: 1, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.154 Vali Acc: 0.618 Test Loss: 1.154 Test Acc: 0.618
Validation loss decreased (inf --> -0.618486).  Saving model ...
Epoch: 2 cost time: 2.1554453372955322
Epoch: 2, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.084 Vali Acc: 0.642 Test Loss: 1.084 Test Acc: 0.642
Validation loss decreased (-0.618486 --> -0.641608).  Saving model ...
Epoch: 3 cost time: 2.159773111343384
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.843 Vali Acc: 0.723 Test Loss: 0.843 Test Acc: 0.723
Validation loss decreased (-0.641608 --> -0.722535).  Saving model ...
Epoch: 4 cost time: 1.9402999877929688
Epoch: 4, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
Validation loss decreased (-0.722535 --> -0.774559).  Saving model ...
Epoch: 5 cost time: 2.2023167610168457
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774559).  Saving model ...
Epoch: 6 cost time: 2.1771903038024902
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.769 Test Loss: 0.763 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.284578561782837
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.780 Test Loss: 0.814 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780339).  Saving model ...
Epoch: 8 cost time: 2.174715757369995
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.780 Test Loss: 0.780 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 9 cost time: 2.165264844894409
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.780 Test Loss: 0.757 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 10 cost time: 2.2097084522247314
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.780 Test Loss: 0.745 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 11 cost time: 2.181748628616333
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.780 Test Loss: 0.742 Test Acc: 0.780
Validation loss decreased (-0.780339 --> -0.780339).  Saving model ...
Epoch: 12 cost time: 2.192375421524048
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.769 Test Loss: 0.738 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.114354372024536
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.769 Test Loss: 0.733 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.014535903930664
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.769 Test Loss: 0.732 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.045351505279541
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0196890830993652
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0750105381011963
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.116793394088745
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.775 Test Loss: 0.732 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.059094190597534
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.775 Test Loss: 0.732 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.125703811645508
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.769 Test Loss: 0.733 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9026596546173096
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.769 Test Loss: 0.732 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w15_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1054345
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2273268699645996
Epoch: 1, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.049 Vali Acc: 0.647 Test Loss: 1.049 Test Acc: 0.647
Validation loss decreased (inf --> -0.647388).  Saving model ...
Epoch: 2 cost time: 2.016862392425537
Epoch: 2, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.716 Vali Acc: 0.728 Test Loss: 0.716 Test Acc: 0.728
Validation loss decreased (-0.647388 --> -0.728317).  Saving model ...
Epoch: 3 cost time: 2.256441116333008
Epoch: 3, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
Validation loss decreased (-0.728317 --> -0.757217).  Saving model ...
Epoch: 4 cost time: 2.2364413738250732
Epoch: 4, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.921 Vali Acc: 0.728 Test Loss: 0.921 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.213667392730713
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.763 Test Loss: 0.811 Test Acc: 0.763
Validation loss decreased (-0.757217 --> -0.762998).  Saving model ...
Epoch: 6 cost time: 2.058943510055542
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.746 Test Loss: 0.792 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.029839277267456
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.746 Test Loss: 0.775 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1409990787506104
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.757 Test Loss: 0.755 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1477267742156982
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.757 Test Loss: 0.743 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.253859758377075
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.757 Test Loss: 0.738 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.153078556060791
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.757 Test Loss: 0.731 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1530306339263916
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.757 Test Loss: 0.726 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.122257947921753
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.149585723876953
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.769 Test Loss: 0.718 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768779).  Saving model ...
Epoch: 15 cost time: 2.214987277984619
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.769 Test Loss: 0.713 Test Acc: 0.769
Validation loss decreased (-0.768779 --> -0.768779).  Saving model ...
Epoch: 16 cost time: 2.3048386573791504
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.780 Test Loss: 0.711 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780340).  Saving model ...
Epoch: 17 cost time: 1.8586080074310303
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.780 Test Loss: 0.710 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 18 cost time: 1.9505257606506348
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.780 Test Loss: 0.707 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 19 cost time: 1.8118760585784912
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.786 Test Loss: 0.706 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786120).  Saving model ...
Epoch: 20 cost time: 1.8471455574035645
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.786 Test Loss: 0.704 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 21 cost time: 1.9901118278503418
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.786 Test Loss: 0.703 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 22 cost time: 1.968017578125
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.786 Test Loss: 0.702 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 23 cost time: 1.901634931564331
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.786 Test Loss: 0.701 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 24 cost time: 1.898343563079834
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.786 Test Loss: 0.700 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 25 cost time: 2.069133996963501
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.798 Test Loss: 0.700 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797681).  Saving model ...
Epoch: 26 cost time: 1.797872543334961
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.798 Test Loss: 0.697 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 27 cost time: 1.8566770553588867
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 28 cost time: 1.8398878574371338
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.798 Test Loss: 0.697 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8229832649230957
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.798 Test Loss: 0.697 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8845276832580566
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.798 Test Loss: 0.697 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7478821277618408
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9215328693389893
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 33 cost time: 1.9055736064910889
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 34 cost time: 1.8981225490570068
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.798 Test Loss: 0.694 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 35 cost time: 1.9055798053741455
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 36 cost time: 1.8462133407592773
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.798 Test Loss: 0.694 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7454109191894531
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.798 Test Loss: 0.694 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.250105857849121
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.798 Test Loss: 0.692 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 39 cost time: 2.0022239685058594
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8160467147827148
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9511477947235107
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.160310983657837
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.798 Test Loss: 0.692 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 43 cost time: 2.028510093688965
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.3394224643707275
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.079772710800171
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.9119799137115479
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.798 Test Loss: 0.694 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.784637451171875
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.798 Test Loss: 0.694 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.150054454803467
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.798 Test Loss: 0.694 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.8909270763397217
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.8711791038513184
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.7965772151947021
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.6369080543518066
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1053321
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.364377737045288
Epoch: 1, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.191 Vali Acc: 0.555 Test Loss: 1.191 Test Acc: 0.555
Validation loss decreased (inf --> -0.554901).  Saving model ...
Epoch: 2 cost time: 1.9418704509735107
Epoch: 2, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.965 Vali Acc: 0.711 Test Loss: 0.965 Test Acc: 0.711
Validation loss decreased (-0.554901 --> -0.710973).  Saving model ...
Epoch: 3 cost time: 1.9144237041473389
Epoch: 3, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9076802730560303
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.007 Vali Acc: 0.746 Test Loss: 1.007 Test Acc: 0.746
Validation loss decreased (-0.710973 --> -0.745655).  Saving model ...
Epoch: 5 cost time: 1.908334493637085
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.740 Test Loss: 1.009 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.860522985458374
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.769 Test Loss: 0.830 Test Acc: 0.769
Validation loss decreased (-0.745655 --> -0.768778).  Saving model ...
Epoch: 7 cost time: 1.9285249710083008
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8634803295135498
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.775 Test Loss: 0.663 Test Acc: 0.775
Validation loss decreased (-0.768778 --> -0.774560).  Saving model ...
Epoch: 9 cost time: 1.6377253532409668
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.780 Test Loss: 0.654 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780340).  Saving model ...
Epoch: 10 cost time: 1.7402822971343994
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.786 Test Loss: 0.649 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786121).  Saving model ...
Epoch: 11 cost time: 1.680786371231079
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.786 Test Loss: 0.647 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 12 cost time: 1.7738926410675049
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.786 Test Loss: 0.645 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 13 cost time: 1.8350017070770264
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.786 Test Loss: 0.645 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 14 cost time: 1.8188986778259277
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.786 Test Loss: 0.645 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8624413013458252
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.786 Test Loss: 0.645 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.780174732208252
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.792 Test Loss: 0.646 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791901).  Saving model ...
Epoch: 17 cost time: 1.8443999290466309
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.792 Test Loss: 0.646 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791901).  Saving model ...
Epoch: 18 cost time: 1.8570187091827393
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.792 Test Loss: 0.646 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8720765113830566
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.792 Test Loss: 0.646 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.932326316833496
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.798 Test Loss: 0.647 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797681).  Saving model ...
Epoch: 21 cost time: 2.0891621112823486
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.798 Test Loss: 0.648 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8517916202545166
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.59635591506958
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.798 Test Loss: 0.650 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9929707050323486
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.798 Test Loss: 0.650 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.960390567779541
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.798 Test Loss: 0.651 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9102709293365479
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.798 Test Loss: 0.651 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.172614336013794
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.798 Test Loss: 0.653 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.103048086166382
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.798 Test Loss: 0.653 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9993081092834473
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803462).  Saving model ...
Epoch: 30 cost time: 2.0921437740325928
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.137268304824829
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.099471092224121
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.252171039581299
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.798 Test Loss: 0.656 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.334054470062256
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.798 Test Loss: 0.656 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0784950256347656
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.798 Test Loss: 0.657 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.6459908485412598
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.798 Test Loss: 0.657 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.9881250858306885
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.792 Test Loss: 0.658 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.330576181411743
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.798 Test Loss: 0.659 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.2290806770324707
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.792 Test Loss: 0.660 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1052553
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.521442174911499
Epoch: 1, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.077 Vali Acc: 0.584 Test Loss: 1.077 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 1.4377150535583496
Epoch: 2, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.882 Vali Acc: 0.682 Test Loss: 0.882 Test Acc: 0.682
Validation loss decreased (-0.583804 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 1.4780335426330566
Epoch: 3, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.942 Vali Acc: 0.740 Test Loss: 0.942 Test Acc: 0.740
Validation loss decreased (-0.682072 --> -0.739875).  Saving model ...
Epoch: 4 cost time: 1.4747278690338135
Epoch: 4, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.792 Vali Acc: 0.705 Test Loss: 0.792 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.577876091003418
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.740 Test Loss: 0.790 Test Acc: 0.740
Validation loss decreased (-0.739875 --> -0.739876).  Saving model ...
Epoch: 6 cost time: 1.4029653072357178
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.740 Test Loss: 0.727 Test Acc: 0.740
Validation loss decreased (-0.739876 --> -0.739877).  Saving model ...
Epoch: 7 cost time: 1.4099037647247314
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.734 Test Loss: 0.698 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3995037078857422
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.728 Test Loss: 0.687 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4547343254089355
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.746 Test Loss: 0.681 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745658).  Saving model ...
Epoch: 10 cost time: 1.4576959609985352
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 11 cost time: 1.377345085144043
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.746 Test Loss: 0.674 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 12 cost time: 1.297245979309082
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 13 cost time: 1.253326654434204
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
Validation loss decreased (-0.745658 --> -0.757219).  Saving model ...
Epoch: 14 cost time: 1.3471977710723877
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.757 Test Loss: 0.666 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 15 cost time: 1.4344122409820557
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.757 Test Loss: 0.665 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 16 cost time: 1.3995835781097412
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.757 Test Loss: 0.664 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 17 cost time: 1.4480152130126953
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 18 cost time: 1.4790539741516113
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.757 Test Loss: 0.662 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 19 cost time: 1.5977387428283691
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
Validation loss decreased (-0.757219 --> -0.762999).  Saving model ...
Epoch: 20 cost time: 1.378697156906128
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2466371059417725
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.391521692276001
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4330451488494873
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3912034034729004
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.418851613998413
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3037974834442139
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3844990730285645
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2554755210876465
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.763 Test Loss: 0.665 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3740391731262207
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.763 Test Loss: 0.666 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1051785
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4810352325439453
Epoch: 1, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.106 Vali Acc: 0.538 Test Loss: 1.106 Test Acc: 0.538
Validation loss decreased (inf --> -0.537561).  Saving model ...
Epoch: 2 cost time: 1.133965253829956
Epoch: 2, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.991 Vali Acc: 0.682 Test Loss: 0.991 Test Acc: 0.682
Validation loss decreased (-0.537561 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 1.3046307563781738
Epoch: 3, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.862 Vali Acc: 0.728 Test Loss: 0.862 Test Acc: 0.728
Validation loss decreased (-0.682071 --> -0.728315).  Saving model ...
Epoch: 4 cost time: 1.3909759521484375
Epoch: 4, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.146 Vali Acc: 0.734 Test Loss: 1.146 Test Acc: 0.734
Validation loss decreased (-0.728315 --> -0.734093).  Saving model ...
Epoch: 5 cost time: 1.3449070453643799
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.734 Test Loss: 1.045 Test Acc: 0.734
Validation loss decreased (-0.734093 --> -0.734094).  Saving model ...
Epoch: 6 cost time: 1.3034045696258545
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.717 Test Loss: 1.093 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.324693202972412
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.717 Test Loss: 1.093 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3499975204467773
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.717 Test Loss: 1.021 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4294676780700684
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.723 Test Loss: 0.987 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1363413333892822
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.728 Test Loss: 0.971 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3025107383728027
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.728 Test Loss: 0.960 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.273386001586914
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.728 Test Loss: 0.954 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2762658596038818
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.740 Test Loss: 0.947 Test Acc: 0.740
Validation loss decreased (-0.734094 --> -0.739875).  Saving model ...
Epoch: 14 cost time: 1.0959923267364502
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.728 Test Loss: 0.945 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1222574710845947
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.746 Test Loss: 0.942 Test Acc: 0.746
Validation loss decreased (-0.739875 --> -0.745655).  Saving model ...
Epoch: 16 cost time: 1.2681660652160645
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.746 Test Loss: 0.940 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745655).  Saving model ...
Epoch: 17 cost time: 1.1875929832458496
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.740 Test Loss: 0.936 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2127346992492676
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.740 Test Loss: 0.935 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.077416181564331
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.740 Test Loss: 0.933 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.285029411315918
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.740 Test Loss: 0.933 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2556192874908447
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.929 Vali Acc: 0.740 Test Loss: 0.929 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2305850982666016
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.740 Test Loss: 0.926 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2335665225982666
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.740 Test Loss: 0.925 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.244469404220581
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.740 Test Loss: 0.925 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1886093616485596
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.740 Test Loss: 0.924 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.247133493423462
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.746 Test Loss: 0.924 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745656).  Saving model ...
Epoch: 27 cost time: 1.2441351413726807
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.746 Test Loss: 0.923 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745656).  Saving model ...
Epoch: 28 cost time: 1.1973347663879395
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.746 Test Loss: 0.921 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745656).  Saving model ...
Epoch: 29 cost time: 1.1439218521118164
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.746 Test Loss: 0.918 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745656).  Saving model ...
Epoch: 30 cost time: 1.1922376155853271
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.751 Test Loss: 0.917 Test Acc: 0.751
Validation loss decreased (-0.745656 --> -0.751436).  Saving model ...
Epoch: 31 cost time: 1.2260680198669434
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.751 Test Loss: 0.917 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1968746185302734
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.751 Test Loss: 0.916 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 33 cost time: 1.1327261924743652
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.751 Test Loss: 0.916 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1852095127105713
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.751 Test Loss: 0.915 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 35 cost time: 1.216336965560913
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.751 Test Loss: 0.915 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.245445966720581
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.751 Test Loss: 0.915 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.082256555557251
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.751 Test Loss: 0.914 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 38 cost time: 1.1035683155059814
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.740 Test Loss: 0.913 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2084791660308838
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.740 Test Loss: 0.912 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2157714366912842
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.740 Test Loss: 0.911 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.166156530380249
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.740 Test Loss: 0.911 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2166101932525635
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.740 Test Loss: 0.909 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2311978340148926
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.740 Test Loss: 0.908 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.28102707862854
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.740 Test Loss: 0.909 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1457347869873047
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.740 Test Loss: 0.908 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3476483821868896
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.740 Test Loss: 0.908 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1495413780212402
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.740 Test Loss: 0.908 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 1051273
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6822359561920166
Epoch: 1, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.303 Vali Acc: 0.555 Test Loss: 1.303 Test Acc: 0.555
Validation loss decreased (inf --> -0.554900).  Saving model ...
Epoch: 2 cost time: 1.1715114116668701
Epoch: 2, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.682 Vali Acc: 0.780 Test Loss: 0.682 Test Acc: 0.780
Validation loss decreased (-0.554900 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 1.2164204120635986
Epoch: 3, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.891 Vali Acc: 0.734 Test Loss: 0.891 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.308419942855835
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.081 Vali Acc: 0.723 Test Loss: 1.081 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.185502290725708
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.728 Test Loss: 0.982 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3010766506195068
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.208 Vali Acc: 0.711 Test Loss: 1.208 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.280663013458252
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.294 Vali Acc: 0.699 Test Loss: 1.294 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.199591875076294
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.723 Test Loss: 0.883 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3981635570526123
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.723 Test Loss: 0.905 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2338862419128418
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.717 Test Loss: 0.921 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2485461235046387
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.723 Test Loss: 0.886 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2948005199432373
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1051017
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.0376064777374268
Epoch: 1, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.096 Vali Acc: 0.572 Test Loss: 1.096 Test Acc: 0.572
Validation loss decreased (inf --> -0.572243).  Saving model ...
Epoch: 2 cost time: 0.9273688793182373
Epoch: 2, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.799 Vali Acc: 0.723 Test Loss: 0.799 Test Acc: 0.723
Validation loss decreased (-0.572243 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 0.9564981460571289
Epoch: 3, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.868 Vali Acc: 0.717 Test Loss: 0.868 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9644365310668945
Epoch: 4, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.129 Vali Acc: 0.746 Test Loss: 1.129 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745653).  Saving model ...
Epoch: 5 cost time: 0.912628173828125
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.734 Test Loss: 1.082 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9105498790740967
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.751 Test Loss: 0.917 Test Acc: 0.751
Validation loss decreased (-0.745653 --> -0.751436).  Saving model ...
Epoch: 7 cost time: 1.025761604309082
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.746 Test Loss: 0.958 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8960938453674316
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.751 Test Loss: 0.943 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.016326665878296
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.751 Test Loss: 0.932 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9133751392364502
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.751 Test Loss: 0.923 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.859372615814209
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.918 Vali Acc: 0.746 Test Loss: 0.918 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8081893920898438
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.746 Test Loss: 0.914 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8976500034332275
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.746 Test Loss: 0.912 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9114387035369873
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.746 Test Loss: 0.908 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9361817836761475
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.751 Test Loss: 0.906 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 16 cost time: 0.9203140735626221
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.751 Test Loss: 0.904 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 17 cost time: 0.9032008647918701
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.751 Test Loss: 0.903 Test Acc: 0.751
Validation loss decreased (-0.751436 --> -0.751436).  Saving model ...
Epoch: 18 cost time: 1.1403000354766846
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.757 Test Loss: 0.902 Test Acc: 0.757
Validation loss decreased (-0.751436 --> -0.757216).  Saving model ...
Epoch: 19 cost time: 0.9459095001220703
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.757 Test Loss: 0.901 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 20 cost time: 0.9421992301940918
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.757 Test Loss: 0.902 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9539310932159424
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.901 Vali Acc: 0.757 Test Loss: 0.901 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 22 cost time: 1.1141564846038818
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.757 Test Loss: 0.902 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1691129207611084
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.757 Test Loss: 0.899 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 24 cost time: 1.189295768737793
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.757 Test Loss: 0.897 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 25 cost time: 0.9234869480133057
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.757 Test Loss: 0.897 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 26 cost time: 1.2420952320098877
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.757 Test Loss: 0.896 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 27 cost time: 1.2835686206817627
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.757 Test Loss: 0.896 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.184945821762085
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.757 Test Loss: 0.895 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757216).  Saving model ...
Epoch: 29 cost time: 1.157893419265747
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.757 Test Loss: 0.893 Test Acc: 0.757
Validation loss decreased (-0.757216 --> -0.757217).  Saving model ...
Epoch: 30 cost time: 1.268268346786499
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 31 cost time: 1.2240853309631348
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 32 cost time: 1.1384825706481934
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.757 Test Loss: 0.892 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1670255661010742
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
Validation loss decreased (-0.757217 --> -0.757217).  Saving model ...
Epoch: 34 cost time: 1.0536518096923828
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.757 Test Loss: 0.892 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.970165491104126
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0490925312042236
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.769 Test Loss: 0.890 Test Acc: 0.769
Validation loss decreased (-0.757217 --> -0.768777).  Saving model ...
Epoch: 37 cost time: 1.0544209480285645
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.769 Test Loss: 0.890 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 38 cost time: 0.9645473957061768
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 39 cost time: 1.1375610828399658
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.769 Test Loss: 0.889 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.976360559463501
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 41 cost time: 1.086406946182251
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9963469505310059
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0933279991149902
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 44 cost time: 0.9797844886779785
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9600040912628174
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9804036617279053
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 47 cost time: 1.0155165195465088
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8509330749511719
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.769 Test Loss: 0.887 Test Acc: 0.769
Validation loss decreased (-0.768777 --> -0.768777).  Saving model ...
Epoch: 49 cost time: 0.9505765438079834
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8578934669494629
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9201247692108154
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9685330390930176
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8442490100860596
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9153063297271729
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.1003704071044922
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9304342269897461
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.0123894214630127
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.769 Test Loss: 0.888 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9229598045349121
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.769 Test Loss: 0.889 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_MTSMixer_UEA_ftM_sl144_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1050761
model size : 4.01MB
