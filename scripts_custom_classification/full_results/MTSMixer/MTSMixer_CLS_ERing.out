Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4996585845947266
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.868 Vali Acc: 0.152 Test Loss: 1.868 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.4248044490814209
Epoch: 2, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.861 Vali Acc: 0.152 Test Loss: 1.861 Test Acc: 0.152
Validation loss decreased (-0.151833 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.43519067764282227
Epoch: 3, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.853 Vali Acc: 0.156 Test Loss: 1.853 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155537).  Saving model ...
Epoch: 4 cost time: 0.4451477527618408
Epoch: 4, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.841 Vali Acc: 0.159 Test Loss: 1.841 Test Acc: 0.159
Validation loss decreased (-0.155537 --> -0.159241).  Saving model ...
Epoch: 5 cost time: 0.37219834327697754
Epoch: 5, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.827 Vali Acc: 0.163 Test Loss: 1.827 Test Acc: 0.163
Validation loss decreased (-0.159241 --> -0.162945).  Saving model ...
Epoch: 6 cost time: 0.38045763969421387
Epoch: 6, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.811 Vali Acc: 0.174 Test Loss: 1.811 Test Acc: 0.174
Validation loss decreased (-0.162945 --> -0.174056).  Saving model ...
Epoch: 7 cost time: 0.3952960968017578
Epoch: 7, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.792 Vali Acc: 0.193 Test Loss: 1.792 Test Acc: 0.193
Validation loss decreased (-0.174056 --> -0.192575).  Saving model ...
Epoch: 8 cost time: 0.45980381965637207
Epoch: 8, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.771 Vali Acc: 0.211 Test Loss: 1.771 Test Acc: 0.211
Validation loss decreased (-0.192575 --> -0.211093).  Saving model ...
Epoch: 9 cost time: 0.423506498336792
Epoch: 9, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.749 Vali Acc: 0.215 Test Loss: 1.749 Test Acc: 0.215
Validation loss decreased (-0.211093 --> -0.214797).  Saving model ...
Epoch: 10 cost time: 0.4135417938232422
Epoch: 10, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.727 Vali Acc: 0.241 Test Loss: 1.727 Test Acc: 0.241
Validation loss decreased (-0.214797 --> -0.240723).  Saving model ...
Epoch: 11 cost time: 0.48155903816223145
Epoch: 11, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.704 Vali Acc: 0.256 Test Loss: 1.704 Test Acc: 0.256
Validation loss decreased (-0.240723 --> -0.255539).  Saving model ...
Epoch: 12 cost time: 0.4648423194885254
Epoch: 12, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.681 Vali Acc: 0.278 Test Loss: 1.681 Test Acc: 0.278
Validation loss decreased (-0.255539 --> -0.277761).  Saving model ...
Epoch: 13 cost time: 0.4123420715332031
Epoch: 13, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.658 Vali Acc: 0.304 Test Loss: 1.658 Test Acc: 0.304
Validation loss decreased (-0.277761 --> -0.303687).  Saving model ...
Epoch: 14 cost time: 0.43410801887512207
Epoch: 14, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.635 Vali Acc: 0.326 Test Loss: 1.635 Test Acc: 0.326
Validation loss decreased (-0.303687 --> -0.325910).  Saving model ...
Epoch: 15 cost time: 0.43158888816833496
Epoch: 15, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.611 Vali Acc: 0.359 Test Loss: 1.611 Test Acc: 0.359
Validation loss decreased (-0.325910 --> -0.359243).  Saving model ...
Epoch: 16 cost time: 0.4442563056945801
Epoch: 16, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.588 Vali Acc: 0.396 Test Loss: 1.588 Test Acc: 0.396
Validation loss decreased (-0.359243 --> -0.396280).  Saving model ...
Epoch: 17 cost time: 0.45119428634643555
Epoch: 17, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.565 Vali Acc: 0.426 Test Loss: 1.565 Test Acc: 0.426
Validation loss decreased (-0.396280 --> -0.425910).  Saving model ...
Epoch: 18 cost time: 0.42146921157836914
Epoch: 18, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.543 Vali Acc: 0.452 Test Loss: 1.543 Test Acc: 0.452
Validation loss decreased (-0.425910 --> -0.451836).  Saving model ...
Epoch: 19 cost time: 0.4239194393157959
Epoch: 19, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.521 Vali Acc: 0.481 Test Loss: 1.521 Test Acc: 0.481
Validation loss decreased (-0.451836 --> -0.481466).  Saving model ...
Epoch: 20 cost time: 0.45461082458496094
Epoch: 20, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.501 Vali Acc: 0.507 Test Loss: 1.501 Test Acc: 0.507
Validation loss decreased (-0.481466 --> -0.507392).  Saving model ...
Epoch: 21 cost time: 0.4746229648590088
Epoch: 21, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.481 Vali Acc: 0.522 Test Loss: 1.481 Test Acc: 0.522
Validation loss decreased (-0.507392 --> -0.522207).  Saving model ...
Epoch: 22 cost time: 0.5153427124023438
Epoch: 22, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.463 Vali Acc: 0.533 Test Loss: 1.463 Test Acc: 0.533
Validation loss decreased (-0.522207 --> -0.533319).  Saving model ...
Epoch: 23 cost time: 0.4443035125732422
Epoch: 23, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.445 Vali Acc: 0.570 Test Loss: 1.445 Test Acc: 0.570
Validation loss decreased (-0.533319 --> -0.570356).  Saving model ...
Epoch: 24 cost time: 0.45555925369262695
Epoch: 24, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.426 Vali Acc: 0.585 Test Loss: 1.426 Test Acc: 0.585
Validation loss decreased (-0.570356 --> -0.585171).  Saving model ...
Epoch: 25 cost time: 0.37860774993896484
Epoch: 25, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.409 Vali Acc: 0.607 Test Loss: 1.409 Test Acc: 0.607
Validation loss decreased (-0.585171 --> -0.607393).  Saving model ...
Epoch: 26 cost time: 0.42513585090637207
Epoch: 26, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.393 Vali Acc: 0.622 Test Loss: 1.393 Test Acc: 0.622
Validation loss decreased (-0.607393 --> -0.622208).  Saving model ...
Epoch: 27 cost time: 0.4435603618621826
Epoch: 27, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.377 Vali Acc: 0.630 Test Loss: 1.377 Test Acc: 0.630
Validation loss decreased (-0.622208 --> -0.629616).  Saving model ...
Epoch: 28 cost time: 0.4036545753479004
Epoch: 28, Steps: 2 | Train Loss: 0.924 Vali Loss: 1.362 Vali Acc: 0.626 Test Loss: 1.362 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4604496955871582
Epoch: 29, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.349 Vali Acc: 0.626 Test Loss: 1.349 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.49597859382629395
Epoch: 30, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.335 Vali Acc: 0.633 Test Loss: 1.335 Test Acc: 0.633
Validation loss decreased (-0.629616 --> -0.633320).  Saving model ...
Epoch: 31 cost time: 0.5814321041107178
Epoch: 31, Steps: 2 | Train Loss: 0.893 Vali Loss: 1.322 Vali Acc: 0.641 Test Loss: 1.322 Test Acc: 0.641
Validation loss decreased (-0.633320 --> -0.640728).  Saving model ...
Epoch: 32 cost time: 0.5853941440582275
Epoch: 32, Steps: 2 | Train Loss: 0.834 Vali Loss: 1.310 Vali Acc: 0.644 Test Loss: 1.310 Test Acc: 0.644
Validation loss decreased (-0.640728 --> -0.644431).  Saving model ...
Epoch: 33 cost time: 0.5144448280334473
Epoch: 33, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.298 Vali Acc: 0.659 Test Loss: 1.298 Test Acc: 0.659
Validation loss decreased (-0.644431 --> -0.659246).  Saving model ...
Epoch: 34 cost time: 0.5989553928375244
Epoch: 34, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.287 Vali Acc: 0.659 Test Loss: 1.287 Test Acc: 0.659
Validation loss decreased (-0.659246 --> -0.659246).  Saving model ...
Epoch: 35 cost time: 0.4504683017730713
Epoch: 35, Steps: 2 | Train Loss: 0.752 Vali Loss: 1.276 Vali Acc: 0.670 Test Loss: 1.276 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670358).  Saving model ...
Epoch: 36 cost time: 0.4922335147857666
Epoch: 36, Steps: 2 | Train Loss: 0.738 Vali Loss: 1.266 Vali Acc: 0.674 Test Loss: 1.266 Test Acc: 0.674
Validation loss decreased (-0.670358 --> -0.674061).  Saving model ...
Epoch: 37 cost time: 0.47800588607788086
Epoch: 37, Steps: 2 | Train Loss: 0.721 Vali Loss: 1.256 Vali Acc: 0.674 Test Loss: 1.256 Test Acc: 0.674
Validation loss decreased (-0.674061 --> -0.674062).  Saving model ...
Epoch: 38 cost time: 0.5536108016967773
Epoch: 38, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.245 Vali Acc: 0.681 Test Loss: 1.245 Test Acc: 0.681
Validation loss decreased (-0.674062 --> -0.681469).  Saving model ...
Epoch: 39 cost time: 0.5573742389678955
Epoch: 39, Steps: 2 | Train Loss: 0.647 Vali Loss: 1.235 Vali Acc: 0.689 Test Loss: 1.235 Test Acc: 0.689
Validation loss decreased (-0.681469 --> -0.688877).  Saving model ...
Epoch: 40 cost time: 0.46314358711242676
Epoch: 40, Steps: 2 | Train Loss: 0.643 Vali Loss: 1.225 Vali Acc: 0.696 Test Loss: 1.225 Test Acc: 0.696
Validation loss decreased (-0.688877 --> -0.696284).  Saving model ...
Epoch: 41 cost time: 0.44430041313171387
Epoch: 41, Steps: 2 | Train Loss: 0.618 Vali Loss: 1.214 Vali Acc: 0.700 Test Loss: 1.214 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 42 cost time: 0.5474367141723633
Epoch: 42, Steps: 2 | Train Loss: 0.607 Vali Loss: 1.204 Vali Acc: 0.704 Test Loss: 1.204 Test Acc: 0.704
Validation loss decreased (-0.699988 --> -0.703692).  Saving model ...
Epoch: 43 cost time: 0.5123574733734131
Epoch: 43, Steps: 2 | Train Loss: 0.584 Vali Loss: 1.196 Vali Acc: 0.711 Test Loss: 1.196 Test Acc: 0.711
Validation loss decreased (-0.703692 --> -0.711099).  Saving model ...
Epoch: 44 cost time: 0.5114293098449707
Epoch: 44, Steps: 2 | Train Loss: 0.551 Vali Loss: 1.186 Vali Acc: 0.715 Test Loss: 1.186 Test Acc: 0.715
Validation loss decreased (-0.711099 --> -0.714803).  Saving model ...
Epoch: 45 cost time: 0.5515279769897461
Epoch: 45, Steps: 2 | Train Loss: 0.529 Vali Loss: 1.177 Vali Acc: 0.715 Test Loss: 1.177 Test Acc: 0.715
Validation loss decreased (-0.714803 --> -0.714803).  Saving model ...
Epoch: 46 cost time: 0.5771389007568359
Epoch: 46, Steps: 2 | Train Loss: 0.507 Vali Loss: 1.168 Vali Acc: 0.722 Test Loss: 1.168 Test Acc: 0.722
Validation loss decreased (-0.714803 --> -0.722211).  Saving model ...
Epoch: 47 cost time: 0.5085859298706055
Epoch: 47, Steps: 2 | Train Loss: 0.503 Vali Loss: 1.159 Vali Acc: 0.726 Test Loss: 1.159 Test Acc: 0.726
Validation loss decreased (-0.722211 --> -0.725914).  Saving model ...
Epoch: 48 cost time: 0.5489702224731445
Epoch: 48, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.151 Vali Acc: 0.726 Test Loss: 1.151 Test Acc: 0.726
Validation loss decreased (-0.725914 --> -0.725914).  Saving model ...
Epoch: 49 cost time: 0.5218825340270996
Epoch: 49, Steps: 2 | Train Loss: 0.456 Vali Loss: 1.144 Vali Acc: 0.719 Test Loss: 1.144 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.49315690994262695
Epoch: 50, Steps: 2 | Train Loss: 0.452 Vali Loss: 1.137 Vali Acc: 0.722 Test Loss: 1.137 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.4622478485107422
Epoch: 51, Steps: 2 | Train Loss: 0.456 Vali Loss: 1.129 Vali Acc: 0.726 Test Loss: 1.129 Test Acc: 0.726
Validation loss decreased (-0.725914 --> -0.725915).  Saving model ...
Epoch: 52 cost time: 0.537895679473877
Epoch: 52, Steps: 2 | Train Loss: 0.396 Vali Loss: 1.122 Vali Acc: 0.733 Test Loss: 1.122 Test Acc: 0.733
Validation loss decreased (-0.725915 --> -0.733322).  Saving model ...
Epoch: 53 cost time: 0.5009665489196777
Epoch: 53, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.114 Vali Acc: 0.741 Test Loss: 1.114 Test Acc: 0.741
Validation loss decreased (-0.733322 --> -0.740730).  Saving model ...
Epoch: 54 cost time: 0.5102620124816895
Epoch: 54, Steps: 2 | Train Loss: 0.390 Vali Loss: 1.106 Vali Acc: 0.744 Test Loss: 1.106 Test Acc: 0.744
Validation loss decreased (-0.740730 --> -0.744433).  Saving model ...
Epoch: 55 cost time: 0.561577320098877
Epoch: 55, Steps: 2 | Train Loss: 0.368 Vali Loss: 1.098 Vali Acc: 0.744 Test Loss: 1.098 Test Acc: 0.744
Validation loss decreased (-0.744433 --> -0.744433).  Saving model ...
Epoch: 56 cost time: 0.6115684509277344
Epoch: 56, Steps: 2 | Train Loss: 0.355 Vali Loss: 1.091 Vali Acc: 0.744 Test Loss: 1.091 Test Acc: 0.744
Validation loss decreased (-0.744433 --> -0.744434).  Saving model ...
Epoch: 57 cost time: 0.6048116683959961
Epoch: 57, Steps: 2 | Train Loss: 0.333 Vali Loss: 1.085 Vali Acc: 0.741 Test Loss: 1.085 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5245199203491211
Epoch: 58, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.078 Vali Acc: 0.741 Test Loss: 1.078 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.556725263595581
Epoch: 59, Steps: 2 | Train Loss: 0.305 Vali Loss: 1.070 Vali Acc: 0.748 Test Loss: 1.070 Test Acc: 0.748
Validation loss decreased (-0.744434 --> -0.748137).  Saving model ...
Epoch: 60 cost time: 0.49453091621398926
Epoch: 60, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.064 Vali Acc: 0.744 Test Loss: 1.064 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5226075649261475
Epoch: 61, Steps: 2 | Train Loss: 0.293 Vali Loss: 1.057 Vali Acc: 0.741 Test Loss: 1.057 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6121392250061035
Epoch: 62, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.051 Vali Acc: 0.741 Test Loss: 1.051 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5418827533721924
Epoch: 63, Steps: 2 | Train Loss: 0.275 Vali Loss: 1.045 Vali Acc: 0.741 Test Loss: 1.045 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.49738264083862305
Epoch: 64, Steps: 2 | Train Loss: 0.246 Vali Loss: 1.039 Vali Acc: 0.748 Test Loss: 1.039 Test Acc: 0.748
Validation loss decreased (-0.748137 --> -0.748138).  Saving model ...
Epoch: 65 cost time: 0.5217437744140625
Epoch: 65, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.033 Vali Acc: 0.748 Test Loss: 1.033 Test Acc: 0.748
Validation loss decreased (-0.748138 --> -0.748138).  Saving model ...
Epoch: 66 cost time: 0.5380165576934814
Epoch: 66, Steps: 2 | Train Loss: 0.229 Vali Loss: 1.027 Vali Acc: 0.748 Test Loss: 1.027 Test Acc: 0.748
Validation loss decreased (-0.748138 --> -0.748138).  Saving model ...
Epoch: 67 cost time: 0.5509200096130371
Epoch: 67, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.022 Vali Acc: 0.756 Test Loss: 1.022 Test Acc: 0.756
Validation loss decreased (-0.748138 --> -0.755545).  Saving model ...
Epoch: 68 cost time: 0.6534006595611572
Epoch: 68, Steps: 2 | Train Loss: 0.226 Vali Loss: 1.017 Vali Acc: 0.756 Test Loss: 1.017 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755545).  Saving model ...
Epoch: 69 cost time: 0.5626578330993652
Epoch: 69, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.012 Vali Acc: 0.756 Test Loss: 1.012 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755545).  Saving model ...
Epoch: 70 cost time: 0.5724923610687256
Epoch: 70, Steps: 2 | Train Loss: 0.214 Vali Loss: 1.007 Vali Acc: 0.756 Test Loss: 1.007 Test Acc: 0.756
Validation loss decreased (-0.755545 --> -0.755545).  Saving model ...
Epoch: 71 cost time: 0.5887007713317871
Epoch: 71, Steps: 2 | Train Loss: 0.196 Vali Loss: 1.003 Vali Acc: 0.752 Test Loss: 1.003 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6857707500457764
Epoch: 72, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.998 Vali Acc: 0.752 Test Loss: 0.998 Test Acc: 0.752
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5973165035247803
Epoch: 73, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.993 Vali Acc: 0.752 Test Loss: 0.993 Test Acc: 0.752
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5419909954071045
Epoch: 74, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.987 Vali Acc: 0.752 Test Loss: 0.987 Test Acc: 0.752
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.5175726413726807
Epoch: 75, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.982 Vali Acc: 0.752 Test Loss: 0.982 Test Acc: 0.752
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.5251021385192871
Epoch: 76, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.978 Vali Acc: 0.748 Test Loss: 0.978 Test Acc: 0.748
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.5446956157684326
Epoch: 77, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.974 Vali Acc: 0.744 Test Loss: 0.974 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.5746786594390869
Epoch: 78, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.969 Vali Acc: 0.744 Test Loss: 0.969 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.6138145923614502
Epoch: 79, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.964 Vali Acc: 0.741 Test Loss: 0.964 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.6610395908355713
Epoch: 80, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.959 Vali Acc: 0.737 Test Loss: 0.959 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7555555555555555
model parameter : 286436
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.861600399017334
Epoch: 1, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.779 Vali Acc: 0.189 Test Loss: 1.779 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.5897974967956543
Epoch: 2, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.771 Vali Acc: 0.189 Test Loss: 1.771 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.6097352504730225
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.762 Vali Acc: 0.193 Test Loss: 1.762 Test Acc: 0.193
Validation loss decreased (-0.188871 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 0.5587739944458008
Epoch: 4, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.750 Vali Acc: 0.204 Test Loss: 1.750 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.7515974044799805
Epoch: 5, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.734 Vali Acc: 0.233 Test Loss: 1.734 Test Acc: 0.233
Validation loss decreased (-0.203686 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 0.5087873935699463
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.715 Vali Acc: 0.256 Test Loss: 1.715 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255538).  Saving model ...
Epoch: 7 cost time: 0.596360445022583
Epoch: 7, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.694 Vali Acc: 0.281 Test Loss: 1.694 Test Acc: 0.281
Validation loss decreased (-0.255538 --> -0.281465).  Saving model ...
Epoch: 8 cost time: 0.6531670093536377
Epoch: 8, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.671 Vali Acc: 0.326 Test Loss: 1.671 Test Acc: 0.326
Validation loss decreased (-0.281465 --> -0.325909).  Saving model ...
Epoch: 9 cost time: 0.6264257431030273
Epoch: 9, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.647 Vali Acc: 0.367 Test Loss: 1.647 Test Acc: 0.367
Validation loss decreased (-0.325909 --> -0.366650).  Saving model ...
Epoch: 10 cost time: 0.6208398342132568
Epoch: 10, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.622 Vali Acc: 0.385 Test Loss: 1.622 Test Acc: 0.385
Validation loss decreased (-0.366650 --> -0.385169).  Saving model ...
Epoch: 11 cost time: 0.9046833515167236
Epoch: 11, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.597 Vali Acc: 0.437 Test Loss: 1.597 Test Acc: 0.437
Validation loss decreased (-0.385169 --> -0.437021).  Saving model ...
Epoch: 12 cost time: 0.5975806713104248
Epoch: 12, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.572 Vali Acc: 0.459 Test Loss: 1.572 Test Acc: 0.459
Validation loss decreased (-0.437021 --> -0.459244).  Saving model ...
Epoch: 13 cost time: 0.6212408542633057
Epoch: 13, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.547 Vali Acc: 0.493 Test Loss: 1.547 Test Acc: 0.493
Validation loss decreased (-0.459244 --> -0.492577).  Saving model ...
Epoch: 14 cost time: 0.7830352783203125
Epoch: 14, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.523 Vali Acc: 0.511 Test Loss: 1.523 Test Acc: 0.511
Validation loss decreased (-0.492577 --> -0.511096).  Saving model ...
Epoch: 15 cost time: 0.6941957473754883
Epoch: 15, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.499 Vali Acc: 0.526 Test Loss: 1.499 Test Acc: 0.526
Validation loss decreased (-0.511096 --> -0.525911).  Saving model ...
Epoch: 16 cost time: 0.7661302089691162
Epoch: 16, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.476 Vali Acc: 0.552 Test Loss: 1.476 Test Acc: 0.552
Validation loss decreased (-0.525911 --> -0.551837).  Saving model ...
Epoch: 17 cost time: 0.7001123428344727
Epoch: 17, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.454 Vali Acc: 0.589 Test Loss: 1.454 Test Acc: 0.589
Validation loss decreased (-0.551837 --> -0.588874).  Saving model ...
Epoch: 18 cost time: 0.7071757316589355
Epoch: 18, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.433 Vali Acc: 0.600 Test Loss: 1.433 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 0.7260603904724121
Epoch: 19, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.413 Vali Acc: 0.630 Test Loss: 1.413 Test Acc: 0.630
Validation loss decreased (-0.599986 --> -0.629616).  Saving model ...
Epoch: 20 cost time: 0.6452536582946777
Epoch: 20, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.394 Vali Acc: 0.644 Test Loss: 1.394 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644430).  Saving model ...
Epoch: 21 cost time: 0.6948208808898926
Epoch: 21, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.377 Vali Acc: 0.674 Test Loss: 1.377 Test Acc: 0.674
Validation loss decreased (-0.644430 --> -0.674060).  Saving model ...
Epoch: 22 cost time: 0.6327438354492188
Epoch: 22, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.359 Vali Acc: 0.678 Test Loss: 1.359 Test Acc: 0.678
Validation loss decreased (-0.674060 --> -0.677764).  Saving model ...
Epoch: 23 cost time: 0.6538975238800049
Epoch: 23, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.342 Vali Acc: 0.685 Test Loss: 1.342 Test Acc: 0.685
Validation loss decreased (-0.677764 --> -0.685172).  Saving model ...
Epoch: 24 cost time: 0.7502708435058594
Epoch: 24, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.326 Vali Acc: 0.689 Test Loss: 1.326 Test Acc: 0.689
Validation loss decreased (-0.685172 --> -0.688876).  Saving model ...
Epoch: 25 cost time: 0.6049036979675293
Epoch: 25, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.311 Vali Acc: 0.700 Test Loss: 1.311 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699987).  Saving model ...
Epoch: 26 cost time: 0.6084086894989014
Epoch: 26, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.295 Vali Acc: 0.696 Test Loss: 1.295 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7767314910888672
Epoch: 27, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.281 Vali Acc: 0.707 Test Loss: 1.281 Test Acc: 0.707
Validation loss decreased (-0.699987 --> -0.707395).  Saving model ...
Epoch: 28 cost time: 0.6740419864654541
Epoch: 28, Steps: 2 | Train Loss: 0.790 Vali Loss: 1.267 Vali Acc: 0.711 Test Loss: 1.267 Test Acc: 0.711
Validation loss decreased (-0.707395 --> -0.711098).  Saving model ...
Epoch: 29 cost time: 0.8139939308166504
Epoch: 29, Steps: 2 | Train Loss: 0.748 Vali Loss: 1.254 Vali Acc: 0.722 Test Loss: 1.254 Test Acc: 0.722
Validation loss decreased (-0.711098 --> -0.722210).  Saving model ...
Epoch: 30 cost time: 0.6996417045593262
Epoch: 30, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.242 Vali Acc: 0.730 Test Loss: 1.242 Test Acc: 0.730
Validation loss decreased (-0.722210 --> -0.729617).  Saving model ...
Epoch: 31 cost time: 0.7694292068481445
Epoch: 31, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.230 Vali Acc: 0.722 Test Loss: 1.230 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8940026760101318
Epoch: 32, Steps: 2 | Train Loss: 0.676 Vali Loss: 1.219 Vali Acc: 0.722 Test Loss: 1.219 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7190451622009277
Epoch: 33, Steps: 2 | Train Loss: 0.636 Vali Loss: 1.207 Vali Acc: 0.719 Test Loss: 1.207 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7588992118835449
Epoch: 34, Steps: 2 | Train Loss: 0.641 Vali Loss: 1.196 Vali Acc: 0.722 Test Loss: 1.196 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.829803466796875
Epoch: 35, Steps: 2 | Train Loss: 0.592 Vali Loss: 1.186 Vali Acc: 0.722 Test Loss: 1.186 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7804582118988037
Epoch: 36, Steps: 2 | Train Loss: 0.603 Vali Loss: 1.176 Vali Acc: 0.733 Test Loss: 1.176 Test Acc: 0.733
Validation loss decreased (-0.729617 --> -0.733322).  Saving model ...
Epoch: 37 cost time: 0.6835997104644775
Epoch: 37, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.166 Vali Acc: 0.730 Test Loss: 1.166 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.670799970626831
Epoch: 38, Steps: 2 | Train Loss: 0.553 Vali Loss: 1.156 Vali Acc: 0.737 Test Loss: 1.156 Test Acc: 0.737
Validation loss decreased (-0.733322 --> -0.737025).  Saving model ...
Epoch: 39 cost time: 0.726600170135498
Epoch: 39, Steps: 2 | Train Loss: 0.514 Vali Loss: 1.147 Vali Acc: 0.733 Test Loss: 1.147 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6709423065185547
Epoch: 40, Steps: 2 | Train Loss: 0.507 Vali Loss: 1.138 Vali Acc: 0.726 Test Loss: 1.138 Test Acc: 0.726
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6974263191223145
Epoch: 41, Steps: 2 | Train Loss: 0.471 Vali Loss: 1.130 Vali Acc: 0.730 Test Loss: 1.130 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9791007041931152
Epoch: 42, Steps: 2 | Train Loss: 0.488 Vali Loss: 1.123 Vali Acc: 0.733 Test Loss: 1.123 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9071557521820068
Epoch: 43, Steps: 2 | Train Loss: 0.450 Vali Loss: 1.116 Vali Acc: 0.730 Test Loss: 1.116 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8640203475952148
Epoch: 44, Steps: 2 | Train Loss: 0.434 Vali Loss: 1.109 Vali Acc: 0.726 Test Loss: 1.109 Test Acc: 0.726
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6609320640563965
Epoch: 45, Steps: 2 | Train Loss: 0.413 Vali Loss: 1.103 Vali Acc: 0.733 Test Loss: 1.103 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7990334033966064
Epoch: 46, Steps: 2 | Train Loss: 0.384 Vali Loss: 1.097 Vali Acc: 0.733 Test Loss: 1.097 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5562553405761719
Epoch: 47, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.092 Vali Acc: 0.730 Test Loss: 1.092 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5993449687957764
Epoch: 48, Steps: 2 | Train Loss: 0.370 Vali Loss: 1.086 Vali Acc: 0.730 Test Loss: 1.086 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.737037037037037
model parameter : 282340
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4881751537323
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.825 Vali Acc: 0.196 Test Loss: 1.825 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.6746249198913574
Epoch: 2, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.816 Vali Acc: 0.193 Test Loss: 1.816 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7170109748840332
Epoch: 3, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.808 Vali Acc: 0.193 Test Loss: 1.808 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7124853134155273
Epoch: 4, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.799 Vali Acc: 0.200 Test Loss: 1.799 Test Acc: 0.200
Validation loss decreased (-0.196278 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 0.7755630016326904
Epoch: 5, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.787 Vali Acc: 0.200 Test Loss: 1.787 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.6774730682373047
Epoch: 6, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.773 Vali Acc: 0.215 Test Loss: 1.773 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.7103424072265625
Epoch: 7, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.757 Vali Acc: 0.219 Test Loss: 1.757 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 8 cost time: 0.7656638622283936
Epoch: 8, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.740 Vali Acc: 0.248 Test Loss: 1.740 Test Acc: 0.248
Validation loss decreased (-0.218501 --> -0.248131).  Saving model ...
Epoch: 9 cost time: 0.6254265308380127
Epoch: 9, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.722 Vali Acc: 0.256 Test Loss: 1.722 Test Acc: 0.256
Validation loss decreased (-0.248131 --> -0.255538).  Saving model ...
Epoch: 10 cost time: 0.6701953411102295
Epoch: 10, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.703 Vali Acc: 0.267 Test Loss: 1.703 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266650).  Saving model ...
Epoch: 11 cost time: 0.7696182727813721
Epoch: 11, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.683 Vali Acc: 0.296 Test Loss: 1.683 Test Acc: 0.296
Validation loss decreased (-0.266650 --> -0.296279).  Saving model ...
Epoch: 12 cost time: 0.638359546661377
Epoch: 12, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.663 Vali Acc: 0.307 Test Loss: 1.663 Test Acc: 0.307
Validation loss decreased (-0.296279 --> -0.307391).  Saving model ...
Epoch: 13 cost time: 0.7004227638244629
Epoch: 13, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.643 Vali Acc: 0.337 Test Loss: 1.643 Test Acc: 0.337
Validation loss decreased (-0.307391 --> -0.337021).  Saving model ...
Epoch: 14 cost time: 0.6705543994903564
Epoch: 14, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.623 Vali Acc: 0.363 Test Loss: 1.623 Test Acc: 0.363
Validation loss decreased (-0.337021 --> -0.362947).  Saving model ...
Epoch: 15 cost time: 0.5828671455383301
Epoch: 15, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.604 Vali Acc: 0.385 Test Loss: 1.604 Test Acc: 0.385
Validation loss decreased (-0.362947 --> -0.385169).  Saving model ...
Epoch: 16 cost time: 0.5929605960845947
Epoch: 16, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.585 Vali Acc: 0.400 Test Loss: 1.585 Test Acc: 0.400
Validation loss decreased (-0.385169 --> -0.399984).  Saving model ...
Epoch: 17 cost time: 0.6780273914337158
Epoch: 17, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.567 Vali Acc: 0.411 Test Loss: 1.567 Test Acc: 0.411
Validation loss decreased (-0.399984 --> -0.411095).  Saving model ...
Epoch: 18 cost time: 0.7406649589538574
Epoch: 18, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.550 Vali Acc: 0.433 Test Loss: 1.550 Test Acc: 0.433
Validation loss decreased (-0.411095 --> -0.433318).  Saving model ...
Epoch: 19 cost time: 0.6312110424041748
Epoch: 19, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.533 Vali Acc: 0.481 Test Loss: 1.533 Test Acc: 0.481
Validation loss decreased (-0.433318 --> -0.481466).  Saving model ...
Epoch: 20 cost time: 0.7047719955444336
Epoch: 20, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.517 Vali Acc: 0.489 Test Loss: 1.517 Test Acc: 0.489
Validation loss decreased (-0.481466 --> -0.488874).  Saving model ...
Epoch: 21 cost time: 0.7412092685699463
Epoch: 21, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.500 Vali Acc: 0.507 Test Loss: 1.500 Test Acc: 0.507
Validation loss decreased (-0.488874 --> -0.507392).  Saving model ...
Epoch: 22 cost time: 0.6664998531341553
Epoch: 22, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.484 Vali Acc: 0.537 Test Loss: 1.484 Test Acc: 0.537
Validation loss decreased (-0.507392 --> -0.537022).  Saving model ...
Epoch: 23 cost time: 0.8260486125946045
Epoch: 23, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.469 Vali Acc: 0.544 Test Loss: 1.469 Test Acc: 0.544
Validation loss decreased (-0.537022 --> -0.544430).  Saving model ...
Epoch: 24 cost time: 0.6677572727203369
Epoch: 24, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.454 Vali Acc: 0.559 Test Loss: 1.454 Test Acc: 0.559
Validation loss decreased (-0.544430 --> -0.559245).  Saving model ...
Epoch: 25 cost time: 0.9304442405700684
Epoch: 25, Steps: 2 | Train Loss: 0.802 Vali Loss: 1.440 Vali Acc: 0.589 Test Loss: 1.440 Test Acc: 0.589
Validation loss decreased (-0.559245 --> -0.588874).  Saving model ...
Epoch: 26 cost time: 0.9168205261230469
Epoch: 26, Steps: 2 | Train Loss: 0.760 Vali Loss: 1.427 Vali Acc: 0.596 Test Loss: 1.427 Test Acc: 0.596
Validation loss decreased (-0.588874 --> -0.596282).  Saving model ...
Epoch: 27 cost time: 0.693906307220459
Epoch: 27, Steps: 2 | Train Loss: 0.762 Vali Loss: 1.414 Vali Acc: 0.600 Test Loss: 1.414 Test Acc: 0.600
Validation loss decreased (-0.596282 --> -0.599986).  Saving model ...
Epoch: 28 cost time: 0.7895019054412842
Epoch: 28, Steps: 2 | Train Loss: 0.729 Vali Loss: 1.402 Vali Acc: 0.611 Test Loss: 1.402 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611097).  Saving model ...
Epoch: 29 cost time: 0.7028272151947021
Epoch: 29, Steps: 2 | Train Loss: 0.696 Vali Loss: 1.390 Vali Acc: 0.626 Test Loss: 1.390 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625912).  Saving model ...
Epoch: 30 cost time: 0.868701696395874
Epoch: 30, Steps: 2 | Train Loss: 0.643 Vali Loss: 1.379 Vali Acc: 0.622 Test Loss: 1.379 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9130508899688721
Epoch: 31, Steps: 2 | Train Loss: 0.635 Vali Loss: 1.367 Vali Acc: 0.626 Test Loss: 1.367 Test Acc: 0.626
Validation loss decreased (-0.625912 --> -0.625912).  Saving model ...
Epoch: 32 cost time: 0.5761725902557373
Epoch: 32, Steps: 2 | Train Loss: 0.623 Vali Loss: 1.357 Vali Acc: 0.630 Test Loss: 1.357 Test Acc: 0.630
Validation loss decreased (-0.625912 --> -0.629616).  Saving model ...
Epoch: 33 cost time: 0.8043580055236816
Epoch: 33, Steps: 2 | Train Loss: 0.568 Vali Loss: 1.348 Vali Acc: 0.633 Test Loss: 1.348 Test Acc: 0.633
Validation loss decreased (-0.629616 --> -0.633320).  Saving model ...
Epoch: 34 cost time: 0.7481772899627686
Epoch: 34, Steps: 2 | Train Loss: 0.555 Vali Loss: 1.339 Vali Acc: 0.633 Test Loss: 1.339 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 35 cost time: 0.7891645431518555
Epoch: 35, Steps: 2 | Train Loss: 0.539 Vali Loss: 1.331 Vali Acc: 0.633 Test Loss: 1.331 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 36 cost time: 0.9316482543945312
Epoch: 36, Steps: 2 | Train Loss: 0.516 Vali Loss: 1.322 Vali Acc: 0.637 Test Loss: 1.322 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.637024).  Saving model ...
Epoch: 37 cost time: 0.7816317081451416
Epoch: 37, Steps: 2 | Train Loss: 0.491 Vali Loss: 1.312 Vali Acc: 0.637 Test Loss: 1.312 Test Acc: 0.637
Validation loss decreased (-0.637024 --> -0.637024).  Saving model ...
Epoch: 38 cost time: 0.633690357208252
Epoch: 38, Steps: 2 | Train Loss: 0.462 Vali Loss: 1.301 Vali Acc: 0.641 Test Loss: 1.301 Test Acc: 0.641
Validation loss decreased (-0.637024 --> -0.640728).  Saving model ...
Epoch: 39 cost time: 0.7103800773620605
Epoch: 39, Steps: 2 | Train Loss: 0.439 Vali Loss: 1.291 Vali Acc: 0.648 Test Loss: 1.291 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648135).  Saving model ...
Epoch: 40 cost time: 0.8022840023040771
Epoch: 40, Steps: 2 | Train Loss: 0.421 Vali Loss: 1.281 Vali Acc: 0.652 Test Loss: 1.281 Test Acc: 0.652
Validation loss decreased (-0.648135 --> -0.651839).  Saving model ...
Epoch: 41 cost time: 0.6285836696624756
Epoch: 41, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.273 Vali Acc: 0.659 Test Loss: 1.273 Test Acc: 0.659
Validation loss decreased (-0.651839 --> -0.659247).  Saving model ...
Epoch: 42 cost time: 0.6346676349639893
Epoch: 42, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.265 Vali Acc: 0.667 Test Loss: 1.265 Test Acc: 0.667
Validation loss decreased (-0.659247 --> -0.666654).  Saving model ...
Epoch: 43 cost time: 0.6741194725036621
Epoch: 43, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.257 Vali Acc: 0.667 Test Loss: 1.257 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 44 cost time: 0.6661365032196045
Epoch: 44, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.250 Vali Acc: 0.663 Test Loss: 1.250 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6430068016052246
Epoch: 45, Steps: 2 | Train Loss: 0.358 Vali Loss: 1.241 Vali Acc: 0.674 Test Loss: 1.241 Test Acc: 0.674
Validation loss decreased (-0.666654 --> -0.674062).  Saving model ...
Epoch: 46 cost time: 0.6176345348358154
Epoch: 46, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.233 Vali Acc: 0.667 Test Loss: 1.233 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.680469274520874
Epoch: 47, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.224 Vali Acc: 0.667 Test Loss: 1.224 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6545007228851318
Epoch: 48, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.217 Vali Acc: 0.667 Test Loss: 1.217 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8567650318145752
Epoch: 49, Steps: 2 | Train Loss: 0.298 Vali Loss: 1.211 Vali Acc: 0.659 Test Loss: 1.211 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8378703594207764
Epoch: 50, Steps: 2 | Train Loss: 0.282 Vali Loss: 1.206 Vali Acc: 0.659 Test Loss: 1.206 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6329708099365234
Epoch: 51, Steps: 2 | Train Loss: 0.281 Vali Loss: 1.200 Vali Acc: 0.659 Test Loss: 1.200 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6171133518218994
Epoch: 52, Steps: 2 | Train Loss: 0.255 Vali Loss: 1.194 Vali Acc: 0.659 Test Loss: 1.194 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.5668003559112549
Epoch: 53, Steps: 2 | Train Loss: 0.257 Vali Loss: 1.189 Vali Acc: 0.659 Test Loss: 1.189 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6638498306274414
Epoch: 54, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.184 Vali Acc: 0.663 Test Loss: 1.184 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8589181900024414
Epoch: 55, Steps: 2 | Train Loss: 0.234 Vali Loss: 1.178 Vali Acc: 0.667 Test Loss: 1.178 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.674074074074074
model parameter : 278244
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.162233591079712
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.860 Vali Acc: 0.148 Test Loss: 1.860 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.6225252151489258
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.853 Vali Acc: 0.159 Test Loss: 1.853 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.5704455375671387
Epoch: 3, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.846 Vali Acc: 0.167 Test Loss: 1.846 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 0.6383638381958008
Epoch: 4, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.836 Vali Acc: 0.174 Test Loss: 1.836 Test Acc: 0.174
Validation loss decreased (-0.166648 --> -0.174056).  Saving model ...
Epoch: 5 cost time: 0.5590755939483643
Epoch: 5, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.823 Vali Acc: 0.174 Test Loss: 1.823 Test Acc: 0.174
Validation loss decreased (-0.174056 --> -0.174056).  Saving model ...
Epoch: 6 cost time: 0.5050044059753418
Epoch: 6, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.807 Vali Acc: 0.185 Test Loss: 1.807 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185167).  Saving model ...
Epoch: 7 cost time: 0.6024570465087891
Epoch: 7, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.790 Vali Acc: 0.200 Test Loss: 1.790 Test Acc: 0.200
Validation loss decreased (-0.185167 --> -0.199982).  Saving model ...
Epoch: 8 cost time: 0.5595893859863281
Epoch: 8, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.772 Vali Acc: 0.219 Test Loss: 1.772 Test Acc: 0.219
Validation loss decreased (-0.199982 --> -0.218501).  Saving model ...
Epoch: 9 cost time: 0.5809371471405029
Epoch: 9, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.753 Vali Acc: 0.252 Test Loss: 1.753 Test Acc: 0.252
Validation loss decreased (-0.218501 --> -0.251834).  Saving model ...
Epoch: 10 cost time: 0.6126728057861328
Epoch: 10, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.732 Vali Acc: 0.281 Test Loss: 1.732 Test Acc: 0.281
Validation loss decreased (-0.251834 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.672452449798584
Epoch: 11, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.712 Vali Acc: 0.307 Test Loss: 1.712 Test Acc: 0.307
Validation loss decreased (-0.281464 --> -0.307390).  Saving model ...
Epoch: 12 cost time: 0.5989198684692383
Epoch: 12, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.691 Vali Acc: 0.333 Test Loss: 1.691 Test Acc: 0.333
Validation loss decreased (-0.307390 --> -0.333316).  Saving model ...
Epoch: 13 cost time: 0.6545712947845459
Epoch: 13, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.670 Vali Acc: 0.363 Test Loss: 1.670 Test Acc: 0.363
Validation loss decreased (-0.333316 --> -0.362946).  Saving model ...
Epoch: 14 cost time: 0.5671443939208984
Epoch: 14, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.651 Vali Acc: 0.396 Test Loss: 1.651 Test Acc: 0.396
Validation loss decreased (-0.362946 --> -0.396280).  Saving model ...
Epoch: 15 cost time: 0.5647428035736084
Epoch: 15, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.632 Vali Acc: 0.419 Test Loss: 1.632 Test Acc: 0.419
Validation loss decreased (-0.396280 --> -0.418502).  Saving model ...
Epoch: 16 cost time: 0.6083507537841797
Epoch: 16, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.614 Vali Acc: 0.441 Test Loss: 1.614 Test Acc: 0.441
Validation loss decreased (-0.418502 --> -0.440725).  Saving model ...
Epoch: 17 cost time: 0.913769006729126
Epoch: 17, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.596 Vali Acc: 0.459 Test Loss: 1.596 Test Acc: 0.459
Validation loss decreased (-0.440725 --> -0.459243).  Saving model ...
Epoch: 18 cost time: 0.6115291118621826
Epoch: 18, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.578 Vali Acc: 0.478 Test Loss: 1.578 Test Acc: 0.478
Validation loss decreased (-0.459243 --> -0.477762).  Saving model ...
Epoch: 19 cost time: 0.691173791885376
Epoch: 19, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
Validation loss decreased (-0.477762 --> -0.499984).  Saving model ...
Epoch: 20 cost time: 0.5606930255889893
Epoch: 20, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.546 Vali Acc: 0.522 Test Loss: 1.546 Test Acc: 0.522
Validation loss decreased (-0.499984 --> -0.522207).  Saving model ...
Epoch: 21 cost time: 0.5938892364501953
Epoch: 21, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.530 Vali Acc: 0.552 Test Loss: 1.530 Test Acc: 0.552
Validation loss decreased (-0.522207 --> -0.551837).  Saving model ...
Epoch: 22 cost time: 0.831606388092041
Epoch: 22, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.515 Vali Acc: 0.559 Test Loss: 1.515 Test Acc: 0.559
Validation loss decreased (-0.551837 --> -0.559244).  Saving model ...
Epoch: 23 cost time: 0.7908520698547363
Epoch: 23, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.500 Vali Acc: 0.567 Test Loss: 1.500 Test Acc: 0.567
Validation loss decreased (-0.559244 --> -0.566652).  Saving model ...
Epoch: 24 cost time: 0.6687109470367432
Epoch: 24, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.485 Vali Acc: 0.581 Test Loss: 1.485 Test Acc: 0.581
Validation loss decreased (-0.566652 --> -0.581467).  Saving model ...
Epoch: 25 cost time: 0.7058041095733643
Epoch: 25, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.470 Vali Acc: 0.604 Test Loss: 1.470 Test Acc: 0.604
Validation loss decreased (-0.581467 --> -0.603689).  Saving model ...
Epoch: 26 cost time: 0.5758171081542969
Epoch: 26, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.456 Vali Acc: 0.619 Test Loss: 1.456 Test Acc: 0.619
Validation loss decreased (-0.603689 --> -0.618504).  Saving model ...
Epoch: 27 cost time: 0.6353280544281006
Epoch: 27, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.441 Vali Acc: 0.619 Test Loss: 1.441 Test Acc: 0.619
Validation loss decreased (-0.618504 --> -0.618504).  Saving model ...
Epoch: 28 cost time: 0.6565587520599365
Epoch: 28, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.427 Vali Acc: 0.630 Test Loss: 1.427 Test Acc: 0.630
Validation loss decreased (-0.618504 --> -0.629615).  Saving model ...
Epoch: 29 cost time: 0.6007571220397949
Epoch: 29, Steps: 2 | Train Loss: 0.857 Vali Loss: 1.413 Vali Acc: 0.644 Test Loss: 1.413 Test Acc: 0.644
Validation loss decreased (-0.629615 --> -0.644430).  Saving model ...
Epoch: 30 cost time: 0.7592437267303467
Epoch: 30, Steps: 2 | Train Loss: 0.811 Vali Loss: 1.399 Vali Acc: 0.663 Test Loss: 1.399 Test Acc: 0.663
Validation loss decreased (-0.644430 --> -0.662949).  Saving model ...
Epoch: 31 cost time: 0.7259471416473389
Epoch: 31, Steps: 2 | Train Loss: 0.799 Vali Loss: 1.385 Vali Acc: 0.674 Test Loss: 1.385 Test Acc: 0.674
Validation loss decreased (-0.662949 --> -0.674060).  Saving model ...
Epoch: 32 cost time: 0.6575405597686768
Epoch: 32, Steps: 2 | Train Loss: 0.757 Vali Loss: 1.371 Vali Acc: 0.674 Test Loss: 1.371 Test Acc: 0.674
Validation loss decreased (-0.674060 --> -0.674060).  Saving model ...
Epoch: 33 cost time: 0.7187025547027588
Epoch: 33, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.359 Vali Acc: 0.674 Test Loss: 1.359 Test Acc: 0.674
Validation loss decreased (-0.674060 --> -0.674060).  Saving model ...
Epoch: 34 cost time: 0.6316342353820801
Epoch: 34, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.346 Vali Acc: 0.681 Test Loss: 1.346 Test Acc: 0.681
Validation loss decreased (-0.674060 --> -0.681468).  Saving model ...
Epoch: 35 cost time: 0.6646974086761475
Epoch: 35, Steps: 2 | Train Loss: 0.681 Vali Loss: 1.334 Vali Acc: 0.685 Test Loss: 1.334 Test Acc: 0.685
Validation loss decreased (-0.681468 --> -0.685172).  Saving model ...
Epoch: 36 cost time: 0.6747550964355469
Epoch: 36, Steps: 2 | Train Loss: 0.671 Vali Loss: 1.323 Vali Acc: 0.674 Test Loss: 1.323 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9091155529022217
Epoch: 37, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.312 Vali Acc: 0.678 Test Loss: 1.312 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7557711601257324
Epoch: 38, Steps: 2 | Train Loss: 0.584 Vali Loss: 1.302 Vali Acc: 0.674 Test Loss: 1.302 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6042518615722656
Epoch: 39, Steps: 2 | Train Loss: 0.568 Vali Loss: 1.292 Vali Acc: 0.681 Test Loss: 1.292 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7313811779022217
Epoch: 40, Steps: 2 | Train Loss: 0.543 Vali Loss: 1.282 Vali Acc: 0.674 Test Loss: 1.282 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6909029483795166
Epoch: 41, Steps: 2 | Train Loss: 0.553 Vali Loss: 1.270 Vali Acc: 0.689 Test Loss: 1.270 Test Acc: 0.689
Validation loss decreased (-0.685172 --> -0.688876).  Saving model ...
Epoch: 42 cost time: 0.6205205917358398
Epoch: 42, Steps: 2 | Train Loss: 0.506 Vali Loss: 1.257 Vali Acc: 0.693 Test Loss: 1.257 Test Acc: 0.693
Validation loss decreased (-0.688876 --> -0.692580).  Saving model ...
Epoch: 43 cost time: 0.5508215427398682
Epoch: 43, Steps: 2 | Train Loss: 0.475 Vali Loss: 1.247 Vali Acc: 0.696 Test Loss: 1.247 Test Acc: 0.696
Validation loss decreased (-0.692580 --> -0.696284).  Saving model ...
Epoch: 44 cost time: 0.6416871547698975
Epoch: 44, Steps: 2 | Train Loss: 0.462 Vali Loss: 1.236 Vali Acc: 0.696 Test Loss: 1.236 Test Acc: 0.696
Validation loss decreased (-0.696284 --> -0.696284).  Saving model ...
Epoch: 45 cost time: 0.6684348583221436
Epoch: 45, Steps: 2 | Train Loss: 0.447 Vali Loss: 1.225 Vali Acc: 0.693 Test Loss: 1.225 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8295583724975586
Epoch: 46, Steps: 2 | Train Loss: 0.411 Vali Loss: 1.215 Vali Acc: 0.693 Test Loss: 1.215 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5994503498077393
Epoch: 47, Steps: 2 | Train Loss: 0.417 Vali Loss: 1.205 Vali Acc: 0.696 Test Loss: 1.205 Test Acc: 0.696
Validation loss decreased (-0.696284 --> -0.696284).  Saving model ...
Epoch: 48 cost time: 0.6533951759338379
Epoch: 48, Steps: 2 | Train Loss: 0.375 Vali Loss: 1.195 Vali Acc: 0.696 Test Loss: 1.195 Test Acc: 0.696
Validation loss decreased (-0.696284 --> -0.696284).  Saving model ...
Epoch: 49 cost time: 0.7326951026916504
Epoch: 49, Steps: 2 | Train Loss: 0.370 Vali Loss: 1.184 Vali Acc: 0.696 Test Loss: 1.184 Test Acc: 0.696
Validation loss decreased (-0.696284 --> -0.696284).  Saving model ...
Epoch: 50 cost time: 0.5700609683990479
Epoch: 50, Steps: 2 | Train Loss: 0.349 Vali Loss: 1.174 Vali Acc: 0.693 Test Loss: 1.174 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6072168350219727
Epoch: 51, Steps: 2 | Train Loss: 0.352 Vali Loss: 1.166 Vali Acc: 0.693 Test Loss: 1.166 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5864603519439697
Epoch: 52, Steps: 2 | Train Loss: 0.326 Vali Loss: 1.158 Vali Acc: 0.689 Test Loss: 1.158 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.575305700302124
Epoch: 53, Steps: 2 | Train Loss: 0.320 Vali Loss: 1.150 Vali Acc: 0.681 Test Loss: 1.150 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7324812412261963
Epoch: 54, Steps: 2 | Train Loss: 0.311 Vali Loss: 1.144 Vali Acc: 0.681 Test Loss: 1.144 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6163105964660645
Epoch: 55, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.139 Vali Acc: 0.685 Test Loss: 1.139 Test Acc: 0.685
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5121660232543945
Epoch: 56, Steps: 2 | Train Loss: 0.263 Vali Loss: 1.133 Vali Acc: 0.681 Test Loss: 1.133 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.6389369964599609
Epoch: 57, Steps: 2 | Train Loss: 0.264 Vali Loss: 1.126 Vali Acc: 0.681 Test Loss: 1.126 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.8145442008972168
Epoch: 58, Steps: 2 | Train Loss: 0.246 Vali Loss: 1.119 Vali Acc: 0.681 Test Loss: 1.119 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.6986033916473389
Epoch: 59, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.113 Vali Acc: 0.685 Test Loss: 1.113 Test Acc: 0.685
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6962962962962963
model parameter : 276196
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3916656970977783
Epoch: 1, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.744 Vali Acc: 0.248 Test Loss: 1.744 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 0.6132423877716064
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.737 Vali Acc: 0.267 Test Loss: 1.737 Test Acc: 0.267
Validation loss decreased (-0.248131 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.7745840549468994
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.731 Vali Acc: 0.274 Test Loss: 1.731 Test Acc: 0.274
Validation loss decreased (-0.266649 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.7016453742980957
Epoch: 4, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.721 Vali Acc: 0.289 Test Loss: 1.721 Test Acc: 0.289
Validation loss decreased (-0.274057 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.7547709941864014
Epoch: 5, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.709 Vali Acc: 0.300 Test Loss: 1.709 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 0.6605455875396729
Epoch: 6, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.695 Vali Acc: 0.315 Test Loss: 1.695 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 7 cost time: 0.7701289653778076
Epoch: 7, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.680 Vali Acc: 0.322 Test Loss: 1.680 Test Acc: 0.322
Validation loss decreased (-0.314798 --> -0.322205).  Saving model ...
Epoch: 8 cost time: 0.772097110748291
Epoch: 8, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.663 Vali Acc: 0.359 Test Loss: 1.663 Test Acc: 0.359
Validation loss decreased (-0.322205 --> -0.359243).  Saving model ...
Epoch: 9 cost time: 0.6771268844604492
Epoch: 9, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.646 Vali Acc: 0.381 Test Loss: 1.646 Test Acc: 0.381
Validation loss decreased (-0.359243 --> -0.381465).  Saving model ...
Epoch: 10 cost time: 0.8683304786682129
Epoch: 10, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.627 Vali Acc: 0.407 Test Loss: 1.627 Test Acc: 0.407
Validation loss decreased (-0.381465 --> -0.407391).  Saving model ...
Epoch: 11 cost time: 0.6775410175323486
Epoch: 11, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.608 Vali Acc: 0.433 Test Loss: 1.608 Test Acc: 0.433
Validation loss decreased (-0.407391 --> -0.433317).  Saving model ...
Epoch: 12 cost time: 0.5943634510040283
Epoch: 12, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.589 Vali Acc: 0.448 Test Loss: 1.589 Test Acc: 0.448
Validation loss decreased (-0.433317 --> -0.448132).  Saving model ...
Epoch: 13 cost time: 0.5357038974761963
Epoch: 13, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.570 Vali Acc: 0.459 Test Loss: 1.570 Test Acc: 0.459
Validation loss decreased (-0.448132 --> -0.459244).  Saving model ...
Epoch: 14 cost time: 0.6335659027099609
Epoch: 14, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.550 Vali Acc: 0.474 Test Loss: 1.550 Test Acc: 0.474
Validation loss decreased (-0.459244 --> -0.474059).  Saving model ...
Epoch: 15 cost time: 0.6398038864135742
Epoch: 15, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.531 Vali Acc: 0.500 Test Loss: 1.531 Test Acc: 0.500
Validation loss decreased (-0.474059 --> -0.499985).  Saving model ...
Epoch: 16 cost time: 0.6511569023132324
Epoch: 16, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.512 Vali Acc: 0.515 Test Loss: 1.512 Test Acc: 0.515
Validation loss decreased (-0.499985 --> -0.514800).  Saving model ...
Epoch: 17 cost time: 0.5742435455322266
Epoch: 17, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.493 Vali Acc: 0.548 Test Loss: 1.493 Test Acc: 0.548
Validation loss decreased (-0.514800 --> -0.548133).  Saving model ...
Epoch: 18 cost time: 0.5758492946624756
Epoch: 18, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.474 Vali Acc: 0.559 Test Loss: 1.474 Test Acc: 0.559
Validation loss decreased (-0.548133 --> -0.559245).  Saving model ...
Epoch: 19 cost time: 0.6637718677520752
Epoch: 19, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.455 Vali Acc: 0.581 Test Loss: 1.455 Test Acc: 0.581
Validation loss decreased (-0.559245 --> -0.581467).  Saving model ...
Epoch: 20 cost time: 0.5882859230041504
Epoch: 20, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.437 Vali Acc: 0.611 Test Loss: 1.437 Test Acc: 0.611
Validation loss decreased (-0.581467 --> -0.611097).  Saving model ...
Epoch: 21 cost time: 0.6591880321502686
Epoch: 21, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.419 Vali Acc: 0.615 Test Loss: 1.419 Test Acc: 0.615
Validation loss decreased (-0.611097 --> -0.614801).  Saving model ...
Epoch: 22 cost time: 0.7002456188201904
Epoch: 22, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.401 Vali Acc: 0.619 Test Loss: 1.401 Test Acc: 0.619
Validation loss decreased (-0.614801 --> -0.618505).  Saving model ...
Epoch: 23 cost time: 0.9228389263153076
Epoch: 23, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.384 Vali Acc: 0.630 Test Loss: 1.384 Test Acc: 0.630
Validation loss decreased (-0.618505 --> -0.629616).  Saving model ...
Epoch: 24 cost time: 0.6780822277069092
Epoch: 24, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.368 Vali Acc: 0.633 Test Loss: 1.368 Test Acc: 0.633
Validation loss decreased (-0.629616 --> -0.633320).  Saving model ...
Epoch: 25 cost time: 0.6674516201019287
Epoch: 25, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.351 Vali Acc: 0.644 Test Loss: 1.351 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644431).  Saving model ...
Epoch: 26 cost time: 0.6874752044677734
Epoch: 26, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.335 Vali Acc: 0.644 Test Loss: 1.335 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 27 cost time: 0.5976238250732422
Epoch: 27, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.319 Vali Acc: 0.633 Test Loss: 1.319 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6984610557556152
Epoch: 28, Steps: 2 | Train Loss: 0.802 Vali Loss: 1.303 Vali Acc: 0.637 Test Loss: 1.303 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7475419044494629
Epoch: 29, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.287 Vali Acc: 0.656 Test Loss: 1.287 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655543).  Saving model ...
Epoch: 30 cost time: 0.5925345420837402
Epoch: 30, Steps: 2 | Train Loss: 0.722 Vali Loss: 1.273 Vali Acc: 0.659 Test Loss: 1.273 Test Acc: 0.659
Validation loss decreased (-0.655543 --> -0.659247).  Saving model ...
Epoch: 31 cost time: 0.6502902507781982
Epoch: 31, Steps: 2 | Train Loss: 0.706 Vali Loss: 1.258 Vali Acc: 0.656 Test Loss: 1.258 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6137905120849609
Epoch: 32, Steps: 2 | Train Loss: 0.669 Vali Loss: 1.243 Vali Acc: 0.663 Test Loss: 1.243 Test Acc: 0.663
Validation loss decreased (-0.659247 --> -0.662951).  Saving model ...
Epoch: 33 cost time: 0.8250901699066162
Epoch: 33, Steps: 2 | Train Loss: 0.658 Vali Loss: 1.230 Vali Acc: 0.659 Test Loss: 1.230 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5722343921661377
Epoch: 34, Steps: 2 | Train Loss: 0.598 Vali Loss: 1.218 Vali Acc: 0.656 Test Loss: 1.218 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.900691032409668
Epoch: 35, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.204 Vali Acc: 0.659 Test Loss: 1.204 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7200560569763184
Epoch: 36, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.190 Vali Acc: 0.663 Test Loss: 1.190 Test Acc: 0.663
Validation loss decreased (-0.662951 --> -0.662951).  Saving model ...
Epoch: 37 cost time: 0.6145031452178955
Epoch: 37, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.175 Vali Acc: 0.681 Test Loss: 1.175 Test Acc: 0.681
Validation loss decreased (-0.662951 --> -0.681470).  Saving model ...
Epoch: 38 cost time: 0.6169748306274414
Epoch: 38, Steps: 2 | Train Loss: 0.508 Vali Loss: 1.161 Vali Acc: 0.689 Test Loss: 1.161 Test Acc: 0.689
Validation loss decreased (-0.681470 --> -0.688877).  Saving model ...
Epoch: 39 cost time: 0.5251200199127197
Epoch: 39, Steps: 2 | Train Loss: 0.455 Vali Loss: 1.150 Vali Acc: 0.696 Test Loss: 1.150 Test Acc: 0.696
Validation loss decreased (-0.688877 --> -0.696285).  Saving model ...
Epoch: 40 cost time: 0.5583803653717041
Epoch: 40, Steps: 2 | Train Loss: 0.472 Vali Loss: 1.139 Vali Acc: 0.704 Test Loss: 1.139 Test Acc: 0.704
Validation loss decreased (-0.696285 --> -0.703692).  Saving model ...
Epoch: 41 cost time: 0.5875952243804932
Epoch: 41, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.128 Vali Acc: 0.707 Test Loss: 1.128 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 42 cost time: 0.6568925380706787
Epoch: 42, Steps: 2 | Train Loss: 0.410 Vali Loss: 1.118 Vali Acc: 0.707 Test Loss: 1.118 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 43 cost time: 0.6189510822296143
Epoch: 43, Steps: 2 | Train Loss: 0.395 Vali Loss: 1.109 Vali Acc: 0.711 Test Loss: 1.109 Test Acc: 0.711
Validation loss decreased (-0.707396 --> -0.711100).  Saving model ...
Epoch: 44 cost time: 0.6847717761993408
Epoch: 44, Steps: 2 | Train Loss: 0.358 Vali Loss: 1.100 Vali Acc: 0.722 Test Loss: 1.100 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722211).  Saving model ...
Epoch: 45 cost time: 0.6319019794464111
Epoch: 45, Steps: 2 | Train Loss: 0.346 Vali Loss: 1.091 Vali Acc: 0.722 Test Loss: 1.091 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722211).  Saving model ...
Epoch: 46 cost time: 0.761091947555542
Epoch: 46, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.083 Vali Acc: 0.715 Test Loss: 1.083 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7808568477630615
Epoch: 47, Steps: 2 | Train Loss: 0.308 Vali Loss: 1.075 Vali Acc: 0.711 Test Loss: 1.075 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6252632141113281
Epoch: 48, Steps: 2 | Train Loss: 0.297 Vali Loss: 1.067 Vali Acc: 0.711 Test Loss: 1.067 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6120126247406006
Epoch: 49, Steps: 2 | Train Loss: 0.290 Vali Loss: 1.060 Vali Acc: 0.715 Test Loss: 1.060 Test Acc: 0.715
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.570244550704956
Epoch: 50, Steps: 2 | Train Loss: 0.275 Vali Loss: 1.054 Vali Acc: 0.719 Test Loss: 1.054 Test Acc: 0.719
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6028754711151123
Epoch: 51, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.049 Vali Acc: 0.719 Test Loss: 1.049 Test Acc: 0.719
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5838782787322998
Epoch: 52, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.045 Vali Acc: 0.719 Test Loss: 1.045 Test Acc: 0.719
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.6519393920898438
Epoch: 53, Steps: 2 | Train Loss: 0.249 Vali Loss: 1.040 Vali Acc: 0.719 Test Loss: 1.040 Test Acc: 0.719
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.59283447265625
Epoch: 54, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.036 Vali Acc: 0.719 Test Loss: 1.036 Test Acc: 0.719
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.6674013137817383
Epoch: 55, Steps: 2 | Train Loss: 0.220 Vali Loss: 1.032 Vali Acc: 0.719 Test Loss: 1.032 Test Acc: 0.719
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7222222222222222
model parameter : 272100
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2802577018737793
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.923 Vali Acc: 0.059 Test Loss: 1.923 Test Acc: 0.059
Validation loss decreased (inf --> -0.059240).  Saving model ...
Epoch: 2 cost time: 0.5581731796264648
Epoch: 2, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.915 Vali Acc: 0.059 Test Loss: 1.915 Test Acc: 0.059
Validation loss decreased (-0.059240 --> -0.059240).  Saving model ...
Epoch: 3 cost time: 0.5655918121337891
Epoch: 3, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.908 Vali Acc: 0.063 Test Loss: 1.908 Test Acc: 0.063
Validation loss decreased (-0.059240 --> -0.062944).  Saving model ...
Epoch: 4 cost time: 0.6061267852783203
Epoch: 4, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.898 Vali Acc: 0.067 Test Loss: 1.898 Test Acc: 0.067
Validation loss decreased (-0.062944 --> -0.066648).  Saving model ...
Epoch: 5 cost time: 0.6185188293457031
Epoch: 5, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.885 Vali Acc: 0.067 Test Loss: 1.885 Test Acc: 0.067
Validation loss decreased (-0.066648 --> -0.066648).  Saving model ...
Epoch: 6 cost time: 0.7295520305633545
Epoch: 6, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.869 Vali Acc: 0.078 Test Loss: 1.869 Test Acc: 0.078
Validation loss decreased (-0.066648 --> -0.077759).  Saving model ...
Epoch: 7 cost time: 0.565601110458374
Epoch: 7, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.852 Vali Acc: 0.096 Test Loss: 1.852 Test Acc: 0.096
Validation loss decreased (-0.077759 --> -0.096278).  Saving model ...
Epoch: 8 cost time: 0.7350945472717285
Epoch: 8, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.834 Vali Acc: 0.100 Test Loss: 1.834 Test Acc: 0.100
Validation loss decreased (-0.096278 --> -0.099982).  Saving model ...
Epoch: 9 cost time: 0.7904500961303711
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.814 Vali Acc: 0.119 Test Loss: 1.814 Test Acc: 0.119
Validation loss decreased (-0.099982 --> -0.118500).  Saving model ...
Epoch: 10 cost time: 0.6501705646514893
Epoch: 10, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.794 Vali Acc: 0.144 Test Loss: 1.794 Test Acc: 0.144
Validation loss decreased (-0.118500 --> -0.144427).  Saving model ...
Epoch: 11 cost time: 0.7390701770782471
Epoch: 11, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.773 Vali Acc: 0.207 Test Loss: 1.773 Test Acc: 0.207
Validation loss decreased (-0.144427 --> -0.207390).  Saving model ...
Epoch: 12 cost time: 0.5922031402587891
Epoch: 12, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.752 Vali Acc: 0.237 Test Loss: 1.752 Test Acc: 0.237
Validation loss decreased (-0.207390 --> -0.237020).  Saving model ...
Epoch: 13 cost time: 0.6009984016418457
Epoch: 13, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.730 Vali Acc: 0.267 Test Loss: 1.730 Test Acc: 0.267
Validation loss decreased (-0.237020 --> -0.266649).  Saving model ...
Epoch: 14 cost time: 0.5390312671661377
Epoch: 14, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.708 Vali Acc: 0.300 Test Loss: 1.708 Test Acc: 0.300
Validation loss decreased (-0.266649 --> -0.299983).  Saving model ...
Epoch: 15 cost time: 0.6487205028533936
Epoch: 15, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.686 Vali Acc: 0.315 Test Loss: 1.686 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 16 cost time: 0.8449676036834717
Epoch: 16, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.663 Vali Acc: 0.337 Test Loss: 1.663 Test Acc: 0.337
Validation loss decreased (-0.314798 --> -0.337020).  Saving model ...
Epoch: 17 cost time: 0.585918664932251
Epoch: 17, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.641 Vali Acc: 0.367 Test Loss: 1.641 Test Acc: 0.367
Validation loss decreased (-0.337020 --> -0.366650).  Saving model ...
Epoch: 18 cost time: 0.6730496883392334
Epoch: 18, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.620 Vali Acc: 0.378 Test Loss: 1.620 Test Acc: 0.378
Validation loss decreased (-0.366650 --> -0.377762).  Saving model ...
Epoch: 19 cost time: 0.6319124698638916
Epoch: 19, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.599 Vali Acc: 0.404 Test Loss: 1.599 Test Acc: 0.404
Validation loss decreased (-0.377762 --> -0.403688).  Saving model ...
Epoch: 20 cost time: 0.6862783432006836
Epoch: 20, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.579 Vali Acc: 0.430 Test Loss: 1.579 Test Acc: 0.430
Validation loss decreased (-0.403688 --> -0.429614).  Saving model ...
Epoch: 21 cost time: 0.5613985061645508
Epoch: 21, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.560 Vali Acc: 0.467 Test Loss: 1.560 Test Acc: 0.467
Validation loss decreased (-0.429614 --> -0.466651).  Saving model ...
Epoch: 22 cost time: 0.7925796508789062
Epoch: 22, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.541 Vali Acc: 0.481 Test Loss: 1.541 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 23 cost time: 0.5466349124908447
Epoch: 23, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.524 Vali Acc: 0.504 Test Loss: 1.524 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503688).  Saving model ...
Epoch: 24 cost time: 0.6368131637573242
Epoch: 24, Steps: 2 | Train Loss: 0.824 Vali Loss: 1.507 Vali Acc: 0.515 Test Loss: 1.507 Test Acc: 0.515
Validation loss decreased (-0.503688 --> -0.514800).  Saving model ...
Epoch: 25 cost time: 0.609546422958374
Epoch: 25, Steps: 2 | Train Loss: 0.807 Vali Loss: 1.491 Vali Acc: 0.526 Test Loss: 1.491 Test Acc: 0.526
Validation loss decreased (-0.514800 --> -0.525911).  Saving model ...
Epoch: 26 cost time: 0.5211982727050781
Epoch: 26, Steps: 2 | Train Loss: 0.775 Vali Loss: 1.476 Vali Acc: 0.526 Test Loss: 1.476 Test Acc: 0.526
Validation loss decreased (-0.525911 --> -0.525911).  Saving model ...
Epoch: 27 cost time: 0.5956234931945801
Epoch: 27, Steps: 2 | Train Loss: 0.757 Vali Loss: 1.461 Vali Acc: 0.537 Test Loss: 1.461 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537022).  Saving model ...
Epoch: 28 cost time: 0.5642609596252441
Epoch: 28, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.446 Vali Acc: 0.544 Test Loss: 1.446 Test Acc: 0.544
Validation loss decreased (-0.537022 --> -0.544430).  Saving model ...
Epoch: 29 cost time: 0.6463828086853027
Epoch: 29, Steps: 2 | Train Loss: 0.690 Vali Loss: 1.432 Vali Acc: 0.548 Test Loss: 1.432 Test Acc: 0.548
Validation loss decreased (-0.544430 --> -0.548134).  Saving model ...
Epoch: 30 cost time: 0.7252030372619629
Epoch: 30, Steps: 2 | Train Loss: 0.667 Vali Loss: 1.418 Vali Acc: 0.563 Test Loss: 1.418 Test Acc: 0.563
Validation loss decreased (-0.548134 --> -0.562949).  Saving model ...
Epoch: 31 cost time: 0.5776152610778809
Epoch: 31, Steps: 2 | Train Loss: 0.637 Vali Loss: 1.405 Vali Acc: 0.570 Test Loss: 1.405 Test Acc: 0.570
Validation loss decreased (-0.562949 --> -0.570356).  Saving model ...
Epoch: 32 cost time: 0.6329648494720459
Epoch: 32, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.392 Vali Acc: 0.574 Test Loss: 1.392 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 33 cost time: 0.565281867980957
Epoch: 33, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.380 Vali Acc: 0.581 Test Loss: 1.380 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 34 cost time: 0.6640439033508301
Epoch: 34, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.369 Vali Acc: 0.585 Test Loss: 1.369 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585171).  Saving model ...
Epoch: 35 cost time: 0.6054039001464844
Epoch: 35, Steps: 2 | Train Loss: 0.519 Vali Loss: 1.358 Vali Acc: 0.593 Test Loss: 1.358 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592579).  Saving model ...
Epoch: 36 cost time: 0.7776694297790527
Epoch: 36, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.348 Vali Acc: 0.604 Test Loss: 1.348 Test Acc: 0.604
Validation loss decreased (-0.592579 --> -0.603690).  Saving model ...
Epoch: 37 cost time: 0.589890718460083
Epoch: 37, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.338 Vali Acc: 0.604 Test Loss: 1.338 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 38 cost time: 0.5511586666107178
Epoch: 38, Steps: 2 | Train Loss: 0.446 Vali Loss: 1.329 Vali Acc: 0.604 Test Loss: 1.329 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 39 cost time: 0.691927433013916
Epoch: 39, Steps: 2 | Train Loss: 0.413 Vali Loss: 1.320 Vali Acc: 0.607 Test Loss: 1.320 Test Acc: 0.607
Validation loss decreased (-0.603690 --> -0.607394).  Saving model ...
Epoch: 40 cost time: 0.5125670433044434
Epoch: 40, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.313 Vali Acc: 0.611 Test Loss: 1.313 Test Acc: 0.611
Validation loss decreased (-0.607394 --> -0.611098).  Saving model ...
Epoch: 41 cost time: 0.6696219444274902
Epoch: 41, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.305 Vali Acc: 0.611 Test Loss: 1.305 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 42 cost time: 0.657738208770752
Epoch: 42, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.297 Vali Acc: 0.604 Test Loss: 1.297 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5980262756347656
Epoch: 43, Steps: 2 | Train Loss: 0.341 Vali Loss: 1.290 Vali Acc: 0.604 Test Loss: 1.290 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6231944561004639
Epoch: 44, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.282 Vali Acc: 0.604 Test Loss: 1.282 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7217316627502441
Epoch: 45, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.274 Vali Acc: 0.611 Test Loss: 1.274 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 46 cost time: 1.0836844444274902
Epoch: 46, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.266 Vali Acc: 0.611 Test Loss: 1.266 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 47 cost time: 0.6159853935241699
Epoch: 47, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.259 Vali Acc: 0.611 Test Loss: 1.259 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 48 cost time: 0.7605197429656982
Epoch: 48, Steps: 2 | Train Loss: 0.264 Vali Loss: 1.252 Vali Acc: 0.615 Test Loss: 1.252 Test Acc: 0.615
Validation loss decreased (-0.611099 --> -0.614802).  Saving model ...
Epoch: 49 cost time: 0.662804365158081
Epoch: 49, Steps: 2 | Train Loss: 0.250 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
Validation loss decreased (-0.614802 --> -0.622210).  Saving model ...
Epoch: 50 cost time: 0.7809209823608398
Epoch: 50, Steps: 2 | Train Loss: 0.241 Vali Loss: 1.241 Vali Acc: 0.622 Test Loss: 1.241 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 51 cost time: 0.7233326435089111
Epoch: 51, Steps: 2 | Train Loss: 0.238 Vali Loss: 1.234 Vali Acc: 0.622 Test Loss: 1.234 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 52 cost time: 0.6332845687866211
Epoch: 52, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.227 Vali Acc: 0.630 Test Loss: 1.227 Test Acc: 0.630
Validation loss decreased (-0.622210 --> -0.629617).  Saving model ...
Epoch: 53 cost time: 0.5986371040344238
Epoch: 53, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.220 Vali Acc: 0.630 Test Loss: 1.220 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 54 cost time: 0.6452271938323975
Epoch: 54, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.213 Vali Acc: 0.626 Test Loss: 1.213 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8465285301208496
Epoch: 55, Steps: 2 | Train Loss: 0.194 Vali Loss: 1.208 Vali Acc: 0.626 Test Loss: 1.208 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5386106967926025
Epoch: 56, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.203 Vali Acc: 0.630 Test Loss: 1.203 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629618).  Saving model ...
Epoch: 57 cost time: 0.6593194007873535
Epoch: 57, Steps: 2 | Train Loss: 0.167 Vali Loss: 1.197 Vali Acc: 0.626 Test Loss: 1.197 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6367735862731934
Epoch: 58, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.191 Vali Acc: 0.630 Test Loss: 1.191 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 59 cost time: 0.757498025894165
Epoch: 59, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.186 Vali Acc: 0.637 Test Loss: 1.186 Test Acc: 0.637
Validation loss decreased (-0.629618 --> -0.637025).  Saving model ...
Epoch: 60 cost time: 0.7424619197845459
Epoch: 60, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.181 Vali Acc: 0.644 Test Loss: 1.181 Test Acc: 0.644
Validation loss decreased (-0.637025 --> -0.644433).  Saving model ...
Epoch: 61 cost time: 0.6686534881591797
Epoch: 61, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.176 Vali Acc: 0.644 Test Loss: 1.176 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 62 cost time: 0.8267068862915039
Epoch: 62, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.170 Vali Acc: 0.644 Test Loss: 1.170 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 63 cost time: 0.517848014831543
Epoch: 63, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.165 Vali Acc: 0.644 Test Loss: 1.165 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 64 cost time: 0.7624466419219971
Epoch: 64, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.160 Vali Acc: 0.648 Test Loss: 1.160 Test Acc: 0.648
Validation loss decreased (-0.644433 --> -0.648137).  Saving model ...
Epoch: 65 cost time: 0.6110367774963379
Epoch: 65, Steps: 2 | Train Loss: 0.130 Vali Loss: 1.155 Vali Acc: 0.648 Test Loss: 1.155 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 66 cost time: 0.6538934707641602
Epoch: 66, Steps: 2 | Train Loss: 0.126 Vali Loss: 1.150 Vali Acc: 0.656 Test Loss: 1.150 Test Acc: 0.656
Validation loss decreased (-0.648137 --> -0.655544).  Saving model ...
Epoch: 67 cost time: 0.6007649898529053
Epoch: 67, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.145 Vali Acc: 0.656 Test Loss: 1.145 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 68 cost time: 0.6675357818603516
Epoch: 68, Steps: 2 | Train Loss: 0.114 Vali Loss: 1.141 Vali Acc: 0.656 Test Loss: 1.141 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 69 cost time: 0.6793832778930664
Epoch: 69, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.138 Vali Acc: 0.656 Test Loss: 1.138 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 70 cost time: 0.7988379001617432
Epoch: 70, Steps: 2 | Train Loss: 0.109 Vali Loss: 1.134 Vali Acc: 0.656 Test Loss: 1.134 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 71 cost time: 0.5761229991912842
Epoch: 71, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.131 Vali Acc: 0.659 Test Loss: 1.131 Test Acc: 0.659
Validation loss decreased (-0.655544 --> -0.659248).  Saving model ...
Epoch: 72 cost time: 0.5380148887634277
Epoch: 72, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.128 Vali Acc: 0.663 Test Loss: 1.128 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662952).  Saving model ...
Epoch: 73 cost time: 0.6131742000579834
Epoch: 73, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.124 Vali Acc: 0.667 Test Loss: 1.124 Test Acc: 0.667
Validation loss decreased (-0.662952 --> -0.666655).  Saving model ...
Epoch: 74 cost time: 0.8433148860931396
Epoch: 74, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.122 Vali Acc: 0.667 Test Loss: 1.122 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 75 cost time: 0.6197011470794678
Epoch: 75, Steps: 2 | Train Loss: 0.088 Vali Loss: 1.119 Vali Acc: 0.667 Test Loss: 1.119 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 76 cost time: 0.5526151657104492
Epoch: 76, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.117 Vali Acc: 0.667 Test Loss: 1.117 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 77 cost time: 0.7692432403564453
Epoch: 77, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 78 cost time: 0.7857799530029297
Epoch: 78, Steps: 2 | Train Loss: 0.081 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 79 cost time: 0.5208926200866699
Epoch: 79, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.112 Vali Acc: 0.667 Test Loss: 1.112 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 80 cost time: 0.5871648788452148
Epoch: 80, Steps: 2 | Train Loss: 0.076 Vali Loss: 1.109 Vali Acc: 0.663 Test Loss: 1.109 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5734243392944336
Epoch: 81, Steps: 2 | Train Loss: 0.081 Vali Loss: 1.106 Vali Acc: 0.663 Test Loss: 1.106 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.5669581890106201
Epoch: 82, Steps: 2 | Train Loss: 0.071 Vali Loss: 1.104 Vali Acc: 0.663 Test Loss: 1.104 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.7085328102111816
Epoch: 83, Steps: 2 | Train Loss: 0.073 Vali Loss: 1.101 Vali Acc: 0.659 Test Loss: 1.101 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.8040988445281982
Epoch: 84, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.099 Vali Acc: 0.663 Test Loss: 1.099 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.6305229663848877
Epoch: 85, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.097 Vali Acc: 0.667 Test Loss: 1.097 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 86 cost time: 0.5781707763671875
Epoch: 86, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.094 Vali Acc: 0.667 Test Loss: 1.094 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 87 cost time: 0.6261231899261475
Epoch: 87, Steps: 2 | Train Loss: 0.063 Vali Loss: 1.092 Vali Acc: 0.667 Test Loss: 1.092 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 88 cost time: 0.6974403858184814
Epoch: 88, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.089 Vali Acc: 0.667 Test Loss: 1.089 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 89 cost time: 0.6470611095428467
Epoch: 89, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.086 Vali Acc: 0.667 Test Loss: 1.086 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 90 cost time: 0.6498825550079346
Epoch: 90, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.083 Vali Acc: 0.667 Test Loss: 1.083 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 91 cost time: 0.5672917366027832
Epoch: 91, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.081 Vali Acc: 0.663 Test Loss: 1.081 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6263608932495117
Epoch: 92, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.079 Vali Acc: 0.663 Test Loss: 1.079 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.6705601215362549
Epoch: 93, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.077 Vali Acc: 0.663 Test Loss: 1.077 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.6928355693817139
Epoch: 94, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.075 Vali Acc: 0.663 Test Loss: 1.075 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.5996313095092773
Epoch: 95, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.073 Vali Acc: 0.663 Test Loss: 1.073 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.808314323425293
Epoch: 96, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.071 Vali Acc: 0.663 Test Loss: 1.071 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.6708197593688965
Epoch: 97, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.069 Vali Acc: 0.663 Test Loss: 1.069 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.6597616672515869
Epoch: 98, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.067 Vali Acc: 0.659 Test Loss: 1.067 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.7096669673919678
Epoch: 99, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.065 Vali Acc: 0.659 Test Loss: 1.065 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.5623462200164795
Epoch: 100, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.064 Vali Acc: 0.659 Test Loss: 1.064 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6666666666666666
model parameter : 270052
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2836670875549316
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.923 Vali Acc: 0.059 Test Loss: 1.923 Test Acc: 0.059
Validation loss decreased (inf --> -0.059240).  Saving model ...
Epoch: 2 cost time: 0.7406051158905029
Epoch: 2, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.915 Vali Acc: 0.059 Test Loss: 1.915 Test Acc: 0.059
Validation loss decreased (-0.059240 --> -0.059240).  Saving model ...
Epoch: 3 cost time: 0.6347448825836182
Epoch: 3, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.908 Vali Acc: 0.063 Test Loss: 1.908 Test Acc: 0.063
Validation loss decreased (-0.059240 --> -0.062944).  Saving model ...
Epoch: 4 cost time: 0.9171035289764404
Epoch: 4, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.898 Vali Acc: 0.067 Test Loss: 1.898 Test Acc: 0.067
Validation loss decreased (-0.062944 --> -0.066648).  Saving model ...
Epoch: 5 cost time: 0.8856978416442871
Epoch: 5, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.885 Vali Acc: 0.067 Test Loss: 1.885 Test Acc: 0.067
Validation loss decreased (-0.066648 --> -0.066648).  Saving model ...
Epoch: 6 cost time: 0.6644918918609619
Epoch: 6, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.869 Vali Acc: 0.078 Test Loss: 1.869 Test Acc: 0.078
Validation loss decreased (-0.066648 --> -0.077759).  Saving model ...
Epoch: 7 cost time: 0.6264653205871582
Epoch: 7, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.852 Vali Acc: 0.096 Test Loss: 1.852 Test Acc: 0.096
Validation loss decreased (-0.077759 --> -0.096278).  Saving model ...
Epoch: 8 cost time: 0.7101168632507324
Epoch: 8, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.834 Vali Acc: 0.100 Test Loss: 1.834 Test Acc: 0.100
Validation loss decreased (-0.096278 --> -0.099982).  Saving model ...
Epoch: 9 cost time: 0.928971529006958
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.814 Vali Acc: 0.119 Test Loss: 1.814 Test Acc: 0.119
Validation loss decreased (-0.099982 --> -0.118500).  Saving model ...
Epoch: 10 cost time: 0.7621610164642334
Epoch: 10, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.794 Vali Acc: 0.144 Test Loss: 1.794 Test Acc: 0.144
Validation loss decreased (-0.118500 --> -0.144427).  Saving model ...
Epoch: 11 cost time: 0.7421982288360596
Epoch: 11, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.773 Vali Acc: 0.207 Test Loss: 1.773 Test Acc: 0.207
Validation loss decreased (-0.144427 --> -0.207390).  Saving model ...
Epoch: 12 cost time: 0.6197903156280518
Epoch: 12, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.752 Vali Acc: 0.237 Test Loss: 1.752 Test Acc: 0.237
Validation loss decreased (-0.207390 --> -0.237020).  Saving model ...
Epoch: 13 cost time: 0.7374775409698486
Epoch: 13, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.730 Vali Acc: 0.267 Test Loss: 1.730 Test Acc: 0.267
Validation loss decreased (-0.237020 --> -0.266649).  Saving model ...
Epoch: 14 cost time: 0.5954391956329346
Epoch: 14, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.708 Vali Acc: 0.300 Test Loss: 1.708 Test Acc: 0.300
Validation loss decreased (-0.266649 --> -0.299983).  Saving model ...
Epoch: 15 cost time: 0.708540678024292
Epoch: 15, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.686 Vali Acc: 0.315 Test Loss: 1.686 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 16 cost time: 0.6471431255340576
Epoch: 16, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.663 Vali Acc: 0.337 Test Loss: 1.663 Test Acc: 0.337
Validation loss decreased (-0.314798 --> -0.337020).  Saving model ...
Epoch: 17 cost time: 0.5694966316223145
Epoch: 17, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.641 Vali Acc: 0.367 Test Loss: 1.641 Test Acc: 0.367
Validation loss decreased (-0.337020 --> -0.366650).  Saving model ...
Epoch: 18 cost time: 0.5798392295837402
Epoch: 18, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.620 Vali Acc: 0.378 Test Loss: 1.620 Test Acc: 0.378
Validation loss decreased (-0.366650 --> -0.377762).  Saving model ...
Epoch: 19 cost time: 0.5724446773529053
Epoch: 19, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.599 Vali Acc: 0.404 Test Loss: 1.599 Test Acc: 0.404
Validation loss decreased (-0.377762 --> -0.403688).  Saving model ...
Epoch: 20 cost time: 0.6137425899505615
Epoch: 20, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.579 Vali Acc: 0.430 Test Loss: 1.579 Test Acc: 0.430
Validation loss decreased (-0.403688 --> -0.429614).  Saving model ...
Epoch: 21 cost time: 0.6221864223480225
Epoch: 21, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.560 Vali Acc: 0.467 Test Loss: 1.560 Test Acc: 0.467
Validation loss decreased (-0.429614 --> -0.466651).  Saving model ...
Epoch: 22 cost time: 0.8394486904144287
Epoch: 22, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.541 Vali Acc: 0.481 Test Loss: 1.541 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 23 cost time: 0.8544504642486572
Epoch: 23, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.524 Vali Acc: 0.504 Test Loss: 1.524 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503688).  Saving model ...
Epoch: 24 cost time: 0.7469618320465088
Epoch: 24, Steps: 2 | Train Loss: 0.824 Vali Loss: 1.507 Vali Acc: 0.515 Test Loss: 1.507 Test Acc: 0.515
Validation loss decreased (-0.503688 --> -0.514800).  Saving model ...
Epoch: 25 cost time: 0.6189613342285156
Epoch: 25, Steps: 2 | Train Loss: 0.807 Vali Loss: 1.491 Vali Acc: 0.526 Test Loss: 1.491 Test Acc: 0.526
Validation loss decreased (-0.514800 --> -0.525911).  Saving model ...
Epoch: 26 cost time: 0.6777219772338867
Epoch: 26, Steps: 2 | Train Loss: 0.775 Vali Loss: 1.476 Vali Acc: 0.526 Test Loss: 1.476 Test Acc: 0.526
Validation loss decreased (-0.525911 --> -0.525911).  Saving model ...
Epoch: 27 cost time: 0.5546362400054932
Epoch: 27, Steps: 2 | Train Loss: 0.757 Vali Loss: 1.461 Vali Acc: 0.537 Test Loss: 1.461 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537022).  Saving model ...
Epoch: 28 cost time: 0.588787317276001
Epoch: 28, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.446 Vali Acc: 0.544 Test Loss: 1.446 Test Acc: 0.544
Validation loss decreased (-0.537022 --> -0.544430).  Saving model ...
Epoch: 29 cost time: 0.5522046089172363
Epoch: 29, Steps: 2 | Train Loss: 0.690 Vali Loss: 1.432 Vali Acc: 0.548 Test Loss: 1.432 Test Acc: 0.548
Validation loss decreased (-0.544430 --> -0.548134).  Saving model ...
Epoch: 30 cost time: 0.6559970378875732
Epoch: 30, Steps: 2 | Train Loss: 0.667 Vali Loss: 1.418 Vali Acc: 0.563 Test Loss: 1.418 Test Acc: 0.563
Validation loss decreased (-0.548134 --> -0.562949).  Saving model ...
Epoch: 31 cost time: 0.5870349407196045
Epoch: 31, Steps: 2 | Train Loss: 0.637 Vali Loss: 1.405 Vali Acc: 0.570 Test Loss: 1.405 Test Acc: 0.570
Validation loss decreased (-0.562949 --> -0.570356).  Saving model ...
Epoch: 32 cost time: 0.6620121002197266
Epoch: 32, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.392 Vali Acc: 0.574 Test Loss: 1.392 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 33 cost time: 0.8335201740264893
Epoch: 33, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.380 Vali Acc: 0.581 Test Loss: 1.380 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 34 cost time: 0.6395444869995117
Epoch: 34, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.369 Vali Acc: 0.585 Test Loss: 1.369 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585171).  Saving model ...
Epoch: 35 cost time: 0.6228673458099365
Epoch: 35, Steps: 2 | Train Loss: 0.519 Vali Loss: 1.358 Vali Acc: 0.593 Test Loss: 1.358 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592579).  Saving model ...
Epoch: 36 cost time: 0.66713547706604
Epoch: 36, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.348 Vali Acc: 0.604 Test Loss: 1.348 Test Acc: 0.604
Validation loss decreased (-0.592579 --> -0.603690).  Saving model ...
Epoch: 37 cost time: 0.7611243724822998
Epoch: 37, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.338 Vali Acc: 0.604 Test Loss: 1.338 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 38 cost time: 0.6416399478912354
Epoch: 38, Steps: 2 | Train Loss: 0.446 Vali Loss: 1.329 Vali Acc: 0.604 Test Loss: 1.329 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 39 cost time: 0.655921220779419
Epoch: 39, Steps: 2 | Train Loss: 0.413 Vali Loss: 1.320 Vali Acc: 0.607 Test Loss: 1.320 Test Acc: 0.607
Validation loss decreased (-0.603690 --> -0.607394).  Saving model ...
Epoch: 40 cost time: 0.5856032371520996
Epoch: 40, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.313 Vali Acc: 0.611 Test Loss: 1.313 Test Acc: 0.611
Validation loss decreased (-0.607394 --> -0.611098).  Saving model ...
Epoch: 41 cost time: 0.7229640483856201
Epoch: 41, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.305 Vali Acc: 0.611 Test Loss: 1.305 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 42 cost time: 0.6683974266052246
Epoch: 42, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.297 Vali Acc: 0.604 Test Loss: 1.297 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.721062183380127
Epoch: 43, Steps: 2 | Train Loss: 0.341 Vali Loss: 1.290 Vali Acc: 0.604 Test Loss: 1.290 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7473864555358887
Epoch: 44, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.282 Vali Acc: 0.604 Test Loss: 1.282 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6923635005950928
Epoch: 45, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.274 Vali Acc: 0.611 Test Loss: 1.274 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 46 cost time: 0.7623875141143799
Epoch: 46, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.266 Vali Acc: 0.611 Test Loss: 1.266 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 47 cost time: 0.645322322845459
Epoch: 47, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.259 Vali Acc: 0.611 Test Loss: 1.259 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 48 cost time: 0.6560354232788086
Epoch: 48, Steps: 2 | Train Loss: 0.264 Vali Loss: 1.252 Vali Acc: 0.615 Test Loss: 1.252 Test Acc: 0.615
Validation loss decreased (-0.611099 --> -0.614802).  Saving model ...
Epoch: 49 cost time: 0.5513896942138672
Epoch: 49, Steps: 2 | Train Loss: 0.250 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
Validation loss decreased (-0.614802 --> -0.622210).  Saving model ...
Epoch: 50 cost time: 0.6566660404205322
Epoch: 50, Steps: 2 | Train Loss: 0.241 Vali Loss: 1.241 Vali Acc: 0.622 Test Loss: 1.241 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 51 cost time: 0.6248648166656494
Epoch: 51, Steps: 2 | Train Loss: 0.238 Vali Loss: 1.234 Vali Acc: 0.622 Test Loss: 1.234 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 52 cost time: 0.8562295436859131
Epoch: 52, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.227 Vali Acc: 0.630 Test Loss: 1.227 Test Acc: 0.630
Validation loss decreased (-0.622210 --> -0.629617).  Saving model ...
Epoch: 53 cost time: 0.5451364517211914
Epoch: 53, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.220 Vali Acc: 0.630 Test Loss: 1.220 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 54 cost time: 0.545168399810791
Epoch: 54, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.213 Vali Acc: 0.626 Test Loss: 1.213 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7616128921508789
Epoch: 55, Steps: 2 | Train Loss: 0.194 Vali Loss: 1.208 Vali Acc: 0.626 Test Loss: 1.208 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5540533065795898
Epoch: 56, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.203 Vali Acc: 0.630 Test Loss: 1.203 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629618).  Saving model ...
Epoch: 57 cost time: 0.7833938598632812
Epoch: 57, Steps: 2 | Train Loss: 0.167 Vali Loss: 1.197 Vali Acc: 0.626 Test Loss: 1.197 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7430651187896729
Epoch: 58, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.191 Vali Acc: 0.630 Test Loss: 1.191 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 59 cost time: 0.6335229873657227
Epoch: 59, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.186 Vali Acc: 0.637 Test Loss: 1.186 Test Acc: 0.637
Validation loss decreased (-0.629618 --> -0.637025).  Saving model ...
Epoch: 60 cost time: 0.4880025386810303
Epoch: 60, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.181 Vali Acc: 0.644 Test Loss: 1.181 Test Acc: 0.644
Validation loss decreased (-0.637025 --> -0.644433).  Saving model ...
Epoch: 61 cost time: 0.5451295375823975
Epoch: 61, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.176 Vali Acc: 0.644 Test Loss: 1.176 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 62 cost time: 0.49640870094299316
Epoch: 62, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.170 Vali Acc: 0.644 Test Loss: 1.170 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 63 cost time: 0.6441032886505127
Epoch: 63, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.165 Vali Acc: 0.644 Test Loss: 1.165 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 64 cost time: 0.6782002449035645
Epoch: 64, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.160 Vali Acc: 0.648 Test Loss: 1.160 Test Acc: 0.648
Validation loss decreased (-0.644433 --> -0.648137).  Saving model ...
Epoch: 65 cost time: 0.6834003925323486
Epoch: 65, Steps: 2 | Train Loss: 0.130 Vali Loss: 1.155 Vali Acc: 0.648 Test Loss: 1.155 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 66 cost time: 0.6224081516265869
Epoch: 66, Steps: 2 | Train Loss: 0.126 Vali Loss: 1.150 Vali Acc: 0.656 Test Loss: 1.150 Test Acc: 0.656
Validation loss decreased (-0.648137 --> -0.655544).  Saving model ...
Epoch: 67 cost time: 0.5470364093780518
Epoch: 67, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.145 Vali Acc: 0.656 Test Loss: 1.145 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 68 cost time: 0.7391178607940674
Epoch: 68, Steps: 2 | Train Loss: 0.114 Vali Loss: 1.141 Vali Acc: 0.656 Test Loss: 1.141 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 69 cost time: 0.6892728805541992
Epoch: 69, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.138 Vali Acc: 0.656 Test Loss: 1.138 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 70 cost time: 0.5660803318023682
Epoch: 70, Steps: 2 | Train Loss: 0.109 Vali Loss: 1.134 Vali Acc: 0.656 Test Loss: 1.134 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 71 cost time: 0.5377898216247559
Epoch: 71, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.131 Vali Acc: 0.659 Test Loss: 1.131 Test Acc: 0.659
Validation loss decreased (-0.655544 --> -0.659248).  Saving model ...
Epoch: 72 cost time: 0.5715491771697998
Epoch: 72, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.128 Vali Acc: 0.663 Test Loss: 1.128 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662952).  Saving model ...
Epoch: 73 cost time: 0.6791954040527344
Epoch: 73, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.124 Vali Acc: 0.667 Test Loss: 1.124 Test Acc: 0.667
Validation loss decreased (-0.662952 --> -0.666655).  Saving model ...
Epoch: 74 cost time: 0.7057275772094727
Epoch: 74, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.122 Vali Acc: 0.667 Test Loss: 1.122 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 75 cost time: 0.6087195873260498
Epoch: 75, Steps: 2 | Train Loss: 0.088 Vali Loss: 1.119 Vali Acc: 0.667 Test Loss: 1.119 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 76 cost time: 0.6250145435333252
Epoch: 76, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.117 Vali Acc: 0.667 Test Loss: 1.117 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 77 cost time: 0.5003950595855713
Epoch: 77, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 78 cost time: 0.6322379112243652
Epoch: 78, Steps: 2 | Train Loss: 0.081 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 79 cost time: 0.7076082229614258
Epoch: 79, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.112 Vali Acc: 0.667 Test Loss: 1.112 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 80 cost time: 0.7110662460327148
Epoch: 80, Steps: 2 | Train Loss: 0.076 Vali Loss: 1.109 Vali Acc: 0.663 Test Loss: 1.109 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5849995613098145
Epoch: 81, Steps: 2 | Train Loss: 0.081 Vali Loss: 1.106 Vali Acc: 0.663 Test Loss: 1.106 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.7459814548492432
Epoch: 82, Steps: 2 | Train Loss: 0.071 Vali Loss: 1.104 Vali Acc: 0.663 Test Loss: 1.104 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.5423145294189453
Epoch: 83, Steps: 2 | Train Loss: 0.073 Vali Loss: 1.101 Vali Acc: 0.659 Test Loss: 1.101 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.6565067768096924
Epoch: 84, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.099 Vali Acc: 0.663 Test Loss: 1.099 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.6853344440460205
Epoch: 85, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.097 Vali Acc: 0.667 Test Loss: 1.097 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 86 cost time: 0.6449377536773682
Epoch: 86, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.094 Vali Acc: 0.667 Test Loss: 1.094 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 87 cost time: 0.6937689781188965
Epoch: 87, Steps: 2 | Train Loss: 0.063 Vali Loss: 1.092 Vali Acc: 0.667 Test Loss: 1.092 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 88 cost time: 0.7985174655914307
Epoch: 88, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.089 Vali Acc: 0.667 Test Loss: 1.089 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 89 cost time: 0.5735998153686523
Epoch: 89, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.086 Vali Acc: 0.667 Test Loss: 1.086 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 90 cost time: 0.7397665977478027
Epoch: 90, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.083 Vali Acc: 0.667 Test Loss: 1.083 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 91 cost time: 0.6366934776306152
Epoch: 91, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.081 Vali Acc: 0.663 Test Loss: 1.081 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.741267204284668
Epoch: 92, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.079 Vali Acc: 0.663 Test Loss: 1.079 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.5703344345092773
Epoch: 93, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.077 Vali Acc: 0.663 Test Loss: 1.077 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.8634717464447021
Epoch: 94, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.075 Vali Acc: 0.663 Test Loss: 1.075 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.6264839172363281
Epoch: 95, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.073 Vali Acc: 0.663 Test Loss: 1.073 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.634986400604248
Epoch: 96, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.071 Vali Acc: 0.663 Test Loss: 1.071 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.8916757106781006
Epoch: 97, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.069 Vali Acc: 0.663 Test Loss: 1.069 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.6968667507171631
Epoch: 98, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.067 Vali Acc: 0.659 Test Loss: 1.067 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.7332613468170166
Epoch: 99, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.065 Vali Acc: 0.659 Test Loss: 1.065 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 0.880425214767456
Epoch: 100, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.064 Vali Acc: 0.659 Test Loss: 1.064 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6666666666666666
model parameter : 270052
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4816317558288574
Epoch: 1, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.865 Vali Acc: 0.119 Test Loss: 1.865 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 1.0592060089111328
Epoch: 2, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.855 Vali Acc: 0.126 Test Loss: 1.855 Test Acc: 0.126
Validation loss decreased (-0.118500 --> -0.125907).  Saving model ...
Epoch: 3 cost time: 0.6984195709228516
Epoch: 3, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.840 Vali Acc: 0.130 Test Loss: 1.840 Test Acc: 0.130
Validation loss decreased (-0.125907 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 0.6416997909545898
Epoch: 4, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.813 Vali Acc: 0.170 Test Loss: 1.813 Test Acc: 0.170
Validation loss decreased (-0.129611 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 0.636948823928833
Epoch: 5, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.778 Vali Acc: 0.204 Test Loss: 1.778 Test Acc: 0.204
Validation loss decreased (-0.170352 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 0.7589542865753174
Epoch: 6, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.741 Vali Acc: 0.259 Test Loss: 1.741 Test Acc: 0.259
Validation loss decreased (-0.203686 --> -0.259242).  Saving model ...
Epoch: 7 cost time: 0.6566498279571533
Epoch: 7, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.702 Vali Acc: 0.289 Test Loss: 1.702 Test Acc: 0.289
Validation loss decreased (-0.259242 --> -0.288872).  Saving model ...
Epoch: 8 cost time: 0.6917989253997803
Epoch: 8, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.665 Vali Acc: 0.344 Test Loss: 1.665 Test Acc: 0.344
Validation loss decreased (-0.288872 --> -0.344428).  Saving model ...
Epoch: 9 cost time: 0.614377498626709
Epoch: 9, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.630 Vali Acc: 0.385 Test Loss: 1.630 Test Acc: 0.385
Validation loss decreased (-0.344428 --> -0.385169).  Saving model ...
Epoch: 10 cost time: 0.729783296585083
Epoch: 10, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.595 Vali Acc: 0.422 Test Loss: 1.595 Test Acc: 0.422
Validation loss decreased (-0.385169 --> -0.422206).  Saving model ...
Epoch: 11 cost time: 0.6183919906616211
Epoch: 11, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.568 Vali Acc: 0.452 Test Loss: 1.568 Test Acc: 0.452
Validation loss decreased (-0.422206 --> -0.451836).  Saving model ...
Epoch: 12 cost time: 0.868502140045166
Epoch: 12, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.546 Vali Acc: 0.485 Test Loss: 1.546 Test Acc: 0.485
Validation loss decreased (-0.451836 --> -0.485170).  Saving model ...
Epoch: 13 cost time: 0.8025696277618408
Epoch: 13, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.527 Vali Acc: 0.519 Test Loss: 1.527 Test Acc: 0.519
Validation loss decreased (-0.485170 --> -0.518503).  Saving model ...
Epoch: 14 cost time: 0.7105965614318848
Epoch: 14, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.507 Vali Acc: 0.522 Test Loss: 1.507 Test Acc: 0.522
Validation loss decreased (-0.518503 --> -0.522207).  Saving model ...
Epoch: 15 cost time: 0.7178840637207031
Epoch: 15, Steps: 2 | Train Loss: 0.789 Vali Loss: 1.486 Vali Acc: 0.552 Test Loss: 1.486 Test Acc: 0.552
Validation loss decreased (-0.522207 --> -0.551837).  Saving model ...
Epoch: 16 cost time: 0.6635456085205078
Epoch: 16, Steps: 2 | Train Loss: 0.755 Vali Loss: 1.466 Vali Acc: 0.563 Test Loss: 1.466 Test Acc: 0.563
Validation loss decreased (-0.551837 --> -0.562948).  Saving model ...
Epoch: 17 cost time: 0.6869289875030518
Epoch: 17, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.451 Vali Acc: 0.559 Test Loss: 1.451 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7339386940002441
Epoch: 18, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.433 Vali Acc: 0.563 Test Loss: 1.433 Test Acc: 0.563
Validation loss decreased (-0.562948 --> -0.562949).  Saving model ...
Epoch: 19 cost time: 0.770789384841919
Epoch: 19, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.421 Vali Acc: 0.570 Test Loss: 1.421 Test Acc: 0.570
Validation loss decreased (-0.562949 --> -0.570356).  Saving model ...
Epoch: 20 cost time: 0.5978364944458008
Epoch: 20, Steps: 2 | Train Loss: 0.587 Vali Loss: 1.409 Vali Acc: 0.563 Test Loss: 1.409 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6380071640014648
Epoch: 21, Steps: 2 | Train Loss: 0.553 Vali Loss: 1.398 Vali Acc: 0.578 Test Loss: 1.398 Test Acc: 0.578
Validation loss decreased (-0.570356 --> -0.577764).  Saving model ...
Epoch: 22 cost time: 0.9839558601379395
Epoch: 22, Steps: 2 | Train Loss: 0.511 Vali Loss: 1.388 Vali Acc: 0.578 Test Loss: 1.388 Test Acc: 0.578
Validation loss decreased (-0.577764 --> -0.577764).  Saving model ...
Epoch: 23 cost time: 0.7990858554840088
Epoch: 23, Steps: 2 | Train Loss: 0.492 Vali Loss: 1.379 Vali Acc: 0.593 Test Loss: 1.379 Test Acc: 0.593
Validation loss decreased (-0.577764 --> -0.592579).  Saving model ...
Epoch: 24 cost time: 0.8201408386230469
Epoch: 24, Steps: 2 | Train Loss: 0.439 Vali Loss: 1.371 Vali Acc: 0.585 Test Loss: 1.371 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6959176063537598
Epoch: 25, Steps: 2 | Train Loss: 0.422 Vali Loss: 1.362 Vali Acc: 0.611 Test Loss: 1.362 Test Acc: 0.611
Validation loss decreased (-0.592579 --> -0.611097).  Saving model ...
Epoch: 26 cost time: 0.7670292854309082
Epoch: 26, Steps: 2 | Train Loss: 0.387 Vali Loss: 1.348 Vali Acc: 0.611 Test Loss: 1.348 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611098).  Saving model ...
Epoch: 27 cost time: 0.766502857208252
Epoch: 27, Steps: 2 | Train Loss: 0.362 Vali Loss: 1.336 Vali Acc: 0.619 Test Loss: 1.336 Test Acc: 0.619
Validation loss decreased (-0.611098 --> -0.618505).  Saving model ...
Epoch: 28 cost time: 0.7251138687133789
Epoch: 28, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.326 Vali Acc: 0.619 Test Loss: 1.326 Test Acc: 0.619
Validation loss decreased (-0.618505 --> -0.618505).  Saving model ...
Epoch: 29 cost time: 1.0931875705718994
Epoch: 29, Steps: 2 | Train Loss: 0.313 Vali Loss: 1.319 Vali Acc: 0.615 Test Loss: 1.319 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7773056030273438
Epoch: 30, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.314 Vali Acc: 0.622 Test Loss: 1.314 Test Acc: 0.622
Validation loss decreased (-0.618505 --> -0.622209).  Saving model ...
Epoch: 31 cost time: 0.5067667961120605
Epoch: 31, Steps: 2 | Train Loss: 0.282 Vali Loss: 1.310 Vali Acc: 0.615 Test Loss: 1.310 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6765792369842529
Epoch: 32, Steps: 2 | Train Loss: 0.269 Vali Loss: 1.305 Vali Acc: 0.619 Test Loss: 1.305 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7025306224822998
Epoch: 33, Steps: 2 | Train Loss: 0.234 Vali Loss: 1.293 Vali Acc: 0.630 Test Loss: 1.293 Test Acc: 0.630
Validation loss decreased (-0.622209 --> -0.629617).  Saving model ...
Epoch: 34 cost time: 0.9143807888031006
Epoch: 34, Steps: 2 | Train Loss: 0.217 Vali Loss: 1.281 Vali Acc: 0.633 Test Loss: 1.281 Test Acc: 0.633
Validation loss decreased (-0.629617 --> -0.633321).  Saving model ...
Epoch: 35 cost time: 0.7048661708831787
Epoch: 35, Steps: 2 | Train Loss: 0.199 Vali Loss: 1.276 Vali Acc: 0.622 Test Loss: 1.276 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9960958957672119
Epoch: 36, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.277 Vali Acc: 0.619 Test Loss: 1.277 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6453051567077637
Epoch: 37, Steps: 2 | Train Loss: 0.180 Vali Loss: 1.273 Vali Acc: 0.633 Test Loss: 1.273 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 38 cost time: 0.5615017414093018
Epoch: 38, Steps: 2 | Train Loss: 0.179 Vali Loss: 1.265 Vali Acc: 0.630 Test Loss: 1.265 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6366610527038574
Epoch: 39, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.255 Vali Acc: 0.633 Test Loss: 1.255 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 40 cost time: 0.6253635883331299
Epoch: 40, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 41 cost time: 0.633965015411377
Epoch: 41, Steps: 2 | Train Loss: 0.147 Vali Loss: 1.239 Vali Acc: 0.630 Test Loss: 1.239 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6140108108520508
Epoch: 42, Steps: 2 | Train Loss: 0.157 Vali Loss: 1.232 Vali Acc: 0.630 Test Loss: 1.232 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7965104579925537
Epoch: 43, Steps: 2 | Train Loss: 0.135 Vali Loss: 1.226 Vali Acc: 0.637 Test Loss: 1.226 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.637025).  Saving model ...
Epoch: 44 cost time: 0.6742346286773682
Epoch: 44, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.216 Vali Acc: 0.641 Test Loss: 1.216 Test Acc: 0.641
Validation loss decreased (-0.637025 --> -0.640729).  Saving model ...
Epoch: 45 cost time: 0.6800627708435059
Epoch: 45, Steps: 2 | Train Loss: 0.120 Vali Loss: 1.209 Vali Acc: 0.630 Test Loss: 1.209 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7359974384307861
Epoch: 46, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.206 Vali Acc: 0.637 Test Loss: 1.206 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7078249454498291
Epoch: 47, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.203 Vali Acc: 0.644 Test Loss: 1.203 Test Acc: 0.644
Validation loss decreased (-0.640729 --> -0.644432).  Saving model ...
Epoch: 48 cost time: 0.7499139308929443
Epoch: 48, Steps: 2 | Train Loss: 0.106 Vali Loss: 1.196 Vali Acc: 0.644 Test Loss: 1.196 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644432).  Saving model ...
Epoch: 49 cost time: 0.6836199760437012
Epoch: 49, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.191 Vali Acc: 0.652 Test Loss: 1.191 Test Acc: 0.652
Validation loss decreased (-0.644432 --> -0.651840).  Saving model ...
Epoch: 50 cost time: 0.7686338424682617
Epoch: 50, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.188 Vali Acc: 0.659 Test Loss: 1.188 Test Acc: 0.659
Validation loss decreased (-0.651840 --> -0.659247).  Saving model ...
Epoch: 51 cost time: 0.5795712471008301
Epoch: 51, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.188 Vali Acc: 0.656 Test Loss: 1.188 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7722029685974121
Epoch: 52, Steps: 2 | Train Loss: 0.088 Vali Loss: 1.185 Vali Acc: 0.648 Test Loss: 1.185 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7130763530731201
Epoch: 53, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.181 Vali Acc: 0.656 Test Loss: 1.181 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6372964382171631
Epoch: 54, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.179 Vali Acc: 0.648 Test Loss: 1.179 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.6843302249908447
Epoch: 55, Steps: 2 | Train Loss: 0.080 Vali Loss: 1.176 Vali Acc: 0.637 Test Loss: 1.176 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7807333469390869
Epoch: 56, Steps: 2 | Train Loss: 0.074 Vali Loss: 1.174 Vali Acc: 0.630 Test Loss: 1.174 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.6740758419036865
Epoch: 57, Steps: 2 | Train Loss: 0.073 Vali Loss: 1.171 Vali Acc: 0.641 Test Loss: 1.171 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.7778937816619873
Epoch: 58, Steps: 2 | Train Loss: 0.068 Vali Loss: 1.167 Vali Acc: 0.633 Test Loss: 1.167 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.7759020328521729
Epoch: 59, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.163 Vali Acc: 0.633 Test Loss: 1.163 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6433496475219727
Epoch: 60, Steps: 2 | Train Loss: 0.061 Vali Loss: 1.159 Vali Acc: 0.641 Test Loss: 1.159 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6592592592592592
model parameter : 286392
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3902087211608887
Epoch: 1, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.933 Vali Acc: 0.067 Test Loss: 1.933 Test Acc: 0.067
Validation loss decreased (inf --> -0.066647).  Saving model ...
Epoch: 2 cost time: 0.7815117835998535
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.915 Vali Acc: 0.078 Test Loss: 1.915 Test Acc: 0.078
Validation loss decreased (-0.066647 --> -0.077759).  Saving model ...
Epoch: 3 cost time: 0.7628927230834961
Epoch: 3, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.891 Vali Acc: 0.100 Test Loss: 1.891 Test Acc: 0.100
Validation loss decreased (-0.077759 --> -0.099981).  Saving model ...
Epoch: 4 cost time: 0.7345054149627686
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.854 Vali Acc: 0.133 Test Loss: 1.854 Test Acc: 0.133
Validation loss decreased (-0.099981 --> -0.133315).  Saving model ...
Epoch: 5 cost time: 0.6969444751739502
Epoch: 5, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.811 Vali Acc: 0.174 Test Loss: 1.811 Test Acc: 0.174
Validation loss decreased (-0.133315 --> -0.174056).  Saving model ...
Epoch: 6 cost time: 0.7213125228881836
Epoch: 6, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.765 Vali Acc: 0.241 Test Loss: 1.765 Test Acc: 0.241
Validation loss decreased (-0.174056 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.7329809665679932
Epoch: 7, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.721 Vali Acc: 0.278 Test Loss: 1.721 Test Acc: 0.278
Validation loss decreased (-0.240723 --> -0.277761).  Saving model ...
Epoch: 8 cost time: 0.8514542579650879
Epoch: 8, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.679 Vali Acc: 0.326 Test Loss: 1.679 Test Acc: 0.326
Validation loss decreased (-0.277761 --> -0.325909).  Saving model ...
Epoch: 9 cost time: 0.7499189376831055
Epoch: 9, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.646 Vali Acc: 0.359 Test Loss: 1.646 Test Acc: 0.359
Validation loss decreased (-0.325909 --> -0.359243).  Saving model ...
Epoch: 10 cost time: 0.6878955364227295
Epoch: 10, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.614 Vali Acc: 0.378 Test Loss: 1.614 Test Acc: 0.378
Validation loss decreased (-0.359243 --> -0.377762).  Saving model ...
Epoch: 11 cost time: 0.7257931232452393
Epoch: 11, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.580 Vali Acc: 0.415 Test Loss: 1.580 Test Acc: 0.415
Validation loss decreased (-0.377762 --> -0.414799).  Saving model ...
Epoch: 12 cost time: 0.8445427417755127
Epoch: 12, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.551 Vali Acc: 0.441 Test Loss: 1.551 Test Acc: 0.441
Validation loss decreased (-0.414799 --> -0.440725).  Saving model ...
Epoch: 13 cost time: 0.7513015270233154
Epoch: 13, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.527 Vali Acc: 0.456 Test Loss: 1.527 Test Acc: 0.456
Validation loss decreased (-0.440725 --> -0.455540).  Saving model ...
Epoch: 14 cost time: 0.7009141445159912
Epoch: 14, Steps: 2 | Train Loss: 0.753 Vali Loss: 1.507 Vali Acc: 0.463 Test Loss: 1.507 Test Acc: 0.463
Validation loss decreased (-0.455540 --> -0.462948).  Saving model ...
Epoch: 15 cost time: 0.8591327667236328
Epoch: 15, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.488 Vali Acc: 0.474 Test Loss: 1.488 Test Acc: 0.474
Validation loss decreased (-0.462948 --> -0.474059).  Saving model ...
Epoch: 16 cost time: 0.7445836067199707
Epoch: 16, Steps: 2 | Train Loss: 0.658 Vali Loss: 1.470 Vali Acc: 0.507 Test Loss: 1.470 Test Acc: 0.507
Validation loss decreased (-0.474059 --> -0.507393).  Saving model ...
Epoch: 17 cost time: 1.0103962421417236
Epoch: 17, Steps: 2 | Train Loss: 0.620 Vali Loss: 1.451 Vali Acc: 0.515 Test Loss: 1.451 Test Acc: 0.515
Validation loss decreased (-0.507393 --> -0.514800).  Saving model ...
Epoch: 18 cost time: 0.9158978462219238
Epoch: 18, Steps: 2 | Train Loss: 0.575 Vali Loss: 1.435 Vali Acc: 0.519 Test Loss: 1.435 Test Acc: 0.519
Validation loss decreased (-0.514800 --> -0.518504).  Saving model ...
Epoch: 19 cost time: 1.0080196857452393
Epoch: 19, Steps: 2 | Train Loss: 0.522 Vali Loss: 1.420 Vali Acc: 0.537 Test Loss: 1.420 Test Acc: 0.537
Validation loss decreased (-0.518504 --> -0.537023).  Saving model ...
Epoch: 20 cost time: 0.6706809997558594
Epoch: 20, Steps: 2 | Train Loss: 0.491 Vali Loss: 1.407 Vali Acc: 0.548 Test Loss: 1.407 Test Acc: 0.548
Validation loss decreased (-0.537023 --> -0.548134).  Saving model ...
Epoch: 21 cost time: 0.9684927463531494
Epoch: 21, Steps: 2 | Train Loss: 0.454 Vali Loss: 1.398 Vali Acc: 0.548 Test Loss: 1.398 Test Acc: 0.548
Validation loss decreased (-0.548134 --> -0.548134).  Saving model ...
Epoch: 22 cost time: 0.7716517448425293
Epoch: 22, Steps: 2 | Train Loss: 0.407 Vali Loss: 1.389 Vali Acc: 0.563 Test Loss: 1.389 Test Acc: 0.563
Validation loss decreased (-0.548134 --> -0.562949).  Saving model ...
Epoch: 23 cost time: 0.9212324619293213
Epoch: 23, Steps: 2 | Train Loss: 0.394 Vali Loss: 1.377 Vali Acc: 0.563 Test Loss: 1.377 Test Acc: 0.563
Validation loss decreased (-0.562949 --> -0.562949).  Saving model ...
Epoch: 24 cost time: 0.9266757965087891
Epoch: 24, Steps: 2 | Train Loss: 0.357 Vali Loss: 1.365 Vali Acc: 0.585 Test Loss: 1.365 Test Acc: 0.585
Validation loss decreased (-0.562949 --> -0.585172).  Saving model ...
Epoch: 25 cost time: 0.7944762706756592
Epoch: 25, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.354 Vali Acc: 0.596 Test Loss: 1.354 Test Acc: 0.596
Validation loss decreased (-0.585172 --> -0.596283).  Saving model ...
Epoch: 26 cost time: 0.6613879203796387
Epoch: 26, Steps: 2 | Train Loss: 0.317 Vali Loss: 1.345 Vali Acc: 0.585 Test Loss: 1.345 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7702863216400146
Epoch: 27, Steps: 2 | Train Loss: 0.306 Vali Loss: 1.336 Vali Acc: 0.596 Test Loss: 1.336 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 28 cost time: 0.8080620765686035
Epoch: 28, Steps: 2 | Train Loss: 0.269 Vali Loss: 1.331 Vali Acc: 0.604 Test Loss: 1.331 Test Acc: 0.604
Validation loss decreased (-0.596283 --> -0.603690).  Saving model ...
Epoch: 29 cost time: 0.7327196598052979
Epoch: 29, Steps: 2 | Train Loss: 0.254 Vali Loss: 1.327 Vali Acc: 0.604 Test Loss: 1.327 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 30 cost time: 0.8271241188049316
Epoch: 30, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.321 Vali Acc: 0.615 Test Loss: 1.321 Test Acc: 0.615
Validation loss decreased (-0.603690 --> -0.614802).  Saving model ...
Epoch: 31 cost time: 0.9685258865356445
Epoch: 31, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.316 Vali Acc: 0.611 Test Loss: 1.316 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8623631000518799
Epoch: 32, Steps: 2 | Train Loss: 0.208 Vali Loss: 1.308 Vali Acc: 0.600 Test Loss: 1.308 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9274961948394775
Epoch: 33, Steps: 2 | Train Loss: 0.198 Vali Loss: 1.302 Vali Acc: 0.593 Test Loss: 1.302 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1008832454681396
Epoch: 34, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.297 Vali Acc: 0.596 Test Loss: 1.297 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9040071964263916
Epoch: 35, Steps: 2 | Train Loss: 0.173 Vali Loss: 1.293 Vali Acc: 0.600 Test Loss: 1.293 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6878056526184082
Epoch: 36, Steps: 2 | Train Loss: 0.165 Vali Loss: 1.289 Vali Acc: 0.600 Test Loss: 1.289 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6910097599029541
Epoch: 37, Steps: 2 | Train Loss: 0.171 Vali Loss: 1.285 Vali Acc: 0.604 Test Loss: 1.285 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6972765922546387
Epoch: 38, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.279 Vali Acc: 0.596 Test Loss: 1.279 Test Acc: 0.596
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9496970176696777
Epoch: 39, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.272 Vali Acc: 0.607 Test Loss: 1.272 Test Acc: 0.607
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9565470218658447
Epoch: 40, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.267 Vali Acc: 0.607 Test Loss: 1.267 Test Acc: 0.607
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6148148148148148
model parameter : 282296
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7592251300811768
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.770 Vali Acc: 0.263 Test Loss: 1.770 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.8690657615661621
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.763 Vali Acc: 0.274 Test Loss: 1.763 Test Acc: 0.274
Validation loss decreased (-0.262945 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 0.6707906723022461
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.753 Vali Acc: 0.285 Test Loss: 1.753 Test Acc: 0.285
Validation loss decreased (-0.274056 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.8143045902252197
Epoch: 4, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.735 Vali Acc: 0.304 Test Loss: 1.735 Test Acc: 0.304
Validation loss decreased (-0.285168 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.6865639686584473
Epoch: 5, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.713 Vali Acc: 0.315 Test Loss: 1.713 Test Acc: 0.315
Validation loss decreased (-0.303686 --> -0.314798).  Saving model ...
Epoch: 6 cost time: 0.950498104095459
Epoch: 6, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.689 Vali Acc: 0.333 Test Loss: 1.689 Test Acc: 0.333
Validation loss decreased (-0.314798 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.9259021282196045
Epoch: 7, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.663 Vali Acc: 0.352 Test Loss: 1.663 Test Acc: 0.352
Validation loss decreased (-0.333316 --> -0.351835).  Saving model ...
Epoch: 8 cost time: 0.819148063659668
Epoch: 8, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.636 Vali Acc: 0.378 Test Loss: 1.636 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377761).  Saving model ...
Epoch: 9 cost time: 0.8178679943084717
Epoch: 9, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.610 Vali Acc: 0.407 Test Loss: 1.610 Test Acc: 0.407
Validation loss decreased (-0.377761 --> -0.407391).  Saving model ...
Epoch: 10 cost time: 0.8978581428527832
Epoch: 10, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.585 Vali Acc: 0.448 Test Loss: 1.585 Test Acc: 0.448
Validation loss decreased (-0.407391 --> -0.448132).  Saving model ...
Epoch: 11 cost time: 0.9600906372070312
Epoch: 11, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.560 Vali Acc: 0.463 Test Loss: 1.560 Test Acc: 0.463
Validation loss decreased (-0.448132 --> -0.462947).  Saving model ...
Epoch: 12 cost time: 1.01304292678833
Epoch: 12, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.538 Vali Acc: 0.500 Test Loss: 1.538 Test Acc: 0.500
Validation loss decreased (-0.462947 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 0.7634086608886719
Epoch: 13, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.515 Vali Acc: 0.537 Test Loss: 1.515 Test Acc: 0.537
Validation loss decreased (-0.499985 --> -0.537022).  Saving model ...
Epoch: 14 cost time: 0.7536542415618896
Epoch: 14, Steps: 2 | Train Loss: 0.813 Vali Loss: 1.493 Vali Acc: 0.563 Test Loss: 1.493 Test Acc: 0.563
Validation loss decreased (-0.537022 --> -0.562948).  Saving model ...
Epoch: 15 cost time: 0.6721770763397217
Epoch: 15, Steps: 2 | Train Loss: 0.776 Vali Loss: 1.476 Vali Acc: 0.574 Test Loss: 1.476 Test Acc: 0.574
Validation loss decreased (-0.562948 --> -0.574059).  Saving model ...
Epoch: 16 cost time: 0.8682882785797119
Epoch: 16, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.463 Vali Acc: 0.578 Test Loss: 1.463 Test Acc: 0.578
Validation loss decreased (-0.574059 --> -0.577763).  Saving model ...
Epoch: 17 cost time: 1.010242223739624
Epoch: 17, Steps: 2 | Train Loss: 0.646 Vali Loss: 1.450 Vali Acc: 0.585 Test Loss: 1.450 Test Acc: 0.585
Validation loss decreased (-0.577763 --> -0.585171).  Saving model ...
Epoch: 18 cost time: 0.6765415668487549
Epoch: 18, Steps: 2 | Train Loss: 0.595 Vali Loss: 1.436 Vali Acc: 0.585 Test Loss: 1.436 Test Acc: 0.585
Validation loss decreased (-0.585171 --> -0.585171).  Saving model ...
Epoch: 19 cost time: 0.8129448890686035
Epoch: 19, Steps: 2 | Train Loss: 0.528 Vali Loss: 1.422 Vali Acc: 0.581 Test Loss: 1.422 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9117598533630371
Epoch: 20, Steps: 2 | Train Loss: 0.478 Vali Loss: 1.406 Vali Acc: 0.593 Test Loss: 1.406 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592579).  Saving model ...
Epoch: 21 cost time: 0.8302516937255859
Epoch: 21, Steps: 2 | Train Loss: 0.447 Vali Loss: 1.390 Vali Acc: 0.596 Test Loss: 1.390 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596282).  Saving model ...
Epoch: 22 cost time: 0.6543982028961182
Epoch: 22, Steps: 2 | Train Loss: 0.415 Vali Loss: 1.372 Vali Acc: 0.611 Test Loss: 1.372 Test Acc: 0.611
Validation loss decreased (-0.596282 --> -0.611097).  Saving model ...
Epoch: 23 cost time: 0.6703488826751709
Epoch: 23, Steps: 2 | Train Loss: 0.372 Vali Loss: 1.357 Vali Acc: 0.611 Test Loss: 1.357 Test Acc: 0.611
Validation loss decreased (-0.611097 --> -0.611098).  Saving model ...
Epoch: 24 cost time: 1.1035263538360596
Epoch: 24, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.343 Vali Acc: 0.615 Test Loss: 1.343 Test Acc: 0.615
Validation loss decreased (-0.611098 --> -0.614801).  Saving model ...
Epoch: 25 cost time: 0.7797982692718506
Epoch: 25, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.332 Vali Acc: 0.630 Test Loss: 1.332 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
Epoch: 26 cost time: 0.9806184768676758
Epoch: 26, Steps: 2 | Train Loss: 0.307 Vali Loss: 1.323 Vali Acc: 0.648 Test Loss: 1.323 Test Acc: 0.648
Validation loss decreased (-0.629616 --> -0.648135).  Saving model ...
Epoch: 27 cost time: 0.8728575706481934
Epoch: 27, Steps: 2 | Train Loss: 0.297 Vali Loss: 1.314 Vali Acc: 0.633 Test Loss: 1.314 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9625463485717773
Epoch: 28, Steps: 2 | Train Loss: 0.257 Vali Loss: 1.305 Vali Acc: 0.633 Test Loss: 1.305 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7725489139556885
Epoch: 29, Steps: 2 | Train Loss: 0.244 Vali Loss: 1.295 Vali Acc: 0.644 Test Loss: 1.295 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.807037353515625
Epoch: 30, Steps: 2 | Train Loss: 0.219 Vali Loss: 1.287 Vali Acc: 0.648 Test Loss: 1.287 Test Acc: 0.648
Validation loss decreased (-0.648135 --> -0.648135).  Saving model ...
Epoch: 31 cost time: 0.6118342876434326
Epoch: 31, Steps: 2 | Train Loss: 0.214 Vali Loss: 1.279 Vali Acc: 0.644 Test Loss: 1.279 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8299894332885742
Epoch: 32, Steps: 2 | Train Loss: 0.198 Vali Loss: 1.270 Vali Acc: 0.648 Test Loss: 1.270 Test Acc: 0.648
Validation loss decreased (-0.648135 --> -0.648135).  Saving model ...
Epoch: 33 cost time: 1.0606098175048828
Epoch: 33, Steps: 2 | Train Loss: 0.183 Vali Loss: 1.261 Vali Acc: 0.641 Test Loss: 1.261 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3106040954589844
Epoch: 34, Steps: 2 | Train Loss: 0.181 Vali Loss: 1.255 Vali Acc: 0.641 Test Loss: 1.255 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8785736560821533
Epoch: 35, Steps: 2 | Train Loss: 0.165 Vali Loss: 1.250 Vali Acc: 0.644 Test Loss: 1.250 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7861475944519043
Epoch: 36, Steps: 2 | Train Loss: 0.152 Vali Loss: 1.245 Vali Acc: 0.648 Test Loss: 1.245 Test Acc: 0.648
Validation loss decreased (-0.648135 --> -0.648136).  Saving model ...
Epoch: 37 cost time: 0.9647109508514404
Epoch: 37, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.240 Vali Acc: 0.648 Test Loss: 1.240 Test Acc: 0.648
Validation loss decreased (-0.648136 --> -0.648136).  Saving model ...
Epoch: 38 cost time: 0.9335989952087402
Epoch: 38, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.235 Vali Acc: 0.644 Test Loss: 1.235 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0564591884613037
Epoch: 39, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.232 Vali Acc: 0.644 Test Loss: 1.232 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8202693462371826
Epoch: 40, Steps: 2 | Train Loss: 0.121 Vali Loss: 1.230 Vali Acc: 0.641 Test Loss: 1.230 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.83345627784729
Epoch: 41, Steps: 2 | Train Loss: 0.102 Vali Loss: 1.227 Vali Acc: 0.644 Test Loss: 1.227 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7599136829376221
Epoch: 42, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.225 Vali Acc: 0.641 Test Loss: 1.225 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7641327381134033
Epoch: 43, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.222 Vali Acc: 0.644 Test Loss: 1.222 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0329864025115967
Epoch: 44, Steps: 2 | Train Loss: 0.097 Vali Loss: 1.219 Vali Acc: 0.637 Test Loss: 1.219 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8914639949798584
Epoch: 45, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.216 Vali Acc: 0.644 Test Loss: 1.216 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7290995121002197
Epoch: 46, Steps: 2 | Train Loss: 0.087 Vali Loss: 1.217 Vali Acc: 0.641 Test Loss: 1.217 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9392156600952148
Epoch: 47, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.219 Vali Acc: 0.641 Test Loss: 1.219 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6481481481481481
model parameter : 278200
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3866918087005615
Epoch: 1, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.891 Vali Acc: 0.144 Test Loss: 1.891 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.7672085762023926
Epoch: 2, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.881 Vali Acc: 0.148 Test Loss: 1.881 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148129).  Saving model ...
Epoch: 3 cost time: 0.6649467945098877
Epoch: 3, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.867 Vali Acc: 0.159 Test Loss: 1.867 Test Acc: 0.159
Validation loss decreased (-0.148129 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.7240018844604492
Epoch: 4, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.841 Vali Acc: 0.170 Test Loss: 1.841 Test Acc: 0.170
Validation loss decreased (-0.159241 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 0.7784078121185303
Epoch: 5, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.811 Vali Acc: 0.178 Test Loss: 1.811 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 0.6596708297729492
Epoch: 6, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.778 Vali Acc: 0.196 Test Loss: 1.778 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 7 cost time: 0.628833532333374
Epoch: 7, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.740 Vali Acc: 0.259 Test Loss: 1.740 Test Acc: 0.259
Validation loss decreased (-0.196279 --> -0.259242).  Saving model ...
Epoch: 8 cost time: 0.8197665214538574
Epoch: 8, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.700 Vali Acc: 0.311 Test Loss: 1.700 Test Acc: 0.311
Validation loss decreased (-0.259242 --> -0.311094).  Saving model ...
Epoch: 9 cost time: 0.6675782203674316
Epoch: 9, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.662 Vali Acc: 0.370 Test Loss: 1.662 Test Acc: 0.370
Validation loss decreased (-0.311094 --> -0.370354).  Saving model ...
Epoch: 10 cost time: 0.7736485004425049
Epoch: 10, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.627 Vali Acc: 0.415 Test Loss: 1.627 Test Acc: 0.415
Validation loss decreased (-0.370354 --> -0.414799).  Saving model ...
Epoch: 11 cost time: 0.6983401775360107
Epoch: 11, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.599 Vali Acc: 0.470 Test Loss: 1.599 Test Acc: 0.470
Validation loss decreased (-0.414799 --> -0.470354).  Saving model ...
Epoch: 12 cost time: 0.7387666702270508
Epoch: 12, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.575 Vali Acc: 0.511 Test Loss: 1.575 Test Acc: 0.511
Validation loss decreased (-0.470354 --> -0.511095).  Saving model ...
Epoch: 13 cost time: 0.7341334819793701
Epoch: 13, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.553 Vali Acc: 0.533 Test Loss: 1.553 Test Acc: 0.533
Validation loss decreased (-0.511095 --> -0.533318).  Saving model ...
Epoch: 14 cost time: 0.8245389461517334
Epoch: 14, Steps: 2 | Train Loss: 0.753 Vali Loss: 1.534 Vali Acc: 0.541 Test Loss: 1.534 Test Acc: 0.541
Validation loss decreased (-0.533318 --> -0.540725).  Saving model ...
Epoch: 15 cost time: 0.8884172439575195
Epoch: 15, Steps: 2 | Train Loss: 0.686 Vali Loss: 1.515 Vali Acc: 0.556 Test Loss: 1.515 Test Acc: 0.556
Validation loss decreased (-0.540725 --> -0.555540).  Saving model ...
Epoch: 16 cost time: 0.6864218711853027
Epoch: 16, Steps: 2 | Train Loss: 0.660 Vali Loss: 1.498 Vali Acc: 0.585 Test Loss: 1.498 Test Acc: 0.585
Validation loss decreased (-0.555540 --> -0.585170).  Saving model ...
Epoch: 17 cost time: 0.8210375308990479
Epoch: 17, Steps: 2 | Train Loss: 0.604 Vali Loss: 1.477 Vali Acc: 0.578 Test Loss: 1.477 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8532547950744629
Epoch: 18, Steps: 2 | Train Loss: 0.555 Vali Loss: 1.452 Vali Acc: 0.596 Test Loss: 1.452 Test Acc: 0.596
Validation loss decreased (-0.585170 --> -0.596282).  Saving model ...
Epoch: 19 cost time: 0.9729318618774414
Epoch: 19, Steps: 2 | Train Loss: 0.519 Vali Loss: 1.428 Vali Acc: 0.600 Test Loss: 1.428 Test Acc: 0.600
Validation loss decreased (-0.596282 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.7485265731811523
Epoch: 20, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.411 Vali Acc: 0.600 Test Loss: 1.411 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 0.7661323547363281
Epoch: 21, Steps: 2 | Train Loss: 0.436 Vali Loss: 1.398 Vali Acc: 0.600 Test Loss: 1.398 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 0.9008276462554932
Epoch: 22, Steps: 2 | Train Loss: 0.392 Vali Loss: 1.388 Vali Acc: 0.607 Test Loss: 1.388 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.607394).  Saving model ...
Epoch: 23 cost time: 0.7711277008056641
Epoch: 23, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.376 Vali Acc: 0.615 Test Loss: 1.376 Test Acc: 0.615
Validation loss decreased (-0.607394 --> -0.614801).  Saving model ...
Epoch: 24 cost time: 0.7410593032836914
Epoch: 24, Steps: 2 | Train Loss: 0.341 Vali Loss: 1.364 Vali Acc: 0.619 Test Loss: 1.364 Test Acc: 0.619
Validation loss decreased (-0.614801 --> -0.618505).  Saving model ...
Epoch: 25 cost time: 0.7055995464324951
Epoch: 25, Steps: 2 | Train Loss: 0.328 Vali Loss: 1.352 Vali Acc: 0.622 Test Loss: 1.352 Test Acc: 0.622
Validation loss decreased (-0.618505 --> -0.622209).  Saving model ...
Epoch: 26 cost time: 0.7715427875518799
Epoch: 26, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.343 Vali Acc: 0.637 Test Loss: 1.343 Test Acc: 0.637
Validation loss decreased (-0.622209 --> -0.637024).  Saving model ...
Epoch: 27 cost time: 0.9480628967285156
Epoch: 27, Steps: 2 | Train Loss: 0.268 Vali Loss: 1.336 Vali Acc: 0.626 Test Loss: 1.336 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8693811893463135
Epoch: 28, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.329 Vali Acc: 0.630 Test Loss: 1.329 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7116599082946777
Epoch: 29, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.322 Vali Acc: 0.633 Test Loss: 1.322 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9337408542633057
Epoch: 30, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.316 Vali Acc: 0.630 Test Loss: 1.316 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8391387462615967
Epoch: 31, Steps: 2 | Train Loss: 0.201 Vali Loss: 1.310 Vali Acc: 0.641 Test Loss: 1.310 Test Acc: 0.641
Validation loss decreased (-0.637024 --> -0.640728).  Saving model ...
Epoch: 32 cost time: 0.6035544872283936
Epoch: 32, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.304 Vali Acc: 0.648 Test Loss: 1.304 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648135).  Saving model ...
Epoch: 33 cost time: 0.8235743045806885
Epoch: 33, Steps: 2 | Train Loss: 0.178 Vali Loss: 1.298 Vali Acc: 0.641 Test Loss: 1.298 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8907496929168701
Epoch: 34, Steps: 2 | Train Loss: 0.163 Vali Loss: 1.292 Vali Acc: 0.626 Test Loss: 1.292 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7378664016723633
Epoch: 35, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.286 Vali Acc: 0.637 Test Loss: 1.286 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8979687690734863
Epoch: 36, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.281 Vali Acc: 0.637 Test Loss: 1.281 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8357391357421875
Epoch: 37, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.276 Vali Acc: 0.637 Test Loss: 1.276 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9180951118469238
Epoch: 38, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.270 Vali Acc: 0.630 Test Loss: 1.270 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7151269912719727
Epoch: 39, Steps: 2 | Train Loss: 0.117 Vali Loss: 1.264 Vali Acc: 0.622 Test Loss: 1.264 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7264776229858398
Epoch: 40, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.260 Vali Acc: 0.626 Test Loss: 1.260 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7424776554107666
Epoch: 41, Steps: 2 | Train Loss: 0.109 Vali Loss: 1.257 Vali Acc: 0.630 Test Loss: 1.257 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7263176441192627
Epoch: 42, Steps: 2 | Train Loss: 0.105 Vali Loss: 1.252 Vali Acc: 0.630 Test Loss: 1.252 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6481481481481481
model parameter : 276152
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3776113986968994
Epoch: 1, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.812 Vali Acc: 0.196 Test Loss: 1.812 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.7191548347473145
Epoch: 2, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.805 Vali Acc: 0.200 Test Loss: 1.805 Test Acc: 0.200
Validation loss decreased (-0.196278 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6623132228851318
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.791 Vali Acc: 0.211 Test Loss: 1.791 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211093).  Saving model ...
Epoch: 4 cost time: 0.6584458351135254
Epoch: 4, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.767 Vali Acc: 0.237 Test Loss: 1.767 Test Acc: 0.237
Validation loss decreased (-0.211093 --> -0.237019).  Saving model ...
Epoch: 5 cost time: 0.5434927940368652
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.739 Vali Acc: 0.263 Test Loss: 1.739 Test Acc: 0.263
Validation loss decreased (-0.237019 --> -0.262946).  Saving model ...
Epoch: 6 cost time: 0.4835336208343506
Epoch: 6, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.708 Vali Acc: 0.289 Test Loss: 1.708 Test Acc: 0.289
Validation loss decreased (-0.262946 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.5766549110412598
Epoch: 7, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.676 Vali Acc: 0.344 Test Loss: 1.676 Test Acc: 0.344
Validation loss decreased (-0.288872 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.8078806400299072
Epoch: 8, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.644 Vali Acc: 0.367 Test Loss: 1.644 Test Acc: 0.367
Validation loss decreased (-0.344428 --> -0.366650).  Saving model ...
Epoch: 9 cost time: 0.7474589347839355
Epoch: 9, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.613 Vali Acc: 0.415 Test Loss: 1.613 Test Acc: 0.415
Validation loss decreased (-0.366650 --> -0.414799).  Saving model ...
Epoch: 10 cost time: 0.8413023948669434
Epoch: 10, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.581 Vali Acc: 0.459 Test Loss: 1.581 Test Acc: 0.459
Validation loss decreased (-0.414799 --> -0.459243).  Saving model ...
Epoch: 11 cost time: 0.6688399314880371
Epoch: 11, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.548 Vali Acc: 0.496 Test Loss: 1.548 Test Acc: 0.496
Validation loss decreased (-0.459243 --> -0.496281).  Saving model ...
Epoch: 12 cost time: 0.7291653156280518
Epoch: 12, Steps: 2 | Train Loss: 0.834 Vali Loss: 1.515 Vali Acc: 0.533 Test Loss: 1.515 Test Acc: 0.533
Validation loss decreased (-0.496281 --> -0.533318).  Saving model ...
Epoch: 13 cost time: 0.6468968391418457
Epoch: 13, Steps: 2 | Train Loss: 0.790 Vali Loss: 1.487 Vali Acc: 0.563 Test Loss: 1.487 Test Acc: 0.563
Validation loss decreased (-0.533318 --> -0.562948).  Saving model ...
Epoch: 14 cost time: 0.6352348327636719
Epoch: 14, Steps: 2 | Train Loss: 0.704 Vali Loss: 1.465 Vali Acc: 0.589 Test Loss: 1.465 Test Acc: 0.589
Validation loss decreased (-0.562948 --> -0.588874).  Saving model ...
Epoch: 15 cost time: 0.8433833122253418
Epoch: 15, Steps: 2 | Train Loss: 0.624 Vali Loss: 1.446 Vali Acc: 0.585 Test Loss: 1.446 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.781193733215332
Epoch: 16, Steps: 2 | Train Loss: 0.535 Vali Loss: 1.430 Vali Acc: 0.585 Test Loss: 1.430 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7014679908752441
Epoch: 17, Steps: 2 | Train Loss: 0.501 Vali Loss: 1.415 Vali Acc: 0.589 Test Loss: 1.415 Test Acc: 0.589
Validation loss decreased (-0.588874 --> -0.588875).  Saving model ...
Epoch: 18 cost time: 0.7904970645904541
Epoch: 18, Steps: 2 | Train Loss: 0.451 Vali Loss: 1.401 Vali Acc: 0.589 Test Loss: 1.401 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588875).  Saving model ...
Epoch: 19 cost time: 0.6242363452911377
Epoch: 19, Steps: 2 | Train Loss: 0.438 Vali Loss: 1.389 Vali Acc: 0.559 Test Loss: 1.389 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7420752048492432
Epoch: 20, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.378 Vali Acc: 0.563 Test Loss: 1.378 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7918083667755127
Epoch: 21, Steps: 2 | Train Loss: 0.362 Vali Loss: 1.370 Vali Acc: 0.563 Test Loss: 1.370 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7262988090515137
Epoch: 22, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.364 Vali Acc: 0.563 Test Loss: 1.364 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.998279333114624
Epoch: 23, Steps: 2 | Train Loss: 0.319 Vali Loss: 1.356 Vali Acc: 0.563 Test Loss: 1.356 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0381801128387451
Epoch: 24, Steps: 2 | Train Loss: 0.290 Vali Loss: 1.346 Vali Acc: 0.567 Test Loss: 1.346 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8505959510803223
Epoch: 25, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.337 Vali Acc: 0.578 Test Loss: 1.337 Test Acc: 0.578
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9234557151794434
Epoch: 26, Steps: 2 | Train Loss: 0.245 Vali Loss: 1.328 Vali Acc: 0.574 Test Loss: 1.328 Test Acc: 0.574
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7041893005371094
Epoch: 27, Steps: 2 | Train Loss: 0.238 Vali Loss: 1.320 Vali Acc: 0.589 Test Loss: 1.320 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588876).  Saving model ...
Epoch: 28 cost time: 0.5615105628967285
Epoch: 28, Steps: 2 | Train Loss: 0.213 Vali Loss: 1.311 Vali Acc: 0.589 Test Loss: 1.311 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588876).  Saving model ...
Epoch: 29 cost time: 0.6608710289001465
Epoch: 29, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.304 Vali Acc: 0.596 Test Loss: 1.304 Test Acc: 0.596
Validation loss decreased (-0.588876 --> -0.596283).  Saving model ...
Epoch: 30 cost time: 0.9390585422515869
Epoch: 30, Steps: 2 | Train Loss: 0.192 Vali Loss: 1.297 Vali Acc: 0.593 Test Loss: 1.297 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8644733428955078
Epoch: 31, Steps: 2 | Train Loss: 0.169 Vali Loss: 1.290 Vali Acc: 0.593 Test Loss: 1.290 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0841286182403564
Epoch: 32, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.285 Vali Acc: 0.593 Test Loss: 1.285 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8740828037261963
Epoch: 33, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.279 Vali Acc: 0.593 Test Loss: 1.279 Test Acc: 0.593
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8429896831512451
Epoch: 34, Steps: 2 | Train Loss: 0.149 Vali Loss: 1.275 Vali Acc: 0.596 Test Loss: 1.275 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596284).  Saving model ...
Epoch: 35 cost time: 0.7746953964233398
Epoch: 35, Steps: 2 | Train Loss: 0.138 Vali Loss: 1.269 Vali Acc: 0.604 Test Loss: 1.269 Test Acc: 0.604
Validation loss decreased (-0.596284 --> -0.603691).  Saving model ...
Epoch: 36 cost time: 0.6542577743530273
Epoch: 36, Steps: 2 | Train Loss: 0.132 Vali Loss: 1.264 Vali Acc: 0.600 Test Loss: 1.264 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6937944889068604
Epoch: 37, Steps: 2 | Train Loss: 0.125 Vali Loss: 1.257 Vali Acc: 0.604 Test Loss: 1.257 Test Acc: 0.604
Validation loss decreased (-0.603691 --> -0.603691).  Saving model ...
Epoch: 38 cost time: 0.864739179611206
Epoch: 38, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.252 Vali Acc: 0.604 Test Loss: 1.252 Test Acc: 0.604
Validation loss decreased (-0.603691 --> -0.603691).  Saving model ...
Epoch: 39 cost time: 0.9220068454742432
Epoch: 39, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.248 Vali Acc: 0.604 Test Loss: 1.248 Test Acc: 0.604
Validation loss decreased (-0.603691 --> -0.603691).  Saving model ...
Epoch: 40 cost time: 0.8532025814056396
Epoch: 40, Steps: 2 | Train Loss: 0.105 Vali Loss: 1.243 Vali Acc: 0.604 Test Loss: 1.243 Test Acc: 0.604
Validation loss decreased (-0.603691 --> -0.603691).  Saving model ...
Epoch: 41 cost time: 0.6738944053649902
Epoch: 41, Steps: 2 | Train Loss: 0.097 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6395895481109619
Epoch: 42, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.234 Vali Acc: 0.596 Test Loss: 1.234 Test Acc: 0.596
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7773189544677734
Epoch: 43, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6467158794403076
Epoch: 44, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.227 Vali Acc: 0.607 Test Loss: 1.227 Test Acc: 0.607
Validation loss decreased (-0.603691 --> -0.607395).  Saving model ...
Epoch: 45 cost time: 0.6229562759399414
Epoch: 45, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.225 Vali Acc: 0.604 Test Loss: 1.225 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7436003684997559
Epoch: 46, Steps: 2 | Train Loss: 0.078 Vali Loss: 1.222 Vali Acc: 0.607 Test Loss: 1.222 Test Acc: 0.607
Validation loss decreased (-0.607395 --> -0.607395).  Saving model ...
Epoch: 47 cost time: 0.8479225635528564
Epoch: 47, Steps: 2 | Train Loss: 0.080 Vali Loss: 1.220 Vali Acc: 0.611 Test Loss: 1.220 Test Acc: 0.611
Validation loss decreased (-0.607395 --> -0.611099).  Saving model ...
Epoch: 48 cost time: 0.9974777698516846
Epoch: 48, Steps: 2 | Train Loss: 0.071 Vali Loss: 1.217 Vali Acc: 0.611 Test Loss: 1.217 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 49 cost time: 0.6226725578308105
Epoch: 49, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.213 Vali Acc: 0.615 Test Loss: 1.213 Test Acc: 0.615
Validation loss decreased (-0.611099 --> -0.614803).  Saving model ...
Epoch: 50 cost time: 0.5977165699005127
Epoch: 50, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.210 Vali Acc: 0.630 Test Loss: 1.210 Test Acc: 0.630
Validation loss decreased (-0.614803 --> -0.629618).  Saving model ...
Epoch: 51 cost time: 0.8120541572570801
Epoch: 51, Steps: 2 | Train Loss: 0.065 Vali Loss: 1.207 Vali Acc: 0.626 Test Loss: 1.207 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.761160135269165
Epoch: 52, Steps: 2 | Train Loss: 0.061 Vali Loss: 1.205 Vali Acc: 0.630 Test Loss: 1.205 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 53 cost time: 0.7982280254364014
Epoch: 53, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.202 Vali Acc: 0.626 Test Loss: 1.202 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6166789531707764
Epoch: 54, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.200 Vali Acc: 0.630 Test Loss: 1.200 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 55 cost time: 0.808295726776123
Epoch: 55, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.198 Vali Acc: 0.637 Test Loss: 1.198 Test Acc: 0.637
Validation loss decreased (-0.629618 --> -0.637025).  Saving model ...
Epoch: 56 cost time: 0.7072196006774902
Epoch: 56, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.195 Vali Acc: 0.622 Test Loss: 1.195 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6456501483917236
Epoch: 57, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.192 Vali Acc: 0.619 Test Loss: 1.192 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5929427146911621
Epoch: 58, Steps: 2 | Train Loss: 0.052 Vali Loss: 1.189 Vali Acc: 0.619 Test Loss: 1.189 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6711134910583496
Epoch: 59, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.187 Vali Acc: 0.619 Test Loss: 1.187 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7177319526672363
Epoch: 60, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.185 Vali Acc: 0.619 Test Loss: 1.185 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8190555572509766
Epoch: 61, Steps: 2 | Train Loss: 0.046 Vali Loss: 1.184 Vali Acc: 0.619 Test Loss: 1.184 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.826256275177002
Epoch: 62, Steps: 2 | Train Loss: 0.042 Vali Loss: 1.184 Vali Acc: 0.619 Test Loss: 1.184 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6909034252166748
Epoch: 63, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.183 Vali Acc: 0.622 Test Loss: 1.183 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.6409876346588135
Epoch: 64, Steps: 2 | Train Loss: 0.036 Vali Loss: 1.181 Vali Acc: 0.622 Test Loss: 1.181 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.8101944923400879
Epoch: 65, Steps: 2 | Train Loss: 0.036 Vali Loss: 1.179 Vali Acc: 0.622 Test Loss: 1.179 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6370370370370371
model parameter : 272056
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.134077787399292
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.824 Vali Acc: 0.152 Test Loss: 1.824 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 0.9452261924743652
Epoch: 2, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.813 Vali Acc: 0.148 Test Loss: 1.813 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8813700675964355
Epoch: 3, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.795 Vali Acc: 0.181 Test Loss: 1.795 Test Acc: 0.181
Validation loss decreased (-0.151834 --> -0.181464).  Saving model ...
Epoch: 4 cost time: 0.939720869064331
Epoch: 4, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.765 Vali Acc: 0.196 Test Loss: 1.765 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 5 cost time: 1.197908878326416
Epoch: 5, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.729 Vali Acc: 0.230 Test Loss: 1.729 Test Acc: 0.230
Validation loss decreased (-0.196279 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 0.9334371089935303
Epoch: 6, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.690 Vali Acc: 0.304 Test Loss: 1.690 Test Acc: 0.304
Validation loss decreased (-0.229612 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 0.7451834678649902
Epoch: 7, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.650 Vali Acc: 0.363 Test Loss: 1.650 Test Acc: 0.363
Validation loss decreased (-0.303687 --> -0.362946).  Saving model ...
Epoch: 8 cost time: 0.745574951171875
Epoch: 8, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.608 Vali Acc: 0.400 Test Loss: 1.608 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399984).  Saving model ...
Epoch: 9 cost time: 0.8967642784118652
Epoch: 9, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.569 Vali Acc: 0.430 Test Loss: 1.569 Test Acc: 0.430
Validation loss decreased (-0.399984 --> -0.429614).  Saving model ...
Epoch: 10 cost time: 0.6898140907287598
Epoch: 10, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.533 Vali Acc: 0.485 Test Loss: 1.533 Test Acc: 0.485
Validation loss decreased (-0.429614 --> -0.485170).  Saving model ...
Epoch: 11 cost time: 1.221996784210205
Epoch: 11, Steps: 2 | Train Loss: 0.883 Vali Loss: 1.499 Vali Acc: 0.522 Test Loss: 1.499 Test Acc: 0.522
Validation loss decreased (-0.485170 --> -0.522207).  Saving model ...
Epoch: 12 cost time: 0.7994492053985596
Epoch: 12, Steps: 2 | Train Loss: 0.799 Vali Loss: 1.468 Vali Acc: 0.533 Test Loss: 1.468 Test Acc: 0.533
Validation loss decreased (-0.522207 --> -0.533319).  Saving model ...
Epoch: 13 cost time: 0.9010732173919678
Epoch: 13, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.437 Vali Acc: 0.559 Test Loss: 1.437 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559245).  Saving model ...
Epoch: 14 cost time: 0.958183765411377
Epoch: 14, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.409 Vali Acc: 0.581 Test Loss: 1.409 Test Acc: 0.581
Validation loss decreased (-0.559245 --> -0.581467).  Saving model ...
Epoch: 15 cost time: 0.7070262432098389
Epoch: 15, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.385 Vali Acc: 0.604 Test Loss: 1.385 Test Acc: 0.604
Validation loss decreased (-0.581467 --> -0.603690).  Saving model ...
Epoch: 16 cost time: 1.1432163715362549
Epoch: 16, Steps: 2 | Train Loss: 0.503 Vali Loss: 1.364 Vali Acc: 0.604 Test Loss: 1.364 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 17 cost time: 0.6880276203155518
Epoch: 17, Steps: 2 | Train Loss: 0.483 Vali Loss: 1.347 Vali Acc: 0.611 Test Loss: 1.347 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611098).  Saving model ...
Epoch: 18 cost time: 0.7578232288360596
Epoch: 18, Steps: 2 | Train Loss: 0.446 Vali Loss: 1.329 Vali Acc: 0.611 Test Loss: 1.329 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 19 cost time: 0.721731424331665
Epoch: 19, Steps: 2 | Train Loss: 0.378 Vali Loss: 1.311 Vali Acc: 0.619 Test Loss: 1.311 Test Acc: 0.619
Validation loss decreased (-0.611098 --> -0.618505).  Saving model ...
Epoch: 20 cost time: 0.9458625316619873
Epoch: 20, Steps: 2 | Train Loss: 0.361 Vali Loss: 1.294 Vali Acc: 0.619 Test Loss: 1.294 Test Acc: 0.619
Validation loss decreased (-0.618505 --> -0.618506).  Saving model ...
Epoch: 21 cost time: 0.7596890926361084
Epoch: 21, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.278 Vali Acc: 0.626 Test Loss: 1.278 Test Acc: 0.626
Validation loss decreased (-0.618506 --> -0.625913).  Saving model ...
Epoch: 22 cost time: 0.8498311042785645
Epoch: 22, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.263 Vali Acc: 0.622 Test Loss: 1.263 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6841726303100586
Epoch: 23, Steps: 2 | Train Loss: 0.277 Vali Loss: 1.252 Vali Acc: 0.626 Test Loss: 1.252 Test Acc: 0.626
Validation loss decreased (-0.625913 --> -0.625913).  Saving model ...
Epoch: 24 cost time: 0.7546713352203369
Epoch: 24, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.240 Vali Acc: 0.619 Test Loss: 1.240 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8250861167907715
Epoch: 25, Steps: 2 | Train Loss: 0.232 Vali Loss: 1.228 Vali Acc: 0.626 Test Loss: 1.228 Test Acc: 0.626
Validation loss decreased (-0.625913 --> -0.625914).  Saving model ...
Epoch: 26 cost time: 0.7563059329986572
Epoch: 26, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.215 Vali Acc: 0.630 Test Loss: 1.215 Test Acc: 0.630
Validation loss decreased (-0.625914 --> -0.629617).  Saving model ...
Epoch: 27 cost time: 0.8060784339904785
Epoch: 27, Steps: 2 | Train Loss: 0.199 Vali Loss: 1.203 Vali Acc: 0.622 Test Loss: 1.203 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7913305759429932
Epoch: 28, Steps: 2 | Train Loss: 0.183 Vali Loss: 1.192 Vali Acc: 0.619 Test Loss: 1.192 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.789325475692749
Epoch: 29, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.180 Vali Acc: 0.626 Test Loss: 1.180 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6579575538635254
Epoch: 30, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.170 Vali Acc: 0.633 Test Loss: 1.170 Test Acc: 0.633
Validation loss decreased (-0.629617 --> -0.633322).  Saving model ...
Epoch: 31 cost time: 0.7673070430755615
Epoch: 31, Steps: 2 | Train Loss: 0.149 Vali Loss: 1.163 Vali Acc: 0.633 Test Loss: 1.163 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 32 cost time: 0.9774820804595947
Epoch: 32, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.157 Vali Acc: 0.637 Test Loss: 1.157 Test Acc: 0.637
Validation loss decreased (-0.633322 --> -0.637025).  Saving model ...
Epoch: 33 cost time: 1.0105631351470947
Epoch: 33, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.152 Vali Acc: 0.637 Test Loss: 1.152 Test Acc: 0.637
Validation loss decreased (-0.637025 --> -0.637026).  Saving model ...
Epoch: 34 cost time: 0.9940733909606934
Epoch: 34, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.148 Vali Acc: 0.641 Test Loss: 1.148 Test Acc: 0.641
Validation loss decreased (-0.637026 --> -0.640729).  Saving model ...
Epoch: 35 cost time: 0.9052133560180664
Epoch: 35, Steps: 2 | Train Loss: 0.107 Vali Loss: 1.144 Vali Acc: 0.641 Test Loss: 1.144 Test Acc: 0.641
Validation loss decreased (-0.640729 --> -0.640729).  Saving model ...
Epoch: 36 cost time: 0.873539924621582
Epoch: 36, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.140 Vali Acc: 0.641 Test Loss: 1.140 Test Acc: 0.641
Validation loss decreased (-0.640729 --> -0.640729).  Saving model ...
Epoch: 37 cost time: 1.0882360935211182
Epoch: 37, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.137 Vali Acc: 0.641 Test Loss: 1.137 Test Acc: 0.641
Validation loss decreased (-0.640729 --> -0.640729).  Saving model ...
Epoch: 38 cost time: 0.940760612487793
Epoch: 38, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.134 Vali Acc: 0.644 Test Loss: 1.134 Test Acc: 0.644
Validation loss decreased (-0.640729 --> -0.644433).  Saving model ...
Epoch: 39 cost time: 1.0087649822235107
Epoch: 39, Steps: 2 | Train Loss: 0.089 Vali Loss: 1.131 Vali Acc: 0.637 Test Loss: 1.131 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1043946743011475
Epoch: 40, Steps: 2 | Train Loss: 0.079 Vali Loss: 1.128 Vali Acc: 0.644 Test Loss: 1.128 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 41 cost time: 1.0652902126312256
Epoch: 41, Steps: 2 | Train Loss: 0.078 Vali Loss: 1.125 Vali Acc: 0.641 Test Loss: 1.125 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7922699451446533
Epoch: 42, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.122 Vali Acc: 0.641 Test Loss: 1.122 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8060319423675537
Epoch: 43, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.120 Vali Acc: 0.641 Test Loss: 1.120 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8819625377655029
Epoch: 44, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.118 Vali Acc: 0.641 Test Loss: 1.118 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9792215824127197
Epoch: 45, Steps: 2 | Train Loss: 0.065 Vali Loss: 1.116 Vali Acc: 0.637 Test Loss: 1.116 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1196088790893555
Epoch: 46, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.114 Vali Acc: 0.630 Test Loss: 1.114 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9853503704071045
Epoch: 47, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.112 Vali Acc: 0.637 Test Loss: 1.112 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7748920917510986
Epoch: 48, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.110 Vali Acc: 0.641 Test Loss: 1.110 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9806394577026367
Epoch: 49, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.109 Vali Acc: 0.641 Test Loss: 1.109 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9379665851593018
Epoch: 50, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.108 Vali Acc: 0.637 Test Loss: 1.108 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6444444444444445
model parameter : 270008
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3785817623138428
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.824 Vali Acc: 0.152 Test Loss: 1.824 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 0.8129093647003174
Epoch: 2, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.813 Vali Acc: 0.148 Test Loss: 1.813 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7177212238311768
Epoch: 3, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.795 Vali Acc: 0.181 Test Loss: 1.795 Test Acc: 0.181
Validation loss decreased (-0.151834 --> -0.181464).  Saving model ...
Epoch: 4 cost time: 0.6158852577209473
Epoch: 4, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.765 Vali Acc: 0.196 Test Loss: 1.765 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 5 cost time: 0.6730377674102783
Epoch: 5, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.729 Vali Acc: 0.230 Test Loss: 1.729 Test Acc: 0.230
Validation loss decreased (-0.196279 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 0.9256224632263184
Epoch: 6, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.690 Vali Acc: 0.304 Test Loss: 1.690 Test Acc: 0.304
Validation loss decreased (-0.229612 --> -0.303687).  Saving model ...
Epoch: 7 cost time: 0.7295541763305664
Epoch: 7, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.650 Vali Acc: 0.363 Test Loss: 1.650 Test Acc: 0.363
Validation loss decreased (-0.303687 --> -0.362946).  Saving model ...
Epoch: 8 cost time: 0.6665778160095215
Epoch: 8, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.608 Vali Acc: 0.400 Test Loss: 1.608 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399984).  Saving model ...
Epoch: 9 cost time: 0.6994669437408447
Epoch: 9, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.569 Vali Acc: 0.430 Test Loss: 1.569 Test Acc: 0.430
Validation loss decreased (-0.399984 --> -0.429614).  Saving model ...
Epoch: 10 cost time: 0.6930224895477295
Epoch: 10, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.533 Vali Acc: 0.485 Test Loss: 1.533 Test Acc: 0.485
Validation loss decreased (-0.429614 --> -0.485170).  Saving model ...
Epoch: 11 cost time: 0.691481351852417
Epoch: 11, Steps: 2 | Train Loss: 0.883 Vali Loss: 1.499 Vali Acc: 0.522 Test Loss: 1.499 Test Acc: 0.522
Validation loss decreased (-0.485170 --> -0.522207).  Saving model ...
Epoch: 12 cost time: 0.6695823669433594
Epoch: 12, Steps: 2 | Train Loss: 0.799 Vali Loss: 1.468 Vali Acc: 0.533 Test Loss: 1.468 Test Acc: 0.533
Validation loss decreased (-0.522207 --> -0.533319).  Saving model ...
Epoch: 13 cost time: 0.5535860061645508
Epoch: 13, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.437 Vali Acc: 0.559 Test Loss: 1.437 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559245).  Saving model ...
Epoch: 14 cost time: 0.6809573173522949
Epoch: 14, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.409 Vali Acc: 0.581 Test Loss: 1.409 Test Acc: 0.581
Validation loss decreased (-0.559245 --> -0.581467).  Saving model ...
Epoch: 15 cost time: 0.7300302982330322
Epoch: 15, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.385 Vali Acc: 0.604 Test Loss: 1.385 Test Acc: 0.604
Validation loss decreased (-0.581467 --> -0.603690).  Saving model ...
Epoch: 16 cost time: 0.7343859672546387
Epoch: 16, Steps: 2 | Train Loss: 0.503 Vali Loss: 1.364 Vali Acc: 0.604 Test Loss: 1.364 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 17 cost time: 0.7928769588470459
Epoch: 17, Steps: 2 | Train Loss: 0.483 Vali Loss: 1.347 Vali Acc: 0.611 Test Loss: 1.347 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611098).  Saving model ...
Epoch: 18 cost time: 0.7633776664733887
Epoch: 18, Steps: 2 | Train Loss: 0.446 Vali Loss: 1.329 Vali Acc: 0.611 Test Loss: 1.329 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 19 cost time: 0.7926521301269531
Epoch: 19, Steps: 2 | Train Loss: 0.378 Vali Loss: 1.311 Vali Acc: 0.619 Test Loss: 1.311 Test Acc: 0.619
Validation loss decreased (-0.611098 --> -0.618505).  Saving model ...
Epoch: 20 cost time: 0.6659398078918457
Epoch: 20, Steps: 2 | Train Loss: 0.361 Vali Loss: 1.294 Vali Acc: 0.619 Test Loss: 1.294 Test Acc: 0.619
Validation loss decreased (-0.618505 --> -0.618506).  Saving model ...
Epoch: 21 cost time: 0.5810725688934326
Epoch: 21, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.278 Vali Acc: 0.626 Test Loss: 1.278 Test Acc: 0.626
Validation loss decreased (-0.618506 --> -0.625913).  Saving model ...
Epoch: 22 cost time: 0.5707852840423584
Epoch: 22, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.263 Vali Acc: 0.622 Test Loss: 1.263 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7999246120452881
Epoch: 23, Steps: 2 | Train Loss: 0.277 Vali Loss: 1.252 Vali Acc: 0.626 Test Loss: 1.252 Test Acc: 0.626
Validation loss decreased (-0.625913 --> -0.625913).  Saving model ...
Epoch: 24 cost time: 0.7336671352386475
Epoch: 24, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.240 Vali Acc: 0.619 Test Loss: 1.240 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9576373100280762
Epoch: 25, Steps: 2 | Train Loss: 0.232 Vali Loss: 1.228 Vali Acc: 0.626 Test Loss: 1.228 Test Acc: 0.626
Validation loss decreased (-0.625913 --> -0.625914).  Saving model ...
Epoch: 26 cost time: 0.5978379249572754
Epoch: 26, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.215 Vali Acc: 0.630 Test Loss: 1.215 Test Acc: 0.630
Validation loss decreased (-0.625914 --> -0.629617).  Saving model ...
Epoch: 27 cost time: 0.7816517353057861
Epoch: 27, Steps: 2 | Train Loss: 0.199 Vali Loss: 1.203 Vali Acc: 0.622 Test Loss: 1.203 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8956890106201172
Epoch: 28, Steps: 2 | Train Loss: 0.183 Vali Loss: 1.192 Vali Acc: 0.619 Test Loss: 1.192 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9264388084411621
Epoch: 29, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.180 Vali Acc: 0.626 Test Loss: 1.180 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7142758369445801
Epoch: 30, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.170 Vali Acc: 0.633 Test Loss: 1.170 Test Acc: 0.633
Validation loss decreased (-0.629617 --> -0.633322).  Saving model ...
Epoch: 31 cost time: 0.569312572479248
Epoch: 31, Steps: 2 | Train Loss: 0.149 Vali Loss: 1.163 Vali Acc: 0.633 Test Loss: 1.163 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 32 cost time: 0.812924861907959
Epoch: 32, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.157 Vali Acc: 0.637 Test Loss: 1.157 Test Acc: 0.637
Validation loss decreased (-0.633322 --> -0.637025).  Saving model ...
Epoch: 33 cost time: 0.9209229946136475
Epoch: 33, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.152 Vali Acc: 0.637 Test Loss: 1.152 Test Acc: 0.637
Validation loss decreased (-0.637025 --> -0.637026).  Saving model ...
Epoch: 34 cost time: 0.5892496109008789
Epoch: 34, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.148 Vali Acc: 0.641 Test Loss: 1.148 Test Acc: 0.641
Validation loss decreased (-0.637026 --> -0.640729).  Saving model ...
Epoch: 35 cost time: 0.7764310836791992
Epoch: 35, Steps: 2 | Train Loss: 0.107 Vali Loss: 1.144 Vali Acc: 0.641 Test Loss: 1.144 Test Acc: 0.641
Validation loss decreased (-0.640729 --> -0.640729).  Saving model ...
Epoch: 36 cost time: 0.8663239479064941
Epoch: 36, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.140 Vali Acc: 0.641 Test Loss: 1.140 Test Acc: 0.641
Validation loss decreased (-0.640729 --> -0.640729).  Saving model ...
Epoch: 37 cost time: 0.8138957023620605
Epoch: 37, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.137 Vali Acc: 0.641 Test Loss: 1.137 Test Acc: 0.641
Validation loss decreased (-0.640729 --> -0.640729).  Saving model ...
Epoch: 38 cost time: 0.7305624485015869
Epoch: 38, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.134 Vali Acc: 0.644 Test Loss: 1.134 Test Acc: 0.644
Validation loss decreased (-0.640729 --> -0.644433).  Saving model ...
Epoch: 39 cost time: 0.7180931568145752
Epoch: 39, Steps: 2 | Train Loss: 0.089 Vali Loss: 1.131 Vali Acc: 0.637 Test Loss: 1.131 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7380790710449219
Epoch: 40, Steps: 2 | Train Loss: 0.079 Vali Loss: 1.128 Vali Acc: 0.644 Test Loss: 1.128 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 41 cost time: 0.8145954608917236
Epoch: 41, Steps: 2 | Train Loss: 0.078 Vali Loss: 1.125 Vali Acc: 0.641 Test Loss: 1.125 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8418586254119873
Epoch: 42, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.122 Vali Acc: 0.641 Test Loss: 1.122 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6804749965667725
Epoch: 43, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.120 Vali Acc: 0.641 Test Loss: 1.120 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9200382232666016
Epoch: 44, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.118 Vali Acc: 0.641 Test Loss: 1.118 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6982018947601318
Epoch: 45, Steps: 2 | Train Loss: 0.065 Vali Loss: 1.116 Vali Acc: 0.637 Test Loss: 1.116 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.741685152053833
Epoch: 46, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.114 Vali Acc: 0.630 Test Loss: 1.114 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7931194305419922
Epoch: 47, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.112 Vali Acc: 0.637 Test Loss: 1.112 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8457684516906738
Epoch: 48, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.110 Vali Acc: 0.641 Test Loss: 1.110 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8263792991638184
Epoch: 49, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.109 Vali Acc: 0.641 Test Loss: 1.109 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.891521692276001
Epoch: 50, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.108 Vali Acc: 0.637 Test Loss: 1.108 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6444444444444445
model parameter : 270008
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7888431549072266
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.842 Vali Acc: 0.222 Test Loss: 1.842 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 0.9422812461853027
Epoch: 2, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.834 Vali Acc: 0.226 Test Loss: 1.834 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.7779734134674072
Epoch: 3, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.828 Vali Acc: 0.230 Test Loss: 1.828 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 1.0605897903442383
Epoch: 4, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.820 Vali Acc: 0.230 Test Loss: 1.820 Test Acc: 0.230
Validation loss decreased (-0.229611 --> -0.229611).  Saving model ...
Epoch: 5 cost time: 1.1387314796447754
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.811 Vali Acc: 0.241 Test Loss: 1.811 Test Acc: 0.241
Validation loss decreased (-0.229611 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.8812024593353271
Epoch: 6, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.800 Vali Acc: 0.237 Test Loss: 1.800 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7566983699798584
Epoch: 7, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.787 Vali Acc: 0.259 Test Loss: 1.787 Test Acc: 0.259
Validation loss decreased (-0.240723 --> -0.259241).  Saving model ...
Epoch: 8 cost time: 1.0075418949127197
Epoch: 8, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.773 Vali Acc: 0.274 Test Loss: 1.773 Test Acc: 0.274
Validation loss decreased (-0.259241 --> -0.274056).  Saving model ...
Epoch: 9 cost time: 0.9039173126220703
Epoch: 9, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.757 Vali Acc: 0.289 Test Loss: 1.757 Test Acc: 0.289
Validation loss decreased (-0.274056 --> -0.288871).  Saving model ...
Epoch: 10 cost time: 0.8202226161956787
Epoch: 10, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.741 Vali Acc: 0.307 Test Loss: 1.741 Test Acc: 0.307
Validation loss decreased (-0.288871 --> -0.307390).  Saving model ...
Epoch: 11 cost time: 0.7949233055114746
Epoch: 11, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.724 Vali Acc: 0.319 Test Loss: 1.724 Test Acc: 0.319
Validation loss decreased (-0.307390 --> -0.318501).  Saving model ...
Epoch: 12 cost time: 0.8895227909088135
Epoch: 12, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.708 Vali Acc: 0.322 Test Loss: 1.708 Test Acc: 0.322
Validation loss decreased (-0.318501 --> -0.322205).  Saving model ...
Epoch: 13 cost time: 0.8909001350402832
Epoch: 13, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.691 Vali Acc: 0.333 Test Loss: 1.691 Test Acc: 0.333
Validation loss decreased (-0.322205 --> -0.333316).  Saving model ...
Epoch: 14 cost time: 1.0005598068237305
Epoch: 14, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.674 Vali Acc: 0.341 Test Loss: 1.674 Test Acc: 0.341
Validation loss decreased (-0.333316 --> -0.340724).  Saving model ...
Epoch: 15 cost time: 0.9216082096099854
Epoch: 15, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.656 Vali Acc: 0.356 Test Loss: 1.656 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 16 cost time: 0.906134843826294
Epoch: 16, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.638 Vali Acc: 0.370 Test Loss: 1.638 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 17 cost time: 1.010507583618164
Epoch: 17, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.620 Vali Acc: 0.396 Test Loss: 1.620 Test Acc: 0.396
Validation loss decreased (-0.370354 --> -0.396280).  Saving model ...
Epoch: 18 cost time: 0.8688461780548096
Epoch: 18, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.601 Vali Acc: 0.426 Test Loss: 1.601 Test Acc: 0.426
Validation loss decreased (-0.396280 --> -0.425910).  Saving model ...
Epoch: 19 cost time: 0.8873164653778076
Epoch: 19, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.582 Vali Acc: 0.441 Test Loss: 1.582 Test Acc: 0.441
Validation loss decreased (-0.425910 --> -0.440725).  Saving model ...
Epoch: 20 cost time: 1.0529029369354248
Epoch: 20, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.563 Vali Acc: 0.444 Test Loss: 1.563 Test Acc: 0.444
Validation loss decreased (-0.440725 --> -0.444429).  Saving model ...
Epoch: 21 cost time: 1.0192418098449707
Epoch: 21, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.545 Vali Acc: 0.456 Test Loss: 1.545 Test Acc: 0.456
Validation loss decreased (-0.444429 --> -0.455540).  Saving model ...
Epoch: 22 cost time: 1.0337083339691162
Epoch: 22, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.527 Vali Acc: 0.463 Test Loss: 1.527 Test Acc: 0.463
Validation loss decreased (-0.455540 --> -0.462948).  Saving model ...
Epoch: 23 cost time: 1.0114502906799316
Epoch: 23, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.508 Vali Acc: 0.481 Test Loss: 1.508 Test Acc: 0.481
Validation loss decreased (-0.462948 --> -0.481466).  Saving model ...
Epoch: 24 cost time: 0.6766848564147949
Epoch: 24, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.490 Vali Acc: 0.500 Test Loss: 1.490 Test Acc: 0.500
Validation loss decreased (-0.481466 --> -0.499985).  Saving model ...
Epoch: 25 cost time: 0.7152392864227295
Epoch: 25, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.471 Vali Acc: 0.511 Test Loss: 1.471 Test Acc: 0.511
Validation loss decreased (-0.499985 --> -0.511096).  Saving model ...
Epoch: 26 cost time: 0.9668207168579102
Epoch: 26, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.452 Vali Acc: 0.541 Test Loss: 1.452 Test Acc: 0.541
Validation loss decreased (-0.511096 --> -0.540726).  Saving model ...
Epoch: 27 cost time: 0.7755043506622314
Epoch: 27, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.434 Vali Acc: 0.559 Test Loss: 1.434 Test Acc: 0.559
Validation loss decreased (-0.540726 --> -0.559245).  Saving model ...
Epoch: 28 cost time: 0.7480602264404297
Epoch: 28, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.416 Vali Acc: 0.574 Test Loss: 1.416 Test Acc: 0.574
Validation loss decreased (-0.559245 --> -0.574060).  Saving model ...
Epoch: 29 cost time: 0.9403531551361084
Epoch: 29, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.399 Vali Acc: 0.596 Test Loss: 1.399 Test Acc: 0.596
Validation loss decreased (-0.574060 --> -0.596282).  Saving model ...
Epoch: 30 cost time: 1.0159618854522705
Epoch: 30, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.382 Vali Acc: 0.600 Test Loss: 1.382 Test Acc: 0.600
Validation loss decreased (-0.596282 --> -0.599986).  Saving model ...
Epoch: 31 cost time: 0.8579225540161133
Epoch: 31, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.367 Vali Acc: 0.607 Test Loss: 1.367 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.607394).  Saving model ...
Epoch: 32 cost time: 0.8922240734100342
Epoch: 32, Steps: 2 | Train Loss: 0.827 Vali Loss: 1.351 Vali Acc: 0.611 Test Loss: 1.351 Test Acc: 0.611
Validation loss decreased (-0.607394 --> -0.611098).  Saving model ...
Epoch: 33 cost time: 0.8700470924377441
Epoch: 33, Steps: 2 | Train Loss: 0.807 Vali Loss: 1.337 Vali Acc: 0.619 Test Loss: 1.337 Test Acc: 0.619
Validation loss decreased (-0.611098 --> -0.618505).  Saving model ...
Epoch: 34 cost time: 1.0568220615386963
Epoch: 34, Steps: 2 | Train Loss: 0.762 Vali Loss: 1.324 Vali Acc: 0.637 Test Loss: 1.324 Test Acc: 0.637
Validation loss decreased (-0.618505 --> -0.637024).  Saving model ...
Epoch: 35 cost time: 1.1916732788085938
Epoch: 35, Steps: 2 | Train Loss: 0.736 Vali Loss: 1.310 Vali Acc: 0.641 Test Loss: 1.310 Test Acc: 0.641
Validation loss decreased (-0.637024 --> -0.640728).  Saving model ...
Epoch: 36 cost time: 0.826845645904541
Epoch: 36, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.297 Vali Acc: 0.648 Test Loss: 1.297 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648135).  Saving model ...
Epoch: 37 cost time: 0.8915297985076904
Epoch: 37, Steps: 2 | Train Loss: 0.713 Vali Loss: 1.285 Vali Acc: 0.659 Test Loss: 1.285 Test Acc: 0.659
Validation loss decreased (-0.648135 --> -0.659246).  Saving model ...
Epoch: 38 cost time: 0.9289638996124268
Epoch: 38, Steps: 2 | Train Loss: 0.666 Vali Loss: 1.272 Vali Acc: 0.656 Test Loss: 1.272 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9057354927062988
Epoch: 39, Steps: 2 | Train Loss: 0.674 Vali Loss: 1.260 Vali Acc: 0.663 Test Loss: 1.260 Test Acc: 0.663
Validation loss decreased (-0.659246 --> -0.662950).  Saving model ...
Epoch: 40 cost time: 0.7223308086395264
Epoch: 40, Steps: 2 | Train Loss: 0.637 Vali Loss: 1.249 Vali Acc: 0.670 Test Loss: 1.249 Test Acc: 0.670
Validation loss decreased (-0.662950 --> -0.670358).  Saving model ...
Epoch: 41 cost time: 1.0229201316833496
Epoch: 41, Steps: 2 | Train Loss: 0.616 Vali Loss: 1.237 Vali Acc: 0.670 Test Loss: 1.237 Test Acc: 0.670
Validation loss decreased (-0.670358 --> -0.670358).  Saving model ...
Epoch: 42 cost time: 0.7545585632324219
Epoch: 42, Steps: 2 | Train Loss: 0.598 Vali Loss: 1.226 Vali Acc: 0.674 Test Loss: 1.226 Test Acc: 0.674
Validation loss decreased (-0.670358 --> -0.674062).  Saving model ...
Epoch: 43 cost time: 0.746678352355957
Epoch: 43, Steps: 2 | Train Loss: 0.560 Vali Loss: 1.215 Vali Acc: 0.678 Test Loss: 1.215 Test Acc: 0.678
Validation loss decreased (-0.674062 --> -0.677766).  Saving model ...
Epoch: 44 cost time: 0.8761398792266846
Epoch: 44, Steps: 2 | Train Loss: 0.549 Vali Loss: 1.204 Vali Acc: 0.689 Test Loss: 1.204 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688877).  Saving model ...
Epoch: 45 cost time: 0.9324510097503662
Epoch: 45, Steps: 2 | Train Loss: 0.553 Vali Loss: 1.194 Vali Acc: 0.693 Test Loss: 1.194 Test Acc: 0.693
Validation loss decreased (-0.688877 --> -0.692581).  Saving model ...
Epoch: 46 cost time: 1.039546012878418
Epoch: 46, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.184 Vali Acc: 0.693 Test Loss: 1.184 Test Acc: 0.693
Validation loss decreased (-0.692581 --> -0.692581).  Saving model ...
Epoch: 47 cost time: 0.8199031352996826
Epoch: 47, Steps: 2 | Train Loss: 0.500 Vali Loss: 1.175 Vali Acc: 0.704 Test Loss: 1.175 Test Acc: 0.704
Validation loss decreased (-0.692581 --> -0.703692).  Saving model ...
Epoch: 48 cost time: 0.843012809753418
Epoch: 48, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.165 Vali Acc: 0.700 Test Loss: 1.165 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1855623722076416
Epoch: 49, Steps: 2 | Train Loss: 0.467 Vali Loss: 1.156 Vali Acc: 0.700 Test Loss: 1.156 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9057517051696777
Epoch: 50, Steps: 2 | Train Loss: 0.454 Vali Loss: 1.147 Vali Acc: 0.704 Test Loss: 1.147 Test Acc: 0.704
Validation loss decreased (-0.703692 --> -0.703692).  Saving model ...
Epoch: 51 cost time: 0.9753162860870361
Epoch: 51, Steps: 2 | Train Loss: 0.449 Vali Loss: 1.139 Vali Acc: 0.707 Test Loss: 1.139 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 52 cost time: 0.889946699142456
Epoch: 52, Steps: 2 | Train Loss: 0.446 Vali Loss: 1.130 Vali Acc: 0.707 Test Loss: 1.130 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 53 cost time: 0.9949028491973877
Epoch: 53, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.122 Vali Acc: 0.719 Test Loss: 1.122 Test Acc: 0.719
Validation loss decreased (-0.707396 --> -0.718507).  Saving model ...
Epoch: 54 cost time: 1.1365468502044678
Epoch: 54, Steps: 2 | Train Loss: 0.392 Vali Loss: 1.114 Vali Acc: 0.707 Test Loss: 1.114 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9868383407592773
Epoch: 55, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.106 Vali Acc: 0.711 Test Loss: 1.106 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8872842788696289
Epoch: 56, Steps: 2 | Train Loss: 0.360 Vali Loss: 1.098 Vali Acc: 0.715 Test Loss: 1.098 Test Acc: 0.715
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9170422554016113
Epoch: 57, Steps: 2 | Train Loss: 0.346 Vali Loss: 1.091 Vali Acc: 0.715 Test Loss: 1.091 Test Acc: 0.715
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9937372207641602
Epoch: 58, Steps: 2 | Train Loss: 0.322 Vali Loss: 1.083 Vali Acc: 0.722 Test Loss: 1.083 Test Acc: 0.722
Validation loss decreased (-0.718507 --> -0.722211).  Saving model ...
Epoch: 59 cost time: 0.750727653503418
Epoch: 59, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.076 Vali Acc: 0.722 Test Loss: 1.076 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722211).  Saving model ...
Epoch: 60 cost time: 0.8850595951080322
Epoch: 60, Steps: 2 | Train Loss: 0.326 Vali Loss: 1.069 Vali Acc: 0.722 Test Loss: 1.069 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722212).  Saving model ...
Epoch: 61 cost time: 0.9000773429870605
Epoch: 61, Steps: 2 | Train Loss: 0.307 Vali Loss: 1.061 Vali Acc: 0.726 Test Loss: 1.061 Test Acc: 0.726
Validation loss decreased (-0.722212 --> -0.725915).  Saving model ...
Epoch: 62 cost time: 0.7999610900878906
Epoch: 62, Steps: 2 | Train Loss: 0.303 Vali Loss: 1.054 Vali Acc: 0.726 Test Loss: 1.054 Test Acc: 0.726
Validation loss decreased (-0.725915 --> -0.725915).  Saving model ...
Epoch: 63 cost time: 0.8046400547027588
Epoch: 63, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.046 Vali Acc: 0.730 Test Loss: 1.046 Test Acc: 0.730
Validation loss decreased (-0.725915 --> -0.729619).  Saving model ...
Epoch: 64 cost time: 0.8410842418670654
Epoch: 64, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.039 Vali Acc: 0.730 Test Loss: 1.039 Test Acc: 0.730
Validation loss decreased (-0.729619 --> -0.729619).  Saving model ...
Epoch: 65 cost time: 1.0399401187896729
Epoch: 65, Steps: 2 | Train Loss: 0.267 Vali Loss: 1.031 Vali Acc: 0.726 Test Loss: 1.031 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.107471227645874
Epoch: 66, Steps: 2 | Train Loss: 0.262 Vali Loss: 1.024 Vali Acc: 0.722 Test Loss: 1.024 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7604086399078369
Epoch: 67, Steps: 2 | Train Loss: 0.245 Vali Loss: 1.018 Vali Acc: 0.722 Test Loss: 1.018 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7508599758148193
Epoch: 68, Steps: 2 | Train Loss: 0.245 Vali Loss: 1.013 Vali Acc: 0.722 Test Loss: 1.013 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.0347323417663574
Epoch: 69, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.007 Vali Acc: 0.726 Test Loss: 1.007 Test Acc: 0.726
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8384201526641846
Epoch: 70, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.002 Vali Acc: 0.722 Test Loss: 1.002 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.8822789192199707
Epoch: 71, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.997 Vali Acc: 0.719 Test Loss: 0.997 Test Acc: 0.719
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.9418454170227051
Epoch: 72, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.992 Vali Acc: 0.719 Test Loss: 0.992 Test Acc: 0.719
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.943265438079834
Epoch: 73, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.987 Vali Acc: 0.719 Test Loss: 0.987 Test Acc: 0.719
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.9965155124664307
Epoch: 74, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.982 Vali Acc: 0.719 Test Loss: 0.982 Test Acc: 0.719
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7296296296296296
model parameter : 144100
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0208356380462646
Epoch: 1, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.832 Vali Acc: 0.115 Test Loss: 1.832 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.8814935684204102
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.826 Vali Acc: 0.119 Test Loss: 1.826 Test Acc: 0.119
Validation loss decreased (-0.114796 --> -0.118500).  Saving model ...
Epoch: 3 cost time: 0.7317202091217041
Epoch: 3, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.821 Vali Acc: 0.119 Test Loss: 1.821 Test Acc: 0.119
Validation loss decreased (-0.118500 --> -0.118500).  Saving model ...
Epoch: 4 cost time: 0.7435581684112549
Epoch: 4, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.816 Vali Acc: 0.119 Test Loss: 1.816 Test Acc: 0.119
Validation loss decreased (-0.118500 --> -0.118500).  Saving model ...
Epoch: 5 cost time: 0.8240072727203369
Epoch: 5, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.809 Vali Acc: 0.130 Test Loss: 1.809 Test Acc: 0.130
Validation loss decreased (-0.118500 --> -0.129612).  Saving model ...
Epoch: 6 cost time: 0.7027056217193604
Epoch: 6, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.801 Vali Acc: 0.137 Test Loss: 1.801 Test Acc: 0.137
Validation loss decreased (-0.129612 --> -0.137019).  Saving model ...
Epoch: 7 cost time: 0.8229148387908936
Epoch: 7, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.792 Vali Acc: 0.156 Test Loss: 1.792 Test Acc: 0.156
Validation loss decreased (-0.137019 --> -0.155538).  Saving model ...
Epoch: 8 cost time: 0.6996157169342041
Epoch: 8, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.782 Vali Acc: 0.170 Test Loss: 1.782 Test Acc: 0.170
Validation loss decreased (-0.155538 --> -0.170353).  Saving model ...
Epoch: 9 cost time: 0.9681921005249023
Epoch: 9, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.771 Vali Acc: 0.174 Test Loss: 1.771 Test Acc: 0.174
Validation loss decreased (-0.170353 --> -0.174056).  Saving model ...
Epoch: 10 cost time: 0.7680583000183105
Epoch: 10, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.761 Vali Acc: 0.189 Test Loss: 1.761 Test Acc: 0.189
Validation loss decreased (-0.174056 --> -0.188871).  Saving model ...
Epoch: 11 cost time: 0.7223489284515381
Epoch: 11, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.749 Vali Acc: 0.200 Test Loss: 1.749 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199983).  Saving model ...
Epoch: 12 cost time: 1.0495097637176514
Epoch: 12, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.738 Vali Acc: 0.204 Test Loss: 1.738 Test Acc: 0.204
Validation loss decreased (-0.199983 --> -0.203686).  Saving model ...
Epoch: 13 cost time: 0.8889515399932861
Epoch: 13, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.726 Vali Acc: 0.233 Test Loss: 1.726 Test Acc: 0.233
Validation loss decreased (-0.203686 --> -0.233316).  Saving model ...
Epoch: 14 cost time: 0.845684289932251
Epoch: 14, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.715 Vali Acc: 0.244 Test Loss: 1.715 Test Acc: 0.244
Validation loss decreased (-0.233316 --> -0.244427).  Saving model ...
Epoch: 15 cost time: 0.9052391052246094
Epoch: 15, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.703 Vali Acc: 0.259 Test Loss: 1.703 Test Acc: 0.259
Validation loss decreased (-0.244427 --> -0.259242).  Saving model ...
Epoch: 16 cost time: 0.6829886436462402
Epoch: 16, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.690 Vali Acc: 0.281 Test Loss: 1.690 Test Acc: 0.281
Validation loss decreased (-0.259242 --> -0.281465).  Saving model ...
Epoch: 17 cost time: 0.8722074031829834
Epoch: 17, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.677 Vali Acc: 0.319 Test Loss: 1.677 Test Acc: 0.319
Validation loss decreased (-0.281465 --> -0.318502).  Saving model ...
Epoch: 18 cost time: 0.8017215728759766
Epoch: 18, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.664 Vali Acc: 0.330 Test Loss: 1.664 Test Acc: 0.330
Validation loss decreased (-0.318502 --> -0.329613).  Saving model ...
Epoch: 19 cost time: 1.065852403640747
Epoch: 19, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.651 Vali Acc: 0.378 Test Loss: 1.651 Test Acc: 0.378
Validation loss decreased (-0.329613 --> -0.377761).  Saving model ...
Epoch: 20 cost time: 0.7624380588531494
Epoch: 20, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.637 Vali Acc: 0.404 Test Loss: 1.637 Test Acc: 0.404
Validation loss decreased (-0.377761 --> -0.403687).  Saving model ...
Epoch: 21 cost time: 0.8996284008026123
Epoch: 21, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.623 Vali Acc: 0.441 Test Loss: 1.623 Test Acc: 0.441
Validation loss decreased (-0.403687 --> -0.440725).  Saving model ...
Epoch: 22 cost time: 1.04909348487854
Epoch: 22, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.609 Vali Acc: 0.478 Test Loss: 1.609 Test Acc: 0.478
Validation loss decreased (-0.440725 --> -0.477762).  Saving model ...
Epoch: 23 cost time: 0.9580357074737549
Epoch: 23, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.595 Vali Acc: 0.474 Test Loss: 1.595 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9812378883361816
Epoch: 24, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.581 Vali Acc: 0.481 Test Loss: 1.581 Test Acc: 0.481
Validation loss decreased (-0.477762 --> -0.481466).  Saving model ...
Epoch: 25 cost time: 0.7412827014923096
Epoch: 25, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.567 Vali Acc: 0.500 Test Loss: 1.567 Test Acc: 0.500
Validation loss decreased (-0.481466 --> -0.499984).  Saving model ...
Epoch: 26 cost time: 0.8201186656951904
Epoch: 26, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.554 Vali Acc: 0.511 Test Loss: 1.554 Test Acc: 0.511
Validation loss decreased (-0.499984 --> -0.511096).  Saving model ...
Epoch: 27 cost time: 0.900538444519043
Epoch: 27, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.542 Vali Acc: 0.526 Test Loss: 1.542 Test Acc: 0.526
Validation loss decreased (-0.511096 --> -0.525911).  Saving model ...
Epoch: 28 cost time: 0.7806694507598877
Epoch: 28, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.529 Vali Acc: 0.533 Test Loss: 1.529 Test Acc: 0.533
Validation loss decreased (-0.525911 --> -0.533318).  Saving model ...
Epoch: 29 cost time: 0.8191566467285156
Epoch: 29, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.517 Vali Acc: 0.548 Test Loss: 1.517 Test Acc: 0.548
Validation loss decreased (-0.533318 --> -0.548133).  Saving model ...
Epoch: 30 cost time: 0.9389650821685791
Epoch: 30, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.505 Vali Acc: 0.556 Test Loss: 1.505 Test Acc: 0.556
Validation loss decreased (-0.548133 --> -0.555541).  Saving model ...
Epoch: 31 cost time: 0.8098082542419434
Epoch: 31, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.493 Vali Acc: 0.567 Test Loss: 1.493 Test Acc: 0.567
Validation loss decreased (-0.555541 --> -0.566652).  Saving model ...
Epoch: 32 cost time: 0.9489672183990479
Epoch: 32, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.481 Vali Acc: 0.567 Test Loss: 1.481 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566652).  Saving model ...
Epoch: 33 cost time: 0.8750324249267578
Epoch: 33, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.470 Vali Acc: 0.585 Test Loss: 1.470 Test Acc: 0.585
Validation loss decreased (-0.566652 --> -0.585170).  Saving model ...
Epoch: 34 cost time: 0.8725550174713135
Epoch: 34, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.460 Vali Acc: 0.593 Test Loss: 1.460 Test Acc: 0.593
Validation loss decreased (-0.585170 --> -0.592578).  Saving model ...
Epoch: 35 cost time: 0.6994824409484863
Epoch: 35, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.449 Vali Acc: 0.596 Test Loss: 1.449 Test Acc: 0.596
Validation loss decreased (-0.592578 --> -0.596282).  Saving model ...
Epoch: 36 cost time: 1.00600004196167
Epoch: 36, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.439 Vali Acc: 0.611 Test Loss: 1.439 Test Acc: 0.611
Validation loss decreased (-0.596282 --> -0.611097).  Saving model ...
Epoch: 37 cost time: 0.8445556163787842
Epoch: 37, Steps: 2 | Train Loss: 0.829 Vali Loss: 1.430 Vali Acc: 0.607 Test Loss: 1.430 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0332531929016113
Epoch: 38, Steps: 2 | Train Loss: 0.823 Vali Loss: 1.420 Vali Acc: 0.607 Test Loss: 1.420 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8864879608154297
Epoch: 39, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.410 Vali Acc: 0.622 Test Loss: 1.410 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622208).  Saving model ...
Epoch: 40 cost time: 0.83551025390625
Epoch: 40, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.400 Vali Acc: 0.633 Test Loss: 1.400 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633319).  Saving model ...
Epoch: 41 cost time: 0.7532734870910645
Epoch: 41, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.390 Vali Acc: 0.633 Test Loss: 1.390 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 42 cost time: 1.175307273864746
Epoch: 42, Steps: 2 | Train Loss: 0.735 Vali Loss: 1.380 Vali Acc: 0.637 Test Loss: 1.380 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.637023).  Saving model ...
Epoch: 43 cost time: 0.8758895397186279
Epoch: 43, Steps: 2 | Train Loss: 0.689 Vali Loss: 1.371 Vali Acc: 0.637 Test Loss: 1.371 Test Acc: 0.637
Validation loss decreased (-0.637023 --> -0.637023).  Saving model ...
Epoch: 44 cost time: 0.8411991596221924
Epoch: 44, Steps: 2 | Train Loss: 0.709 Vali Loss: 1.362 Vali Acc: 0.637 Test Loss: 1.362 Test Acc: 0.637
Validation loss decreased (-0.637023 --> -0.637023).  Saving model ...
Epoch: 45 cost time: 1.0017902851104736
Epoch: 45, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.353 Vali Acc: 0.641 Test Loss: 1.353 Test Acc: 0.641
Validation loss decreased (-0.637023 --> -0.640727).  Saving model ...
Epoch: 46 cost time: 0.9193007946014404
Epoch: 46, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.344 Vali Acc: 0.644 Test Loss: 1.344 Test Acc: 0.644
Validation loss decreased (-0.640727 --> -0.644431).  Saving model ...
Epoch: 47 cost time: 0.6735656261444092
Epoch: 47, Steps: 2 | Train Loss: 0.622 Vali Loss: 1.335 Vali Acc: 0.648 Test Loss: 1.335 Test Acc: 0.648
Validation loss decreased (-0.644431 --> -0.648135).  Saving model ...
Epoch: 48 cost time: 0.7288961410522461
Epoch: 48, Steps: 2 | Train Loss: 0.618 Vali Loss: 1.327 Vali Acc: 0.652 Test Loss: 1.327 Test Acc: 0.652
Validation loss decreased (-0.648135 --> -0.651839).  Saving model ...
Epoch: 49 cost time: 0.8388595581054688
Epoch: 49, Steps: 2 | Train Loss: 0.583 Vali Loss: 1.318 Vali Acc: 0.652 Test Loss: 1.318 Test Acc: 0.652
Validation loss decreased (-0.651839 --> -0.651839).  Saving model ...
Epoch: 50 cost time: 0.8132174015045166
Epoch: 50, Steps: 2 | Train Loss: 0.563 Vali Loss: 1.309 Vali Acc: 0.656 Test Loss: 1.309 Test Acc: 0.656
Validation loss decreased (-0.651839 --> -0.655542).  Saving model ...
Epoch: 51 cost time: 0.9407143592834473
Epoch: 51, Steps: 2 | Train Loss: 0.573 Vali Loss: 1.301 Vali Acc: 0.659 Test Loss: 1.301 Test Acc: 0.659
Validation loss decreased (-0.655542 --> -0.659246).  Saving model ...
Epoch: 52 cost time: 0.7089283466339111
Epoch: 52, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.293 Vali Acc: 0.659 Test Loss: 1.293 Test Acc: 0.659
Validation loss decreased (-0.659246 --> -0.659246).  Saving model ...
Epoch: 53 cost time: 0.8164730072021484
Epoch: 53, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.285 Vali Acc: 0.656 Test Loss: 1.285 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.828833818435669
Epoch: 54, Steps: 2 | Train Loss: 0.531 Vali Loss: 1.277 Vali Acc: 0.652 Test Loss: 1.277 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9232192039489746
Epoch: 55, Steps: 2 | Train Loss: 0.480 Vali Loss: 1.269 Vali Acc: 0.652 Test Loss: 1.269 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8907606601715088
Epoch: 56, Steps: 2 | Train Loss: 0.469 Vali Loss: 1.261 Vali Acc: 0.652 Test Loss: 1.261 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8340027332305908
Epoch: 57, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.254 Vali Acc: 0.652 Test Loss: 1.254 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9354166984558105
Epoch: 58, Steps: 2 | Train Loss: 0.442 Vali Loss: 1.247 Vali Acc: 0.652 Test Loss: 1.247 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.8521220684051514
Epoch: 59, Steps: 2 | Train Loss: 0.438 Vali Loss: 1.240 Vali Acc: 0.656 Test Loss: 1.240 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.854569673538208
Epoch: 60, Steps: 2 | Train Loss: 0.420 Vali Loss: 1.234 Vali Acc: 0.656 Test Loss: 1.234 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7882344722747803
Epoch: 61, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.227 Vali Acc: 0.659 Test Loss: 1.227 Test Acc: 0.659
Validation loss decreased (-0.659246 --> -0.659247).  Saving model ...
Epoch: 62 cost time: 0.9096403121948242
Epoch: 62, Steps: 2 | Train Loss: 0.401 Vali Loss: 1.221 Vali Acc: 0.663 Test Loss: 1.221 Test Acc: 0.663
Validation loss decreased (-0.659247 --> -0.662951).  Saving model ...
Epoch: 63 cost time: 0.7135281562805176
Epoch: 63, Steps: 2 | Train Loss: 0.397 Vali Loss: 1.215 Vali Acc: 0.659 Test Loss: 1.215 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8994314670562744
Epoch: 64, Steps: 2 | Train Loss: 0.372 Vali Loss: 1.209 Vali Acc: 0.663 Test Loss: 1.209 Test Acc: 0.663
Validation loss decreased (-0.662951 --> -0.662951).  Saving model ...
Epoch: 65 cost time: 0.7203986644744873
Epoch: 65, Steps: 2 | Train Loss: 0.360 Vali Loss: 1.203 Vali Acc: 0.659 Test Loss: 1.203 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9023067951202393
Epoch: 66, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.197 Vali Acc: 0.663 Test Loss: 1.197 Test Acc: 0.663
Validation loss decreased (-0.662951 --> -0.662951).  Saving model ...
Epoch: 67 cost time: 0.7607722282409668
Epoch: 67, Steps: 2 | Train Loss: 0.326 Vali Loss: 1.191 Vali Acc: 0.663 Test Loss: 1.191 Test Acc: 0.663
Validation loss decreased (-0.662951 --> -0.662951).  Saving model ...
Epoch: 68 cost time: 0.9980869293212891
Epoch: 68, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.185 Vali Acc: 0.667 Test Loss: 1.185 Test Acc: 0.667
Validation loss decreased (-0.662951 --> -0.666655).  Saving model ...
Epoch: 69 cost time: 1.0092463493347168
Epoch: 69, Steps: 2 | Train Loss: 0.295 Vali Loss: 1.179 Vali Acc: 0.667 Test Loss: 1.179 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 70 cost time: 0.9111707210540771
Epoch: 70, Steps: 2 | Train Loss: 0.305 Vali Loss: 1.173 Vali Acc: 0.663 Test Loss: 1.173 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.1238412857055664
Epoch: 71, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.168 Vali Acc: 0.667 Test Loss: 1.168 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 72 cost time: 0.8756263256072998
Epoch: 72, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.162 Vali Acc: 0.667 Test Loss: 1.162 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 73 cost time: 0.951634407043457
Epoch: 73, Steps: 2 | Train Loss: 0.295 Vali Loss: 1.158 Vali Acc: 0.670 Test Loss: 1.158 Test Acc: 0.670
Validation loss decreased (-0.666655 --> -0.670359).  Saving model ...
Epoch: 74 cost time: 0.8597910404205322
Epoch: 74, Steps: 2 | Train Loss: 0.253 Vali Loss: 1.154 Vali Acc: 0.678 Test Loss: 1.154 Test Acc: 0.678
Validation loss decreased (-0.670359 --> -0.677766).  Saving model ...
Epoch: 75 cost time: 0.9107301235198975
Epoch: 75, Steps: 2 | Train Loss: 0.252 Vali Loss: 1.150 Vali Acc: 0.685 Test Loss: 1.150 Test Acc: 0.685
Validation loss decreased (-0.677766 --> -0.685174).  Saving model ...
Epoch: 76 cost time: 1.0463359355926514
Epoch: 76, Steps: 2 | Train Loss: 0.249 Vali Loss: 1.145 Vali Acc: 0.693 Test Loss: 1.145 Test Acc: 0.693
Validation loss decreased (-0.685174 --> -0.692581).  Saving model ...
Epoch: 77 cost time: 0.8245201110839844
Epoch: 77, Steps: 2 | Train Loss: 0.245 Vali Loss: 1.140 Vali Acc: 0.696 Test Loss: 1.140 Test Acc: 0.696
Validation loss decreased (-0.692581 --> -0.696285).  Saving model ...
Epoch: 78 cost time: 1.045839548110962
Epoch: 78, Steps: 2 | Train Loss: 0.221 Vali Loss: 1.135 Vali Acc: 0.696 Test Loss: 1.135 Test Acc: 0.696
Validation loss decreased (-0.696285 --> -0.696285).  Saving model ...
Epoch: 79 cost time: 1.0716073513031006
Epoch: 79, Steps: 2 | Train Loss: 0.226 Vali Loss: 1.130 Vali Acc: 0.696 Test Loss: 1.130 Test Acc: 0.696
Validation loss decreased (-0.696285 --> -0.696285).  Saving model ...
Epoch: 80 cost time: 0.8423244953155518
Epoch: 80, Steps: 2 | Train Loss: 0.224 Vali Loss: 1.125 Vali Acc: 0.696 Test Loss: 1.125 Test Acc: 0.696
Validation loss decreased (-0.696285 --> -0.696285).  Saving model ...
Epoch: 81 cost time: 1.1831841468811035
Epoch: 81, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.120 Vali Acc: 0.696 Test Loss: 1.120 Test Acc: 0.696
Validation loss decreased (-0.696285 --> -0.696285).  Saving model ...
Epoch: 82 cost time: 0.8650417327880859
Epoch: 82, Steps: 2 | Train Loss: 0.213 Vali Loss: 1.116 Vali Acc: 0.693 Test Loss: 1.116 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.3473987579345703
Epoch: 83, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.111 Vali Acc: 0.696 Test Loss: 1.111 Test Acc: 0.696
Validation loss decreased (-0.696285 --> -0.696285).  Saving model ...
Epoch: 84 cost time: 0.84263014793396
Epoch: 84, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
Validation loss decreased (-0.696285 --> -0.699989).  Saving model ...
Epoch: 85 cost time: 0.9243175983428955
Epoch: 85, Steps: 2 | Train Loss: 0.179 Vali Loss: 1.102 Vali Acc: 0.700 Test Loss: 1.102 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 86 cost time: 0.9389970302581787
Epoch: 86, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.098 Vali Acc: 0.704 Test Loss: 1.098 Test Acc: 0.704
Validation loss decreased (-0.699989 --> -0.703693).  Saving model ...
Epoch: 87 cost time: 1.1769471168518066
Epoch: 87, Steps: 2 | Train Loss: 0.180 Vali Loss: 1.094 Vali Acc: 0.696 Test Loss: 1.094 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.929133415222168
Epoch: 88, Steps: 2 | Train Loss: 0.181 Vali Loss: 1.091 Vali Acc: 0.693 Test Loss: 1.091 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.363236904144287
Epoch: 89, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.088 Vali Acc: 0.693 Test Loss: 1.088 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.818446159362793
Epoch: 90, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.086 Vali Acc: 0.696 Test Loss: 1.086 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.834204912185669
Epoch: 91, Steps: 2 | Train Loss: 0.162 Vali Loss: 1.083 Vali Acc: 0.696 Test Loss: 1.083 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.9169178009033203
Epoch: 92, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.080 Vali Acc: 0.693 Test Loss: 1.080 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.0673010349273682
Epoch: 93, Steps: 2 | Train Loss: 0.148 Vali Loss: 1.076 Vali Acc: 0.689 Test Loss: 1.076 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.9445834159851074
Epoch: 94, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.073 Vali Acc: 0.689 Test Loss: 1.073 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.9425530433654785
Epoch: 95, Steps: 2 | Train Loss: 0.139 Vali Loss: 1.070 Vali Acc: 0.689 Test Loss: 1.070 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 0.9789912700653076
Epoch: 96, Steps: 2 | Train Loss: 0.135 Vali Loss: 1.068 Vali Acc: 0.685 Test Loss: 1.068 Test Acc: 0.685
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7037037037037037
model parameter : 142052
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6490478515625
Epoch: 1, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.841 Vali Acc: 0.133 Test Loss: 1.841 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.8635268211364746
Epoch: 2, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.835 Vali Acc: 0.141 Test Loss: 1.835 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 0.8210458755493164
Epoch: 3, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.830 Vali Acc: 0.144 Test Loss: 1.830 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 0.9073400497436523
Epoch: 4, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.824 Vali Acc: 0.148 Test Loss: 1.824 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148130).  Saving model ...
Epoch: 5 cost time: 0.8494319915771484
Epoch: 5, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.817 Vali Acc: 0.156 Test Loss: 1.817 Test Acc: 0.156
Validation loss decreased (-0.148130 --> -0.155537).  Saving model ...
Epoch: 6 cost time: 0.865372896194458
Epoch: 6, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.808 Vali Acc: 0.170 Test Loss: 1.808 Test Acc: 0.170
Validation loss decreased (-0.155537 --> -0.170352).  Saving model ...
Epoch: 7 cost time: 0.8243143558502197
Epoch: 7, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.799 Vali Acc: 0.170 Test Loss: 1.799 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 8 cost time: 0.8445661067962646
Epoch: 8, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.788 Vali Acc: 0.174 Test Loss: 1.788 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 9 cost time: 0.7859594821929932
Epoch: 9, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.777 Vali Acc: 0.181 Test Loss: 1.777 Test Acc: 0.181
Validation loss decreased (-0.174056 --> -0.181464).  Saving model ...
Epoch: 10 cost time: 0.8212518692016602
Epoch: 10, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.765 Vali Acc: 0.174 Test Loss: 1.765 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8009648323059082
Epoch: 11, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.752 Vali Acc: 0.181 Test Loss: 1.752 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 12 cost time: 0.9316236972808838
Epoch: 12, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.739 Vali Acc: 0.193 Test Loss: 1.739 Test Acc: 0.193
Validation loss decreased (-0.181464 --> -0.192575).  Saving model ...
Epoch: 13 cost time: 1.0312838554382324
Epoch: 13, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.726 Vali Acc: 0.204 Test Loss: 1.726 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 14 cost time: 0.8104221820831299
Epoch: 14, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.712 Vali Acc: 0.215 Test Loss: 1.712 Test Acc: 0.215
Validation loss decreased (-0.203686 --> -0.214798).  Saving model ...
Epoch: 15 cost time: 0.9571990966796875
Epoch: 15, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.698 Vali Acc: 0.237 Test Loss: 1.698 Test Acc: 0.237
Validation loss decreased (-0.214798 --> -0.237020).  Saving model ...
Epoch: 16 cost time: 0.864588737487793
Epoch: 16, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.684 Vali Acc: 0.241 Test Loss: 1.684 Test Acc: 0.241
Validation loss decreased (-0.237020 --> -0.240724).  Saving model ...
Epoch: 17 cost time: 0.79978346824646
Epoch: 17, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.669 Vali Acc: 0.248 Test Loss: 1.669 Test Acc: 0.248
Validation loss decreased (-0.240724 --> -0.248131).  Saving model ...
Epoch: 18 cost time: 0.901658296585083
Epoch: 18, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.655 Vali Acc: 0.263 Test Loss: 1.655 Test Acc: 0.263
Validation loss decreased (-0.248131 --> -0.262946).  Saving model ...
Epoch: 19 cost time: 0.8039078712463379
Epoch: 19, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.642 Vali Acc: 0.263 Test Loss: 1.642 Test Acc: 0.263
Validation loss decreased (-0.262946 --> -0.262947).  Saving model ...
Epoch: 20 cost time: 0.8813226222991943
Epoch: 20, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.628 Vali Acc: 0.252 Test Loss: 1.628 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8368134498596191
Epoch: 21, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.614 Vali Acc: 0.289 Test Loss: 1.614 Test Acc: 0.289
Validation loss decreased (-0.262947 --> -0.288873).  Saving model ...
Epoch: 22 cost time: 0.6856670379638672
Epoch: 22, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.600 Vali Acc: 0.315 Test Loss: 1.600 Test Acc: 0.315
Validation loss decreased (-0.288873 --> -0.314799).  Saving model ...
Epoch: 23 cost time: 0.8263261318206787
Epoch: 23, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.587 Vali Acc: 0.341 Test Loss: 1.587 Test Acc: 0.341
Validation loss decreased (-0.314799 --> -0.340725).  Saving model ...
Epoch: 24 cost time: 1.0304045677185059
Epoch: 24, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.574 Vali Acc: 0.363 Test Loss: 1.574 Test Acc: 0.363
Validation loss decreased (-0.340725 --> -0.362947).  Saving model ...
Epoch: 25 cost time: 0.8770754337310791
Epoch: 25, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.560 Vali Acc: 0.396 Test Loss: 1.560 Test Acc: 0.396
Validation loss decreased (-0.362947 --> -0.396281).  Saving model ...
Epoch: 26 cost time: 1.088458776473999
Epoch: 26, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.546 Vali Acc: 0.411 Test Loss: 1.546 Test Acc: 0.411
Validation loss decreased (-0.396281 --> -0.411096).  Saving model ...
Epoch: 27 cost time: 0.6930983066558838
Epoch: 27, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.532 Vali Acc: 0.426 Test Loss: 1.532 Test Acc: 0.426
Validation loss decreased (-0.411096 --> -0.425911).  Saving model ...
Epoch: 28 cost time: 0.9171457290649414
Epoch: 28, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.519 Vali Acc: 0.444 Test Loss: 1.519 Test Acc: 0.444
Validation loss decreased (-0.425911 --> -0.444429).  Saving model ...
Epoch: 29 cost time: 0.8019254207611084
Epoch: 29, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.506 Vali Acc: 0.467 Test Loss: 1.506 Test Acc: 0.467
Validation loss decreased (-0.444429 --> -0.466652).  Saving model ...
Epoch: 30 cost time: 0.734755277633667
Epoch: 30, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.493 Vali Acc: 0.474 Test Loss: 1.493 Test Acc: 0.474
Validation loss decreased (-0.466652 --> -0.474059).  Saving model ...
Epoch: 31 cost time: 0.7456283569335938
Epoch: 31, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.481 Vali Acc: 0.496 Test Loss: 1.481 Test Acc: 0.496
Validation loss decreased (-0.474059 --> -0.496281).  Saving model ...
Epoch: 32 cost time: 0.9243814945220947
Epoch: 32, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.467 Vali Acc: 0.519 Test Loss: 1.467 Test Acc: 0.519
Validation loss decreased (-0.496281 --> -0.518504).  Saving model ...
Epoch: 33 cost time: 0.7831020355224609
Epoch: 33, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.454 Vali Acc: 0.541 Test Loss: 1.454 Test Acc: 0.541
Validation loss decreased (-0.518504 --> -0.540726).  Saving model ...
Epoch: 34 cost time: 0.9167037010192871
Epoch: 34, Steps: 2 | Train Loss: 0.838 Vali Loss: 1.441 Vali Acc: 0.556 Test Loss: 1.441 Test Acc: 0.556
Validation loss decreased (-0.540726 --> -0.555541).  Saving model ...
Epoch: 35 cost time: 0.8151602745056152
Epoch: 35, Steps: 2 | Train Loss: 0.793 Vali Loss: 1.428 Vali Acc: 0.570 Test Loss: 1.428 Test Acc: 0.570
Validation loss decreased (-0.555541 --> -0.570356).  Saving model ...
Epoch: 36 cost time: 0.6829187870025635
Epoch: 36, Steps: 2 | Train Loss: 0.750 Vali Loss: 1.415 Vali Acc: 0.578 Test Loss: 1.415 Test Acc: 0.578
Validation loss decreased (-0.570356 --> -0.577764).  Saving model ...
Epoch: 37 cost time: 0.7776446342468262
Epoch: 37, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.401 Vali Acc: 0.589 Test Loss: 1.401 Test Acc: 0.589
Validation loss decreased (-0.577764 --> -0.588875).  Saving model ...
Epoch: 38 cost time: 0.6686692237854004
Epoch: 38, Steps: 2 | Train Loss: 0.726 Vali Loss: 1.389 Vali Acc: 0.593 Test Loss: 1.389 Test Acc: 0.593
Validation loss decreased (-0.588875 --> -0.592579).  Saving model ...
Epoch: 39 cost time: 0.8035919666290283
Epoch: 39, Steps: 2 | Train Loss: 0.680 Vali Loss: 1.376 Vali Acc: 0.604 Test Loss: 1.376 Test Acc: 0.604
Validation loss decreased (-0.592579 --> -0.603690).  Saving model ...
Epoch: 40 cost time: 0.839000940322876
Epoch: 40, Steps: 2 | Train Loss: 0.691 Vali Loss: 1.365 Vali Acc: 0.615 Test Loss: 1.365 Test Acc: 0.615
Validation loss decreased (-0.603690 --> -0.614801).  Saving model ...
Epoch: 41 cost time: 0.7070043087005615
Epoch: 41, Steps: 2 | Train Loss: 0.627 Vali Loss: 1.353 Vali Acc: 0.619 Test Loss: 1.353 Test Acc: 0.619
Validation loss decreased (-0.614801 --> -0.618505).  Saving model ...
Epoch: 42 cost time: 0.657707929611206
Epoch: 42, Steps: 2 | Train Loss: 0.629 Vali Loss: 1.342 Vali Acc: 0.619 Test Loss: 1.342 Test Acc: 0.619
Validation loss decreased (-0.618505 --> -0.618505).  Saving model ...
Epoch: 43 cost time: 0.6800181865692139
Epoch: 43, Steps: 2 | Train Loss: 0.609 Vali Loss: 1.332 Vali Acc: 0.622 Test Loss: 1.332 Test Acc: 0.622
Validation loss decreased (-0.618505 --> -0.622209).  Saving model ...
Epoch: 44 cost time: 0.7327494621276855
Epoch: 44, Steps: 2 | Train Loss: 0.595 Vali Loss: 1.321 Vali Acc: 0.619 Test Loss: 1.321 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7370114326477051
Epoch: 45, Steps: 2 | Train Loss: 0.567 Vali Loss: 1.312 Vali Acc: 0.619 Test Loss: 1.312 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8553562164306641
Epoch: 46, Steps: 2 | Train Loss: 0.540 Vali Loss: 1.303 Vali Acc: 0.622 Test Loss: 1.303 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622209).  Saving model ...
Epoch: 47 cost time: 0.7329652309417725
Epoch: 47, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.293 Vali Acc: 0.622 Test Loss: 1.293 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622209).  Saving model ...
Epoch: 48 cost time: 0.7003846168518066
Epoch: 48, Steps: 2 | Train Loss: 0.489 Vali Loss: 1.285 Vali Acc: 0.619 Test Loss: 1.285 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7356584072113037
Epoch: 49, Steps: 2 | Train Loss: 0.501 Vali Loss: 1.276 Vali Acc: 0.615 Test Loss: 1.276 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0287997722625732
Epoch: 50, Steps: 2 | Train Loss: 0.473 Vali Loss: 1.268 Vali Acc: 0.615 Test Loss: 1.268 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7464959621429443
Epoch: 51, Steps: 2 | Train Loss: 0.458 Vali Loss: 1.260 Vali Acc: 0.611 Test Loss: 1.260 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8994991779327393
Epoch: 52, Steps: 2 | Train Loss: 0.413 Vali Loss: 1.251 Vali Acc: 0.607 Test Loss: 1.251 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.829272985458374
Epoch: 53, Steps: 2 | Train Loss: 0.424 Vali Loss: 1.243 Vali Acc: 0.619 Test Loss: 1.243 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.7165658473968506
Epoch: 54, Steps: 2 | Train Loss: 0.418 Vali Loss: 1.236 Vali Acc: 0.619 Test Loss: 1.236 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.926612377166748
Epoch: 55, Steps: 2 | Train Loss: 0.403 Vali Loss: 1.229 Vali Acc: 0.619 Test Loss: 1.229 Test Acc: 0.619
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.7802200317382812
Epoch: 56, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.221 Vali Acc: 0.622 Test Loss: 1.221 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 57 cost time: 0.8155248165130615
Epoch: 57, Steps: 2 | Train Loss: 0.362 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 58 cost time: 0.7797605991363525
Epoch: 58, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.206 Vali Acc: 0.622 Test Loss: 1.206 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 59 cost time: 0.6268279552459717
Epoch: 59, Steps: 2 | Train Loss: 0.343 Vali Loss: 1.199 Vali Acc: 0.622 Test Loss: 1.199 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 60 cost time: 0.7164092063903809
Epoch: 60, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.191 Vali Acc: 0.633 Test Loss: 1.191 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633321).  Saving model ...
Epoch: 61 cost time: 0.7074339389801025
Epoch: 61, Steps: 2 | Train Loss: 0.314 Vali Loss: 1.184 Vali Acc: 0.630 Test Loss: 1.184 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7984209060668945
Epoch: 62, Steps: 2 | Train Loss: 0.296 Vali Loss: 1.177 Vali Acc: 0.641 Test Loss: 1.177 Test Acc: 0.641
Validation loss decreased (-0.633321 --> -0.640729).  Saving model ...
Epoch: 63 cost time: 0.6804342269897461
Epoch: 63, Steps: 2 | Train Loss: 0.306 Vali Loss: 1.171 Vali Acc: 0.644 Test Loss: 1.171 Test Acc: 0.644
Validation loss decreased (-0.640729 --> -0.644433).  Saving model ...
Epoch: 64 cost time: 0.5948271751403809
Epoch: 64, Steps: 2 | Train Loss: 0.273 Vali Loss: 1.165 Vali Acc: 0.644 Test Loss: 1.165 Test Acc: 0.644
Validation loss decreased (-0.644433 --> -0.644433).  Saving model ...
Epoch: 65 cost time: 0.6144504547119141
Epoch: 65, Steps: 2 | Train Loss: 0.263 Vali Loss: 1.160 Vali Acc: 0.648 Test Loss: 1.160 Test Acc: 0.648
Validation loss decreased (-0.644433 --> -0.648137).  Saving model ...
Epoch: 66 cost time: 0.6027441024780273
Epoch: 66, Steps: 2 | Train Loss: 0.271 Vali Loss: 1.154 Vali Acc: 0.648 Test Loss: 1.154 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 67 cost time: 0.8398346900939941
Epoch: 67, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.149 Vali Acc: 0.648 Test Loss: 1.149 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 68 cost time: 0.6578109264373779
Epoch: 68, Steps: 2 | Train Loss: 0.246 Vali Loss: 1.144 Vali Acc: 0.648 Test Loss: 1.144 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 69 cost time: 0.7494103908538818
Epoch: 69, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.140 Vali Acc: 0.648 Test Loss: 1.140 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 70 cost time: 0.7123711109161377
Epoch: 70, Steps: 2 | Train Loss: 0.234 Vali Loss: 1.136 Vali Acc: 0.644 Test Loss: 1.136 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6770918369293213
Epoch: 71, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.130 Vali Acc: 0.652 Test Loss: 1.130 Test Acc: 0.652
Validation loss decreased (-0.648137 --> -0.651841).  Saving model ...
Epoch: 72 cost time: 0.7668237686157227
Epoch: 72, Steps: 2 | Train Loss: 0.223 Vali Loss: 1.126 Vali Acc: 0.656 Test Loss: 1.126 Test Acc: 0.656
Validation loss decreased (-0.651841 --> -0.655544).  Saving model ...
Epoch: 73 cost time: 0.7766478061676025
Epoch: 73, Steps: 2 | Train Loss: 0.203 Vali Loss: 1.122 Vali Acc: 0.652 Test Loss: 1.122 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9655020236968994
Epoch: 74, Steps: 2 | Train Loss: 0.200 Vali Loss: 1.117 Vali Acc: 0.652 Test Loss: 1.117 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7754626274108887
Epoch: 75, Steps: 2 | Train Loss: 0.198 Vali Loss: 1.112 Vali Acc: 0.656 Test Loss: 1.112 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 76 cost time: 0.7256205081939697
Epoch: 76, Steps: 2 | Train Loss: 0.179 Vali Loss: 1.107 Vali Acc: 0.652 Test Loss: 1.107 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7146012783050537
Epoch: 77, Steps: 2 | Train Loss: 0.197 Vali Loss: 1.103 Vali Acc: 0.656 Test Loss: 1.103 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 78 cost time: 0.6676180362701416
Epoch: 78, Steps: 2 | Train Loss: 0.169 Vali Loss: 1.098 Vali Acc: 0.659 Test Loss: 1.098 Test Acc: 0.659
Validation loss decreased (-0.655545 --> -0.659248).  Saving model ...
Epoch: 79 cost time: 0.6917431354522705
Epoch: 79, Steps: 2 | Train Loss: 0.174 Vali Loss: 1.093 Vali Acc: 0.656 Test Loss: 1.093 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.6772141456604004
Epoch: 80, Steps: 2 | Train Loss: 0.157 Vali Loss: 1.088 Vali Acc: 0.652 Test Loss: 1.088 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.8080658912658691
Epoch: 81, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.084 Vali Acc: 0.652 Test Loss: 1.084 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.8361196517944336
Epoch: 82, Steps: 2 | Train Loss: 0.149 Vali Loss: 1.081 Vali Acc: 0.656 Test Loss: 1.081 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.7061691284179688
Epoch: 83, Steps: 2 | Train Loss: 0.151 Vali Loss: 1.077 Vali Acc: 0.656 Test Loss: 1.077 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.8711607456207275
Epoch: 84, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.074 Vali Acc: 0.659 Test Loss: 1.074 Test Acc: 0.659
Validation loss decreased (-0.659248 --> -0.659249).  Saving model ...
Epoch: 85 cost time: 0.7361443042755127
Epoch: 85, Steps: 2 | Train Loss: 0.139 Vali Loss: 1.071 Vali Acc: 0.659 Test Loss: 1.071 Test Acc: 0.659
Validation loss decreased (-0.659249 --> -0.659249).  Saving model ...
Epoch: 86 cost time: 0.611931562423706
Epoch: 86, Steps: 2 | Train Loss: 0.127 Vali Loss: 1.067 Vali Acc: 0.659 Test Loss: 1.067 Test Acc: 0.659
Validation loss decreased (-0.659249 --> -0.659249).  Saving model ...
Epoch: 87 cost time: 0.7103621959686279
Epoch: 87, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.064 Vali Acc: 0.659 Test Loss: 1.064 Test Acc: 0.659
Validation loss decreased (-0.659249 --> -0.659249).  Saving model ...
Epoch: 88 cost time: 0.8102047443389893
Epoch: 88, Steps: 2 | Train Loss: 0.123 Vali Loss: 1.061 Vali Acc: 0.667 Test Loss: 1.061 Test Acc: 0.667
Validation loss decreased (-0.659249 --> -0.666656).  Saving model ...
Epoch: 89 cost time: 0.7633638381958008
Epoch: 89, Steps: 2 | Train Loss: 0.121 Vali Loss: 1.058 Vali Acc: 0.663 Test Loss: 1.058 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.740208625793457
Epoch: 90, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.056 Vali Acc: 0.667 Test Loss: 1.056 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 91 cost time: 0.7120749950408936
Epoch: 91, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.053 Vali Acc: 0.663 Test Loss: 1.053 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6852571964263916
Epoch: 92, Steps: 2 | Train Loss: 0.105 Vali Loss: 1.051 Vali Acc: 0.659 Test Loss: 1.051 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.6578969955444336
Epoch: 93, Steps: 2 | Train Loss: 0.105 Vali Loss: 1.048 Vali Acc: 0.656 Test Loss: 1.048 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.7544310092926025
Epoch: 94, Steps: 2 | Train Loss: 0.102 Vali Loss: 1.046 Vali Acc: 0.659 Test Loss: 1.046 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.7448279857635498
Epoch: 95, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.044 Vali Acc: 0.659 Test Loss: 1.044 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.8073849678039551
Epoch: 96, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.042 Vali Acc: 0.659 Test Loss: 1.042 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 1.0095689296722412
Epoch: 97, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.040 Vali Acc: 0.659 Test Loss: 1.040 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.8771612644195557
Epoch: 98, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.038 Vali Acc: 0.667 Test Loss: 1.038 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 99 cost time: 0.9012026786804199
Epoch: 99, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.036 Vali Acc: 0.667 Test Loss: 1.036 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 100 cost time: 0.6845808029174805
Epoch: 100, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.034 Vali Acc: 0.667 Test Loss: 1.034 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6666666666666666
model parameter : 140004
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.827319860458374
Epoch: 1, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.877 Vali Acc: 0.207 Test Loss: 1.877 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.68695068359375
Epoch: 2, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.869 Vali Acc: 0.211 Test Loss: 1.869 Test Acc: 0.211
Validation loss decreased (-0.207389 --> -0.211092).  Saving model ...
Epoch: 3 cost time: 0.953331708908081
Epoch: 3, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.864 Vali Acc: 0.222 Test Loss: 1.864 Test Acc: 0.222
Validation loss decreased (-0.211092 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.8571107387542725
Epoch: 4, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.857 Vali Acc: 0.226 Test Loss: 1.857 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225907).  Saving model ...
Epoch: 5 cost time: 0.6830155849456787
Epoch: 5, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.849 Vali Acc: 0.241 Test Loss: 1.849 Test Acc: 0.241
Validation loss decreased (-0.225907 --> -0.240722).  Saving model ...
Epoch: 6 cost time: 0.7022285461425781
Epoch: 6, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.840 Vali Acc: 0.241 Test Loss: 1.840 Test Acc: 0.241
Validation loss decreased (-0.240722 --> -0.240722).  Saving model ...
Epoch: 7 cost time: 0.6998865604400635
Epoch: 7, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.829 Vali Acc: 0.252 Test Loss: 1.829 Test Acc: 0.252
Validation loss decreased (-0.240722 --> -0.251834).  Saving model ...
Epoch: 8 cost time: 0.7961916923522949
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.818 Vali Acc: 0.259 Test Loss: 1.818 Test Acc: 0.259
Validation loss decreased (-0.251834 --> -0.259241).  Saving model ...
Epoch: 9 cost time: 0.778785228729248
Epoch: 9, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.805 Vali Acc: 0.263 Test Loss: 1.805 Test Acc: 0.263
Validation loss decreased (-0.259241 --> -0.262945).  Saving model ...
Epoch: 10 cost time: 0.8531744480133057
Epoch: 10, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.792 Vali Acc: 0.270 Test Loss: 1.792 Test Acc: 0.270
Validation loss decreased (-0.262945 --> -0.270352).  Saving model ...
Epoch: 11 cost time: 0.8698742389678955
Epoch: 11, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.777 Vali Acc: 0.270 Test Loss: 1.777 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270353).  Saving model ...
Epoch: 12 cost time: 1.1199848651885986
Epoch: 12, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.763 Vali Acc: 0.293 Test Loss: 1.763 Test Acc: 0.293
Validation loss decreased (-0.270353 --> -0.292575).  Saving model ...
Epoch: 13 cost time: 0.6583480834960938
Epoch: 13, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.748 Vali Acc: 0.293 Test Loss: 1.748 Test Acc: 0.293
Validation loss decreased (-0.292575 --> -0.292575).  Saving model ...
Epoch: 14 cost time: 0.7035133838653564
Epoch: 14, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.734 Vali Acc: 0.307 Test Loss: 1.734 Test Acc: 0.307
Validation loss decreased (-0.292575 --> -0.307390).  Saving model ...
Epoch: 15 cost time: 0.8052334785461426
Epoch: 15, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.718 Vali Acc: 0.333 Test Loss: 1.718 Test Acc: 0.333
Validation loss decreased (-0.307390 --> -0.333316).  Saving model ...
Epoch: 16 cost time: 0.7018835544586182
Epoch: 16, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.703 Vali Acc: 0.348 Test Loss: 1.703 Test Acc: 0.348
Validation loss decreased (-0.333316 --> -0.348131).  Saving model ...
Epoch: 17 cost time: 0.8177490234375
Epoch: 17, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.689 Vali Acc: 0.370 Test Loss: 1.689 Test Acc: 0.370
Validation loss decreased (-0.348131 --> -0.370353).  Saving model ...
Epoch: 18 cost time: 0.7375164031982422
Epoch: 18, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.674 Vali Acc: 0.389 Test Loss: 1.674 Test Acc: 0.389
Validation loss decreased (-0.370353 --> -0.388872).  Saving model ...
Epoch: 19 cost time: 0.8292577266693115
Epoch: 19, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.659 Vali Acc: 0.407 Test Loss: 1.659 Test Acc: 0.407
Validation loss decreased (-0.388872 --> -0.407391).  Saving model ...
Epoch: 20 cost time: 0.7202653884887695
Epoch: 20, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.644 Vali Acc: 0.430 Test Loss: 1.644 Test Acc: 0.430
Validation loss decreased (-0.407391 --> -0.429613).  Saving model ...
Epoch: 21 cost time: 0.917637825012207
Epoch: 21, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.629 Vali Acc: 0.430 Test Loss: 1.629 Test Acc: 0.430
Validation loss decreased (-0.429613 --> -0.429613).  Saving model ...
Epoch: 22 cost time: 0.656949520111084
Epoch: 22, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.614 Vali Acc: 0.448 Test Loss: 1.614 Test Acc: 0.448
Validation loss decreased (-0.429613 --> -0.448132).  Saving model ...
Epoch: 23 cost time: 0.8429121971130371
Epoch: 23, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.598 Vali Acc: 0.452 Test Loss: 1.598 Test Acc: 0.452
Validation loss decreased (-0.448132 --> -0.451836).  Saving model ...
Epoch: 24 cost time: 0.7194578647613525
Epoch: 24, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.580 Vali Acc: 0.463 Test Loss: 1.580 Test Acc: 0.463
Validation loss decreased (-0.451836 --> -0.462947).  Saving model ...
Epoch: 25 cost time: 0.6445894241333008
Epoch: 25, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.565 Vali Acc: 0.467 Test Loss: 1.565 Test Acc: 0.467
Validation loss decreased (-0.462947 --> -0.466651).  Saving model ...
Epoch: 26 cost time: 0.8460655212402344
Epoch: 26, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.549 Vali Acc: 0.485 Test Loss: 1.549 Test Acc: 0.485
Validation loss decreased (-0.466651 --> -0.485170).  Saving model ...
Epoch: 27 cost time: 1.0424516201019287
Epoch: 27, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.533 Vali Acc: 0.489 Test Loss: 1.533 Test Acc: 0.489
Validation loss decreased (-0.485170 --> -0.488874).  Saving model ...
Epoch: 28 cost time: 0.7330307960510254
Epoch: 28, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.516 Vali Acc: 0.511 Test Loss: 1.516 Test Acc: 0.511
Validation loss decreased (-0.488874 --> -0.511096).  Saving model ...
Epoch: 29 cost time: 0.6966903209686279
Epoch: 29, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.501 Vali Acc: 0.526 Test Loss: 1.501 Test Acc: 0.526
Validation loss decreased (-0.511096 --> -0.525911).  Saving model ...
Epoch: 30 cost time: 0.9868063926696777
Epoch: 30, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.487 Vali Acc: 0.530 Test Loss: 1.487 Test Acc: 0.530
Validation loss decreased (-0.525911 --> -0.529615).  Saving model ...
Epoch: 31 cost time: 0.8696660995483398
Epoch: 31, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.472 Vali Acc: 0.548 Test Loss: 1.472 Test Acc: 0.548
Validation loss decreased (-0.529615 --> -0.548133).  Saving model ...
Epoch: 32 cost time: 0.7631149291992188
Epoch: 32, Steps: 2 | Train Loss: 0.845 Vali Loss: 1.459 Vali Acc: 0.559 Test Loss: 1.459 Test Acc: 0.559
Validation loss decreased (-0.548133 --> -0.559245).  Saving model ...
Epoch: 33 cost time: 0.7293875217437744
Epoch: 33, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.446 Vali Acc: 0.559 Test Loss: 1.446 Test Acc: 0.559
Validation loss decreased (-0.559245 --> -0.559245).  Saving model ...
Epoch: 34 cost time: 0.870495080947876
Epoch: 34, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.433 Vali Acc: 0.556 Test Loss: 1.433 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7476348876953125
Epoch: 35, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.420 Vali Acc: 0.559 Test Loss: 1.420 Test Acc: 0.559
Validation loss decreased (-0.559245 --> -0.559245).  Saving model ...
Epoch: 36 cost time: 0.7346177101135254
Epoch: 36, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.408 Vali Acc: 0.563 Test Loss: 1.408 Test Acc: 0.563
Validation loss decreased (-0.559245 --> -0.562949).  Saving model ...
Epoch: 37 cost time: 0.7010447978973389
Epoch: 37, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.396 Vali Acc: 0.567 Test Loss: 1.396 Test Acc: 0.567
Validation loss decreased (-0.562949 --> -0.566653).  Saving model ...
Epoch: 38 cost time: 0.8304963111877441
Epoch: 38, Steps: 2 | Train Loss: 0.717 Vali Loss: 1.384 Vali Acc: 0.559 Test Loss: 1.384 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.976628303527832
Epoch: 39, Steps: 2 | Train Loss: 0.694 Vali Loss: 1.373 Vali Acc: 0.556 Test Loss: 1.373 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6664185523986816
Epoch: 40, Steps: 2 | Train Loss: 0.656 Vali Loss: 1.361 Vali Acc: 0.563 Test Loss: 1.361 Test Acc: 0.563
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9102146625518799
Epoch: 41, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.350 Vali Acc: 0.563 Test Loss: 1.350 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7303328514099121
Epoch: 42, Steps: 2 | Train Loss: 0.625 Vali Loss: 1.338 Vali Acc: 0.570 Test Loss: 1.338 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.570357).  Saving model ...
Epoch: 43 cost time: 0.8198115825653076
Epoch: 43, Steps: 2 | Train Loss: 0.599 Vali Loss: 1.326 Vali Acc: 0.574 Test Loss: 1.326 Test Acc: 0.574
Validation loss decreased (-0.570357 --> -0.574061).  Saving model ...
Epoch: 44 cost time: 0.8336150646209717
Epoch: 44, Steps: 2 | Train Loss: 0.565 Vali Loss: 1.315 Vali Acc: 0.589 Test Loss: 1.315 Test Acc: 0.589
Validation loss decreased (-0.574061 --> -0.588876).  Saving model ...
Epoch: 45 cost time: 1.0863032341003418
Epoch: 45, Steps: 2 | Train Loss: 0.538 Vali Loss: 1.304 Vali Acc: 0.585 Test Loss: 1.304 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9607260227203369
Epoch: 46, Steps: 2 | Train Loss: 0.538 Vali Loss: 1.293 Vali Acc: 0.585 Test Loss: 1.293 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9531369209289551
Epoch: 47, Steps: 2 | Train Loss: 0.526 Vali Loss: 1.282 Vali Acc: 0.593 Test Loss: 1.282 Test Acc: 0.593
Validation loss decreased (-0.588876 --> -0.592580).  Saving model ...
Epoch: 48 cost time: 0.7611100673675537
Epoch: 48, Steps: 2 | Train Loss: 0.513 Vali Loss: 1.272 Vali Acc: 0.607 Test Loss: 1.272 Test Acc: 0.607
Validation loss decreased (-0.592580 --> -0.607395).  Saving model ...
Epoch: 49 cost time: 0.8656909465789795
Epoch: 49, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.262 Vali Acc: 0.615 Test Loss: 1.262 Test Acc: 0.615
Validation loss decreased (-0.607395 --> -0.614802).  Saving model ...
Epoch: 50 cost time: 0.9464929103851318
Epoch: 50, Steps: 2 | Train Loss: 0.495 Vali Loss: 1.252 Vali Acc: 0.615 Test Loss: 1.252 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 51 cost time: 1.0127017498016357
Epoch: 51, Steps: 2 | Train Loss: 0.438 Vali Loss: 1.244 Vali Acc: 0.615 Test Loss: 1.244 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 52 cost time: 0.8417973518371582
Epoch: 52, Steps: 2 | Train Loss: 0.431 Vali Loss: 1.236 Vali Acc: 0.626 Test Loss: 1.236 Test Acc: 0.626
Validation loss decreased (-0.614802 --> -0.625914).  Saving model ...
Epoch: 53 cost time: 0.8684649467468262
Epoch: 53, Steps: 2 | Train Loss: 0.421 Vali Loss: 1.229 Vali Acc: 0.633 Test Loss: 1.229 Test Acc: 0.633
Validation loss decreased (-0.625914 --> -0.633321).  Saving model ...
Epoch: 54 cost time: 0.8062717914581299
Epoch: 54, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.221 Vali Acc: 0.630 Test Loss: 1.221 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8712503910064697
Epoch: 55, Steps: 2 | Train Loss: 0.399 Vali Loss: 1.214 Vali Acc: 0.637 Test Loss: 1.214 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.637025).  Saving model ...
Epoch: 56 cost time: 0.7815895080566406
Epoch: 56, Steps: 2 | Train Loss: 0.351 Vali Loss: 1.207 Vali Acc: 0.641 Test Loss: 1.207 Test Acc: 0.641
Validation loss decreased (-0.637025 --> -0.640729).  Saving model ...
Epoch: 57 cost time: 0.7815475463867188
Epoch: 57, Steps: 2 | Train Loss: 0.365 Vali Loss: 1.200 Vali Acc: 0.648 Test Loss: 1.200 Test Acc: 0.648
Validation loss decreased (-0.640729 --> -0.648136).  Saving model ...
Epoch: 58 cost time: 0.908240795135498
Epoch: 58, Steps: 2 | Train Loss: 0.356 Vali Loss: 1.193 Vali Acc: 0.652 Test Loss: 1.193 Test Acc: 0.652
Validation loss decreased (-0.648136 --> -0.651840).  Saving model ...
Epoch: 59 cost time: 0.8336696624755859
Epoch: 59, Steps: 2 | Train Loss: 0.351 Vali Loss: 1.186 Vali Acc: 0.656 Test Loss: 1.186 Test Acc: 0.656
Validation loss decreased (-0.651840 --> -0.655544).  Saving model ...
Epoch: 60 cost time: 0.9121146202087402
Epoch: 60, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.179 Vali Acc: 0.656 Test Loss: 1.179 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 61 cost time: 0.712317705154419
Epoch: 61, Steps: 2 | Train Loss: 0.326 Vali Loss: 1.174 Vali Acc: 0.659 Test Loss: 1.174 Test Acc: 0.659
Validation loss decreased (-0.655544 --> -0.659248).  Saving model ...
Epoch: 62 cost time: 1.139582633972168
Epoch: 62, Steps: 2 | Train Loss: 0.303 Vali Loss: 1.168 Vali Acc: 0.659 Test Loss: 1.168 Test Acc: 0.659
Validation loss decreased (-0.659248 --> -0.659248).  Saving model ...
Epoch: 63 cost time: 0.9305524826049805
Epoch: 63, Steps: 2 | Train Loss: 0.296 Vali Loss: 1.162 Vali Acc: 0.656 Test Loss: 1.162 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0049381256103516
Epoch: 64, Steps: 2 | Train Loss: 0.283 Vali Loss: 1.157 Vali Acc: 0.656 Test Loss: 1.157 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8334355354309082
Epoch: 65, Steps: 2 | Train Loss: 0.280 Vali Loss: 1.152 Vali Acc: 0.659 Test Loss: 1.152 Test Acc: 0.659
Validation loss decreased (-0.659248 --> -0.659248).  Saving model ...
Epoch: 66 cost time: 0.717167854309082
Epoch: 66, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.146 Vali Acc: 0.663 Test Loss: 1.146 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662951).  Saving model ...
Epoch: 67 cost time: 0.9295194149017334
Epoch: 67, Steps: 2 | Train Loss: 0.243 Vali Loss: 1.141 Vali Acc: 0.667 Test Loss: 1.141 Test Acc: 0.667
Validation loss decreased (-0.662951 --> -0.666655).  Saving model ...
Epoch: 68 cost time: 0.7948136329650879
Epoch: 68, Steps: 2 | Train Loss: 0.241 Vali Loss: 1.134 Vali Acc: 0.670 Test Loss: 1.134 Test Acc: 0.670
Validation loss decreased (-0.666655 --> -0.670359).  Saving model ...
Epoch: 69 cost time: 0.6669936180114746
Epoch: 69, Steps: 2 | Train Loss: 0.239 Vali Loss: 1.128 Vali Acc: 0.670 Test Loss: 1.128 Test Acc: 0.670
Validation loss decreased (-0.670359 --> -0.670359).  Saving model ...
Epoch: 70 cost time: 0.6967294216156006
Epoch: 70, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.122 Vali Acc: 0.670 Test Loss: 1.122 Test Acc: 0.670
Validation loss decreased (-0.670359 --> -0.670359).  Saving model ...
Epoch: 71 cost time: 0.7683632373809814
Epoch: 71, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.116 Vali Acc: 0.670 Test Loss: 1.116 Test Acc: 0.670
Validation loss decreased (-0.670359 --> -0.670359).  Saving model ...
Epoch: 72 cost time: 0.6799592971801758
Epoch: 72, Steps: 2 | Train Loss: 0.211 Vali Loss: 1.109 Vali Acc: 0.670 Test Loss: 1.109 Test Acc: 0.670
Validation loss decreased (-0.670359 --> -0.670359).  Saving model ...
Epoch: 73 cost time: 0.8338546752929688
Epoch: 73, Steps: 2 | Train Loss: 0.197 Vali Loss: 1.104 Vali Acc: 0.674 Test Loss: 1.104 Test Acc: 0.674
Validation loss decreased (-0.670359 --> -0.674063).  Saving model ...
Epoch: 74 cost time: 0.7515583038330078
Epoch: 74, Steps: 2 | Train Loss: 0.198 Vali Loss: 1.097 Vali Acc: 0.681 Test Loss: 1.097 Test Acc: 0.681
Validation loss decreased (-0.674063 --> -0.681471).  Saving model ...
Epoch: 75 cost time: 0.593618631362915
Epoch: 75, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.092 Vali Acc: 0.681 Test Loss: 1.092 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 76 cost time: 0.6167705059051514
Epoch: 76, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.087 Vali Acc: 0.681 Test Loss: 1.087 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 77 cost time: 0.8982326984405518
Epoch: 77, Steps: 2 | Train Loss: 0.177 Vali Loss: 1.082 Vali Acc: 0.685 Test Loss: 1.082 Test Acc: 0.685
Validation loss decreased (-0.681471 --> -0.685174).  Saving model ...
Epoch: 78 cost time: 0.7580215930938721
Epoch: 78, Steps: 2 | Train Loss: 0.154 Vali Loss: 1.076 Vali Acc: 0.681 Test Loss: 1.076 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6416120529174805
Epoch: 79, Steps: 2 | Train Loss: 0.157 Vali Loss: 1.071 Vali Acc: 0.681 Test Loss: 1.071 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.7894816398620605
Epoch: 80, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.065 Vali Acc: 0.681 Test Loss: 1.065 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.7729625701904297
Epoch: 81, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.060 Vali Acc: 0.681 Test Loss: 1.060 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.781564474105835
Epoch: 82, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.056 Vali Acc: 0.685 Test Loss: 1.056 Test Acc: 0.685
Validation loss decreased (-0.685174 --> -0.685175).  Saving model ...
Epoch: 83 cost time: 0.6074776649475098
Epoch: 83, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.052 Vali Acc: 0.685 Test Loss: 1.052 Test Acc: 0.685
Validation loss decreased (-0.685175 --> -0.685175).  Saving model ...
Epoch: 84 cost time: 0.6650044918060303
Epoch: 84, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.048 Vali Acc: 0.681 Test Loss: 1.048 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.8747367858886719
Epoch: 85, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.044 Vali Acc: 0.689 Test Loss: 1.044 Test Acc: 0.689
Validation loss decreased (-0.685175 --> -0.688878).  Saving model ...
Epoch: 86 cost time: 0.6056365966796875
Epoch: 86, Steps: 2 | Train Loss: 0.123 Vali Loss: 1.039 Vali Acc: 0.689 Test Loss: 1.039 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 87 cost time: 0.8871150016784668
Epoch: 87, Steps: 2 | Train Loss: 0.135 Vali Loss: 1.035 Vali Acc: 0.689 Test Loss: 1.035 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688879).  Saving model ...
Epoch: 88 cost time: 0.8622348308563232
Epoch: 88, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.031 Vali Acc: 0.689 Test Loss: 1.031 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688879).  Saving model ...
Epoch: 89 cost time: 0.7852258682250977
Epoch: 89, Steps: 2 | Train Loss: 0.112 Vali Loss: 1.025 Vali Acc: 0.696 Test Loss: 1.025 Test Acc: 0.696
Validation loss decreased (-0.688879 --> -0.696286).  Saving model ...
Epoch: 90 cost time: 0.9775378704071045
Epoch: 90, Steps: 2 | Train Loss: 0.114 Vali Loss: 1.021 Vali Acc: 0.696 Test Loss: 1.021 Test Acc: 0.696
Validation loss decreased (-0.696286 --> -0.696286).  Saving model ...
Epoch: 91 cost time: 1.101180076599121
Epoch: 91, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.017 Vali Acc: 0.696 Test Loss: 1.017 Test Acc: 0.696
Validation loss decreased (-0.696286 --> -0.696286).  Saving model ...
Epoch: 92 cost time: 0.8583283424377441
Epoch: 92, Steps: 2 | Train Loss: 0.105 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.696286 --> -0.699990).  Saving model ...
Epoch: 93 cost time: 0.8802280426025391
Epoch: 93, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 94 cost time: 0.6380093097686768
Epoch: 94, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.005 Vali Acc: 0.704 Test Loss: 1.005 Test Acc: 0.704
Validation loss decreased (-0.699990 --> -0.703694).  Saving model ...
Epoch: 95 cost time: 0.9555511474609375
Epoch: 95, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.002 Vali Acc: 0.707 Test Loss: 1.002 Test Acc: 0.707
Validation loss decreased (-0.703694 --> -0.707397).  Saving model ...
Epoch: 96 cost time: 0.751166820526123
Epoch: 96, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.999 Vali Acc: 0.707 Test Loss: 0.999 Test Acc: 0.707
Validation loss decreased (-0.707397 --> -0.707397).  Saving model ...
Epoch: 97 cost time: 0.7897298336029053
Epoch: 97, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.996 Vali Acc: 0.707 Test Loss: 0.996 Test Acc: 0.707
Validation loss decreased (-0.707397 --> -0.707397).  Saving model ...
Epoch: 98 cost time: 0.8938539028167725
Epoch: 98, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.993 Vali Acc: 0.711 Test Loss: 0.993 Test Acc: 0.711
Validation loss decreased (-0.707397 --> -0.711101).  Saving model ...
Epoch: 99 cost time: 0.9810316562652588
Epoch: 99, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.990 Vali Acc: 0.707 Test Loss: 0.990 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.0362656116485596
Epoch: 100, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.987 Vali Acc: 0.711 Test Loss: 0.987 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7111111111111111
model parameter : 138980
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.763293504714966
Epoch: 1, Steps: 2 | Train Loss: 2.002 Vali Loss: 1.959 Vali Acc: 0.167 Test Loss: 1.959 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.7163243293762207
Epoch: 2, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.951 Vali Acc: 0.174 Test Loss: 1.951 Test Acc: 0.174
Validation loss decreased (-0.166647 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.8506522178649902
Epoch: 3, Steps: 2 | Train Loss: 1.943 Vali Loss: 1.944 Vali Acc: 0.174 Test Loss: 1.944 Test Acc: 0.174
Validation loss decreased (-0.174055 --> -0.174055).  Saving model ...
Epoch: 4 cost time: 0.6178305149078369
Epoch: 4, Steps: 2 | Train Loss: 1.993 Vali Loss: 1.937 Vali Acc: 0.178 Test Loss: 1.937 Test Acc: 0.178
Validation loss decreased (-0.174055 --> -0.177758).  Saving model ...
Epoch: 5 cost time: 0.7510154247283936
Epoch: 5, Steps: 2 | Train Loss: 1.951 Vali Loss: 1.926 Vali Acc: 0.181 Test Loss: 1.926 Test Acc: 0.181
Validation loss decreased (-0.177758 --> -0.181462).  Saving model ...
Epoch: 6 cost time: 0.7168903350830078
Epoch: 6, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.914 Vali Acc: 0.181 Test Loss: 1.914 Test Acc: 0.181
Validation loss decreased (-0.181462 --> -0.181462).  Saving model ...
Epoch: 7 cost time: 0.8477475643157959
Epoch: 7, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.900 Vali Acc: 0.193 Test Loss: 1.900 Test Acc: 0.193
Validation loss decreased (-0.181462 --> -0.192574).  Saving model ...
Epoch: 8 cost time: 0.6641592979431152
Epoch: 8, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.886 Vali Acc: 0.204 Test Loss: 1.886 Test Acc: 0.204
Validation loss decreased (-0.192574 --> -0.203685).  Saving model ...
Epoch: 9 cost time: 0.8072342872619629
Epoch: 9, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.870 Vali Acc: 0.207 Test Loss: 1.870 Test Acc: 0.207
Validation loss decreased (-0.203685 --> -0.207389).  Saving model ...
Epoch: 10 cost time: 0.8420374393463135
Epoch: 10, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.853 Vali Acc: 0.219 Test Loss: 1.853 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218500).  Saving model ...
Epoch: 11 cost time: 0.8387794494628906
Epoch: 11, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.836 Vali Acc: 0.222 Test Loss: 1.836 Test Acc: 0.222
Validation loss decreased (-0.218500 --> -0.222204).  Saving model ...
Epoch: 12 cost time: 0.8031785488128662
Epoch: 12, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.818 Vali Acc: 0.226 Test Loss: 1.818 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 13 cost time: 0.6410903930664062
Epoch: 13, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.799 Vali Acc: 0.230 Test Loss: 1.799 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 14 cost time: 0.7348840236663818
Epoch: 14, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.780 Vali Acc: 0.252 Test Loss: 1.780 Test Acc: 0.252
Validation loss decreased (-0.229612 --> -0.251834).  Saving model ...
Epoch: 15 cost time: 0.7250287532806396
Epoch: 15, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.762 Vali Acc: 0.256 Test Loss: 1.762 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 16 cost time: 0.6152637004852295
Epoch: 16, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.743 Vali Acc: 0.270 Test Loss: 1.743 Test Acc: 0.270
Validation loss decreased (-0.255538 --> -0.270353).  Saving model ...
Epoch: 17 cost time: 0.7671773433685303
Epoch: 17, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.724 Vali Acc: 0.293 Test Loss: 1.724 Test Acc: 0.293
Validation loss decreased (-0.270353 --> -0.292575).  Saving model ...
Epoch: 18 cost time: 0.8994755744934082
Epoch: 18, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.705 Vali Acc: 0.304 Test Loss: 1.705 Test Acc: 0.304
Validation loss decreased (-0.292575 --> -0.303687).  Saving model ...
Epoch: 19 cost time: 0.6365466117858887
Epoch: 19, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.685 Vali Acc: 0.344 Test Loss: 1.685 Test Acc: 0.344
Validation loss decreased (-0.303687 --> -0.344428).  Saving model ...
Epoch: 20 cost time: 0.6016371250152588
Epoch: 20, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.666 Vali Acc: 0.348 Test Loss: 1.666 Test Acc: 0.348
Validation loss decreased (-0.344428 --> -0.348131).  Saving model ...
Epoch: 21 cost time: 0.8450064659118652
Epoch: 21, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.647 Vali Acc: 0.367 Test Loss: 1.647 Test Acc: 0.367
Validation loss decreased (-0.348131 --> -0.366650).  Saving model ...
Epoch: 22 cost time: 0.7418079376220703
Epoch: 22, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.627 Vali Acc: 0.396 Test Loss: 1.627 Test Acc: 0.396
Validation loss decreased (-0.366650 --> -0.396280).  Saving model ...
Epoch: 23 cost time: 0.7251076698303223
Epoch: 23, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.608 Vali Acc: 0.419 Test Loss: 1.608 Test Acc: 0.419
Validation loss decreased (-0.396280 --> -0.418502).  Saving model ...
Epoch: 24 cost time: 0.7092506885528564
Epoch: 24, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.589 Vali Acc: 0.470 Test Loss: 1.589 Test Acc: 0.470
Validation loss decreased (-0.418502 --> -0.470354).  Saving model ...
Epoch: 25 cost time: 0.7776920795440674
Epoch: 25, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.569 Vali Acc: 0.507 Test Loss: 1.569 Test Acc: 0.507
Validation loss decreased (-0.470354 --> -0.507392).  Saving model ...
Epoch: 26 cost time: 0.6488945484161377
Epoch: 26, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.550 Vali Acc: 0.515 Test Loss: 1.550 Test Acc: 0.515
Validation loss decreased (-0.507392 --> -0.514799).  Saving model ...
Epoch: 27 cost time: 0.643965482711792
Epoch: 27, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.531 Vali Acc: 0.556 Test Loss: 1.531 Test Acc: 0.556
Validation loss decreased (-0.514799 --> -0.555540).  Saving model ...
Epoch: 28 cost time: 0.7370023727416992
Epoch: 28, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.513 Vali Acc: 0.567 Test Loss: 1.513 Test Acc: 0.567
Validation loss decreased (-0.555540 --> -0.566652).  Saving model ...
Epoch: 29 cost time: 0.6746861934661865
Epoch: 29, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.495 Vali Acc: 0.585 Test Loss: 1.495 Test Acc: 0.585
Validation loss decreased (-0.566652 --> -0.585170).  Saving model ...
Epoch: 30 cost time: 0.6435811519622803
Epoch: 30, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.477 Vali Acc: 0.604 Test Loss: 1.477 Test Acc: 0.604
Validation loss decreased (-0.585170 --> -0.603689).  Saving model ...
Epoch: 31 cost time: 0.6466875076293945
Epoch: 31, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.460 Vali Acc: 0.626 Test Loss: 1.460 Test Acc: 0.626
Validation loss decreased (-0.603689 --> -0.625911).  Saving model ...
Epoch: 32 cost time: 0.6504020690917969
Epoch: 32, Steps: 2 | Train Loss: 0.867 Vali Loss: 1.443 Vali Acc: 0.630 Test Loss: 1.443 Test Acc: 0.630
Validation loss decreased (-0.625911 --> -0.629615).  Saving model ...
Epoch: 33 cost time: 0.6683611869812012
Epoch: 33, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.427 Vali Acc: 0.637 Test Loss: 1.427 Test Acc: 0.637
Validation loss decreased (-0.629615 --> -0.637023).  Saving model ...
Epoch: 34 cost time: 0.7262485027313232
Epoch: 34, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.410 Vali Acc: 0.648 Test Loss: 1.410 Test Acc: 0.648
Validation loss decreased (-0.637023 --> -0.648134).  Saving model ...
Epoch: 35 cost time: 0.722804069519043
Epoch: 35, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.394 Vali Acc: 0.663 Test Loss: 1.394 Test Acc: 0.663
Validation loss decreased (-0.648134 --> -0.662949).  Saving model ...
Epoch: 36 cost time: 0.6497788429260254
Epoch: 36, Steps: 2 | Train Loss: 0.752 Vali Loss: 1.378 Vali Acc: 0.678 Test Loss: 1.378 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 37 cost time: 0.6737172603607178
Epoch: 37, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.362 Vali Acc: 0.693 Test Loss: 1.362 Test Acc: 0.693
Validation loss decreased (-0.677764 --> -0.692579).  Saving model ...
Epoch: 38 cost time: 0.6318337917327881
Epoch: 38, Steps: 2 | Train Loss: 0.709 Vali Loss: 1.347 Vali Acc: 0.693 Test Loss: 1.347 Test Acc: 0.693
Validation loss decreased (-0.692579 --> -0.692579).  Saving model ...
Epoch: 39 cost time: 1.1129696369171143
Epoch: 39, Steps: 2 | Train Loss: 0.675 Vali Loss: 1.332 Vali Acc: 0.693 Test Loss: 1.332 Test Acc: 0.693
Validation loss decreased (-0.692579 --> -0.692579).  Saving model ...
Epoch: 40 cost time: 0.6729440689086914
Epoch: 40, Steps: 2 | Train Loss: 0.649 Vali Loss: 1.316 Vali Acc: 0.696 Test Loss: 1.316 Test Acc: 0.696
Validation loss decreased (-0.692579 --> -0.696283).  Saving model ...
Epoch: 41 cost time: 0.8213286399841309
Epoch: 41, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.301 Vali Acc: 0.704 Test Loss: 1.301 Test Acc: 0.704
Validation loss decreased (-0.696283 --> -0.703691).  Saving model ...
Epoch: 42 cost time: 0.8167576789855957
Epoch: 42, Steps: 2 | Train Loss: 0.621 Vali Loss: 1.286 Vali Acc: 0.700 Test Loss: 1.286 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7677497863769531
Epoch: 43, Steps: 2 | Train Loss: 0.601 Vali Loss: 1.272 Vali Acc: 0.704 Test Loss: 1.272 Test Acc: 0.704
Validation loss decreased (-0.703691 --> -0.703691).  Saving model ...
Epoch: 44 cost time: 0.619797945022583
Epoch: 44, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.258 Vali Acc: 0.704 Test Loss: 1.258 Test Acc: 0.704
Validation loss decreased (-0.703691 --> -0.703691).  Saving model ...
Epoch: 45 cost time: 0.759484052658081
Epoch: 45, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.244 Vali Acc: 0.704 Test Loss: 1.244 Test Acc: 0.704
Validation loss decreased (-0.703691 --> -0.703691).  Saving model ...
Epoch: 46 cost time: 0.8794217109680176
Epoch: 46, Steps: 2 | Train Loss: 0.495 Vali Loss: 1.230 Vali Acc: 0.711 Test Loss: 1.230 Test Acc: 0.711
Validation loss decreased (-0.703691 --> -0.711099).  Saving model ...
Epoch: 47 cost time: 0.8769774436950684
Epoch: 47, Steps: 2 | Train Loss: 0.518 Vali Loss: 1.218 Vali Acc: 0.711 Test Loss: 1.218 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711099).  Saving model ...
Epoch: 48 cost time: 0.7539315223693848
Epoch: 48, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.207 Vali Acc: 0.711 Test Loss: 1.207 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711099).  Saving model ...
Epoch: 49 cost time: 0.6974220275878906
Epoch: 49, Steps: 2 | Train Loss: 0.451 Vali Loss: 1.196 Vali Acc: 0.711 Test Loss: 1.196 Test Acc: 0.711
Validation loss decreased (-0.711099 --> -0.711099).  Saving model ...
Epoch: 50 cost time: 0.9504244327545166
Epoch: 50, Steps: 2 | Train Loss: 0.427 Vali Loss: 1.186 Vali Acc: 0.715 Test Loss: 1.186 Test Acc: 0.715
Validation loss decreased (-0.711099 --> -0.714803).  Saving model ...
Epoch: 51 cost time: 0.740138053894043
Epoch: 51, Steps: 2 | Train Loss: 0.410 Vali Loss: 1.176 Vali Acc: 0.711 Test Loss: 1.176 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6611819267272949
Epoch: 52, Steps: 2 | Train Loss: 0.450 Vali Loss: 1.166 Vali Acc: 0.707 Test Loss: 1.166 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7346100807189941
Epoch: 53, Steps: 2 | Train Loss: 0.381 Vali Loss: 1.157 Vali Acc: 0.719 Test Loss: 1.157 Test Acc: 0.719
Validation loss decreased (-0.714803 --> -0.718507).  Saving model ...
Epoch: 54 cost time: 0.8931229114532471
Epoch: 54, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.147 Vali Acc: 0.719 Test Loss: 1.147 Test Acc: 0.719
Validation loss decreased (-0.718507 --> -0.718507).  Saving model ...
Epoch: 55 cost time: 0.9355957508087158
Epoch: 55, Steps: 2 | Train Loss: 0.370 Vali Loss: 1.138 Vali Acc: 0.722 Test Loss: 1.138 Test Acc: 0.722
Validation loss decreased (-0.718507 --> -0.722211).  Saving model ...
Epoch: 56 cost time: 0.8391110897064209
Epoch: 56, Steps: 2 | Train Loss: 0.339 Vali Loss: 1.128 Vali Acc: 0.722 Test Loss: 1.128 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722211).  Saving model ...
Epoch: 57 cost time: 0.667017936706543
Epoch: 57, Steps: 2 | Train Loss: 0.313 Vali Loss: 1.120 Vali Acc: 0.726 Test Loss: 1.120 Test Acc: 0.726
Validation loss decreased (-0.722211 --> -0.725915).  Saving model ...
Epoch: 58 cost time: 0.9497666358947754
Epoch: 58, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.111 Vali Acc: 0.726 Test Loss: 1.111 Test Acc: 0.726
Validation loss decreased (-0.725915 --> -0.725915).  Saving model ...
Epoch: 59 cost time: 1.0685534477233887
Epoch: 59, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.104 Vali Acc: 0.726 Test Loss: 1.104 Test Acc: 0.726
Validation loss decreased (-0.725915 --> -0.725915).  Saving model ...
Epoch: 60 cost time: 0.7902781963348389
Epoch: 60, Steps: 2 | Train Loss: 0.297 Vali Loss: 1.097 Vali Acc: 0.726 Test Loss: 1.097 Test Acc: 0.726
Validation loss decreased (-0.725915 --> -0.725915).  Saving model ...
Epoch: 61 cost time: 0.7895410060882568
Epoch: 61, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.091 Vali Acc: 0.726 Test Loss: 1.091 Test Acc: 0.726
Validation loss decreased (-0.725915 --> -0.725915).  Saving model ...
Epoch: 62 cost time: 0.6644322872161865
Epoch: 62, Steps: 2 | Train Loss: 0.268 Vali Loss: 1.084 Vali Acc: 0.730 Test Loss: 1.084 Test Acc: 0.730
Validation loss decreased (-0.725915 --> -0.729619).  Saving model ...
Epoch: 63 cost time: 0.7140839099884033
Epoch: 63, Steps: 2 | Train Loss: 0.266 Vali Loss: 1.077 Vali Acc: 0.730 Test Loss: 1.077 Test Acc: 0.730
Validation loss decreased (-0.729619 --> -0.729619).  Saving model ...
Epoch: 64 cost time: 0.7625081539154053
Epoch: 64, Steps: 2 | Train Loss: 0.253 Vali Loss: 1.071 Vali Acc: 0.730 Test Loss: 1.071 Test Acc: 0.730
Validation loss decreased (-0.729619 --> -0.729619).  Saving model ...
Epoch: 65 cost time: 0.8050429821014404
Epoch: 65, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.064 Vali Acc: 0.733 Test Loss: 1.064 Test Acc: 0.733
Validation loss decreased (-0.729619 --> -0.733323).  Saving model ...
Epoch: 66 cost time: 0.8397765159606934
Epoch: 66, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.058 Vali Acc: 0.733 Test Loss: 1.058 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 67 cost time: 0.8869855403900146
Epoch: 67, Steps: 2 | Train Loss: 0.224 Vali Loss: 1.052 Vali Acc: 0.733 Test Loss: 1.052 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 68 cost time: 0.8777523040771484
Epoch: 68, Steps: 2 | Train Loss: 0.207 Vali Loss: 1.046 Vali Acc: 0.737 Test Loss: 1.046 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.737027).  Saving model ...
Epoch: 69 cost time: 0.7999391555786133
Epoch: 69, Steps: 2 | Train Loss: 0.217 Vali Loss: 1.040 Vali Acc: 0.733 Test Loss: 1.040 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.019376516342163
Epoch: 70, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.035 Vali Acc: 0.737 Test Loss: 1.035 Test Acc: 0.737
Validation loss decreased (-0.737027 --> -0.737027).  Saving model ...
Epoch: 71 cost time: 0.6545917987823486
Epoch: 71, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.029 Vali Acc: 0.733 Test Loss: 1.029 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7703862190246582
Epoch: 72, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.024 Vali Acc: 0.722 Test Loss: 1.024 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7743299007415771
Epoch: 73, Steps: 2 | Train Loss: 0.176 Vali Loss: 1.019 Vali Acc: 0.722 Test Loss: 1.019 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.891179084777832
Epoch: 74, Steps: 2 | Train Loss: 0.175 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.810314416885376
Epoch: 75, Steps: 2 | Train Loss: 0.179 Vali Loss: 1.010 Vali Acc: 0.722 Test Loss: 1.010 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.1695024967193604
Epoch: 76, Steps: 2 | Train Loss: 0.173 Vali Loss: 1.005 Vali Acc: 0.726 Test Loss: 1.005 Test Acc: 0.726
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.7065508365631104
Epoch: 77, Steps: 2 | Train Loss: 0.162 Vali Loss: 1.001 Vali Acc: 0.722 Test Loss: 1.001 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.7479918003082275
Epoch: 78, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.996 Vali Acc: 0.722 Test Loss: 0.996 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.942866325378418
Epoch: 79, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.992 Vali Acc: 0.726 Test Loss: 0.992 Test Acc: 0.726
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.7570254802703857
Epoch: 80, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.988 Vali Acc: 0.730 Test Loss: 0.988 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.737037037037037
model parameter : 136932
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8293864727020264
Epoch: 1, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.867 Vali Acc: 0.178 Test Loss: 1.867 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.8425264358520508
Epoch: 2, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.860 Vali Acc: 0.185 Test Loss: 1.860 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.8960342407226562
Epoch: 3, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.853 Vali Acc: 0.193 Test Loss: 1.853 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192574).  Saving model ...
Epoch: 4 cost time: 0.7129321098327637
Epoch: 4, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.844 Vali Acc: 0.193 Test Loss: 1.844 Test Acc: 0.193
Validation loss decreased (-0.192574 --> -0.192574).  Saving model ...
Epoch: 5 cost time: 0.7266745567321777
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.833 Vali Acc: 0.200 Test Loss: 1.833 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.8362109661102295
Epoch: 6, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.820 Vali Acc: 0.200 Test Loss: 1.820 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 0.6654620170593262
Epoch: 7, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.806 Vali Acc: 0.200 Test Loss: 1.806 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 8 cost time: 0.7689628601074219
Epoch: 8, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.790 Vali Acc: 0.204 Test Loss: 1.790 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 9 cost time: 0.763554573059082
Epoch: 9, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.773 Vali Acc: 0.215 Test Loss: 1.773 Test Acc: 0.215
Validation loss decreased (-0.203686 --> -0.214797).  Saving model ...
Epoch: 10 cost time: 0.7656843662261963
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.756 Vali Acc: 0.226 Test Loss: 1.756 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225908).  Saving model ...
Epoch: 11 cost time: 0.6728246212005615
Epoch: 11, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.737 Vali Acc: 0.248 Test Loss: 1.737 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248131).  Saving model ...
Epoch: 12 cost time: 0.7702155113220215
Epoch: 12, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.718 Vali Acc: 0.267 Test Loss: 1.718 Test Acc: 0.267
Validation loss decreased (-0.248131 --> -0.266649).  Saving model ...
Epoch: 13 cost time: 0.6773641109466553
Epoch: 13, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.698 Vali Acc: 0.281 Test Loss: 1.698 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281465).  Saving model ...
Epoch: 14 cost time: 0.7328050136566162
Epoch: 14, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.677 Vali Acc: 0.296 Test Loss: 1.677 Test Acc: 0.296
Validation loss decreased (-0.281465 --> -0.296280).  Saving model ...
Epoch: 15 cost time: 0.8637797832489014
Epoch: 15, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.656 Vali Acc: 0.326 Test Loss: 1.656 Test Acc: 0.326
Validation loss decreased (-0.296280 --> -0.325909).  Saving model ...
Epoch: 16 cost time: 0.604529619216919
Epoch: 16, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.635 Vali Acc: 0.356 Test Loss: 1.635 Test Acc: 0.356
Validation loss decreased (-0.325909 --> -0.355539).  Saving model ...
Epoch: 17 cost time: 0.8994991779327393
Epoch: 17, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.613 Vali Acc: 0.370 Test Loss: 1.613 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 18 cost time: 0.7398645877838135
Epoch: 18, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.592 Vali Acc: 0.396 Test Loss: 1.592 Test Acc: 0.396
Validation loss decreased (-0.370354 --> -0.396280).  Saving model ...
Epoch: 19 cost time: 0.8061015605926514
Epoch: 19, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.570 Vali Acc: 0.411 Test Loss: 1.570 Test Acc: 0.411
Validation loss decreased (-0.396280 --> -0.411095).  Saving model ...
Epoch: 20 cost time: 0.9067723751068115
Epoch: 20, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.548 Vali Acc: 0.448 Test Loss: 1.548 Test Acc: 0.448
Validation loss decreased (-0.411095 --> -0.448133).  Saving model ...
Epoch: 21 cost time: 0.8195934295654297
Epoch: 21, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.527 Vali Acc: 0.470 Test Loss: 1.527 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 22 cost time: 0.75016188621521
Epoch: 22, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
Validation loss decreased (-0.470355 --> -0.499985).  Saving model ...
Epoch: 23 cost time: 0.839848518371582
Epoch: 23, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.484 Vali Acc: 0.519 Test Loss: 1.484 Test Acc: 0.519
Validation loss decreased (-0.499985 --> -0.518504).  Saving model ...
Epoch: 24 cost time: 0.7182345390319824
Epoch: 24, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.463 Vali Acc: 0.537 Test Loss: 1.463 Test Acc: 0.537
Validation loss decreased (-0.518504 --> -0.537022).  Saving model ...
Epoch: 25 cost time: 0.6540951728820801
Epoch: 25, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.443 Vali Acc: 0.559 Test Loss: 1.443 Test Acc: 0.559
Validation loss decreased (-0.537022 --> -0.559245).  Saving model ...
Epoch: 26 cost time: 0.7966773509979248
Epoch: 26, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.422 Vali Acc: 0.600 Test Loss: 1.422 Test Acc: 0.600
Validation loss decreased (-0.559245 --> -0.599986).  Saving model ...
Epoch: 27 cost time: 0.8385581970214844
Epoch: 27, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.402 Vali Acc: 0.615 Test Loss: 1.402 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614801).  Saving model ...
Epoch: 28 cost time: 0.8336596488952637
Epoch: 28, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.382 Vali Acc: 0.641 Test Loss: 1.382 Test Acc: 0.641
Validation loss decreased (-0.614801 --> -0.640727).  Saving model ...
Epoch: 29 cost time: 0.7345857620239258
Epoch: 29, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.363 Vali Acc: 0.663 Test Loss: 1.363 Test Acc: 0.663
Validation loss decreased (-0.640727 --> -0.662949).  Saving model ...
Epoch: 30 cost time: 0.6741220951080322
Epoch: 30, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.344 Vali Acc: 0.678 Test Loss: 1.344 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 31 cost time: 0.6287896633148193
Epoch: 31, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.325 Vali Acc: 0.689 Test Loss: 1.325 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 32 cost time: 0.7121365070343018
Epoch: 32, Steps: 2 | Train Loss: 0.872 Vali Loss: 1.307 Vali Acc: 0.707 Test Loss: 1.307 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707394).  Saving model ...
Epoch: 33 cost time: 0.7896966934204102
Epoch: 33, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.289 Vali Acc: 0.707 Test Loss: 1.289 Test Acc: 0.707
Validation loss decreased (-0.707394 --> -0.707395).  Saving model ...
Epoch: 34 cost time: 0.7794020175933838
Epoch: 34, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.271 Vali Acc: 0.719 Test Loss: 1.271 Test Acc: 0.719
Validation loss decreased (-0.707395 --> -0.718506).  Saving model ...
Epoch: 35 cost time: 0.8221428394317627
Epoch: 35, Steps: 2 | Train Loss: 0.772 Vali Loss: 1.253 Vali Acc: 0.715 Test Loss: 1.253 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7492036819458008
Epoch: 36, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.237 Vali Acc: 0.733 Test Loss: 1.237 Test Acc: 0.733
Validation loss decreased (-0.718506 --> -0.733321).  Saving model ...
Epoch: 37 cost time: 0.6632559299468994
Epoch: 37, Steps: 2 | Train Loss: 0.718 Vali Loss: 1.220 Vali Acc: 0.737 Test Loss: 1.220 Test Acc: 0.737
Validation loss decreased (-0.733321 --> -0.737025).  Saving model ...
Epoch: 38 cost time: 0.8050968647003174
Epoch: 38, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.204 Vali Acc: 0.741 Test Loss: 1.204 Test Acc: 0.741
Validation loss decreased (-0.737025 --> -0.740729).  Saving model ...
Epoch: 39 cost time: 0.8219127655029297
Epoch: 39, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.189 Vali Acc: 0.741 Test Loss: 1.189 Test Acc: 0.741
Validation loss decreased (-0.740729 --> -0.740729).  Saving model ...
Epoch: 40 cost time: 0.8017997741699219
Epoch: 40, Steps: 2 | Train Loss: 0.655 Vali Loss: 1.174 Vali Acc: 0.752 Test Loss: 1.174 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751840).  Saving model ...
Epoch: 41 cost time: 0.6133747100830078
Epoch: 41, Steps: 2 | Train Loss: 0.626 Vali Loss: 1.159 Vali Acc: 0.748 Test Loss: 1.159 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7301275730133057
Epoch: 42, Steps: 2 | Train Loss: 0.588 Vali Loss: 1.145 Vali Acc: 0.744 Test Loss: 1.145 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7390811443328857
Epoch: 43, Steps: 2 | Train Loss: 0.593 Vali Loss: 1.130 Vali Acc: 0.744 Test Loss: 1.130 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7636644840240479
Epoch: 44, Steps: 2 | Train Loss: 0.568 Vali Loss: 1.117 Vali Acc: 0.744 Test Loss: 1.117 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6820352077484131
Epoch: 45, Steps: 2 | Train Loss: 0.508 Vali Loss: 1.103 Vali Acc: 0.748 Test Loss: 1.103 Test Acc: 0.748
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8238825798034668
Epoch: 46, Steps: 2 | Train Loss: 0.497 Vali Loss: 1.090 Vali Acc: 0.752 Test Loss: 1.090 Test Acc: 0.752
Validation loss decreased (-0.751840 --> -0.751841).  Saving model ...
Epoch: 47 cost time: 0.845780611038208
Epoch: 47, Steps: 2 | Train Loss: 0.467 Vali Loss: 1.078 Vali Acc: 0.752 Test Loss: 1.078 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751841).  Saving model ...
Epoch: 48 cost time: 0.8224811553955078
Epoch: 48, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.066 Vali Acc: 0.752 Test Loss: 1.066 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751841).  Saving model ...
Epoch: 49 cost time: 0.7010836601257324
Epoch: 49, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.054 Vali Acc: 0.748 Test Loss: 1.054 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8211431503295898
Epoch: 50, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.043 Vali Acc: 0.752 Test Loss: 1.043 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751841).  Saving model ...
Epoch: 51 cost time: 1.0405006408691406
Epoch: 51, Steps: 2 | Train Loss: 0.402 Vali Loss: 1.032 Vali Acc: 0.752 Test Loss: 1.032 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751842).  Saving model ...
Epoch: 52 cost time: 0.8793954849243164
Epoch: 52, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.022 Vali Acc: 0.756 Test Loss: 1.022 Test Acc: 0.756
Validation loss decreased (-0.751842 --> -0.755545).  Saving model ...
Epoch: 53 cost time: 0.7741334438323975
Epoch: 53, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.011 Vali Acc: 0.767 Test Loss: 1.011 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766657).  Saving model ...
Epoch: 54 cost time: 0.7201611995697021
Epoch: 54, Steps: 2 | Train Loss: 0.366 Vali Loss: 1.002 Vali Acc: 0.770 Test Loss: 1.002 Test Acc: 0.770
Validation loss decreased (-0.766657 --> -0.770360).  Saving model ...
Epoch: 55 cost time: 0.9833076000213623
Epoch: 55, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.992 Vali Acc: 0.767 Test Loss: 0.992 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9091932773590088
Epoch: 56, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.983 Vali Acc: 0.767 Test Loss: 0.983 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.112459659576416
Epoch: 57, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.974 Vali Acc: 0.774 Test Loss: 0.974 Test Acc: 0.774
Validation loss decreased (-0.770360 --> -0.774064).  Saving model ...
Epoch: 58 cost time: 1.0641958713531494
Epoch: 58, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.966 Vali Acc: 0.770 Test Loss: 0.966 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.917424201965332
Epoch: 59, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.958 Vali Acc: 0.774 Test Loss: 0.958 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 60 cost time: 0.8804230690002441
Epoch: 60, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.950 Vali Acc: 0.778 Test Loss: 0.950 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 61 cost time: 0.6395950317382812
Epoch: 61, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.942 Vali Acc: 0.778 Test Loss: 0.942 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777768).  Saving model ...
Epoch: 62 cost time: 1.1136820316314697
Epoch: 62, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.935 Vali Acc: 0.778 Test Loss: 0.935 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777768).  Saving model ...
Epoch: 63 cost time: 0.7075300216674805
Epoch: 63, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.928 Vali Acc: 0.774 Test Loss: 0.928 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8063957691192627
Epoch: 64, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.921 Vali Acc: 0.774 Test Loss: 0.921 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8967843055725098
Epoch: 65, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.914 Vali Acc: 0.774 Test Loss: 0.914 Test Acc: 0.774
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8355002403259277
Epoch: 66, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.907 Vali Acc: 0.778 Test Loss: 0.907 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777769).  Saving model ...
Epoch: 67 cost time: 0.9478964805603027
Epoch: 67, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.901 Vali Acc: 0.774 Test Loss: 0.901 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7842354774475098
Epoch: 68, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.895 Vali Acc: 0.774 Test Loss: 0.895 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7771644592285156
Epoch: 69, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.890 Vali Acc: 0.770 Test Loss: 0.890 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7539739608764648
Epoch: 70, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.885 Vali Acc: 0.767 Test Loss: 0.885 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8340685367584229
Epoch: 71, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.880 Vali Acc: 0.767 Test Loss: 0.880 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8433849811553955
Epoch: 72, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.875 Vali Acc: 0.770 Test Loss: 0.875 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.6332712173461914
Epoch: 73, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.871 Vali Acc: 0.770 Test Loss: 0.871 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.8225405216217041
Epoch: 74, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.866 Vali Acc: 0.770 Test Loss: 0.866 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.6562485694885254
Epoch: 75, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.862 Vali Acc: 0.770 Test Loss: 0.862 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6316688060760498
Epoch: 76, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.857 Vali Acc: 0.774 Test Loss: 0.857 Test Acc: 0.774
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7777777777777778
model parameter : 135908
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3818397521972656
Epoch: 1, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.867 Vali Acc: 0.178 Test Loss: 1.867 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.6335413455963135
Epoch: 2, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.860 Vali Acc: 0.185 Test Loss: 1.860 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.6043562889099121
Epoch: 3, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.853 Vali Acc: 0.193 Test Loss: 1.853 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192574).  Saving model ...
Epoch: 4 cost time: 0.6270577907562256
Epoch: 4, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.844 Vali Acc: 0.193 Test Loss: 1.844 Test Acc: 0.193
Validation loss decreased (-0.192574 --> -0.192574).  Saving model ...
Epoch: 5 cost time: 0.6274676322937012
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.833 Vali Acc: 0.200 Test Loss: 1.833 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.697049617767334
Epoch: 6, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.820 Vali Acc: 0.200 Test Loss: 1.820 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 0.6486411094665527
Epoch: 7, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.806 Vali Acc: 0.200 Test Loss: 1.806 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 8 cost time: 0.7270691394805908
Epoch: 8, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.790 Vali Acc: 0.204 Test Loss: 1.790 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 9 cost time: 0.6802611351013184
Epoch: 9, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.773 Vali Acc: 0.215 Test Loss: 1.773 Test Acc: 0.215
Validation loss decreased (-0.203686 --> -0.214797).  Saving model ...
Epoch: 10 cost time: 0.5575864315032959
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.756 Vali Acc: 0.226 Test Loss: 1.756 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225908).  Saving model ...
Epoch: 11 cost time: 0.6754987239837646
Epoch: 11, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.737 Vali Acc: 0.248 Test Loss: 1.737 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248131).  Saving model ...
Epoch: 12 cost time: 0.7836132049560547
Epoch: 12, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.718 Vali Acc: 0.267 Test Loss: 1.718 Test Acc: 0.267
Validation loss decreased (-0.248131 --> -0.266649).  Saving model ...
Epoch: 13 cost time: 0.6200847625732422
Epoch: 13, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.698 Vali Acc: 0.281 Test Loss: 1.698 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281465).  Saving model ...
Epoch: 14 cost time: 0.5734837055206299
Epoch: 14, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.677 Vali Acc: 0.296 Test Loss: 1.677 Test Acc: 0.296
Validation loss decreased (-0.281465 --> -0.296280).  Saving model ...
Epoch: 15 cost time: 0.7880408763885498
Epoch: 15, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.656 Vali Acc: 0.326 Test Loss: 1.656 Test Acc: 0.326
Validation loss decreased (-0.296280 --> -0.325909).  Saving model ...
Epoch: 16 cost time: 0.6960294246673584
Epoch: 16, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.635 Vali Acc: 0.356 Test Loss: 1.635 Test Acc: 0.356
Validation loss decreased (-0.325909 --> -0.355539).  Saving model ...
Epoch: 17 cost time: 0.7804288864135742
Epoch: 17, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.613 Vali Acc: 0.370 Test Loss: 1.613 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 18 cost time: 0.7403383255004883
Epoch: 18, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.592 Vali Acc: 0.396 Test Loss: 1.592 Test Acc: 0.396
Validation loss decreased (-0.370354 --> -0.396280).  Saving model ...
Epoch: 19 cost time: 0.7521796226501465
Epoch: 19, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.570 Vali Acc: 0.411 Test Loss: 1.570 Test Acc: 0.411
Validation loss decreased (-0.396280 --> -0.411095).  Saving model ...
Epoch: 20 cost time: 0.7361772060394287
Epoch: 20, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.548 Vali Acc: 0.448 Test Loss: 1.548 Test Acc: 0.448
Validation loss decreased (-0.411095 --> -0.448133).  Saving model ...
Epoch: 21 cost time: 0.8398680686950684
Epoch: 21, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.527 Vali Acc: 0.470 Test Loss: 1.527 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 22 cost time: 0.7640447616577148
Epoch: 22, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
Validation loss decreased (-0.470355 --> -0.499985).  Saving model ...
Epoch: 23 cost time: 0.7055797576904297
Epoch: 23, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.484 Vali Acc: 0.519 Test Loss: 1.484 Test Acc: 0.519
Validation loss decreased (-0.499985 --> -0.518504).  Saving model ...
Epoch: 24 cost time: 0.7497904300689697
Epoch: 24, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.463 Vali Acc: 0.537 Test Loss: 1.463 Test Acc: 0.537
Validation loss decreased (-0.518504 --> -0.537022).  Saving model ...
Epoch: 25 cost time: 0.7722678184509277
Epoch: 25, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.443 Vali Acc: 0.559 Test Loss: 1.443 Test Acc: 0.559
Validation loss decreased (-0.537022 --> -0.559245).  Saving model ...
Epoch: 26 cost time: 0.7492156028747559
Epoch: 26, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.422 Vali Acc: 0.600 Test Loss: 1.422 Test Acc: 0.600
Validation loss decreased (-0.559245 --> -0.599986).  Saving model ...
Epoch: 27 cost time: 0.8253512382507324
Epoch: 27, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.402 Vali Acc: 0.615 Test Loss: 1.402 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614801).  Saving model ...
Epoch: 28 cost time: 0.6962826251983643
Epoch: 28, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.382 Vali Acc: 0.641 Test Loss: 1.382 Test Acc: 0.641
Validation loss decreased (-0.614801 --> -0.640727).  Saving model ...
Epoch: 29 cost time: 0.6549811363220215
Epoch: 29, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.363 Vali Acc: 0.663 Test Loss: 1.363 Test Acc: 0.663
Validation loss decreased (-0.640727 --> -0.662949).  Saving model ...
Epoch: 30 cost time: 0.7766523361206055
Epoch: 30, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.344 Vali Acc: 0.678 Test Loss: 1.344 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 31 cost time: 0.7954633235931396
Epoch: 31, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.325 Vali Acc: 0.689 Test Loss: 1.325 Test Acc: 0.689
Validation loss decreased (-0.677764 --> -0.688876).  Saving model ...
Epoch: 32 cost time: 0.6260690689086914
Epoch: 32, Steps: 2 | Train Loss: 0.872 Vali Loss: 1.307 Vali Acc: 0.707 Test Loss: 1.307 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707394).  Saving model ...
Epoch: 33 cost time: 0.7937769889831543
Epoch: 33, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.289 Vali Acc: 0.707 Test Loss: 1.289 Test Acc: 0.707
Validation loss decreased (-0.707394 --> -0.707395).  Saving model ...
Epoch: 34 cost time: 0.6665172576904297
Epoch: 34, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.271 Vali Acc: 0.719 Test Loss: 1.271 Test Acc: 0.719
Validation loss decreased (-0.707395 --> -0.718506).  Saving model ...
Epoch: 35 cost time: 0.5582072734832764
Epoch: 35, Steps: 2 | Train Loss: 0.772 Vali Loss: 1.253 Vali Acc: 0.715 Test Loss: 1.253 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9585504531860352
Epoch: 36, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.237 Vali Acc: 0.733 Test Loss: 1.237 Test Acc: 0.733
Validation loss decreased (-0.718506 --> -0.733321).  Saving model ...
Epoch: 37 cost time: 0.6803069114685059
Epoch: 37, Steps: 2 | Train Loss: 0.718 Vali Loss: 1.220 Vali Acc: 0.737 Test Loss: 1.220 Test Acc: 0.737
Validation loss decreased (-0.733321 --> -0.737025).  Saving model ...
Epoch: 38 cost time: 0.6670098304748535
Epoch: 38, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.204 Vali Acc: 0.741 Test Loss: 1.204 Test Acc: 0.741
Validation loss decreased (-0.737025 --> -0.740729).  Saving model ...
Epoch: 39 cost time: 0.6586208343505859
Epoch: 39, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.189 Vali Acc: 0.741 Test Loss: 1.189 Test Acc: 0.741
Validation loss decreased (-0.740729 --> -0.740729).  Saving model ...
Epoch: 40 cost time: 0.7266709804534912
Epoch: 40, Steps: 2 | Train Loss: 0.655 Vali Loss: 1.174 Vali Acc: 0.752 Test Loss: 1.174 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751840).  Saving model ...
Epoch: 41 cost time: 0.6854164600372314
Epoch: 41, Steps: 2 | Train Loss: 0.626 Vali Loss: 1.159 Vali Acc: 0.748 Test Loss: 1.159 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6681442260742188
Epoch: 42, Steps: 2 | Train Loss: 0.588 Vali Loss: 1.145 Vali Acc: 0.744 Test Loss: 1.145 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6642358303070068
Epoch: 43, Steps: 2 | Train Loss: 0.593 Vali Loss: 1.130 Vali Acc: 0.744 Test Loss: 1.130 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6727266311645508
Epoch: 44, Steps: 2 | Train Loss: 0.568 Vali Loss: 1.117 Vali Acc: 0.744 Test Loss: 1.117 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6737356185913086
Epoch: 45, Steps: 2 | Train Loss: 0.508 Vali Loss: 1.103 Vali Acc: 0.748 Test Loss: 1.103 Test Acc: 0.748
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6796286106109619
Epoch: 46, Steps: 2 | Train Loss: 0.497 Vali Loss: 1.090 Vali Acc: 0.752 Test Loss: 1.090 Test Acc: 0.752
Validation loss decreased (-0.751840 --> -0.751841).  Saving model ...
Epoch: 47 cost time: 0.7748706340789795
Epoch: 47, Steps: 2 | Train Loss: 0.467 Vali Loss: 1.078 Vali Acc: 0.752 Test Loss: 1.078 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751841).  Saving model ...
Epoch: 48 cost time: 0.6921486854553223
Epoch: 48, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.066 Vali Acc: 0.752 Test Loss: 1.066 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751841).  Saving model ...
Epoch: 49 cost time: 0.7921991348266602
Epoch: 49, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.054 Vali Acc: 0.748 Test Loss: 1.054 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9538509845733643
Epoch: 50, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.043 Vali Acc: 0.752 Test Loss: 1.043 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751841).  Saving model ...
Epoch: 51 cost time: 0.7605752944946289
Epoch: 51, Steps: 2 | Train Loss: 0.402 Vali Loss: 1.032 Vali Acc: 0.752 Test Loss: 1.032 Test Acc: 0.752
Validation loss decreased (-0.751841 --> -0.751842).  Saving model ...
Epoch: 52 cost time: 0.6906132698059082
Epoch: 52, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.022 Vali Acc: 0.756 Test Loss: 1.022 Test Acc: 0.756
Validation loss decreased (-0.751842 --> -0.755545).  Saving model ...
Epoch: 53 cost time: 0.7415146827697754
Epoch: 53, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.011 Vali Acc: 0.767 Test Loss: 1.011 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766657).  Saving model ...
Epoch: 54 cost time: 0.6203751564025879
Epoch: 54, Steps: 2 | Train Loss: 0.366 Vali Loss: 1.002 Vali Acc: 0.770 Test Loss: 1.002 Test Acc: 0.770
Validation loss decreased (-0.766657 --> -0.770360).  Saving model ...
Epoch: 55 cost time: 0.850567102432251
Epoch: 55, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.992 Vali Acc: 0.767 Test Loss: 0.992 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9516749382019043
Epoch: 56, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.983 Vali Acc: 0.767 Test Loss: 0.983 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8427362442016602
Epoch: 57, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.974 Vali Acc: 0.774 Test Loss: 0.974 Test Acc: 0.774
Validation loss decreased (-0.770360 --> -0.774064).  Saving model ...
Epoch: 58 cost time: 0.5952768325805664
Epoch: 58, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.966 Vali Acc: 0.770 Test Loss: 0.966 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7603335380554199
Epoch: 59, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.958 Vali Acc: 0.774 Test Loss: 0.958 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 60 cost time: 0.6251304149627686
Epoch: 60, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.950 Vali Acc: 0.778 Test Loss: 0.950 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 61 cost time: 0.6693015098571777
Epoch: 61, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.942 Vali Acc: 0.778 Test Loss: 0.942 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777768).  Saving model ...
Epoch: 62 cost time: 0.6598594188690186
Epoch: 62, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.935 Vali Acc: 0.778 Test Loss: 0.935 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777768).  Saving model ...
Epoch: 63 cost time: 0.7670392990112305
Epoch: 63, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.928 Vali Acc: 0.774 Test Loss: 0.928 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9029881954193115
Epoch: 64, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.921 Vali Acc: 0.774 Test Loss: 0.921 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.6827003955841064
Epoch: 65, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.914 Vali Acc: 0.774 Test Loss: 0.914 Test Acc: 0.774
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9127211570739746
Epoch: 66, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.907 Vali Acc: 0.778 Test Loss: 0.907 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777769).  Saving model ...
Epoch: 67 cost time: 0.6891469955444336
Epoch: 67, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.901 Vali Acc: 0.774 Test Loss: 0.901 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7723546028137207
Epoch: 68, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.895 Vali Acc: 0.774 Test Loss: 0.895 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6666431427001953
Epoch: 69, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.890 Vali Acc: 0.770 Test Loss: 0.890 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.774439811706543
Epoch: 70, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.885 Vali Acc: 0.767 Test Loss: 0.885 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6653282642364502
Epoch: 71, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.880 Vali Acc: 0.767 Test Loss: 0.880 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6489715576171875
Epoch: 72, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.875 Vali Acc: 0.770 Test Loss: 0.875 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.6870477199554443
Epoch: 73, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.871 Vali Acc: 0.770 Test Loss: 0.871 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7713947296142578
Epoch: 74, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.866 Vali Acc: 0.770 Test Loss: 0.866 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.7762963771820068
Epoch: 75, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.862 Vali Acc: 0.770 Test Loss: 0.862 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.7055401802062988
Epoch: 76, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.857 Vali Acc: 0.774 Test Loss: 0.857 Test Acc: 0.774
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7777777777777778
model parameter : 135908
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.610366106033325
Epoch: 1, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.771 Vali Acc: 0.230 Test Loss: 1.771 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.7413895130157471
Epoch: 2, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.763 Vali Acc: 0.230 Test Loss: 1.763 Test Acc: 0.230
Validation loss decreased (-0.229612 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 0.8458333015441895
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.754 Vali Acc: 0.237 Test Loss: 1.754 Test Acc: 0.237
Validation loss decreased (-0.229612 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.7801070213317871
Epoch: 4, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.738 Vali Acc: 0.256 Test Loss: 1.738 Test Acc: 0.256
Validation loss decreased (-0.237019 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 0.8116507530212402
Epoch: 5, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.719 Vali Acc: 0.281 Test Loss: 1.719 Test Acc: 0.281
Validation loss decreased (-0.255538 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 0.6596167087554932
Epoch: 6, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.698 Vali Acc: 0.315 Test Loss: 1.698 Test Acc: 0.315
Validation loss decreased (-0.281464 --> -0.314798).  Saving model ...
Epoch: 7 cost time: 0.7298910617828369
Epoch: 7, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.678 Vali Acc: 0.341 Test Loss: 1.678 Test Acc: 0.341
Validation loss decreased (-0.314798 --> -0.340724).  Saving model ...
Epoch: 8 cost time: 0.7703652381896973
Epoch: 8, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.658 Vali Acc: 0.381 Test Loss: 1.658 Test Acc: 0.381
Validation loss decreased (-0.340724 --> -0.381465).  Saving model ...
Epoch: 9 cost time: 0.9000248908996582
Epoch: 9, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.638 Vali Acc: 0.393 Test Loss: 1.638 Test Acc: 0.393
Validation loss decreased (-0.381465 --> -0.392576).  Saving model ...
Epoch: 10 cost time: 1.0467503070831299
Epoch: 10, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.619 Vali Acc: 0.396 Test Loss: 1.619 Test Acc: 0.396
Validation loss decreased (-0.392576 --> -0.396280).  Saving model ...
Epoch: 11 cost time: 0.6688244342803955
Epoch: 11, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.600 Vali Acc: 0.433 Test Loss: 1.600 Test Acc: 0.433
Validation loss decreased (-0.396280 --> -0.433317).  Saving model ...
Epoch: 12 cost time: 0.868619441986084
Epoch: 12, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.581 Vali Acc: 0.437 Test Loss: 1.581 Test Acc: 0.437
Validation loss decreased (-0.433317 --> -0.437021).  Saving model ...
Epoch: 13 cost time: 0.6233391761779785
Epoch: 13, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.561 Vali Acc: 0.470 Test Loss: 1.561 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470355).  Saving model ...
Epoch: 14 cost time: 0.6530423164367676
Epoch: 14, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
Validation loss decreased (-0.470355 --> -0.499985).  Saving model ...
Epoch: 15 cost time: 0.8246006965637207
Epoch: 15, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.523 Vali Acc: 0.522 Test Loss: 1.523 Test Acc: 0.522
Validation loss decreased (-0.499985 --> -0.522207).  Saving model ...
Epoch: 16 cost time: 0.6864142417907715
Epoch: 16, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.502 Vali Acc: 0.552 Test Loss: 1.502 Test Acc: 0.552
Validation loss decreased (-0.522207 --> -0.551837).  Saving model ...
Epoch: 17 cost time: 1.0500833988189697
Epoch: 17, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.485 Vali Acc: 0.567 Test Loss: 1.485 Test Acc: 0.567
Validation loss decreased (-0.551837 --> -0.566652).  Saving model ...
Epoch: 18 cost time: 0.9356591701507568
Epoch: 18, Steps: 2 | Train Loss: 0.788 Vali Loss: 1.467 Vali Acc: 0.563 Test Loss: 1.467 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8338978290557861
Epoch: 19, Steps: 2 | Train Loss: 0.792 Vali Loss: 1.450 Vali Acc: 0.570 Test Loss: 1.450 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.570356).  Saving model ...
Epoch: 20 cost time: 0.9530444145202637
Epoch: 20, Steps: 2 | Train Loss: 0.721 Vali Loss: 1.432 Vali Acc: 0.574 Test Loss: 1.432 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 21 cost time: 0.7733249664306641
Epoch: 21, Steps: 2 | Train Loss: 0.659 Vali Loss: 1.415 Vali Acc: 0.585 Test Loss: 1.415 Test Acc: 0.585
Validation loss decreased (-0.574060 --> -0.585171).  Saving model ...
Epoch: 22 cost time: 0.982398509979248
Epoch: 22, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.400 Vali Acc: 0.593 Test Loss: 1.400 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592579).  Saving model ...
Epoch: 23 cost time: 1.011479139328003
Epoch: 23, Steps: 2 | Train Loss: 0.603 Vali Loss: 1.387 Vali Acc: 0.604 Test Loss: 1.387 Test Acc: 0.604
Validation loss decreased (-0.592579 --> -0.603690).  Saving model ...
Epoch: 24 cost time: 0.8491616249084473
Epoch: 24, Steps: 2 | Train Loss: 0.580 Vali Loss: 1.374 Vali Acc: 0.615 Test Loss: 1.374 Test Acc: 0.615
Validation loss decreased (-0.603690 --> -0.614801).  Saving model ...
Epoch: 25 cost time: 1.0109825134277344
Epoch: 25, Steps: 2 | Train Loss: 0.536 Vali Loss: 1.360 Vali Acc: 0.633 Test Loss: 1.360 Test Acc: 0.633
Validation loss decreased (-0.614801 --> -0.633320).  Saving model ...
Epoch: 26 cost time: 0.7915835380554199
Epoch: 26, Steps: 2 | Train Loss: 0.485 Vali Loss: 1.346 Vali Acc: 0.637 Test Loss: 1.346 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.637024).  Saving model ...
Epoch: 27 cost time: 1.005462408065796
Epoch: 27, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.336 Vali Acc: 0.644 Test Loss: 1.336 Test Acc: 0.644
Validation loss decreased (-0.637024 --> -0.644431).  Saving model ...
Epoch: 28 cost time: 0.7580945491790771
Epoch: 28, Steps: 2 | Train Loss: 0.442 Vali Loss: 1.327 Vali Acc: 0.644 Test Loss: 1.327 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 29 cost time: 0.8865141868591309
Epoch: 29, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.318 Vali Acc: 0.641 Test Loss: 1.318 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0744805335998535
Epoch: 30, Steps: 2 | Train Loss: 0.388 Vali Loss: 1.309 Vali Acc: 0.637 Test Loss: 1.309 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8824441432952881
Epoch: 31, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.301 Vali Acc: 0.659 Test Loss: 1.301 Test Acc: 0.659
Validation loss decreased (-0.644431 --> -0.659246).  Saving model ...
Epoch: 32 cost time: 1.0005574226379395
Epoch: 32, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.294 Vali Acc: 0.656 Test Loss: 1.294 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8657748699188232
Epoch: 33, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.287 Vali Acc: 0.648 Test Loss: 1.287 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8810915946960449
Epoch: 34, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.280 Vali Acc: 0.641 Test Loss: 1.280 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8358781337738037
Epoch: 35, Steps: 2 | Train Loss: 0.290 Vali Loss: 1.272 Vali Acc: 0.652 Test Loss: 1.272 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8194725513458252
Epoch: 36, Steps: 2 | Train Loss: 0.282 Vali Loss: 1.263 Vali Acc: 0.659 Test Loss: 1.263 Test Acc: 0.659
Validation loss decreased (-0.659246 --> -0.659247).  Saving model ...
Epoch: 37 cost time: 0.7909207344055176
Epoch: 37, Steps: 2 | Train Loss: 0.265 Vali Loss: 1.255 Vali Acc: 0.670 Test Loss: 1.255 Test Acc: 0.670
Validation loss decreased (-0.659247 --> -0.670358).  Saving model ...
Epoch: 38 cost time: 0.8357338905334473
Epoch: 38, Steps: 2 | Train Loss: 0.256 Vali Loss: 1.251 Vali Acc: 0.674 Test Loss: 1.251 Test Acc: 0.674
Validation loss decreased (-0.670358 --> -0.674062).  Saving model ...
Epoch: 39 cost time: 0.787708044052124
Epoch: 39, Steps: 2 | Train Loss: 0.239 Vali Loss: 1.247 Vali Acc: 0.685 Test Loss: 1.247 Test Acc: 0.685
Validation loss decreased (-0.674062 --> -0.685173).  Saving model ...
Epoch: 40 cost time: 0.8183064460754395
Epoch: 40, Steps: 2 | Train Loss: 0.220 Vali Loss: 1.242 Vali Acc: 0.685 Test Loss: 1.242 Test Acc: 0.685
Validation loss decreased (-0.685173 --> -0.685173).  Saving model ...
Epoch: 41 cost time: 0.8828694820404053
Epoch: 41, Steps: 2 | Train Loss: 0.211 Vali Loss: 1.237 Vali Acc: 0.678 Test Loss: 1.237 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8412845134735107
Epoch: 42, Steps: 2 | Train Loss: 0.206 Vali Loss: 1.232 Vali Acc: 0.674 Test Loss: 1.232 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6703662872314453
Epoch: 43, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.228 Vali Acc: 0.670 Test Loss: 1.228 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7428188323974609
Epoch: 44, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.223 Vali Acc: 0.667 Test Loss: 1.223 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9564604759216309
Epoch: 45, Steps: 2 | Train Loss: 0.173 Vali Loss: 1.219 Vali Acc: 0.663 Test Loss: 1.219 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8800041675567627
Epoch: 46, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.214 Vali Acc: 0.659 Test Loss: 1.214 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0382447242736816
Epoch: 47, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.210 Vali Acc: 0.659 Test Loss: 1.210 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6557743549346924
Epoch: 48, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.204 Vali Acc: 0.659 Test Loss: 1.204 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7483603954315186
Epoch: 49, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.199 Vali Acc: 0.663 Test Loss: 1.199 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7617714405059814
Epoch: 50, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.196 Vali Acc: 0.652 Test Loss: 1.196 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6851851851851852
model parameter : 144056
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.148914337158203
Epoch: 1, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.854 Vali Acc: 0.156 Test Loss: 1.854 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.7626452445983887
Epoch: 2, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.849 Vali Acc: 0.163 Test Loss: 1.849 Test Acc: 0.163
Validation loss decreased (-0.155537 --> -0.162944).  Saving model ...
Epoch: 3 cost time: 0.7186639308929443
Epoch: 3, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.842 Vali Acc: 0.159 Test Loss: 1.842 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6840028762817383
Epoch: 4, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.830 Vali Acc: 0.159 Test Loss: 1.830 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.70113205909729
Epoch: 5, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.814 Vali Acc: 0.159 Test Loss: 1.814 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9771506786346436
Epoch: 6, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.795 Vali Acc: 0.185 Test Loss: 1.795 Test Acc: 0.185
Validation loss decreased (-0.162944 --> -0.185167).  Saving model ...
Epoch: 7 cost time: 0.8245162963867188
Epoch: 7, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.775 Vali Acc: 0.189 Test Loss: 1.775 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 8 cost time: 0.7795238494873047
Epoch: 8, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.753 Vali Acc: 0.256 Test Loss: 1.753 Test Acc: 0.256
Validation loss decreased (-0.188871 --> -0.255538).  Saving model ...
Epoch: 9 cost time: 0.8610916137695312
Epoch: 9, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.732 Vali Acc: 0.274 Test Loss: 1.732 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 10 cost time: 0.7115883827209473
Epoch: 10, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.709 Vali Acc: 0.307 Test Loss: 1.709 Test Acc: 0.307
Validation loss decreased (-0.274057 --> -0.307390).  Saving model ...
Epoch: 11 cost time: 0.9429309368133545
Epoch: 11, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.686 Vali Acc: 0.333 Test Loss: 1.686 Test Acc: 0.333
Validation loss decreased (-0.307390 --> -0.333316).  Saving model ...
Epoch: 12 cost time: 0.8572118282318115
Epoch: 12, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.664 Vali Acc: 0.356 Test Loss: 1.664 Test Acc: 0.356
Validation loss decreased (-0.333316 --> -0.355539).  Saving model ...
Epoch: 13 cost time: 0.9063193798065186
Epoch: 13, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.642 Vali Acc: 0.370 Test Loss: 1.642 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 14 cost time: 0.7245786190032959
Epoch: 14, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.621 Vali Acc: 0.385 Test Loss: 1.621 Test Acc: 0.385
Validation loss decreased (-0.370354 --> -0.385169).  Saving model ...
Epoch: 15 cost time: 0.6683609485626221
Epoch: 15, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.601 Vali Acc: 0.404 Test Loss: 1.601 Test Acc: 0.404
Validation loss decreased (-0.385169 --> -0.403688).  Saving model ...
Epoch: 16 cost time: 0.7505125999450684
Epoch: 16, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.582 Vali Acc: 0.407 Test Loss: 1.582 Test Acc: 0.407
Validation loss decreased (-0.403688 --> -0.407392).  Saving model ...
Epoch: 17 cost time: 0.7422046661376953
Epoch: 17, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.563 Vali Acc: 0.411 Test Loss: 1.563 Test Acc: 0.411
Validation loss decreased (-0.407392 --> -0.411095).  Saving model ...
Epoch: 18 cost time: 0.8569536209106445
Epoch: 18, Steps: 2 | Train Loss: 0.738 Vali Loss: 1.545 Vali Acc: 0.430 Test Loss: 1.545 Test Acc: 0.430
Validation loss decreased (-0.411095 --> -0.429614).  Saving model ...
Epoch: 19 cost time: 0.8114669322967529
Epoch: 19, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.526 Vali Acc: 0.448 Test Loss: 1.526 Test Acc: 0.448
Validation loss decreased (-0.429614 --> -0.448133).  Saving model ...
Epoch: 20 cost time: 0.6757795810699463
Epoch: 20, Steps: 2 | Train Loss: 0.661 Vali Loss: 1.510 Vali Acc: 0.470 Test Loss: 1.510 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 21 cost time: 0.8421273231506348
Epoch: 21, Steps: 2 | Train Loss: 0.614 Vali Loss: 1.494 Vali Acc: 0.481 Test Loss: 1.494 Test Acc: 0.481
Validation loss decreased (-0.470355 --> -0.481467).  Saving model ...
Epoch: 22 cost time: 0.8149590492248535
Epoch: 22, Steps: 2 | Train Loss: 0.574 Vali Loss: 1.481 Vali Acc: 0.478 Test Loss: 1.481 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9386687278747559
Epoch: 23, Steps: 2 | Train Loss: 0.534 Vali Loss: 1.470 Vali Acc: 0.493 Test Loss: 1.470 Test Acc: 0.493
Validation loss decreased (-0.481467 --> -0.492578).  Saving model ...
Epoch: 24 cost time: 0.7494208812713623
Epoch: 24, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.461 Vali Acc: 0.500 Test Loss: 1.461 Test Acc: 0.500
Validation loss decreased (-0.492578 --> -0.499985).  Saving model ...
Epoch: 25 cost time: 0.6658957004547119
Epoch: 25, Steps: 2 | Train Loss: 0.487 Vali Loss: 1.455 Vali Acc: 0.500 Test Loss: 1.455 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 26 cost time: 0.9595744609832764
Epoch: 26, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.449 Vali Acc: 0.500 Test Loss: 1.449 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499986).  Saving model ...
Epoch: 27 cost time: 0.826479434967041
Epoch: 27, Steps: 2 | Train Loss: 0.418 Vali Loss: 1.443 Vali Acc: 0.507 Test Loss: 1.443 Test Acc: 0.507
Validation loss decreased (-0.499986 --> -0.507393).  Saving model ...
Epoch: 28 cost time: 0.8917913436889648
Epoch: 28, Steps: 2 | Train Loss: 0.397 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9013731479644775
Epoch: 29, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
Validation loss decreased (-0.507393 --> -0.518504).  Saving model ...
Epoch: 30 cost time: 1.0192289352416992
Epoch: 30, Steps: 2 | Train Loss: 0.344 Vali Loss: 1.423 Vali Acc: 0.515 Test Loss: 1.423 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8669071197509766
Epoch: 31, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.416 Vali Acc: 0.526 Test Loss: 1.416 Test Acc: 0.526
Validation loss decreased (-0.518504 --> -0.525912).  Saving model ...
Epoch: 32 cost time: 1.038102626800537
Epoch: 32, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.409 Vali Acc: 0.526 Test Loss: 1.409 Test Acc: 0.526
Validation loss decreased (-0.525912 --> -0.525912).  Saving model ...
Epoch: 33 cost time: 0.8262321949005127
Epoch: 33, Steps: 2 | Train Loss: 0.272 Vali Loss: 1.403 Vali Acc: 0.522 Test Loss: 1.403 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1175098419189453
Epoch: 34, Steps: 2 | Train Loss: 0.272 Vali Loss: 1.396 Vali Acc: 0.519 Test Loss: 1.396 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9402527809143066
Epoch: 35, Steps: 2 | Train Loss: 0.256 Vali Loss: 1.391 Vali Acc: 0.519 Test Loss: 1.391 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1121094226837158
Epoch: 36, Steps: 2 | Train Loss: 0.239 Vali Loss: 1.385 Vali Acc: 0.522 Test Loss: 1.385 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7595682144165039
Epoch: 37, Steps: 2 | Train Loss: 0.223 Vali Loss: 1.381 Vali Acc: 0.537 Test Loss: 1.381 Test Acc: 0.537
Validation loss decreased (-0.525912 --> -0.537023).  Saving model ...
Epoch: 38 cost time: 0.7024250030517578
Epoch: 38, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.377 Vali Acc: 0.548 Test Loss: 1.377 Test Acc: 0.548
Validation loss decreased (-0.537023 --> -0.548134).  Saving model ...
Epoch: 39 cost time: 0.7646052837371826
Epoch: 39, Steps: 2 | Train Loss: 0.202 Vali Loss: 1.371 Vali Acc: 0.552 Test Loss: 1.371 Test Acc: 0.552
Validation loss decreased (-0.548134 --> -0.551838).  Saving model ...
Epoch: 40 cost time: 1.099586009979248
Epoch: 40, Steps: 2 | Train Loss: 0.196 Vali Loss: 1.364 Vali Acc: 0.559 Test Loss: 1.364 Test Acc: 0.559
Validation loss decreased (-0.551838 --> -0.559246).  Saving model ...
Epoch: 41 cost time: 0.7957284450531006
Epoch: 41, Steps: 2 | Train Loss: 0.178 Vali Loss: 1.357 Vali Acc: 0.559 Test Loss: 1.357 Test Acc: 0.559
Validation loss decreased (-0.559246 --> -0.559246).  Saving model ...
Epoch: 42 cost time: 0.7339603900909424
Epoch: 42, Steps: 2 | Train Loss: 0.176 Vali Loss: 1.352 Vali Acc: 0.559 Test Loss: 1.352 Test Acc: 0.559
Validation loss decreased (-0.559246 --> -0.559246).  Saving model ...
Epoch: 43 cost time: 0.7699079513549805
Epoch: 43, Steps: 2 | Train Loss: 0.167 Vali Loss: 1.348 Vali Acc: 0.567 Test Loss: 1.348 Test Acc: 0.567
Validation loss decreased (-0.559246 --> -0.566653).  Saving model ...
Epoch: 44 cost time: 0.9683370590209961
Epoch: 44, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.345 Vali Acc: 0.570 Test Loss: 1.345 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.570357).  Saving model ...
Epoch: 45 cost time: 0.9452168941497803
Epoch: 45, Steps: 2 | Train Loss: 0.158 Vali Loss: 1.342 Vali Acc: 0.581 Test Loss: 1.342 Test Acc: 0.581
Validation loss decreased (-0.570357 --> -0.581468).  Saving model ...
Epoch: 46 cost time: 0.762641429901123
Epoch: 46, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.338 Vali Acc: 0.585 Test Loss: 1.338 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585172).  Saving model ...
Epoch: 47 cost time: 0.8675079345703125
Epoch: 47, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.335 Vali Acc: 0.578 Test Loss: 1.335 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7655973434448242
Epoch: 48, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.333 Vali Acc: 0.567 Test Loss: 1.333 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8455114364624023
Epoch: 49, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.331 Vali Acc: 0.570 Test Loss: 1.331 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9320340156555176
Epoch: 50, Steps: 2 | Train Loss: 0.128 Vali Loss: 1.329 Vali Acc: 0.578 Test Loss: 1.329 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7864642143249512
Epoch: 51, Steps: 2 | Train Loss: 0.119 Vali Loss: 1.327 Vali Acc: 0.581 Test Loss: 1.327 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9219470024108887
Epoch: 52, Steps: 2 | Train Loss: 0.113 Vali Loss: 1.325 Vali Acc: 0.574 Test Loss: 1.325 Test Acc: 0.574
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7846174240112305
Epoch: 53, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.323 Vali Acc: 0.574 Test Loss: 1.323 Test Acc: 0.574
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8697035312652588
Epoch: 54, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.320 Vali Acc: 0.578 Test Loss: 1.320 Test Acc: 0.578
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7660269737243652
Epoch: 55, Steps: 2 | Train Loss: 0.101 Vali Loss: 1.318 Vali Acc: 0.585 Test Loss: 1.318 Test Acc: 0.585
Validation loss decreased (-0.585172 --> -0.585172).  Saving model ...
Epoch: 56 cost time: 0.8621625900268555
Epoch: 56, Steps: 2 | Train Loss: 0.098 Vali Loss: 1.316 Vali Acc: 0.593 Test Loss: 1.316 Test Acc: 0.593
Validation loss decreased (-0.585172 --> -0.592579).  Saving model ...
Epoch: 57 cost time: 0.7426149845123291
Epoch: 57, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.314 Vali Acc: 0.581 Test Loss: 1.314 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8258440494537354
Epoch: 58, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.310 Vali Acc: 0.570 Test Loss: 1.310 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.091088056564331
Epoch: 59, Steps: 2 | Train Loss: 0.083 Vali Loss: 1.307 Vali Acc: 0.581 Test Loss: 1.307 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9238100051879883
Epoch: 60, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.304 Vali Acc: 0.581 Test Loss: 1.304 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8725812435150146
Epoch: 61, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.302 Vali Acc: 0.585 Test Loss: 1.302 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.7767486572265625
Epoch: 62, Steps: 2 | Train Loss: 0.073 Vali Loss: 1.300 Vali Acc: 0.589 Test Loss: 1.300 Test Acc: 0.589
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.7351059913635254
Epoch: 63, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.299 Vali Acc: 0.589 Test Loss: 1.299 Test Acc: 0.589
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.8574960231781006
Epoch: 64, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.296 Vali Acc: 0.593 Test Loss: 1.296 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592580).  Saving model ...
Epoch: 65 cost time: 0.9492208957672119
Epoch: 65, Steps: 2 | Train Loss: 0.072 Vali Loss: 1.294 Vali Acc: 0.593 Test Loss: 1.294 Test Acc: 0.593
Validation loss decreased (-0.592580 --> -0.592580).  Saving model ...
Epoch: 66 cost time: 0.917771577835083
Epoch: 66, Steps: 2 | Train Loss: 0.063 Vali Loss: 1.292 Vali Acc: 0.604 Test Loss: 1.292 Test Acc: 0.604
Validation loss decreased (-0.592580 --> -0.603691).  Saving model ...
Epoch: 67 cost time: 0.8536298274993896
Epoch: 67, Steps: 2 | Train Loss: 0.065 Vali Loss: 1.291 Vali Acc: 0.607 Test Loss: 1.291 Test Acc: 0.607
Validation loss decreased (-0.603691 --> -0.607394).  Saving model ...
Epoch: 68 cost time: 1.0320732593536377
Epoch: 68, Steps: 2 | Train Loss: 0.065 Vali Loss: 1.290 Vali Acc: 0.604 Test Loss: 1.290 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9940376281738281
Epoch: 69, Steps: 2 | Train Loss: 0.064 Vali Loss: 1.289 Vali Acc: 0.604 Test Loss: 1.289 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8207063674926758
Epoch: 70, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.288 Vali Acc: 0.607 Test Loss: 1.288 Test Acc: 0.607
Validation loss decreased (-0.607394 --> -0.607395).  Saving model ...
Epoch: 71 cost time: 0.8823890686035156
Epoch: 71, Steps: 2 | Train Loss: 0.058 Vali Loss: 1.287 Vali Acc: 0.607 Test Loss: 1.287 Test Acc: 0.607
Validation loss decreased (-0.607395 --> -0.607395).  Saving model ...
Epoch: 72 cost time: 0.840003252029419
Epoch: 72, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.284 Vali Acc: 0.604 Test Loss: 1.284 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7361845970153809
Epoch: 73, Steps: 2 | Train Loss: 0.056 Vali Loss: 1.282 Vali Acc: 0.604 Test Loss: 1.282 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.9346556663513184
Epoch: 74, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.281 Vali Acc: 0.604 Test Loss: 1.281 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.7928683757781982
Epoch: 75, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.279 Vali Acc: 0.596 Test Loss: 1.279 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.7847492694854736
Epoch: 76, Steps: 2 | Train Loss: 0.054 Vali Loss: 1.278 Vali Acc: 0.596 Test Loss: 1.278 Test Acc: 0.596
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.8438336849212646
Epoch: 77, Steps: 2 | Train Loss: 0.050 Vali Loss: 1.276 Vali Acc: 0.604 Test Loss: 1.276 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.7504222393035889
Epoch: 78, Steps: 2 | Train Loss: 0.046 Vali Loss: 1.274 Vali Acc: 0.604 Test Loss: 1.274 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.0106637477874756
Epoch: 79, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.273 Vali Acc: 0.593 Test Loss: 1.273 Test Acc: 0.593
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.0478951930999756
Epoch: 80, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.274 Vali Acc: 0.593 Test Loss: 1.274 Test Acc: 0.593
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.7038989067077637
Epoch: 81, Steps: 2 | Train Loss: 0.050 Vali Loss: 1.273 Vali Acc: 0.589 Test Loss: 1.273 Test Acc: 0.589
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6074074074074074
model parameter : 142008
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1950125694274902
Epoch: 1, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.823 Vali Acc: 0.130 Test Loss: 1.823 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.6324319839477539
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.814 Vali Acc: 0.133 Test Loss: 1.814 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.728405237197876
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.803 Vali Acc: 0.148 Test Loss: 1.803 Test Acc: 0.148
Validation loss decreased (-0.133315 --> -0.148130).  Saving model ...
Epoch: 4 cost time: 0.6211099624633789
Epoch: 4, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.785 Vali Acc: 0.163 Test Loss: 1.785 Test Acc: 0.163
Validation loss decreased (-0.148130 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.7750482559204102
Epoch: 5, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.762 Vali Acc: 0.170 Test Loss: 1.762 Test Acc: 0.170
Validation loss decreased (-0.162945 --> -0.170353).  Saving model ...
Epoch: 6 cost time: 0.6665840148925781
Epoch: 6, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.736 Vali Acc: 0.207 Test Loss: 1.736 Test Acc: 0.207
Validation loss decreased (-0.170353 --> -0.207390).  Saving model ...
Epoch: 7 cost time: 0.6745309829711914
Epoch: 7, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.705 Vali Acc: 0.237 Test Loss: 1.705 Test Acc: 0.237
Validation loss decreased (-0.207390 --> -0.237020).  Saving model ...
Epoch: 8 cost time: 0.6759309768676758
Epoch: 8, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.674 Vali Acc: 0.296 Test Loss: 1.674 Test Acc: 0.296
Validation loss decreased (-0.237020 --> -0.296280).  Saving model ...
Epoch: 9 cost time: 0.6762158870697021
Epoch: 9, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.644 Vali Acc: 0.370 Test Loss: 1.644 Test Acc: 0.370
Validation loss decreased (-0.296280 --> -0.370354).  Saving model ...
Epoch: 10 cost time: 0.6192121505737305
Epoch: 10, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.615 Vali Acc: 0.389 Test Loss: 1.615 Test Acc: 0.389
Validation loss decreased (-0.370354 --> -0.388873).  Saving model ...
Epoch: 11 cost time: 0.652785062789917
Epoch: 11, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.589 Vali Acc: 0.430 Test Loss: 1.589 Test Acc: 0.430
Validation loss decreased (-0.388873 --> -0.429614).  Saving model ...
Epoch: 12 cost time: 0.6573188304901123
Epoch: 12, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.564 Vali Acc: 0.467 Test Loss: 1.564 Test Acc: 0.467
Validation loss decreased (-0.429614 --> -0.466651).  Saving model ...
Epoch: 13 cost time: 0.6590619087219238
Epoch: 13, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.540 Vali Acc: 0.481 Test Loss: 1.540 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 14 cost time: 0.670562744140625
Epoch: 14, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.518 Vali Acc: 0.485 Test Loss: 1.518 Test Acc: 0.485
Validation loss decreased (-0.481466 --> -0.485170).  Saving model ...
Epoch: 15 cost time: 0.6861903667449951
Epoch: 15, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.498 Vali Acc: 0.504 Test Loss: 1.498 Test Acc: 0.504
Validation loss decreased (-0.485170 --> -0.503689).  Saving model ...
Epoch: 16 cost time: 0.7316617965698242
Epoch: 16, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.479 Vali Acc: 0.522 Test Loss: 1.479 Test Acc: 0.522
Validation loss decreased (-0.503689 --> -0.522207).  Saving model ...
Epoch: 17 cost time: 0.8050525188446045
Epoch: 17, Steps: 2 | Train Loss: 0.777 Vali Loss: 1.462 Vali Acc: 0.530 Test Loss: 1.462 Test Acc: 0.530
Validation loss decreased (-0.522207 --> -0.529615).  Saving model ...
Epoch: 18 cost time: 0.6878666877746582
Epoch: 18, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.447 Vali Acc: 0.533 Test Loss: 1.447 Test Acc: 0.533
Validation loss decreased (-0.529615 --> -0.533319).  Saving model ...
Epoch: 19 cost time: 0.5511002540588379
Epoch: 19, Steps: 2 | Train Loss: 0.685 Vali Loss: 1.433 Vali Acc: 0.537 Test Loss: 1.433 Test Acc: 0.537
Validation loss decreased (-0.533319 --> -0.537023).  Saving model ...
Epoch: 20 cost time: 0.6607682704925537
Epoch: 20, Steps: 2 | Train Loss: 0.658 Vali Loss: 1.422 Vali Acc: 0.533 Test Loss: 1.422 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6024487018585205
Epoch: 21, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.412 Vali Acc: 0.537 Test Loss: 1.412 Test Acc: 0.537
Validation loss decreased (-0.537023 --> -0.537023).  Saving model ...
Epoch: 22 cost time: 0.572394847869873
Epoch: 22, Steps: 2 | Train Loss: 0.536 Vali Loss: 1.401 Vali Acc: 0.552 Test Loss: 1.401 Test Acc: 0.552
Validation loss decreased (-0.537023 --> -0.551838).  Saving model ...
Epoch: 23 cost time: 0.5864152908325195
Epoch: 23, Steps: 2 | Train Loss: 0.544 Vali Loss: 1.390 Vali Acc: 0.548 Test Loss: 1.390 Test Acc: 0.548
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5833659172058105
Epoch: 24, Steps: 2 | Train Loss: 0.462 Vali Loss: 1.378 Vali Acc: 0.559 Test Loss: 1.378 Test Acc: 0.559
Validation loss decreased (-0.551838 --> -0.559245).  Saving model ...
Epoch: 25 cost time: 0.5612514019012451
Epoch: 25, Steps: 2 | Train Loss: 0.470 Vali Loss: 1.366 Vali Acc: 0.559 Test Loss: 1.366 Test Acc: 0.559
Validation loss decreased (-0.559245 --> -0.559246).  Saving model ...
Epoch: 26 cost time: 0.5960147380828857
Epoch: 26, Steps: 2 | Train Loss: 0.432 Vali Loss: 1.356 Vali Acc: 0.567 Test Loss: 1.356 Test Acc: 0.567
Validation loss decreased (-0.559246 --> -0.566653).  Saving model ...
Epoch: 27 cost time: 0.7146511077880859
Epoch: 27, Steps: 2 | Train Loss: 0.394 Vali Loss: 1.345 Vali Acc: 0.567 Test Loss: 1.345 Test Acc: 0.567
Validation loss decreased (-0.566653 --> -0.566653).  Saving model ...
Epoch: 28 cost time: 0.6283173561096191
Epoch: 28, Steps: 2 | Train Loss: 0.394 Vali Loss: 1.334 Vali Acc: 0.581 Test Loss: 1.334 Test Acc: 0.581
Validation loss decreased (-0.566653 --> -0.581468).  Saving model ...
Epoch: 29 cost time: 0.6541171073913574
Epoch: 29, Steps: 2 | Train Loss: 0.338 Vali Loss: 1.324 Vali Acc: 0.585 Test Loss: 1.324 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585172).  Saving model ...
Epoch: 30 cost time: 0.7605376243591309
Epoch: 30, Steps: 2 | Train Loss: 0.331 Vali Loss: 1.315 Vali Acc: 0.593 Test Loss: 1.315 Test Acc: 0.593
Validation loss decreased (-0.585172 --> -0.592579).  Saving model ...
Epoch: 31 cost time: 0.614330530166626
Epoch: 31, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.308 Vali Acc: 0.593 Test Loss: 1.308 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592580).  Saving model ...
Epoch: 32 cost time: 0.6476855278015137
Epoch: 32, Steps: 2 | Train Loss: 0.292 Vali Loss: 1.303 Vali Acc: 0.585 Test Loss: 1.303 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7113244533538818
Epoch: 33, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.297 Vali Acc: 0.574 Test Loss: 1.297 Test Acc: 0.574
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6717379093170166
Epoch: 34, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.292 Vali Acc: 0.570 Test Loss: 1.292 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7459568977355957
Epoch: 35, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.286 Vali Acc: 0.563 Test Loss: 1.286 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7405264377593994
Epoch: 36, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.281 Vali Acc: 0.574 Test Loss: 1.281 Test Acc: 0.574
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7272262573242188
Epoch: 37, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.276 Vali Acc: 0.578 Test Loss: 1.276 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6819782257080078
Epoch: 38, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.272 Vali Acc: 0.585 Test Loss: 1.272 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7069497108459473
Epoch: 39, Steps: 2 | Train Loss: 0.196 Vali Loss: 1.267 Vali Acc: 0.581 Test Loss: 1.267 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8204090595245361
Epoch: 40, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.262 Vali Acc: 0.581 Test Loss: 1.262 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6629765033721924
Epoch: 41, Steps: 2 | Train Loss: 0.167 Vali Loss: 1.257 Vali Acc: 0.574 Test Loss: 1.257 Test Acc: 0.574
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.5925925925925926
model parameter : 139960
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3331964015960693
Epoch: 1, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.853 Vali Acc: 0.174 Test Loss: 1.853 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.8036317825317383
Epoch: 2, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.845 Vali Acc: 0.167 Test Loss: 1.845 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7327344417572021
Epoch: 3, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.835 Vali Acc: 0.170 Test Loss: 1.835 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6646914482116699
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.820 Vali Acc: 0.178 Test Loss: 1.820 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 5 cost time: 0.7080883979797363
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.800 Vali Acc: 0.185 Test Loss: 1.800 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.603018045425415
Epoch: 6, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.777 Vali Acc: 0.189 Test Loss: 1.777 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 7 cost time: 0.781914234161377
Epoch: 7, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.753 Vali Acc: 0.215 Test Loss: 1.753 Test Acc: 0.215
Validation loss decreased (-0.188871 --> -0.214797).  Saving model ...
Epoch: 8 cost time: 0.6256251335144043
Epoch: 8, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.729 Vali Acc: 0.267 Test Loss: 1.729 Test Acc: 0.267
Validation loss decreased (-0.214797 --> -0.266649).  Saving model ...
Epoch: 9 cost time: 0.7692182064056396
Epoch: 9, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.704 Vali Acc: 0.311 Test Loss: 1.704 Test Acc: 0.311
Validation loss decreased (-0.266649 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.7925198078155518
Epoch: 10, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.677 Vali Acc: 0.341 Test Loss: 1.677 Test Acc: 0.341
Validation loss decreased (-0.311094 --> -0.340724).  Saving model ...
Epoch: 11 cost time: 0.8301293849945068
Epoch: 11, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.651 Vali Acc: 0.385 Test Loss: 1.651 Test Acc: 0.385
Validation loss decreased (-0.340724 --> -0.385169).  Saving model ...
Epoch: 12 cost time: 0.6792397499084473
Epoch: 12, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.626 Vali Acc: 0.452 Test Loss: 1.626 Test Acc: 0.452
Validation loss decreased (-0.385169 --> -0.451836).  Saving model ...
Epoch: 13 cost time: 0.8134169578552246
Epoch: 13, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.604 Vali Acc: 0.470 Test Loss: 1.604 Test Acc: 0.470
Validation loss decreased (-0.451836 --> -0.470354).  Saving model ...
Epoch: 14 cost time: 0.803041934967041
Epoch: 14, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
Validation loss decreased (-0.470354 --> -0.499984).  Saving model ...
Epoch: 15 cost time: 0.6981849670410156
Epoch: 15, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499984).  Saving model ...
Epoch: 16 cost time: 0.8636322021484375
Epoch: 16, Steps: 2 | Train Loss: 0.853 Vali Loss: 1.536 Vali Acc: 0.519 Test Loss: 1.536 Test Acc: 0.519
Validation loss decreased (-0.499984 --> -0.518503).  Saving model ...
Epoch: 17 cost time: 0.7412872314453125
Epoch: 17, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.510 Vali Acc: 0.556 Test Loss: 1.510 Test Acc: 0.556
Validation loss decreased (-0.518503 --> -0.555540).  Saving model ...
Epoch: 18 cost time: 0.8160395622253418
Epoch: 18, Steps: 2 | Train Loss: 0.743 Vali Loss: 1.484 Vali Acc: 0.559 Test Loss: 1.484 Test Acc: 0.559
Validation loss decreased (-0.555540 --> -0.559244).  Saving model ...
Epoch: 19 cost time: 0.9848308563232422
Epoch: 19, Steps: 2 | Train Loss: 0.717 Vali Loss: 1.460 Vali Acc: 0.574 Test Loss: 1.460 Test Acc: 0.574
Validation loss decreased (-0.559244 --> -0.574059).  Saving model ...
Epoch: 20 cost time: 0.7492570877075195
Epoch: 20, Steps: 2 | Train Loss: 0.647 Vali Loss: 1.437 Vali Acc: 0.578 Test Loss: 1.437 Test Acc: 0.578
Validation loss decreased (-0.574059 --> -0.577763).  Saving model ...
Epoch: 21 cost time: 0.7676401138305664
Epoch: 21, Steps: 2 | Train Loss: 0.588 Vali Loss: 1.416 Vali Acc: 0.589 Test Loss: 1.416 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588875).  Saving model ...
Epoch: 22 cost time: 0.809028148651123
Epoch: 22, Steps: 2 | Train Loss: 0.561 Vali Loss: 1.397 Vali Acc: 0.593 Test Loss: 1.397 Test Acc: 0.593
Validation loss decreased (-0.588875 --> -0.592579).  Saving model ...
Epoch: 23 cost time: 0.8712024688720703
Epoch: 23, Steps: 2 | Train Loss: 0.523 Vali Loss: 1.380 Vali Acc: 0.600 Test Loss: 1.380 Test Acc: 0.600
Validation loss decreased (-0.592579 --> -0.599986).  Saving model ...
Epoch: 24 cost time: 0.7137486934661865
Epoch: 24, Steps: 2 | Train Loss: 0.460 Vali Loss: 1.365 Vali Acc: 0.607 Test Loss: 1.365 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.607394).  Saving model ...
Epoch: 25 cost time: 0.8013627529144287
Epoch: 25, Steps: 2 | Train Loss: 0.436 Vali Loss: 1.351 Vali Acc: 0.619 Test Loss: 1.351 Test Acc: 0.619
Validation loss decreased (-0.607394 --> -0.618505).  Saving model ...
Epoch: 26 cost time: 0.744779109954834
Epoch: 26, Steps: 2 | Train Loss: 0.386 Vali Loss: 1.337 Vali Acc: 0.619 Test Loss: 1.337 Test Acc: 0.619
Validation loss decreased (-0.618505 --> -0.618505).  Saving model ...
Epoch: 27 cost time: 0.740786075592041
Epoch: 27, Steps: 2 | Train Loss: 0.384 Vali Loss: 1.324 Vali Acc: 0.622 Test Loss: 1.324 Test Acc: 0.622
Validation loss decreased (-0.618505 --> -0.622209).  Saving model ...
Epoch: 28 cost time: 0.7853310108184814
Epoch: 28, Steps: 2 | Train Loss: 0.345 Vali Loss: 1.313 Vali Acc: 0.622 Test Loss: 1.313 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622209).  Saving model ...
Epoch: 29 cost time: 0.9649035930633545
Epoch: 29, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.303 Vali Acc: 0.615 Test Loss: 1.303 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8382296562194824
Epoch: 30, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.292 Vali Acc: 0.626 Test Loss: 1.292 Test Acc: 0.626
Validation loss decreased (-0.622209 --> -0.625913).  Saving model ...
Epoch: 31 cost time: 0.8254408836364746
Epoch: 31, Steps: 2 | Train Loss: 0.280 Vali Loss: 1.282 Vali Acc: 0.626 Test Loss: 1.282 Test Acc: 0.626
Validation loss decreased (-0.625913 --> -0.625913).  Saving model ...
Epoch: 32 cost time: 0.820056676864624
Epoch: 32, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.273 Vali Acc: 0.630 Test Loss: 1.273 Test Acc: 0.630
Validation loss decreased (-0.625913 --> -0.629617).  Saving model ...
Epoch: 33 cost time: 0.7065415382385254
Epoch: 33, Steps: 2 | Train Loss: 0.238 Vali Loss: 1.264 Vali Acc: 0.626 Test Loss: 1.264 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7506961822509766
Epoch: 34, Steps: 2 | Train Loss: 0.226 Vali Loss: 1.257 Vali Acc: 0.626 Test Loss: 1.257 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8158395290374756
Epoch: 35, Steps: 2 | Train Loss: 0.231 Vali Loss: 1.250 Vali Acc: 0.626 Test Loss: 1.250 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7455871105194092
Epoch: 36, Steps: 2 | Train Loss: 0.206 Vali Loss: 1.244 Vali Acc: 0.630 Test Loss: 1.244 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 37 cost time: 0.8080315589904785
Epoch: 37, Steps: 2 | Train Loss: 0.193 Vali Loss: 1.238 Vali Acc: 0.630 Test Loss: 1.238 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 38 cost time: 0.8962891101837158
Epoch: 38, Steps: 2 | Train Loss: 0.171 Vali Loss: 1.231 Vali Acc: 0.630 Test Loss: 1.231 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 39 cost time: 0.8133556842803955
Epoch: 39, Steps: 2 | Train Loss: 0.176 Vali Loss: 1.225 Vali Acc: 0.630 Test Loss: 1.225 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 40 cost time: 1.1028258800506592
Epoch: 40, Steps: 2 | Train Loss: 0.154 Vali Loss: 1.218 Vali Acc: 0.630 Test Loss: 1.218 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 41 cost time: 0.8932726383209229
Epoch: 41, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.211 Vali Acc: 0.615 Test Loss: 1.211 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7473063468933105
Epoch: 42, Steps: 2 | Train Loss: 0.152 Vali Loss: 1.204 Vali Acc: 0.619 Test Loss: 1.204 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.755117654800415
Epoch: 43, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.198 Vali Acc: 0.626 Test Loss: 1.198 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6555547714233398
Epoch: 44, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.192 Vali Acc: 0.630 Test Loss: 1.192 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629618).  Saving model ...
Epoch: 45 cost time: 0.7901933193206787
Epoch: 45, Steps: 2 | Train Loss: 0.130 Vali Loss: 1.188 Vali Acc: 0.622 Test Loss: 1.188 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7060215473175049
Epoch: 46, Steps: 2 | Train Loss: 0.117 Vali Loss: 1.185 Vali Acc: 0.619 Test Loss: 1.185 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.705376386642456
Epoch: 47, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.182 Vali Acc: 0.615 Test Loss: 1.182 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7585833072662354
Epoch: 48, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.179 Vali Acc: 0.615 Test Loss: 1.179 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.835125207901001
Epoch: 49, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.175 Vali Acc: 0.615 Test Loss: 1.175 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9198150634765625
Epoch: 50, Steps: 2 | Train Loss: 0.098 Vali Loss: 1.171 Vali Acc: 0.615 Test Loss: 1.171 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8910887241363525
Epoch: 51, Steps: 2 | Train Loss: 0.095 Vali Loss: 1.167 Vali Acc: 0.615 Test Loss: 1.167 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9340651035308838
Epoch: 52, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.164 Vali Acc: 0.622 Test Loss: 1.164 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.938990592956543
Epoch: 53, Steps: 2 | Train Loss: 0.090 Vali Loss: 1.160 Vali Acc: 0.622 Test Loss: 1.160 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9802851676940918
Epoch: 54, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.157 Vali Acc: 0.630 Test Loss: 1.157 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 55 cost time: 0.809985876083374
Epoch: 55, Steps: 2 | Train Loss: 0.076 Vali Loss: 1.154 Vali Acc: 0.633 Test Loss: 1.154 Test Acc: 0.633
Validation loss decreased (-0.629618 --> -0.633322).  Saving model ...
Epoch: 56 cost time: 0.7693345546722412
Epoch: 56, Steps: 2 | Train Loss: 0.073 Vali Loss: 1.152 Vali Acc: 0.633 Test Loss: 1.152 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 57 cost time: 0.7819216251373291
Epoch: 57, Steps: 2 | Train Loss: 0.071 Vali Loss: 1.149 Vali Acc: 0.633 Test Loss: 1.149 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 58 cost time: 0.807711124420166
Epoch: 58, Steps: 2 | Train Loss: 0.071 Vali Loss: 1.147 Vali Acc: 0.630 Test Loss: 1.147 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9904735088348389
Epoch: 59, Steps: 2 | Train Loss: 0.069 Vali Loss: 1.145 Vali Acc: 0.630 Test Loss: 1.145 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9671282768249512
Epoch: 60, Steps: 2 | Train Loss: 0.070 Vali Loss: 1.142 Vali Acc: 0.630 Test Loss: 1.142 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9684245586395264
Epoch: 61, Steps: 2 | Train Loss: 0.064 Vali Loss: 1.140 Vali Acc: 0.633 Test Loss: 1.140 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 62 cost time: 0.8483328819274902
Epoch: 62, Steps: 2 | Train Loss: 0.064 Vali Loss: 1.137 Vali Acc: 0.637 Test Loss: 1.137 Test Acc: 0.637
Validation loss decreased (-0.633322 --> -0.637026).  Saving model ...
Epoch: 63 cost time: 0.7492275238037109
Epoch: 63, Steps: 2 | Train Loss: 0.061 Vali Loss: 1.135 Vali Acc: 0.637 Test Loss: 1.135 Test Acc: 0.637
Validation loss decreased (-0.637026 --> -0.637026).  Saving model ...
Epoch: 64 cost time: 0.9828269481658936
Epoch: 64, Steps: 2 | Train Loss: 0.057 Vali Loss: 1.132 Vali Acc: 0.637 Test Loss: 1.132 Test Acc: 0.637
Validation loss decreased (-0.637026 --> -0.637026).  Saving model ...
Epoch: 65 cost time: 0.9687561988830566
Epoch: 65, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.129 Vali Acc: 0.637 Test Loss: 1.129 Test Acc: 0.637
Validation loss decreased (-0.637026 --> -0.637026).  Saving model ...
Epoch: 66 cost time: 0.8793008327484131
Epoch: 66, Steps: 2 | Train Loss: 0.055 Vali Loss: 1.126 Vali Acc: 0.637 Test Loss: 1.126 Test Acc: 0.637
Validation loss decreased (-0.637026 --> -0.637026).  Saving model ...
Epoch: 67 cost time: 0.7771425247192383
Epoch: 67, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.124 Vali Acc: 0.633 Test Loss: 1.124 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8520145416259766
Epoch: 68, Steps: 2 | Train Loss: 0.049 Vali Loss: 1.122 Vali Acc: 0.633 Test Loss: 1.122 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8356964588165283
Epoch: 69, Steps: 2 | Train Loss: 0.048 Vali Loss: 1.120 Vali Acc: 0.637 Test Loss: 1.120 Test Acc: 0.637
Validation loss decreased (-0.637026 --> -0.637026).  Saving model ...
Epoch: 70 cost time: 0.8869838714599609
Epoch: 70, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.118 Vali Acc: 0.641 Test Loss: 1.118 Test Acc: 0.641
Validation loss decreased (-0.637026 --> -0.640730).  Saving model ...
Epoch: 71 cost time: 0.8081026077270508
Epoch: 71, Steps: 2 | Train Loss: 0.043 Vali Loss: 1.116 Vali Acc: 0.637 Test Loss: 1.116 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9266064167022705
Epoch: 72, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.115 Vali Acc: 0.637 Test Loss: 1.115 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.81174635887146
Epoch: 73, Steps: 2 | Train Loss: 0.044 Vali Loss: 1.113 Vali Acc: 0.637 Test Loss: 1.113 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.8167729377746582
Epoch: 74, Steps: 2 | Train Loss: 0.043 Vali Loss: 1.112 Vali Acc: 0.637 Test Loss: 1.112 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.8872535228729248
Epoch: 75, Steps: 2 | Train Loss: 0.039 Vali Loss: 1.110 Vali Acc: 0.641 Test Loss: 1.110 Test Acc: 0.641
Validation loss decreased (-0.640730 --> -0.640730).  Saving model ...
Epoch: 76 cost time: 0.7432425022125244
Epoch: 76, Steps: 2 | Train Loss: 0.037 Vali Loss: 1.108 Vali Acc: 0.637 Test Loss: 1.108 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7587459087371826
Epoch: 77, Steps: 2 | Train Loss: 0.040 Vali Loss: 1.106 Vali Acc: 0.641 Test Loss: 1.106 Test Acc: 0.641
Validation loss decreased (-0.640730 --> -0.640730).  Saving model ...
Epoch: 78 cost time: 0.674508810043335
Epoch: 78, Steps: 2 | Train Loss: 0.036 Vali Loss: 1.105 Vali Acc: 0.641 Test Loss: 1.105 Test Acc: 0.641
Validation loss decreased (-0.640730 --> -0.640730).  Saving model ...
Epoch: 79 cost time: 0.7773728370666504
Epoch: 79, Steps: 2 | Train Loss: 0.037 Vali Loss: 1.103 Vali Acc: 0.637 Test Loss: 1.103 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8522803783416748
Epoch: 80, Steps: 2 | Train Loss: 0.033 Vali Loss: 1.102 Vali Acc: 0.641 Test Loss: 1.102 Test Acc: 0.641
Validation loss decreased (-0.640730 --> -0.640730).  Saving model ...
Epoch: 81 cost time: 0.7974023818969727
Epoch: 81, Steps: 2 | Train Loss: 0.033 Vali Loss: 1.100 Vali Acc: 0.644 Test Loss: 1.100 Test Acc: 0.644
Validation loss decreased (-0.640730 --> -0.644433).  Saving model ...
Epoch: 82 cost time: 0.9224798679351807
Epoch: 82, Steps: 2 | Train Loss: 0.033 Vali Loss: 1.098 Vali Acc: 0.648 Test Loss: 1.098 Test Acc: 0.648
Validation loss decreased (-0.644433 --> -0.648137).  Saving model ...
Epoch: 83 cost time: 0.7971947193145752
Epoch: 83, Steps: 2 | Train Loss: 0.034 Vali Loss: 1.097 Vali Acc: 0.648 Test Loss: 1.097 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 84 cost time: 0.6088912487030029
Epoch: 84, Steps: 2 | Train Loss: 0.031 Vali Loss: 1.095 Vali Acc: 0.648 Test Loss: 1.095 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 85 cost time: 0.8565340042114258
Epoch: 85, Steps: 2 | Train Loss: 0.032 Vali Loss: 1.094 Vali Acc: 0.644 Test Loss: 1.094 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.767897367477417
Epoch: 86, Steps: 2 | Train Loss: 0.030 Vali Loss: 1.092 Vali Acc: 0.644 Test Loss: 1.092 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.7387394905090332
Epoch: 87, Steps: 2 | Train Loss: 0.031 Vali Loss: 1.091 Vali Acc: 0.648 Test Loss: 1.091 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 88 cost time: 0.6588292121887207
Epoch: 88, Steps: 2 | Train Loss: 0.028 Vali Loss: 1.090 Vali Acc: 0.648 Test Loss: 1.090 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 89 cost time: 0.7940373420715332
Epoch: 89, Steps: 2 | Train Loss: 0.028 Vali Loss: 1.089 Vali Acc: 0.648 Test Loss: 1.089 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 90 cost time: 0.6737387180328369
Epoch: 90, Steps: 2 | Train Loss: 0.027 Vali Loss: 1.086 Vali Acc: 0.648 Test Loss: 1.086 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 91 cost time: 0.7171266078948975
Epoch: 91, Steps: 2 | Train Loss: 0.026 Vali Loss: 1.084 Vali Acc: 0.648 Test Loss: 1.084 Test Acc: 0.648
Validation loss decreased (-0.648137 --> -0.648137).  Saving model ...
Epoch: 92 cost time: 0.9236204624176025
Epoch: 92, Steps: 2 | Train Loss: 0.026 Vali Loss: 1.081 Vali Acc: 0.652 Test Loss: 1.081 Test Acc: 0.652
Validation loss decreased (-0.648137 --> -0.651841).  Saving model ...
Epoch: 93 cost time: 0.8136320114135742
Epoch: 93, Steps: 2 | Train Loss: 0.027 Vali Loss: 1.080 Vali Acc: 0.652 Test Loss: 1.080 Test Acc: 0.652
Validation loss decreased (-0.651841 --> -0.651841).  Saving model ...
Epoch: 94 cost time: 0.840775728225708
Epoch: 94, Steps: 2 | Train Loss: 0.023 Vali Loss: 1.078 Vali Acc: 0.656 Test Loss: 1.078 Test Acc: 0.656
Validation loss decreased (-0.651841 --> -0.655545).  Saving model ...
Epoch: 95 cost time: 0.7462162971496582
Epoch: 95, Steps: 2 | Train Loss: 0.025 Vali Loss: 1.077 Vali Acc: 0.652 Test Loss: 1.077 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.934323787689209
Epoch: 96, Steps: 2 | Train Loss: 0.023 Vali Loss: 1.076 Vali Acc: 0.644 Test Loss: 1.076 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.7883462905883789
Epoch: 97, Steps: 2 | Train Loss: 0.022 Vali Loss: 1.075 Vali Acc: 0.648 Test Loss: 1.075 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.7492654323577881
Epoch: 98, Steps: 2 | Train Loss: 0.021 Vali Loss: 1.074 Vali Acc: 0.652 Test Loss: 1.074 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.9728279113769531
Epoch: 99, Steps: 2 | Train Loss: 0.022 Vali Loss: 1.072 Vali Acc: 0.652 Test Loss: 1.072 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.8617546558380127
Epoch: 100, Steps: 2 | Train Loss: 0.022 Vali Loss: 1.071 Vali Acc: 0.648 Test Loss: 1.071 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6555555555555556
model parameter : 138936
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4070065021514893
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.798 Vali Acc: 0.133 Test Loss: 1.798 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.8498749732971191
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.789 Vali Acc: 0.141 Test Loss: 1.789 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.8984453678131104
Epoch: 3, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.777 Vali Acc: 0.144 Test Loss: 1.777 Test Acc: 0.144
Validation loss decreased (-0.140723 --> -0.144427).  Saving model ...
Epoch: 4 cost time: 0.6763927936553955
Epoch: 4, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.759 Vali Acc: 0.167 Test Loss: 1.759 Test Acc: 0.167
Validation loss decreased (-0.144427 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.7524278163909912
Epoch: 5, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.736 Vali Acc: 0.181 Test Loss: 1.736 Test Acc: 0.181
Validation loss decreased (-0.166649 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.8117265701293945
Epoch: 6, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.712 Vali Acc: 0.233 Test Loss: 1.712 Test Acc: 0.233
Validation loss decreased (-0.181464 --> -0.233316).  Saving model ...
Epoch: 7 cost time: 0.7217304706573486
Epoch: 7, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.686 Vali Acc: 0.256 Test Loss: 1.686 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255539).  Saving model ...
Epoch: 8 cost time: 0.8725330829620361
Epoch: 8, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.659 Vali Acc: 0.307 Test Loss: 1.659 Test Acc: 0.307
Validation loss decreased (-0.255539 --> -0.307391).  Saving model ...
Epoch: 9 cost time: 0.9525787830352783
Epoch: 9, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.632 Vali Acc: 0.348 Test Loss: 1.632 Test Acc: 0.348
Validation loss decreased (-0.307391 --> -0.348132).  Saving model ...
Epoch: 10 cost time: 0.75860595703125
Epoch: 10, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.606 Vali Acc: 0.422 Test Loss: 1.606 Test Acc: 0.422
Validation loss decreased (-0.348132 --> -0.422206).  Saving model ...
Epoch: 11 cost time: 0.766655683517456
Epoch: 11, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.580 Vali Acc: 0.452 Test Loss: 1.580 Test Acc: 0.452
Validation loss decreased (-0.422206 --> -0.451836).  Saving model ...
Epoch: 12 cost time: 0.7206952571868896
Epoch: 12, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.556 Vali Acc: 0.489 Test Loss: 1.556 Test Acc: 0.489
Validation loss decreased (-0.451836 --> -0.488873).  Saving model ...
Epoch: 13 cost time: 0.7092921733856201
Epoch: 13, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.534 Vali Acc: 0.511 Test Loss: 1.534 Test Acc: 0.511
Validation loss decreased (-0.488873 --> -0.511096).  Saving model ...
Epoch: 14 cost time: 0.7958667278289795
Epoch: 14, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.513 Vali Acc: 0.533 Test Loss: 1.513 Test Acc: 0.533
Validation loss decreased (-0.511096 --> -0.533318).  Saving model ...
Epoch: 15 cost time: 0.7503092288970947
Epoch: 15, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.493 Vali Acc: 0.541 Test Loss: 1.493 Test Acc: 0.541
Validation loss decreased (-0.533318 --> -0.540726).  Saving model ...
Epoch: 16 cost time: 0.7901406288146973
Epoch: 16, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.475 Vali Acc: 0.548 Test Loss: 1.475 Test Acc: 0.548
Validation loss decreased (-0.540726 --> -0.548133).  Saving model ...
Epoch: 17 cost time: 0.6891322135925293
Epoch: 17, Steps: 2 | Train Loss: 0.777 Vali Loss: 1.459 Vali Acc: 0.556 Test Loss: 1.459 Test Acc: 0.556
Validation loss decreased (-0.548133 --> -0.555541).  Saving model ...
Epoch: 18 cost time: 0.766312837600708
Epoch: 18, Steps: 2 | Train Loss: 0.719 Vali Loss: 1.444 Vali Acc: 0.563 Test Loss: 1.444 Test Acc: 0.563
Validation loss decreased (-0.555541 --> -0.562949).  Saving model ...
Epoch: 19 cost time: 0.7566900253295898
Epoch: 19, Steps: 2 | Train Loss: 0.688 Vali Loss: 1.432 Vali Acc: 0.563 Test Loss: 1.432 Test Acc: 0.563
Validation loss decreased (-0.562949 --> -0.562949).  Saving model ...
Epoch: 20 cost time: 0.7083635330200195
Epoch: 20, Steps: 2 | Train Loss: 0.605 Vali Loss: 1.419 Vali Acc: 0.574 Test Loss: 1.419 Test Acc: 0.574
Validation loss decreased (-0.562949 --> -0.574060).  Saving model ...
Epoch: 21 cost time: 0.6742010116577148
Epoch: 21, Steps: 2 | Train Loss: 0.565 Vali Loss: 1.407 Vali Acc: 0.581 Test Loss: 1.407 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581467).  Saving model ...
Epoch: 22 cost time: 0.7271692752838135
Epoch: 22, Steps: 2 | Train Loss: 0.524 Vali Loss: 1.395 Vali Acc: 0.589 Test Loss: 1.395 Test Acc: 0.589
Validation loss decreased (-0.581467 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 1.0547332763671875
Epoch: 23, Steps: 2 | Train Loss: 0.487 Vali Loss: 1.382 Vali Acc: 0.585 Test Loss: 1.382 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7780923843383789
Epoch: 24, Steps: 2 | Train Loss: 0.450 Vali Loss: 1.369 Vali Acc: 0.589 Test Loss: 1.369 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588875).  Saving model ...
Epoch: 25 cost time: 0.7259964942932129
Epoch: 25, Steps: 2 | Train Loss: 0.430 Vali Loss: 1.357 Vali Acc: 0.593 Test Loss: 1.357 Test Acc: 0.593
Validation loss decreased (-0.588875 --> -0.592579).  Saving model ...
Epoch: 26 cost time: 0.745868444442749
Epoch: 26, Steps: 2 | Train Loss: 0.408 Vali Loss: 1.347 Vali Acc: 0.593 Test Loss: 1.347 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 27 cost time: 0.8305411338806152
Epoch: 27, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.337 Vali Acc: 0.607 Test Loss: 1.337 Test Acc: 0.607
Validation loss decreased (-0.592579 --> -0.607394).  Saving model ...
Epoch: 28 cost time: 0.744678258895874
Epoch: 28, Steps: 2 | Train Loss: 0.355 Vali Loss: 1.327 Vali Acc: 0.611 Test Loss: 1.327 Test Acc: 0.611
Validation loss decreased (-0.607394 --> -0.611098).  Saving model ...
Epoch: 29 cost time: 0.6458501815795898
Epoch: 29, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.317 Vali Acc: 0.615 Test Loss: 1.317 Test Acc: 0.615
Validation loss decreased (-0.611098 --> -0.614802).  Saving model ...
Epoch: 30 cost time: 0.7035102844238281
Epoch: 30, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.309 Vali Acc: 0.615 Test Loss: 1.309 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 31 cost time: 0.7416868209838867
Epoch: 31, Steps: 2 | Train Loss: 0.290 Vali Loss: 1.301 Vali Acc: 0.615 Test Loss: 1.301 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 32 cost time: 0.8247146606445312
Epoch: 32, Steps: 2 | Train Loss: 0.262 Vali Loss: 1.293 Vali Acc: 0.622 Test Loss: 1.293 Test Acc: 0.622
Validation loss decreased (-0.614802 --> -0.622209).  Saving model ...
Epoch: 33 cost time: 0.8188960552215576
Epoch: 33, Steps: 2 | Train Loss: 0.253 Vali Loss: 1.288 Vali Acc: 0.615 Test Loss: 1.288 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7564225196838379
Epoch: 34, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.282 Vali Acc: 0.619 Test Loss: 1.282 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.773963212966919
Epoch: 35, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.277 Vali Acc: 0.619 Test Loss: 1.277 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6941208839416504
Epoch: 36, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.271 Vali Acc: 0.619 Test Loss: 1.271 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7958574295043945
Epoch: 37, Steps: 2 | Train Loss: 0.196 Vali Loss: 1.266 Vali Acc: 0.615 Test Loss: 1.266 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.865588903427124
Epoch: 38, Steps: 2 | Train Loss: 0.176 Vali Loss: 1.261 Vali Acc: 0.615 Test Loss: 1.261 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9182469844818115
Epoch: 39, Steps: 2 | Train Loss: 0.178 Vali Loss: 1.256 Vali Acc: 0.615 Test Loss: 1.256 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7107746601104736
Epoch: 40, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.251 Vali Acc: 0.619 Test Loss: 1.251 Test Acc: 0.619
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7209744453430176
Epoch: 41, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.246 Vali Acc: 0.600 Test Loss: 1.246 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6261036396026611
Epoch: 42, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.243 Vali Acc: 0.593 Test Loss: 1.243 Test Acc: 0.593
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6222222222222222
model parameter : 136888
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3684022426605225
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.791 Vali Acc: 0.200 Test Loss: 1.791 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.7678368091583252
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.785 Vali Acc: 0.204 Test Loss: 1.785 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.6695766448974609
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.774 Vali Acc: 0.204 Test Loss: 1.774 Test Acc: 0.204
Validation loss decreased (-0.203686 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.6152703762054443
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.755 Vali Acc: 0.241 Test Loss: 1.755 Test Acc: 0.241
Validation loss decreased (-0.203686 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.6913182735443115
Epoch: 5, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.730 Vali Acc: 0.252 Test Loss: 1.730 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 6 cost time: 0.8050384521484375
Epoch: 6, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.701 Vali Acc: 0.274 Test Loss: 1.701 Test Acc: 0.274
Validation loss decreased (-0.251835 --> -0.274057).  Saving model ...
Epoch: 7 cost time: 0.5867235660552979
Epoch: 7, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.675 Vali Acc: 0.304 Test Loss: 1.675 Test Acc: 0.304
Validation loss decreased (-0.274057 --> -0.303687).  Saving model ...
Epoch: 8 cost time: 0.8954041004180908
Epoch: 8, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.647 Vali Acc: 0.337 Test Loss: 1.647 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 0.5686614513397217
Epoch: 9, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.620 Vali Acc: 0.404 Test Loss: 1.620 Test Acc: 0.404
Validation loss decreased (-0.337021 --> -0.403688).  Saving model ...
Epoch: 10 cost time: 0.7118141651153564
Epoch: 10, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.593 Vali Acc: 0.437 Test Loss: 1.593 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437021).  Saving model ...
Epoch: 11 cost time: 0.8057518005371094
Epoch: 11, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.568 Vali Acc: 0.470 Test Loss: 1.568 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470355).  Saving model ...
Epoch: 12 cost time: 0.6988697052001953
Epoch: 12, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.544 Vali Acc: 0.485 Test Loss: 1.544 Test Acc: 0.485
Validation loss decreased (-0.470355 --> -0.485170).  Saving model ...
Epoch: 13 cost time: 0.6756999492645264
Epoch: 13, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.521 Vali Acc: 0.519 Test Loss: 1.521 Test Acc: 0.519
Validation loss decreased (-0.485170 --> -0.518503).  Saving model ...
Epoch: 14 cost time: 0.5759389400482178
Epoch: 14, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.500 Vali Acc: 0.537 Test Loss: 1.500 Test Acc: 0.537
Validation loss decreased (-0.518503 --> -0.537022).  Saving model ...
Epoch: 15 cost time: 0.6690394878387451
Epoch: 15, Steps: 2 | Train Loss: 0.812 Vali Loss: 1.478 Vali Acc: 0.559 Test Loss: 1.478 Test Acc: 0.559
Validation loss decreased (-0.537022 --> -0.559244).  Saving model ...
Epoch: 16 cost time: 0.6952245235443115
Epoch: 16, Steps: 2 | Train Loss: 0.734 Vali Loss: 1.453 Vali Acc: 0.585 Test Loss: 1.453 Test Acc: 0.585
Validation loss decreased (-0.559244 --> -0.585171).  Saving model ...
Epoch: 17 cost time: 0.6820554733276367
Epoch: 17, Steps: 2 | Train Loss: 0.707 Vali Loss: 1.431 Vali Acc: 0.578 Test Loss: 1.431 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9706032276153564
Epoch: 18, Steps: 2 | Train Loss: 0.640 Vali Loss: 1.408 Vali Acc: 0.578 Test Loss: 1.408 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7486128807067871
Epoch: 19, Steps: 2 | Train Loss: 0.585 Vali Loss: 1.384 Vali Acc: 0.596 Test Loss: 1.384 Test Acc: 0.596
Validation loss decreased (-0.585171 --> -0.596282).  Saving model ...
Epoch: 20 cost time: 0.7879164218902588
Epoch: 20, Steps: 2 | Train Loss: 0.538 Vali Loss: 1.364 Vali Acc: 0.596 Test Loss: 1.364 Test Acc: 0.596
Validation loss decreased (-0.596282 --> -0.596283).  Saving model ...
Epoch: 21 cost time: 0.582176923751831
Epoch: 21, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.346 Vali Acc: 0.589 Test Loss: 1.346 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6139094829559326
Epoch: 22, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.329 Vali Acc: 0.585 Test Loss: 1.329 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8227024078369141
Epoch: 23, Steps: 2 | Train Loss: 0.421 Vali Loss: 1.314 Vali Acc: 0.593 Test Loss: 1.314 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7369461059570312
Epoch: 24, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.596283 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 0.6783390045166016
Epoch: 25, Steps: 2 | Train Loss: 0.354 Vali Loss: 1.292 Vali Acc: 0.593 Test Loss: 1.292 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7674312591552734
Epoch: 26, Steps: 2 | Train Loss: 0.330 Vali Loss: 1.282 Vali Acc: 0.593 Test Loss: 1.282 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6392641067504883
Epoch: 27, Steps: 2 | Train Loss: 0.311 Vali Loss: 1.273 Vali Acc: 0.596 Test Loss: 1.273 Test Acc: 0.596
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6973581314086914
Epoch: 28, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.265 Vali Acc: 0.596 Test Loss: 1.265 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7840695381164551
Epoch: 29, Steps: 2 | Train Loss: 0.254 Vali Loss: 1.256 Vali Acc: 0.607 Test Loss: 1.256 Test Acc: 0.607
Validation loss decreased (-0.599987 --> -0.607395).  Saving model ...
Epoch: 30 cost time: 0.811715841293335
Epoch: 30, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.248 Vali Acc: 0.615 Test Loss: 1.248 Test Acc: 0.615
Validation loss decreased (-0.607395 --> -0.614802).  Saving model ...
Epoch: 31 cost time: 0.7100687026977539
Epoch: 31, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.239 Vali Acc: 0.619 Test Loss: 1.239 Test Acc: 0.619
Validation loss decreased (-0.614802 --> -0.618506).  Saving model ...
Epoch: 32 cost time: 0.8034629821777344
Epoch: 32, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.231 Vali Acc: 0.630 Test Loss: 1.231 Test Acc: 0.630
Validation loss decreased (-0.618506 --> -0.629617).  Saving model ...
Epoch: 33 cost time: 0.8121631145477295
Epoch: 33, Steps: 2 | Train Loss: 0.212 Vali Loss: 1.223 Vali Acc: 0.626 Test Loss: 1.223 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6343843936920166
Epoch: 34, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.215 Vali Acc: 0.622 Test Loss: 1.215 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7027707099914551
Epoch: 35, Steps: 2 | Train Loss: 0.178 Vali Loss: 1.209 Vali Acc: 0.626 Test Loss: 1.209 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8197026252746582
Epoch: 36, Steps: 2 | Train Loss: 0.179 Vali Loss: 1.203 Vali Acc: 0.622 Test Loss: 1.203 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8814406394958496
Epoch: 37, Steps: 2 | Train Loss: 0.162 Vali Loss: 1.197 Vali Acc: 0.622 Test Loss: 1.197 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9396896362304688
Epoch: 38, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.192 Vali Acc: 0.622 Test Loss: 1.192 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6361403465270996
Epoch: 39, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.188 Vali Acc: 0.619 Test Loss: 1.188 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6031796932220459
Epoch: 40, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.185 Vali Acc: 0.615 Test Loss: 1.185 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8307082653045654
Epoch: 41, Steps: 2 | Train Loss: 0.122 Vali Loss: 1.181 Vali Acc: 0.611 Test Loss: 1.181 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8900082111358643
Epoch: 42, Steps: 2 | Train Loss: 0.124 Vali Loss: 1.179 Vali Acc: 0.611 Test Loss: 1.179 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6296296296296297
model parameter : 135864
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.263291835784912
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.791 Vali Acc: 0.200 Test Loss: 1.791 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.635591983795166
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.785 Vali Acc: 0.204 Test Loss: 1.785 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.6490066051483154
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.774 Vali Acc: 0.204 Test Loss: 1.774 Test Acc: 0.204
Validation loss decreased (-0.203686 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.8822965621948242
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.755 Vali Acc: 0.241 Test Loss: 1.755 Test Acc: 0.241
Validation loss decreased (-0.203686 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.688793420791626
Epoch: 5, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.730 Vali Acc: 0.252 Test Loss: 1.730 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 6 cost time: 0.6952269077301025
Epoch: 6, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.701 Vali Acc: 0.274 Test Loss: 1.701 Test Acc: 0.274
Validation loss decreased (-0.251835 --> -0.274057).  Saving model ...
Epoch: 7 cost time: 0.4733426570892334
Epoch: 7, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.675 Vali Acc: 0.304 Test Loss: 1.675 Test Acc: 0.304
Validation loss decreased (-0.274057 --> -0.303687).  Saving model ...
Epoch: 8 cost time: 0.5572643280029297
Epoch: 8, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.647 Vali Acc: 0.337 Test Loss: 1.647 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 0.47946977615356445
Epoch: 9, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.620 Vali Acc: 0.404 Test Loss: 1.620 Test Acc: 0.404
Validation loss decreased (-0.337021 --> -0.403688).  Saving model ...
Epoch: 10 cost time: 0.6386411190032959
Epoch: 10, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.593 Vali Acc: 0.437 Test Loss: 1.593 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437021).  Saving model ...
Epoch: 11 cost time: 0.5672335624694824
Epoch: 11, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.568 Vali Acc: 0.470 Test Loss: 1.568 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470355).  Saving model ...
Epoch: 12 cost time: 0.7835237979888916
Epoch: 12, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.544 Vali Acc: 0.485 Test Loss: 1.544 Test Acc: 0.485
Validation loss decreased (-0.470355 --> -0.485170).  Saving model ...
Epoch: 13 cost time: 0.6658835411071777
Epoch: 13, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.521 Vali Acc: 0.519 Test Loss: 1.521 Test Acc: 0.519
Validation loss decreased (-0.485170 --> -0.518503).  Saving model ...
Epoch: 14 cost time: 0.7044765949249268
Epoch: 14, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.500 Vali Acc: 0.537 Test Loss: 1.500 Test Acc: 0.537
Validation loss decreased (-0.518503 --> -0.537022).  Saving model ...
Epoch: 15 cost time: 0.5701591968536377
Epoch: 15, Steps: 2 | Train Loss: 0.812 Vali Loss: 1.478 Vali Acc: 0.559 Test Loss: 1.478 Test Acc: 0.559
Validation loss decreased (-0.537022 --> -0.559244).  Saving model ...
Epoch: 16 cost time: 0.5092136859893799
Epoch: 16, Steps: 2 | Train Loss: 0.734 Vali Loss: 1.453 Vali Acc: 0.585 Test Loss: 1.453 Test Acc: 0.585
Validation loss decreased (-0.559244 --> -0.585171).  Saving model ...
Epoch: 17 cost time: 0.5348200798034668
Epoch: 17, Steps: 2 | Train Loss: 0.707 Vali Loss: 1.431 Vali Acc: 0.578 Test Loss: 1.431 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6502735614776611
Epoch: 18, Steps: 2 | Train Loss: 0.640 Vali Loss: 1.408 Vali Acc: 0.578 Test Loss: 1.408 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.646233081817627
Epoch: 19, Steps: 2 | Train Loss: 0.585 Vali Loss: 1.384 Vali Acc: 0.596 Test Loss: 1.384 Test Acc: 0.596
Validation loss decreased (-0.585171 --> -0.596282).  Saving model ...
Epoch: 20 cost time: 0.6988418102264404
Epoch: 20, Steps: 2 | Train Loss: 0.538 Vali Loss: 1.364 Vali Acc: 0.596 Test Loss: 1.364 Test Acc: 0.596
Validation loss decreased (-0.596282 --> -0.596283).  Saving model ...
Epoch: 21 cost time: 0.5864276885986328
Epoch: 21, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.346 Vali Acc: 0.589 Test Loss: 1.346 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7522635459899902
Epoch: 22, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.329 Vali Acc: 0.585 Test Loss: 1.329 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5465595722198486
Epoch: 23, Steps: 2 | Train Loss: 0.421 Vali Loss: 1.314 Vali Acc: 0.593 Test Loss: 1.314 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7395937442779541
Epoch: 24, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.596283 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 0.642686128616333
Epoch: 25, Steps: 2 | Train Loss: 0.354 Vali Loss: 1.292 Vali Acc: 0.593 Test Loss: 1.292 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7587080001831055
Epoch: 26, Steps: 2 | Train Loss: 0.330 Vali Loss: 1.282 Vali Acc: 0.593 Test Loss: 1.282 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6250162124633789
Epoch: 27, Steps: 2 | Train Loss: 0.311 Vali Loss: 1.273 Vali Acc: 0.596 Test Loss: 1.273 Test Acc: 0.596
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5736677646636963
Epoch: 28, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.265 Vali Acc: 0.596 Test Loss: 1.265 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6850345134735107
Epoch: 29, Steps: 2 | Train Loss: 0.254 Vali Loss: 1.256 Vali Acc: 0.607 Test Loss: 1.256 Test Acc: 0.607
Validation loss decreased (-0.599987 --> -0.607395).  Saving model ...
Epoch: 30 cost time: 0.6803245544433594
Epoch: 30, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.248 Vali Acc: 0.615 Test Loss: 1.248 Test Acc: 0.615
Validation loss decreased (-0.607395 --> -0.614802).  Saving model ...
Epoch: 31 cost time: 0.8041937351226807
Epoch: 31, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.239 Vali Acc: 0.619 Test Loss: 1.239 Test Acc: 0.619
Validation loss decreased (-0.614802 --> -0.618506).  Saving model ...
Epoch: 32 cost time: 0.6300239562988281
Epoch: 32, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.231 Vali Acc: 0.630 Test Loss: 1.231 Test Acc: 0.630
Validation loss decreased (-0.618506 --> -0.629617).  Saving model ...
Epoch: 33 cost time: 0.5844905376434326
Epoch: 33, Steps: 2 | Train Loss: 0.212 Vali Loss: 1.223 Vali Acc: 0.626 Test Loss: 1.223 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5340960025787354
Epoch: 34, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.215 Vali Acc: 0.622 Test Loss: 1.215 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7821152210235596
Epoch: 35, Steps: 2 | Train Loss: 0.178 Vali Loss: 1.209 Vali Acc: 0.626 Test Loss: 1.209 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6149237155914307
Epoch: 36, Steps: 2 | Train Loss: 0.179 Vali Loss: 1.203 Vali Acc: 0.622 Test Loss: 1.203 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7221055030822754
Epoch: 37, Steps: 2 | Train Loss: 0.162 Vali Loss: 1.197 Vali Acc: 0.622 Test Loss: 1.197 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7150063514709473
Epoch: 38, Steps: 2 | Train Loss: 0.146 Vali Loss: 1.192 Vali Acc: 0.622 Test Loss: 1.192 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6345133781433105
Epoch: 39, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.188 Vali Acc: 0.619 Test Loss: 1.188 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6702823638916016
Epoch: 40, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.185 Vali Acc: 0.615 Test Loss: 1.185 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7862591743469238
Epoch: 41, Steps: 2 | Train Loss: 0.122 Vali Loss: 1.181 Vali Acc: 0.611 Test Loss: 1.181 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.739375114440918
Epoch: 42, Steps: 2 | Train Loss: 0.124 Vali Loss: 1.179 Vali Acc: 0.611 Test Loss: 1.179 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6296296296296297
model parameter : 135864
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6082959175109863
Epoch: 1, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.870 Vali Acc: 0.170 Test Loss: 1.870 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.9394969940185547
Epoch: 2, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.866 Vali Acc: 0.174 Test Loss: 1.866 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.922065019607544
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.862 Vali Acc: 0.181 Test Loss: 1.862 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181463).  Saving model ...
Epoch: 4 cost time: 0.9159126281738281
Epoch: 4, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.858 Vali Acc: 0.185 Test Loss: 1.858 Test Acc: 0.185
Validation loss decreased (-0.181463 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.849606990814209
Epoch: 5, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.854 Vali Acc: 0.196 Test Loss: 1.854 Test Acc: 0.196
Validation loss decreased (-0.185167 --> -0.196278).  Saving model ...
Epoch: 6 cost time: 0.7145779132843018
Epoch: 6, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.848 Vali Acc: 0.207 Test Loss: 1.848 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 7 cost time: 0.9185960292816162
Epoch: 7, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.842 Vali Acc: 0.207 Test Loss: 1.842 Test Acc: 0.207
Validation loss decreased (-0.207389 --> -0.207389).  Saving model ...
Epoch: 8 cost time: 0.8700189590454102
Epoch: 8, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.835 Vali Acc: 0.226 Test Loss: 1.835 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.8670756816864014
Epoch: 9, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.827 Vali Acc: 0.230 Test Loss: 1.827 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229611).  Saving model ...
Epoch: 10 cost time: 0.6169166564941406
Epoch: 10, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.819 Vali Acc: 0.230 Test Loss: 1.819 Test Acc: 0.230
Validation loss decreased (-0.229611 --> -0.229611).  Saving model ...
Epoch: 11 cost time: 0.9980301856994629
Epoch: 11, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.810 Vali Acc: 0.244 Test Loss: 1.810 Test Acc: 0.244
Validation loss decreased (-0.229611 --> -0.244426).  Saving model ...
Epoch: 12 cost time: 0.6855204105377197
Epoch: 12, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.801 Vali Acc: 0.256 Test Loss: 1.801 Test Acc: 0.256
Validation loss decreased (-0.244426 --> -0.255538).  Saving model ...
Epoch: 13 cost time: 0.6895186901092529
Epoch: 13, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.792 Vali Acc: 0.263 Test Loss: 1.792 Test Acc: 0.263
Validation loss decreased (-0.255538 --> -0.262945).  Saving model ...
Epoch: 14 cost time: 0.949674129486084
Epoch: 14, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.782 Vali Acc: 0.274 Test Loss: 1.782 Test Acc: 0.274
Validation loss decreased (-0.262945 --> -0.274056).  Saving model ...
Epoch: 15 cost time: 0.7108962535858154
Epoch: 15, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.772 Vali Acc: 0.285 Test Loss: 1.772 Test Acc: 0.285
Validation loss decreased (-0.274056 --> -0.285167).  Saving model ...
Epoch: 16 cost time: 0.6687610149383545
Epoch: 16, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.762 Vali Acc: 0.307 Test Loss: 1.762 Test Acc: 0.307
Validation loss decreased (-0.285167 --> -0.307390).  Saving model ...
Epoch: 17 cost time: 0.7171247005462646
Epoch: 17, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.751 Vali Acc: 0.315 Test Loss: 1.751 Test Acc: 0.315
Validation loss decreased (-0.307390 --> -0.314797).  Saving model ...
Epoch: 18 cost time: 0.7152154445648193
Epoch: 18, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.740 Vali Acc: 0.330 Test Loss: 1.740 Test Acc: 0.330
Validation loss decreased (-0.314797 --> -0.329612).  Saving model ...
Epoch: 19 cost time: 0.9493026733398438
Epoch: 19, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.729 Vali Acc: 0.348 Test Loss: 1.729 Test Acc: 0.348
Validation loss decreased (-0.329612 --> -0.348131).  Saving model ...
Epoch: 20 cost time: 0.7320380210876465
Epoch: 20, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.719 Vali Acc: 0.367 Test Loss: 1.719 Test Acc: 0.367
Validation loss decreased (-0.348131 --> -0.366649).  Saving model ...
Epoch: 21 cost time: 0.6486432552337646
Epoch: 21, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.708 Vali Acc: 0.393 Test Loss: 1.708 Test Acc: 0.393
Validation loss decreased (-0.366649 --> -0.392576).  Saving model ...
Epoch: 22 cost time: 0.524855375289917
Epoch: 22, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.697 Vali Acc: 0.400 Test Loss: 1.697 Test Acc: 0.400
Validation loss decreased (-0.392576 --> -0.399983).  Saving model ...
Epoch: 23 cost time: 0.7855310440063477
Epoch: 23, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.685 Vali Acc: 0.419 Test Loss: 1.685 Test Acc: 0.419
Validation loss decreased (-0.399983 --> -0.418502).  Saving model ...
Epoch: 24 cost time: 0.6636636257171631
Epoch: 24, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.674 Vali Acc: 0.430 Test Loss: 1.674 Test Acc: 0.430
Validation loss decreased (-0.418502 --> -0.429613).  Saving model ...
Epoch: 25 cost time: 1.0494840145111084
Epoch: 25, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.663 Vali Acc: 0.459 Test Loss: 1.663 Test Acc: 0.459
Validation loss decreased (-0.429613 --> -0.459243).  Saving model ...
Epoch: 26 cost time: 0.8064477443695068
Epoch: 26, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.651 Vali Acc: 0.493 Test Loss: 1.651 Test Acc: 0.493
Validation loss decreased (-0.459243 --> -0.492576).  Saving model ...
Epoch: 27 cost time: 0.6704216003417969
Epoch: 27, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.639 Vali Acc: 0.496 Test Loss: 1.639 Test Acc: 0.496
Validation loss decreased (-0.492576 --> -0.496280).  Saving model ...
Epoch: 28 cost time: 0.9800806045532227
Epoch: 28, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.627 Vali Acc: 0.511 Test Loss: 1.627 Test Acc: 0.511
Validation loss decreased (-0.496280 --> -0.511095).  Saving model ...
Epoch: 29 cost time: 0.8953795433044434
Epoch: 29, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.615 Vali Acc: 0.515 Test Loss: 1.615 Test Acc: 0.515
Validation loss decreased (-0.511095 --> -0.514799).  Saving model ...
Epoch: 30 cost time: 0.8528752326965332
Epoch: 30, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.603 Vali Acc: 0.530 Test Loss: 1.603 Test Acc: 0.530
Validation loss decreased (-0.514799 --> -0.529614).  Saving model ...
Epoch: 31 cost time: 0.9853084087371826
Epoch: 31, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.591 Vali Acc: 0.537 Test Loss: 1.591 Test Acc: 0.537
Validation loss decreased (-0.529614 --> -0.537021).  Saving model ...
Epoch: 32 cost time: 0.9151942729949951
Epoch: 32, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.578 Vali Acc: 0.559 Test Loss: 1.578 Test Acc: 0.559
Validation loss decreased (-0.537021 --> -0.559243).  Saving model ...
Epoch: 33 cost time: 0.845224142074585
Epoch: 33, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.566 Vali Acc: 0.570 Test Loss: 1.566 Test Acc: 0.570
Validation loss decreased (-0.559243 --> -0.570355).  Saving model ...
Epoch: 34 cost time: 0.744178056716919
Epoch: 34, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.553 Vali Acc: 0.574 Test Loss: 1.553 Test Acc: 0.574
Validation loss decreased (-0.570355 --> -0.574059).  Saving model ...
Epoch: 35 cost time: 0.8818933963775635
Epoch: 35, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.541 Vali Acc: 0.581 Test Loss: 1.541 Test Acc: 0.581
Validation loss decreased (-0.574059 --> -0.581466).  Saving model ...
Epoch: 36 cost time: 0.8552720546722412
Epoch: 36, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.529 Vali Acc: 0.589 Test Loss: 1.529 Test Acc: 0.589
Validation loss decreased (-0.581466 --> -0.588874).  Saving model ...
Epoch: 37 cost time: 1.036102533340454
Epoch: 37, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.516 Vali Acc: 0.607 Test Loss: 1.516 Test Acc: 0.607
Validation loss decreased (-0.588874 --> -0.607392).  Saving model ...
Epoch: 38 cost time: 0.6858429908752441
Epoch: 38, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.504 Vali Acc: 0.615 Test Loss: 1.504 Test Acc: 0.615
Validation loss decreased (-0.607392 --> -0.614800).  Saving model ...
Epoch: 39 cost time: 0.7096176147460938
Epoch: 39, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.492 Vali Acc: 0.619 Test Loss: 1.492 Test Acc: 0.619
Validation loss decreased (-0.614800 --> -0.618504).  Saving model ...
Epoch: 40 cost time: 0.9435021877288818
Epoch: 40, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.480 Vali Acc: 0.622 Test Loss: 1.480 Test Acc: 0.622
Validation loss decreased (-0.618504 --> -0.622207).  Saving model ...
Epoch: 41 cost time: 0.9533987045288086
Epoch: 41, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.469 Vali Acc: 0.626 Test Loss: 1.469 Test Acc: 0.626
Validation loss decreased (-0.622207 --> -0.625911).  Saving model ...
Epoch: 42 cost time: 0.9729981422424316
Epoch: 42, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.457 Vali Acc: 0.633 Test Loss: 1.457 Test Acc: 0.633
Validation loss decreased (-0.625911 --> -0.633319).  Saving model ...
Epoch: 43 cost time: 0.6509594917297363
Epoch: 43, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.447 Vali Acc: 0.633 Test Loss: 1.447 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 1.0036559104919434
Epoch: 44, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.436 Vali Acc: 0.641 Test Loss: 1.436 Test Acc: 0.641
Validation loss decreased (-0.633319 --> -0.640726).  Saving model ...
Epoch: 45 cost time: 0.9516198635101318
Epoch: 45, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.426 Vali Acc: 0.648 Test Loss: 1.426 Test Acc: 0.648
Validation loss decreased (-0.640726 --> -0.648134).  Saving model ...
Epoch: 46 cost time: 0.7976107597351074
Epoch: 46, Steps: 2 | Train Loss: 0.870 Vali Loss: 1.416 Vali Acc: 0.637 Test Loss: 1.416 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9542169570922852
Epoch: 47, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.406 Vali Acc: 0.644 Test Loss: 1.406 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6526393890380859
Epoch: 48, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.397 Vali Acc: 0.644 Test Loss: 1.397 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.790156364440918
Epoch: 49, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.387 Vali Acc: 0.648 Test Loss: 1.387 Test Acc: 0.648
Validation loss decreased (-0.648134 --> -0.648134).  Saving model ...
Epoch: 50 cost time: 0.83121657371521
Epoch: 50, Steps: 2 | Train Loss: 0.806 Vali Loss: 1.378 Vali Acc: 0.644 Test Loss: 1.378 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9083127975463867
Epoch: 51, Steps: 2 | Train Loss: 0.746 Vali Loss: 1.368 Vali Acc: 0.652 Test Loss: 1.368 Test Acc: 0.652
Validation loss decreased (-0.648134 --> -0.651838).  Saving model ...
Epoch: 52 cost time: 0.9306864738464355
Epoch: 52, Steps: 2 | Train Loss: 0.742 Vali Loss: 1.359 Vali Acc: 0.656 Test Loss: 1.359 Test Acc: 0.656
Validation loss decreased (-0.651838 --> -0.655542).  Saving model ...
Epoch: 53 cost time: 0.8573381900787354
Epoch: 53, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.349 Vali Acc: 0.656 Test Loss: 1.349 Test Acc: 0.656
Validation loss decreased (-0.655542 --> -0.655542).  Saving model ...
Epoch: 54 cost time: 0.7824037075042725
Epoch: 54, Steps: 2 | Train Loss: 0.707 Vali Loss: 1.340 Vali Acc: 0.659 Test Loss: 1.340 Test Acc: 0.659
Validation loss decreased (-0.655542 --> -0.659246).  Saving model ...
Epoch: 55 cost time: 0.7884585857391357
Epoch: 55, Steps: 2 | Train Loss: 0.678 Vali Loss: 1.331 Vali Acc: 0.663 Test Loss: 1.331 Test Acc: 0.663
Validation loss decreased (-0.659246 --> -0.662950).  Saving model ...
Epoch: 56 cost time: 0.6825175285339355
Epoch: 56, Steps: 2 | Train Loss: 0.676 Vali Loss: 1.322 Vali Acc: 0.667 Test Loss: 1.322 Test Acc: 0.667
Validation loss decreased (-0.662950 --> -0.666653).  Saving model ...
Epoch: 57 cost time: 0.8452813625335693
Epoch: 57, Steps: 2 | Train Loss: 0.623 Vali Loss: 1.313 Vali Acc: 0.670 Test Loss: 1.313 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.670357).  Saving model ...
Epoch: 58 cost time: 1.0305781364440918
Epoch: 58, Steps: 2 | Train Loss: 0.608 Vali Loss: 1.304 Vali Acc: 0.670 Test Loss: 1.304 Test Acc: 0.670
Validation loss decreased (-0.670357 --> -0.670357).  Saving model ...
Epoch: 59 cost time: 0.9359815120697021
Epoch: 59, Steps: 2 | Train Loss: 0.591 Vali Loss: 1.296 Vali Acc: 0.670 Test Loss: 1.296 Test Acc: 0.670
Validation loss decreased (-0.670357 --> -0.670357).  Saving model ...
Epoch: 60 cost time: 0.806760311126709
Epoch: 60, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.287 Vali Acc: 0.670 Test Loss: 1.287 Test Acc: 0.670
Validation loss decreased (-0.670357 --> -0.670357).  Saving model ...
Epoch: 61 cost time: 0.9086906909942627
Epoch: 61, Steps: 2 | Train Loss: 0.560 Vali Loss: 1.279 Vali Acc: 0.670 Test Loss: 1.279 Test Acc: 0.670
Validation loss decreased (-0.670357 --> -0.670358).  Saving model ...
Epoch: 62 cost time: 0.7518327236175537
Epoch: 62, Steps: 2 | Train Loss: 0.510 Vali Loss: 1.272 Vali Acc: 0.674 Test Loss: 1.272 Test Acc: 0.674
Validation loss decreased (-0.670358 --> -0.674061).  Saving model ...
Epoch: 63 cost time: 0.8474369049072266
Epoch: 63, Steps: 2 | Train Loss: 0.528 Vali Loss: 1.264 Vali Acc: 0.663 Test Loss: 1.264 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.75942063331604
Epoch: 64, Steps: 2 | Train Loss: 0.487 Vali Loss: 1.256 Vali Acc: 0.663 Test Loss: 1.256 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8727836608886719
Epoch: 65, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.249 Vali Acc: 0.663 Test Loss: 1.249 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8168807029724121
Epoch: 66, Steps: 2 | Train Loss: 0.480 Vali Loss: 1.242 Vali Acc: 0.659 Test Loss: 1.242 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7300803661346436
Epoch: 67, Steps: 2 | Train Loss: 0.453 Vali Loss: 1.234 Vali Acc: 0.659 Test Loss: 1.234 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.8519487380981445
Epoch: 68, Steps: 2 | Train Loss: 0.436 Vali Loss: 1.227 Vali Acc: 0.663 Test Loss: 1.227 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.7818930149078369
Epoch: 69, Steps: 2 | Train Loss: 0.402 Vali Loss: 1.220 Vali Acc: 0.663 Test Loss: 1.220 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.9364950656890869
Epoch: 70, Steps: 2 | Train Loss: 0.385 Vali Loss: 1.213 Vali Acc: 0.670 Test Loss: 1.213 Test Acc: 0.670
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.8340418338775635
Epoch: 71, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.207 Vali Acc: 0.678 Test Loss: 1.207 Test Acc: 0.678
Validation loss decreased (-0.674061 --> -0.677766).  Saving model ...
Epoch: 72 cost time: 0.7889046669006348
Epoch: 72, Steps: 2 | Train Loss: 0.383 Vali Loss: 1.200 Vali Acc: 0.678 Test Loss: 1.200 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 73 cost time: 0.8862519264221191
Epoch: 73, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.193 Vali Acc: 0.681 Test Loss: 1.193 Test Acc: 0.681
Validation loss decreased (-0.677766 --> -0.681470).  Saving model ...
Epoch: 74 cost time: 0.7403888702392578
Epoch: 74, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.186 Vali Acc: 0.678 Test Loss: 1.186 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7422034740447998
Epoch: 75, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.180 Vali Acc: 0.678 Test Loss: 1.180 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.7183651924133301
Epoch: 76, Steps: 2 | Train Loss: 0.322 Vali Loss: 1.173 Vali Acc: 0.681 Test Loss: 1.173 Test Acc: 0.681
Validation loss decreased (-0.681470 --> -0.681470).  Saving model ...
Epoch: 77 cost time: 0.825833797454834
Epoch: 77, Steps: 2 | Train Loss: 0.306 Vali Loss: 1.166 Vali Acc: 0.681 Test Loss: 1.166 Test Acc: 0.681
Validation loss decreased (-0.681470 --> -0.681470).  Saving model ...
Epoch: 78 cost time: 0.7641592025756836
Epoch: 78, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.160 Vali Acc: 0.678 Test Loss: 1.160 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7700920104980469
Epoch: 79, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.154 Vali Acc: 0.681 Test Loss: 1.154 Test Acc: 0.681
Validation loss decreased (-0.681470 --> -0.681470).  Saving model ...
Epoch: 80 cost time: 0.615753173828125
Epoch: 80, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.148 Vali Acc: 0.681 Test Loss: 1.148 Test Acc: 0.681
Validation loss decreased (-0.681470 --> -0.681470).  Saving model ...
Epoch: 81 cost time: 0.8701901435852051
Epoch: 81, Steps: 2 | Train Loss: 0.271 Vali Loss: 1.142 Vali Acc: 0.681 Test Loss: 1.142 Test Acc: 0.681
Validation loss decreased (-0.681470 --> -0.681470).  Saving model ...
Epoch: 82 cost time: 0.8378095626831055
Epoch: 82, Steps: 2 | Train Loss: 0.263 Vali Loss: 1.136 Vali Acc: 0.685 Test Loss: 1.136 Test Acc: 0.685
Validation loss decreased (-0.681470 --> -0.685174).  Saving model ...
Epoch: 83 cost time: 0.7565879821777344
Epoch: 83, Steps: 2 | Train Loss: 0.247 Vali Loss: 1.129 Vali Acc: 0.689 Test Loss: 1.129 Test Acc: 0.689
Validation loss decreased (-0.685174 --> -0.688878).  Saving model ...
Epoch: 84 cost time: 0.9340033531188965
Epoch: 84, Steps: 2 | Train Loss: 0.224 Vali Loss: 1.123 Vali Acc: 0.685 Test Loss: 1.123 Test Acc: 0.685
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.6586697101593018
Epoch: 85, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.118 Vali Acc: 0.689 Test Loss: 1.118 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 86 cost time: 0.7090716361999512
Epoch: 86, Steps: 2 | Train Loss: 0.236 Vali Loss: 1.112 Vali Acc: 0.689 Test Loss: 1.112 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 87 cost time: 0.8558156490325928
Epoch: 87, Steps: 2 | Train Loss: 0.213 Vali Loss: 1.107 Vali Acc: 0.693 Test Loss: 1.107 Test Acc: 0.693
Validation loss decreased (-0.688878 --> -0.692582).  Saving model ...
Epoch: 88 cost time: 0.7977678775787354
Epoch: 88, Steps: 2 | Train Loss: 0.200 Vali Loss: 1.102 Vali Acc: 0.693 Test Loss: 1.102 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692582).  Saving model ...
Epoch: 89 cost time: 0.7024838924407959
Epoch: 89, Steps: 2 | Train Loss: 0.191 Vali Loss: 1.097 Vali Acc: 0.693 Test Loss: 1.097 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692582).  Saving model ...
Epoch: 90 cost time: 0.7424724102020264
Epoch: 90, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.093 Vali Acc: 0.693 Test Loss: 1.093 Test Acc: 0.693
Validation loss decreased (-0.692582 --> -0.692582).  Saving model ...
Epoch: 91 cost time: 0.6847999095916748
Epoch: 91, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.088 Vali Acc: 0.689 Test Loss: 1.088 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.8526210784912109
Epoch: 92, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.084 Vali Acc: 0.685 Test Loss: 1.084 Test Acc: 0.685
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.880901575088501
Epoch: 93, Steps: 2 | Train Loss: 0.175 Vali Loss: 1.080 Vali Acc: 0.681 Test Loss: 1.080 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.8180563449859619
Epoch: 94, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.077 Vali Acc: 0.681 Test Loss: 1.077 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.745413064956665
Epoch: 95, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.073 Vali Acc: 0.681 Test Loss: 1.073 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.7317595481872559
Epoch: 96, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.069 Vali Acc: 0.685 Test Loss: 1.069 Test Acc: 0.685
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.7568783760070801
Epoch: 97, Steps: 2 | Train Loss: 0.152 Vali Loss: 1.065 Vali Acc: 0.685 Test Loss: 1.065 Test Acc: 0.685
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.8028016090393066
Epoch: 98, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.060 Vali Acc: 0.685 Test Loss: 1.060 Test Acc: 0.685
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.8880620002746582
Epoch: 99, Steps: 2 | Train Loss: 0.154 Vali Loss: 1.056 Vali Acc: 0.685 Test Loss: 1.056 Test Acc: 0.685
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 1.0060391426086426
Epoch: 100, Steps: 2 | Train Loss: 0.140 Vali Loss: 1.053 Vali Acc: 0.685 Test Loss: 1.053 Test Acc: 0.685
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6925925925925925
model parameter : 72932
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.561384677886963
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.782 Vali Acc: 0.174 Test Loss: 1.782 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.6749463081359863
Epoch: 2, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.776 Vali Acc: 0.178 Test Loss: 1.776 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.8280370235443115
Epoch: 3, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.771 Vali Acc: 0.181 Test Loss: 1.771 Test Acc: 0.181
Validation loss decreased (-0.177760 --> -0.181464).  Saving model ...
Epoch: 4 cost time: 0.6520047187805176
Epoch: 4, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.766 Vali Acc: 0.181 Test Loss: 1.766 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 5 cost time: 0.7692630290985107
Epoch: 5, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.761 Vali Acc: 0.181 Test Loss: 1.761 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.6575489044189453
Epoch: 6, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.754 Vali Acc: 0.185 Test Loss: 1.754 Test Acc: 0.185
Validation loss decreased (-0.181464 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.8339204788208008
Epoch: 7, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.746 Vali Acc: 0.196 Test Loss: 1.746 Test Acc: 0.196
Validation loss decreased (-0.185168 --> -0.196279).  Saving model ...
Epoch: 8 cost time: 0.9731230735778809
Epoch: 8, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.738 Vali Acc: 0.204 Test Loss: 1.738 Test Acc: 0.204
Validation loss decreased (-0.196279 --> -0.203686).  Saving model ...
Epoch: 9 cost time: 0.8323209285736084
Epoch: 9, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.729 Vali Acc: 0.219 Test Loss: 1.729 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 10 cost time: 0.8733415603637695
Epoch: 10, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.719 Vali Acc: 0.233 Test Loss: 1.719 Test Acc: 0.233
Validation loss decreased (-0.218501 --> -0.233316).  Saving model ...
Epoch: 11 cost time: 0.8592307567596436
Epoch: 11, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.709 Vali Acc: 0.237 Test Loss: 1.709 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237020).  Saving model ...
Epoch: 12 cost time: 0.7734994888305664
Epoch: 12, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.699 Vali Acc: 0.237 Test Loss: 1.699 Test Acc: 0.237
Validation loss decreased (-0.237020 --> -0.237020).  Saving model ...
Epoch: 13 cost time: 0.7598991394042969
Epoch: 13, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.688 Vali Acc: 0.256 Test Loss: 1.688 Test Acc: 0.256
Validation loss decreased (-0.237020 --> -0.255539).  Saving model ...
Epoch: 14 cost time: 1.0459363460540771
Epoch: 14, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.678 Vali Acc: 0.274 Test Loss: 1.678 Test Acc: 0.274
Validation loss decreased (-0.255539 --> -0.274057).  Saving model ...
Epoch: 15 cost time: 0.703618049621582
Epoch: 15, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.666 Vali Acc: 0.285 Test Loss: 1.666 Test Acc: 0.285
Validation loss decreased (-0.274057 --> -0.285169).  Saving model ...
Epoch: 16 cost time: 0.8262791633605957
Epoch: 16, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.654 Vali Acc: 0.304 Test Loss: 1.654 Test Acc: 0.304
Validation loss decreased (-0.285169 --> -0.303687).  Saving model ...
Epoch: 17 cost time: 0.6747934818267822
Epoch: 17, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.642 Vali Acc: 0.311 Test Loss: 1.642 Test Acc: 0.311
Validation loss decreased (-0.303687 --> -0.311095).  Saving model ...
Epoch: 18 cost time: 0.7673420906066895
Epoch: 18, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.630 Vali Acc: 0.341 Test Loss: 1.630 Test Acc: 0.341
Validation loss decreased (-0.311095 --> -0.340724).  Saving model ...
Epoch: 19 cost time: 1.021479606628418
Epoch: 19, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.617 Vali Acc: 0.359 Test Loss: 1.617 Test Acc: 0.359
Validation loss decreased (-0.340724 --> -0.359243).  Saving model ...
Epoch: 20 cost time: 0.8055615425109863
Epoch: 20, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.605 Vali Acc: 0.374 Test Loss: 1.605 Test Acc: 0.374
Validation loss decreased (-0.359243 --> -0.374058).  Saving model ...
Epoch: 21 cost time: 0.7125124931335449
Epoch: 21, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.592 Vali Acc: 0.381 Test Loss: 1.592 Test Acc: 0.381
Validation loss decreased (-0.374058 --> -0.381466).  Saving model ...
Epoch: 22 cost time: 0.815842866897583
Epoch: 22, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.580 Vali Acc: 0.404 Test Loss: 1.580 Test Acc: 0.404
Validation loss decreased (-0.381466 --> -0.403688).  Saving model ...
Epoch: 23 cost time: 0.9039151668548584
Epoch: 23, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.568 Vali Acc: 0.437 Test Loss: 1.568 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437021).  Saving model ...
Epoch: 24 cost time: 0.9205896854400635
Epoch: 24, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.556 Vali Acc: 0.456 Test Loss: 1.556 Test Acc: 0.456
Validation loss decreased (-0.437021 --> -0.455540).  Saving model ...
Epoch: 25 cost time: 0.7173388004302979
Epoch: 25, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.543 Vali Acc: 0.478 Test Loss: 1.543 Test Acc: 0.478
Validation loss decreased (-0.455540 --> -0.477762).  Saving model ...
Epoch: 26 cost time: 0.7184748649597168
Epoch: 26, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.531 Vali Acc: 0.481 Test Loss: 1.531 Test Acc: 0.481
Validation loss decreased (-0.477762 --> -0.481466).  Saving model ...
Epoch: 27 cost time: 0.6393094062805176
Epoch: 27, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
Validation loss decreased (-0.481466 --> -0.499985).  Saving model ...
Epoch: 28 cost time: 0.6973419189453125
Epoch: 28, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.507 Vali Acc: 0.515 Test Loss: 1.507 Test Acc: 0.515
Validation loss decreased (-0.499985 --> -0.514800).  Saving model ...
Epoch: 29 cost time: 0.873568058013916
Epoch: 29, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.495 Vali Acc: 0.522 Test Loss: 1.495 Test Acc: 0.522
Validation loss decreased (-0.514800 --> -0.522207).  Saving model ...
Epoch: 30 cost time: 0.5661542415618896
Epoch: 30, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.483 Vali Acc: 0.533 Test Loss: 1.483 Test Acc: 0.533
Validation loss decreased (-0.522207 --> -0.533319).  Saving model ...
Epoch: 31 cost time: 0.7190346717834473
Epoch: 31, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.472 Vali Acc: 0.533 Test Loss: 1.472 Test Acc: 0.533
Validation loss decreased (-0.533319 --> -0.533319).  Saving model ...
Epoch: 32 cost time: 0.9344737529754639
Epoch: 32, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.460 Vali Acc: 0.548 Test Loss: 1.460 Test Acc: 0.548
Validation loss decreased (-0.533319 --> -0.548134).  Saving model ...
Epoch: 33 cost time: 0.6991536617279053
Epoch: 33, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.448 Vali Acc: 0.574 Test Loss: 1.448 Test Acc: 0.574
Validation loss decreased (-0.548134 --> -0.574060).  Saving model ...
Epoch: 34 cost time: 0.85469651222229
Epoch: 34, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.436 Vali Acc: 0.574 Test Loss: 1.436 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 35 cost time: 0.7490825653076172
Epoch: 35, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.424 Vali Acc: 0.589 Test Loss: 1.424 Test Acc: 0.589
Validation loss decreased (-0.574060 --> -0.588875).  Saving model ...
Epoch: 36 cost time: 0.8286821842193604
Epoch: 36, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.412 Vali Acc: 0.604 Test Loss: 1.412 Test Acc: 0.604
Validation loss decreased (-0.588875 --> -0.603690).  Saving model ...
Epoch: 37 cost time: 0.9740133285522461
Epoch: 37, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.401 Vali Acc: 0.611 Test Loss: 1.401 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611097).  Saving model ...
Epoch: 38 cost time: 0.7694268226623535
Epoch: 38, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.389 Vali Acc: 0.619 Test Loss: 1.389 Test Acc: 0.619
Validation loss decreased (-0.611097 --> -0.618505).  Saving model ...
Epoch: 39 cost time: 0.8648684024810791
Epoch: 39, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.378 Vali Acc: 0.622 Test Loss: 1.378 Test Acc: 0.622
Validation loss decreased (-0.618505 --> -0.622208).  Saving model ...
Epoch: 40 cost time: 0.7912912368774414
Epoch: 40, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.366 Vali Acc: 0.633 Test Loss: 1.366 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633320).  Saving model ...
Epoch: 41 cost time: 0.7580718994140625
Epoch: 41, Steps: 2 | Train Loss: 0.829 Vali Loss: 1.354 Vali Acc: 0.641 Test Loss: 1.354 Test Acc: 0.641
Validation loss decreased (-0.633320 --> -0.640727).  Saving model ...
Epoch: 42 cost time: 0.912722110748291
Epoch: 42, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.343 Vali Acc: 0.648 Test Loss: 1.343 Test Acc: 0.648
Validation loss decreased (-0.640727 --> -0.648135).  Saving model ...
Epoch: 43 cost time: 0.6164612770080566
Epoch: 43, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.331 Vali Acc: 0.663 Test Loss: 1.331 Test Acc: 0.663
Validation loss decreased (-0.648135 --> -0.662950).  Saving model ...
Epoch: 44 cost time: 0.847726583480835
Epoch: 44, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.320 Vali Acc: 0.678 Test Loss: 1.320 Test Acc: 0.678
Validation loss decreased (-0.662950 --> -0.677765).  Saving model ...
Epoch: 45 cost time: 0.8401274681091309
Epoch: 45, Steps: 2 | Train Loss: 0.757 Vali Loss: 1.308 Vali Acc: 0.681 Test Loss: 1.308 Test Acc: 0.681
Validation loss decreased (-0.677765 --> -0.681468).  Saving model ...
Epoch: 46 cost time: 0.7136135101318359
Epoch: 46, Steps: 2 | Train Loss: 0.706 Vali Loss: 1.296 Vali Acc: 0.689 Test Loss: 1.296 Test Acc: 0.689
Validation loss decreased (-0.681468 --> -0.688876).  Saving model ...
Epoch: 47 cost time: 0.7396130561828613
Epoch: 47, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.285 Vali Acc: 0.693 Test Loss: 1.285 Test Acc: 0.693
Validation loss decreased (-0.688876 --> -0.692580).  Saving model ...
Epoch: 48 cost time: 0.9799308776855469
Epoch: 48, Steps: 2 | Train Loss: 0.654 Vali Loss: 1.274 Vali Acc: 0.711 Test Loss: 1.274 Test Acc: 0.711
Validation loss decreased (-0.692580 --> -0.711098).  Saving model ...
Epoch: 49 cost time: 0.7758462429046631
Epoch: 49, Steps: 2 | Train Loss: 0.637 Vali Loss: 1.263 Vali Acc: 0.715 Test Loss: 1.263 Test Acc: 0.715
Validation loss decreased (-0.711098 --> -0.714802).  Saving model ...
Epoch: 50 cost time: 1.177367925643921
Epoch: 50, Steps: 2 | Train Loss: 0.631 Vali Loss: 1.252 Vali Acc: 0.711 Test Loss: 1.252 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6678087711334229
Epoch: 51, Steps: 2 | Train Loss: 0.636 Vali Loss: 1.241 Vali Acc: 0.715 Test Loss: 1.241 Test Acc: 0.715
Validation loss decreased (-0.714802 --> -0.714802).  Saving model ...
Epoch: 52 cost time: 0.7255425453186035
Epoch: 52, Steps: 2 | Train Loss: 0.588 Vali Loss: 1.230 Vali Acc: 0.719 Test Loss: 1.230 Test Acc: 0.719
Validation loss decreased (-0.714802 --> -0.718506).  Saving model ...
Epoch: 53 cost time: 1.0866646766662598
Epoch: 53, Steps: 2 | Train Loss: 0.585 Vali Loss: 1.219 Vali Acc: 0.733 Test Loss: 1.219 Test Acc: 0.733
Validation loss decreased (-0.718506 --> -0.733321).  Saving model ...
Epoch: 54 cost time: 0.9066362380981445
Epoch: 54, Steps: 2 | Train Loss: 0.564 Vali Loss: 1.208 Vali Acc: 0.737 Test Loss: 1.208 Test Acc: 0.737
Validation loss decreased (-0.733321 --> -0.737025).  Saving model ...
Epoch: 55 cost time: 0.9064033031463623
Epoch: 55, Steps: 2 | Train Loss: 0.551 Vali Loss: 1.197 Vali Acc: 0.744 Test Loss: 1.197 Test Acc: 0.744
Validation loss decreased (-0.737025 --> -0.744432).  Saving model ...
Epoch: 56 cost time: 0.812269926071167
Epoch: 56, Steps: 2 | Train Loss: 0.526 Vali Loss: 1.186 Vali Acc: 0.744 Test Loss: 1.186 Test Acc: 0.744
Validation loss decreased (-0.744432 --> -0.744433).  Saving model ...
Epoch: 57 cost time: 0.640549898147583
Epoch: 57, Steps: 2 | Train Loss: 0.506 Vali Loss: 1.176 Vali Acc: 0.744 Test Loss: 1.176 Test Acc: 0.744
Validation loss decreased (-0.744433 --> -0.744433).  Saving model ...
Epoch: 58 cost time: 0.7647557258605957
Epoch: 58, Steps: 2 | Train Loss: 0.483 Vali Loss: 1.165 Vali Acc: 0.756 Test Loss: 1.165 Test Acc: 0.756
Validation loss decreased (-0.744433 --> -0.755544).  Saving model ...
Epoch: 59 cost time: 0.7606298923492432
Epoch: 59, Steps: 2 | Train Loss: 0.482 Vali Loss: 1.154 Vali Acc: 0.759 Test Loss: 1.154 Test Acc: 0.759
Validation loss decreased (-0.755544 --> -0.759248).  Saving model ...
Epoch: 60 cost time: 1.0170958042144775
Epoch: 60, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.145 Vali Acc: 0.756 Test Loss: 1.145 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9966864585876465
Epoch: 61, Steps: 2 | Train Loss: 0.475 Vali Loss: 1.135 Vali Acc: 0.759 Test Loss: 1.135 Test Acc: 0.759
Validation loss decreased (-0.759248 --> -0.759248).  Saving model ...
Epoch: 62 cost time: 1.1178064346313477
Epoch: 62, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.126 Vali Acc: 0.759 Test Loss: 1.126 Test Acc: 0.759
Validation loss decreased (-0.759248 --> -0.759248).  Saving model ...
Epoch: 63 cost time: 1.004945993423462
Epoch: 63, Steps: 2 | Train Loss: 0.427 Vali Loss: 1.116 Vali Acc: 0.759 Test Loss: 1.116 Test Acc: 0.759
Validation loss decreased (-0.759248 --> -0.759248).  Saving model ...
Epoch: 64 cost time: 0.7501368522644043
Epoch: 64, Steps: 2 | Train Loss: 0.387 Vali Loss: 1.108 Vali Acc: 0.759 Test Loss: 1.108 Test Acc: 0.759
Validation loss decreased (-0.759248 --> -0.759248).  Saving model ...
Epoch: 65 cost time: 0.9580938816070557
Epoch: 65, Steps: 2 | Train Loss: 0.384 Vali Loss: 1.099 Vali Acc: 0.759 Test Loss: 1.099 Test Acc: 0.759
Validation loss decreased (-0.759248 --> -0.759248).  Saving model ...
Epoch: 66 cost time: 0.7371666431427002
Epoch: 66, Steps: 2 | Train Loss: 0.366 Vali Loss: 1.091 Vali Acc: 0.763 Test Loss: 1.091 Test Acc: 0.763
Validation loss decreased (-0.759248 --> -0.762952).  Saving model ...
Epoch: 67 cost time: 0.7457277774810791
Epoch: 67, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.082 Vali Acc: 0.763 Test Loss: 1.082 Test Acc: 0.763
Validation loss decreased (-0.762952 --> -0.762952).  Saving model ...
Epoch: 68 cost time: 1.119621753692627
Epoch: 68, Steps: 2 | Train Loss: 0.365 Vali Loss: 1.074 Vali Acc: 0.763 Test Loss: 1.074 Test Acc: 0.763
Validation loss decreased (-0.762952 --> -0.762952).  Saving model ...
Epoch: 69 cost time: 0.7993299961090088
Epoch: 69, Steps: 2 | Train Loss: 0.354 Vali Loss: 1.066 Vali Acc: 0.767 Test Loss: 1.066 Test Acc: 0.767
Validation loss decreased (-0.762952 --> -0.766656).  Saving model ...
Epoch: 70 cost time: 0.8609611988067627
Epoch: 70, Steps: 2 | Train Loss: 0.339 Vali Loss: 1.058 Vali Acc: 0.770 Test Loss: 1.058 Test Acc: 0.770
Validation loss decreased (-0.766656 --> -0.770360).  Saving model ...
Epoch: 71 cost time: 0.5836529731750488
Epoch: 71, Steps: 2 | Train Loss: 0.322 Vali Loss: 1.051 Vali Acc: 0.774 Test Loss: 1.051 Test Acc: 0.774
Validation loss decreased (-0.770360 --> -0.774064).  Saving model ...
Epoch: 72 cost time: 0.7195606231689453
Epoch: 72, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.044 Vali Acc: 0.770 Test Loss: 1.044 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6468126773834229
Epoch: 73, Steps: 2 | Train Loss: 0.319 Vali Loss: 1.037 Vali Acc: 0.774 Test Loss: 1.037 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 74 cost time: 0.7104465961456299
Epoch: 74, Steps: 2 | Train Loss: 0.286 Vali Loss: 1.031 Vali Acc: 0.774 Test Loss: 1.031 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 75 cost time: 0.7174947261810303
Epoch: 75, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.024 Vali Acc: 0.774 Test Loss: 1.024 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 76 cost time: 1.1399800777435303
Epoch: 76, Steps: 2 | Train Loss: 0.282 Vali Loss: 1.018 Vali Acc: 0.774 Test Loss: 1.018 Test Acc: 0.774
Validation loss decreased (-0.774064 --> -0.774064).  Saving model ...
Epoch: 77 cost time: 0.8924984931945801
Epoch: 77, Steps: 2 | Train Loss: 0.265 Vali Loss: 1.013 Vali Acc: 0.770 Test Loss: 1.013 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8404860496520996
Epoch: 78, Steps: 2 | Train Loss: 0.247 Vali Loss: 1.007 Vali Acc: 0.770 Test Loss: 1.007 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9933645725250244
Epoch: 79, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.002 Vali Acc: 0.770 Test Loss: 1.002 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.6871495246887207
Epoch: 80, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.997 Vali Acc: 0.770 Test Loss: 0.997 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.8761651515960693
Epoch: 81, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.992 Vali Acc: 0.770 Test Loss: 0.992 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.7463281154632568
Epoch: 82, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.988 Vali Acc: 0.763 Test Loss: 0.988 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.7586925029754639
Epoch: 83, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.984 Vali Acc: 0.763 Test Loss: 0.984 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.9791953563690186
Epoch: 84, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.980 Vali Acc: 0.759 Test Loss: 0.980 Test Acc: 0.759
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.7918143272399902
Epoch: 85, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.976 Vali Acc: 0.756 Test Loss: 0.976 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.7612555027008057
Epoch: 86, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.973 Vali Acc: 0.756 Test Loss: 0.973 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.774074074074074
model parameter : 71908
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.673161268234253
Epoch: 1, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.770 Vali Acc: 0.215 Test Loss: 1.770 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.9233229160308838
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.765 Vali Acc: 0.222 Test Loss: 1.765 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.81160569190979
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.761 Vali Acc: 0.226 Test Loss: 1.761 Test Acc: 0.226
Validation loss decreased (-0.222205 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.9275832176208496
Epoch: 4, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.757 Vali Acc: 0.230 Test Loss: 1.757 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.7749550342559814
Epoch: 5, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.752 Vali Acc: 0.252 Test Loss: 1.752 Test Acc: 0.252
Validation loss decreased (-0.229612 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 0.6577470302581787
Epoch: 6, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.746 Vali Acc: 0.263 Test Loss: 1.746 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262946).  Saving model ...
Epoch: 7 cost time: 0.8759922981262207
Epoch: 7, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.739 Vali Acc: 0.274 Test Loss: 1.739 Test Acc: 0.274
Validation loss decreased (-0.262946 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.7851336002349854
Epoch: 8, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.731 Vali Acc: 0.278 Test Loss: 1.731 Test Acc: 0.278
Validation loss decreased (-0.274057 --> -0.277760).  Saving model ...
Epoch: 9 cost time: 0.636160135269165
Epoch: 9, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.723 Vali Acc: 0.285 Test Loss: 1.723 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285168).  Saving model ...
Epoch: 10 cost time: 0.7285699844360352
Epoch: 10, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.714 Vali Acc: 0.300 Test Loss: 1.714 Test Acc: 0.300
Validation loss decreased (-0.285168 --> -0.299983).  Saving model ...
Epoch: 11 cost time: 0.6892364025115967
Epoch: 11, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.704 Vali Acc: 0.311 Test Loss: 1.704 Test Acc: 0.311
Validation loss decreased (-0.299983 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 0.8622851371765137
Epoch: 12, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.694 Vali Acc: 0.333 Test Loss: 1.694 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333316).  Saving model ...
Epoch: 13 cost time: 0.6723623275756836
Epoch: 13, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.683 Vali Acc: 0.344 Test Loss: 1.683 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344428).  Saving model ...
Epoch: 14 cost time: 0.8419747352600098
Epoch: 14, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.672 Vali Acc: 0.359 Test Loss: 1.672 Test Acc: 0.359
Validation loss decreased (-0.344428 --> -0.359243).  Saving model ...
Epoch: 15 cost time: 0.8210704326629639
Epoch: 15, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.660 Vali Acc: 0.370 Test Loss: 1.660 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370354).  Saving model ...
Epoch: 16 cost time: 0.7158503532409668
Epoch: 16, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.648 Vali Acc: 0.381 Test Loss: 1.648 Test Acc: 0.381
Validation loss decreased (-0.370354 --> -0.381465).  Saving model ...
Epoch: 17 cost time: 0.6292552947998047
Epoch: 17, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.635 Vali Acc: 0.385 Test Loss: 1.635 Test Acc: 0.385
Validation loss decreased (-0.381465 --> -0.385169).  Saving model ...
Epoch: 18 cost time: 0.5620715618133545
Epoch: 18, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.622 Vali Acc: 0.393 Test Loss: 1.622 Test Acc: 0.393
Validation loss decreased (-0.385169 --> -0.392576).  Saving model ...
Epoch: 19 cost time: 0.6766555309295654
Epoch: 19, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.609 Vali Acc: 0.407 Test Loss: 1.609 Test Acc: 0.407
Validation loss decreased (-0.392576 --> -0.407391).  Saving model ...
Epoch: 20 cost time: 0.6005308628082275
Epoch: 20, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.596 Vali Acc: 0.441 Test Loss: 1.596 Test Acc: 0.441
Validation loss decreased (-0.407391 --> -0.440725).  Saving model ...
Epoch: 21 cost time: 0.5903644561767578
Epoch: 21, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.583 Vali Acc: 0.456 Test Loss: 1.583 Test Acc: 0.456
Validation loss decreased (-0.440725 --> -0.455540).  Saving model ...
Epoch: 22 cost time: 0.6558477878570557
Epoch: 22, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.570 Vali Acc: 0.478 Test Loss: 1.570 Test Acc: 0.478
Validation loss decreased (-0.455540 --> -0.477762).  Saving model ...
Epoch: 23 cost time: 0.6856558322906494
Epoch: 23, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.557 Vali Acc: 0.496 Test Loss: 1.557 Test Acc: 0.496
Validation loss decreased (-0.477762 --> -0.496281).  Saving model ...
Epoch: 24 cost time: 0.5978970527648926
Epoch: 24, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.544 Vali Acc: 0.507 Test Loss: 1.544 Test Acc: 0.507
Validation loss decreased (-0.496281 --> -0.507392).  Saving model ...
Epoch: 25 cost time: 0.6718027591705322
Epoch: 25, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.530 Vali Acc: 0.522 Test Loss: 1.530 Test Acc: 0.522
Validation loss decreased (-0.507392 --> -0.522207).  Saving model ...
Epoch: 26 cost time: 0.6114861965179443
Epoch: 26, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.517 Vali Acc: 0.530 Test Loss: 1.517 Test Acc: 0.530
Validation loss decreased (-0.522207 --> -0.529614).  Saving model ...
Epoch: 27 cost time: 0.541003942489624
Epoch: 27, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.504 Vali Acc: 0.544 Test Loss: 1.504 Test Acc: 0.544
Validation loss decreased (-0.529614 --> -0.544429).  Saving model ...
Epoch: 28 cost time: 0.799903154373169
Epoch: 28, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.491 Vali Acc: 0.563 Test Loss: 1.491 Test Acc: 0.563
Validation loss decreased (-0.544429 --> -0.562948).  Saving model ...
Epoch: 29 cost time: 0.8227636814117432
Epoch: 29, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.477 Vali Acc: 0.574 Test Loss: 1.477 Test Acc: 0.574
Validation loss decreased (-0.562948 --> -0.574059).  Saving model ...
Epoch: 30 cost time: 0.6993350982666016
Epoch: 30, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.464 Vali Acc: 0.593 Test Loss: 1.464 Test Acc: 0.593
Validation loss decreased (-0.574059 --> -0.592578).  Saving model ...
Epoch: 31 cost time: 0.6095974445343018
Epoch: 31, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.451 Vali Acc: 0.604 Test Loss: 1.451 Test Acc: 0.604
Validation loss decreased (-0.592578 --> -0.603689).  Saving model ...
Epoch: 32 cost time: 0.6455683708190918
Epoch: 32, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.438 Vali Acc: 0.619 Test Loss: 1.438 Test Acc: 0.619
Validation loss decreased (-0.603689 --> -0.618504).  Saving model ...
Epoch: 33 cost time: 0.588003396987915
Epoch: 33, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.425 Vali Acc: 0.633 Test Loss: 1.425 Test Acc: 0.633
Validation loss decreased (-0.618504 --> -0.633319).  Saving model ...
Epoch: 34 cost time: 0.6433758735656738
Epoch: 34, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.411 Vali Acc: 0.637 Test Loss: 1.411 Test Acc: 0.637
Validation loss decreased (-0.633319 --> -0.637023).  Saving model ...
Epoch: 35 cost time: 0.7321770191192627
Epoch: 35, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.398 Vali Acc: 0.644 Test Loss: 1.398 Test Acc: 0.644
Validation loss decreased (-0.637023 --> -0.644430).  Saving model ...
Epoch: 36 cost time: 1.005171775817871
Epoch: 36, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.386 Vali Acc: 0.656 Test Loss: 1.386 Test Acc: 0.656
Validation loss decreased (-0.644430 --> -0.655542).  Saving model ...
Epoch: 37 cost time: 0.6676812171936035
Epoch: 37, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.373 Vali Acc: 0.674 Test Loss: 1.373 Test Acc: 0.674
Validation loss decreased (-0.655542 --> -0.674060).  Saving model ...
Epoch: 38 cost time: 0.7046141624450684
Epoch: 38, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.361 Vali Acc: 0.685 Test Loss: 1.361 Test Acc: 0.685
Validation loss decreased (-0.674060 --> -0.685172).  Saving model ...
Epoch: 39 cost time: 0.8556258678436279
Epoch: 39, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.349 Vali Acc: 0.689 Test Loss: 1.349 Test Acc: 0.689
Validation loss decreased (-0.685172 --> -0.688875).  Saving model ...
Epoch: 40 cost time: 0.9821877479553223
Epoch: 40, Steps: 2 | Train Loss: 0.851 Vali Loss: 1.336 Vali Acc: 0.685 Test Loss: 1.336 Test Acc: 0.685
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8035414218902588
Epoch: 41, Steps: 2 | Train Loss: 0.813 Vali Loss: 1.324 Vali Acc: 0.678 Test Loss: 1.324 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9509596824645996
Epoch: 42, Steps: 2 | Train Loss: 0.802 Vali Loss: 1.313 Vali Acc: 0.678 Test Loss: 1.313 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9098310470581055
Epoch: 43, Steps: 2 | Train Loss: 0.764 Vali Loss: 1.301 Vali Acc: 0.678 Test Loss: 1.301 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8854799270629883
Epoch: 44, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.289 Vali Acc: 0.674 Test Loss: 1.289 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8596944808959961
Epoch: 45, Steps: 2 | Train Loss: 0.735 Vali Loss: 1.277 Vali Acc: 0.681 Test Loss: 1.277 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8808691501617432
Epoch: 46, Steps: 2 | Train Loss: 0.698 Vali Loss: 1.266 Vali Acc: 0.681 Test Loss: 1.266 Test Acc: 0.681
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9192836284637451
Epoch: 47, Steps: 2 | Train Loss: 0.678 Vali Loss: 1.254 Vali Acc: 0.685 Test Loss: 1.254 Test Acc: 0.685
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7550647258758545
Epoch: 48, Steps: 2 | Train Loss: 0.666 Vali Loss: 1.243 Vali Acc: 0.681 Test Loss: 1.243 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7996859550476074
Epoch: 49, Steps: 2 | Train Loss: 0.643 Vali Loss: 1.232 Vali Acc: 0.685 Test Loss: 1.232 Test Acc: 0.685
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6888888888888889
model parameter : 70884
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9304466247558594
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.800 Vali Acc: 0.211 Test Loss: 1.800 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.6037850379943848
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.796 Vali Acc: 0.215 Test Loss: 1.796 Test Acc: 0.215
Validation loss decreased (-0.211093 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.6176068782806396
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.793 Vali Acc: 0.219 Test Loss: 1.793 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.7145383358001709
Epoch: 4, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.789 Vali Acc: 0.222 Test Loss: 1.789 Test Acc: 0.222
Validation loss decreased (-0.218501 --> -0.222204).  Saving model ...
Epoch: 5 cost time: 0.7219417095184326
Epoch: 5, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.784 Vali Acc: 0.226 Test Loss: 1.784 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 0.819617748260498
Epoch: 6, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.779 Vali Acc: 0.230 Test Loss: 1.779 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 7 cost time: 0.7417595386505127
Epoch: 7, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.773 Vali Acc: 0.237 Test Loss: 1.773 Test Acc: 0.237
Validation loss decreased (-0.229612 --> -0.237019).  Saving model ...
Epoch: 8 cost time: 0.6206827163696289
Epoch: 8, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.766 Vali Acc: 0.241 Test Loss: 1.766 Test Acc: 0.241
Validation loss decreased (-0.237019 --> -0.240723).  Saving model ...
Epoch: 9 cost time: 0.630573034286499
Epoch: 9, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.758 Vali Acc: 0.248 Test Loss: 1.758 Test Acc: 0.248
Validation loss decreased (-0.240723 --> -0.248131).  Saving model ...
Epoch: 10 cost time: 0.5737638473510742
Epoch: 10, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.750 Vali Acc: 0.259 Test Loss: 1.750 Test Acc: 0.259
Validation loss decreased (-0.248131 --> -0.259242).  Saving model ...
Epoch: 11 cost time: 0.618358850479126
Epoch: 11, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.741 Vali Acc: 0.267 Test Loss: 1.741 Test Acc: 0.267
Validation loss decreased (-0.259242 --> -0.266649).  Saving model ...
Epoch: 12 cost time: 0.6055257320404053
Epoch: 12, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.732 Vali Acc: 0.278 Test Loss: 1.732 Test Acc: 0.278
Validation loss decreased (-0.266649 --> -0.277760).  Saving model ...
Epoch: 13 cost time: 0.6630771160125732
Epoch: 13, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.723 Vali Acc: 0.278 Test Loss: 1.723 Test Acc: 0.278
Validation loss decreased (-0.277760 --> -0.277761).  Saving model ...
Epoch: 14 cost time: 0.6630706787109375
Epoch: 14, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.713 Vali Acc: 0.285 Test Loss: 1.713 Test Acc: 0.285
Validation loss decreased (-0.277761 --> -0.285168).  Saving model ...
Epoch: 15 cost time: 0.6927504539489746
Epoch: 15, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.703 Vali Acc: 0.296 Test Loss: 1.703 Test Acc: 0.296
Validation loss decreased (-0.285168 --> -0.296279).  Saving model ...
Epoch: 16 cost time: 0.5862724781036377
Epoch: 16, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.692 Vali Acc: 0.293 Test Loss: 1.692 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5817358493804932
Epoch: 17, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.682 Vali Acc: 0.304 Test Loss: 1.682 Test Acc: 0.304
Validation loss decreased (-0.296279 --> -0.303687).  Saving model ...
Epoch: 18 cost time: 0.7883288860321045
Epoch: 18, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.671 Vali Acc: 0.322 Test Loss: 1.671 Test Acc: 0.322
Validation loss decreased (-0.303687 --> -0.322206).  Saving model ...
Epoch: 19 cost time: 0.6513576507568359
Epoch: 19, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.660 Vali Acc: 0.341 Test Loss: 1.660 Test Acc: 0.341
Validation loss decreased (-0.322206 --> -0.340724).  Saving model ...
Epoch: 20 cost time: 0.6484508514404297
Epoch: 20, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.649 Vali Acc: 0.356 Test Loss: 1.649 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 21 cost time: 0.6001491546630859
Epoch: 21, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.638 Vali Acc: 0.363 Test Loss: 1.638 Test Acc: 0.363
Validation loss decreased (-0.355539 --> -0.362947).  Saving model ...
Epoch: 22 cost time: 0.5950753688812256
Epoch: 22, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.626 Vali Acc: 0.374 Test Loss: 1.626 Test Acc: 0.374
Validation loss decreased (-0.362947 --> -0.374058).  Saving model ...
Epoch: 23 cost time: 0.5929234027862549
Epoch: 23, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.614 Vali Acc: 0.378 Test Loss: 1.614 Test Acc: 0.378
Validation loss decreased (-0.374058 --> -0.377762).  Saving model ...
Epoch: 24 cost time: 0.707019567489624
Epoch: 24, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.602 Vali Acc: 0.385 Test Loss: 1.602 Test Acc: 0.385
Validation loss decreased (-0.377762 --> -0.385169).  Saving model ...
Epoch: 25 cost time: 0.5421633720397949
Epoch: 25, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.590 Vali Acc: 0.385 Test Loss: 1.590 Test Acc: 0.385
Validation loss decreased (-0.385169 --> -0.385169).  Saving model ...
Epoch: 26 cost time: 0.5533673763275146
Epoch: 26, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.577 Vali Acc: 0.396 Test Loss: 1.577 Test Acc: 0.396
Validation loss decreased (-0.385169 --> -0.396281).  Saving model ...
Epoch: 27 cost time: 0.8364923000335693
Epoch: 27, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.565 Vali Acc: 0.422 Test Loss: 1.565 Test Acc: 0.422
Validation loss decreased (-0.396281 --> -0.422207).  Saving model ...
Epoch: 28 cost time: 0.7656669616699219
Epoch: 28, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.552 Vali Acc: 0.426 Test Loss: 1.552 Test Acc: 0.426
Validation loss decreased (-0.422207 --> -0.425910).  Saving model ...
Epoch: 29 cost time: 0.8752329349517822
Epoch: 29, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.539 Vali Acc: 0.437 Test Loss: 1.539 Test Acc: 0.437
Validation loss decreased (-0.425910 --> -0.437022).  Saving model ...
Epoch: 30 cost time: 0.6707658767700195
Epoch: 30, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.527 Vali Acc: 0.448 Test Loss: 1.527 Test Acc: 0.448
Validation loss decreased (-0.437022 --> -0.448133).  Saving model ...
Epoch: 31 cost time: 0.6609368324279785
Epoch: 31, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.514 Vali Acc: 0.470 Test Loss: 1.514 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 32 cost time: 0.9169890880584717
Epoch: 32, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.501 Vali Acc: 0.489 Test Loss: 1.501 Test Acc: 0.489
Validation loss decreased (-0.470355 --> -0.488874).  Saving model ...
Epoch: 33 cost time: 0.9447290897369385
Epoch: 33, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
Validation loss decreased (-0.488874 --> -0.499985).  Saving model ...
Epoch: 34 cost time: 0.883275032043457
Epoch: 34, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.476 Vali Acc: 0.507 Test Loss: 1.476 Test Acc: 0.507
Validation loss decreased (-0.499985 --> -0.507393).  Saving model ...
Epoch: 35 cost time: 0.8266708850860596
Epoch: 35, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.463 Vali Acc: 0.519 Test Loss: 1.463 Test Acc: 0.519
Validation loss decreased (-0.507393 --> -0.518504).  Saving model ...
Epoch: 36 cost time: 0.7113683223724365
Epoch: 36, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.450 Vali Acc: 0.533 Test Loss: 1.450 Test Acc: 0.533
Validation loss decreased (-0.518504 --> -0.533319).  Saving model ...
Epoch: 37 cost time: 1.0458221435546875
Epoch: 37, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.437 Vali Acc: 0.541 Test Loss: 1.437 Test Acc: 0.541
Validation loss decreased (-0.533319 --> -0.540726).  Saving model ...
Epoch: 38 cost time: 0.8637070655822754
Epoch: 38, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.425 Vali Acc: 0.552 Test Loss: 1.425 Test Acc: 0.552
Validation loss decreased (-0.540726 --> -0.551838).  Saving model ...
Epoch: 39 cost time: 0.8418102264404297
Epoch: 39, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.412 Vali Acc: 0.578 Test Loss: 1.412 Test Acc: 0.578
Validation loss decreased (-0.551838 --> -0.577764).  Saving model ...
Epoch: 40 cost time: 0.9609377384185791
Epoch: 40, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.400 Vali Acc: 0.589 Test Loss: 1.400 Test Acc: 0.589
Validation loss decreased (-0.577764 --> -0.588875).  Saving model ...
Epoch: 41 cost time: 0.9919941425323486
Epoch: 41, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.388 Vali Acc: 0.607 Test Loss: 1.388 Test Acc: 0.607
Validation loss decreased (-0.588875 --> -0.607394).  Saving model ...
Epoch: 42 cost time: 0.7180469036102295
Epoch: 42, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.376 Vali Acc: 0.600 Test Loss: 1.376 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7645418643951416
Epoch: 43, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.365 Vali Acc: 0.619 Test Loss: 1.365 Test Acc: 0.619
Validation loss decreased (-0.607394 --> -0.618505).  Saving model ...
Epoch: 44 cost time: 0.8832759857177734
Epoch: 44, Steps: 2 | Train Loss: 0.845 Vali Loss: 1.353 Vali Acc: 0.626 Test Loss: 1.353 Test Acc: 0.626
Validation loss decreased (-0.618505 --> -0.625912).  Saving model ...
Epoch: 45 cost time: 0.7076671123504639
Epoch: 45, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.342 Vali Acc: 0.630 Test Loss: 1.342 Test Acc: 0.630
Validation loss decreased (-0.625912 --> -0.629616).  Saving model ...
Epoch: 46 cost time: 0.8683311939239502
Epoch: 46, Steps: 2 | Train Loss: 0.820 Vali Loss: 1.332 Vali Acc: 0.630 Test Loss: 1.332 Test Acc: 0.630
Validation loss decreased (-0.629616 --> -0.629616).  Saving model ...
Epoch: 47 cost time: 0.6547918319702148
Epoch: 47, Steps: 2 | Train Loss: 0.813 Vali Loss: 1.322 Vali Acc: 0.630 Test Loss: 1.322 Test Acc: 0.630
Validation loss decreased (-0.629616 --> -0.629616).  Saving model ...
Epoch: 48 cost time: 0.7561326026916504
Epoch: 48, Steps: 2 | Train Loss: 0.752 Vali Loss: 1.311 Vali Acc: 0.633 Test Loss: 1.311 Test Acc: 0.633
Validation loss decreased (-0.629616 --> -0.633320).  Saving model ...
Epoch: 49 cost time: 0.7990708351135254
Epoch: 49, Steps: 2 | Train Loss: 0.759 Vali Loss: 1.301 Vali Acc: 0.633 Test Loss: 1.301 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 50 cost time: 0.9830226898193359
Epoch: 50, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.291 Vali Acc: 0.637 Test Loss: 1.291 Test Acc: 0.637
Validation loss decreased (-0.633320 --> -0.637024).  Saving model ...
Epoch: 51 cost time: 0.7262976169586182
Epoch: 51, Steps: 2 | Train Loss: 0.706 Vali Loss: 1.282 Vali Acc: 0.644 Test Loss: 1.282 Test Acc: 0.644
Validation loss decreased (-0.637024 --> -0.644432).  Saving model ...
Epoch: 52 cost time: 0.8207225799560547
Epoch: 52, Steps: 2 | Train Loss: 0.710 Vali Loss: 1.272 Vali Acc: 0.648 Test Loss: 1.272 Test Acc: 0.648
Validation loss decreased (-0.644432 --> -0.648135).  Saving model ...
Epoch: 53 cost time: 0.6953630447387695
Epoch: 53, Steps: 2 | Train Loss: 0.675 Vali Loss: 1.263 Vali Acc: 0.648 Test Loss: 1.263 Test Acc: 0.648
Validation loss decreased (-0.648135 --> -0.648136).  Saving model ...
Epoch: 54 cost time: 1.1550164222717285
Epoch: 54, Steps: 2 | Train Loss: 0.652 Vali Loss: 1.253 Vali Acc: 0.652 Test Loss: 1.253 Test Acc: 0.652
Validation loss decreased (-0.648136 --> -0.651839).  Saving model ...
Epoch: 55 cost time: 0.7600071430206299
Epoch: 55, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.244 Vali Acc: 0.652 Test Loss: 1.244 Test Acc: 0.652
Validation loss decreased (-0.651839 --> -0.651839).  Saving model ...
Epoch: 56 cost time: 0.585554838180542
Epoch: 56, Steps: 2 | Train Loss: 0.601 Vali Loss: 1.235 Vali Acc: 0.652 Test Loss: 1.235 Test Acc: 0.652
Validation loss decreased (-0.651839 --> -0.651840).  Saving model ...
Epoch: 57 cost time: 0.6954381465911865
Epoch: 57, Steps: 2 | Train Loss: 0.576 Vali Loss: 1.225 Vali Acc: 0.652 Test Loss: 1.225 Test Acc: 0.652
Validation loss decreased (-0.651840 --> -0.651840).  Saving model ...
Epoch: 58 cost time: 0.6646347045898438
Epoch: 58, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.215 Vali Acc: 0.659 Test Loss: 1.215 Test Acc: 0.659
Validation loss decreased (-0.651840 --> -0.659247).  Saving model ...
Epoch: 59 cost time: 0.5929560661315918
Epoch: 59, Steps: 2 | Train Loss: 0.539 Vali Loss: 1.206 Vali Acc: 0.648 Test Loss: 1.206 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6366584300994873
Epoch: 60, Steps: 2 | Train Loss: 0.529 Vali Loss: 1.196 Vali Acc: 0.644 Test Loss: 1.196 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8008406162261963
Epoch: 61, Steps: 2 | Train Loss: 0.502 Vali Loss: 1.187 Vali Acc: 0.644 Test Loss: 1.187 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.6350014209747314
Epoch: 62, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.178 Vali Acc: 0.656 Test Loss: 1.178 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.7165336608886719
Epoch: 63, Steps: 2 | Train Loss: 0.478 Vali Loss: 1.169 Vali Acc: 0.659 Test Loss: 1.169 Test Acc: 0.659
Validation loss decreased (-0.659247 --> -0.659248).  Saving model ...
Epoch: 64 cost time: 0.7821953296661377
Epoch: 64, Steps: 2 | Train Loss: 0.447 Vali Loss: 1.161 Vali Acc: 0.667 Test Loss: 1.161 Test Acc: 0.667
Validation loss decreased (-0.659248 --> -0.666655).  Saving model ...
Epoch: 65 cost time: 0.6033785343170166
Epoch: 65, Steps: 2 | Train Loss: 0.439 Vali Loss: 1.153 Vali Acc: 0.670 Test Loss: 1.153 Test Acc: 0.670
Validation loss decreased (-0.666655 --> -0.670359).  Saving model ...
Epoch: 66 cost time: 0.6343281269073486
Epoch: 66, Steps: 2 | Train Loss: 0.437 Vali Loss: 1.145 Vali Acc: 0.674 Test Loss: 1.145 Test Acc: 0.674
Validation loss decreased (-0.670359 --> -0.674063).  Saving model ...
Epoch: 67 cost time: 0.5626399517059326
Epoch: 67, Steps: 2 | Train Loss: 0.395 Vali Loss: 1.137 Vali Acc: 0.674 Test Loss: 1.137 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 68 cost time: 0.5458781719207764
Epoch: 68, Steps: 2 | Train Loss: 0.388 Vali Loss: 1.130 Vali Acc: 0.670 Test Loss: 1.130 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7546191215515137
Epoch: 69, Steps: 2 | Train Loss: 0.385 Vali Loss: 1.122 Vali Acc: 0.670 Test Loss: 1.122 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.7076306343078613
Epoch: 70, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.114 Vali Acc: 0.678 Test Loss: 1.114 Test Acc: 0.678
Validation loss decreased (-0.674063 --> -0.677767).  Saving model ...
Epoch: 71 cost time: 0.5306518077850342
Epoch: 71, Steps: 2 | Train Loss: 0.355 Vali Loss: 1.107 Vali Acc: 0.678 Test Loss: 1.107 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 72 cost time: 0.8512628078460693
Epoch: 72, Steps: 2 | Train Loss: 0.341 Vali Loss: 1.101 Vali Acc: 0.678 Test Loss: 1.101 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 73 cost time: 0.6619398593902588
Epoch: 73, Steps: 2 | Train Loss: 0.313 Vali Loss: 1.094 Vali Acc: 0.681 Test Loss: 1.094 Test Acc: 0.681
Validation loss decreased (-0.677767 --> -0.681471).  Saving model ...
Epoch: 74 cost time: 0.6899948120117188
Epoch: 74, Steps: 2 | Train Loss: 0.309 Vali Loss: 1.088 Vali Acc: 0.681 Test Loss: 1.088 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 75 cost time: 0.6764142513275146
Epoch: 75, Steps: 2 | Train Loss: 0.304 Vali Loss: 1.082 Vali Acc: 0.681 Test Loss: 1.082 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 76 cost time: 0.7749946117401123
Epoch: 76, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.077 Vali Acc: 0.681 Test Loss: 1.077 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 77 cost time: 0.9067931175231934
Epoch: 77, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.071 Vali Acc: 0.681 Test Loss: 1.071 Test Acc: 0.681
Validation loss decreased (-0.681471 --> -0.681471).  Saving model ...
Epoch: 78 cost time: 0.8691902160644531
Epoch: 78, Steps: 2 | Train Loss: 0.265 Vali Loss: 1.066 Vali Acc: 0.685 Test Loss: 1.066 Test Acc: 0.685
Validation loss decreased (-0.681471 --> -0.685175).  Saving model ...
Epoch: 79 cost time: 0.8311483860015869
Epoch: 79, Steps: 2 | Train Loss: 0.264 Vali Loss: 1.060 Vali Acc: 0.689 Test Loss: 1.060 Test Acc: 0.689
Validation loss decreased (-0.685175 --> -0.688878).  Saving model ...
Epoch: 80 cost time: 0.7382888793945312
Epoch: 80, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.055 Vali Acc: 0.689 Test Loss: 1.055 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 81 cost time: 0.8374013900756836
Epoch: 81, Steps: 2 | Train Loss: 0.249 Vali Loss: 1.050 Vali Acc: 0.681 Test Loss: 1.050 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7287743091583252
Epoch: 82, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.045 Vali Acc: 0.670 Test Loss: 1.045 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.9599261283874512
Epoch: 83, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.040 Vali Acc: 0.674 Test Loss: 1.040 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.6874165534973145
Epoch: 84, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.036 Vali Acc: 0.674 Test Loss: 1.036 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.9162106513977051
Epoch: 85, Steps: 2 | Train Loss: 0.220 Vali Loss: 1.031 Vali Acc: 0.674 Test Loss: 1.031 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.7224845886230469
Epoch: 86, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.026 Vali Acc: 0.681 Test Loss: 1.026 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.8188536167144775
Epoch: 87, Steps: 2 | Train Loss: 0.206 Vali Loss: 1.022 Vali Acc: 0.685 Test Loss: 1.022 Test Acc: 0.685
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.7335898876190186
Epoch: 88, Steps: 2 | Train Loss: 0.211 Vali Loss: 1.018 Vali Acc: 0.685 Test Loss: 1.018 Test Acc: 0.685
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.9326446056365967
Epoch: 89, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.013 Vali Acc: 0.685 Test Loss: 1.013 Test Acc: 0.685
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.6919748783111572
Epoch: 90, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.009 Vali Acc: 0.681 Test Loss: 1.009 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6888888888888889
model parameter : 70372
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.127234697341919
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.787 Vali Acc: 0.230 Test Loss: 1.787 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 1.0246851444244385
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.781 Vali Acc: 0.241 Test Loss: 1.781 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.8859024047851562
Epoch: 3, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.776 Vali Acc: 0.252 Test Loss: 1.776 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 0.6245250701904297
Epoch: 4, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.770 Vali Acc: 0.252 Test Loss: 1.770 Test Acc: 0.252
Validation loss decreased (-0.251834 --> -0.251834).  Saving model ...
Epoch: 5 cost time: 0.6864035129547119
Epoch: 5, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.763 Vali Acc: 0.256 Test Loss: 1.763 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 0.6837115287780762
Epoch: 6, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.754 Vali Acc: 0.263 Test Loss: 1.754 Test Acc: 0.263
Validation loss decreased (-0.255538 --> -0.262945).  Saving model ...
Epoch: 7 cost time: 0.6353785991668701
Epoch: 7, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.744 Vali Acc: 0.274 Test Loss: 1.744 Test Acc: 0.274
Validation loss decreased (-0.262945 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.7123775482177734
Epoch: 8, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.733 Vali Acc: 0.281 Test Loss: 1.733 Test Acc: 0.281
Validation loss decreased (-0.274057 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 0.6737658977508545
Epoch: 9, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.722 Vali Acc: 0.289 Test Loss: 1.722 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 0.6903367042541504
Epoch: 10, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.710 Vali Acc: 0.300 Test Loss: 1.710 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 11 cost time: 1.013972520828247
Epoch: 11, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.697 Vali Acc: 0.311 Test Loss: 1.697 Test Acc: 0.311
Validation loss decreased (-0.299983 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 0.6886801719665527
Epoch: 12, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.684 Vali Acc: 0.333 Test Loss: 1.684 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333316).  Saving model ...
Epoch: 13 cost time: 1.1725597381591797
Epoch: 13, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.670 Vali Acc: 0.352 Test Loss: 1.670 Test Acc: 0.352
Validation loss decreased (-0.333316 --> -0.351835).  Saving model ...
Epoch: 14 cost time: 0.6807329654693604
Epoch: 14, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.656 Vali Acc: 0.356 Test Loss: 1.656 Test Acc: 0.356
Validation loss decreased (-0.351835 --> -0.355539).  Saving model ...
Epoch: 15 cost time: 0.6921014785766602
Epoch: 15, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.642 Vali Acc: 0.370 Test Loss: 1.642 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 16 cost time: 0.8309931755065918
Epoch: 16, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.628 Vali Acc: 0.393 Test Loss: 1.628 Test Acc: 0.393
Validation loss decreased (-0.370354 --> -0.392576).  Saving model ...
Epoch: 17 cost time: 0.8505995273590088
Epoch: 17, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.613 Vali Acc: 0.400 Test Loss: 1.613 Test Acc: 0.400
Validation loss decreased (-0.392576 --> -0.399984).  Saving model ...
Epoch: 18 cost time: 0.855933666229248
Epoch: 18, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.599 Vali Acc: 0.407 Test Loss: 1.599 Test Acc: 0.407
Validation loss decreased (-0.399984 --> -0.407391).  Saving model ...
Epoch: 19 cost time: 0.6170117855072021
Epoch: 19, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.584 Vali Acc: 0.430 Test Loss: 1.584 Test Acc: 0.430
Validation loss decreased (-0.407391 --> -0.429614).  Saving model ...
Epoch: 20 cost time: 0.5828115940093994
Epoch: 20, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.570 Vali Acc: 0.452 Test Loss: 1.570 Test Acc: 0.452
Validation loss decreased (-0.429614 --> -0.451836).  Saving model ...
Epoch: 21 cost time: 0.7080037593841553
Epoch: 21, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.556 Vali Acc: 0.470 Test Loss: 1.556 Test Acc: 0.470
Validation loss decreased (-0.451836 --> -0.470355).  Saving model ...
Epoch: 22 cost time: 0.753537654876709
Epoch: 22, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.542 Vali Acc: 0.485 Test Loss: 1.542 Test Acc: 0.485
Validation loss decreased (-0.470355 --> -0.485170).  Saving model ...
Epoch: 23 cost time: 0.7499480247497559
Epoch: 23, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.528 Vali Acc: 0.493 Test Loss: 1.528 Test Acc: 0.493
Validation loss decreased (-0.485170 --> -0.492577).  Saving model ...
Epoch: 24 cost time: 0.7867012023925781
Epoch: 24, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.515 Vali Acc: 0.493 Test Loss: 1.515 Test Acc: 0.493
Validation loss decreased (-0.492577 --> -0.492577).  Saving model ...
Epoch: 25 cost time: 0.6225700378417969
Epoch: 25, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.501 Vali Acc: 0.519 Test Loss: 1.501 Test Acc: 0.519
Validation loss decreased (-0.492577 --> -0.518504).  Saving model ...
Epoch: 26 cost time: 0.7057700157165527
Epoch: 26, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.488 Vali Acc: 0.552 Test Loss: 1.488 Test Acc: 0.552
Validation loss decreased (-0.518504 --> -0.551837).  Saving model ...
Epoch: 27 cost time: 0.7843620777130127
Epoch: 27, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.475 Vali Acc: 0.574 Test Loss: 1.475 Test Acc: 0.574
Validation loss decreased (-0.551837 --> -0.574059).  Saving model ...
Epoch: 28 cost time: 0.6521062850952148
Epoch: 28, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.462 Vali Acc: 0.578 Test Loss: 1.462 Test Acc: 0.578
Validation loss decreased (-0.574059 --> -0.577763).  Saving model ...
Epoch: 29 cost time: 0.7076809406280518
Epoch: 29, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.449 Vali Acc: 0.593 Test Loss: 1.449 Test Acc: 0.593
Validation loss decreased (-0.577763 --> -0.592578).  Saving model ...
Epoch: 30 cost time: 0.5774722099304199
Epoch: 30, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.436 Vali Acc: 0.593 Test Loss: 1.436 Test Acc: 0.593
Validation loss decreased (-0.592578 --> -0.592578).  Saving model ...
Epoch: 31 cost time: 0.5577313899993896
Epoch: 31, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.424 Vali Acc: 0.604 Test Loss: 1.424 Test Acc: 0.604
Validation loss decreased (-0.592578 --> -0.603689).  Saving model ...
Epoch: 32 cost time: 0.9185059070587158
Epoch: 32, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.412 Vali Acc: 0.615 Test Loss: 1.412 Test Acc: 0.615
Validation loss decreased (-0.603689 --> -0.614801).  Saving model ...
Epoch: 33 cost time: 0.834082841873169
Epoch: 33, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.399 Vali Acc: 0.619 Test Loss: 1.399 Test Acc: 0.619
Validation loss decreased (-0.614801 --> -0.618505).  Saving model ...
Epoch: 34 cost time: 0.9625685214996338
Epoch: 34, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.388 Vali Acc: 0.622 Test Loss: 1.388 Test Acc: 0.622
Validation loss decreased (-0.618505 --> -0.622208).  Saving model ...
Epoch: 35 cost time: 0.7901012897491455
Epoch: 35, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.376 Vali Acc: 0.633 Test Loss: 1.376 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633320).  Saving model ...
Epoch: 36 cost time: 0.8642063140869141
Epoch: 36, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.365 Vali Acc: 0.652 Test Loss: 1.365 Test Acc: 0.652
Validation loss decreased (-0.633320 --> -0.651838).  Saving model ...
Epoch: 37 cost time: 0.733783483505249
Epoch: 37, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.354 Vali Acc: 0.652 Test Loss: 1.354 Test Acc: 0.652
Validation loss decreased (-0.651838 --> -0.651838).  Saving model ...
Epoch: 38 cost time: 0.7113077640533447
Epoch: 38, Steps: 2 | Train Loss: 0.845 Vali Loss: 1.342 Vali Acc: 0.656 Test Loss: 1.342 Test Acc: 0.656
Validation loss decreased (-0.651838 --> -0.655542).  Saving model ...
Epoch: 39 cost time: 0.8334314823150635
Epoch: 39, Steps: 2 | Train Loss: 0.831 Vali Loss: 1.332 Vali Acc: 0.659 Test Loss: 1.332 Test Acc: 0.659
Validation loss decreased (-0.655542 --> -0.659246).  Saving model ...
Epoch: 40 cost time: 0.6842782497406006
Epoch: 40, Steps: 2 | Train Loss: 0.805 Vali Loss: 1.321 Vali Acc: 0.659 Test Loss: 1.321 Test Acc: 0.659
Validation loss decreased (-0.659246 --> -0.659246).  Saving model ...
Epoch: 41 cost time: 0.7728631496429443
Epoch: 41, Steps: 2 | Train Loss: 0.786 Vali Loss: 1.310 Vali Acc: 0.663 Test Loss: 1.310 Test Acc: 0.663
Validation loss decreased (-0.659246 --> -0.662950).  Saving model ...
Epoch: 42 cost time: 0.5913550853729248
Epoch: 42, Steps: 2 | Train Loss: 0.759 Vali Loss: 1.299 Vali Acc: 0.659 Test Loss: 1.299 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7317397594451904
Epoch: 43, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.289 Vali Acc: 0.659 Test Loss: 1.289 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.73150634765625
Epoch: 44, Steps: 2 | Train Loss: 0.730 Vali Loss: 1.279 Vali Acc: 0.678 Test Loss: 1.279 Test Acc: 0.678
Validation loss decreased (-0.662950 --> -0.677765).  Saving model ...
Epoch: 45 cost time: 0.6164262294769287
Epoch: 45, Steps: 2 | Train Loss: 0.699 Vali Loss: 1.269 Vali Acc: 0.685 Test Loss: 1.269 Test Acc: 0.685
Validation loss decreased (-0.677765 --> -0.685172).  Saving model ...
Epoch: 46 cost time: 0.777167558670044
Epoch: 46, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.259 Vali Acc: 0.689 Test Loss: 1.259 Test Acc: 0.689
Validation loss decreased (-0.685172 --> -0.688876).  Saving model ...
Epoch: 47 cost time: 0.6844513416290283
Epoch: 47, Steps: 2 | Train Loss: 0.636 Vali Loss: 1.249 Vali Acc: 0.685 Test Loss: 1.249 Test Acc: 0.685
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.596625804901123
Epoch: 48, Steps: 2 | Train Loss: 0.653 Vali Loss: 1.239 Vali Acc: 0.681 Test Loss: 1.239 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7728517055511475
Epoch: 49, Steps: 2 | Train Loss: 0.599 Vali Loss: 1.230 Vali Acc: 0.681 Test Loss: 1.230 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8318817615509033
Epoch: 50, Steps: 2 | Train Loss: 0.586 Vali Loss: 1.220 Vali Acc: 0.685 Test Loss: 1.220 Test Acc: 0.685
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7210018634796143
Epoch: 51, Steps: 2 | Train Loss: 0.550 Vali Loss: 1.211 Vali Acc: 0.685 Test Loss: 1.211 Test Acc: 0.685
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8434815406799316
Epoch: 52, Steps: 2 | Train Loss: 0.520 Vali Loss: 1.202 Vali Acc: 0.689 Test Loss: 1.202 Test Acc: 0.689
Validation loss decreased (-0.688876 --> -0.688877).  Saving model ...
Epoch: 53 cost time: 0.748042106628418
Epoch: 53, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.193 Vali Acc: 0.696 Test Loss: 1.193 Test Acc: 0.696
Validation loss decreased (-0.688877 --> -0.696284).  Saving model ...
Epoch: 54 cost time: 0.7840533256530762
Epoch: 54, Steps: 2 | Train Loss: 0.497 Vali Loss: 1.183 Vali Acc: 0.693 Test Loss: 1.183 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6840198040008545
Epoch: 55, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.174 Vali Acc: 0.693 Test Loss: 1.174 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6255569458007812
Epoch: 56, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.165 Vali Acc: 0.693 Test Loss: 1.165 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8782517910003662
Epoch: 57, Steps: 2 | Train Loss: 0.442 Vali Loss: 1.156 Vali Acc: 0.700 Test Loss: 1.156 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 58 cost time: 0.7188260555267334
Epoch: 58, Steps: 2 | Train Loss: 0.449 Vali Loss: 1.148 Vali Acc: 0.700 Test Loss: 1.148 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 59 cost time: 0.7691638469696045
Epoch: 59, Steps: 2 | Train Loss: 0.452 Vali Loss: 1.139 Vali Acc: 0.700 Test Loss: 1.139 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 60 cost time: 0.7956342697143555
Epoch: 60, Steps: 2 | Train Loss: 0.437 Vali Loss: 1.130 Vali Acc: 0.704 Test Loss: 1.130 Test Acc: 0.704
Validation loss decreased (-0.699989 --> -0.703692).  Saving model ...
Epoch: 61 cost time: 0.7784299850463867
Epoch: 61, Steps: 2 | Train Loss: 0.423 Vali Loss: 1.122 Vali Acc: 0.704 Test Loss: 1.122 Test Acc: 0.704
Validation loss decreased (-0.703692 --> -0.703692).  Saving model ...
Epoch: 62 cost time: 0.7496562004089355
Epoch: 62, Steps: 2 | Train Loss: 0.372 Vali Loss: 1.113 Vali Acc: 0.707 Test Loss: 1.113 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 63 cost time: 0.6976206302642822
Epoch: 63, Steps: 2 | Train Loss: 0.365 Vali Loss: 1.105 Vali Acc: 0.707 Test Loss: 1.105 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 64 cost time: 0.6735179424285889
Epoch: 64, Steps: 2 | Train Loss: 0.355 Vali Loss: 1.097 Vali Acc: 0.707 Test Loss: 1.097 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 65 cost time: 0.7234618663787842
Epoch: 65, Steps: 2 | Train Loss: 0.330 Vali Loss: 1.089 Vali Acc: 0.711 Test Loss: 1.089 Test Acc: 0.711
Validation loss decreased (-0.707396 --> -0.711100).  Saving model ...
Epoch: 66 cost time: 0.8582165241241455
Epoch: 66, Steps: 2 | Train Loss: 0.328 Vali Loss: 1.081 Vali Acc: 0.715 Test Loss: 1.081 Test Acc: 0.715
Validation loss decreased (-0.711100 --> -0.714804).  Saving model ...
Epoch: 67 cost time: 0.770662784576416
Epoch: 67, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.074 Vali Acc: 0.715 Test Loss: 1.074 Test Acc: 0.715
Validation loss decreased (-0.714804 --> -0.714804).  Saving model ...
Epoch: 68 cost time: 0.690030574798584
Epoch: 68, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.066 Vali Acc: 0.715 Test Loss: 1.066 Test Acc: 0.715
Validation loss decreased (-0.714804 --> -0.714804).  Saving model ...
Epoch: 69 cost time: 0.81418776512146
Epoch: 69, Steps: 2 | Train Loss: 0.304 Vali Loss: 1.059 Vali Acc: 0.715 Test Loss: 1.059 Test Acc: 0.715
Validation loss decreased (-0.714804 --> -0.714804).  Saving model ...
Epoch: 70 cost time: 0.8982992172241211
Epoch: 70, Steps: 2 | Train Loss: 0.286 Vali Loss: 1.052 Vali Acc: 0.719 Test Loss: 1.052 Test Acc: 0.719
Validation loss decreased (-0.714804 --> -0.718508).  Saving model ...
Epoch: 71 cost time: 0.8500592708587646
Epoch: 71, Steps: 2 | Train Loss: 0.265 Vali Loss: 1.046 Vali Acc: 0.719 Test Loss: 1.046 Test Acc: 0.719
Validation loss decreased (-0.718508 --> -0.718508).  Saving model ...
Epoch: 72 cost time: 0.5783662796020508
Epoch: 72, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.039 Vali Acc: 0.719 Test Loss: 1.039 Test Acc: 0.719
Validation loss decreased (-0.718508 --> -0.718508).  Saving model ...
Epoch: 73 cost time: 0.8612148761749268
Epoch: 73, Steps: 2 | Train Loss: 0.269 Vali Loss: 1.033 Vali Acc: 0.722 Test Loss: 1.033 Test Acc: 0.722
Validation loss decreased (-0.718508 --> -0.722212).  Saving model ...
Epoch: 74 cost time: 0.7343182563781738
Epoch: 74, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.026 Vali Acc: 0.722 Test Loss: 1.026 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 75 cost time: 0.7349019050598145
Epoch: 75, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.020 Vali Acc: 0.722 Test Loss: 1.020 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722212).  Saving model ...
Epoch: 76 cost time: 0.5605449676513672
Epoch: 76, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.015 Vali Acc: 0.726 Test Loss: 1.015 Test Acc: 0.726
Validation loss decreased (-0.722212 --> -0.725916).  Saving model ...
Epoch: 77 cost time: 0.5749797821044922
Epoch: 77, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.009 Vali Acc: 0.726 Test Loss: 1.009 Test Acc: 0.726
Validation loss decreased (-0.725916 --> -0.725916).  Saving model ...
Epoch: 78 cost time: 0.7346148490905762
Epoch: 78, Steps: 2 | Train Loss: 0.206 Vali Loss: 1.004 Vali Acc: 0.726 Test Loss: 1.004 Test Acc: 0.726
Validation loss decreased (-0.725916 --> -0.725916).  Saving model ...
Epoch: 79 cost time: 0.7769913673400879
Epoch: 79, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.998 Vali Acc: 0.730 Test Loss: 0.998 Test Acc: 0.730
Validation loss decreased (-0.725916 --> -0.729620).  Saving model ...
Epoch: 80 cost time: 0.6522102355957031
Epoch: 80, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.992 Vali Acc: 0.726 Test Loss: 0.992 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8041322231292725
Epoch: 81, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.987 Vali Acc: 0.726 Test Loss: 0.987 Test Acc: 0.726
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.6561737060546875
Epoch: 82, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.982 Vali Acc: 0.722 Test Loss: 0.982 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.7031493186950684
Epoch: 83, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.977 Vali Acc: 0.722 Test Loss: 0.977 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.8533644676208496
Epoch: 84, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.972 Vali Acc: 0.722 Test Loss: 0.972 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.5727791786193848
Epoch: 85, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.967 Vali Acc: 0.722 Test Loss: 0.967 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.57704758644104
Epoch: 86, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.963 Vali Acc: 0.726 Test Loss: 0.963 Test Acc: 0.726
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.49916958808898926
Epoch: 87, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.958 Vali Acc: 0.730 Test Loss: 0.958 Test Acc: 0.730
Validation loss decreased (-0.729620 --> -0.729620).  Saving model ...
Epoch: 88 cost time: 0.5696926116943359
Epoch: 88, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.954 Vali Acc: 0.733 Test Loss: 0.954 Test Acc: 0.733
Validation loss decreased (-0.729620 --> -0.733324).  Saving model ...
Epoch: 89 cost time: 0.6418957710266113
Epoch: 89, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.950 Vali Acc: 0.730 Test Loss: 0.950 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.49266934394836426
Epoch: 90, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.946 Vali Acc: 0.733 Test Loss: 0.946 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 91 cost time: 0.5992794036865234
Epoch: 91, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.941 Vali Acc: 0.733 Test Loss: 0.941 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 92 cost time: 0.6981816291809082
Epoch: 92, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.937 Vali Acc: 0.733 Test Loss: 0.937 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 93 cost time: 0.8556351661682129
Epoch: 93, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 94 cost time: 0.5841705799102783
Epoch: 94, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.930 Vali Acc: 0.733 Test Loss: 0.930 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 95 cost time: 0.7140305042266846
Epoch: 95, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.926 Vali Acc: 0.733 Test Loss: 0.926 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 96 cost time: 0.5201787948608398
Epoch: 96, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 97 cost time: 0.6521406173706055
Epoch: 97, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.918 Vali Acc: 0.733 Test Loss: 0.918 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 98 cost time: 0.7573254108428955
Epoch: 98, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.915 Vali Acc: 0.744 Test Loss: 0.915 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 99 cost time: 0.5493142604827881
Epoch: 99, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.911 Vali Acc: 0.744 Test Loss: 0.911 Test Acc: 0.744
Validation loss decreased (-0.744435 --> -0.744435).  Saving model ...
Epoch: 100 cost time: 0.7928876876831055
Epoch: 100, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.908 Vali Acc: 0.748 Test Loss: 0.908 Test Acc: 0.748
Validation loss decreased (-0.744435 --> -0.748139).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7481481481481481
model parameter : 69348
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.525169610977173
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.788 Vali Acc: 0.237 Test Loss: 1.788 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.6124780178070068
Epoch: 2, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.783 Vali Acc: 0.237 Test Loss: 1.783 Test Acc: 0.237
Validation loss decreased (-0.237019 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 0.5132138729095459
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.779 Vali Acc: 0.233 Test Loss: 1.779 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8118798732757568
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.775 Vali Acc: 0.233 Test Loss: 1.775 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5686962604522705
Epoch: 5, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.769 Vali Acc: 0.237 Test Loss: 1.769 Test Acc: 0.237
Validation loss decreased (-0.237019 --> -0.237019).  Saving model ...
Epoch: 6 cost time: 0.6796741485595703
Epoch: 6, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.762 Vali Acc: 0.252 Test Loss: 1.762 Test Acc: 0.252
Validation loss decreased (-0.237019 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 0.6779768466949463
Epoch: 7, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.754 Vali Acc: 0.256 Test Loss: 1.754 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.7205533981323242
Epoch: 8, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.745 Vali Acc: 0.267 Test Loss: 1.745 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266649).  Saving model ...
Epoch: 9 cost time: 0.6071732044219971
Epoch: 9, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.736 Vali Acc: 0.281 Test Loss: 1.736 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281464).  Saving model ...
Epoch: 10 cost time: 0.6791837215423584
Epoch: 10, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.726 Vali Acc: 0.307 Test Loss: 1.726 Test Acc: 0.307
Validation loss decreased (-0.281464 --> -0.307390).  Saving model ...
Epoch: 11 cost time: 0.5974702835083008
Epoch: 11, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.715 Vali Acc: 0.322 Test Loss: 1.715 Test Acc: 0.322
Validation loss decreased (-0.307390 --> -0.322205).  Saving model ...
Epoch: 12 cost time: 0.7008743286132812
Epoch: 12, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.704 Vali Acc: 0.330 Test Loss: 1.704 Test Acc: 0.330
Validation loss decreased (-0.322205 --> -0.329613).  Saving model ...
Epoch: 13 cost time: 0.728564977645874
Epoch: 13, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.692 Vali Acc: 0.337 Test Loss: 1.692 Test Acc: 0.337
Validation loss decreased (-0.329613 --> -0.337020).  Saving model ...
Epoch: 14 cost time: 0.5682573318481445
Epoch: 14, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.680 Vali Acc: 0.344 Test Loss: 1.680 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344428).  Saving model ...
Epoch: 15 cost time: 0.6739997863769531
Epoch: 15, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.668 Vali Acc: 0.374 Test Loss: 1.668 Test Acc: 0.374
Validation loss decreased (-0.344428 --> -0.374057).  Saving model ...
Epoch: 16 cost time: 0.6792335510253906
Epoch: 16, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.655 Vali Acc: 0.404 Test Loss: 1.655 Test Acc: 0.404
Validation loss decreased (-0.374057 --> -0.403687).  Saving model ...
Epoch: 17 cost time: 0.7504053115844727
Epoch: 17, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.642 Vali Acc: 0.437 Test Loss: 1.642 Test Acc: 0.437
Validation loss decreased (-0.403687 --> -0.437021).  Saving model ...
Epoch: 18 cost time: 0.7734942436218262
Epoch: 18, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.629 Vali Acc: 0.456 Test Loss: 1.629 Test Acc: 0.456
Validation loss decreased (-0.437021 --> -0.455539).  Saving model ...
Epoch: 19 cost time: 0.6284358501434326
Epoch: 19, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.616 Vali Acc: 0.478 Test Loss: 1.616 Test Acc: 0.478
Validation loss decreased (-0.455539 --> -0.477762).  Saving model ...
Epoch: 20 cost time: 0.7199103832244873
Epoch: 20, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
Validation loss decreased (-0.477762 --> -0.499984).  Saving model ...
Epoch: 21 cost time: 0.7931070327758789
Epoch: 21, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499984).  Saving model ...
Epoch: 22 cost time: 0.6449384689331055
Epoch: 22, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.575 Vali Acc: 0.522 Test Loss: 1.575 Test Acc: 0.522
Validation loss decreased (-0.499984 --> -0.522206).  Saving model ...
Epoch: 23 cost time: 0.7271270751953125
Epoch: 23, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.561 Vali Acc: 0.526 Test Loss: 1.561 Test Acc: 0.526
Validation loss decreased (-0.522206 --> -0.525910).  Saving model ...
Epoch: 24 cost time: 0.8515100479125977
Epoch: 24, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.548 Vali Acc: 0.548 Test Loss: 1.548 Test Acc: 0.548
Validation loss decreased (-0.525910 --> -0.548133).  Saving model ...
Epoch: 25 cost time: 0.7521944046020508
Epoch: 25, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.534 Vali Acc: 0.567 Test Loss: 1.534 Test Acc: 0.567
Validation loss decreased (-0.548133 --> -0.566651).  Saving model ...
Epoch: 26 cost time: 0.5965018272399902
Epoch: 26, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.520 Vali Acc: 0.585 Test Loss: 1.520 Test Acc: 0.585
Validation loss decreased (-0.566651 --> -0.585170).  Saving model ...
Epoch: 27 cost time: 0.6790580749511719
Epoch: 27, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.506 Vali Acc: 0.607 Test Loss: 1.506 Test Acc: 0.607
Validation loss decreased (-0.585170 --> -0.607392).  Saving model ...
Epoch: 28 cost time: 0.6174263954162598
Epoch: 28, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.493 Vali Acc: 0.637 Test Loss: 1.493 Test Acc: 0.637
Validation loss decreased (-0.607392 --> -0.637022).  Saving model ...
Epoch: 29 cost time: 0.6591308116912842
Epoch: 29, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.479 Vali Acc: 0.648 Test Loss: 1.479 Test Acc: 0.648
Validation loss decreased (-0.637022 --> -0.648133).  Saving model ...
Epoch: 30 cost time: 0.7422616481781006
Epoch: 30, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.465 Vali Acc: 0.656 Test Loss: 1.465 Test Acc: 0.656
Validation loss decreased (-0.648133 --> -0.655541).  Saving model ...
Epoch: 31 cost time: 0.6880273818969727
Epoch: 31, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.452 Vali Acc: 0.667 Test Loss: 1.452 Test Acc: 0.667
Validation loss decreased (-0.655541 --> -0.666652).  Saving model ...
Epoch: 32 cost time: 0.9368674755096436
Epoch: 32, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.438 Vali Acc: 0.670 Test Loss: 1.438 Test Acc: 0.670
Validation loss decreased (-0.666652 --> -0.670356).  Saving model ...
Epoch: 33 cost time: 0.6271095275878906
Epoch: 33, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.425 Vali Acc: 0.674 Test Loss: 1.425 Test Acc: 0.674
Validation loss decreased (-0.670356 --> -0.674060).  Saving model ...
Epoch: 34 cost time: 0.5822844505310059
Epoch: 34, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.412 Vali Acc: 0.681 Test Loss: 1.412 Test Acc: 0.681
Validation loss decreased (-0.674060 --> -0.681467).  Saving model ...
Epoch: 35 cost time: 0.5305249691009521
Epoch: 35, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.399 Vali Acc: 0.685 Test Loss: 1.399 Test Acc: 0.685
Validation loss decreased (-0.681467 --> -0.685171).  Saving model ...
Epoch: 36 cost time: 0.5874598026275635
Epoch: 36, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.386 Vali Acc: 0.685 Test Loss: 1.386 Test Acc: 0.685
Validation loss decreased (-0.685171 --> -0.685171).  Saving model ...
Epoch: 37 cost time: 0.5711917877197266
Epoch: 37, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.373 Vali Acc: 0.689 Test Loss: 1.373 Test Acc: 0.689
Validation loss decreased (-0.685171 --> -0.688875).  Saving model ...
Epoch: 38 cost time: 0.6426324844360352
Epoch: 38, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.360 Vali Acc: 0.693 Test Loss: 1.360 Test Acc: 0.693
Validation loss decreased (-0.688875 --> -0.692579).  Saving model ...
Epoch: 39 cost time: 0.5737545490264893
Epoch: 39, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.347 Vali Acc: 0.700 Test Loss: 1.347 Test Acc: 0.700
Validation loss decreased (-0.692579 --> -0.699987).  Saving model ...
Epoch: 40 cost time: 0.5785317420959473
Epoch: 40, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.334 Vali Acc: 0.704 Test Loss: 1.334 Test Acc: 0.704
Validation loss decreased (-0.699987 --> -0.703690).  Saving model ...
Epoch: 41 cost time: 0.6915359497070312
Epoch: 41, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.322 Vali Acc: 0.707 Test Loss: 1.322 Test Acc: 0.707
Validation loss decreased (-0.703690 --> -0.707394).  Saving model ...
Epoch: 42 cost time: 0.7543659210205078
Epoch: 42, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.309 Vali Acc: 0.715 Test Loss: 1.309 Test Acc: 0.715
Validation loss decreased (-0.707394 --> -0.714802).  Saving model ...
Epoch: 43 cost time: 0.6288461685180664
Epoch: 43, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.297 Vali Acc: 0.719 Test Loss: 1.297 Test Acc: 0.719
Validation loss decreased (-0.714802 --> -0.718506).  Saving model ...
Epoch: 44 cost time: 0.7426271438598633
Epoch: 44, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.285 Vali Acc: 0.715 Test Loss: 1.285 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5903563499450684
Epoch: 45, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.272 Vali Acc: 0.722 Test Loss: 1.272 Test Acc: 0.722
Validation loss decreased (-0.718506 --> -0.722210).  Saving model ...
Epoch: 46 cost time: 0.5338976383209229
Epoch: 46, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.260 Vali Acc: 0.722 Test Loss: 1.260 Test Acc: 0.722
Validation loss decreased (-0.722210 --> -0.722210).  Saving model ...
Epoch: 47 cost time: 0.6474571228027344
Epoch: 47, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.247 Vali Acc: 0.722 Test Loss: 1.247 Test Acc: 0.722
Validation loss decreased (-0.722210 --> -0.722210).  Saving model ...
Epoch: 48 cost time: 0.8067231178283691
Epoch: 48, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.235 Vali Acc: 0.730 Test Loss: 1.235 Test Acc: 0.730
Validation loss decreased (-0.722210 --> -0.729617).  Saving model ...
Epoch: 49 cost time: 0.7190792560577393
Epoch: 49, Steps: 2 | Train Loss: 0.721 Vali Loss: 1.222 Vali Acc: 0.730 Test Loss: 1.222 Test Acc: 0.730
Validation loss decreased (-0.729617 --> -0.729617).  Saving model ...
Epoch: 50 cost time: 0.6949303150177002
Epoch: 50, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.210 Vali Acc: 0.737 Test Loss: 1.210 Test Acc: 0.737
Validation loss decreased (-0.729617 --> -0.737025).  Saving model ...
Epoch: 51 cost time: 0.6944766044616699
Epoch: 51, Steps: 2 | Train Loss: 0.683 Vali Loss: 1.198 Vali Acc: 0.733 Test Loss: 1.198 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5777623653411865
Epoch: 52, Steps: 2 | Train Loss: 0.661 Vali Loss: 1.186 Vali Acc: 0.737 Test Loss: 1.186 Test Acc: 0.737
Validation loss decreased (-0.737025 --> -0.737025).  Saving model ...
Epoch: 53 cost time: 0.8621439933776855
Epoch: 53, Steps: 2 | Train Loss: 0.647 Vali Loss: 1.174 Vali Acc: 0.737 Test Loss: 1.174 Test Acc: 0.737
Validation loss decreased (-0.737025 --> -0.737025).  Saving model ...
Epoch: 54 cost time: 0.96598219871521
Epoch: 54, Steps: 2 | Train Loss: 0.613 Vali Loss: 1.163 Vali Acc: 0.733 Test Loss: 1.163 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8549776077270508
Epoch: 55, Steps: 2 | Train Loss: 0.588 Vali Loss: 1.151 Vali Acc: 0.737 Test Loss: 1.151 Test Acc: 0.737
Validation loss decreased (-0.737025 --> -0.737026).  Saving model ...
Epoch: 56 cost time: 0.6600983142852783
Epoch: 56, Steps: 2 | Train Loss: 0.556 Vali Loss: 1.140 Vali Acc: 0.737 Test Loss: 1.140 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 57 cost time: 0.7238593101501465
Epoch: 57, Steps: 2 | Train Loss: 0.557 Vali Loss: 1.130 Vali Acc: 0.730 Test Loss: 1.130 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6645815372467041
Epoch: 58, Steps: 2 | Train Loss: 0.513 Vali Loss: 1.120 Vali Acc: 0.730 Test Loss: 1.120 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7262763977050781
Epoch: 59, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.110 Vali Acc: 0.730 Test Loss: 1.110 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7822186946868896
Epoch: 60, Steps: 2 | Train Loss: 0.520 Vali Loss: 1.099 Vali Acc: 0.733 Test Loss: 1.099 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8291764259338379
Epoch: 61, Steps: 2 | Train Loss: 0.513 Vali Loss: 1.089 Vali Acc: 0.733 Test Loss: 1.089 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.7847840785980225
Epoch: 62, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.080 Vali Acc: 0.733 Test Loss: 1.080 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.8745601177215576
Epoch: 63, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.071 Vali Acc: 0.737 Test Loss: 1.071 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 64 cost time: 0.7364790439605713
Epoch: 64, Steps: 2 | Train Loss: 0.439 Vali Loss: 1.063 Vali Acc: 0.737 Test Loss: 1.063 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 65 cost time: 0.8234078884124756
Epoch: 65, Steps: 2 | Train Loss: 0.396 Vali Loss: 1.056 Vali Acc: 0.741 Test Loss: 1.056 Test Acc: 0.741
Validation loss decreased (-0.737026 --> -0.740730).  Saving model ...
Epoch: 66 cost time: 0.6054246425628662
Epoch: 66, Steps: 2 | Train Loss: 0.411 Vali Loss: 1.048 Vali Acc: 0.741 Test Loss: 1.048 Test Acc: 0.741
Validation loss decreased (-0.740730 --> -0.740730).  Saving model ...
Epoch: 67 cost time: 0.7003262042999268
Epoch: 67, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.041 Vali Acc: 0.737 Test Loss: 1.041 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7879557609558105
Epoch: 68, Steps: 2 | Train Loss: 0.358 Vali Loss: 1.034 Vali Acc: 0.733 Test Loss: 1.034 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8212940692901611
Epoch: 69, Steps: 2 | Train Loss: 0.365 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.736515998840332
Epoch: 70, Steps: 2 | Train Loss: 0.344 Vali Loss: 1.020 Vali Acc: 0.730 Test Loss: 1.020 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.762761116027832
Epoch: 71, Steps: 2 | Train Loss: 0.319 Vali Loss: 1.013 Vali Acc: 0.730 Test Loss: 1.013 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.9193236827850342
Epoch: 72, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.007 Vali Acc: 0.730 Test Loss: 1.007 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7444179058074951
Epoch: 73, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.001 Vali Acc: 0.730 Test Loss: 1.001 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7813537120819092
Epoch: 74, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.996 Vali Acc: 0.726 Test Loss: 0.996 Test Acc: 0.726
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.8090770244598389
Epoch: 75, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.990 Vali Acc: 0.722 Test Loss: 0.990 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.7268428802490234
Epoch: 76, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7407407407407407
model parameter : 68836
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5574753284454346
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.788 Vali Acc: 0.237 Test Loss: 1.788 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.801123857498169
Epoch: 2, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.783 Vali Acc: 0.237 Test Loss: 1.783 Test Acc: 0.237
Validation loss decreased (-0.237019 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 0.8212592601776123
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.779 Vali Acc: 0.233 Test Loss: 1.779 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6893975734710693
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.775 Vali Acc: 0.233 Test Loss: 1.775 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6705834865570068
Epoch: 5, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.769 Vali Acc: 0.237 Test Loss: 1.769 Test Acc: 0.237
Validation loss decreased (-0.237019 --> -0.237019).  Saving model ...
Epoch: 6 cost time: 0.9131119251251221
Epoch: 6, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.762 Vali Acc: 0.252 Test Loss: 1.762 Test Acc: 0.252
Validation loss decreased (-0.237019 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 0.7396645545959473
Epoch: 7, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.754 Vali Acc: 0.256 Test Loss: 1.754 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.7379071712493896
Epoch: 8, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.745 Vali Acc: 0.267 Test Loss: 1.745 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266649).  Saving model ...
Epoch: 9 cost time: 0.6957151889801025
Epoch: 9, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.736 Vali Acc: 0.281 Test Loss: 1.736 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281464).  Saving model ...
Epoch: 10 cost time: 0.7340161800384521
Epoch: 10, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.726 Vali Acc: 0.307 Test Loss: 1.726 Test Acc: 0.307
Validation loss decreased (-0.281464 --> -0.307390).  Saving model ...
Epoch: 11 cost time: 0.6122355461120605
Epoch: 11, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.715 Vali Acc: 0.322 Test Loss: 1.715 Test Acc: 0.322
Validation loss decreased (-0.307390 --> -0.322205).  Saving model ...
Epoch: 12 cost time: 0.7445766925811768
Epoch: 12, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.704 Vali Acc: 0.330 Test Loss: 1.704 Test Acc: 0.330
Validation loss decreased (-0.322205 --> -0.329613).  Saving model ...
Epoch: 13 cost time: 0.831505537033081
Epoch: 13, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.692 Vali Acc: 0.337 Test Loss: 1.692 Test Acc: 0.337
Validation loss decreased (-0.329613 --> -0.337020).  Saving model ...
Epoch: 14 cost time: 0.697178840637207
Epoch: 14, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.680 Vali Acc: 0.344 Test Loss: 1.680 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344428).  Saving model ...
Epoch: 15 cost time: 0.5727224349975586
Epoch: 15, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.668 Vali Acc: 0.374 Test Loss: 1.668 Test Acc: 0.374
Validation loss decreased (-0.344428 --> -0.374057).  Saving model ...
Epoch: 16 cost time: 0.636028528213501
Epoch: 16, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.655 Vali Acc: 0.404 Test Loss: 1.655 Test Acc: 0.404
Validation loss decreased (-0.374057 --> -0.403687).  Saving model ...
Epoch: 17 cost time: 0.7090029716491699
Epoch: 17, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.642 Vali Acc: 0.437 Test Loss: 1.642 Test Acc: 0.437
Validation loss decreased (-0.403687 --> -0.437021).  Saving model ...
Epoch: 18 cost time: 0.7615792751312256
Epoch: 18, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.629 Vali Acc: 0.456 Test Loss: 1.629 Test Acc: 0.456
Validation loss decreased (-0.437021 --> -0.455539).  Saving model ...
Epoch: 19 cost time: 0.7959094047546387
Epoch: 19, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.616 Vali Acc: 0.478 Test Loss: 1.616 Test Acc: 0.478
Validation loss decreased (-0.455539 --> -0.477762).  Saving model ...
Epoch: 20 cost time: 0.5277791023254395
Epoch: 20, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
Validation loss decreased (-0.477762 --> -0.499984).  Saving model ...
Epoch: 21 cost time: 0.6799519062042236
Epoch: 21, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499984).  Saving model ...
Epoch: 22 cost time: 0.6846439838409424
Epoch: 22, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.575 Vali Acc: 0.522 Test Loss: 1.575 Test Acc: 0.522
Validation loss decreased (-0.499984 --> -0.522206).  Saving model ...
Epoch: 23 cost time: 0.7711582183837891
Epoch: 23, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.561 Vali Acc: 0.526 Test Loss: 1.561 Test Acc: 0.526
Validation loss decreased (-0.522206 --> -0.525910).  Saving model ...
Epoch: 24 cost time: 0.7308032512664795
Epoch: 24, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.548 Vali Acc: 0.548 Test Loss: 1.548 Test Acc: 0.548
Validation loss decreased (-0.525910 --> -0.548133).  Saving model ...
Epoch: 25 cost time: 0.6140894889831543
Epoch: 25, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.534 Vali Acc: 0.567 Test Loss: 1.534 Test Acc: 0.567
Validation loss decreased (-0.548133 --> -0.566651).  Saving model ...
Epoch: 26 cost time: 0.7002823352813721
Epoch: 26, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.520 Vali Acc: 0.585 Test Loss: 1.520 Test Acc: 0.585
Validation loss decreased (-0.566651 --> -0.585170).  Saving model ...
Epoch: 27 cost time: 0.7549088001251221
Epoch: 27, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.506 Vali Acc: 0.607 Test Loss: 1.506 Test Acc: 0.607
Validation loss decreased (-0.585170 --> -0.607392).  Saving model ...
Epoch: 28 cost time: 0.9067258834838867
Epoch: 28, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.493 Vali Acc: 0.637 Test Loss: 1.493 Test Acc: 0.637
Validation loss decreased (-0.607392 --> -0.637022).  Saving model ...
Epoch: 29 cost time: 0.7787601947784424
Epoch: 29, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.479 Vali Acc: 0.648 Test Loss: 1.479 Test Acc: 0.648
Validation loss decreased (-0.637022 --> -0.648133).  Saving model ...
Epoch: 30 cost time: 0.6492645740509033
Epoch: 30, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.465 Vali Acc: 0.656 Test Loss: 1.465 Test Acc: 0.656
Validation loss decreased (-0.648133 --> -0.655541).  Saving model ...
Epoch: 31 cost time: 0.8682126998901367
Epoch: 31, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.452 Vali Acc: 0.667 Test Loss: 1.452 Test Acc: 0.667
Validation loss decreased (-0.655541 --> -0.666652).  Saving model ...
Epoch: 32 cost time: 1.223700761795044
Epoch: 32, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.438 Vali Acc: 0.670 Test Loss: 1.438 Test Acc: 0.670
Validation loss decreased (-0.666652 --> -0.670356).  Saving model ...
Epoch: 33 cost time: 0.7713606357574463
Epoch: 33, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.425 Vali Acc: 0.674 Test Loss: 1.425 Test Acc: 0.674
Validation loss decreased (-0.670356 --> -0.674060).  Saving model ...
Epoch: 34 cost time: 0.7728967666625977
Epoch: 34, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.412 Vali Acc: 0.681 Test Loss: 1.412 Test Acc: 0.681
Validation loss decreased (-0.674060 --> -0.681467).  Saving model ...
Epoch: 35 cost time: 0.935046911239624
Epoch: 35, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.399 Vali Acc: 0.685 Test Loss: 1.399 Test Acc: 0.685
Validation loss decreased (-0.681467 --> -0.685171).  Saving model ...
Epoch: 36 cost time: 0.8833537101745605
Epoch: 36, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.386 Vali Acc: 0.685 Test Loss: 1.386 Test Acc: 0.685
Validation loss decreased (-0.685171 --> -0.685171).  Saving model ...
Epoch: 37 cost time: 0.7097878456115723
Epoch: 37, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.373 Vali Acc: 0.689 Test Loss: 1.373 Test Acc: 0.689
Validation loss decreased (-0.685171 --> -0.688875).  Saving model ...
Epoch: 38 cost time: 0.7346508502960205
Epoch: 38, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.360 Vali Acc: 0.693 Test Loss: 1.360 Test Acc: 0.693
Validation loss decreased (-0.688875 --> -0.692579).  Saving model ...
Epoch: 39 cost time: 0.7299909591674805
Epoch: 39, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.347 Vali Acc: 0.700 Test Loss: 1.347 Test Acc: 0.700
Validation loss decreased (-0.692579 --> -0.699987).  Saving model ...
Epoch: 40 cost time: 0.7170767784118652
Epoch: 40, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.334 Vali Acc: 0.704 Test Loss: 1.334 Test Acc: 0.704
Validation loss decreased (-0.699987 --> -0.703690).  Saving model ...
Epoch: 41 cost time: 0.7670872211456299
Epoch: 41, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.322 Vali Acc: 0.707 Test Loss: 1.322 Test Acc: 0.707
Validation loss decreased (-0.703690 --> -0.707394).  Saving model ...
Epoch: 42 cost time: 0.7402243614196777
Epoch: 42, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.309 Vali Acc: 0.715 Test Loss: 1.309 Test Acc: 0.715
Validation loss decreased (-0.707394 --> -0.714802).  Saving model ...
Epoch: 43 cost time: 0.7530734539031982
Epoch: 43, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.297 Vali Acc: 0.719 Test Loss: 1.297 Test Acc: 0.719
Validation loss decreased (-0.714802 --> -0.718506).  Saving model ...
Epoch: 44 cost time: 0.7444303035736084
Epoch: 44, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.285 Vali Acc: 0.715 Test Loss: 1.285 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8492867946624756
Epoch: 45, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.272 Vali Acc: 0.722 Test Loss: 1.272 Test Acc: 0.722
Validation loss decreased (-0.718506 --> -0.722210).  Saving model ...
Epoch: 46 cost time: 0.8352711200714111
Epoch: 46, Steps: 2 | Train Loss: 0.780 Vali Loss: 1.260 Vali Acc: 0.722 Test Loss: 1.260 Test Acc: 0.722
Validation loss decreased (-0.722210 --> -0.722210).  Saving model ...
Epoch: 47 cost time: 0.6839025020599365
Epoch: 47, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.247 Vali Acc: 0.722 Test Loss: 1.247 Test Acc: 0.722
Validation loss decreased (-0.722210 --> -0.722210).  Saving model ...
Epoch: 48 cost time: 0.5601239204406738
Epoch: 48, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.235 Vali Acc: 0.730 Test Loss: 1.235 Test Acc: 0.730
Validation loss decreased (-0.722210 --> -0.729617).  Saving model ...
Epoch: 49 cost time: 0.7222023010253906
Epoch: 49, Steps: 2 | Train Loss: 0.721 Vali Loss: 1.222 Vali Acc: 0.730 Test Loss: 1.222 Test Acc: 0.730
Validation loss decreased (-0.729617 --> -0.729617).  Saving model ...
Epoch: 50 cost time: 0.9498996734619141
Epoch: 50, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.210 Vali Acc: 0.737 Test Loss: 1.210 Test Acc: 0.737
Validation loss decreased (-0.729617 --> -0.737025).  Saving model ...
Epoch: 51 cost time: 0.8883695602416992
Epoch: 51, Steps: 2 | Train Loss: 0.683 Vali Loss: 1.198 Vali Acc: 0.733 Test Loss: 1.198 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.780709981918335
Epoch: 52, Steps: 2 | Train Loss: 0.661 Vali Loss: 1.186 Vali Acc: 0.737 Test Loss: 1.186 Test Acc: 0.737
Validation loss decreased (-0.737025 --> -0.737025).  Saving model ...
Epoch: 53 cost time: 0.6329584121704102
Epoch: 53, Steps: 2 | Train Loss: 0.647 Vali Loss: 1.174 Vali Acc: 0.737 Test Loss: 1.174 Test Acc: 0.737
Validation loss decreased (-0.737025 --> -0.737025).  Saving model ...
Epoch: 54 cost time: 0.7740402221679688
Epoch: 54, Steps: 2 | Train Loss: 0.613 Vali Loss: 1.163 Vali Acc: 0.733 Test Loss: 1.163 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8534371852874756
Epoch: 55, Steps: 2 | Train Loss: 0.588 Vali Loss: 1.151 Vali Acc: 0.737 Test Loss: 1.151 Test Acc: 0.737
Validation loss decreased (-0.737025 --> -0.737026).  Saving model ...
Epoch: 56 cost time: 0.9422826766967773
Epoch: 56, Steps: 2 | Train Loss: 0.556 Vali Loss: 1.140 Vali Acc: 0.737 Test Loss: 1.140 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 57 cost time: 0.6795892715454102
Epoch: 57, Steps: 2 | Train Loss: 0.557 Vali Loss: 1.130 Vali Acc: 0.730 Test Loss: 1.130 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6379680633544922
Epoch: 58, Steps: 2 | Train Loss: 0.513 Vali Loss: 1.120 Vali Acc: 0.730 Test Loss: 1.120 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7175803184509277
Epoch: 59, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.110 Vali Acc: 0.730 Test Loss: 1.110 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.6591134071350098
Epoch: 60, Steps: 2 | Train Loss: 0.520 Vali Loss: 1.099 Vali Acc: 0.733 Test Loss: 1.099 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.6569716930389404
Epoch: 61, Steps: 2 | Train Loss: 0.513 Vali Loss: 1.089 Vali Acc: 0.733 Test Loss: 1.089 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.7196893692016602
Epoch: 62, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.080 Vali Acc: 0.733 Test Loss: 1.080 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.8286764621734619
Epoch: 63, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.071 Vali Acc: 0.737 Test Loss: 1.071 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 64 cost time: 0.569664478302002
Epoch: 64, Steps: 2 | Train Loss: 0.439 Vali Loss: 1.063 Vali Acc: 0.737 Test Loss: 1.063 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 65 cost time: 0.6772785186767578
Epoch: 65, Steps: 2 | Train Loss: 0.396 Vali Loss: 1.056 Vali Acc: 0.741 Test Loss: 1.056 Test Acc: 0.741
Validation loss decreased (-0.737026 --> -0.740730).  Saving model ...
Epoch: 66 cost time: 0.6892414093017578
Epoch: 66, Steps: 2 | Train Loss: 0.411 Vali Loss: 1.048 Vali Acc: 0.741 Test Loss: 1.048 Test Acc: 0.741
Validation loss decreased (-0.740730 --> -0.740730).  Saving model ...
Epoch: 67 cost time: 0.9003231525421143
Epoch: 67, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.041 Vali Acc: 0.737 Test Loss: 1.041 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7849349975585938
Epoch: 68, Steps: 2 | Train Loss: 0.358 Vali Loss: 1.034 Vali Acc: 0.733 Test Loss: 1.034 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6827595233917236
Epoch: 69, Steps: 2 | Train Loss: 0.365 Vali Loss: 1.027 Vali Acc: 0.733 Test Loss: 1.027 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8682849407196045
Epoch: 70, Steps: 2 | Train Loss: 0.344 Vali Loss: 1.020 Vali Acc: 0.730 Test Loss: 1.020 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6845924854278564
Epoch: 71, Steps: 2 | Train Loss: 0.319 Vali Loss: 1.013 Vali Acc: 0.730 Test Loss: 1.013 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.7987794876098633
Epoch: 72, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.007 Vali Acc: 0.730 Test Loss: 1.007 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8166935443878174
Epoch: 73, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.001 Vali Acc: 0.730 Test Loss: 1.001 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7375707626342773
Epoch: 74, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.996 Vali Acc: 0.726 Test Loss: 0.996 Test Acc: 0.726
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.7033538818359375
Epoch: 75, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.990 Vali Acc: 0.722 Test Loss: 0.990 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6215260028839111
Epoch: 76, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7407407407407407
model parameter : 68836
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6609606742858887
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.880 Vali Acc: 0.152 Test Loss: 1.880 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.7751240730285645
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.871 Vali Acc: 0.167 Test Loss: 1.871 Test Acc: 0.167
Validation loss decreased (-0.151833 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.6645474433898926
Epoch: 3, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.863 Vali Acc: 0.178 Test Loss: 1.863 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177759).  Saving model ...
Epoch: 4 cost time: 1.1053035259246826
Epoch: 4, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.853 Vali Acc: 0.185 Test Loss: 1.853 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.9407341480255127
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.840 Vali Acc: 0.196 Test Loss: 1.840 Test Acc: 0.196
Validation loss decreased (-0.185167 --> -0.196278).  Saving model ...
Epoch: 6 cost time: 0.9306139945983887
Epoch: 6, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.826 Vali Acc: 0.207 Test Loss: 1.826 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 7 cost time: 0.712547779083252
Epoch: 7, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.810 Vali Acc: 0.230 Test Loss: 1.810 Test Acc: 0.230
Validation loss decreased (-0.207389 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 0.7967326641082764
Epoch: 8, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.793 Vali Acc: 0.263 Test Loss: 1.793 Test Acc: 0.263
Validation loss decreased (-0.229612 --> -0.262945).  Saving model ...
Epoch: 9 cost time: 0.7866654396057129
Epoch: 9, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.776 Vali Acc: 0.270 Test Loss: 1.776 Test Acc: 0.270
Validation loss decreased (-0.262945 --> -0.270353).  Saving model ...
Epoch: 10 cost time: 0.6897528171539307
Epoch: 10, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.759 Vali Acc: 0.281 Test Loss: 1.759 Test Acc: 0.281
Validation loss decreased (-0.270353 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.682793378829956
Epoch: 11, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.742 Vali Acc: 0.304 Test Loss: 1.742 Test Acc: 0.304
Validation loss decreased (-0.281464 --> -0.303686).  Saving model ...
Epoch: 12 cost time: 0.7950336933135986
Epoch: 12, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.724 Vali Acc: 0.319 Test Loss: 1.724 Test Acc: 0.319
Validation loss decreased (-0.303686 --> -0.318501).  Saving model ...
Epoch: 13 cost time: 0.7137236595153809
Epoch: 13, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.705 Vali Acc: 0.337 Test Loss: 1.705 Test Acc: 0.337
Validation loss decreased (-0.318501 --> -0.337020).  Saving model ...
Epoch: 14 cost time: 0.7399182319641113
Epoch: 14, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.685 Vali Acc: 0.378 Test Loss: 1.685 Test Acc: 0.378
Validation loss decreased (-0.337020 --> -0.377761).  Saving model ...
Epoch: 15 cost time: 0.6930317878723145
Epoch: 15, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.664 Vali Acc: 0.411 Test Loss: 1.664 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411094).  Saving model ...
Epoch: 16 cost time: 0.7366704940795898
Epoch: 16, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.644 Vali Acc: 0.426 Test Loss: 1.644 Test Acc: 0.426
Validation loss decreased (-0.411094 --> -0.425909).  Saving model ...
Epoch: 17 cost time: 0.8237533569335938
Epoch: 17, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.623 Vali Acc: 0.456 Test Loss: 1.623 Test Acc: 0.456
Validation loss decreased (-0.425909 --> -0.455539).  Saving model ...
Epoch: 18 cost time: 0.6120545864105225
Epoch: 18, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.602 Vali Acc: 0.474 Test Loss: 1.602 Test Acc: 0.474
Validation loss decreased (-0.455539 --> -0.474058).  Saving model ...
Epoch: 19 cost time: 0.8160715103149414
Epoch: 19, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.581 Vali Acc: 0.489 Test Loss: 1.581 Test Acc: 0.489
Validation loss decreased (-0.474058 --> -0.488873).  Saving model ...
Epoch: 20 cost time: 0.7715675830841064
Epoch: 20, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.562 Vali Acc: 0.507 Test Loss: 1.562 Test Acc: 0.507
Validation loss decreased (-0.488873 --> -0.507392).  Saving model ...
Epoch: 21 cost time: 0.7977211475372314
Epoch: 21, Steps: 2 | Train Loss: 0.895 Vali Loss: 1.544 Vali Acc: 0.515 Test Loss: 1.544 Test Acc: 0.515
Validation loss decreased (-0.507392 --> -0.514799).  Saving model ...
Epoch: 22 cost time: 0.9128034114837646
Epoch: 22, Steps: 2 | Train Loss: 0.837 Vali Loss: 1.526 Vali Acc: 0.507 Test Loss: 1.526 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7162737846374512
Epoch: 23, Steps: 2 | Train Loss: 0.828 Vali Loss: 1.509 Vali Acc: 0.530 Test Loss: 1.509 Test Acc: 0.530
Validation loss decreased (-0.514799 --> -0.529615).  Saving model ...
Epoch: 24 cost time: 0.808253288269043
Epoch: 24, Steps: 2 | Train Loss: 0.824 Vali Loss: 1.493 Vali Acc: 0.544 Test Loss: 1.493 Test Acc: 0.544
Validation loss decreased (-0.529615 --> -0.544430).  Saving model ...
Epoch: 25 cost time: 0.7270517349243164
Epoch: 25, Steps: 2 | Train Loss: 0.785 Vali Loss: 1.479 Vali Acc: 0.552 Test Loss: 1.479 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551837).  Saving model ...
Epoch: 26 cost time: 0.7918088436126709
Epoch: 26, Steps: 2 | Train Loss: 0.740 Vali Loss: 1.464 Vali Acc: 0.570 Test Loss: 1.464 Test Acc: 0.570
Validation loss decreased (-0.551837 --> -0.570356).  Saving model ...
Epoch: 27 cost time: 0.7303736209869385
Epoch: 27, Steps: 2 | Train Loss: 0.711 Vali Loss: 1.451 Vali Acc: 0.574 Test Loss: 1.451 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 28 cost time: 0.7659034729003906
Epoch: 28, Steps: 2 | Train Loss: 0.680 Vali Loss: 1.438 Vali Acc: 0.585 Test Loss: 1.438 Test Acc: 0.585
Validation loss decreased (-0.574060 --> -0.585171).  Saving model ...
Epoch: 29 cost time: 0.7189555168151855
Epoch: 29, Steps: 2 | Train Loss: 0.626 Vali Loss: 1.426 Vali Acc: 0.596 Test Loss: 1.426 Test Acc: 0.596
Validation loss decreased (-0.585171 --> -0.596282).  Saving model ...
Epoch: 30 cost time: 0.7230393886566162
Epoch: 30, Steps: 2 | Train Loss: 0.631 Vali Loss: 1.413 Vali Acc: 0.604 Test Loss: 1.413 Test Acc: 0.604
Validation loss decreased (-0.596282 --> -0.603690).  Saving model ...
Epoch: 31 cost time: 0.8628885746002197
Epoch: 31, Steps: 2 | Train Loss: 0.598 Vali Loss: 1.401 Vali Acc: 0.611 Test Loss: 1.401 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611097).  Saving model ...
Epoch: 32 cost time: 0.8147096633911133
Epoch: 32, Steps: 2 | Train Loss: 0.552 Vali Loss: 1.391 Vali Acc: 0.615 Test Loss: 1.391 Test Acc: 0.615
Validation loss decreased (-0.611097 --> -0.614801).  Saving model ...
Epoch: 33 cost time: 0.741157054901123
Epoch: 33, Steps: 2 | Train Loss: 0.525 Vali Loss: 1.381 Vali Acc: 0.626 Test Loss: 1.381 Test Acc: 0.626
Validation loss decreased (-0.614801 --> -0.625912).  Saving model ...
Epoch: 34 cost time: 0.718766450881958
Epoch: 34, Steps: 2 | Train Loss: 0.503 Vali Loss: 1.373 Vali Acc: 0.622 Test Loss: 1.373 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7422642707824707
Epoch: 35, Steps: 2 | Train Loss: 0.482 Vali Loss: 1.364 Vali Acc: 0.615 Test Loss: 1.364 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6856124401092529
Epoch: 36, Steps: 2 | Train Loss: 0.479 Vali Loss: 1.356 Vali Acc: 0.626 Test Loss: 1.356 Test Acc: 0.626
Validation loss decreased (-0.625912 --> -0.625912).  Saving model ...
Epoch: 37 cost time: 0.9731378555297852
Epoch: 37, Steps: 2 | Train Loss: 0.460 Vali Loss: 1.348 Vali Acc: 0.630 Test Loss: 1.348 Test Acc: 0.630
Validation loss decreased (-0.625912 --> -0.629616).  Saving model ...
Epoch: 38 cost time: 0.8154499530792236
Epoch: 38, Steps: 2 | Train Loss: 0.426 Vali Loss: 1.341 Vali Acc: 0.626 Test Loss: 1.341 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.827312707901001
Epoch: 39, Steps: 2 | Train Loss: 0.419 Vali Loss: 1.333 Vali Acc: 0.626 Test Loss: 1.333 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7095043659210205
Epoch: 40, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.326 Vali Acc: 0.622 Test Loss: 1.326 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7822144031524658
Epoch: 41, Steps: 2 | Train Loss: 0.359 Vali Loss: 1.319 Vali Acc: 0.622 Test Loss: 1.319 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9493310451507568
Epoch: 42, Steps: 2 | Train Loss: 0.361 Vali Loss: 1.312 Vali Acc: 0.626 Test Loss: 1.312 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.834259033203125
Epoch: 43, Steps: 2 | Train Loss: 0.329 Vali Loss: 1.305 Vali Acc: 0.630 Test Loss: 1.305 Test Acc: 0.630
Validation loss decreased (-0.629616 --> -0.629617).  Saving model ...
Epoch: 44 cost time: 0.9286482334136963
Epoch: 44, Steps: 2 | Train Loss: 0.318 Vali Loss: 1.300 Vali Acc: 0.619 Test Loss: 1.300 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8013174533843994
Epoch: 45, Steps: 2 | Train Loss: 0.309 Vali Loss: 1.297 Vali Acc: 0.611 Test Loss: 1.297 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7655205726623535
Epoch: 46, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.292 Vali Acc: 0.611 Test Loss: 1.292 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8647291660308838
Epoch: 47, Steps: 2 | Train Loss: 0.295 Vali Loss: 1.287 Vali Acc: 0.615 Test Loss: 1.287 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8304038047790527
Epoch: 48, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.282 Vali Acc: 0.615 Test Loss: 1.282 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9096579551696777
Epoch: 49, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.276 Vali Acc: 0.619 Test Loss: 1.276 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9935312271118164
Epoch: 50, Steps: 2 | Train Loss: 0.254 Vali Loss: 1.270 Vali Acc: 0.615 Test Loss: 1.270 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6990339756011963
Epoch: 51, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.264 Vali Acc: 0.622 Test Loss: 1.264 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7994308471679688
Epoch: 52, Steps: 2 | Train Loss: 0.223 Vali Loss: 1.258 Vali Acc: 0.619 Test Loss: 1.258 Test Acc: 0.619
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.8075160980224609
Epoch: 53, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.253 Vali Acc: 0.607 Test Loss: 1.253 Test Acc: 0.607
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6296296296296297
model parameter : 72888
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2467334270477295
Epoch: 1, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.814 Vali Acc: 0.185 Test Loss: 1.814 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.8906025886535645
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.809 Vali Acc: 0.185 Test Loss: 1.809 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.6209132671356201
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.804 Vali Acc: 0.196 Test Loss: 1.804 Test Acc: 0.196
Validation loss decreased (-0.185167 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.6156091690063477
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.796 Vali Acc: 0.207 Test Loss: 1.796 Test Acc: 0.207
Validation loss decreased (-0.196278 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 0.7016375064849854
Epoch: 5, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.785 Vali Acc: 0.219 Test Loss: 1.785 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.6821672916412354
Epoch: 6, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.773 Vali Acc: 0.222 Test Loss: 1.773 Test Acc: 0.222
Validation loss decreased (-0.218501 --> -0.222204).  Saving model ...
Epoch: 7 cost time: 0.7145364284515381
Epoch: 7, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.759 Vali Acc: 0.230 Test Loss: 1.759 Test Acc: 0.230
Validation loss decreased (-0.222204 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 0.7342841625213623
Epoch: 8, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.744 Vali Acc: 0.248 Test Loss: 1.744 Test Acc: 0.248
Validation loss decreased (-0.229612 --> -0.248131).  Saving model ...
Epoch: 9 cost time: 0.5539858341217041
Epoch: 9, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.728 Vali Acc: 0.256 Test Loss: 1.728 Test Acc: 0.256
Validation loss decreased (-0.248131 --> -0.255538).  Saving model ...
Epoch: 10 cost time: 0.727555513381958
Epoch: 10, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.712 Vali Acc: 0.281 Test Loss: 1.712 Test Acc: 0.281
Validation loss decreased (-0.255538 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.8262894153594971
Epoch: 11, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.696 Vali Acc: 0.293 Test Loss: 1.696 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292576).  Saving model ...
Epoch: 12 cost time: 0.6755478382110596
Epoch: 12, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.679 Vali Acc: 0.307 Test Loss: 1.679 Test Acc: 0.307
Validation loss decreased (-0.292576 --> -0.307391).  Saving model ...
Epoch: 13 cost time: 0.763237714767456
Epoch: 13, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.662 Vali Acc: 0.322 Test Loss: 1.662 Test Acc: 0.322
Validation loss decreased (-0.307391 --> -0.322206).  Saving model ...
Epoch: 14 cost time: 0.603947639465332
Epoch: 14, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.646 Vali Acc: 0.341 Test Loss: 1.646 Test Acc: 0.341
Validation loss decreased (-0.322206 --> -0.340724).  Saving model ...
Epoch: 15 cost time: 0.6925656795501709
Epoch: 15, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.630 Vali Acc: 0.348 Test Loss: 1.630 Test Acc: 0.348
Validation loss decreased (-0.340724 --> -0.348132).  Saving model ...
Epoch: 16 cost time: 0.7120621204376221
Epoch: 16, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.615 Vali Acc: 0.378 Test Loss: 1.615 Test Acc: 0.378
Validation loss decreased (-0.348132 --> -0.377762).  Saving model ...
Epoch: 17 cost time: 0.6700887680053711
Epoch: 17, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.599 Vali Acc: 0.393 Test Loss: 1.599 Test Acc: 0.393
Validation loss decreased (-0.377762 --> -0.392577).  Saving model ...
Epoch: 18 cost time: 0.7270491123199463
Epoch: 18, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.583 Vali Acc: 0.411 Test Loss: 1.583 Test Acc: 0.411
Validation loss decreased (-0.392577 --> -0.411095).  Saving model ...
Epoch: 19 cost time: 0.6848928928375244
Epoch: 19, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.570 Vali Acc: 0.407 Test Loss: 1.570 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6256332397460938
Epoch: 20, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.558 Vali Acc: 0.415 Test Loss: 1.558 Test Acc: 0.415
Validation loss decreased (-0.411095 --> -0.414799).  Saving model ...
Epoch: 21 cost time: 0.6651358604431152
Epoch: 21, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.546 Vali Acc: 0.448 Test Loss: 1.546 Test Acc: 0.448
Validation loss decreased (-0.414799 --> -0.448133).  Saving model ...
Epoch: 22 cost time: 0.9388887882232666
Epoch: 22, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.536 Vali Acc: 0.448 Test Loss: 1.536 Test Acc: 0.448
Validation loss decreased (-0.448133 --> -0.448133).  Saving model ...
Epoch: 23 cost time: 0.8458251953125
Epoch: 23, Steps: 2 | Train Loss: 0.795 Vali Loss: 1.526 Vali Acc: 0.459 Test Loss: 1.526 Test Acc: 0.459
Validation loss decreased (-0.448133 --> -0.459244).  Saving model ...
Epoch: 24 cost time: 0.7745175361633301
Epoch: 24, Steps: 2 | Train Loss: 0.751 Vali Loss: 1.516 Vali Acc: 0.467 Test Loss: 1.516 Test Acc: 0.467
Validation loss decreased (-0.459244 --> -0.466652).  Saving model ...
Epoch: 25 cost time: 0.7860395908355713
Epoch: 25, Steps: 2 | Train Loss: 0.732 Vali Loss: 1.505 Vali Acc: 0.470 Test Loss: 1.505 Test Acc: 0.470
Validation loss decreased (-0.466652 --> -0.470355).  Saving model ...
Epoch: 26 cost time: 0.6236042976379395
Epoch: 26, Steps: 2 | Train Loss: 0.696 Vali Loss: 1.493 Vali Acc: 0.467 Test Loss: 1.493 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7908477783203125
Epoch: 27, Steps: 2 | Train Loss: 0.680 Vali Loss: 1.482 Vali Acc: 0.467 Test Loss: 1.482 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6589415073394775
Epoch: 28, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.472 Vali Acc: 0.481 Test Loss: 1.472 Test Acc: 0.481
Validation loss decreased (-0.470355 --> -0.481467).  Saving model ...
Epoch: 29 cost time: 0.6537899971008301
Epoch: 29, Steps: 2 | Train Loss: 0.592 Vali Loss: 1.463 Vali Acc: 0.481 Test Loss: 1.463 Test Acc: 0.481
Validation loss decreased (-0.481467 --> -0.481467).  Saving model ...
Epoch: 30 cost time: 0.6590261459350586
Epoch: 30, Steps: 2 | Train Loss: 0.591 Vali Loss: 1.455 Vali Acc: 0.485 Test Loss: 1.455 Test Acc: 0.485
Validation loss decreased (-0.481467 --> -0.485171).  Saving model ...
Epoch: 31 cost time: 0.7417259216308594
Epoch: 31, Steps: 2 | Train Loss: 0.555 Vali Loss: 1.447 Vali Acc: 0.481 Test Loss: 1.447 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7083213329315186
Epoch: 32, Steps: 2 | Train Loss: 0.509 Vali Loss: 1.438 Vali Acc: 0.481 Test Loss: 1.438 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6579043865203857
Epoch: 33, Steps: 2 | Train Loss: 0.503 Vali Loss: 1.428 Vali Acc: 0.481 Test Loss: 1.428 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7156875133514404
Epoch: 34, Steps: 2 | Train Loss: 0.481 Vali Loss: 1.419 Vali Acc: 0.478 Test Loss: 1.419 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8388049602508545
Epoch: 35, Steps: 2 | Train Loss: 0.456 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
Validation loss decreased (-0.485171 --> -0.499986).  Saving model ...
Epoch: 36 cost time: 0.6692473888397217
Epoch: 36, Steps: 2 | Train Loss: 0.427 Vali Loss: 1.399 Vali Acc: 0.507 Test Loss: 1.399 Test Acc: 0.507
Validation loss decreased (-0.499986 --> -0.507393).  Saving model ...
Epoch: 37 cost time: 0.6407740116119385
Epoch: 37, Steps: 2 | Train Loss: 0.411 Vali Loss: 1.390 Vali Acc: 0.511 Test Loss: 1.390 Test Acc: 0.511
Validation loss decreased (-0.507393 --> -0.511097).  Saving model ...
Epoch: 38 cost time: 0.6616394519805908
Epoch: 38, Steps: 2 | Train Loss: 0.390 Vali Loss: 1.381 Vali Acc: 0.522 Test Loss: 1.381 Test Acc: 0.522
Validation loss decreased (-0.511097 --> -0.522208).  Saving model ...
Epoch: 39 cost time: 0.8077099323272705
Epoch: 39, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.373 Vali Acc: 0.533 Test Loss: 1.373 Test Acc: 0.533
Validation loss decreased (-0.522208 --> -0.533320).  Saving model ...
Epoch: 40 cost time: 0.7546205520629883
Epoch: 40, Steps: 2 | Train Loss: 0.370 Vali Loss: 1.365 Vali Acc: 0.541 Test Loss: 1.365 Test Acc: 0.541
Validation loss decreased (-0.533320 --> -0.540727).  Saving model ...
Epoch: 41 cost time: 0.6646912097930908
Epoch: 41, Steps: 2 | Train Loss: 0.322 Vali Loss: 1.357 Vali Acc: 0.541 Test Loss: 1.357 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540727).  Saving model ...
Epoch: 42 cost time: 0.6569294929504395
Epoch: 42, Steps: 2 | Train Loss: 0.327 Vali Loss: 1.348 Vali Acc: 0.544 Test Loss: 1.348 Test Acc: 0.544
Validation loss decreased (-0.540727 --> -0.544431).  Saving model ...
Epoch: 43 cost time: 0.669104814529419
Epoch: 43, Steps: 2 | Train Loss: 0.311 Vali Loss: 1.340 Vali Acc: 0.548 Test Loss: 1.340 Test Acc: 0.548
Validation loss decreased (-0.544431 --> -0.548135).  Saving model ...
Epoch: 44 cost time: 0.6790835857391357
Epoch: 44, Steps: 2 | Train Loss: 0.300 Vali Loss: 1.333 Vali Acc: 0.544 Test Loss: 1.333 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6749365329742432
Epoch: 45, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.326 Vali Acc: 0.559 Test Loss: 1.326 Test Acc: 0.559
Validation loss decreased (-0.548135 --> -0.559246).  Saving model ...
Epoch: 46 cost time: 0.8589417934417725
Epoch: 46, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.320 Vali Acc: 0.563 Test Loss: 1.320 Test Acc: 0.563
Validation loss decreased (-0.559246 --> -0.562950).  Saving model ...
Epoch: 47 cost time: 0.6345939636230469
Epoch: 47, Steps: 2 | Train Loss: 0.263 Vali Loss: 1.314 Vali Acc: 0.570 Test Loss: 1.314 Test Acc: 0.570
Validation loss decreased (-0.562950 --> -0.570357).  Saving model ...
Epoch: 48 cost time: 0.62265944480896
Epoch: 48, Steps: 2 | Train Loss: 0.266 Vali Loss: 1.309 Vali Acc: 0.570 Test Loss: 1.309 Test Acc: 0.570
Validation loss decreased (-0.570357 --> -0.570357).  Saving model ...
Epoch: 49 cost time: 0.7478704452514648
Epoch: 49, Steps: 2 | Train Loss: 0.224 Vali Loss: 1.304 Vali Acc: 0.574 Test Loss: 1.304 Test Acc: 0.574
Validation loss decreased (-0.570357 --> -0.574061).  Saving model ...
Epoch: 50 cost time: 0.6680757999420166
Epoch: 50, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.298 Vali Acc: 0.589 Test Loss: 1.298 Test Acc: 0.589
Validation loss decreased (-0.574061 --> -0.588876).  Saving model ...
Epoch: 51 cost time: 0.681250810623169
Epoch: 51, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.293 Vali Acc: 0.589 Test Loss: 1.293 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588876).  Saving model ...
Epoch: 52 cost time: 0.6787137985229492
Epoch: 52, Steps: 2 | Train Loss: 0.200 Vali Loss: 1.289 Vali Acc: 0.589 Test Loss: 1.289 Test Acc: 0.589
Validation loss decreased (-0.588876 --> -0.588876).  Saving model ...
Epoch: 53 cost time: 0.647761344909668
Epoch: 53, Steps: 2 | Train Loss: 0.206 Vali Loss: 1.284 Vali Acc: 0.585 Test Loss: 1.284 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8303513526916504
Epoch: 54, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.280 Vali Acc: 0.600 Test Loss: 1.280 Test Acc: 0.600
Validation loss decreased (-0.588876 --> -0.599987).  Saving model ...
Epoch: 55 cost time: 0.7423133850097656
Epoch: 55, Steps: 2 | Train Loss: 0.172 Vali Loss: 1.275 Vali Acc: 0.593 Test Loss: 1.275 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7592372894287109
Epoch: 56, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.271 Vali Acc: 0.593 Test Loss: 1.271 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.690488338470459
Epoch: 57, Steps: 2 | Train Loss: 0.166 Vali Loss: 1.266 Vali Acc: 0.589 Test Loss: 1.266 Test Acc: 0.589
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9679863452911377
Epoch: 58, Steps: 2 | Train Loss: 0.158 Vali Loss: 1.262 Vali Acc: 0.596 Test Loss: 1.262 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6993975639343262
Epoch: 59, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.259 Vali Acc: 0.604 Test Loss: 1.259 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603691).  Saving model ...
Epoch: 60 cost time: 0.7360532283782959
Epoch: 60, Steps: 2 | Train Loss: 0.151 Vali Loss: 1.255 Vali Acc: 0.600 Test Loss: 1.255 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8829209804534912
Epoch: 61, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.250 Vali Acc: 0.604 Test Loss: 1.250 Test Acc: 0.604
Validation loss decreased (-0.603691 --> -0.603691).  Saving model ...
Epoch: 62 cost time: 0.7583963871002197
Epoch: 62, Steps: 2 | Train Loss: 0.141 Vali Loss: 1.245 Vali Acc: 0.611 Test Loss: 1.245 Test Acc: 0.611
Validation loss decreased (-0.603691 --> -0.611099).  Saving model ...
Epoch: 63 cost time: 0.6482052803039551
Epoch: 63, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.241 Vali Acc: 0.611 Test Loss: 1.241 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 64 cost time: 0.7207834720611572
Epoch: 64, Steps: 2 | Train Loss: 0.119 Vali Loss: 1.237 Vali Acc: 0.611 Test Loss: 1.237 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 65 cost time: 0.7090747356414795
Epoch: 65, Steps: 2 | Train Loss: 0.121 Vali Loss: 1.232 Vali Acc: 0.615 Test Loss: 1.232 Test Acc: 0.615
Validation loss decreased (-0.611099 --> -0.614802).  Saving model ...
Epoch: 66 cost time: 0.7341339588165283
Epoch: 66, Steps: 2 | Train Loss: 0.119 Vali Loss: 1.228 Vali Acc: 0.615 Test Loss: 1.228 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614803).  Saving model ...
Epoch: 67 cost time: 0.7251095771789551
Epoch: 67, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.224 Vali Acc: 0.622 Test Loss: 1.224 Test Acc: 0.622
Validation loss decreased (-0.614803 --> -0.622210).  Saving model ...
Epoch: 68 cost time: 0.7262959480285645
Epoch: 68, Steps: 2 | Train Loss: 0.113 Vali Loss: 1.220 Vali Acc: 0.615 Test Loss: 1.220 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9094271659851074
Epoch: 69, Steps: 2 | Train Loss: 0.102 Vali Loss: 1.217 Vali Acc: 0.615 Test Loss: 1.217 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8458483219146729
Epoch: 70, Steps: 2 | Train Loss: 0.094 Vali Loss: 1.214 Vali Acc: 0.615 Test Loss: 1.214 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7269797325134277
Epoch: 71, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.211 Vali Acc: 0.607 Test Loss: 1.211 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9174695014953613
Epoch: 72, Steps: 2 | Train Loss: 0.095 Vali Loss: 1.208 Vali Acc: 0.604 Test Loss: 1.208 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.9661719799041748
Epoch: 73, Steps: 2 | Train Loss: 0.092 Vali Loss: 1.206 Vali Acc: 0.604 Test Loss: 1.206 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.647529125213623
Epoch: 74, Steps: 2 | Train Loss: 0.083 Vali Loss: 1.203 Vali Acc: 0.604 Test Loss: 1.203 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.6685147285461426
Epoch: 75, Steps: 2 | Train Loss: 0.081 Vali Loss: 1.200 Vali Acc: 0.607 Test Loss: 1.200 Test Acc: 0.607
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.728471040725708
Epoch: 76, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.198 Vali Acc: 0.607 Test Loss: 1.198 Test Acc: 0.607
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.6906826496124268
Epoch: 77, Steps: 2 | Train Loss: 0.079 Vali Loss: 1.196 Vali Acc: 0.611 Test Loss: 1.196 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6222222222222222
model parameter : 71864
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7271173000335693
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.833 Vali Acc: 0.144 Test Loss: 1.833 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.6708428859710693
Epoch: 2, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.827 Vali Acc: 0.152 Test Loss: 1.827 Test Acc: 0.152
Validation loss decreased (-0.144426 --> -0.151834).  Saving model ...
Epoch: 3 cost time: 0.6746518611907959
Epoch: 3, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.821 Vali Acc: 0.163 Test Loss: 1.821 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.7522048950195312
Epoch: 4, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.813 Vali Acc: 0.167 Test Loss: 1.813 Test Acc: 0.167
Validation loss decreased (-0.162945 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.7169249057769775
Epoch: 5, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.803 Vali Acc: 0.181 Test Loss: 1.803 Test Acc: 0.181
Validation loss decreased (-0.166649 --> -0.181463).  Saving model ...
Epoch: 6 cost time: 0.6627748012542725
Epoch: 6, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.791 Vali Acc: 0.189 Test Loss: 1.791 Test Acc: 0.189
Validation loss decreased (-0.181463 --> -0.188871).  Saving model ...
Epoch: 7 cost time: 0.7374582290649414
Epoch: 7, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.777 Vali Acc: 0.196 Test Loss: 1.777 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196279).  Saving model ...
Epoch: 8 cost time: 0.7611112594604492
Epoch: 8, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.763 Vali Acc: 0.211 Test Loss: 1.763 Test Acc: 0.211
Validation loss decreased (-0.196279 --> -0.211093).  Saving model ...
Epoch: 9 cost time: 0.7514419555664062
Epoch: 9, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.748 Vali Acc: 0.222 Test Loss: 1.748 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222205).  Saving model ...
Epoch: 10 cost time: 0.576798677444458
Epoch: 10, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.733 Vali Acc: 0.252 Test Loss: 1.733 Test Acc: 0.252
Validation loss decreased (-0.222205 --> -0.251835).  Saving model ...
Epoch: 11 cost time: 0.7947027683258057
Epoch: 11, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.718 Vali Acc: 0.300 Test Loss: 1.718 Test Acc: 0.300
Validation loss decreased (-0.251835 --> -0.299983).  Saving model ...
Epoch: 12 cost time: 0.6017210483551025
Epoch: 12, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.702 Vali Acc: 0.300 Test Loss: 1.702 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 13 cost time: 0.7499074935913086
Epoch: 13, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.685 Vali Acc: 0.333 Test Loss: 1.685 Test Acc: 0.333
Validation loss decreased (-0.299983 --> -0.333316).  Saving model ...
Epoch: 14 cost time: 0.8768157958984375
Epoch: 14, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.670 Vali Acc: 0.356 Test Loss: 1.670 Test Acc: 0.356
Validation loss decreased (-0.333316 --> -0.355539).  Saving model ...
Epoch: 15 cost time: 0.7117815017700195
Epoch: 15, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.655 Vali Acc: 0.370 Test Loss: 1.655 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 16 cost time: 0.687110424041748
Epoch: 16, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.639 Vali Acc: 0.374 Test Loss: 1.639 Test Acc: 0.374
Validation loss decreased (-0.370354 --> -0.374058).  Saving model ...
Epoch: 17 cost time: 0.7483956813812256
Epoch: 17, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.625 Vali Acc: 0.396 Test Loss: 1.625 Test Acc: 0.396
Validation loss decreased (-0.374058 --> -0.396280).  Saving model ...
Epoch: 18 cost time: 0.6366877555847168
Epoch: 18, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.611 Vali Acc: 0.419 Test Loss: 1.611 Test Acc: 0.419
Validation loss decreased (-0.396280 --> -0.418502).  Saving model ...
Epoch: 19 cost time: 0.7353415489196777
Epoch: 19, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.597 Vali Acc: 0.437 Test Loss: 1.597 Test Acc: 0.437
Validation loss decreased (-0.418502 --> -0.437021).  Saving model ...
Epoch: 20 cost time: 0.6124205589294434
Epoch: 20, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.585 Vali Acc: 0.441 Test Loss: 1.585 Test Acc: 0.441
Validation loss decreased (-0.437021 --> -0.440725).  Saving model ...
Epoch: 21 cost time: 0.6256089210510254
Epoch: 21, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.572 Vali Acc: 0.467 Test Loss: 1.572 Test Acc: 0.467
Validation loss decreased (-0.440725 --> -0.466651).  Saving model ...
Epoch: 22 cost time: 0.7442989349365234
Epoch: 22, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.560 Vali Acc: 0.467 Test Loss: 1.560 Test Acc: 0.467
Validation loss decreased (-0.466651 --> -0.466651).  Saving model ...
Epoch: 23 cost time: 0.6303799152374268
Epoch: 23, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.549 Vali Acc: 0.478 Test Loss: 1.549 Test Acc: 0.478
Validation loss decreased (-0.466651 --> -0.477762).  Saving model ...
Epoch: 24 cost time: 0.6758933067321777
Epoch: 24, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.537 Vali Acc: 0.485 Test Loss: 1.537 Test Acc: 0.485
Validation loss decreased (-0.477762 --> -0.485170).  Saving model ...
Epoch: 25 cost time: 0.612684965133667
Epoch: 25, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.523 Vali Acc: 0.504 Test Loss: 1.523 Test Acc: 0.504
Validation loss decreased (-0.485170 --> -0.503688).  Saving model ...
Epoch: 26 cost time: 0.6653127670288086
Epoch: 26, Steps: 2 | Train Loss: 0.718 Vali Loss: 1.511 Vali Acc: 0.511 Test Loss: 1.511 Test Acc: 0.511
Validation loss decreased (-0.503688 --> -0.511096).  Saving model ...
Epoch: 27 cost time: 0.6924247741699219
Epoch: 27, Steps: 2 | Train Loss: 0.709 Vali Loss: 1.499 Vali Acc: 0.522 Test Loss: 1.499 Test Acc: 0.522
Validation loss decreased (-0.511096 --> -0.522207).  Saving model ...
Epoch: 28 cost time: 0.6861071586608887
Epoch: 28, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.487 Vali Acc: 0.522 Test Loss: 1.487 Test Acc: 0.522
Validation loss decreased (-0.522207 --> -0.522207).  Saving model ...
Epoch: 29 cost time: 0.7381227016448975
Epoch: 29, Steps: 2 | Train Loss: 0.627 Vali Loss: 1.476 Vali Acc: 0.530 Test Loss: 1.476 Test Acc: 0.530
Validation loss decreased (-0.522207 --> -0.529615).  Saving model ...
Epoch: 30 cost time: 0.8014383316040039
Epoch: 30, Steps: 2 | Train Loss: 0.580 Vali Loss: 1.465 Vali Acc: 0.530 Test Loss: 1.465 Test Acc: 0.530
Validation loss decreased (-0.529615 --> -0.529615).  Saving model ...
Epoch: 31 cost time: 0.8205022811889648
Epoch: 31, Steps: 2 | Train Loss: 0.545 Vali Loss: 1.453 Vali Acc: 0.526 Test Loss: 1.453 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7136797904968262
Epoch: 32, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.443 Vali Acc: 0.522 Test Loss: 1.443 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7112371921539307
Epoch: 33, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.434 Vali Acc: 0.522 Test Loss: 1.434 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6319663524627686
Epoch: 34, Steps: 2 | Train Loss: 0.475 Vali Loss: 1.426 Vali Acc: 0.530 Test Loss: 1.426 Test Acc: 0.530
Validation loss decreased (-0.529615 --> -0.529615).  Saving model ...
Epoch: 35 cost time: 0.8336479663848877
Epoch: 35, Steps: 2 | Train Loss: 0.446 Vali Loss: 1.419 Vali Acc: 0.533 Test Loss: 1.419 Test Acc: 0.533
Validation loss decreased (-0.529615 --> -0.533319).  Saving model ...
Epoch: 36 cost time: 0.6950829029083252
Epoch: 36, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.411 Vali Acc: 0.533 Test Loss: 1.411 Test Acc: 0.533
Validation loss decreased (-0.533319 --> -0.533319).  Saving model ...
Epoch: 37 cost time: 0.6663928031921387
Epoch: 37, Steps: 2 | Train Loss: 0.416 Vali Loss: 1.403 Vali Acc: 0.541 Test Loss: 1.403 Test Acc: 0.541
Validation loss decreased (-0.533319 --> -0.540727).  Saving model ...
Epoch: 38 cost time: 0.7655007839202881
Epoch: 38, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.395 Vali Acc: 0.533 Test Loss: 1.395 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7439990043640137
Epoch: 39, Steps: 2 | Train Loss: 0.386 Vali Loss: 1.386 Vali Acc: 0.533 Test Loss: 1.386 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7456624507904053
Epoch: 40, Steps: 2 | Train Loss: 0.344 Vali Loss: 1.378 Vali Acc: 0.541 Test Loss: 1.378 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540727).  Saving model ...
Epoch: 41 cost time: 0.7053024768829346
Epoch: 41, Steps: 2 | Train Loss: 0.349 Vali Loss: 1.370 Vali Acc: 0.537 Test Loss: 1.370 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7400238513946533
Epoch: 42, Steps: 2 | Train Loss: 0.308 Vali Loss: 1.363 Vali Acc: 0.541 Test Loss: 1.363 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540727).  Saving model ...
Epoch: 43 cost time: 0.7585995197296143
Epoch: 43, Steps: 2 | Train Loss: 0.321 Vali Loss: 1.357 Vali Acc: 0.541 Test Loss: 1.357 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540727).  Saving model ...
Epoch: 44 cost time: 0.7811949253082275
Epoch: 44, Steps: 2 | Train Loss: 0.294 Vali Loss: 1.351 Vali Acc: 0.541 Test Loss: 1.351 Test Acc: 0.541
Validation loss decreased (-0.540727 --> -0.540727).  Saving model ...
Epoch: 45 cost time: 0.7403881549835205
Epoch: 45, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.346 Vali Acc: 0.544 Test Loss: 1.346 Test Acc: 0.544
Validation loss decreased (-0.540727 --> -0.544431).  Saving model ...
Epoch: 46 cost time: 0.7530636787414551
Epoch: 46, Steps: 2 | Train Loss: 0.244 Vali Loss: 1.341 Vali Acc: 0.541 Test Loss: 1.341 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7480225563049316
Epoch: 47, Steps: 2 | Train Loss: 0.251 Vali Loss: 1.336 Vali Acc: 0.552 Test Loss: 1.336 Test Acc: 0.552
Validation loss decreased (-0.544431 --> -0.551838).  Saving model ...
Epoch: 48 cost time: 0.612053632736206
Epoch: 48, Steps: 2 | Train Loss: 0.242 Vali Loss: 1.331 Vali Acc: 0.552 Test Loss: 1.331 Test Acc: 0.552
Validation loss decreased (-0.551838 --> -0.551839).  Saving model ...
Epoch: 49 cost time: 0.8007235527038574
Epoch: 49, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.326 Vali Acc: 0.548 Test Loss: 1.326 Test Acc: 0.548
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6717472076416016
Epoch: 50, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.321 Vali Acc: 0.552 Test Loss: 1.321 Test Acc: 0.552
Validation loss decreased (-0.551839 --> -0.551839).  Saving model ...
Epoch: 51 cost time: 0.7060136795043945
Epoch: 51, Steps: 2 | Train Loss: 0.221 Vali Loss: 1.317 Vali Acc: 0.559 Test Loss: 1.317 Test Acc: 0.559
Validation loss decreased (-0.551839 --> -0.559246).  Saving model ...
Epoch: 52 cost time: 0.7161116600036621
Epoch: 52, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.312 Vali Acc: 0.563 Test Loss: 1.312 Test Acc: 0.563
Validation loss decreased (-0.559246 --> -0.562950).  Saving model ...
Epoch: 53 cost time: 0.8100030422210693
Epoch: 53, Steps: 2 | Train Loss: 0.197 Vali Loss: 1.309 Vali Acc: 0.567 Test Loss: 1.309 Test Acc: 0.567
Validation loss decreased (-0.562950 --> -0.566654).  Saving model ...
Epoch: 54 cost time: 0.6488564014434814
Epoch: 54, Steps: 2 | Train Loss: 0.188 Vali Loss: 1.305 Vali Acc: 0.567 Test Loss: 1.305 Test Acc: 0.567
Validation loss decreased (-0.566654 --> -0.566654).  Saving model ...
Epoch: 55 cost time: 0.5467660427093506
Epoch: 55, Steps: 2 | Train Loss: 0.179 Vali Loss: 1.301 Vali Acc: 0.578 Test Loss: 1.301 Test Acc: 0.578
Validation loss decreased (-0.566654 --> -0.577765).  Saving model ...
Epoch: 56 cost time: 0.6999964714050293
Epoch: 56, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.298 Vali Acc: 0.578 Test Loss: 1.298 Test Acc: 0.578
Validation loss decreased (-0.577765 --> -0.577765).  Saving model ...
Epoch: 57 cost time: 0.5743241310119629
Epoch: 57, Steps: 2 | Train Loss: 0.165 Vali Loss: 1.294 Vali Acc: 0.578 Test Loss: 1.294 Test Acc: 0.578
Validation loss decreased (-0.577765 --> -0.577765).  Saving model ...
Epoch: 58 cost time: 0.8155703544616699
Epoch: 58, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.291 Vali Acc: 0.578 Test Loss: 1.291 Test Acc: 0.578
Validation loss decreased (-0.577765 --> -0.577765).  Saving model ...
Epoch: 59 cost time: 0.62335205078125
Epoch: 59, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.288 Vali Acc: 0.578 Test Loss: 1.288 Test Acc: 0.578
Validation loss decreased (-0.577765 --> -0.577765).  Saving model ...
Epoch: 60 cost time: 0.662764310836792
Epoch: 60, Steps: 2 | Train Loss: 0.147 Vali Loss: 1.286 Vali Acc: 0.578 Test Loss: 1.286 Test Acc: 0.578
Validation loss decreased (-0.577765 --> -0.577765).  Saving model ...
Epoch: 61 cost time: 0.7522845268249512
Epoch: 61, Steps: 2 | Train Loss: 0.149 Vali Loss: 1.282 Vali Acc: 0.581 Test Loss: 1.282 Test Acc: 0.581
Validation loss decreased (-0.577765 --> -0.581469).  Saving model ...
Epoch: 62 cost time: 0.7422809600830078
Epoch: 62, Steps: 2 | Train Loss: 0.136 Vali Loss: 1.278 Vali Acc: 0.585 Test Loss: 1.278 Test Acc: 0.585
Validation loss decreased (-0.581469 --> -0.585172).  Saving model ...
Epoch: 63 cost time: 0.7438936233520508
Epoch: 63, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.275 Vali Acc: 0.593 Test Loss: 1.275 Test Acc: 0.593
Validation loss decreased (-0.585172 --> -0.592580).  Saving model ...
Epoch: 64 cost time: 0.7492806911468506
Epoch: 64, Steps: 2 | Train Loss: 0.121 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
Validation loss decreased (-0.592580 --> -0.599987).  Saving model ...
Epoch: 65 cost time: 0.6787142753601074
Epoch: 65, Steps: 2 | Train Loss: 0.124 Vali Loss: 1.269 Vali Acc: 0.600 Test Loss: 1.269 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 66 cost time: 0.6373581886291504
Epoch: 66, Steps: 2 | Train Loss: 0.117 Vali Loss: 1.266 Vali Acc: 0.600 Test Loss: 1.266 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 67 cost time: 0.7663331031799316
Epoch: 67, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.263 Vali Acc: 0.611 Test Loss: 1.263 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611098).  Saving model ...
Epoch: 68 cost time: 0.7250754833221436
Epoch: 68, Steps: 2 | Train Loss: 0.114 Vali Loss: 1.260 Vali Acc: 0.611 Test Loss: 1.260 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 69 cost time: 0.5927131175994873
Epoch: 69, Steps: 2 | Train Loss: 0.104 Vali Loss: 1.257 Vali Acc: 0.615 Test Loss: 1.257 Test Acc: 0.615
Validation loss decreased (-0.611099 --> -0.614802).  Saving model ...
Epoch: 70 cost time: 0.6297764778137207
Epoch: 70, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.253 Vali Acc: 0.615 Test Loss: 1.253 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 71 cost time: 0.7627747058868408
Epoch: 71, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.251 Vali Acc: 0.619 Test Loss: 1.251 Test Acc: 0.619
Validation loss decreased (-0.614802 --> -0.618506).  Saving model ...
Epoch: 72 cost time: 0.6338493824005127
Epoch: 72, Steps: 2 | Train Loss: 0.094 Vali Loss: 1.249 Vali Acc: 0.619 Test Loss: 1.249 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 73 cost time: 0.7711851596832275
Epoch: 73, Steps: 2 | Train Loss: 0.097 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
Validation loss decreased (-0.618506 --> -0.622210).  Saving model ...
Epoch: 74 cost time: 0.626554012298584
Epoch: 74, Steps: 2 | Train Loss: 0.088 Vali Loss: 1.245 Vali Acc: 0.619 Test Loss: 1.245 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.710472822189331
Epoch: 75, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.243 Vali Acc: 0.619 Test Loss: 1.243 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.8199641704559326
Epoch: 76, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.241 Vali Acc: 0.619 Test Loss: 1.241 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.8875424861907959
Epoch: 77, Steps: 2 | Train Loss: 0.086 Vali Loss: 1.238 Vali Acc: 0.622 Test Loss: 1.238 Test Acc: 0.622
Validation loss decreased (-0.622210 --> -0.622210).  Saving model ...
Epoch: 78 cost time: 0.7264595031738281
Epoch: 78, Steps: 2 | Train Loss: 0.078 Vali Loss: 1.236 Vali Acc: 0.619 Test Loss: 1.236 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.0698227882385254
Epoch: 79, Steps: 2 | Train Loss: 0.074 Vali Loss: 1.234 Vali Acc: 0.619 Test Loss: 1.234 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8131663799285889
Epoch: 80, Steps: 2 | Train Loss: 0.074 Vali Loss: 1.233 Vali Acc: 0.615 Test Loss: 1.233 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.8823039531707764
Epoch: 81, Steps: 2 | Train Loss: 0.069 Vali Loss: 1.231 Vali Acc: 0.611 Test Loss: 1.231 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.8935065269470215
Epoch: 82, Steps: 2 | Train Loss: 0.072 Vali Loss: 1.230 Vali Acc: 0.615 Test Loss: 1.230 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.1840908527374268
Epoch: 83, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.229 Vali Acc: 0.611 Test Loss: 1.229 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.7814090251922607
Epoch: 84, Steps: 2 | Train Loss: 0.067 Vali Loss: 1.227 Vali Acc: 0.611 Test Loss: 1.227 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.7369437217712402
Epoch: 85, Steps: 2 | Train Loss: 0.066 Vali Loss: 1.225 Vali Acc: 0.607 Test Loss: 1.225 Test Acc: 0.607
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.7430331707000732
Epoch: 86, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.224 Vali Acc: 0.607 Test Loss: 1.224 Test Acc: 0.607
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.6951439380645752
Epoch: 87, Steps: 2 | Train Loss: 0.059 Vali Loss: 1.223 Vali Acc: 0.604 Test Loss: 1.223 Test Acc: 0.604
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6222222222222222
model parameter : 70840
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.454688787460327
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.788 Vali Acc: 0.263 Test Loss: 1.788 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.7738521099090576
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.782 Vali Acc: 0.270 Test Loss: 1.782 Test Acc: 0.270
Validation loss decreased (-0.262945 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 1.046401023864746
Epoch: 3, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.775 Vali Acc: 0.270 Test Loss: 1.775 Test Acc: 0.270
Validation loss decreased (-0.270353 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 0.7349989414215088
Epoch: 4, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.766 Vali Acc: 0.274 Test Loss: 1.766 Test Acc: 0.274
Validation loss decreased (-0.270353 --> -0.274056).  Saving model ...
Epoch: 5 cost time: 0.789971113204956
Epoch: 5, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.754 Vali Acc: 0.274 Test Loss: 1.754 Test Acc: 0.274
Validation loss decreased (-0.274056 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 0.9479362964630127
Epoch: 6, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.741 Vali Acc: 0.281 Test Loss: 1.741 Test Acc: 0.281
Validation loss decreased (-0.274057 --> -0.281464).  Saving model ...
Epoch: 7 cost time: 0.6955447196960449
Epoch: 7, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.726 Vali Acc: 0.285 Test Loss: 1.726 Test Acc: 0.285
Validation loss decreased (-0.281464 --> -0.285168).  Saving model ...
Epoch: 8 cost time: 0.9943318367004395
Epoch: 8, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.711 Vali Acc: 0.293 Test Loss: 1.711 Test Acc: 0.293
Validation loss decreased (-0.285168 --> -0.292575).  Saving model ...
Epoch: 9 cost time: 0.8331606388092041
Epoch: 9, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.694 Vali Acc: 0.304 Test Loss: 1.694 Test Acc: 0.304
Validation loss decreased (-0.292575 --> -0.303687).  Saving model ...
Epoch: 10 cost time: 0.6172077655792236
Epoch: 10, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.676 Vali Acc: 0.307 Test Loss: 1.676 Test Acc: 0.307
Validation loss decreased (-0.303687 --> -0.307391).  Saving model ...
Epoch: 11 cost time: 0.6273021697998047
Epoch: 11, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.659 Vali Acc: 0.326 Test Loss: 1.659 Test Acc: 0.326
Validation loss decreased (-0.307391 --> -0.325909).  Saving model ...
Epoch: 12 cost time: 0.7826616764068604
Epoch: 12, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.641 Vali Acc: 0.344 Test Loss: 1.641 Test Acc: 0.344
Validation loss decreased (-0.325909 --> -0.344428).  Saving model ...
Epoch: 13 cost time: 0.731468915939331
Epoch: 13, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.623 Vali Acc: 0.352 Test Loss: 1.623 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351836).  Saving model ...
Epoch: 14 cost time: 0.7522494792938232
Epoch: 14, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.604 Vali Acc: 0.359 Test Loss: 1.604 Test Acc: 0.359
Validation loss decreased (-0.351836 --> -0.359243).  Saving model ...
Epoch: 15 cost time: 0.6648051738739014
Epoch: 15, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.585 Vali Acc: 0.370 Test Loss: 1.585 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370355).  Saving model ...
Epoch: 16 cost time: 0.635622501373291
Epoch: 16, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.567 Vali Acc: 0.374 Test Loss: 1.567 Test Acc: 0.374
Validation loss decreased (-0.370355 --> -0.374058).  Saving model ...
Epoch: 17 cost time: 0.8630640506744385
Epoch: 17, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.549 Vali Acc: 0.396 Test Loss: 1.549 Test Acc: 0.396
Validation loss decreased (-0.374058 --> -0.396281).  Saving model ...
Epoch: 18 cost time: 0.8459091186523438
Epoch: 18, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.531 Vali Acc: 0.415 Test Loss: 1.531 Test Acc: 0.415
Validation loss decreased (-0.396281 --> -0.414800).  Saving model ...
Epoch: 19 cost time: 0.751866340637207
Epoch: 19, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.515 Vali Acc: 0.419 Test Loss: 1.515 Test Acc: 0.419
Validation loss decreased (-0.414800 --> -0.418503).  Saving model ...
Epoch: 20 cost time: 0.6279542446136475
Epoch: 20, Steps: 2 | Train Loss: 0.892 Vali Loss: 1.498 Vali Acc: 0.437 Test Loss: 1.498 Test Acc: 0.437
Validation loss decreased (-0.418503 --> -0.437022).  Saving model ...
Epoch: 21 cost time: 0.6619844436645508
Epoch: 21, Steps: 2 | Train Loss: 0.851 Vali Loss: 1.483 Vali Acc: 0.456 Test Loss: 1.483 Test Acc: 0.456
Validation loss decreased (-0.437022 --> -0.455541).  Saving model ...
Epoch: 22 cost time: 0.7180869579315186
Epoch: 22, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.468 Vali Acc: 0.478 Test Loss: 1.468 Test Acc: 0.478
Validation loss decreased (-0.455541 --> -0.477763).  Saving model ...
Epoch: 23 cost time: 0.8117589950561523
Epoch: 23, Steps: 2 | Train Loss: 0.755 Vali Loss: 1.454 Vali Acc: 0.507 Test Loss: 1.454 Test Acc: 0.507
Validation loss decreased (-0.477763 --> -0.507393).  Saving model ...
Epoch: 24 cost time: 0.6660752296447754
Epoch: 24, Steps: 2 | Train Loss: 0.743 Vali Loss: 1.440 Vali Acc: 0.526 Test Loss: 1.440 Test Acc: 0.526
Validation loss decreased (-0.507393 --> -0.525912).  Saving model ...
Epoch: 25 cost time: 0.6908860206604004
Epoch: 25, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.425 Vali Acc: 0.533 Test Loss: 1.425 Test Acc: 0.533
Validation loss decreased (-0.525912 --> -0.533319).  Saving model ...
Epoch: 26 cost time: 0.7076742649078369
Epoch: 26, Steps: 2 | Train Loss: 0.623 Vali Loss: 1.411 Vali Acc: 0.544 Test Loss: 1.411 Test Acc: 0.544
Validation loss decreased (-0.533319 --> -0.544430).  Saving model ...
Epoch: 27 cost time: 0.8761944770812988
Epoch: 27, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.398 Vali Acc: 0.548 Test Loss: 1.398 Test Acc: 0.548
Validation loss decreased (-0.544430 --> -0.548134).  Saving model ...
Epoch: 28 cost time: 0.6123101711273193
Epoch: 28, Steps: 2 | Train Loss: 0.576 Vali Loss: 1.384 Vali Acc: 0.552 Test Loss: 1.384 Test Acc: 0.552
Validation loss decreased (-0.548134 --> -0.551838).  Saving model ...
Epoch: 29 cost time: 0.738544225692749
Epoch: 29, Steps: 2 | Train Loss: 0.552 Vali Loss: 1.373 Vali Acc: 0.552 Test Loss: 1.373 Test Acc: 0.552
Validation loss decreased (-0.551838 --> -0.551838).  Saving model ...
Epoch: 30 cost time: 0.8610773086547852
Epoch: 30, Steps: 2 | Train Loss: 0.510 Vali Loss: 1.362 Vali Acc: 0.552 Test Loss: 1.362 Test Acc: 0.552
Validation loss decreased (-0.551838 --> -0.551838).  Saving model ...
Epoch: 31 cost time: 0.7670490741729736
Epoch: 31, Steps: 2 | Train Loss: 0.501 Vali Loss: 1.354 Vali Acc: 0.548 Test Loss: 1.354 Test Acc: 0.548
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7904367446899414
Epoch: 32, Steps: 2 | Train Loss: 0.451 Vali Loss: 1.344 Vali Acc: 0.552 Test Loss: 1.344 Test Acc: 0.552
Validation loss decreased (-0.551838 --> -0.551838).  Saving model ...
Epoch: 33 cost time: 0.8624978065490723
Epoch: 33, Steps: 2 | Train Loss: 0.454 Vali Loss: 1.335 Vali Acc: 0.567 Test Loss: 1.335 Test Acc: 0.567
Validation loss decreased (-0.551838 --> -0.566653).  Saving model ...
Epoch: 34 cost time: 0.8803646564483643
Epoch: 34, Steps: 2 | Train Loss: 0.420 Vali Loss: 1.326 Vali Acc: 0.574 Test Loss: 1.326 Test Acc: 0.574
Validation loss decreased (-0.566653 --> -0.574061).  Saving model ...
Epoch: 35 cost time: 1.1390631198883057
Epoch: 35, Steps: 2 | Train Loss: 0.385 Vali Loss: 1.317 Vali Acc: 0.570 Test Loss: 1.317 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9326715469360352
Epoch: 36, Steps: 2 | Train Loss: 0.376 Vali Loss: 1.309 Vali Acc: 0.581 Test Loss: 1.309 Test Acc: 0.581
Validation loss decreased (-0.574061 --> -0.581468).  Saving model ...
Epoch: 37 cost time: 0.7789163589477539
Epoch: 37, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.300 Vali Acc: 0.593 Test Loss: 1.300 Test Acc: 0.593
Validation loss decreased (-0.581468 --> -0.592580).  Saving model ...
Epoch: 38 cost time: 0.7186038494110107
Epoch: 38, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
Validation loss decreased (-0.592580 --> -0.599987).  Saving model ...
Epoch: 39 cost time: 0.8197677135467529
Epoch: 39, Steps: 2 | Train Loss: 0.311 Vali Loss: 1.284 Vali Acc: 0.604 Test Loss: 1.284 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603691).  Saving model ...
Epoch: 40 cost time: 0.7850296497344971
Epoch: 40, Steps: 2 | Train Loss: 0.288 Vali Loss: 1.276 Vali Acc: 0.607 Test Loss: 1.276 Test Acc: 0.607
Validation loss decreased (-0.603691 --> -0.607395).  Saving model ...
Epoch: 41 cost time: 0.6191236972808838
Epoch: 41, Steps: 2 | Train Loss: 0.282 Vali Loss: 1.269 Vali Acc: 0.611 Test Loss: 1.269 Test Acc: 0.611
Validation loss decreased (-0.607395 --> -0.611098).  Saving model ...
Epoch: 42 cost time: 0.6369318962097168
Epoch: 42, Steps: 2 | Train Loss: 0.268 Vali Loss: 1.263 Vali Acc: 0.611 Test Loss: 1.263 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 43 cost time: 0.7348918914794922
Epoch: 43, Steps: 2 | Train Loss: 0.245 Vali Loss: 1.257 Vali Acc: 0.615 Test Loss: 1.257 Test Acc: 0.615
Validation loss decreased (-0.611098 --> -0.614802).  Saving model ...
Epoch: 44 cost time: 0.6823382377624512
Epoch: 44, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.250 Vali Acc: 0.607 Test Loss: 1.250 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8525772094726562
Epoch: 45, Steps: 2 | Train Loss: 0.234 Vali Loss: 1.243 Vali Acc: 0.604 Test Loss: 1.243 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.686349630355835
Epoch: 46, Steps: 2 | Train Loss: 0.221 Vali Loss: 1.236 Vali Acc: 0.607 Test Loss: 1.236 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6570713520050049
Epoch: 47, Steps: 2 | Train Loss: 0.217 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6747171878814697
Epoch: 48, Steps: 2 | Train Loss: 0.191 Vali Loss: 1.223 Vali Acc: 0.604 Test Loss: 1.223 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7516767978668213
Epoch: 49, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.217 Vali Acc: 0.607 Test Loss: 1.217 Test Acc: 0.607
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6810564994812012
Epoch: 50, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.211 Vali Acc: 0.607 Test Loss: 1.211 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7442693710327148
Epoch: 51, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.205 Vali Acc: 0.611 Test Loss: 1.205 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.728278398513794
Epoch: 52, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.200 Vali Acc: 0.611 Test Loss: 1.200 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6744029521942139
Epoch: 53, Steps: 2 | Train Loss: 0.163 Vali Loss: 1.195 Vali Acc: 0.615 Test Loss: 1.195 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614803).  Saving model ...
Epoch: 54 cost time: 0.8629899024963379
Epoch: 54, Steps: 2 | Train Loss: 0.161 Vali Loss: 1.192 Vali Acc: 0.607 Test Loss: 1.192 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7148847579956055
Epoch: 55, Steps: 2 | Train Loss: 0.142 Vali Loss: 1.188 Vali Acc: 0.611 Test Loss: 1.188 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6611175537109375
Epoch: 56, Steps: 2 | Train Loss: 0.141 Vali Loss: 1.185 Vali Acc: 0.611 Test Loss: 1.185 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6611804962158203
Epoch: 57, Steps: 2 | Train Loss: 0.129 Vali Loss: 1.182 Vali Acc: 0.611 Test Loss: 1.182 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6141574382781982
Epoch: 58, Steps: 2 | Train Loss: 0.133 Vali Loss: 1.179 Vali Acc: 0.611 Test Loss: 1.179 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5633900165557861
Epoch: 59, Steps: 2 | Train Loss: 0.130 Vali Loss: 1.176 Vali Acc: 0.611 Test Loss: 1.176 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.821671724319458
Epoch: 60, Steps: 2 | Train Loss: 0.121 Vali Loss: 1.173 Vali Acc: 0.615 Test Loss: 1.173 Test Acc: 0.615
Validation loss decreased (-0.614803 --> -0.614803).  Saving model ...
Epoch: 61 cost time: 0.6638538837432861
Epoch: 61, Steps: 2 | Train Loss: 0.117 Vali Loss: 1.171 Vali Acc: 0.615 Test Loss: 1.171 Test Acc: 0.615
Validation loss decreased (-0.614803 --> -0.614803).  Saving model ...
Epoch: 62 cost time: 0.6743619441986084
Epoch: 62, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.167 Vali Acc: 0.615 Test Loss: 1.167 Test Acc: 0.615
Validation loss decreased (-0.614803 --> -0.614803).  Saving model ...
Epoch: 63 cost time: 0.6488018035888672
Epoch: 63, Steps: 2 | Train Loss: 0.116 Vali Loss: 1.165 Vali Acc: 0.615 Test Loss: 1.165 Test Acc: 0.615
Validation loss decreased (-0.614803 --> -0.614803).  Saving model ...
Epoch: 64 cost time: 0.6974902153015137
Epoch: 64, Steps: 2 | Train Loss: 0.112 Vali Loss: 1.162 Vali Acc: 0.611 Test Loss: 1.162 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7229034900665283
Epoch: 65, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.160 Vali Acc: 0.611 Test Loss: 1.160 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.7942349910736084
Epoch: 66, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.158 Vali Acc: 0.607 Test Loss: 1.158 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.606194257736206
Epoch: 67, Steps: 2 | Train Loss: 0.094 Vali Loss: 1.155 Vali Acc: 0.615 Test Loss: 1.155 Test Acc: 0.615
Validation loss decreased (-0.614803 --> -0.614803).  Saving model ...
Epoch: 68 cost time: 0.6101646423339844
Epoch: 68, Steps: 2 | Train Loss: 0.095 Vali Loss: 1.153 Vali Acc: 0.619 Test Loss: 1.153 Test Acc: 0.619
Validation loss decreased (-0.614803 --> -0.618507).  Saving model ...
Epoch: 69 cost time: 0.5705182552337646
Epoch: 69, Steps: 2 | Train Loss: 0.088 Vali Loss: 1.151 Vali Acc: 0.619 Test Loss: 1.151 Test Acc: 0.619
Validation loss decreased (-0.618507 --> -0.618507).  Saving model ...
Epoch: 70 cost time: 0.5997750759124756
Epoch: 70, Steps: 2 | Train Loss: 0.087 Vali Loss: 1.149 Vali Acc: 0.619 Test Loss: 1.149 Test Acc: 0.619
Validation loss decreased (-0.618507 --> -0.618507).  Saving model ...
Epoch: 71 cost time: 0.7413086891174316
Epoch: 71, Steps: 2 | Train Loss: 0.083 Vali Loss: 1.146 Vali Acc: 0.622 Test Loss: 1.146 Test Acc: 0.622
Validation loss decreased (-0.618507 --> -0.622211).  Saving model ...
Epoch: 72 cost time: 0.5861110687255859
Epoch: 72, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.143 Vali Acc: 0.626 Test Loss: 1.143 Test Acc: 0.626
Validation loss decreased (-0.622211 --> -0.625914).  Saving model ...
Epoch: 73 cost time: 0.5629055500030518
Epoch: 73, Steps: 2 | Train Loss: 0.075 Vali Loss: 1.141 Vali Acc: 0.626 Test Loss: 1.141 Test Acc: 0.626
Validation loss decreased (-0.625914 --> -0.625915).  Saving model ...
Epoch: 74 cost time: 0.592294454574585
Epoch: 74, Steps: 2 | Train Loss: 0.077 Vali Loss: 1.139 Vali Acc: 0.626 Test Loss: 1.139 Test Acc: 0.626
Validation loss decreased (-0.625915 --> -0.625915).  Saving model ...
Epoch: 75 cost time: 0.8822555541992188
Epoch: 75, Steps: 2 | Train Loss: 0.078 Vali Loss: 1.138 Vali Acc: 0.626 Test Loss: 1.138 Test Acc: 0.626
Validation loss decreased (-0.625915 --> -0.625915).  Saving model ...
Epoch: 76 cost time: 0.8967149257659912
Epoch: 76, Steps: 2 | Train Loss: 0.069 Vali Loss: 1.136 Vali Acc: 0.622 Test Loss: 1.136 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7160179615020752
Epoch: 77, Steps: 2 | Train Loss: 0.078 Vali Loss: 1.133 Vali Acc: 0.622 Test Loss: 1.133 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.741185188293457
Epoch: 78, Steps: 2 | Train Loss: 0.071 Vali Loss: 1.130 Vali Acc: 0.622 Test Loss: 1.130 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.6999170780181885
Epoch: 79, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.127 Vali Acc: 0.622 Test Loss: 1.127 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.8177371025085449
Epoch: 80, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.124 Vali Acc: 0.630 Test Loss: 1.124 Test Acc: 0.630
Validation loss decreased (-0.625915 --> -0.629618).  Saving model ...
Epoch: 81 cost time: 0.7724359035491943
Epoch: 81, Steps: 2 | Train Loss: 0.060 Vali Loss: 1.122 Vali Acc: 0.630 Test Loss: 1.122 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 82 cost time: 0.6826949119567871
Epoch: 82, Steps: 2 | Train Loss: 0.058 Vali Loss: 1.119 Vali Acc: 0.633 Test Loss: 1.119 Test Acc: 0.633
Validation loss decreased (-0.629618 --> -0.633322).  Saving model ...
Epoch: 83 cost time: 0.6709966659545898
Epoch: 83, Steps: 2 | Train Loss: 0.061 Vali Loss: 1.116 Vali Acc: 0.633 Test Loss: 1.116 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 84 cost time: 0.6916680335998535
Epoch: 84, Steps: 2 | Train Loss: 0.062 Vali Loss: 1.114 Vali Acc: 0.633 Test Loss: 1.114 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 85 cost time: 0.6320364475250244
Epoch: 85, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.111 Vali Acc: 0.633 Test Loss: 1.111 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 86 cost time: 0.6393711566925049
Epoch: 86, Steps: 2 | Train Loss: 0.047 Vali Loss: 1.108 Vali Acc: 0.633 Test Loss: 1.108 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 87 cost time: 0.7442266941070557
Epoch: 87, Steps: 2 | Train Loss: 0.051 Vali Loss: 1.106 Vali Acc: 0.637 Test Loss: 1.106 Test Acc: 0.637
Validation loss decreased (-0.633322 --> -0.637026).  Saving model ...
Epoch: 88 cost time: 0.7371325492858887
Epoch: 88, Steps: 2 | Train Loss: 0.052 Vali Loss: 1.103 Vali Acc: 0.633 Test Loss: 1.103 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.6813168525695801
Epoch: 89, Steps: 2 | Train Loss: 0.053 Vali Loss: 1.101 Vali Acc: 0.630 Test Loss: 1.101 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.8045003414154053
Epoch: 90, Steps: 2 | Train Loss: 0.047 Vali Loss: 1.098 Vali Acc: 0.630 Test Loss: 1.098 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.8045437335968018
Epoch: 91, Steps: 2 | Train Loss: 0.046 Vali Loss: 1.096 Vali Acc: 0.633 Test Loss: 1.096 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.7276599407196045
Epoch: 92, Steps: 2 | Train Loss: 0.046 Vali Loss: 1.093 Vali Acc: 0.637 Test Loss: 1.093 Test Acc: 0.637
Validation loss decreased (-0.637026 --> -0.637026).  Saving model ...
Epoch: 93 cost time: 0.6993386745452881
Epoch: 93, Steps: 2 | Train Loss: 0.047 Vali Loss: 1.092 Vali Acc: 0.633 Test Loss: 1.092 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.6621840000152588
Epoch: 94, Steps: 2 | Train Loss: 0.041 Vali Loss: 1.090 Vali Acc: 0.633 Test Loss: 1.090 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.6772065162658691
Epoch: 95, Steps: 2 | Train Loss: 0.043 Vali Loss: 1.088 Vali Acc: 0.630 Test Loss: 1.088 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.7031254768371582
Epoch: 96, Steps: 2 | Train Loss: 0.045 Vali Loss: 1.086 Vali Acc: 0.637 Test Loss: 1.086 Test Acc: 0.637
Validation loss decreased (-0.637026 --> -0.637026).  Saving model ...
Epoch: 97 cost time: 0.7876260280609131
Epoch: 97, Steps: 2 | Train Loss: 0.043 Vali Loss: 1.084 Vali Acc: 0.630 Test Loss: 1.084 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.8783152103424072
Epoch: 98, Steps: 2 | Train Loss: 0.039 Vali Loss: 1.082 Vali Acc: 0.630 Test Loss: 1.082 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7951979637145996
Epoch: 99, Steps: 2 | Train Loss: 0.038 Vali Loss: 1.080 Vali Acc: 0.630 Test Loss: 1.080 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.7338173389434814
Epoch: 100, Steps: 2 | Train Loss: 0.040 Vali Loss: 1.078 Vali Acc: 0.626 Test Loss: 1.078 Test Acc: 0.626
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6370370370370371
model parameter : 70328
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3220465183258057
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.816 Vali Acc: 0.215 Test Loss: 1.816 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.6169247627258301
Epoch: 2, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.809 Vali Acc: 0.215 Test Loss: 1.809 Test Acc: 0.215
Validation loss decreased (-0.214797 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.6603231430053711
Epoch: 3, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.802 Vali Acc: 0.226 Test Loss: 1.802 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.6680998802185059
Epoch: 4, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.791 Vali Acc: 0.226 Test Loss: 1.791 Test Acc: 0.226
Validation loss decreased (-0.225908 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 0.5778393745422363
Epoch: 5, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.777 Vali Acc: 0.230 Test Loss: 1.777 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 6 cost time: 0.6206381320953369
Epoch: 6, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.761 Vali Acc: 0.241 Test Loss: 1.761 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.5675480365753174
Epoch: 7, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.742 Vali Acc: 0.244 Test Loss: 1.742 Test Acc: 0.244
Validation loss decreased (-0.240723 --> -0.244427).  Saving model ...
Epoch: 8 cost time: 0.5774457454681396
Epoch: 8, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.722 Vali Acc: 0.259 Test Loss: 1.722 Test Acc: 0.259
Validation loss decreased (-0.244427 --> -0.259242).  Saving model ...
Epoch: 9 cost time: 0.5841507911682129
Epoch: 9, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.701 Vali Acc: 0.278 Test Loss: 1.701 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277761).  Saving model ...
Epoch: 10 cost time: 0.5758891105651855
Epoch: 10, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.680 Vali Acc: 0.300 Test Loss: 1.680 Test Acc: 0.300
Validation loss decreased (-0.277761 --> -0.299983).  Saving model ...
Epoch: 11 cost time: 0.6367764472961426
Epoch: 11, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.659 Vali Acc: 0.315 Test Loss: 1.659 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 12 cost time: 0.7802753448486328
Epoch: 12, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.637 Vali Acc: 0.326 Test Loss: 1.637 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325910).  Saving model ...
Epoch: 13 cost time: 0.5542454719543457
Epoch: 13, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.617 Vali Acc: 0.359 Test Loss: 1.617 Test Acc: 0.359
Validation loss decreased (-0.325910 --> -0.359243).  Saving model ...
Epoch: 14 cost time: 0.6766524314880371
Epoch: 14, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.598 Vali Acc: 0.385 Test Loss: 1.598 Test Acc: 0.385
Validation loss decreased (-0.359243 --> -0.385169).  Saving model ...
Epoch: 15 cost time: 0.5053791999816895
Epoch: 15, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.580 Vali Acc: 0.419 Test Loss: 1.580 Test Acc: 0.419
Validation loss decreased (-0.385169 --> -0.418503).  Saving model ...
Epoch: 16 cost time: 0.833728551864624
Epoch: 16, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.561 Vali Acc: 0.433 Test Loss: 1.561 Test Acc: 0.433
Validation loss decreased (-0.418503 --> -0.433318).  Saving model ...
Epoch: 17 cost time: 0.6746411323547363
Epoch: 17, Steps: 2 | Train Loss: 0.945 Vali Loss: 1.543 Vali Acc: 0.459 Test Loss: 1.543 Test Acc: 0.459
Validation loss decreased (-0.433318 --> -0.459244).  Saving model ...
Epoch: 18 cost time: 0.5707311630249023
Epoch: 18, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.525 Vali Acc: 0.474 Test Loss: 1.525 Test Acc: 0.474
Validation loss decreased (-0.459244 --> -0.474059).  Saving model ...
Epoch: 19 cost time: 0.5326309204101562
Epoch: 19, Steps: 2 | Train Loss: 0.856 Vali Loss: 1.509 Vali Acc: 0.481 Test Loss: 1.509 Test Acc: 0.481
Validation loss decreased (-0.474059 --> -0.481466).  Saving model ...
Epoch: 20 cost time: 0.6110365390777588
Epoch: 20, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.494 Vali Acc: 0.507 Test Loss: 1.494 Test Acc: 0.507
Validation loss decreased (-0.481466 --> -0.507392).  Saving model ...
Epoch: 21 cost time: 0.6509342193603516
Epoch: 21, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.479 Vali Acc: 0.511 Test Loss: 1.479 Test Acc: 0.511
Validation loss decreased (-0.507392 --> -0.511096).  Saving model ...
Epoch: 22 cost time: 0.6654372215270996
Epoch: 22, Steps: 2 | Train Loss: 0.764 Vali Loss: 1.465 Vali Acc: 0.533 Test Loss: 1.465 Test Acc: 0.533
Validation loss decreased (-0.511096 --> -0.533319).  Saving model ...
Epoch: 23 cost time: 0.6285891532897949
Epoch: 23, Steps: 2 | Train Loss: 0.719 Vali Loss: 1.452 Vali Acc: 0.541 Test Loss: 1.452 Test Acc: 0.541
Validation loss decreased (-0.533319 --> -0.540726).  Saving model ...
Epoch: 24 cost time: 0.5859684944152832
Epoch: 24, Steps: 2 | Train Loss: 0.649 Vali Loss: 1.441 Vali Acc: 0.552 Test Loss: 1.441 Test Acc: 0.552
Validation loss decreased (-0.540726 --> -0.551837).  Saving model ...
Epoch: 25 cost time: 0.6460955142974854
Epoch: 25, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.429 Vali Acc: 0.563 Test Loss: 1.429 Test Acc: 0.563
Validation loss decreased (-0.551837 --> -0.562949).  Saving model ...
Epoch: 26 cost time: 0.6878190040588379
Epoch: 26, Steps: 2 | Train Loss: 0.593 Vali Loss: 1.416 Vali Acc: 0.570 Test Loss: 1.416 Test Acc: 0.570
Validation loss decreased (-0.562949 --> -0.570356).  Saving model ...
Epoch: 27 cost time: 0.647676944732666
Epoch: 27, Steps: 2 | Train Loss: 0.550 Vali Loss: 1.404 Vali Acc: 0.570 Test Loss: 1.404 Test Acc: 0.570
Validation loss decreased (-0.570356 --> -0.570356).  Saving model ...
Epoch: 28 cost time: 0.6521120071411133
Epoch: 28, Steps: 2 | Train Loss: 0.542 Vali Loss: 1.393 Vali Acc: 0.578 Test Loss: 1.393 Test Acc: 0.578
Validation loss decreased (-0.570356 --> -0.577764).  Saving model ...
Epoch: 29 cost time: 0.5493791103363037
Epoch: 29, Steps: 2 | Train Loss: 0.500 Vali Loss: 1.382 Vali Acc: 0.578 Test Loss: 1.382 Test Acc: 0.578
Validation loss decreased (-0.577764 --> -0.577764).  Saving model ...
Epoch: 30 cost time: 0.5322732925415039
Epoch: 30, Steps: 2 | Train Loss: 0.470 Vali Loss: 1.372 Vali Acc: 0.581 Test Loss: 1.372 Test Acc: 0.581
Validation loss decreased (-0.577764 --> -0.581468).  Saving model ...
Epoch: 31 cost time: 0.6237928867340088
Epoch: 31, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.361 Vali Acc: 0.589 Test Loss: 1.361 Test Acc: 0.589
Validation loss decreased (-0.581468 --> -0.588875).  Saving model ...
Epoch: 32 cost time: 0.6635236740112305
Epoch: 32, Steps: 2 | Train Loss: 0.416 Vali Loss: 1.352 Vali Acc: 0.589 Test Loss: 1.352 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588875).  Saving model ...
Epoch: 33 cost time: 0.7456343173980713
Epoch: 33, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.344 Vali Acc: 0.589 Test Loss: 1.344 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588875).  Saving model ...
Epoch: 34 cost time: 0.5842645168304443
Epoch: 34, Steps: 2 | Train Loss: 0.382 Vali Loss: 1.336 Vali Acc: 0.593 Test Loss: 1.336 Test Acc: 0.593
Validation loss decreased (-0.588875 --> -0.592579).  Saving model ...
Epoch: 35 cost time: 0.6185708045959473
Epoch: 35, Steps: 2 | Train Loss: 0.359 Vali Loss: 1.329 Vali Acc: 0.589 Test Loss: 1.329 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6914761066436768
Epoch: 36, Steps: 2 | Train Loss: 0.354 Vali Loss: 1.323 Vali Acc: 0.578 Test Loss: 1.323 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7533681392669678
Epoch: 37, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.317 Vali Acc: 0.574 Test Loss: 1.317 Test Acc: 0.574
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.746544599533081
Epoch: 38, Steps: 2 | Train Loss: 0.320 Vali Loss: 1.311 Vali Acc: 0.574 Test Loss: 1.311 Test Acc: 0.574
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.705430269241333
Epoch: 39, Steps: 2 | Train Loss: 0.293 Vali Loss: 1.304 Vali Acc: 0.589 Test Loss: 1.304 Test Acc: 0.589
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.699988603591919
Epoch: 40, Steps: 2 | Train Loss: 0.281 Vali Loss: 1.298 Vali Acc: 0.596 Test Loss: 1.298 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 41 cost time: 0.730189323425293
Epoch: 41, Steps: 2 | Train Loss: 0.246 Vali Loss: 1.292 Vali Acc: 0.611 Test Loss: 1.292 Test Acc: 0.611
Validation loss decreased (-0.596283 --> -0.611098).  Saving model ...
Epoch: 42 cost time: 0.6415753364562988
Epoch: 42, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.287 Vali Acc: 0.611 Test Loss: 1.287 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 43 cost time: 0.9909634590148926
Epoch: 43, Steps: 2 | Train Loss: 0.234 Vali Loss: 1.282 Vali Acc: 0.611 Test Loss: 1.282 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 44 cost time: 0.6572093963623047
Epoch: 44, Steps: 2 | Train Loss: 0.223 Vali Loss: 1.278 Vali Acc: 0.611 Test Loss: 1.278 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 45 cost time: 0.7937955856323242
Epoch: 45, Steps: 2 | Train Loss: 0.210 Vali Loss: 1.274 Vali Acc: 0.604 Test Loss: 1.274 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8184757232666016
Epoch: 46, Steps: 2 | Train Loss: 0.196 Vali Loss: 1.269 Vali Acc: 0.607 Test Loss: 1.269 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8349885940551758
Epoch: 47, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.265 Vali Acc: 0.604 Test Loss: 1.265 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7157869338989258
Epoch: 48, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.261 Vali Acc: 0.600 Test Loss: 1.261 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7196743488311768
Epoch: 49, Steps: 2 | Train Loss: 0.181 Vali Loss: 1.258 Vali Acc: 0.600 Test Loss: 1.258 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6944136619567871
Epoch: 50, Steps: 2 | Train Loss: 0.170 Vali Loss: 1.255 Vali Acc: 0.600 Test Loss: 1.255 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7556517124176025
Epoch: 51, Steps: 2 | Train Loss: 0.168 Vali Loss: 1.252 Vali Acc: 0.604 Test Loss: 1.252 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6950554847717285
Epoch: 52, Steps: 2 | Train Loss: 0.145 Vali Loss: 1.249 Vali Acc: 0.611 Test Loss: 1.249 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611099).  Saving model ...
Epoch: 53 cost time: 0.653268575668335
Epoch: 53, Steps: 2 | Train Loss: 0.155 Vali Loss: 1.245 Vali Acc: 0.611 Test Loss: 1.245 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 54 cost time: 0.7726624011993408
Epoch: 54, Steps: 2 | Train Loss: 0.137 Vali Loss: 1.242 Vali Acc: 0.604 Test Loss: 1.242 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7406644821166992
Epoch: 55, Steps: 2 | Train Loss: 0.138 Vali Loss: 1.239 Vali Acc: 0.604 Test Loss: 1.239 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7095069885253906
Epoch: 56, Steps: 2 | Train Loss: 0.125 Vali Loss: 1.236 Vali Acc: 0.604 Test Loss: 1.236 Test Acc: 0.604
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7433555126190186
Epoch: 57, Steps: 2 | Train Loss: 0.127 Vali Loss: 1.233 Vali Acc: 0.604 Test Loss: 1.233 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.680760383605957
Epoch: 58, Steps: 2 | Train Loss: 0.121 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7572894096374512
Epoch: 59, Steps: 2 | Train Loss: 0.121 Vali Loss: 1.227 Vali Acc: 0.604 Test Loss: 1.227 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6925725936889648
Epoch: 60, Steps: 2 | Train Loss: 0.113 Vali Loss: 1.224 Vali Acc: 0.604 Test Loss: 1.224 Test Acc: 0.604
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.8917920589447021
Epoch: 61, Steps: 2 | Train Loss: 0.115 Vali Loss: 1.221 Vali Acc: 0.596 Test Loss: 1.221 Test Acc: 0.596
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.6374650001525879
Epoch: 62, Steps: 2 | Train Loss: 0.103 Vali Loss: 1.218 Vali Acc: 0.600 Test Loss: 1.218 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.7389640808105469
Epoch: 63, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.215 Vali Acc: 0.604 Test Loss: 1.215 Test Acc: 0.604
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6111111111111112
model parameter : 69304
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.12519907951355
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.862 Vali Acc: 0.211 Test Loss: 1.862 Test Acc: 0.211
Validation loss decreased (inf --> -0.211092).  Saving model ...
Epoch: 2 cost time: 0.7156238555908203
Epoch: 2, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.856 Vali Acc: 0.230 Test Loss: 1.856 Test Acc: 0.230
Validation loss decreased (-0.211092 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.7070937156677246
Epoch: 3, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.849 Vali Acc: 0.233 Test Loss: 1.849 Test Acc: 0.233
Validation loss decreased (-0.229611 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 0.7721929550170898
Epoch: 4, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.839 Vali Acc: 0.222 Test Loss: 1.839 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8428945541381836
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.826 Vali Acc: 0.230 Test Loss: 1.826 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6648492813110352
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.813 Vali Acc: 0.241 Test Loss: 1.813 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.694033145904541
Epoch: 7, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
Validation loss decreased (-0.240723 --> -0.259241).  Saving model ...
Epoch: 8 cost time: 0.6165947914123535
Epoch: 8, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.782 Vali Acc: 0.278 Test Loss: 1.782 Test Acc: 0.278
Validation loss decreased (-0.259241 --> -0.277760).  Saving model ...
Epoch: 9 cost time: 0.6317791938781738
Epoch: 9, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.764 Vali Acc: 0.300 Test Loss: 1.764 Test Acc: 0.300
Validation loss decreased (-0.277760 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 0.6537961959838867
Epoch: 10, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.746 Vali Acc: 0.307 Test Loss: 1.746 Test Acc: 0.307
Validation loss decreased (-0.299982 --> -0.307390).  Saving model ...
Epoch: 11 cost time: 0.5753178596496582
Epoch: 11, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.729 Vali Acc: 0.311 Test Loss: 1.729 Test Acc: 0.311
Validation loss decreased (-0.307390 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 1.010544776916504
Epoch: 12, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.710 Vali Acc: 0.322 Test Loss: 1.710 Test Acc: 0.322
Validation loss decreased (-0.311094 --> -0.322205).  Saving model ...
Epoch: 13 cost time: 0.7466232776641846
Epoch: 13, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.692 Vali Acc: 0.341 Test Loss: 1.692 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340724).  Saving model ...
Epoch: 14 cost time: 0.8394176959991455
Epoch: 14, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.673 Vali Acc: 0.370 Test Loss: 1.673 Test Acc: 0.370
Validation loss decreased (-0.340724 --> -0.370354).  Saving model ...
Epoch: 15 cost time: 0.6866424083709717
Epoch: 15, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.655 Vali Acc: 0.381 Test Loss: 1.655 Test Acc: 0.381
Validation loss decreased (-0.370354 --> -0.381465).  Saving model ...
Epoch: 16 cost time: 0.8980007171630859
Epoch: 16, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.637 Vali Acc: 0.381 Test Loss: 1.637 Test Acc: 0.381
Validation loss decreased (-0.381465 --> -0.381465).  Saving model ...
Epoch: 17 cost time: 0.6439793109893799
Epoch: 17, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.618 Vali Acc: 0.400 Test Loss: 1.618 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 18 cost time: 0.703289270401001
Epoch: 18, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.599 Vali Acc: 0.426 Test Loss: 1.599 Test Acc: 0.426
Validation loss decreased (-0.399984 --> -0.425910).  Saving model ...
Epoch: 19 cost time: 0.6335740089416504
Epoch: 19, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.580 Vali Acc: 0.444 Test Loss: 1.580 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444429).  Saving model ...
Epoch: 20 cost time: 0.682955265045166
Epoch: 20, Steps: 2 | Train Loss: 0.771 Vali Loss: 1.560 Vali Acc: 0.459 Test Loss: 1.560 Test Acc: 0.459
Validation loss decreased (-0.444429 --> -0.459244).  Saving model ...
Epoch: 21 cost time: 0.7342779636383057
Epoch: 21, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.541 Vali Acc: 0.481 Test Loss: 1.541 Test Acc: 0.481
Validation loss decreased (-0.459244 --> -0.481466).  Saving model ...
Epoch: 22 cost time: 0.7474527359008789
Epoch: 22, Steps: 2 | Train Loss: 0.689 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503688).  Saving model ...
Epoch: 23 cost time: 0.6885011196136475
Epoch: 23, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.504 Vali Acc: 0.519 Test Loss: 1.504 Test Acc: 0.519
Validation loss decreased (-0.503688 --> -0.518503).  Saving model ...
Epoch: 24 cost time: 0.7124395370483398
Epoch: 24, Steps: 2 | Train Loss: 0.626 Vali Loss: 1.488 Vali Acc: 0.526 Test Loss: 1.488 Test Acc: 0.526
Validation loss decreased (-0.518503 --> -0.525911).  Saving model ...
Epoch: 25 cost time: 0.8059792518615723
Epoch: 25, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.474 Vali Acc: 0.526 Test Loss: 1.474 Test Acc: 0.526
Validation loss decreased (-0.525911 --> -0.525911).  Saving model ...
Epoch: 26 cost time: 0.7374634742736816
Epoch: 26, Steps: 2 | Train Loss: 0.558 Vali Loss: 1.461 Vali Acc: 0.533 Test Loss: 1.461 Test Acc: 0.533
Validation loss decreased (-0.525911 --> -0.533319).  Saving model ...
Epoch: 27 cost time: 0.7464950084686279
Epoch: 27, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.450 Vali Acc: 0.537 Test Loss: 1.450 Test Acc: 0.537
Validation loss decreased (-0.533319 --> -0.537023).  Saving model ...
Epoch: 28 cost time: 0.7220470905303955
Epoch: 28, Steps: 2 | Train Loss: 0.471 Vali Loss: 1.439 Vali Acc: 0.552 Test Loss: 1.439 Test Acc: 0.552
Validation loss decreased (-0.537023 --> -0.551837).  Saving model ...
Epoch: 29 cost time: 0.7362701892852783
Epoch: 29, Steps: 2 | Train Loss: 0.428 Vali Loss: 1.428 Vali Acc: 0.552 Test Loss: 1.428 Test Acc: 0.552
Validation loss decreased (-0.551837 --> -0.551838).  Saving model ...
Epoch: 30 cost time: 0.8799300193786621
Epoch: 30, Steps: 2 | Train Loss: 0.403 Vali Loss: 1.417 Vali Acc: 0.563 Test Loss: 1.417 Test Acc: 0.563
Validation loss decreased (-0.551838 --> -0.562949).  Saving model ...
Epoch: 31 cost time: 0.808868408203125
Epoch: 31, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.407 Vali Acc: 0.570 Test Loss: 1.407 Test Acc: 0.570
Validation loss decreased (-0.562949 --> -0.570356).  Saving model ...
Epoch: 32 cost time: 0.6931521892547607
Epoch: 32, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.396 Vali Acc: 0.581 Test Loss: 1.396 Test Acc: 0.581
Validation loss decreased (-0.570356 --> -0.581468).  Saving model ...
Epoch: 33 cost time: 0.8337583541870117
Epoch: 33, Steps: 2 | Train Loss: 0.351 Vali Loss: 1.386 Vali Acc: 0.574 Test Loss: 1.386 Test Acc: 0.574
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7473664283752441
Epoch: 34, Steps: 2 | Train Loss: 0.333 Vali Loss: 1.376 Vali Acc: 0.570 Test Loss: 1.376 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7548482418060303
Epoch: 35, Steps: 2 | Train Loss: 0.299 Vali Loss: 1.368 Vali Acc: 0.581 Test Loss: 1.368 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581468).  Saving model ...
Epoch: 36 cost time: 0.6658172607421875
Epoch: 36, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.360 Vali Acc: 0.585 Test Loss: 1.360 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585172).  Saving model ...
Epoch: 37 cost time: 0.6496264934539795
Epoch: 37, Steps: 2 | Train Loss: 0.299 Vali Loss: 1.354 Vali Acc: 0.585 Test Loss: 1.354 Test Acc: 0.585
Validation loss decreased (-0.585172 --> -0.585172).  Saving model ...
Epoch: 38 cost time: 0.7518689632415771
Epoch: 38, Steps: 2 | Train Loss: 0.252 Vali Loss: 1.348 Vali Acc: 0.596 Test Loss: 1.348 Test Acc: 0.596
Validation loss decreased (-0.585172 --> -0.596283).  Saving model ...
Epoch: 39 cost time: 0.7674574851989746
Epoch: 39, Steps: 2 | Train Loss: 0.256 Vali Loss: 1.343 Vali Acc: 0.593 Test Loss: 1.343 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8863189220428467
Epoch: 40, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
Validation loss decreased (-0.596283 --> -0.599987).  Saving model ...
Epoch: 41 cost time: 0.7184057235717773
Epoch: 41, Steps: 2 | Train Loss: 0.217 Vali Loss: 1.332 Vali Acc: 0.596 Test Loss: 1.332 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.790618896484375
Epoch: 42, Steps: 2 | Train Loss: 0.205 Vali Loss: 1.326 Vali Acc: 0.604 Test Loss: 1.326 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603690).  Saving model ...
Epoch: 43 cost time: 0.7023084163665771
Epoch: 43, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.321 Vali Acc: 0.600 Test Loss: 1.321 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6864211559295654
Epoch: 44, Steps: 2 | Train Loss: 0.177 Vali Loss: 1.316 Vali Acc: 0.600 Test Loss: 1.316 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6686053276062012
Epoch: 45, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.311 Vali Acc: 0.600 Test Loss: 1.311 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.852949857711792
Epoch: 46, Steps: 2 | Train Loss: 0.163 Vali Loss: 1.306 Vali Acc: 0.596 Test Loss: 1.306 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.695321798324585
Epoch: 47, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.301 Vali Acc: 0.593 Test Loss: 1.301 Test Acc: 0.593
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6303048133850098
Epoch: 48, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.297 Vali Acc: 0.596 Test Loss: 1.297 Test Acc: 0.596
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6195869445800781
Epoch: 49, Steps: 2 | Train Loss: 0.152 Vali Loss: 1.293 Vali Acc: 0.596 Test Loss: 1.293 Test Acc: 0.596
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5353424549102783
Epoch: 50, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.289 Vali Acc: 0.593 Test Loss: 1.289 Test Acc: 0.593
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7881841659545898
Epoch: 51, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.286 Vali Acc: 0.593 Test Loss: 1.286 Test Acc: 0.593
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7052562236785889
Epoch: 52, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.282 Vali Acc: 0.593 Test Loss: 1.282 Test Acc: 0.593
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6037037037037037
model parameter : 68792
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2258572578430176
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.862 Vali Acc: 0.211 Test Loss: 1.862 Test Acc: 0.211
Validation loss decreased (inf --> -0.211092).  Saving model ...
Epoch: 2 cost time: 0.6067759990692139
Epoch: 2, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.856 Vali Acc: 0.230 Test Loss: 1.856 Test Acc: 0.230
Validation loss decreased (-0.211092 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.8096349239349365
Epoch: 3, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.849 Vali Acc: 0.233 Test Loss: 1.849 Test Acc: 0.233
Validation loss decreased (-0.229611 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 0.7071700096130371
Epoch: 4, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.839 Vali Acc: 0.222 Test Loss: 1.839 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7045736312866211
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.826 Vali Acc: 0.230 Test Loss: 1.826 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7852847576141357
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.813 Vali Acc: 0.241 Test Loss: 1.813 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.8568220138549805
Epoch: 7, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
Validation loss decreased (-0.240723 --> -0.259241).  Saving model ...
Epoch: 8 cost time: 0.6503479480743408
Epoch: 8, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.782 Vali Acc: 0.278 Test Loss: 1.782 Test Acc: 0.278
Validation loss decreased (-0.259241 --> -0.277760).  Saving model ...
Epoch: 9 cost time: 0.9111218452453613
Epoch: 9, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.764 Vali Acc: 0.300 Test Loss: 1.764 Test Acc: 0.300
Validation loss decreased (-0.277760 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 0.9676592350006104
Epoch: 10, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.746 Vali Acc: 0.307 Test Loss: 1.746 Test Acc: 0.307
Validation loss decreased (-0.299982 --> -0.307390).  Saving model ...
Epoch: 11 cost time: 0.6518211364746094
Epoch: 11, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.729 Vali Acc: 0.311 Test Loss: 1.729 Test Acc: 0.311
Validation loss decreased (-0.307390 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 0.8398604393005371
Epoch: 12, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.710 Vali Acc: 0.322 Test Loss: 1.710 Test Acc: 0.322
Validation loss decreased (-0.311094 --> -0.322205).  Saving model ...
Epoch: 13 cost time: 0.7691905498504639
Epoch: 13, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.692 Vali Acc: 0.341 Test Loss: 1.692 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340724).  Saving model ...
Epoch: 14 cost time: 0.7033979892730713
Epoch: 14, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.673 Vali Acc: 0.370 Test Loss: 1.673 Test Acc: 0.370
Validation loss decreased (-0.340724 --> -0.370354).  Saving model ...
Epoch: 15 cost time: 0.6528134346008301
Epoch: 15, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.655 Vali Acc: 0.381 Test Loss: 1.655 Test Acc: 0.381
Validation loss decreased (-0.370354 --> -0.381465).  Saving model ...
Epoch: 16 cost time: 1.0258374214172363
Epoch: 16, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.637 Vali Acc: 0.381 Test Loss: 1.637 Test Acc: 0.381
Validation loss decreased (-0.381465 --> -0.381465).  Saving model ...
Epoch: 17 cost time: 0.7219951152801514
Epoch: 17, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.618 Vali Acc: 0.400 Test Loss: 1.618 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 18 cost time: 0.6938297748565674
Epoch: 18, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.599 Vali Acc: 0.426 Test Loss: 1.599 Test Acc: 0.426
Validation loss decreased (-0.399984 --> -0.425910).  Saving model ...
Epoch: 19 cost time: 0.8353216648101807
Epoch: 19, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.580 Vali Acc: 0.444 Test Loss: 1.580 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444429).  Saving model ...
Epoch: 20 cost time: 0.8155174255371094
Epoch: 20, Steps: 2 | Train Loss: 0.771 Vali Loss: 1.560 Vali Acc: 0.459 Test Loss: 1.560 Test Acc: 0.459
Validation loss decreased (-0.444429 --> -0.459244).  Saving model ...
Epoch: 21 cost time: 0.7711217403411865
Epoch: 21, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.541 Vali Acc: 0.481 Test Loss: 1.541 Test Acc: 0.481
Validation loss decreased (-0.459244 --> -0.481466).  Saving model ...
Epoch: 22 cost time: 0.6998636722564697
Epoch: 22, Steps: 2 | Train Loss: 0.689 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503688).  Saving model ...
Epoch: 23 cost time: 0.8284287452697754
Epoch: 23, Steps: 2 | Train Loss: 0.651 Vali Loss: 1.504 Vali Acc: 0.519 Test Loss: 1.504 Test Acc: 0.519
Validation loss decreased (-0.503688 --> -0.518503).  Saving model ...
Epoch: 24 cost time: 0.6440386772155762
Epoch: 24, Steps: 2 | Train Loss: 0.626 Vali Loss: 1.488 Vali Acc: 0.526 Test Loss: 1.488 Test Acc: 0.526
Validation loss decreased (-0.518503 --> -0.525911).  Saving model ...
Epoch: 25 cost time: 0.704749345779419
Epoch: 25, Steps: 2 | Train Loss: 0.578 Vali Loss: 1.474 Vali Acc: 0.526 Test Loss: 1.474 Test Acc: 0.526
Validation loss decreased (-0.525911 --> -0.525911).  Saving model ...
Epoch: 26 cost time: 0.7519745826721191
Epoch: 26, Steps: 2 | Train Loss: 0.558 Vali Loss: 1.461 Vali Acc: 0.533 Test Loss: 1.461 Test Acc: 0.533
Validation loss decreased (-0.525911 --> -0.533319).  Saving model ...
Epoch: 27 cost time: 0.6453120708465576
Epoch: 27, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.450 Vali Acc: 0.537 Test Loss: 1.450 Test Acc: 0.537
Validation loss decreased (-0.533319 --> -0.537023).  Saving model ...
Epoch: 28 cost time: 0.5770998001098633
Epoch: 28, Steps: 2 | Train Loss: 0.471 Vali Loss: 1.439 Vali Acc: 0.552 Test Loss: 1.439 Test Acc: 0.552
Validation loss decreased (-0.537023 --> -0.551837).  Saving model ...
Epoch: 29 cost time: 0.7245132923126221
Epoch: 29, Steps: 2 | Train Loss: 0.428 Vali Loss: 1.428 Vali Acc: 0.552 Test Loss: 1.428 Test Acc: 0.552
Validation loss decreased (-0.551837 --> -0.551838).  Saving model ...
Epoch: 30 cost time: 0.7521767616271973
Epoch: 30, Steps: 2 | Train Loss: 0.403 Vali Loss: 1.417 Vali Acc: 0.563 Test Loss: 1.417 Test Acc: 0.563
Validation loss decreased (-0.551838 --> -0.562949).  Saving model ...
Epoch: 31 cost time: 0.5991766452789307
Epoch: 31, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.407 Vali Acc: 0.570 Test Loss: 1.407 Test Acc: 0.570
Validation loss decreased (-0.562949 --> -0.570356).  Saving model ...
Epoch: 32 cost time: 0.7009522914886475
Epoch: 32, Steps: 2 | Train Loss: 0.367 Vali Loss: 1.396 Vali Acc: 0.581 Test Loss: 1.396 Test Acc: 0.581
Validation loss decreased (-0.570356 --> -0.581468).  Saving model ...
Epoch: 33 cost time: 0.552771806716919
Epoch: 33, Steps: 2 | Train Loss: 0.351 Vali Loss: 1.386 Vali Acc: 0.574 Test Loss: 1.386 Test Acc: 0.574
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7350120544433594
Epoch: 34, Steps: 2 | Train Loss: 0.333 Vali Loss: 1.376 Vali Acc: 0.570 Test Loss: 1.376 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7419958114624023
Epoch: 35, Steps: 2 | Train Loss: 0.299 Vali Loss: 1.368 Vali Acc: 0.581 Test Loss: 1.368 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581468).  Saving model ...
Epoch: 36 cost time: 0.6025362014770508
Epoch: 36, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.360 Vali Acc: 0.585 Test Loss: 1.360 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585172).  Saving model ...
Epoch: 37 cost time: 0.7809638977050781
Epoch: 37, Steps: 2 | Train Loss: 0.299 Vali Loss: 1.354 Vali Acc: 0.585 Test Loss: 1.354 Test Acc: 0.585
Validation loss decreased (-0.585172 --> -0.585172).  Saving model ...
Epoch: 38 cost time: 0.6355938911437988
Epoch: 38, Steps: 2 | Train Loss: 0.252 Vali Loss: 1.348 Vali Acc: 0.596 Test Loss: 1.348 Test Acc: 0.596
Validation loss decreased (-0.585172 --> -0.596283).  Saving model ...
Epoch: 39 cost time: 0.7058713436126709
Epoch: 39, Steps: 2 | Train Loss: 0.256 Vali Loss: 1.343 Vali Acc: 0.593 Test Loss: 1.343 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7254006862640381
Epoch: 40, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
Validation loss decreased (-0.596283 --> -0.599987).  Saving model ...
Epoch: 41 cost time: 0.7218053340911865
Epoch: 41, Steps: 2 | Train Loss: 0.217 Vali Loss: 1.332 Vali Acc: 0.596 Test Loss: 1.332 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8351364135742188
Epoch: 42, Steps: 2 | Train Loss: 0.205 Vali Loss: 1.326 Vali Acc: 0.604 Test Loss: 1.326 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603690).  Saving model ...
Epoch: 43 cost time: 0.6237435340881348
Epoch: 43, Steps: 2 | Train Loss: 0.204 Vali Loss: 1.321 Vali Acc: 0.600 Test Loss: 1.321 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5924627780914307
Epoch: 44, Steps: 2 | Train Loss: 0.177 Vali Loss: 1.316 Vali Acc: 0.600 Test Loss: 1.316 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.784001350402832
Epoch: 45, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.311 Vali Acc: 0.600 Test Loss: 1.311 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.785285472869873
Epoch: 46, Steps: 2 | Train Loss: 0.163 Vali Loss: 1.306 Vali Acc: 0.596 Test Loss: 1.306 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8132760524749756
Epoch: 47, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.301 Vali Acc: 0.593 Test Loss: 1.301 Test Acc: 0.593
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7425239086151123
Epoch: 48, Steps: 2 | Train Loss: 0.153 Vali Loss: 1.297 Vali Acc: 0.596 Test Loss: 1.297 Test Acc: 0.596
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6215963363647461
Epoch: 49, Steps: 2 | Train Loss: 0.152 Vali Loss: 1.293 Vali Acc: 0.596 Test Loss: 1.293 Test Acc: 0.596
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9098725318908691
Epoch: 50, Steps: 2 | Train Loss: 0.150 Vali Loss: 1.289 Vali Acc: 0.593 Test Loss: 1.289 Test Acc: 0.593
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7098212242126465
Epoch: 51, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.286 Vali Acc: 0.593 Test Loss: 1.286 Test Acc: 0.593
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7645783424377441
Epoch: 52, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.282 Vali Acc: 0.593 Test Loss: 1.282 Test Acc: 0.593
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6037037037037037
model parameter : 68792
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6562013626098633
Epoch: 1, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.902 Vali Acc: 0.081 Test Loss: 1.902 Test Acc: 0.081
Validation loss decreased (inf --> -0.081462).  Saving model ...
Epoch: 2 cost time: 0.8310997486114502
Epoch: 2, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.896 Vali Acc: 0.085 Test Loss: 1.896 Test Acc: 0.085
Validation loss decreased (-0.081462 --> -0.085166).  Saving model ...
Epoch: 3 cost time: 0.7518565654754639
Epoch: 3, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.891 Vali Acc: 0.085 Test Loss: 1.891 Test Acc: 0.085
Validation loss decreased (-0.085166 --> -0.085166).  Saving model ...
Epoch: 4 cost time: 0.9776453971862793
Epoch: 4, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.887 Vali Acc: 0.089 Test Loss: 1.887 Test Acc: 0.089
Validation loss decreased (-0.085166 --> -0.088870).  Saving model ...
Epoch: 5 cost time: 0.7040295600891113
Epoch: 5, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.882 Vali Acc: 0.096 Test Loss: 1.882 Test Acc: 0.096
Validation loss decreased (-0.088870 --> -0.096277).  Saving model ...
Epoch: 6 cost time: 0.7167713642120361
Epoch: 6, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.876 Vali Acc: 0.104 Test Loss: 1.876 Test Acc: 0.104
Validation loss decreased (-0.096277 --> -0.103685).  Saving model ...
Epoch: 7 cost time: 0.6488978862762451
Epoch: 7, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.869 Vali Acc: 0.107 Test Loss: 1.869 Test Acc: 0.107
Validation loss decreased (-0.103685 --> -0.107389).  Saving model ...
Epoch: 8 cost time: 0.7329111099243164
Epoch: 8, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.862 Vali Acc: 0.107 Test Loss: 1.862 Test Acc: 0.107
Validation loss decreased (-0.107389 --> -0.107389).  Saving model ...
Epoch: 9 cost time: 0.8213376998901367
Epoch: 9, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.854 Vali Acc: 0.111 Test Loss: 1.854 Test Acc: 0.111
Validation loss decreased (-0.107389 --> -0.111093).  Saving model ...
Epoch: 10 cost time: 0.7305295467376709
Epoch: 10, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.845 Vali Acc: 0.122 Test Loss: 1.845 Test Acc: 0.122
Validation loss decreased (-0.111093 --> -0.122204).  Saving model ...
Epoch: 11 cost time: 0.697622537612915
Epoch: 11, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.836 Vali Acc: 0.141 Test Loss: 1.836 Test Acc: 0.141
Validation loss decreased (-0.122204 --> -0.140722).  Saving model ...
Epoch: 12 cost time: 0.8260395526885986
Epoch: 12, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.827 Vali Acc: 0.148 Test Loss: 1.827 Test Acc: 0.148
Validation loss decreased (-0.140722 --> -0.148130).  Saving model ...
Epoch: 13 cost time: 0.733553409576416
Epoch: 13, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.817 Vali Acc: 0.148 Test Loss: 1.817 Test Acc: 0.148
Validation loss decreased (-0.148130 --> -0.148130).  Saving model ...
Epoch: 14 cost time: 0.5821080207824707
Epoch: 14, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.807 Vali Acc: 0.156 Test Loss: 1.807 Test Acc: 0.156
Validation loss decreased (-0.148130 --> -0.155537).  Saving model ...
Epoch: 15 cost time: 0.6817820072174072
Epoch: 15, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.797 Vali Acc: 0.174 Test Loss: 1.797 Test Acc: 0.174
Validation loss decreased (-0.155537 --> -0.174056).  Saving model ...
Epoch: 16 cost time: 0.7199583053588867
Epoch: 16, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.786 Vali Acc: 0.178 Test Loss: 1.786 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 17 cost time: 0.6802544593811035
Epoch: 17, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.775 Vali Acc: 0.189 Test Loss: 1.775 Test Acc: 0.189
Validation loss decreased (-0.177760 --> -0.188871).  Saving model ...
Epoch: 18 cost time: 0.765678882598877
Epoch: 18, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.764 Vali Acc: 0.200 Test Loss: 1.764 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 19 cost time: 0.6876986026763916
Epoch: 19, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.753 Vali Acc: 0.219 Test Loss: 1.753 Test Acc: 0.219
Validation loss decreased (-0.199982 --> -0.218501).  Saving model ...
Epoch: 20 cost time: 0.6195790767669678
Epoch: 20, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.741 Vali Acc: 0.230 Test Loss: 1.741 Test Acc: 0.230
Validation loss decreased (-0.218501 --> -0.229612).  Saving model ...
Epoch: 21 cost time: 0.8715534210205078
Epoch: 21, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.730 Vali Acc: 0.233 Test Loss: 1.730 Test Acc: 0.233
Validation loss decreased (-0.229612 --> -0.233316).  Saving model ...
Epoch: 22 cost time: 0.7441356182098389
Epoch: 22, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.718 Vali Acc: 0.237 Test Loss: 1.718 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237020).  Saving model ...
Epoch: 23 cost time: 0.880537748336792
Epoch: 23, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.706 Vali Acc: 0.244 Test Loss: 1.706 Test Acc: 0.244
Validation loss decreased (-0.237020 --> -0.244427).  Saving model ...
Epoch: 24 cost time: 0.6526031494140625
Epoch: 24, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.694 Vali Acc: 0.252 Test Loss: 1.694 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251835).  Saving model ...
Epoch: 25 cost time: 0.7597239017486572
Epoch: 25, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.683 Vali Acc: 0.274 Test Loss: 1.683 Test Acc: 0.274
Validation loss decreased (-0.251835 --> -0.274057).  Saving model ...
Epoch: 26 cost time: 0.7218286991119385
Epoch: 26, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.671 Vali Acc: 0.285 Test Loss: 1.671 Test Acc: 0.285
Validation loss decreased (-0.274057 --> -0.285168).  Saving model ...
Epoch: 27 cost time: 0.6286094188690186
Epoch: 27, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.659 Vali Acc: 0.300 Test Loss: 1.659 Test Acc: 0.300
Validation loss decreased (-0.285168 --> -0.299983).  Saving model ...
Epoch: 28 cost time: 0.6889445781707764
Epoch: 28, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.646 Vali Acc: 0.319 Test Loss: 1.646 Test Acc: 0.319
Validation loss decreased (-0.299983 --> -0.318502).  Saving model ...
Epoch: 29 cost time: 0.6345887184143066
Epoch: 29, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.634 Vali Acc: 0.330 Test Loss: 1.634 Test Acc: 0.330
Validation loss decreased (-0.318502 --> -0.329613).  Saving model ...
Epoch: 30 cost time: 0.6435275077819824
Epoch: 30, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.622 Vali Acc: 0.370 Test Loss: 1.622 Test Acc: 0.370
Validation loss decreased (-0.329613 --> -0.370354).  Saving model ...
Epoch: 31 cost time: 1.236421823501587
Epoch: 31, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.609 Vali Acc: 0.389 Test Loss: 1.609 Test Acc: 0.389
Validation loss decreased (-0.370354 --> -0.388873).  Saving model ...
Epoch: 32 cost time: 0.8075590133666992
Epoch: 32, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.597 Vali Acc: 0.404 Test Loss: 1.597 Test Acc: 0.404
Validation loss decreased (-0.388873 --> -0.403688).  Saving model ...
Epoch: 33 cost time: 0.672231912612915
Epoch: 33, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.585 Vali Acc: 0.415 Test Loss: 1.585 Test Acc: 0.415
Validation loss decreased (-0.403688 --> -0.414799).  Saving model ...
Epoch: 34 cost time: 0.8330333232879639
Epoch: 34, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.573 Vali Acc: 0.426 Test Loss: 1.573 Test Acc: 0.426
Validation loss decreased (-0.414799 --> -0.425910).  Saving model ...
Epoch: 35 cost time: 0.7163031101226807
Epoch: 35, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.561 Vali Acc: 0.441 Test Loss: 1.561 Test Acc: 0.441
Validation loss decreased (-0.425910 --> -0.440725).  Saving model ...
Epoch: 36 cost time: 0.7042944431304932
Epoch: 36, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.549 Vali Acc: 0.463 Test Loss: 1.549 Test Acc: 0.463
Validation loss decreased (-0.440725 --> -0.462947).  Saving model ...
Epoch: 37 cost time: 0.8147892951965332
Epoch: 37, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.537 Vali Acc: 0.481 Test Loss: 1.537 Test Acc: 0.481
Validation loss decreased (-0.462947 --> -0.481466).  Saving model ...
Epoch: 38 cost time: 0.7313051223754883
Epoch: 38, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.525 Vali Acc: 0.515 Test Loss: 1.525 Test Acc: 0.515
Validation loss decreased (-0.481466 --> -0.514800).  Saving model ...
Epoch: 39 cost time: 0.7695138454437256
Epoch: 39, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.513 Vali Acc: 0.519 Test Loss: 1.513 Test Acc: 0.519
Validation loss decreased (-0.514800 --> -0.518503).  Saving model ...
Epoch: 40 cost time: 1.0819752216339111
Epoch: 40, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.501 Vali Acc: 0.530 Test Loss: 1.501 Test Acc: 0.530
Validation loss decreased (-0.518503 --> -0.529615).  Saving model ...
Epoch: 41 cost time: 0.7268462181091309
Epoch: 41, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.490 Vali Acc: 0.544 Test Loss: 1.490 Test Acc: 0.544
Validation loss decreased (-0.529615 --> -0.544430).  Saving model ...
Epoch: 42 cost time: 0.9251172542572021
Epoch: 42, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.478 Vali Acc: 0.552 Test Loss: 1.478 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551837).  Saving model ...
Epoch: 43 cost time: 0.79805588722229
Epoch: 43, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.466 Vali Acc: 0.556 Test Loss: 1.466 Test Acc: 0.556
Validation loss decreased (-0.551837 --> -0.555541).  Saving model ...
Epoch: 44 cost time: 0.875185489654541
Epoch: 44, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.455 Vali Acc: 0.570 Test Loss: 1.455 Test Acc: 0.570
Validation loss decreased (-0.555541 --> -0.570356).  Saving model ...
Epoch: 45 cost time: 1.0479116439819336
Epoch: 45, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
Validation loss decreased (-0.570356 --> -0.581467).  Saving model ...
Epoch: 46 cost time: 1.0399999618530273
Epoch: 46, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.432 Vali Acc: 0.589 Test Loss: 1.432 Test Acc: 0.589
Validation loss decreased (-0.581467 --> -0.588875).  Saving model ...
Epoch: 47 cost time: 0.7851085662841797
Epoch: 47, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.421 Vali Acc: 0.593 Test Loss: 1.421 Test Acc: 0.593
Validation loss decreased (-0.588875 --> -0.592578).  Saving model ...
Epoch: 48 cost time: 0.8892829418182373
Epoch: 48, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.410 Vali Acc: 0.596 Test Loss: 1.410 Test Acc: 0.596
Validation loss decreased (-0.592578 --> -0.596282).  Saving model ...
Epoch: 49 cost time: 0.9477570056915283
Epoch: 49, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.399 Vali Acc: 0.596 Test Loss: 1.399 Test Acc: 0.596
Validation loss decreased (-0.596282 --> -0.596282).  Saving model ...
Epoch: 50 cost time: 1.0754508972167969
Epoch: 50, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.388 Vali Acc: 0.604 Test Loss: 1.388 Test Acc: 0.604
Validation loss decreased (-0.596282 --> -0.603690).  Saving model ...
Epoch: 51 cost time: 0.9376540184020996
Epoch: 51, Steps: 2 | Train Loss: 0.794 Vali Loss: 1.377 Vali Acc: 0.600 Test Loss: 1.377 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7776196002960205
Epoch: 52, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.366 Vali Acc: 0.611 Test Loss: 1.366 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611097).  Saving model ...
Epoch: 53 cost time: 0.8880329132080078
Epoch: 53, Steps: 2 | Train Loss: 0.786 Vali Loss: 1.355 Vali Acc: 0.619 Test Loss: 1.355 Test Acc: 0.619
Validation loss decreased (-0.611097 --> -0.618505).  Saving model ...
Epoch: 54 cost time: 0.9825155735015869
Epoch: 54, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.345 Vali Acc: 0.619 Test Loss: 1.345 Test Acc: 0.619
Validation loss decreased (-0.618505 --> -0.618505).  Saving model ...
Epoch: 55 cost time: 0.7842872142791748
Epoch: 55, Steps: 2 | Train Loss: 0.752 Vali Loss: 1.335 Vali Acc: 0.626 Test Loss: 1.335 Test Acc: 0.626
Validation loss decreased (-0.618505 --> -0.625913).  Saving model ...
Epoch: 56 cost time: 0.7836363315582275
Epoch: 56, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.325 Vali Acc: 0.637 Test Loss: 1.325 Test Acc: 0.637
Validation loss decreased (-0.625913 --> -0.637024).  Saving model ...
Epoch: 57 cost time: 0.7640419006347656
Epoch: 57, Steps: 2 | Train Loss: 0.709 Vali Loss: 1.315 Vali Acc: 0.637 Test Loss: 1.315 Test Acc: 0.637
Validation loss decreased (-0.637024 --> -0.637024).  Saving model ...
Epoch: 58 cost time: 0.8709244728088379
Epoch: 58, Steps: 2 | Train Loss: 0.701 Vali Loss: 1.305 Vali Acc: 0.637 Test Loss: 1.305 Test Acc: 0.637
Validation loss decreased (-0.637024 --> -0.637024).  Saving model ...
Epoch: 59 cost time: 0.7062633037567139
Epoch: 59, Steps: 2 | Train Loss: 0.683 Vali Loss: 1.296 Vali Acc: 0.648 Test Loss: 1.296 Test Acc: 0.648
Validation loss decreased (-0.637024 --> -0.648135).  Saving model ...
Epoch: 60 cost time: 0.8862271308898926
Epoch: 60, Steps: 2 | Train Loss: 0.671 Vali Loss: 1.286 Vali Acc: 0.648 Test Loss: 1.286 Test Acc: 0.648
Validation loss decreased (-0.648135 --> -0.648135).  Saving model ...
Epoch: 61 cost time: 1.0702950954437256
Epoch: 61, Steps: 2 | Train Loss: 0.635 Vali Loss: 1.277 Vali Acc: 0.644 Test Loss: 1.277 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8318147659301758
Epoch: 62, Steps: 2 | Train Loss: 0.614 Vali Loss: 1.268 Vali Acc: 0.648 Test Loss: 1.268 Test Acc: 0.648
Validation loss decreased (-0.648135 --> -0.648135).  Saving model ...
Epoch: 63 cost time: 0.6805353164672852
Epoch: 63, Steps: 2 | Train Loss: 0.613 Vali Loss: 1.259 Vali Acc: 0.648 Test Loss: 1.259 Test Acc: 0.648
Validation loss decreased (-0.648135 --> -0.648136).  Saving model ...
Epoch: 64 cost time: 0.6882851123809814
Epoch: 64, Steps: 2 | Train Loss: 0.568 Vali Loss: 1.250 Vali Acc: 0.652 Test Loss: 1.250 Test Acc: 0.652
Validation loss decreased (-0.648136 --> -0.651839).  Saving model ...
Epoch: 65 cost time: 0.8407561779022217
Epoch: 65, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.242 Vali Acc: 0.656 Test Loss: 1.242 Test Acc: 0.656
Validation loss decreased (-0.651839 --> -0.655543).  Saving model ...
Epoch: 66 cost time: 0.7180852890014648
Epoch: 66, Steps: 2 | Train Loss: 0.567 Vali Loss: 1.233 Vali Acc: 0.656 Test Loss: 1.233 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 67 cost time: 0.912653923034668
Epoch: 67, Steps: 2 | Train Loss: 0.546 Vali Loss: 1.224 Vali Acc: 0.656 Test Loss: 1.224 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 68 cost time: 0.7167894840240479
Epoch: 68, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.216 Vali Acc: 0.659 Test Loss: 1.216 Test Acc: 0.659
Validation loss decreased (-0.655543 --> -0.659247).  Saving model ...
Epoch: 69 cost time: 0.8047404289245605
Epoch: 69, Steps: 2 | Train Loss: 0.522 Vali Loss: 1.209 Vali Acc: 0.659 Test Loss: 1.209 Test Acc: 0.659
Validation loss decreased (-0.659247 --> -0.659247).  Saving model ...
Epoch: 70 cost time: 1.2440049648284912
Epoch: 70, Steps: 2 | Train Loss: 0.516 Vali Loss: 1.201 Vali Acc: 0.659 Test Loss: 1.201 Test Acc: 0.659
Validation loss decreased (-0.659247 --> -0.659247).  Saving model ...
Epoch: 71 cost time: 1.051548719406128
Epoch: 71, Steps: 2 | Train Loss: 0.484 Vali Loss: 1.194 Vali Acc: 0.659 Test Loss: 1.194 Test Acc: 0.659
Validation loss decreased (-0.659247 --> -0.659247).  Saving model ...
Epoch: 72 cost time: 0.8174407482147217
Epoch: 72, Steps: 2 | Train Loss: 0.468 Vali Loss: 1.186 Vali Acc: 0.659 Test Loss: 1.186 Test Acc: 0.659
Validation loss decreased (-0.659247 --> -0.659247).  Saving model ...
Epoch: 73 cost time: 0.973167896270752
Epoch: 73, Steps: 2 | Train Loss: 0.461 Vali Loss: 1.179 Vali Acc: 0.656 Test Loss: 1.179 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7900886535644531
Epoch: 74, Steps: 2 | Train Loss: 0.447 Vali Loss: 1.171 Vali Acc: 0.659 Test Loss: 1.171 Test Acc: 0.659
Validation loss decreased (-0.659247 --> -0.659248).  Saving model ...
Epoch: 75 cost time: 0.7584447860717773
Epoch: 75, Steps: 2 | Train Loss: 0.445 Vali Loss: 1.164 Vali Acc: 0.659 Test Loss: 1.164 Test Acc: 0.659
Validation loss decreased (-0.659248 --> -0.659248).  Saving model ...
Epoch: 76 cost time: 0.7128655910491943
Epoch: 76, Steps: 2 | Train Loss: 0.434 Vali Loss: 1.157 Vali Acc: 0.663 Test Loss: 1.157 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662951).  Saving model ...
Epoch: 77 cost time: 0.8365752696990967
Epoch: 77, Steps: 2 | Train Loss: 0.408 Vali Loss: 1.150 Vali Acc: 0.659 Test Loss: 1.150 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8966727256774902
Epoch: 78, Steps: 2 | Train Loss: 0.381 Vali Loss: 1.144 Vali Acc: 0.667 Test Loss: 1.144 Test Acc: 0.667
Validation loss decreased (-0.662951 --> -0.666655).  Saving model ...
Epoch: 79 cost time: 0.9642069339752197
Epoch: 79, Steps: 2 | Train Loss: 0.386 Vali Loss: 1.138 Vali Acc: 0.670 Test Loss: 1.138 Test Acc: 0.670
Validation loss decreased (-0.666655 --> -0.670359).  Saving model ...
Epoch: 80 cost time: 0.7440910339355469
Epoch: 80, Steps: 2 | Train Loss: 0.349 Vali Loss: 1.132 Vali Acc: 0.670 Test Loss: 1.132 Test Acc: 0.670
Validation loss decreased (-0.670359 --> -0.670359).  Saving model ...
Epoch: 81 cost time: 0.8563284873962402
Epoch: 81, Steps: 2 | Train Loss: 0.353 Vali Loss: 1.126 Vali Acc: 0.674 Test Loss: 1.126 Test Acc: 0.674
Validation loss decreased (-0.670359 --> -0.674063).  Saving model ...
Epoch: 82 cost time: 0.946500301361084
Epoch: 82, Steps: 2 | Train Loss: 0.340 Vali Loss: 1.120 Vali Acc: 0.674 Test Loss: 1.120 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 83 cost time: 0.7157435417175293
Epoch: 83, Steps: 2 | Train Loss: 0.337 Vali Loss: 1.114 Vali Acc: 0.674 Test Loss: 1.114 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 84 cost time: 0.7181615829467773
Epoch: 84, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.108 Vali Acc: 0.674 Test Loss: 1.108 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 85 cost time: 0.8991925716400146
Epoch: 85, Steps: 2 | Train Loss: 0.324 Vali Loss: 1.103 Vali Acc: 0.670 Test Loss: 1.103 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.903616189956665
Epoch: 86, Steps: 2 | Train Loss: 0.327 Vali Loss: 1.097 Vali Acc: 0.670 Test Loss: 1.097 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.9535048007965088
Epoch: 87, Steps: 2 | Train Loss: 0.303 Vali Loss: 1.092 Vali Acc: 0.670 Test Loss: 1.092 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.968639612197876
Epoch: 88, Steps: 2 | Train Loss: 0.294 Vali Loss: 1.088 Vali Acc: 0.674 Test Loss: 1.088 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 89 cost time: 1.0389654636383057
Epoch: 89, Steps: 2 | Train Loss: 0.291 Vali Loss: 1.083 Vali Acc: 0.674 Test Loss: 1.083 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 90 cost time: 0.9378015995025635
Epoch: 90, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.079 Vali Acc: 0.670 Test Loss: 1.079 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9436757564544678
Epoch: 91, Steps: 2 | Train Loss: 0.280 Vali Loss: 1.074 Vali Acc: 0.674 Test Loss: 1.074 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 92 cost time: 0.9783196449279785
Epoch: 92, Steps: 2 | Train Loss: 0.266 Vali Loss: 1.071 Vali Acc: 0.674 Test Loss: 1.071 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 93 cost time: 1.0044989585876465
Epoch: 93, Steps: 2 | Train Loss: 0.252 Vali Loss: 1.067 Vali Acc: 0.670 Test Loss: 1.067 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.8828575611114502
Epoch: 94, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.063 Vali Acc: 0.674 Test Loss: 1.063 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 95 cost time: 0.9243752956390381
Epoch: 95, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.059 Vali Acc: 0.670 Test Loss: 1.059 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7085561752319336
Epoch: 96, Steps: 2 | Train Loss: 0.255 Vali Loss: 1.055 Vali Acc: 0.670 Test Loss: 1.055 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.7494142055511475
Epoch: 97, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.052 Vali Acc: 0.670 Test Loss: 1.052 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.9443297386169434
Epoch: 98, Steps: 2 | Train Loss: 0.223 Vali Loss: 1.048 Vali Acc: 0.670 Test Loss: 1.048 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.7723679542541504
Epoch: 99, Steps: 2 | Train Loss: 0.222 Vali Loss: 1.044 Vali Acc: 0.670 Test Loss: 1.044 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.899043083190918
Epoch: 100, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.040 Vali Acc: 0.678 Test Loss: 1.040 Test Acc: 0.678
Validation loss decreased (-0.674063 --> -0.677767).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w9_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6777777777777778
model parameter : 37348
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.75772762298584
Epoch: 1, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.789 Vali Acc: 0.189 Test Loss: 1.789 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.7167978286743164
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.782 Vali Acc: 0.200 Test Loss: 1.782 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.9265615940093994
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.778 Vali Acc: 0.196 Test Loss: 1.778 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7990851402282715
Epoch: 4, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.774 Vali Acc: 0.196 Test Loss: 1.774 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8689224720001221
Epoch: 5, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.769 Vali Acc: 0.200 Test Loss: 1.769 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.6591501235961914
Epoch: 6, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.764 Vali Acc: 0.200 Test Loss: 1.764 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 0.7261009216308594
Epoch: 7, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.757 Vali Acc: 0.200 Test Loss: 1.757 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 8 cost time: 0.7295682430267334
Epoch: 8, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.750 Vali Acc: 0.200 Test Loss: 1.750 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199983).  Saving model ...
Epoch: 9 cost time: 0.9481620788574219
Epoch: 9, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.742 Vali Acc: 0.207 Test Loss: 1.742 Test Acc: 0.207
Validation loss decreased (-0.199983 --> -0.207390).  Saving model ...
Epoch: 10 cost time: 0.9301400184631348
Epoch: 10, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.734 Vali Acc: 0.219 Test Loss: 1.734 Test Acc: 0.219
Validation loss decreased (-0.207390 --> -0.218501).  Saving model ...
Epoch: 11 cost time: 0.8417048454284668
Epoch: 11, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.725 Vali Acc: 0.226 Test Loss: 1.725 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225909).  Saving model ...
Epoch: 12 cost time: 0.6737093925476074
Epoch: 12, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.715 Vali Acc: 0.233 Test Loss: 1.715 Test Acc: 0.233
Validation loss decreased (-0.225909 --> -0.233316).  Saving model ...
Epoch: 13 cost time: 0.8093371391296387
Epoch: 13, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.706 Vali Acc: 0.248 Test Loss: 1.706 Test Acc: 0.248
Validation loss decreased (-0.233316 --> -0.248131).  Saving model ...
Epoch: 14 cost time: 0.7880959510803223
Epoch: 14, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.696 Vali Acc: 0.263 Test Loss: 1.696 Test Acc: 0.263
Validation loss decreased (-0.248131 --> -0.262946).  Saving model ...
Epoch: 15 cost time: 0.7640960216522217
Epoch: 15, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.686 Vali Acc: 0.278 Test Loss: 1.686 Test Acc: 0.278
Validation loss decreased (-0.262946 --> -0.277761).  Saving model ...
Epoch: 16 cost time: 0.9057028293609619
Epoch: 16, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.675 Vali Acc: 0.296 Test Loss: 1.675 Test Acc: 0.296
Validation loss decreased (-0.277761 --> -0.296280).  Saving model ...
Epoch: 17 cost time: 0.7382018566131592
Epoch: 17, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.665 Vali Acc: 0.304 Test Loss: 1.665 Test Acc: 0.304
Validation loss decreased (-0.296280 --> -0.303687).  Saving model ...
Epoch: 18 cost time: 0.7082622051239014
Epoch: 18, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.655 Vali Acc: 0.319 Test Loss: 1.655 Test Acc: 0.319
Validation loss decreased (-0.303687 --> -0.318502).  Saving model ...
Epoch: 19 cost time: 0.8251142501831055
Epoch: 19, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.644 Vali Acc: 0.326 Test Loss: 1.644 Test Acc: 0.326
Validation loss decreased (-0.318502 --> -0.325909).  Saving model ...
Epoch: 20 cost time: 0.7201511859893799
Epoch: 20, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.633 Vali Acc: 0.341 Test Loss: 1.633 Test Acc: 0.341
Validation loss decreased (-0.325909 --> -0.340724).  Saving model ...
Epoch: 21 cost time: 0.6368861198425293
Epoch: 21, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.622 Vali Acc: 0.363 Test Loss: 1.622 Test Acc: 0.363
Validation loss decreased (-0.340724 --> -0.362947).  Saving model ...
Epoch: 22 cost time: 0.810591459274292
Epoch: 22, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.611 Vali Acc: 0.374 Test Loss: 1.611 Test Acc: 0.374
Validation loss decreased (-0.362947 --> -0.374058).  Saving model ...
Epoch: 23 cost time: 0.7335705757141113
Epoch: 23, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.600 Vali Acc: 0.381 Test Loss: 1.600 Test Acc: 0.381
Validation loss decreased (-0.374058 --> -0.381465).  Saving model ...
Epoch: 24 cost time: 0.667820930480957
Epoch: 24, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.588 Vali Acc: 0.393 Test Loss: 1.588 Test Acc: 0.393
Validation loss decreased (-0.381465 --> -0.392577).  Saving model ...
Epoch: 25 cost time: 0.6874375343322754
Epoch: 25, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.576 Vali Acc: 0.419 Test Loss: 1.576 Test Acc: 0.419
Validation loss decreased (-0.392577 --> -0.418503).  Saving model ...
Epoch: 26 cost time: 0.6712243556976318
Epoch: 26, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.565 Vali Acc: 0.426 Test Loss: 1.565 Test Acc: 0.426
Validation loss decreased (-0.418503 --> -0.425910).  Saving model ...
Epoch: 27 cost time: 0.8158583641052246
Epoch: 27, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.553 Vali Acc: 0.437 Test Loss: 1.553 Test Acc: 0.437
Validation loss decreased (-0.425910 --> -0.437022).  Saving model ...
Epoch: 28 cost time: 0.6947968006134033
Epoch: 28, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.541 Vali Acc: 0.448 Test Loss: 1.541 Test Acc: 0.448
Validation loss decreased (-0.437022 --> -0.448133).  Saving model ...
Epoch: 29 cost time: 0.7368016242980957
Epoch: 29, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.529 Vali Acc: 0.459 Test Loss: 1.529 Test Acc: 0.459
Validation loss decreased (-0.448133 --> -0.459244).  Saving model ...
Epoch: 30 cost time: 0.7462570667266846
Epoch: 30, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.517 Vali Acc: 0.478 Test Loss: 1.517 Test Acc: 0.478
Validation loss decreased (-0.459244 --> -0.477763).  Saving model ...
Epoch: 31 cost time: 0.7850086688995361
Epoch: 31, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.505 Vali Acc: 0.481 Test Loss: 1.505 Test Acc: 0.481
Validation loss decreased (-0.477763 --> -0.481466).  Saving model ...
Epoch: 32 cost time: 0.765362024307251
Epoch: 32, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.494 Vali Acc: 0.489 Test Loss: 1.494 Test Acc: 0.489
Validation loss decreased (-0.481466 --> -0.488874).  Saving model ...
Epoch: 33 cost time: 0.8025093078613281
Epoch: 33, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.482 Vali Acc: 0.500 Test Loss: 1.482 Test Acc: 0.500
Validation loss decreased (-0.488874 --> -0.499985).  Saving model ...
Epoch: 34 cost time: 0.8226327896118164
Epoch: 34, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.470 Vali Acc: 0.504 Test Loss: 1.470 Test Acc: 0.504
Validation loss decreased (-0.499985 --> -0.503689).  Saving model ...
Epoch: 35 cost time: 0.6513493061065674
Epoch: 35, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.458 Vali Acc: 0.507 Test Loss: 1.458 Test Acc: 0.507
Validation loss decreased (-0.503689 --> -0.507393).  Saving model ...
Epoch: 36 cost time: 0.7734963893890381
Epoch: 36, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.447 Vali Acc: 0.511 Test Loss: 1.447 Test Acc: 0.511
Validation loss decreased (-0.507393 --> -0.511097).  Saving model ...
Epoch: 37 cost time: 0.6861395835876465
Epoch: 37, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.435 Vali Acc: 0.511 Test Loss: 1.435 Test Acc: 0.511
Validation loss decreased (-0.511097 --> -0.511097).  Saving model ...
Epoch: 38 cost time: 0.7960867881774902
Epoch: 38, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.423 Vali Acc: 0.515 Test Loss: 1.423 Test Acc: 0.515
Validation loss decreased (-0.511097 --> -0.514801).  Saving model ...
Epoch: 39 cost time: 0.7317156791687012
Epoch: 39, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.411 Vali Acc: 0.522 Test Loss: 1.411 Test Acc: 0.522
Validation loss decreased (-0.514801 --> -0.522208).  Saving model ...
Epoch: 40 cost time: 0.7621262073516846
Epoch: 40, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.399 Vali Acc: 0.533 Test Loss: 1.399 Test Acc: 0.533
Validation loss decreased (-0.522208 --> -0.533319).  Saving model ...
Epoch: 41 cost time: 0.759652853012085
Epoch: 41, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.388 Vali Acc: 0.541 Test Loss: 1.388 Test Acc: 0.541
Validation loss decreased (-0.533319 --> -0.540727).  Saving model ...
Epoch: 42 cost time: 0.8103060722351074
Epoch: 42, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.376 Vali Acc: 0.544 Test Loss: 1.376 Test Acc: 0.544
Validation loss decreased (-0.540727 --> -0.544431).  Saving model ...
Epoch: 43 cost time: 1.0255076885223389
Epoch: 43, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.365 Vali Acc: 0.556 Test Loss: 1.365 Test Acc: 0.556
Validation loss decreased (-0.544431 --> -0.555542).  Saving model ...
Epoch: 44 cost time: 0.8600316047668457
Epoch: 44, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.353 Vali Acc: 0.567 Test Loss: 1.353 Test Acc: 0.567
Validation loss decreased (-0.555542 --> -0.566653).  Saving model ...
Epoch: 45 cost time: 0.612342119216919
Epoch: 45, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.342 Vali Acc: 0.585 Test Loss: 1.342 Test Acc: 0.585
Validation loss decreased (-0.566653 --> -0.585172).  Saving model ...
Epoch: 46 cost time: 0.7594335079193115
Epoch: 46, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.331 Vali Acc: 0.589 Test Loss: 1.331 Test Acc: 0.589
Validation loss decreased (-0.585172 --> -0.588876).  Saving model ...
Epoch: 47 cost time: 0.808990478515625
Epoch: 47, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.321 Vali Acc: 0.600 Test Loss: 1.321 Test Acc: 0.600
Validation loss decreased (-0.588876 --> -0.599987).  Saving model ...
Epoch: 48 cost time: 0.6411702632904053
Epoch: 48, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.310 Vali Acc: 0.607 Test Loss: 1.310 Test Acc: 0.607
Validation loss decreased (-0.599987 --> -0.607394).  Saving model ...
Epoch: 49 cost time: 0.7462284564971924
Epoch: 49, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.299 Vali Acc: 0.611 Test Loss: 1.299 Test Acc: 0.611
Validation loss decreased (-0.607394 --> -0.611098).  Saving model ...
Epoch: 50 cost time: 0.7736899852752686
Epoch: 50, Steps: 2 | Train Loss: 0.837 Vali Loss: 1.289 Vali Acc: 0.607 Test Loss: 1.289 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9113664627075195
Epoch: 51, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.278 Vali Acc: 0.611 Test Loss: 1.278 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 52 cost time: 0.7946598529815674
Epoch: 52, Steps: 2 | Train Loss: 0.798 Vali Loss: 1.268 Vali Acc: 0.619 Test Loss: 1.268 Test Acc: 0.619
Validation loss decreased (-0.611098 --> -0.618506).  Saving model ...
Epoch: 53 cost time: 0.6592442989349365
Epoch: 53, Steps: 2 | Train Loss: 0.767 Vali Loss: 1.259 Vali Acc: 0.626 Test Loss: 1.259 Test Acc: 0.626
Validation loss decreased (-0.618506 --> -0.625913).  Saving model ...
Epoch: 54 cost time: 0.7839903831481934
Epoch: 54, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.249 Vali Acc: 0.630 Test Loss: 1.249 Test Acc: 0.630
Validation loss decreased (-0.625913 --> -0.629617).  Saving model ...
Epoch: 55 cost time: 0.7271804809570312
Epoch: 55, Steps: 2 | Train Loss: 0.747 Vali Loss: 1.239 Vali Acc: 0.626 Test Loss: 1.239 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9700636863708496
Epoch: 56, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.230 Vali Acc: 0.633 Test Loss: 1.230 Test Acc: 0.633
Validation loss decreased (-0.629617 --> -0.633321).  Saving model ...
Epoch: 57 cost time: 0.8040189743041992
Epoch: 57, Steps: 2 | Train Loss: 0.698 Vali Loss: 1.220 Vali Acc: 0.637 Test Loss: 1.220 Test Acc: 0.637
Validation loss decreased (-0.633321 --> -0.637025).  Saving model ...
Epoch: 58 cost time: 0.6210029125213623
Epoch: 58, Steps: 2 | Train Loss: 0.681 Vali Loss: 1.211 Vali Acc: 0.648 Test Loss: 1.211 Test Acc: 0.648
Validation loss decreased (-0.637025 --> -0.648136).  Saving model ...
Epoch: 59 cost time: 0.7908947467803955
Epoch: 59, Steps: 2 | Train Loss: 0.670 Vali Loss: 1.202 Vali Acc: 0.659 Test Loss: 1.202 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659247).  Saving model ...
Epoch: 60 cost time: 0.7224276065826416
Epoch: 60, Steps: 2 | Train Loss: 0.644 Vali Loss: 1.193 Vali Acc: 0.659 Test Loss: 1.193 Test Acc: 0.659
Validation loss decreased (-0.659247 --> -0.659247).  Saving model ...
Epoch: 61 cost time: 0.8975300788879395
Epoch: 61, Steps: 2 | Train Loss: 0.654 Vali Loss: 1.184 Vali Acc: 0.667 Test Loss: 1.184 Test Acc: 0.667
Validation loss decreased (-0.659247 --> -0.666655).  Saving model ...
Epoch: 62 cost time: 0.7814421653747559
Epoch: 62, Steps: 2 | Train Loss: 0.617 Vali Loss: 1.175 Vali Acc: 0.667 Test Loss: 1.175 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 63 cost time: 1.0833005905151367
Epoch: 63, Steps: 2 | Train Loss: 0.618 Vali Loss: 1.167 Vali Acc: 0.663 Test Loss: 1.167 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9480020999908447
Epoch: 64, Steps: 2 | Train Loss: 0.561 Vali Loss: 1.158 Vali Acc: 0.667 Test Loss: 1.158 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 65 cost time: 0.7809221744537354
Epoch: 65, Steps: 2 | Train Loss: 0.577 Vali Loss: 1.150 Vali Acc: 0.674 Test Loss: 1.150 Test Acc: 0.674
Validation loss decreased (-0.666655 --> -0.674063).  Saving model ...
Epoch: 66 cost time: 0.7899069786071777
Epoch: 66, Steps: 2 | Train Loss: 0.559 Vali Loss: 1.142 Vali Acc: 0.670 Test Loss: 1.142 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7458450794219971
Epoch: 67, Steps: 2 | Train Loss: 0.543 Vali Loss: 1.134 Vali Acc: 0.670 Test Loss: 1.134 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7223353385925293
Epoch: 68, Steps: 2 | Train Loss: 0.532 Vali Loss: 1.126 Vali Acc: 0.674 Test Loss: 1.126 Test Acc: 0.674
Validation loss decreased (-0.674063 --> -0.674063).  Saving model ...
Epoch: 69 cost time: 0.8236737251281738
Epoch: 69, Steps: 2 | Train Loss: 0.530 Vali Loss: 1.118 Vali Acc: 0.678 Test Loss: 1.118 Test Acc: 0.678
Validation loss decreased (-0.674063 --> -0.677767).  Saving model ...
Epoch: 70 cost time: 0.7785391807556152
Epoch: 70, Steps: 2 | Train Loss: 0.485 Vali Loss: 1.110 Vali Acc: 0.685 Test Loss: 1.110 Test Acc: 0.685
Validation loss decreased (-0.677767 --> -0.685174).  Saving model ...
Epoch: 71 cost time: 0.7000720500946045
Epoch: 71, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.102 Vali Acc: 0.681 Test Loss: 1.102 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.6439704895019531
Epoch: 72, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.095 Vali Acc: 0.685 Test Loss: 1.095 Test Acc: 0.685
Validation loss decreased (-0.685174 --> -0.685174).  Saving model ...
Epoch: 73 cost time: 0.7070221900939941
Epoch: 73, Steps: 2 | Train Loss: 0.451 Vali Loss: 1.087 Vali Acc: 0.685 Test Loss: 1.087 Test Acc: 0.685
Validation loss decreased (-0.685174 --> -0.685174).  Saving model ...
Epoch: 74 cost time: 0.9365100860595703
Epoch: 74, Steps: 2 | Train Loss: 0.441 Vali Loss: 1.080 Vali Acc: 0.685 Test Loss: 1.080 Test Acc: 0.685
Validation loss decreased (-0.685174 --> -0.685174).  Saving model ...
Epoch: 75 cost time: 0.6707596778869629
Epoch: 75, Steps: 2 | Train Loss: 0.419 Vali Loss: 1.073 Vali Acc: 0.696 Test Loss: 1.073 Test Acc: 0.696
Validation loss decreased (-0.685174 --> -0.696286).  Saving model ...
Epoch: 76 cost time: 0.6676826477050781
Epoch: 76, Steps: 2 | Train Loss: 0.411 Vali Loss: 1.066 Vali Acc: 0.696 Test Loss: 1.066 Test Acc: 0.696
Validation loss decreased (-0.696286 --> -0.696286).  Saving model ...
Epoch: 77 cost time: 0.790581464767456
Epoch: 77, Steps: 2 | Train Loss: 0.410 Vali Loss: 1.059 Vali Acc: 0.693 Test Loss: 1.059 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8511393070220947
Epoch: 78, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.052 Vali Acc: 0.693 Test Loss: 1.052 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.7217366695404053
Epoch: 79, Steps: 2 | Train Loss: 0.391 Vali Loss: 1.046 Vali Acc: 0.693 Test Loss: 1.046 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.7060563564300537
Epoch: 80, Steps: 2 | Train Loss: 0.369 Vali Loss: 1.040 Vali Acc: 0.700 Test Loss: 1.040 Test Acc: 0.700
Validation loss decreased (-0.696286 --> -0.699990).  Saving model ...
Epoch: 81 cost time: 0.7755401134490967
Epoch: 81, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.034 Vali Acc: 0.696 Test Loss: 1.034 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8966069221496582
Epoch: 82, Steps: 2 | Train Loss: 0.356 Vali Loss: 1.027 Vali Acc: 0.696 Test Loss: 1.027 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.918856143951416
Epoch: 83, Steps: 2 | Train Loss: 0.339 Vali Loss: 1.021 Vali Acc: 0.696 Test Loss: 1.021 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.7625534534454346
Epoch: 84, Steps: 2 | Train Loss: 0.342 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 85 cost time: 0.7249400615692139
Epoch: 85, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 86 cost time: 0.7693197727203369
Epoch: 86, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.004 Vali Acc: 0.696 Test Loss: 1.004 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7926657199859619
Epoch: 87, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.999 Vali Acc: 0.696 Test Loss: 0.999 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.9794418811798096
Epoch: 88, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.994 Vali Acc: 0.696 Test Loss: 0.994 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.8024611473083496
Epoch: 89, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.989 Vali Acc: 0.693 Test Loss: 0.989 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.8297576904296875
Epoch: 90, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.984 Vali Acc: 0.693 Test Loss: 0.984 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.8973870277404785
Epoch: 91, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.979 Vali Acc: 0.693 Test Loss: 0.979 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.0141170024871826
Epoch: 92, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.975 Vali Acc: 0.693 Test Loss: 0.975 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 1.0016160011291504
Epoch: 93, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.970 Vali Acc: 0.693 Test Loss: 0.970 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.7407445907592773
Epoch: 94, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.966 Vali Acc: 0.693 Test Loss: 0.966 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.9240970611572266
Epoch: 95, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.962 Vali Acc: 0.693 Test Loss: 0.962 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7
model parameter : 36836
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.508031129837036
Epoch: 1, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.851 Vali Acc: 0.159 Test Loss: 1.851 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.7214229106903076
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.847 Vali Acc: 0.167 Test Loss: 1.847 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 1.0138115882873535
Epoch: 3, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.844 Vali Acc: 0.170 Test Loss: 1.844 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 0.6876199245452881
Epoch: 4, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.841 Vali Acc: 0.170 Test Loss: 1.841 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 5 cost time: 0.7140810489654541
Epoch: 5, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.837 Vali Acc: 0.178 Test Loss: 1.837 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177759).  Saving model ...
Epoch: 6 cost time: 0.6005151271820068
Epoch: 6, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.833 Vali Acc: 0.178 Test Loss: 1.833 Test Acc: 0.178
Validation loss decreased (-0.177759 --> -0.177759).  Saving model ...
Epoch: 7 cost time: 0.5682373046875
Epoch: 7, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.828 Vali Acc: 0.178 Test Loss: 1.828 Test Acc: 0.178
Validation loss decreased (-0.177759 --> -0.177759).  Saving model ...
Epoch: 8 cost time: 0.5996038913726807
Epoch: 8, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.822 Vali Acc: 0.178 Test Loss: 1.822 Test Acc: 0.178
Validation loss decreased (-0.177759 --> -0.177760).  Saving model ...
Epoch: 9 cost time: 0.5275132656097412
Epoch: 9, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.816 Vali Acc: 0.178 Test Loss: 1.816 Test Acc: 0.178
Validation loss decreased (-0.177760 --> -0.177760).  Saving model ...
Epoch: 10 cost time: 0.5772099494934082
Epoch: 10, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.810 Vali Acc: 0.185 Test Loss: 1.810 Test Acc: 0.185
Validation loss decreased (-0.177760 --> -0.185167).  Saving model ...
Epoch: 11 cost time: 0.8022654056549072
Epoch: 11, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.803 Vali Acc: 0.189 Test Loss: 1.803 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 12 cost time: 0.6720280647277832
Epoch: 12, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.796 Vali Acc: 0.200 Test Loss: 1.796 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 13 cost time: 0.6064057350158691
Epoch: 13, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.788 Vali Acc: 0.204 Test Loss: 1.788 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 14 cost time: 0.8137052059173584
Epoch: 14, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.780 Vali Acc: 0.222 Test Loss: 1.780 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222204).  Saving model ...
Epoch: 15 cost time: 0.5859060287475586
Epoch: 15, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.772 Vali Acc: 0.230 Test Loss: 1.772 Test Acc: 0.230
Validation loss decreased (-0.222204 --> -0.229612).  Saving model ...
Epoch: 16 cost time: 0.7257919311523438
Epoch: 16, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.763 Vali Acc: 0.244 Test Loss: 1.763 Test Acc: 0.244
Validation loss decreased (-0.229612 --> -0.244427).  Saving model ...
Epoch: 17 cost time: 0.6380128860473633
Epoch: 17, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.755 Vali Acc: 0.248 Test Loss: 1.755 Test Acc: 0.248
Validation loss decreased (-0.244427 --> -0.248131).  Saving model ...
Epoch: 18 cost time: 0.6847827434539795
Epoch: 18, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.746 Vali Acc: 0.259 Test Loss: 1.746 Test Acc: 0.259
Validation loss decreased (-0.248131 --> -0.259242).  Saving model ...
Epoch: 19 cost time: 0.6855065822601318
Epoch: 19, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.736 Vali Acc: 0.278 Test Loss: 1.736 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277760).  Saving model ...
Epoch: 20 cost time: 0.6386511325836182
Epoch: 20, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.727 Vali Acc: 0.285 Test Loss: 1.727 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285168).  Saving model ...
Epoch: 21 cost time: 0.6115109920501709
Epoch: 21, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.717 Vali Acc: 0.304 Test Loss: 1.717 Test Acc: 0.304
Validation loss decreased (-0.285168 --> -0.303687).  Saving model ...
Epoch: 22 cost time: 0.5719950199127197
Epoch: 22, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.708 Vali Acc: 0.311 Test Loss: 1.708 Test Acc: 0.311
Validation loss decreased (-0.303687 --> -0.311094).  Saving model ...
Epoch: 23 cost time: 0.5707297325134277
Epoch: 23, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.698 Vali Acc: 0.326 Test Loss: 1.698 Test Acc: 0.326
Validation loss decreased (-0.311094 --> -0.325909).  Saving model ...
Epoch: 24 cost time: 0.5503706932067871
Epoch: 24, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.688 Vali Acc: 0.330 Test Loss: 1.688 Test Acc: 0.330
Validation loss decreased (-0.325909 --> -0.329613).  Saving model ...
Epoch: 25 cost time: 0.7197511196136475
Epoch: 25, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.677 Vali Acc: 0.348 Test Loss: 1.677 Test Acc: 0.348
Validation loss decreased (-0.329613 --> -0.348131).  Saving model ...
Epoch: 26 cost time: 0.7488067150115967
Epoch: 26, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.667 Vali Acc: 0.363 Test Loss: 1.667 Test Acc: 0.363
Validation loss decreased (-0.348131 --> -0.362946).  Saving model ...
Epoch: 27 cost time: 0.6964223384857178
Epoch: 27, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.656 Vali Acc: 0.370 Test Loss: 1.656 Test Acc: 0.370
Validation loss decreased (-0.362946 --> -0.370354).  Saving model ...
Epoch: 28 cost time: 0.6958482265472412
Epoch: 28, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.645 Vali Acc: 0.393 Test Loss: 1.645 Test Acc: 0.393
Validation loss decreased (-0.370354 --> -0.392576).  Saving model ...
Epoch: 29 cost time: 0.6720097064971924
Epoch: 29, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.634 Vali Acc: 0.400 Test Loss: 1.634 Test Acc: 0.400
Validation loss decreased (-0.392576 --> -0.399984).  Saving model ...
Epoch: 30 cost time: 0.5434207916259766
Epoch: 30, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.623 Vali Acc: 0.437 Test Loss: 1.623 Test Acc: 0.437
Validation loss decreased (-0.399984 --> -0.437021).  Saving model ...
Epoch: 31 cost time: 0.5393521785736084
Epoch: 31, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.611 Vali Acc: 0.463 Test Loss: 1.611 Test Acc: 0.463
Validation loss decreased (-0.437021 --> -0.462947).  Saving model ...
Epoch: 32 cost time: 0.6564178466796875
Epoch: 32, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.600 Vali Acc: 0.467 Test Loss: 1.600 Test Acc: 0.467
Validation loss decreased (-0.462947 --> -0.466651).  Saving model ...
Epoch: 33 cost time: 0.7264268398284912
Epoch: 33, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.588 Vali Acc: 0.478 Test Loss: 1.588 Test Acc: 0.478
Validation loss decreased (-0.466651 --> -0.477762).  Saving model ...
Epoch: 34 cost time: 0.799630880355835
Epoch: 34, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.577 Vali Acc: 0.493 Test Loss: 1.577 Test Acc: 0.493
Validation loss decreased (-0.477762 --> -0.492577).  Saving model ...
Epoch: 35 cost time: 0.6897428035736084
Epoch: 35, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
Validation loss decreased (-0.492577 --> -0.499984).  Saving model ...
Epoch: 36 cost time: 0.6557161808013916
Epoch: 36, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.553 Vali Acc: 0.496 Test Loss: 1.553 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6269948482513428
Epoch: 37, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.540 Vali Acc: 0.515 Test Loss: 1.540 Test Acc: 0.515
Validation loss decreased (-0.499984 --> -0.514799).  Saving model ...
Epoch: 38 cost time: 0.614901065826416
Epoch: 38, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.528 Vali Acc: 0.526 Test Loss: 1.528 Test Acc: 0.526
Validation loss decreased (-0.514799 --> -0.525911).  Saving model ...
Epoch: 39 cost time: 0.6170380115509033
Epoch: 39, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.516 Vali Acc: 0.537 Test Loss: 1.516 Test Acc: 0.537
Validation loss decreased (-0.525911 --> -0.537022).  Saving model ...
Epoch: 40 cost time: 0.6505725383758545
Epoch: 40, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.503 Vali Acc: 0.548 Test Loss: 1.503 Test Acc: 0.548
Validation loss decreased (-0.537022 --> -0.548133).  Saving model ...
Epoch: 41 cost time: 0.5526604652404785
Epoch: 41, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.490 Vali Acc: 0.563 Test Loss: 1.490 Test Acc: 0.563
Validation loss decreased (-0.548133 --> -0.562948).  Saving model ...
Epoch: 42 cost time: 0.6089744567871094
Epoch: 42, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.477 Vali Acc: 0.581 Test Loss: 1.477 Test Acc: 0.581
Validation loss decreased (-0.562948 --> -0.581467).  Saving model ...
Epoch: 43 cost time: 0.6410782337188721
Epoch: 43, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.464 Vali Acc: 0.604 Test Loss: 1.464 Test Acc: 0.604
Validation loss decreased (-0.581467 --> -0.603689).  Saving model ...
Epoch: 44 cost time: 0.5801045894622803
Epoch: 44, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.450 Vali Acc: 0.604 Test Loss: 1.450 Test Acc: 0.604
Validation loss decreased (-0.603689 --> -0.603689).  Saving model ...
Epoch: 45 cost time: 0.6848568916320801
Epoch: 45, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.436 Vali Acc: 0.619 Test Loss: 1.436 Test Acc: 0.619
Validation loss decreased (-0.603689 --> -0.618504).  Saving model ...
Epoch: 46 cost time: 0.526498556137085
Epoch: 46, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.423 Vali Acc: 0.630 Test Loss: 1.423 Test Acc: 0.630
Validation loss decreased (-0.618504 --> -0.629615).  Saving model ...
Epoch: 47 cost time: 0.683513879776001
Epoch: 47, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.409 Vali Acc: 0.641 Test Loss: 1.409 Test Acc: 0.641
Validation loss decreased (-0.629615 --> -0.640727).  Saving model ...
Epoch: 48 cost time: 0.9200913906097412
Epoch: 48, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.395 Vali Acc: 0.648 Test Loss: 1.395 Test Acc: 0.648
Validation loss decreased (-0.640727 --> -0.648134).  Saving model ...
Epoch: 49 cost time: 0.6525905132293701
Epoch: 49, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.380 Vali Acc: 0.652 Test Loss: 1.380 Test Acc: 0.652
Validation loss decreased (-0.648134 --> -0.651838).  Saving model ...
Epoch: 50 cost time: 0.592705249786377
Epoch: 50, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.367 Vali Acc: 0.656 Test Loss: 1.367 Test Acc: 0.656
Validation loss decreased (-0.651838 --> -0.655542).  Saving model ...
Epoch: 51 cost time: 0.8320214748382568
Epoch: 51, Steps: 2 | Train Loss: 0.945 Vali Loss: 1.353 Vali Acc: 0.659 Test Loss: 1.353 Test Acc: 0.659
Validation loss decreased (-0.655542 --> -0.659246).  Saving model ...
Epoch: 52 cost time: 0.6820881366729736
Epoch: 52, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.339 Vali Acc: 0.667 Test Loss: 1.339 Test Acc: 0.667
Validation loss decreased (-0.659246 --> -0.666653).  Saving model ...
Epoch: 53 cost time: 0.6645002365112305
Epoch: 53, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.326 Vali Acc: 0.670 Test Loss: 1.326 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.670357).  Saving model ...
Epoch: 54 cost time: 0.6621084213256836
Epoch: 54, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.313 Vali Acc: 0.670 Test Loss: 1.313 Test Acc: 0.670
Validation loss decreased (-0.670357 --> -0.670357).  Saving model ...
Epoch: 55 cost time: 0.6559593677520752
Epoch: 55, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.299 Vali Acc: 0.674 Test Loss: 1.299 Test Acc: 0.674
Validation loss decreased (-0.670357 --> -0.674061).  Saving model ...
Epoch: 56 cost time: 0.6418166160583496
Epoch: 56, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.286 Vali Acc: 0.678 Test Loss: 1.286 Test Acc: 0.678
Validation loss decreased (-0.674061 --> -0.677765).  Saving model ...
Epoch: 57 cost time: 0.6446573734283447
Epoch: 57, Steps: 2 | Train Loss: 0.784 Vali Loss: 1.272 Vali Acc: 0.685 Test Loss: 1.272 Test Acc: 0.685
Validation loss decreased (-0.677765 --> -0.685172).  Saving model ...
Epoch: 58 cost time: 0.7532451152801514
Epoch: 58, Steps: 2 | Train Loss: 0.773 Vali Loss: 1.259 Vali Acc: 0.693 Test Loss: 1.259 Test Acc: 0.693
Validation loss decreased (-0.685172 --> -0.692580).  Saving model ...
Epoch: 59 cost time: 0.6357631683349609
Epoch: 59, Steps: 2 | Train Loss: 0.735 Vali Loss: 1.245 Vali Acc: 0.696 Test Loss: 1.245 Test Acc: 0.696
Validation loss decreased (-0.692580 --> -0.696284).  Saving model ...
Epoch: 60 cost time: 0.6291227340698242
Epoch: 60, Steps: 2 | Train Loss: 0.718 Vali Loss: 1.233 Vali Acc: 0.707 Test Loss: 1.233 Test Acc: 0.707
Validation loss decreased (-0.696284 --> -0.707395).  Saving model ...
Epoch: 61 cost time: 0.6531627178192139
Epoch: 61, Steps: 2 | Train Loss: 0.694 Vali Loss: 1.220 Vali Acc: 0.707 Test Loss: 1.220 Test Acc: 0.707
Validation loss decreased (-0.707395 --> -0.707395).  Saving model ...
Epoch: 62 cost time: 0.600090503692627
Epoch: 62, Steps: 2 | Train Loss: 0.646 Vali Loss: 1.209 Vali Acc: 0.711 Test Loss: 1.209 Test Acc: 0.711
Validation loss decreased (-0.707395 --> -0.711099).  Saving model ...
Epoch: 63 cost time: 0.7166731357574463
Epoch: 63, Steps: 2 | Train Loss: 0.647 Vali Loss: 1.197 Vali Acc: 0.715 Test Loss: 1.197 Test Acc: 0.715
Validation loss decreased (-0.711099 --> -0.714803).  Saving model ...
Epoch: 64 cost time: 0.7013692855834961
Epoch: 64, Steps: 2 | Train Loss: 0.645 Vali Loss: 1.186 Vali Acc: 0.715 Test Loss: 1.186 Test Acc: 0.715
Validation loss decreased (-0.714803 --> -0.714803).  Saving model ...
Epoch: 65 cost time: 0.717430830001831
Epoch: 65, Steps: 2 | Train Loss: 0.600 Vali Loss: 1.175 Vali Acc: 0.711 Test Loss: 1.175 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6781802177429199
Epoch: 66, Steps: 2 | Train Loss: 0.604 Vali Loss: 1.164 Vali Acc: 0.711 Test Loss: 1.164 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5814740657806396
Epoch: 67, Steps: 2 | Train Loss: 0.558 Vali Loss: 1.154 Vali Acc: 0.711 Test Loss: 1.154 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.5942347049713135
Epoch: 68, Steps: 2 | Train Loss: 0.550 Vali Loss: 1.144 Vali Acc: 0.719 Test Loss: 1.144 Test Acc: 0.719
Validation loss decreased (-0.714803 --> -0.718507).  Saving model ...
Epoch: 69 cost time: 0.6126084327697754
Epoch: 69, Steps: 2 | Train Loss: 0.512 Vali Loss: 1.133 Vali Acc: 0.722 Test Loss: 1.133 Test Acc: 0.722
Validation loss decreased (-0.718507 --> -0.722211).  Saving model ...
Epoch: 70 cost time: 0.6893377304077148
Epoch: 70, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.123 Vali Acc: 0.737 Test Loss: 1.123 Test Acc: 0.737
Validation loss decreased (-0.722211 --> -0.737026).  Saving model ...
Epoch: 71 cost time: 0.7867507934570312
Epoch: 71, Steps: 2 | Train Loss: 0.474 Vali Loss: 1.114 Vali Acc: 0.737 Test Loss: 1.114 Test Acc: 0.737
Validation loss decreased (-0.737026 --> -0.737026).  Saving model ...
Epoch: 72 cost time: 0.6539299488067627
Epoch: 72, Steps: 2 | Train Loss: 0.462 Vali Loss: 1.104 Vali Acc: 0.730 Test Loss: 1.104 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6760437488555908
Epoch: 73, Steps: 2 | Train Loss: 0.468 Vali Loss: 1.095 Vali Acc: 0.733 Test Loss: 1.095 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6701862812042236
Epoch: 74, Steps: 2 | Train Loss: 0.424 Vali Loss: 1.086 Vali Acc: 0.741 Test Loss: 1.086 Test Acc: 0.741
Validation loss decreased (-0.737026 --> -0.740730).  Saving model ...
Epoch: 75 cost time: 0.60701584815979
Epoch: 75, Steps: 2 | Train Loss: 0.443 Vali Loss: 1.077 Vali Acc: 0.744 Test Loss: 1.077 Test Acc: 0.744
Validation loss decreased (-0.740730 --> -0.744434).  Saving model ...
Epoch: 76 cost time: 0.7319810390472412
Epoch: 76, Steps: 2 | Train Loss: 0.405 Vali Loss: 1.069 Vali Acc: 0.744 Test Loss: 1.069 Test Acc: 0.744
Validation loss decreased (-0.744434 --> -0.744434).  Saving model ...
Epoch: 77 cost time: 0.653010368347168
Epoch: 77, Steps: 2 | Train Loss: 0.379 Vali Loss: 1.060 Vali Acc: 0.748 Test Loss: 1.060 Test Acc: 0.748
Validation loss decreased (-0.744434 --> -0.748138).  Saving model ...
Epoch: 78 cost time: 0.578350305557251
Epoch: 78, Steps: 2 | Train Loss: 0.373 Vali Loss: 1.052 Vali Acc: 0.748 Test Loss: 1.052 Test Acc: 0.748
Validation loss decreased (-0.748138 --> -0.748138).  Saving model ...
Epoch: 79 cost time: 0.7012648582458496
Epoch: 79, Steps: 2 | Train Loss: 0.350 Vali Loss: 1.045 Vali Acc: 0.748 Test Loss: 1.045 Test Acc: 0.748
Validation loss decreased (-0.748138 --> -0.748138).  Saving model ...
Epoch: 80 cost time: 0.6302683353424072
Epoch: 80, Steps: 2 | Train Loss: 0.337 Vali Loss: 1.038 Vali Acc: 0.737 Test Loss: 1.038 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8233652114868164
Epoch: 81, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.031 Vali Acc: 0.737 Test Loss: 1.031 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.6000607013702393
Epoch: 82, Steps: 2 | Train Loss: 0.324 Vali Loss: 1.025 Vali Acc: 0.737 Test Loss: 1.025 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.7478935718536377
Epoch: 83, Steps: 2 | Train Loss: 0.296 Vali Loss: 1.019 Vali Acc: 0.737 Test Loss: 1.019 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.8194179534912109
Epoch: 84, Steps: 2 | Train Loss: 0.280 Vali Loss: 1.012 Vali Acc: 0.741 Test Loss: 1.012 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.7594771385192871
Epoch: 85, Steps: 2 | Train Loss: 0.275 Vali Loss: 1.007 Vali Acc: 0.733 Test Loss: 1.007 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.8280668258666992
Epoch: 86, Steps: 2 | Train Loss: 0.284 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.6702957153320312
Epoch: 87, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.995 Vali Acc: 0.733 Test Loss: 0.995 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.776451587677002
Epoch: 88, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.990 Vali Acc: 0.733 Test Loss: 0.990 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.7703936100006104
Epoch: 89, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.985 Vali Acc: 0.733 Test Loss: 0.985 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7481481481481481
model parameter : 36324
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5279698371887207
Epoch: 1, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.861 Vali Acc: 0.174 Test Loss: 1.861 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.6294054985046387
Epoch: 2, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.854 Vali Acc: 0.174 Test Loss: 1.854 Test Acc: 0.174
Validation loss decreased (-0.174055 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.6743357181549072
Epoch: 3, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.850 Vali Acc: 0.185 Test Loss: 1.850 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.6754734516143799
Epoch: 4, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.846 Vali Acc: 0.185 Test Loss: 1.846 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.7468810081481934
Epoch: 5, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.843 Vali Acc: 0.185 Test Loss: 1.843 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.7063474655151367
Epoch: 6, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.838 Vali Acc: 0.185 Test Loss: 1.838 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 7 cost time: 0.7438626289367676
Epoch: 7, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.833 Vali Acc: 0.185 Test Loss: 1.833 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 8 cost time: 0.6999683380126953
Epoch: 8, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.827 Vali Acc: 0.185 Test Loss: 1.827 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 9 cost time: 0.6287908554077148
Epoch: 9, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.821 Vali Acc: 0.185 Test Loss: 1.821 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 10 cost time: 0.6708426475524902
Epoch: 10, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.814 Vali Acc: 0.185 Test Loss: 1.814 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 11 cost time: 0.7969889640808105
Epoch: 11, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.808 Vali Acc: 0.189 Test Loss: 1.808 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 12 cost time: 0.6558783054351807
Epoch: 12, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.801 Vali Acc: 0.189 Test Loss: 1.801 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 13 cost time: 0.7241206169128418
Epoch: 13, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.793 Vali Acc: 0.189 Test Loss: 1.793 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 14 cost time: 0.683835506439209
Epoch: 14, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.786 Vali Acc: 0.185 Test Loss: 1.786 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7315962314605713
Epoch: 15, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.778 Vali Acc: 0.178 Test Loss: 1.778 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5145833492279053
Epoch: 16, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.771 Vali Acc: 0.178 Test Loss: 1.771 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5905215740203857
Epoch: 17, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.763 Vali Acc: 0.181 Test Loss: 1.763 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6969428062438965
Epoch: 18, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.755 Vali Acc: 0.185 Test Loss: 1.755 Test Acc: 0.185
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5535566806793213
Epoch: 19, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.747 Vali Acc: 0.185 Test Loss: 1.747 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6251444816589355
Epoch: 20, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.738 Vali Acc: 0.196 Test Loss: 1.738 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196279).  Saving model ...
Epoch: 21 cost time: 0.5682253837585449
Epoch: 21, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.730 Vali Acc: 0.226 Test Loss: 1.730 Test Acc: 0.226
Validation loss decreased (-0.196279 --> -0.225909).  Saving model ...
Epoch: 22 cost time: 0.5746119022369385
Epoch: 22, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.722 Vali Acc: 0.233 Test Loss: 1.722 Test Acc: 0.233
Validation loss decreased (-0.225909 --> -0.233316).  Saving model ...
Epoch: 23 cost time: 0.5546038150787354
Epoch: 23, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.713 Vali Acc: 0.252 Test Loss: 1.713 Test Acc: 0.252
Validation loss decreased (-0.233316 --> -0.251835).  Saving model ...
Epoch: 24 cost time: 0.7436950206756592
Epoch: 24, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.705 Vali Acc: 0.274 Test Loss: 1.705 Test Acc: 0.274
Validation loss decreased (-0.251835 --> -0.274057).  Saving model ...
Epoch: 25 cost time: 0.5932812690734863
Epoch: 25, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.696 Vali Acc: 0.285 Test Loss: 1.696 Test Acc: 0.285
Validation loss decreased (-0.274057 --> -0.285168).  Saving model ...
Epoch: 26 cost time: 0.6319389343261719
Epoch: 26, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.688 Vali Acc: 0.304 Test Loss: 1.688 Test Acc: 0.304
Validation loss decreased (-0.285168 --> -0.303687).  Saving model ...
Epoch: 27 cost time: 0.5803885459899902
Epoch: 27, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.679 Vali Acc: 0.337 Test Loss: 1.679 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337020).  Saving model ...
Epoch: 28 cost time: 0.6213769912719727
Epoch: 28, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.670 Vali Acc: 0.359 Test Loss: 1.670 Test Acc: 0.359
Validation loss decreased (-0.337020 --> -0.359243).  Saving model ...
Epoch: 29 cost time: 0.5014557838439941
Epoch: 29, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.662 Vali Acc: 0.374 Test Loss: 1.662 Test Acc: 0.374
Validation loss decreased (-0.359243 --> -0.374057).  Saving model ...
Epoch: 30 cost time: 0.6352753639221191
Epoch: 30, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.653 Vali Acc: 0.393 Test Loss: 1.653 Test Acc: 0.393
Validation loss decreased (-0.374057 --> -0.392576).  Saving model ...
Epoch: 31 cost time: 0.6663048267364502
Epoch: 31, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.644 Vali Acc: 0.407 Test Loss: 1.644 Test Acc: 0.407
Validation loss decreased (-0.392576 --> -0.407391).  Saving model ...
Epoch: 32 cost time: 0.6518995761871338
Epoch: 32, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.636 Vali Acc: 0.430 Test Loss: 1.636 Test Acc: 0.430
Validation loss decreased (-0.407391 --> -0.429613).  Saving model ...
Epoch: 33 cost time: 0.6169896125793457
Epoch: 33, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.627 Vali Acc: 0.437 Test Loss: 1.627 Test Acc: 0.437
Validation loss decreased (-0.429613 --> -0.437021).  Saving model ...
Epoch: 34 cost time: 0.5026271343231201
Epoch: 34, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.618 Vali Acc: 0.441 Test Loss: 1.618 Test Acc: 0.441
Validation loss decreased (-0.437021 --> -0.440725).  Saving model ...
Epoch: 35 cost time: 0.7221741676330566
Epoch: 35, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.609 Vali Acc: 0.448 Test Loss: 1.609 Test Acc: 0.448
Validation loss decreased (-0.440725 --> -0.448132).  Saving model ...
Epoch: 36 cost time: 0.6536204814910889
Epoch: 36, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.599 Vali Acc: 0.456 Test Loss: 1.599 Test Acc: 0.456
Validation loss decreased (-0.448132 --> -0.455540).  Saving model ...
Epoch: 37 cost time: 0.5898945331573486
Epoch: 37, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.590 Vali Acc: 0.489 Test Loss: 1.590 Test Acc: 0.489
Validation loss decreased (-0.455540 --> -0.488873).  Saving model ...
Epoch: 38 cost time: 0.6428689956665039
Epoch: 38, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.581 Vali Acc: 0.504 Test Loss: 1.581 Test Acc: 0.504
Validation loss decreased (-0.488873 --> -0.503688).  Saving model ...
Epoch: 39 cost time: 0.5752148628234863
Epoch: 39, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.571 Vali Acc: 0.511 Test Loss: 1.571 Test Acc: 0.511
Validation loss decreased (-0.503688 --> -0.511095).  Saving model ...
Epoch: 40 cost time: 0.6319541931152344
Epoch: 40, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.562 Vali Acc: 0.526 Test Loss: 1.562 Test Acc: 0.526
Validation loss decreased (-0.511095 --> -0.525910).  Saving model ...
Epoch: 41 cost time: 0.641869306564331
Epoch: 41, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.552 Vali Acc: 0.533 Test Loss: 1.552 Test Acc: 0.533
Validation loss decreased (-0.525910 --> -0.533318).  Saving model ...
Epoch: 42 cost time: 0.6521182060241699
Epoch: 42, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.542 Vali Acc: 0.541 Test Loss: 1.542 Test Acc: 0.541
Validation loss decreased (-0.533318 --> -0.540725).  Saving model ...
Epoch: 43 cost time: 0.6122927665710449
Epoch: 43, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.533 Vali Acc: 0.567 Test Loss: 1.533 Test Acc: 0.567
Validation loss decreased (-0.540725 --> -0.566651).  Saving model ...
Epoch: 44 cost time: 0.5281412601470947
Epoch: 44, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.523 Vali Acc: 0.581 Test Loss: 1.523 Test Acc: 0.581
Validation loss decreased (-0.566651 --> -0.581466).  Saving model ...
Epoch: 45 cost time: 0.5764014720916748
Epoch: 45, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.512 Vali Acc: 0.589 Test Loss: 1.512 Test Acc: 0.589
Validation loss decreased (-0.581466 --> -0.588874).  Saving model ...
Epoch: 46 cost time: 0.6100175380706787
Epoch: 46, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.502 Vali Acc: 0.585 Test Loss: 1.502 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7155916690826416
Epoch: 47, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.492 Vali Acc: 0.596 Test Loss: 1.492 Test Acc: 0.596
Validation loss decreased (-0.588874 --> -0.596281).  Saving model ...
Epoch: 48 cost time: 0.64487624168396
Epoch: 48, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.481 Vali Acc: 0.604 Test Loss: 1.481 Test Acc: 0.604
Validation loss decreased (-0.596281 --> -0.603689).  Saving model ...
Epoch: 49 cost time: 0.6287598609924316
Epoch: 49, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.470 Vali Acc: 0.600 Test Loss: 1.470 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6931910514831543
Epoch: 50, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.459 Vali Acc: 0.615 Test Loss: 1.459 Test Acc: 0.615
Validation loss decreased (-0.603689 --> -0.614800).  Saving model ...
Epoch: 51 cost time: 0.5267107486724854
Epoch: 51, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.448 Vali Acc: 0.630 Test Loss: 1.448 Test Acc: 0.630
Validation loss decreased (-0.614800 --> -0.629615).  Saving model ...
Epoch: 52 cost time: 0.7241880893707275
Epoch: 52, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.437 Vali Acc: 0.630 Test Loss: 1.437 Test Acc: 0.630
Validation loss decreased (-0.629615 --> -0.629615).  Saving model ...
Epoch: 53 cost time: 0.7419297695159912
Epoch: 53, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.426 Vali Acc: 0.633 Test Loss: 1.426 Test Acc: 0.633
Validation loss decreased (-0.629615 --> -0.633319).  Saving model ...
Epoch: 54 cost time: 0.6068379878997803
Epoch: 54, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.415 Vali Acc: 0.633 Test Loss: 1.415 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 55 cost time: 0.6143383979797363
Epoch: 55, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.404 Vali Acc: 0.633 Test Loss: 1.404 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 56 cost time: 0.6651136875152588
Epoch: 56, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.392 Vali Acc: 0.633 Test Loss: 1.392 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 57 cost time: 0.6292650699615479
Epoch: 57, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.381 Vali Acc: 0.641 Test Loss: 1.381 Test Acc: 0.641
Validation loss decreased (-0.633319 --> -0.640727).  Saving model ...
Epoch: 58 cost time: 0.6832516193389893
Epoch: 58, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.370 Vali Acc: 0.648 Test Loss: 1.370 Test Acc: 0.648
Validation loss decreased (-0.640727 --> -0.648134).  Saving model ...
Epoch: 59 cost time: 0.6889307498931885
Epoch: 59, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.359 Vali Acc: 0.656 Test Loss: 1.359 Test Acc: 0.656
Validation loss decreased (-0.648134 --> -0.655542).  Saving model ...
Epoch: 60 cost time: 0.5878100395202637
Epoch: 60, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.348 Vali Acc: 0.659 Test Loss: 1.348 Test Acc: 0.659
Validation loss decreased (-0.655542 --> -0.659246).  Saving model ...
Epoch: 61 cost time: 0.6435108184814453
Epoch: 61, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.336 Vali Acc: 0.667 Test Loss: 1.336 Test Acc: 0.667
Validation loss decreased (-0.659246 --> -0.666653).  Saving model ...
Epoch: 62 cost time: 0.5959017276763916
Epoch: 62, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.325 Vali Acc: 0.670 Test Loss: 1.325 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.670357).  Saving model ...
Epoch: 63 cost time: 0.6028287410736084
Epoch: 63, Steps: 2 | Train Loss: 0.902 Vali Loss: 1.314 Vali Acc: 0.667 Test Loss: 1.314 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6563565731048584
Epoch: 64, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.302 Vali Acc: 0.667 Test Loss: 1.302 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7657177448272705
Epoch: 65, Steps: 2 | Train Loss: 0.829 Vali Loss: 1.291 Vali Acc: 0.670 Test Loss: 1.291 Test Acc: 0.670
Validation loss decreased (-0.670357 --> -0.670357).  Saving model ...
Epoch: 66 cost time: 0.8058984279632568
Epoch: 66, Steps: 2 | Train Loss: 0.848 Vali Loss: 1.280 Vali Acc: 0.670 Test Loss: 1.280 Test Acc: 0.670
Validation loss decreased (-0.670357 --> -0.670358).  Saving model ...
Epoch: 67 cost time: 0.6195559501647949
Epoch: 67, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.268 Vali Acc: 0.681 Test Loss: 1.268 Test Acc: 0.681
Validation loss decreased (-0.670358 --> -0.681469).  Saving model ...
Epoch: 68 cost time: 0.582197904586792
Epoch: 68, Steps: 2 | Train Loss: 0.765 Vali Loss: 1.257 Vali Acc: 0.681 Test Loss: 1.257 Test Acc: 0.681
Validation loss decreased (-0.681469 --> -0.681469).  Saving model ...
Epoch: 69 cost time: 0.5790901184082031
Epoch: 69, Steps: 2 | Train Loss: 0.723 Vali Loss: 1.246 Vali Acc: 0.685 Test Loss: 1.246 Test Acc: 0.685
Validation loss decreased (-0.681469 --> -0.685173).  Saving model ...
Epoch: 70 cost time: 0.6424238681793213
Epoch: 70, Steps: 2 | Train Loss: 0.747 Vali Loss: 1.236 Vali Acc: 0.685 Test Loss: 1.236 Test Acc: 0.685
Validation loss decreased (-0.685173 --> -0.685173).  Saving model ...
Epoch: 71 cost time: 0.7183051109313965
Epoch: 71, Steps: 2 | Train Loss: 0.700 Vali Loss: 1.225 Vali Acc: 0.681 Test Loss: 1.225 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5703163146972656
Epoch: 72, Steps: 2 | Train Loss: 0.705 Vali Loss: 1.214 Vali Acc: 0.681 Test Loss: 1.214 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.4401280879974365
Epoch: 73, Steps: 2 | Train Loss: 0.677 Vali Loss: 1.204 Vali Acc: 0.685 Test Loss: 1.204 Test Acc: 0.685
Validation loss decreased (-0.685173 --> -0.685173).  Saving model ...
Epoch: 74 cost time: 0.575467586517334
Epoch: 74, Steps: 2 | Train Loss: 0.625 Vali Loss: 1.194 Vali Acc: 0.696 Test Loss: 1.194 Test Acc: 0.696
Validation loss decreased (-0.685173 --> -0.696284).  Saving model ...
Epoch: 75 cost time: 0.6194956302642822
Epoch: 75, Steps: 2 | Train Loss: 0.614 Vali Loss: 1.183 Vali Acc: 0.696 Test Loss: 1.183 Test Acc: 0.696
Validation loss decreased (-0.696284 --> -0.696284).  Saving model ...
Epoch: 76 cost time: 0.6776401996612549
Epoch: 76, Steps: 2 | Train Loss: 0.624 Vali Loss: 1.173 Vali Acc: 0.700 Test Loss: 1.173 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 77 cost time: 0.6475973129272461
Epoch: 77, Steps: 2 | Train Loss: 0.587 Vali Loss: 1.163 Vali Acc: 0.704 Test Loss: 1.163 Test Acc: 0.704
Validation loss decreased (-0.699988 --> -0.703692).  Saving model ...
Epoch: 78 cost time: 0.657315731048584
Epoch: 78, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.154 Vali Acc: 0.700 Test Loss: 1.154 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7606170177459717
Epoch: 79, Steps: 2 | Train Loss: 0.519 Vali Loss: 1.145 Vali Acc: 0.707 Test Loss: 1.145 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 80 cost time: 0.652015209197998
Epoch: 80, Steps: 2 | Train Loss: 0.511 Vali Loss: 1.136 Vali Acc: 0.707 Test Loss: 1.136 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 81 cost time: 0.619586706161499
Epoch: 81, Steps: 2 | Train Loss: 0.492 Vali Loss: 1.127 Vali Acc: 0.700 Test Loss: 1.127 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.6688930988311768
Epoch: 82, Steps: 2 | Train Loss: 0.465 Vali Loss: 1.118 Vali Acc: 0.707 Test Loss: 1.118 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 83 cost time: 0.5784323215484619
Epoch: 83, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.110 Vali Acc: 0.704 Test Loss: 1.110 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6503615379333496
Epoch: 84, Steps: 2 | Train Loss: 0.452 Vali Loss: 1.102 Vali Acc: 0.707 Test Loss: 1.102 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 85 cost time: 0.7065458297729492
Epoch: 85, Steps: 2 | Train Loss: 0.438 Vali Loss: 1.095 Vali Acc: 0.707 Test Loss: 1.095 Test Acc: 0.707
Validation loss decreased (-0.707396 --> -0.707396).  Saving model ...
Epoch: 86 cost time: 0.6757190227508545
Epoch: 86, Steps: 2 | Train Loss: 0.409 Vali Loss: 1.088 Vali Acc: 0.704 Test Loss: 1.088 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7487835884094238
Epoch: 87, Steps: 2 | Train Loss: 0.389 Vali Loss: 1.081 Vali Acc: 0.704 Test Loss: 1.081 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.7200055122375488
Epoch: 88, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.7565937042236328
Epoch: 89, Steps: 2 | Train Loss: 0.393 Vali Loss: 1.069 Vali Acc: 0.704 Test Loss: 1.069 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.7415101528167725
Epoch: 90, Steps: 2 | Train Loss: 0.348 Vali Loss: 1.063 Vali Acc: 0.704 Test Loss: 1.063 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.6338460445404053
Epoch: 91, Steps: 2 | Train Loss: 0.344 Vali Loss: 1.058 Vali Acc: 0.696 Test Loss: 1.058 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.6979262828826904
Epoch: 92, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.052 Vali Acc: 0.693 Test Loss: 1.052 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.6983242034912109
Epoch: 93, Steps: 2 | Train Loss: 0.320 Vali Loss: 1.047 Vali Acc: 0.693 Test Loss: 1.047 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.6017329692840576
Epoch: 94, Steps: 2 | Train Loss: 0.297 Vali Loss: 1.042 Vali Acc: 0.689 Test Loss: 1.042 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.6091744899749756
Epoch: 95, Steps: 2 | Train Loss: 0.294 Vali Loss: 1.037 Vali Acc: 0.689 Test Loss: 1.037 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7074074074074074
model parameter : 36068
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.212761163711548
Epoch: 1, Steps: 2 | Train Loss: 2.056 Vali Loss: 1.974 Vali Acc: 0.059 Test Loss: 1.974 Test Acc: 0.059
Validation loss decreased (inf --> -0.059240).  Saving model ...
Epoch: 2 cost time: 0.7830283641815186
Epoch: 2, Steps: 2 | Train Loss: 2.021 Vali Loss: 1.966 Vali Acc: 0.063 Test Loss: 1.966 Test Acc: 0.063
Validation loss decreased (-0.059240 --> -0.062943).  Saving model ...
Epoch: 3 cost time: 0.6356596946716309
Epoch: 3, Steps: 2 | Train Loss: 2.047 Vali Loss: 1.960 Vali Acc: 0.063 Test Loss: 1.960 Test Acc: 0.063
Validation loss decreased (-0.062943 --> -0.062943).  Saving model ...
Epoch: 4 cost time: 0.716299295425415
Epoch: 4, Steps: 2 | Train Loss: 1.999 Vali Loss: 1.956 Vali Acc: 0.067 Test Loss: 1.956 Test Acc: 0.067
Validation loss decreased (-0.062943 --> -0.066647).  Saving model ...
Epoch: 5 cost time: 0.5552058219909668
Epoch: 5, Steps: 2 | Train Loss: 2.001 Vali Loss: 1.951 Vali Acc: 0.067 Test Loss: 1.951 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066647).  Saving model ...
Epoch: 6 cost time: 0.5765249729156494
Epoch: 6, Steps: 2 | Train Loss: 1.981 Vali Loss: 1.945 Vali Acc: 0.067 Test Loss: 1.945 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066647).  Saving model ...
Epoch: 7 cost time: 0.6341991424560547
Epoch: 7, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.938 Vali Acc: 0.067 Test Loss: 1.938 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066647).  Saving model ...
Epoch: 8 cost time: 0.6108345985412598
Epoch: 8, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.930 Vali Acc: 0.067 Test Loss: 1.930 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066647).  Saving model ...
Epoch: 9 cost time: 0.6640572547912598
Epoch: 9, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.921 Vali Acc: 0.067 Test Loss: 1.921 Test Acc: 0.067
Validation loss decreased (-0.066647 --> -0.066647).  Saving model ...
Epoch: 10 cost time: 0.6022918224334717
Epoch: 10, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.912 Vali Acc: 0.070 Test Loss: 1.912 Test Acc: 0.070
Validation loss decreased (-0.066647 --> -0.070351).  Saving model ...
Epoch: 11 cost time: 0.48453640937805176
Epoch: 11, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.902 Vali Acc: 0.081 Test Loss: 1.902 Test Acc: 0.081
Validation loss decreased (-0.070351 --> -0.081462).  Saving model ...
Epoch: 12 cost time: 0.6808838844299316
Epoch: 12, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.892 Vali Acc: 0.089 Test Loss: 1.892 Test Acc: 0.089
Validation loss decreased (-0.081462 --> -0.088870).  Saving model ...
Epoch: 13 cost time: 0.7932240962982178
Epoch: 13, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.882 Vali Acc: 0.089 Test Loss: 1.882 Test Acc: 0.089
Validation loss decreased (-0.088870 --> -0.088870).  Saving model ...
Epoch: 14 cost time: 0.6263115406036377
Epoch: 14, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.872 Vali Acc: 0.089 Test Loss: 1.872 Test Acc: 0.089
Validation loss decreased (-0.088870 --> -0.088870).  Saving model ...
Epoch: 15 cost time: 0.8314590454101562
Epoch: 15, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.861 Vali Acc: 0.100 Test Loss: 1.861 Test Acc: 0.100
Validation loss decreased (-0.088870 --> -0.099981).  Saving model ...
Epoch: 16 cost time: 0.7259328365325928
Epoch: 16, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.850 Vali Acc: 0.111 Test Loss: 1.850 Test Acc: 0.111
Validation loss decreased (-0.099981 --> -0.111093).  Saving model ...
Epoch: 17 cost time: 0.6281630992889404
Epoch: 17, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.839 Vali Acc: 0.115 Test Loss: 1.839 Test Acc: 0.115
Validation loss decreased (-0.111093 --> -0.114796).  Saving model ...
Epoch: 18 cost time: 0.6686666011810303
Epoch: 18, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.828 Vali Acc: 0.137 Test Loss: 1.828 Test Acc: 0.137
Validation loss decreased (-0.114796 --> -0.137019).  Saving model ...
Epoch: 19 cost time: 0.4741694927215576
Epoch: 19, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.817 Vali Acc: 0.148 Test Loss: 1.817 Test Acc: 0.148
Validation loss decreased (-0.137019 --> -0.148130).  Saving model ...
Epoch: 20 cost time: 0.6033804416656494
Epoch: 20, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.805 Vali Acc: 0.163 Test Loss: 1.805 Test Acc: 0.163
Validation loss decreased (-0.148130 --> -0.162945).  Saving model ...
Epoch: 21 cost time: 0.5678896903991699
Epoch: 21, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.794 Vali Acc: 0.178 Test Loss: 1.794 Test Acc: 0.178
Validation loss decreased (-0.162945 --> -0.177760).  Saving model ...
Epoch: 22 cost time: 0.5342531204223633
Epoch: 22, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.781 Vali Acc: 0.196 Test Loss: 1.781 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196278).  Saving model ...
Epoch: 23 cost time: 0.4876365661621094
Epoch: 23, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.769 Vali Acc: 0.211 Test Loss: 1.769 Test Acc: 0.211
Validation loss decreased (-0.196278 --> -0.211093).  Saving model ...
Epoch: 24 cost time: 0.6132886409759521
Epoch: 24, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.756 Vali Acc: 0.226 Test Loss: 1.756 Test Acc: 0.226
Validation loss decreased (-0.211093 --> -0.225908).  Saving model ...
Epoch: 25 cost time: 0.6715588569641113
Epoch: 25, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.744 Vali Acc: 0.241 Test Loss: 1.744 Test Acc: 0.241
Validation loss decreased (-0.225908 --> -0.240723).  Saving model ...
Epoch: 26 cost time: 0.5345969200134277
Epoch: 26, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
Validation loss decreased (-0.240723 --> -0.259242).  Saving model ...
Epoch: 27 cost time: 0.5265936851501465
Epoch: 27, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.719 Vali Acc: 0.278 Test Loss: 1.719 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277761).  Saving model ...
Epoch: 28 cost time: 0.5634679794311523
Epoch: 28, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.706 Vali Acc: 0.289 Test Loss: 1.706 Test Acc: 0.289
Validation loss decreased (-0.277761 --> -0.288872).  Saving model ...
Epoch: 29 cost time: 0.6185207366943359
Epoch: 29, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.694 Vali Acc: 0.319 Test Loss: 1.694 Test Acc: 0.319
Validation loss decreased (-0.288872 --> -0.318502).  Saving model ...
Epoch: 30 cost time: 0.6323931217193604
Epoch: 30, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.681 Vali Acc: 0.344 Test Loss: 1.681 Test Acc: 0.344
Validation loss decreased (-0.318502 --> -0.344428).  Saving model ...
Epoch: 31 cost time: 0.7166626453399658
Epoch: 31, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.668 Vali Acc: 0.367 Test Loss: 1.668 Test Acc: 0.367
Validation loss decreased (-0.344428 --> -0.366650).  Saving model ...
Epoch: 32 cost time: 0.6830630302429199
Epoch: 32, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.655 Vali Acc: 0.374 Test Loss: 1.655 Test Acc: 0.374
Validation loss decreased (-0.366650 --> -0.374058).  Saving model ...
Epoch: 33 cost time: 0.7977397441864014
Epoch: 33, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.642 Vali Acc: 0.378 Test Loss: 1.642 Test Acc: 0.378
Validation loss decreased (-0.374058 --> -0.377761).  Saving model ...
Epoch: 34 cost time: 0.715714693069458
Epoch: 34, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.630 Vali Acc: 0.407 Test Loss: 1.630 Test Acc: 0.407
Validation loss decreased (-0.377761 --> -0.407391).  Saving model ...
Epoch: 35 cost time: 0.676964521408081
Epoch: 35, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.617 Vali Acc: 0.407 Test Loss: 1.617 Test Acc: 0.407
Validation loss decreased (-0.407391 --> -0.407391).  Saving model ...
Epoch: 36 cost time: 0.7605316638946533
Epoch: 36, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.604 Vali Acc: 0.422 Test Loss: 1.604 Test Acc: 0.422
Validation loss decreased (-0.407391 --> -0.422206).  Saving model ...
Epoch: 37 cost time: 0.6542365550994873
Epoch: 37, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.591 Vali Acc: 0.437 Test Loss: 1.591 Test Acc: 0.437
Validation loss decreased (-0.422206 --> -0.437021).  Saving model ...
Epoch: 38 cost time: 0.6931886672973633
Epoch: 38, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.579 Vali Acc: 0.459 Test Loss: 1.579 Test Acc: 0.459
Validation loss decreased (-0.437021 --> -0.459243).  Saving model ...
Epoch: 39 cost time: 0.7069518566131592
Epoch: 39, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.567 Vali Acc: 0.470 Test Loss: 1.567 Test Acc: 0.470
Validation loss decreased (-0.459243 --> -0.470355).  Saving model ...
Epoch: 40 cost time: 0.7142417430877686
Epoch: 40, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.555 Vali Acc: 0.485 Test Loss: 1.555 Test Acc: 0.485
Validation loss decreased (-0.470355 --> -0.485170).  Saving model ...
Epoch: 41 cost time: 0.6910746097564697
Epoch: 41, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.543 Vali Acc: 0.489 Test Loss: 1.543 Test Acc: 0.489
Validation loss decreased (-0.485170 --> -0.488873).  Saving model ...
Epoch: 42 cost time: 0.748511552810669
Epoch: 42, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.530 Vali Acc: 0.493 Test Loss: 1.530 Test Acc: 0.493
Validation loss decreased (-0.488873 --> -0.492577).  Saving model ...
Epoch: 43 cost time: 0.6204450130462646
Epoch: 43, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
Validation loss decreased (-0.492577 --> -0.499985).  Saving model ...
Epoch: 44 cost time: 0.7294528484344482
Epoch: 44, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.507 Vali Acc: 0.500 Test Loss: 1.507 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 45 cost time: 0.7219059467315674
Epoch: 45, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.496 Vali Acc: 0.507 Test Loss: 1.496 Test Acc: 0.507
Validation loss decreased (-0.499985 --> -0.507392).  Saving model ...
Epoch: 46 cost time: 0.6059088706970215
Epoch: 46, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.484 Vali Acc: 0.511 Test Loss: 1.484 Test Acc: 0.511
Validation loss decreased (-0.507392 --> -0.511096).  Saving model ...
Epoch: 47 cost time: 0.5756721496582031
Epoch: 47, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.473 Vali Acc: 0.522 Test Loss: 1.473 Test Acc: 0.522
Validation loss decreased (-0.511096 --> -0.522207).  Saving model ...
Epoch: 48 cost time: 0.5996088981628418
Epoch: 48, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.462 Vali Acc: 0.544 Test Loss: 1.462 Test Acc: 0.544
Validation loss decreased (-0.522207 --> -0.544430).  Saving model ...
Epoch: 49 cost time: 0.7161788940429688
Epoch: 49, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.451 Vali Acc: 0.552 Test Loss: 1.451 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551837).  Saving model ...
Epoch: 50 cost time: 0.7024943828582764
Epoch: 50, Steps: 2 | Train Loss: 0.838 Vali Loss: 1.440 Vali Acc: 0.559 Test Loss: 1.440 Test Acc: 0.559
Validation loss decreased (-0.551837 --> -0.559245).  Saving model ...
Epoch: 51 cost time: 0.7059473991394043
Epoch: 51, Steps: 2 | Train Loss: 0.855 Vali Loss: 1.429 Vali Acc: 0.563 Test Loss: 1.429 Test Acc: 0.563
Validation loss decreased (-0.559245 --> -0.562949).  Saving model ...
Epoch: 52 cost time: 0.8308403491973877
Epoch: 52, Steps: 2 | Train Loss: 0.814 Vali Loss: 1.418 Vali Acc: 0.563 Test Loss: 1.418 Test Acc: 0.563
Validation loss decreased (-0.562949 --> -0.562949).  Saving model ...
Epoch: 53 cost time: 0.5866260528564453
Epoch: 53, Steps: 2 | Train Loss: 0.793 Vali Loss: 1.407 Vali Acc: 0.570 Test Loss: 1.407 Test Acc: 0.570
Validation loss decreased (-0.562949 --> -0.570356).  Saving model ...
Epoch: 54 cost time: 0.6490824222564697
Epoch: 54, Steps: 2 | Train Loss: 0.776 Vali Loss: 1.398 Vali Acc: 0.578 Test Loss: 1.398 Test Acc: 0.578
Validation loss decreased (-0.570356 --> -0.577764).  Saving model ...
Epoch: 55 cost time: 0.7621474266052246
Epoch: 55, Steps: 2 | Train Loss: 0.746 Vali Loss: 1.387 Vali Acc: 0.585 Test Loss: 1.387 Test Acc: 0.585
Validation loss decreased (-0.577764 --> -0.585171).  Saving model ...
Epoch: 56 cost time: 0.8894622325897217
Epoch: 56, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.376 Vali Acc: 0.593 Test Loss: 1.376 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592579).  Saving model ...
Epoch: 57 cost time: 0.8735508918762207
Epoch: 57, Steps: 2 | Train Loss: 0.720 Vali Loss: 1.366 Vali Acc: 0.589 Test Loss: 1.366 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2187011241912842
Epoch: 58, Steps: 2 | Train Loss: 0.713 Vali Loss: 1.355 Vali Acc: 0.589 Test Loss: 1.355 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.096545696258545
Epoch: 59, Steps: 2 | Train Loss: 0.698 Vali Loss: 1.346 Vali Acc: 0.596 Test Loss: 1.346 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 60 cost time: 0.9090189933776855
Epoch: 60, Steps: 2 | Train Loss: 0.664 Vali Loss: 1.336 Vali Acc: 0.596 Test Loss: 1.336 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 61 cost time: 0.8966648578643799
Epoch: 61, Steps: 2 | Train Loss: 0.648 Vali Loss: 1.326 Vali Acc: 0.604 Test Loss: 1.326 Test Acc: 0.604
Validation loss decreased (-0.596283 --> -0.603690).  Saving model ...
Epoch: 62 cost time: 0.730283260345459
Epoch: 62, Steps: 2 | Train Loss: 0.635 Vali Loss: 1.317 Vali Acc: 0.611 Test Loss: 1.317 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611098).  Saving model ...
Epoch: 63 cost time: 0.79677414894104
Epoch: 63, Steps: 2 | Train Loss: 0.608 Vali Loss: 1.307 Vali Acc: 0.622 Test Loss: 1.307 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 64 cost time: 0.7433302402496338
Epoch: 64, Steps: 2 | Train Loss: 0.584 Vali Loss: 1.299 Vali Acc: 0.630 Test Loss: 1.299 Test Acc: 0.630
Validation loss decreased (-0.622209 --> -0.629617).  Saving model ...
Epoch: 65 cost time: 0.6610488891601562
Epoch: 65, Steps: 2 | Train Loss: 0.595 Vali Loss: 1.291 Vali Acc: 0.630 Test Loss: 1.291 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 66 cost time: 0.7643578052520752
Epoch: 66, Steps: 2 | Train Loss: 0.581 Vali Loss: 1.282 Vali Acc: 0.633 Test Loss: 1.282 Test Acc: 0.633
Validation loss decreased (-0.629617 --> -0.633321).  Saving model ...
Epoch: 67 cost time: 0.7777786254882812
Epoch: 67, Steps: 2 | Train Loss: 0.526 Vali Loss: 1.273 Vali Acc: 0.641 Test Loss: 1.273 Test Acc: 0.641
Validation loss decreased (-0.633321 --> -0.640728).  Saving model ...
Epoch: 68 cost time: 0.8666896820068359
Epoch: 68, Steps: 2 | Train Loss: 0.519 Vali Loss: 1.265 Vali Acc: 0.641 Test Loss: 1.265 Test Acc: 0.641
Validation loss decreased (-0.640728 --> -0.640728).  Saving model ...
Epoch: 69 cost time: 0.760169267654419
Epoch: 69, Steps: 2 | Train Loss: 0.529 Vali Loss: 1.256 Vali Acc: 0.644 Test Loss: 1.256 Test Acc: 0.644
Validation loss decreased (-0.640728 --> -0.644432).  Saving model ...
Epoch: 70 cost time: 0.6757855415344238
Epoch: 70, Steps: 2 | Train Loss: 0.533 Vali Loss: 1.248 Vali Acc: 0.648 Test Loss: 1.248 Test Acc: 0.648
Validation loss decreased (-0.644432 --> -0.648136).  Saving model ...
Epoch: 71 cost time: 0.7160680294036865
Epoch: 71, Steps: 2 | Train Loss: 0.489 Vali Loss: 1.241 Vali Acc: 0.652 Test Loss: 1.241 Test Acc: 0.652
Validation loss decreased (-0.648136 --> -0.651839).  Saving model ...
Epoch: 72 cost time: 0.716101884841919
Epoch: 72, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.233 Vali Acc: 0.644 Test Loss: 1.233 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.627164363861084
Epoch: 73, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.227 Vali Acc: 0.652 Test Loss: 1.227 Test Acc: 0.652
Validation loss decreased (-0.651839 --> -0.651840).  Saving model ...
Epoch: 74 cost time: 0.7803587913513184
Epoch: 74, Steps: 2 | Train Loss: 0.430 Vali Loss: 1.220 Vali Acc: 0.652 Test Loss: 1.220 Test Acc: 0.652
Validation loss decreased (-0.651840 --> -0.651840).  Saving model ...
Epoch: 75 cost time: 0.6946678161621094
Epoch: 75, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.213 Vali Acc: 0.656 Test Loss: 1.213 Test Acc: 0.656
Validation loss decreased (-0.651840 --> -0.655543).  Saving model ...
Epoch: 76 cost time: 0.8301448822021484
Epoch: 76, Steps: 2 | Train Loss: 0.429 Vali Loss: 1.206 Vali Acc: 0.652 Test Loss: 1.206 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8770880699157715
Epoch: 77, Steps: 2 | Train Loss: 0.421 Vali Loss: 1.199 Vali Acc: 0.648 Test Loss: 1.199 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.7771031856536865
Epoch: 78, Steps: 2 | Train Loss: 0.407 Vali Loss: 1.193 Vali Acc: 0.652 Test Loss: 1.193 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.6747255325317383
Epoch: 79, Steps: 2 | Train Loss: 0.398 Vali Loss: 1.187 Vali Acc: 0.656 Test Loss: 1.187 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 80 cost time: 0.7926185131072998
Epoch: 80, Steps: 2 | Train Loss: 0.361 Vali Loss: 1.181 Vali Acc: 0.656 Test Loss: 1.181 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 81 cost time: 0.8478319644927979
Epoch: 81, Steps: 2 | Train Loss: 0.370 Vali Loss: 1.175 Vali Acc: 0.652 Test Loss: 1.175 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8656322956085205
Epoch: 82, Steps: 2 | Train Loss: 0.347 Vali Loss: 1.169 Vali Acc: 0.659 Test Loss: 1.169 Test Acc: 0.659
Validation loss decreased (-0.655544 --> -0.659248).  Saving model ...
Epoch: 83 cost time: 0.854712963104248
Epoch: 83, Steps: 2 | Train Loss: 0.355 Vali Loss: 1.163 Vali Acc: 0.656 Test Loss: 1.163 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.830256462097168
Epoch: 84, Steps: 2 | Train Loss: 0.311 Vali Loss: 1.158 Vali Acc: 0.656 Test Loss: 1.158 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.0322108268737793
Epoch: 85, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.152 Vali Acc: 0.656 Test Loss: 1.152 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.0230154991149902
Epoch: 86, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.147 Vali Acc: 0.656 Test Loss: 1.147 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.7747187614440918
Epoch: 87, Steps: 2 | Train Loss: 0.306 Vali Loss: 1.142 Vali Acc: 0.663 Test Loss: 1.142 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662952).  Saving model ...
Epoch: 88 cost time: 1.045269250869751
Epoch: 88, Steps: 2 | Train Loss: 0.302 Vali Loss: 1.137 Vali Acc: 0.663 Test Loss: 1.137 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 89 cost time: 0.8177802562713623
Epoch: 89, Steps: 2 | Train Loss: 0.289 Vali Loss: 1.133 Vali Acc: 0.663 Test Loss: 1.133 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 90 cost time: 0.9000053405761719
Epoch: 90, Steps: 2 | Train Loss: 0.267 Vali Loss: 1.128 Vali Acc: 0.659 Test Loss: 1.128 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.6913630962371826
Epoch: 91, Steps: 2 | Train Loss: 0.268 Vali Loss: 1.124 Vali Acc: 0.663 Test Loss: 1.124 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 92 cost time: 0.8450403213500977
Epoch: 92, Steps: 2 | Train Loss: 0.239 Vali Loss: 1.120 Vali Acc: 0.663 Test Loss: 1.120 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 93 cost time: 0.821077823638916
Epoch: 93, Steps: 2 | Train Loss: 0.248 Vali Loss: 1.116 Vali Acc: 0.663 Test Loss: 1.116 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 94 cost time: 0.9702320098876953
Epoch: 94, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.112 Vali Acc: 0.663 Test Loss: 1.112 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 95 cost time: 0.9195637702941895
Epoch: 95, Steps: 2 | Train Loss: 0.236 Vali Loss: 1.108 Vali Acc: 0.663 Test Loss: 1.108 Test Acc: 0.663
Validation loss decreased (-0.662952 --> -0.662952).  Saving model ...
Epoch: 96 cost time: 1.201659917831421
Epoch: 96, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.103 Vali Acc: 0.667 Test Loss: 1.103 Test Acc: 0.667
Validation loss decreased (-0.662952 --> -0.666656).  Saving model ...
Epoch: 97 cost time: 0.8337223529815674
Epoch: 97, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.099 Vali Acc: 0.667 Test Loss: 1.099 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 98 cost time: 0.7003593444824219
Epoch: 98, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.095 Vali Acc: 0.670 Test Loss: 1.095 Test Acc: 0.670
Validation loss decreased (-0.666656 --> -0.670359).  Saving model ...
Epoch: 99 cost time: 0.6596770286560059
Epoch: 99, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.091 Vali Acc: 0.670 Test Loss: 1.091 Test Acc: 0.670
Validation loss decreased (-0.670359 --> -0.670359).  Saving model ...
Epoch: 100 cost time: 0.6783993244171143
Epoch: 100, Steps: 2 | Train Loss: 0.207 Vali Loss: 1.086 Vali Acc: 0.667 Test Loss: 1.086 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6703703703703704
model parameter : 35556
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1024484634399414
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.916 Vali Acc: 0.152 Test Loss: 1.916 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.7101829051971436
Epoch: 2, Steps: 2 | Train Loss: 1.970 Vali Loss: 1.908 Vali Acc: 0.152 Test Loss: 1.908 Test Acc: 0.152
Validation loss decreased (-0.151833 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.6381888389587402
Epoch: 3, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.903 Vali Acc: 0.163 Test Loss: 1.903 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 0.693819522857666
Epoch: 4, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.900 Vali Acc: 0.159 Test Loss: 1.900 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6501755714416504
Epoch: 5, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.895 Vali Acc: 0.159 Test Loss: 1.895 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5030767917633057
Epoch: 6, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.890 Vali Acc: 0.163 Test Loss: 1.890 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162944).  Saving model ...
Epoch: 7 cost time: 0.6898853778839111
Epoch: 7, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.884 Vali Acc: 0.167 Test Loss: 1.884 Test Acc: 0.167
Validation loss decreased (-0.162944 --> -0.166648).  Saving model ...
Epoch: 8 cost time: 0.7876577377319336
Epoch: 8, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.877 Vali Acc: 0.170 Test Loss: 1.877 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 9 cost time: 0.6002562046051025
Epoch: 9, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.869 Vali Acc: 0.170 Test Loss: 1.869 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 10 cost time: 0.6028950214385986
Epoch: 10, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.862 Vali Acc: 0.170 Test Loss: 1.862 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 11 cost time: 0.6060447692871094
Epoch: 11, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.853 Vali Acc: 0.185 Test Loss: 1.853 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 12 cost time: 0.6903266906738281
Epoch: 12, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.845 Vali Acc: 0.196 Test Loss: 1.845 Test Acc: 0.196
Validation loss decreased (-0.185167 --> -0.196278).  Saving model ...
Epoch: 13 cost time: 0.8011572360992432
Epoch: 13, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.835 Vali Acc: 0.211 Test Loss: 1.835 Test Acc: 0.211
Validation loss decreased (-0.196278 --> -0.211093).  Saving model ...
Epoch: 14 cost time: 0.6349813938140869
Epoch: 14, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.826 Vali Acc: 0.211 Test Loss: 1.826 Test Acc: 0.211
Validation loss decreased (-0.211093 --> -0.211093).  Saving model ...
Epoch: 15 cost time: 0.5588200092315674
Epoch: 15, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.816 Vali Acc: 0.215 Test Loss: 1.816 Test Acc: 0.215
Validation loss decreased (-0.211093 --> -0.214797).  Saving model ...
Epoch: 16 cost time: 0.6896867752075195
Epoch: 16, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.806 Vali Acc: 0.219 Test Loss: 1.806 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218500).  Saving model ...
Epoch: 17 cost time: 0.6082532405853271
Epoch: 17, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.795 Vali Acc: 0.233 Test Loss: 1.795 Test Acc: 0.233
Validation loss decreased (-0.218500 --> -0.233315).  Saving model ...
Epoch: 18 cost time: 0.6990654468536377
Epoch: 18, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.784 Vali Acc: 0.241 Test Loss: 1.784 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 19 cost time: 0.7702505588531494
Epoch: 19, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.773 Vali Acc: 0.248 Test Loss: 1.773 Test Acc: 0.248
Validation loss decreased (-0.240723 --> -0.248130).  Saving model ...
Epoch: 20 cost time: 0.6404967308044434
Epoch: 20, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.761 Vali Acc: 0.259 Test Loss: 1.761 Test Acc: 0.259
Validation loss decreased (-0.248130 --> -0.259242).  Saving model ...
Epoch: 21 cost time: 0.7954916954040527
Epoch: 21, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.750 Vali Acc: 0.270 Test Loss: 1.750 Test Acc: 0.270
Validation loss decreased (-0.259242 --> -0.270353).  Saving model ...
Epoch: 22 cost time: 0.5419003963470459
Epoch: 22, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.738 Vali Acc: 0.281 Test Loss: 1.738 Test Acc: 0.281
Validation loss decreased (-0.270353 --> -0.281464).  Saving model ...
Epoch: 23 cost time: 0.8219645023345947
Epoch: 23, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.726 Vali Acc: 0.289 Test Loss: 1.726 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288872).  Saving model ...
Epoch: 24 cost time: 0.6550514698028564
Epoch: 24, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.713 Vali Acc: 0.293 Test Loss: 1.713 Test Acc: 0.293
Validation loss decreased (-0.288872 --> -0.292575).  Saving model ...
Epoch: 25 cost time: 0.8400838375091553
Epoch: 25, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.701 Vali Acc: 0.300 Test Loss: 1.701 Test Acc: 0.300
Validation loss decreased (-0.292575 --> -0.299983).  Saving model ...
Epoch: 26 cost time: 0.7090227603912354
Epoch: 26, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.688 Vali Acc: 0.307 Test Loss: 1.688 Test Acc: 0.307
Validation loss decreased (-0.299983 --> -0.307391).  Saving model ...
Epoch: 27 cost time: 0.7021527290344238
Epoch: 27, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.676 Vali Acc: 0.326 Test Loss: 1.676 Test Acc: 0.326
Validation loss decreased (-0.307391 --> -0.325909).  Saving model ...
Epoch: 28 cost time: 0.6258015632629395
Epoch: 28, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.663 Vali Acc: 0.356 Test Loss: 1.663 Test Acc: 0.356
Validation loss decreased (-0.325909 --> -0.355539).  Saving model ...
Epoch: 29 cost time: 0.7102441787719727
Epoch: 29, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.650 Vali Acc: 0.378 Test Loss: 1.650 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377761).  Saving model ...
Epoch: 30 cost time: 0.9395973682403564
Epoch: 30, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.637 Vali Acc: 0.404 Test Loss: 1.637 Test Acc: 0.404
Validation loss decreased (-0.377761 --> -0.403687).  Saving model ...
Epoch: 31 cost time: 0.6348912715911865
Epoch: 31, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.625 Vali Acc: 0.419 Test Loss: 1.625 Test Acc: 0.419
Validation loss decreased (-0.403687 --> -0.418502).  Saving model ...
Epoch: 32 cost time: 0.6311848163604736
Epoch: 32, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.612 Vali Acc: 0.426 Test Loss: 1.612 Test Acc: 0.426
Validation loss decreased (-0.418502 --> -0.425910).  Saving model ...
Epoch: 33 cost time: 0.5441074371337891
Epoch: 33, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.600 Vali Acc: 0.441 Test Loss: 1.600 Test Acc: 0.441
Validation loss decreased (-0.425910 --> -0.440725).  Saving model ...
Epoch: 34 cost time: 0.6336407661437988
Epoch: 34, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.587 Vali Acc: 0.444 Test Loss: 1.587 Test Acc: 0.444
Validation loss decreased (-0.440725 --> -0.444429).  Saving model ...
Epoch: 35 cost time: 0.5927658081054688
Epoch: 35, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.574 Vali Acc: 0.470 Test Loss: 1.574 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 36 cost time: 0.6048159599304199
Epoch: 36, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
Validation loss decreased (-0.470355 --> -0.488873).  Saving model ...
Epoch: 37 cost time: 0.5740363597869873
Epoch: 37, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.548 Vali Acc: 0.500 Test Loss: 1.548 Test Acc: 0.500
Validation loss decreased (-0.488873 --> -0.499985).  Saving model ...
Epoch: 38 cost time: 0.7308828830718994
Epoch: 38, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.535 Vali Acc: 0.507 Test Loss: 1.535 Test Acc: 0.507
Validation loss decreased (-0.499985 --> -0.507392).  Saving model ...
Epoch: 39 cost time: 0.697662353515625
Epoch: 39, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.522 Vali Acc: 0.526 Test Loss: 1.522 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 40 cost time: 0.7907133102416992
Epoch: 40, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.509 Vali Acc: 0.556 Test Loss: 1.509 Test Acc: 0.556
Validation loss decreased (-0.525911 --> -0.555540).  Saving model ...
Epoch: 41 cost time: 0.6707375049591064
Epoch: 41, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.496 Vali Acc: 0.556 Test Loss: 1.496 Test Acc: 0.556
Validation loss decreased (-0.555540 --> -0.555541).  Saving model ...
Epoch: 42 cost time: 0.6654937267303467
Epoch: 42, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.483 Vali Acc: 0.578 Test Loss: 1.483 Test Acc: 0.578
Validation loss decreased (-0.555541 --> -0.577763).  Saving model ...
Epoch: 43 cost time: 0.6857678890228271
Epoch: 43, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.470 Vali Acc: 0.589 Test Loss: 1.470 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588874).  Saving model ...
Epoch: 44 cost time: 0.7834315299987793
Epoch: 44, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.457 Vali Acc: 0.604 Test Loss: 1.457 Test Acc: 0.604
Validation loss decreased (-0.588874 --> -0.603689).  Saving model ...
Epoch: 45 cost time: 0.5752251148223877
Epoch: 45, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.444 Vali Acc: 0.615 Test Loss: 1.444 Test Acc: 0.615
Validation loss decreased (-0.603689 --> -0.614800).  Saving model ...
Epoch: 46 cost time: 0.7069928646087646
Epoch: 46, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.431 Vali Acc: 0.622 Test Loss: 1.431 Test Acc: 0.622
Validation loss decreased (-0.614800 --> -0.622208).  Saving model ...
Epoch: 47 cost time: 0.6481063365936279
Epoch: 47, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.418 Vali Acc: 0.630 Test Loss: 1.418 Test Acc: 0.630
Validation loss decreased (-0.622208 --> -0.629615).  Saving model ...
Epoch: 48 cost time: 0.7116212844848633
Epoch: 48, Steps: 2 | Train Loss: 0.870 Vali Loss: 1.406 Vali Acc: 0.633 Test Loss: 1.406 Test Acc: 0.633
Validation loss decreased (-0.629615 --> -0.633319).  Saving model ...
Epoch: 49 cost time: 0.7767646312713623
Epoch: 49, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.394 Vali Acc: 0.644 Test Loss: 1.394 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644431).  Saving model ...
Epoch: 50 cost time: 0.8543875217437744
Epoch: 50, Steps: 2 | Train Loss: 0.828 Vali Loss: 1.382 Vali Acc: 0.644 Test Loss: 1.382 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 51 cost time: 0.5673444271087646
Epoch: 51, Steps: 2 | Train Loss: 0.795 Vali Loss: 1.370 Vali Acc: 0.641 Test Loss: 1.370 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.700716495513916
Epoch: 52, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.358 Vali Acc: 0.644 Test Loss: 1.358 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 53 cost time: 0.5786824226379395
Epoch: 53, Steps: 2 | Train Loss: 0.787 Vali Loss: 1.347 Vali Acc: 0.659 Test Loss: 1.347 Test Acc: 0.659
Validation loss decreased (-0.644431 --> -0.659246).  Saving model ...
Epoch: 54 cost time: 0.6766822338104248
Epoch: 54, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.336 Vali Acc: 0.667 Test Loss: 1.336 Test Acc: 0.667
Validation loss decreased (-0.659246 --> -0.666653).  Saving model ...
Epoch: 55 cost time: 0.7355430126190186
Epoch: 55, Steps: 2 | Train Loss: 0.698 Vali Loss: 1.325 Vali Acc: 0.670 Test Loss: 1.325 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.670357).  Saving model ...
Epoch: 56 cost time: 0.685626745223999
Epoch: 56, Steps: 2 | Train Loss: 0.687 Vali Loss: 1.313 Vali Acc: 0.678 Test Loss: 1.313 Test Acc: 0.678
Validation loss decreased (-0.670357 --> -0.677765).  Saving model ...
Epoch: 57 cost time: 0.6454918384552002
Epoch: 57, Steps: 2 | Train Loss: 0.683 Vali Loss: 1.303 Vali Acc: 0.685 Test Loss: 1.303 Test Acc: 0.685
Validation loss decreased (-0.677765 --> -0.685172).  Saving model ...
Epoch: 58 cost time: 0.6050996780395508
Epoch: 58, Steps: 2 | Train Loss: 0.642 Vali Loss: 1.292 Vali Acc: 0.696 Test Loss: 1.292 Test Acc: 0.696
Validation loss decreased (-0.685172 --> -0.696283).  Saving model ...
Epoch: 59 cost time: 0.6439061164855957
Epoch: 59, Steps: 2 | Train Loss: 0.622 Vali Loss: 1.282 Vali Acc: 0.700 Test Loss: 1.282 Test Acc: 0.700
Validation loss decreased (-0.696283 --> -0.699987).  Saving model ...
Epoch: 60 cost time: 0.6765766143798828
Epoch: 60, Steps: 2 | Train Loss: 0.613 Vali Loss: 1.272 Vali Acc: 0.700 Test Loss: 1.272 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699987).  Saving model ...
Epoch: 61 cost time: 0.6375322341918945
Epoch: 61, Steps: 2 | Train Loss: 0.630 Vali Loss: 1.262 Vali Acc: 0.707 Test Loss: 1.262 Test Acc: 0.707
Validation loss decreased (-0.699987 --> -0.707395).  Saving model ...
Epoch: 62 cost time: 0.7407081127166748
Epoch: 62, Steps: 2 | Train Loss: 0.570 Vali Loss: 1.252 Vali Acc: 0.707 Test Loss: 1.252 Test Acc: 0.707
Validation loss decreased (-0.707395 --> -0.707395).  Saving model ...
Epoch: 63 cost time: 0.6156051158905029
Epoch: 63, Steps: 2 | Train Loss: 0.572 Vali Loss: 1.242 Vali Acc: 0.711 Test Loss: 1.242 Test Acc: 0.711
Validation loss decreased (-0.707395 --> -0.711099).  Saving model ...
Epoch: 64 cost time: 0.6351137161254883
Epoch: 64, Steps: 2 | Train Loss: 0.531 Vali Loss: 1.232 Vali Acc: 0.719 Test Loss: 1.232 Test Acc: 0.719
Validation loss decreased (-0.711099 --> -0.718506).  Saving model ...
Epoch: 65 cost time: 0.6066503524780273
Epoch: 65, Steps: 2 | Train Loss: 0.491 Vali Loss: 1.223 Vali Acc: 0.719 Test Loss: 1.223 Test Acc: 0.719
Validation loss decreased (-0.718506 --> -0.718506).  Saving model ...
Epoch: 66 cost time: 0.5478725433349609
Epoch: 66, Steps: 2 | Train Loss: 0.499 Vali Loss: 1.214 Vali Acc: 0.722 Test Loss: 1.214 Test Acc: 0.722
Validation loss decreased (-0.718506 --> -0.722210).  Saving model ...
Epoch: 67 cost time: 0.8470280170440674
Epoch: 67, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.205 Vali Acc: 0.719 Test Loss: 1.205 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6512970924377441
Epoch: 68, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.196 Vali Acc: 0.719 Test Loss: 1.196 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6102681159973145
Epoch: 69, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.187 Vali Acc: 0.719 Test Loss: 1.187 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7688066959381104
Epoch: 70, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.178 Vali Acc: 0.719 Test Loss: 1.178 Test Acc: 0.719
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.0101099014282227
Epoch: 71, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.169 Vali Acc: 0.715 Test Loss: 1.169 Test Acc: 0.715
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8094496726989746
Epoch: 72, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.161 Vali Acc: 0.715 Test Loss: 1.161 Test Acc: 0.715
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8942763805389404
Epoch: 73, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.152 Vali Acc: 0.719 Test Loss: 1.152 Test Acc: 0.719
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.898207426071167
Epoch: 74, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.144 Vali Acc: 0.726 Test Loss: 1.144 Test Acc: 0.726
Validation loss decreased (-0.722210 --> -0.725914).  Saving model ...
Epoch: 75 cost time: 0.7990272045135498
Epoch: 75, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.136 Vali Acc: 0.722 Test Loss: 1.136 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8299095630645752
Epoch: 76, Steps: 2 | Train Loss: 0.351 Vali Loss: 1.128 Vali Acc: 0.730 Test Loss: 1.128 Test Acc: 0.730
Validation loss decreased (-0.725914 --> -0.729618).  Saving model ...
Epoch: 77 cost time: 0.7726881504058838
Epoch: 77, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.120 Vali Acc: 0.730 Test Loss: 1.120 Test Acc: 0.730
Validation loss decreased (-0.729618 --> -0.729618).  Saving model ...
Epoch: 78 cost time: 0.584418773651123
Epoch: 78, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.113 Vali Acc: 0.726 Test Loss: 1.113 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6017112731933594
Epoch: 79, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.105 Vali Acc: 0.733 Test Loss: 1.105 Test Acc: 0.733
Validation loss decreased (-0.729618 --> -0.733322).  Saving model ...
Epoch: 80 cost time: 0.7808525562286377
Epoch: 80, Steps: 2 | Train Loss: 0.312 Vali Loss: 1.098 Vali Acc: 0.726 Test Loss: 1.098 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5962405204772949
Epoch: 81, Steps: 2 | Train Loss: 0.309 Vali Loss: 1.090 Vali Acc: 0.722 Test Loss: 1.090 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.7253177165985107
Epoch: 82, Steps: 2 | Train Loss: 0.275 Vali Loss: 1.084 Vali Acc: 0.722 Test Loss: 1.084 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.7555804252624512
Epoch: 83, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.7066566944122314
Epoch: 84, Steps: 2 | Train Loss: 0.260 Vali Loss: 1.071 Vali Acc: 0.722 Test Loss: 1.071 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.8785901069641113
Epoch: 85, Steps: 2 | Train Loss: 0.253 Vali Loss: 1.065 Vali Acc: 0.726 Test Loss: 1.065 Test Acc: 0.726
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.7294619083404541
Epoch: 86, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.059 Vali Acc: 0.730 Test Loss: 1.059 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.7229959964752197
Epoch: 87, Steps: 2 | Train Loss: 0.247 Vali Loss: 1.053 Vali Acc: 0.730 Test Loss: 1.053 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.7255599498748779
Epoch: 88, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.047 Vali Acc: 0.730 Test Loss: 1.047 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.6980116367340088
Epoch: 89, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.041 Vali Acc: 0.733 Test Loss: 1.041 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733323).  Saving model ...
Epoch: 90 cost time: 0.8243827819824219
Epoch: 90, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.035 Vali Acc: 0.733 Test Loss: 1.035 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 91 cost time: 0.729661226272583
Epoch: 91, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.030 Vali Acc: 0.733 Test Loss: 1.030 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 92 cost time: 0.7706007957458496
Epoch: 92, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.024 Vali Acc: 0.737 Test Loss: 1.024 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.737027).  Saving model ...
Epoch: 93 cost time: 0.6962308883666992
Epoch: 93, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.019 Vali Acc: 0.733 Test Loss: 1.019 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.7504072189331055
Epoch: 94, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.014 Vali Acc: 0.733 Test Loss: 1.014 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.8837990760803223
Epoch: 95, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.009 Vali Acc: 0.730 Test Loss: 1.009 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.8024067878723145
Epoch: 96, Steps: 2 | Train Loss: 0.181 Vali Loss: 1.005 Vali Acc: 0.730 Test Loss: 1.005 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.7811987400054932
Epoch: 97, Steps: 2 | Train Loss: 0.180 Vali Loss: 1.000 Vali Acc: 0.726 Test Loss: 1.000 Test Acc: 0.726
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.9260349273681641
Epoch: 98, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.995 Vali Acc: 0.730 Test Loss: 0.995 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.7171850204467773
Epoch: 99, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.991 Vali Acc: 0.730 Test Loss: 0.991 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.7044646739959717
Epoch: 100, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.987 Vali Acc: 0.726 Test Loss: 0.987 Test Acc: 0.726
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.737037037037037
model parameter : 35300
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4853363037109375
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.916 Vali Acc: 0.152 Test Loss: 1.916 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.6710147857666016
Epoch: 2, Steps: 2 | Train Loss: 1.970 Vali Loss: 1.908 Vali Acc: 0.152 Test Loss: 1.908 Test Acc: 0.152
Validation loss decreased (-0.151833 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.6633524894714355
Epoch: 3, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.903 Vali Acc: 0.163 Test Loss: 1.903 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162944).  Saving model ...
Epoch: 4 cost time: 0.7205750942230225
Epoch: 4, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.900 Vali Acc: 0.159 Test Loss: 1.900 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9205656051635742
Epoch: 5, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.895 Vali Acc: 0.159 Test Loss: 1.895 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5502502918243408
Epoch: 6, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.890 Vali Acc: 0.163 Test Loss: 1.890 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162944).  Saving model ...
Epoch: 7 cost time: 0.6746599674224854
Epoch: 7, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.884 Vali Acc: 0.167 Test Loss: 1.884 Test Acc: 0.167
Validation loss decreased (-0.162944 --> -0.166648).  Saving model ...
Epoch: 8 cost time: 0.7050216197967529
Epoch: 8, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.877 Vali Acc: 0.170 Test Loss: 1.877 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 9 cost time: 0.72395920753479
Epoch: 9, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.869 Vali Acc: 0.170 Test Loss: 1.869 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 10 cost time: 0.7064764499664307
Epoch: 10, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.862 Vali Acc: 0.170 Test Loss: 1.862 Test Acc: 0.170
Validation loss decreased (-0.170352 --> -0.170352).  Saving model ...
Epoch: 11 cost time: 0.717005729675293
Epoch: 11, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.853 Vali Acc: 0.185 Test Loss: 1.853 Test Acc: 0.185
Validation loss decreased (-0.170352 --> -0.185167).  Saving model ...
Epoch: 12 cost time: 0.7628927230834961
Epoch: 12, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.845 Vali Acc: 0.196 Test Loss: 1.845 Test Acc: 0.196
Validation loss decreased (-0.185167 --> -0.196278).  Saving model ...
Epoch: 13 cost time: 0.694709300994873
Epoch: 13, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.835 Vali Acc: 0.211 Test Loss: 1.835 Test Acc: 0.211
Validation loss decreased (-0.196278 --> -0.211093).  Saving model ...
Epoch: 14 cost time: 0.7234892845153809
Epoch: 14, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.826 Vali Acc: 0.211 Test Loss: 1.826 Test Acc: 0.211
Validation loss decreased (-0.211093 --> -0.211093).  Saving model ...
Epoch: 15 cost time: 0.8113677501678467
Epoch: 15, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.816 Vali Acc: 0.215 Test Loss: 1.816 Test Acc: 0.215
Validation loss decreased (-0.211093 --> -0.214797).  Saving model ...
Epoch: 16 cost time: 0.691596269607544
Epoch: 16, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.806 Vali Acc: 0.219 Test Loss: 1.806 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218500).  Saving model ...
Epoch: 17 cost time: 0.6825110912322998
Epoch: 17, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.795 Vali Acc: 0.233 Test Loss: 1.795 Test Acc: 0.233
Validation loss decreased (-0.218500 --> -0.233315).  Saving model ...
Epoch: 18 cost time: 0.8252880573272705
Epoch: 18, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.784 Vali Acc: 0.241 Test Loss: 1.784 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 19 cost time: 0.4737272262573242
Epoch: 19, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.773 Vali Acc: 0.248 Test Loss: 1.773 Test Acc: 0.248
Validation loss decreased (-0.240723 --> -0.248130).  Saving model ...
Epoch: 20 cost time: 0.7681188583374023
Epoch: 20, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.761 Vali Acc: 0.259 Test Loss: 1.761 Test Acc: 0.259
Validation loss decreased (-0.248130 --> -0.259242).  Saving model ...
Epoch: 21 cost time: 0.8579356670379639
Epoch: 21, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.750 Vali Acc: 0.270 Test Loss: 1.750 Test Acc: 0.270
Validation loss decreased (-0.259242 --> -0.270353).  Saving model ...
Epoch: 22 cost time: 0.8149192333221436
Epoch: 22, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.738 Vali Acc: 0.281 Test Loss: 1.738 Test Acc: 0.281
Validation loss decreased (-0.270353 --> -0.281464).  Saving model ...
Epoch: 23 cost time: 0.9005653858184814
Epoch: 23, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.726 Vali Acc: 0.289 Test Loss: 1.726 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288872).  Saving model ...
Epoch: 24 cost time: 0.6190111637115479
Epoch: 24, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.713 Vali Acc: 0.293 Test Loss: 1.713 Test Acc: 0.293
Validation loss decreased (-0.288872 --> -0.292575).  Saving model ...
Epoch: 25 cost time: 0.7314560413360596
Epoch: 25, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.701 Vali Acc: 0.300 Test Loss: 1.701 Test Acc: 0.300
Validation loss decreased (-0.292575 --> -0.299983).  Saving model ...
Epoch: 26 cost time: 0.598121166229248
Epoch: 26, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.688 Vali Acc: 0.307 Test Loss: 1.688 Test Acc: 0.307
Validation loss decreased (-0.299983 --> -0.307391).  Saving model ...
Epoch: 27 cost time: 0.7615926265716553
Epoch: 27, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.676 Vali Acc: 0.326 Test Loss: 1.676 Test Acc: 0.326
Validation loss decreased (-0.307391 --> -0.325909).  Saving model ...
Epoch: 28 cost time: 0.7297496795654297
Epoch: 28, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.663 Vali Acc: 0.356 Test Loss: 1.663 Test Acc: 0.356
Validation loss decreased (-0.325909 --> -0.355539).  Saving model ...
Epoch: 29 cost time: 0.6357159614562988
Epoch: 29, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.650 Vali Acc: 0.378 Test Loss: 1.650 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377761).  Saving model ...
Epoch: 30 cost time: 0.7060635089874268
Epoch: 30, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.637 Vali Acc: 0.404 Test Loss: 1.637 Test Acc: 0.404
Validation loss decreased (-0.377761 --> -0.403687).  Saving model ...
Epoch: 31 cost time: 0.5648908615112305
Epoch: 31, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.625 Vali Acc: 0.419 Test Loss: 1.625 Test Acc: 0.419
Validation loss decreased (-0.403687 --> -0.418502).  Saving model ...
Epoch: 32 cost time: 0.9767563343048096
Epoch: 32, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.612 Vali Acc: 0.426 Test Loss: 1.612 Test Acc: 0.426
Validation loss decreased (-0.418502 --> -0.425910).  Saving model ...
Epoch: 33 cost time: 0.6592345237731934
Epoch: 33, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.600 Vali Acc: 0.441 Test Loss: 1.600 Test Acc: 0.441
Validation loss decreased (-0.425910 --> -0.440725).  Saving model ...
Epoch: 34 cost time: 0.7686612606048584
Epoch: 34, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.587 Vali Acc: 0.444 Test Loss: 1.587 Test Acc: 0.444
Validation loss decreased (-0.440725 --> -0.444429).  Saving model ...
Epoch: 35 cost time: 0.6740729808807373
Epoch: 35, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.574 Vali Acc: 0.470 Test Loss: 1.574 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 36 cost time: 0.7878046035766602
Epoch: 36, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
Validation loss decreased (-0.470355 --> -0.488873).  Saving model ...
Epoch: 37 cost time: 0.6537816524505615
Epoch: 37, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.548 Vali Acc: 0.500 Test Loss: 1.548 Test Acc: 0.500
Validation loss decreased (-0.488873 --> -0.499985).  Saving model ...
Epoch: 38 cost time: 0.7095823287963867
Epoch: 38, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.535 Vali Acc: 0.507 Test Loss: 1.535 Test Acc: 0.507
Validation loss decreased (-0.499985 --> -0.507392).  Saving model ...
Epoch: 39 cost time: 0.8752543926239014
Epoch: 39, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.522 Vali Acc: 0.526 Test Loss: 1.522 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 40 cost time: 0.7812328338623047
Epoch: 40, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.509 Vali Acc: 0.556 Test Loss: 1.509 Test Acc: 0.556
Validation loss decreased (-0.525911 --> -0.555540).  Saving model ...
Epoch: 41 cost time: 0.5953953266143799
Epoch: 41, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.496 Vali Acc: 0.556 Test Loss: 1.496 Test Acc: 0.556
Validation loss decreased (-0.555540 --> -0.555541).  Saving model ...
Epoch: 42 cost time: 0.9210278987884521
Epoch: 42, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.483 Vali Acc: 0.578 Test Loss: 1.483 Test Acc: 0.578
Validation loss decreased (-0.555541 --> -0.577763).  Saving model ...
Epoch: 43 cost time: 0.784635066986084
Epoch: 43, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.470 Vali Acc: 0.589 Test Loss: 1.470 Test Acc: 0.589
Validation loss decreased (-0.577763 --> -0.588874).  Saving model ...
Epoch: 44 cost time: 0.6020646095275879
Epoch: 44, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.457 Vali Acc: 0.604 Test Loss: 1.457 Test Acc: 0.604
Validation loss decreased (-0.588874 --> -0.603689).  Saving model ...
Epoch: 45 cost time: 0.7827672958374023
Epoch: 45, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.444 Vali Acc: 0.615 Test Loss: 1.444 Test Acc: 0.615
Validation loss decreased (-0.603689 --> -0.614800).  Saving model ...
Epoch: 46 cost time: 0.7063863277435303
Epoch: 46, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.431 Vali Acc: 0.622 Test Loss: 1.431 Test Acc: 0.622
Validation loss decreased (-0.614800 --> -0.622208).  Saving model ...
Epoch: 47 cost time: 0.7021183967590332
Epoch: 47, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.418 Vali Acc: 0.630 Test Loss: 1.418 Test Acc: 0.630
Validation loss decreased (-0.622208 --> -0.629615).  Saving model ...
Epoch: 48 cost time: 0.6296901702880859
Epoch: 48, Steps: 2 | Train Loss: 0.870 Vali Loss: 1.406 Vali Acc: 0.633 Test Loss: 1.406 Test Acc: 0.633
Validation loss decreased (-0.629615 --> -0.633319).  Saving model ...
Epoch: 49 cost time: 0.5941095352172852
Epoch: 49, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.394 Vali Acc: 0.644 Test Loss: 1.394 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644431).  Saving model ...
Epoch: 50 cost time: 0.5117723941802979
Epoch: 50, Steps: 2 | Train Loss: 0.828 Vali Loss: 1.382 Vali Acc: 0.644 Test Loss: 1.382 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 51 cost time: 0.5895562171936035
Epoch: 51, Steps: 2 | Train Loss: 0.795 Vali Loss: 1.370 Vali Acc: 0.641 Test Loss: 1.370 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6776502132415771
Epoch: 52, Steps: 2 | Train Loss: 0.769 Vali Loss: 1.358 Vali Acc: 0.644 Test Loss: 1.358 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 53 cost time: 0.7281692028045654
Epoch: 53, Steps: 2 | Train Loss: 0.787 Vali Loss: 1.347 Vali Acc: 0.659 Test Loss: 1.347 Test Acc: 0.659
Validation loss decreased (-0.644431 --> -0.659246).  Saving model ...
Epoch: 54 cost time: 0.6875855922698975
Epoch: 54, Steps: 2 | Train Loss: 0.724 Vali Loss: 1.336 Vali Acc: 0.667 Test Loss: 1.336 Test Acc: 0.667
Validation loss decreased (-0.659246 --> -0.666653).  Saving model ...
Epoch: 55 cost time: 0.7600746154785156
Epoch: 55, Steps: 2 | Train Loss: 0.698 Vali Loss: 1.325 Vali Acc: 0.670 Test Loss: 1.325 Test Acc: 0.670
Validation loss decreased (-0.666653 --> -0.670357).  Saving model ...
Epoch: 56 cost time: 0.7015571594238281
Epoch: 56, Steps: 2 | Train Loss: 0.687 Vali Loss: 1.313 Vali Acc: 0.678 Test Loss: 1.313 Test Acc: 0.678
Validation loss decreased (-0.670357 --> -0.677765).  Saving model ...
Epoch: 57 cost time: 0.6314189434051514
Epoch: 57, Steps: 2 | Train Loss: 0.683 Vali Loss: 1.303 Vali Acc: 0.685 Test Loss: 1.303 Test Acc: 0.685
Validation loss decreased (-0.677765 --> -0.685172).  Saving model ...
Epoch: 58 cost time: 0.7123908996582031
Epoch: 58, Steps: 2 | Train Loss: 0.642 Vali Loss: 1.292 Vali Acc: 0.696 Test Loss: 1.292 Test Acc: 0.696
Validation loss decreased (-0.685172 --> -0.696283).  Saving model ...
Epoch: 59 cost time: 0.7093160152435303
Epoch: 59, Steps: 2 | Train Loss: 0.622 Vali Loss: 1.282 Vali Acc: 0.700 Test Loss: 1.282 Test Acc: 0.700
Validation loss decreased (-0.696283 --> -0.699987).  Saving model ...
Epoch: 60 cost time: 0.8324112892150879
Epoch: 60, Steps: 2 | Train Loss: 0.613 Vali Loss: 1.272 Vali Acc: 0.700 Test Loss: 1.272 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699987).  Saving model ...
Epoch: 61 cost time: 0.6545145511627197
Epoch: 61, Steps: 2 | Train Loss: 0.630 Vali Loss: 1.262 Vali Acc: 0.707 Test Loss: 1.262 Test Acc: 0.707
Validation loss decreased (-0.699987 --> -0.707395).  Saving model ...
Epoch: 62 cost time: 0.8733668327331543
Epoch: 62, Steps: 2 | Train Loss: 0.570 Vali Loss: 1.252 Vali Acc: 0.707 Test Loss: 1.252 Test Acc: 0.707
Validation loss decreased (-0.707395 --> -0.707395).  Saving model ...
Epoch: 63 cost time: 0.6624038219451904
Epoch: 63, Steps: 2 | Train Loss: 0.572 Vali Loss: 1.242 Vali Acc: 0.711 Test Loss: 1.242 Test Acc: 0.711
Validation loss decreased (-0.707395 --> -0.711099).  Saving model ...
Epoch: 64 cost time: 0.7813947200775146
Epoch: 64, Steps: 2 | Train Loss: 0.531 Vali Loss: 1.232 Vali Acc: 0.719 Test Loss: 1.232 Test Acc: 0.719
Validation loss decreased (-0.711099 --> -0.718506).  Saving model ...
Epoch: 65 cost time: 0.696718692779541
Epoch: 65, Steps: 2 | Train Loss: 0.491 Vali Loss: 1.223 Vali Acc: 0.719 Test Loss: 1.223 Test Acc: 0.719
Validation loss decreased (-0.718506 --> -0.718506).  Saving model ...
Epoch: 66 cost time: 0.6716964244842529
Epoch: 66, Steps: 2 | Train Loss: 0.499 Vali Loss: 1.214 Vali Acc: 0.722 Test Loss: 1.214 Test Acc: 0.722
Validation loss decreased (-0.718506 --> -0.722210).  Saving model ...
Epoch: 67 cost time: 0.5051782131195068
Epoch: 67, Steps: 2 | Train Loss: 0.490 Vali Loss: 1.205 Vali Acc: 0.719 Test Loss: 1.205 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7574057579040527
Epoch: 68, Steps: 2 | Train Loss: 0.466 Vali Loss: 1.196 Vali Acc: 0.719 Test Loss: 1.196 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.723466157913208
Epoch: 69, Steps: 2 | Train Loss: 0.444 Vali Loss: 1.187 Vali Acc: 0.719 Test Loss: 1.187 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.693077564239502
Epoch: 70, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.178 Vali Acc: 0.719 Test Loss: 1.178 Test Acc: 0.719
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.792011022567749
Epoch: 71, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.169 Vali Acc: 0.715 Test Loss: 1.169 Test Acc: 0.715
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8273746967315674
Epoch: 72, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.161 Vali Acc: 0.715 Test Loss: 1.161 Test Acc: 0.715
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7923836708068848
Epoch: 73, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.152 Vali Acc: 0.719 Test Loss: 1.152 Test Acc: 0.719
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.6349637508392334
Epoch: 74, Steps: 2 | Train Loss: 0.380 Vali Loss: 1.144 Vali Acc: 0.726 Test Loss: 1.144 Test Acc: 0.726
Validation loss decreased (-0.722210 --> -0.725914).  Saving model ...
Epoch: 75 cost time: 0.7434682846069336
Epoch: 75, Steps: 2 | Train Loss: 0.374 Vali Loss: 1.136 Vali Acc: 0.722 Test Loss: 1.136 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.772819995880127
Epoch: 76, Steps: 2 | Train Loss: 0.351 Vali Loss: 1.128 Vali Acc: 0.730 Test Loss: 1.128 Test Acc: 0.730
Validation loss decreased (-0.725914 --> -0.729618).  Saving model ...
Epoch: 77 cost time: 0.6851687431335449
Epoch: 77, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.120 Vali Acc: 0.730 Test Loss: 1.120 Test Acc: 0.730
Validation loss decreased (-0.729618 --> -0.729618).  Saving model ...
Epoch: 78 cost time: 0.8997585773468018
Epoch: 78, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.113 Vali Acc: 0.726 Test Loss: 1.113 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6373100280761719
Epoch: 79, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.105 Vali Acc: 0.733 Test Loss: 1.105 Test Acc: 0.733
Validation loss decreased (-0.729618 --> -0.733322).  Saving model ...
Epoch: 80 cost time: 0.7263050079345703
Epoch: 80, Steps: 2 | Train Loss: 0.312 Vali Loss: 1.098 Vali Acc: 0.726 Test Loss: 1.098 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8244478702545166
Epoch: 81, Steps: 2 | Train Loss: 0.309 Vali Loss: 1.090 Vali Acc: 0.722 Test Loss: 1.090 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.983973503112793
Epoch: 82, Steps: 2 | Train Loss: 0.275 Vali Loss: 1.084 Vali Acc: 0.722 Test Loss: 1.084 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.6540193557739258
Epoch: 83, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.6997489929199219
Epoch: 84, Steps: 2 | Train Loss: 0.260 Vali Loss: 1.071 Vali Acc: 0.722 Test Loss: 1.071 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.7228302955627441
Epoch: 85, Steps: 2 | Train Loss: 0.253 Vali Loss: 1.065 Vali Acc: 0.726 Test Loss: 1.065 Test Acc: 0.726
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.706162691116333
Epoch: 86, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.059 Vali Acc: 0.730 Test Loss: 1.059 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.7463791370391846
Epoch: 87, Steps: 2 | Train Loss: 0.247 Vali Loss: 1.053 Vali Acc: 0.730 Test Loss: 1.053 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.8793892860412598
Epoch: 88, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.047 Vali Acc: 0.730 Test Loss: 1.047 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.5853109359741211
Epoch: 89, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.041 Vali Acc: 0.733 Test Loss: 1.041 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733323).  Saving model ...
Epoch: 90 cost time: 0.766963005065918
Epoch: 90, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.035 Vali Acc: 0.733 Test Loss: 1.035 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 91 cost time: 0.6728329658508301
Epoch: 91, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.030 Vali Acc: 0.733 Test Loss: 1.030 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 92 cost time: 0.5647914409637451
Epoch: 92, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.024 Vali Acc: 0.737 Test Loss: 1.024 Test Acc: 0.737
Validation loss decreased (-0.733323 --> -0.737027).  Saving model ...
Epoch: 93 cost time: 0.7877364158630371
Epoch: 93, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.019 Vali Acc: 0.733 Test Loss: 1.019 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.6192176342010498
Epoch: 94, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.014 Vali Acc: 0.733 Test Loss: 1.014 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.6956868171691895
Epoch: 95, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.009 Vali Acc: 0.730 Test Loss: 1.009 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.6702611446380615
Epoch: 96, Steps: 2 | Train Loss: 0.181 Vali Loss: 1.005 Vali Acc: 0.730 Test Loss: 1.005 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.8614003658294678
Epoch: 97, Steps: 2 | Train Loss: 0.180 Vali Loss: 1.000 Vali Acc: 0.726 Test Loss: 1.000 Test Acc: 0.726
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.7812974452972412
Epoch: 98, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.995 Vali Acc: 0.730 Test Loss: 0.995 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.5904703140258789
Epoch: 99, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.991 Vali Acc: 0.730 Test Loss: 0.991 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.6418588161468506
Epoch: 100, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.987 Vali Acc: 0.726 Test Loss: 0.987 Test Acc: 0.726
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.737037037037037
model parameter : 35300
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9684414863586426
Epoch: 1, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.805 Vali Acc: 0.196 Test Loss: 1.805 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.7434492111206055
Epoch: 2, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.800 Vali Acc: 0.200 Test Loss: 1.800 Test Acc: 0.200
Validation loss decreased (-0.196278 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6024527549743652
Epoch: 3, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.794 Vali Acc: 0.207 Test Loss: 1.794 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207389).  Saving model ...
Epoch: 4 cost time: 0.6436045169830322
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.788 Vali Acc: 0.207 Test Loss: 1.788 Test Acc: 0.207
Validation loss decreased (-0.207389 --> -0.207390).  Saving model ...
Epoch: 5 cost time: 0.5765962600708008
Epoch: 5, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.780 Vali Acc: 0.215 Test Loss: 1.780 Test Acc: 0.215
Validation loss decreased (-0.207390 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 0.6028456687927246
Epoch: 6, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.771 Vali Acc: 0.215 Test Loss: 1.771 Test Acc: 0.215
Validation loss decreased (-0.214797 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.9902420043945312
Epoch: 7, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.760 Vali Acc: 0.211 Test Loss: 1.760 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8139255046844482
Epoch: 8, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.749 Vali Acc: 0.226 Test Loss: 1.749 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.8729393482208252
Epoch: 9, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.737 Vali Acc: 0.244 Test Loss: 1.737 Test Acc: 0.244
Validation loss decreased (-0.225908 --> -0.244427).  Saving model ...
Epoch: 10 cost time: 0.6996443271636963
Epoch: 10, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.724 Vali Acc: 0.248 Test Loss: 1.724 Test Acc: 0.248
Validation loss decreased (-0.244427 --> -0.248131).  Saving model ...
Epoch: 11 cost time: 0.8298711776733398
Epoch: 11, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.710 Vali Acc: 0.281 Test Loss: 1.710 Test Acc: 0.281
Validation loss decreased (-0.248131 --> -0.281464).  Saving model ...
Epoch: 12 cost time: 0.6538596153259277
Epoch: 12, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.697 Vali Acc: 0.304 Test Loss: 1.697 Test Acc: 0.304
Validation loss decreased (-0.281464 --> -0.303687).  Saving model ...
Epoch: 13 cost time: 0.6529538631439209
Epoch: 13, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.683 Vali Acc: 0.326 Test Loss: 1.683 Test Acc: 0.326
Validation loss decreased (-0.303687 --> -0.325909).  Saving model ...
Epoch: 14 cost time: 0.8109617233276367
Epoch: 14, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.669 Vali Acc: 0.337 Test Loss: 1.669 Test Acc: 0.337
Validation loss decreased (-0.325909 --> -0.337020).  Saving model ...
Epoch: 15 cost time: 0.8569881916046143
Epoch: 15, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.655 Vali Acc: 0.344 Test Loss: 1.655 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344428).  Saving model ...
Epoch: 16 cost time: 0.8576998710632324
Epoch: 16, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.642 Vali Acc: 0.374 Test Loss: 1.642 Test Acc: 0.374
Validation loss decreased (-0.344428 --> -0.374058).  Saving model ...
Epoch: 17 cost time: 0.8575336933135986
Epoch: 17, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.628 Vali Acc: 0.400 Test Loss: 1.628 Test Acc: 0.400
Validation loss decreased (-0.374058 --> -0.399984).  Saving model ...
Epoch: 18 cost time: 0.7099475860595703
Epoch: 18, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.616 Vali Acc: 0.422 Test Loss: 1.616 Test Acc: 0.422
Validation loss decreased (-0.399984 --> -0.422206).  Saving model ...
Epoch: 19 cost time: 0.845350980758667
Epoch: 19, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.603 Vali Acc: 0.448 Test Loss: 1.603 Test Acc: 0.448
Validation loss decreased (-0.422206 --> -0.448132).  Saving model ...
Epoch: 20 cost time: 0.7510006427764893
Epoch: 20, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.590 Vali Acc: 0.456 Test Loss: 1.590 Test Acc: 0.456
Validation loss decreased (-0.448132 --> -0.455540).  Saving model ...
Epoch: 21 cost time: 0.7326564788818359
Epoch: 21, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.578 Vali Acc: 0.467 Test Loss: 1.578 Test Acc: 0.467
Validation loss decreased (-0.455540 --> -0.466651).  Saving model ...
Epoch: 22 cost time: 0.7815403938293457
Epoch: 22, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.567 Vali Acc: 0.481 Test Loss: 1.567 Test Acc: 0.481
Validation loss decreased (-0.466651 --> -0.481466).  Saving model ...
Epoch: 23 cost time: 0.6745517253875732
Epoch: 23, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.554 Vali Acc: 0.493 Test Loss: 1.554 Test Acc: 0.493
Validation loss decreased (-0.481466 --> -0.492577).  Saving model ...
Epoch: 24 cost time: 0.7527272701263428
Epoch: 24, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.543 Vali Acc: 0.493 Test Loss: 1.543 Test Acc: 0.493
Validation loss decreased (-0.492577 --> -0.492577).  Saving model ...
Epoch: 25 cost time: 1.072925329208374
Epoch: 25, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.531 Vali Acc: 0.493 Test Loss: 1.531 Test Acc: 0.493
Validation loss decreased (-0.492577 --> -0.492577).  Saving model ...
Epoch: 26 cost time: 0.7070634365081787
Epoch: 26, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.520 Vali Acc: 0.500 Test Loss: 1.520 Test Acc: 0.500
Validation loss decreased (-0.492577 --> -0.499985).  Saving model ...
Epoch: 27 cost time: 0.875495195388794
Epoch: 27, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.508 Vali Acc: 0.511 Test Loss: 1.508 Test Acc: 0.511
Validation loss decreased (-0.499985 --> -0.511096).  Saving model ...
Epoch: 28 cost time: 0.6923582553863525
Epoch: 28, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.496 Vali Acc: 0.515 Test Loss: 1.496 Test Acc: 0.515
Validation loss decreased (-0.511096 --> -0.514800).  Saving model ...
Epoch: 29 cost time: 0.7640347480773926
Epoch: 29, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.485 Vali Acc: 0.522 Test Loss: 1.485 Test Acc: 0.522
Validation loss decreased (-0.514800 --> -0.522207).  Saving model ...
Epoch: 30 cost time: 0.7381711006164551
Epoch: 30, Steps: 2 | Train Loss: 0.851 Vali Loss: 1.475 Vali Acc: 0.541 Test Loss: 1.475 Test Acc: 0.541
Validation loss decreased (-0.522207 --> -0.540726).  Saving model ...
Epoch: 31 cost time: 0.6920783519744873
Epoch: 31, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.464 Vali Acc: 0.544 Test Loss: 1.464 Test Acc: 0.544
Validation loss decreased (-0.540726 --> -0.544430).  Saving model ...
Epoch: 32 cost time: 0.7458953857421875
Epoch: 32, Steps: 2 | Train Loss: 0.795 Vali Loss: 1.454 Vali Acc: 0.552 Test Loss: 1.454 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551837).  Saving model ...
Epoch: 33 cost time: 0.7664179801940918
Epoch: 33, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.445 Vali Acc: 0.559 Test Loss: 1.445 Test Acc: 0.559
Validation loss decreased (-0.551837 --> -0.559245).  Saving model ...
Epoch: 34 cost time: 0.6339294910430908
Epoch: 34, Steps: 2 | Train Loss: 0.704 Vali Loss: 1.436 Vali Acc: 0.574 Test Loss: 1.436 Test Acc: 0.574
Validation loss decreased (-0.559245 --> -0.574060).  Saving model ...
Epoch: 35 cost time: 0.8120458126068115
Epoch: 35, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.429 Vali Acc: 0.574 Test Loss: 1.429 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 36 cost time: 0.7356369495391846
Epoch: 36, Steps: 2 | Train Loss: 0.675 Vali Loss: 1.421 Vali Acc: 0.574 Test Loss: 1.421 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 37 cost time: 0.7524940967559814
Epoch: 37, Steps: 2 | Train Loss: 0.688 Vali Loss: 1.413 Vali Acc: 0.581 Test Loss: 1.413 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581467).  Saving model ...
Epoch: 38 cost time: 0.8370461463928223
Epoch: 38, Steps: 2 | Train Loss: 0.654 Vali Loss: 1.405 Vali Acc: 0.578 Test Loss: 1.405 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6604568958282471
Epoch: 39, Steps: 2 | Train Loss: 0.621 Vali Loss: 1.398 Vali Acc: 0.578 Test Loss: 1.398 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7524402141571045
Epoch: 40, Steps: 2 | Train Loss: 0.591 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
Validation loss decreased (-0.581467 --> -0.581468).  Saving model ...
Epoch: 41 cost time: 0.7851927280426025
Epoch: 41, Steps: 2 | Train Loss: 0.576 Vali Loss: 1.384 Vali Acc: 0.581 Test Loss: 1.384 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581468).  Saving model ...
Epoch: 42 cost time: 0.6827828884124756
Epoch: 42, Steps: 2 | Train Loss: 0.565 Vali Loss: 1.374 Vali Acc: 0.581 Test Loss: 1.374 Test Acc: 0.581
Validation loss decreased (-0.581468 --> -0.581468).  Saving model ...
Epoch: 43 cost time: 0.8794841766357422
Epoch: 43, Steps: 2 | Train Loss: 0.561 Vali Loss: 1.366 Vali Acc: 0.585 Test Loss: 1.366 Test Acc: 0.585
Validation loss decreased (-0.581468 --> -0.585172).  Saving model ...
Epoch: 44 cost time: 0.7034413814544678
Epoch: 44, Steps: 2 | Train Loss: 0.551 Vali Loss: 1.358 Vali Acc: 0.593 Test Loss: 1.358 Test Acc: 0.593
Validation loss decreased (-0.585172 --> -0.592579).  Saving model ...
Epoch: 45 cost time: 0.8592455387115479
Epoch: 45, Steps: 2 | Train Loss: 0.510 Vali Loss: 1.350 Vali Acc: 0.585 Test Loss: 1.350 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9732379913330078
Epoch: 46, Steps: 2 | Train Loss: 0.487 Vali Loss: 1.342 Vali Acc: 0.596 Test Loss: 1.342 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 47 cost time: 0.7852180004119873
Epoch: 47, Steps: 2 | Train Loss: 0.493 Vali Loss: 1.335 Vali Acc: 0.604 Test Loss: 1.335 Test Acc: 0.604
Validation loss decreased (-0.596283 --> -0.603690).  Saving model ...
Epoch: 48 cost time: 0.7899329662322998
Epoch: 48, Steps: 2 | Train Loss: 0.455 Vali Loss: 1.328 Vali Acc: 0.604 Test Loss: 1.328 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 49 cost time: 0.7066755294799805
Epoch: 49, Steps: 2 | Train Loss: 0.425 Vali Loss: 1.321 Vali Acc: 0.604 Test Loss: 1.321 Test Acc: 0.604
Validation loss decreased (-0.603690 --> -0.603690).  Saving model ...
Epoch: 50 cost time: 0.6751625537872314
Epoch: 50, Steps: 2 | Train Loss: 0.429 Vali Loss: 1.314 Vali Acc: 0.607 Test Loss: 1.314 Test Acc: 0.607
Validation loss decreased (-0.603690 --> -0.607394).  Saving model ...
Epoch: 51 cost time: 0.6808145046234131
Epoch: 51, Steps: 2 | Train Loss: 0.414 Vali Loss: 1.306 Vali Acc: 0.600 Test Loss: 1.306 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7479782104492188
Epoch: 52, Steps: 2 | Train Loss: 0.386 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.909649133682251
Epoch: 53, Steps: 2 | Train Loss: 0.366 Vali Loss: 1.293 Vali Acc: 0.600 Test Loss: 1.293 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8071341514587402
Epoch: 54, Steps: 2 | Train Loss: 0.373 Vali Loss: 1.286 Vali Acc: 0.596 Test Loss: 1.286 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8199284076690674
Epoch: 55, Steps: 2 | Train Loss: 0.343 Vali Loss: 1.280 Vali Acc: 0.600 Test Loss: 1.280 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9132668972015381
Epoch: 56, Steps: 2 | Train Loss: 0.348 Vali Loss: 1.274 Vali Acc: 0.604 Test Loss: 1.274 Test Acc: 0.604
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.005192756652832
Epoch: 57, Steps: 2 | Train Loss: 0.323 Vali Loss: 1.269 Vali Acc: 0.607 Test Loss: 1.269 Test Acc: 0.607
Validation loss decreased (-0.607394 --> -0.607395).  Saving model ...
Epoch: 58 cost time: 0.7339494228363037
Epoch: 58, Steps: 2 | Train Loss: 0.316 Vali Loss: 1.263 Vali Acc: 0.607 Test Loss: 1.263 Test Acc: 0.607
Validation loss decreased (-0.607395 --> -0.607395).  Saving model ...
Epoch: 59 cost time: 0.7176599502563477
Epoch: 59, Steps: 2 | Train Loss: 0.305 Vali Loss: 1.258 Vali Acc: 0.607 Test Loss: 1.258 Test Acc: 0.607
Validation loss decreased (-0.607395 --> -0.607395).  Saving model ...
Epoch: 60 cost time: 0.5897269248962402
Epoch: 60, Steps: 2 | Train Loss: 0.294 Vali Loss: 1.253 Vali Acc: 0.611 Test Loss: 1.253 Test Acc: 0.611
Validation loss decreased (-0.607395 --> -0.611099).  Saving model ...
Epoch: 61 cost time: 0.7472817897796631
Epoch: 61, Steps: 2 | Train Loss: 0.282 Vali Loss: 1.249 Vali Acc: 0.611 Test Loss: 1.249 Test Acc: 0.611
Validation loss decreased (-0.611099 --> -0.611099).  Saving model ...
Epoch: 62 cost time: 0.9120602607727051
Epoch: 62, Steps: 2 | Train Loss: 0.294 Vali Loss: 1.244 Vali Acc: 0.615 Test Loss: 1.244 Test Acc: 0.615
Validation loss decreased (-0.611099 --> -0.614802).  Saving model ...
Epoch: 63 cost time: 0.9042446613311768
Epoch: 63, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.239 Vali Acc: 0.615 Test Loss: 1.239 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 64 cost time: 1.094512939453125
Epoch: 64, Steps: 2 | Train Loss: 0.255 Vali Loss: 1.234 Vali Acc: 0.619 Test Loss: 1.234 Test Acc: 0.619
Validation loss decreased (-0.614802 --> -0.618506).  Saving model ...
Epoch: 65 cost time: 0.7122745513916016
Epoch: 65, Steps: 2 | Train Loss: 0.243 Vali Loss: 1.229 Vali Acc: 0.619 Test Loss: 1.229 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 66 cost time: 0.848473310470581
Epoch: 66, Steps: 2 | Train Loss: 0.240 Vali Loss: 1.224 Vali Acc: 0.626 Test Loss: 1.224 Test Acc: 0.626
Validation loss decreased (-0.618506 --> -0.625914).  Saving model ...
Epoch: 67 cost time: 0.8391218185424805
Epoch: 67, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.221 Vali Acc: 0.626 Test Loss: 1.221 Test Acc: 0.626
Validation loss decreased (-0.625914 --> -0.625914).  Saving model ...
Epoch: 68 cost time: 0.7670097351074219
Epoch: 68, Steps: 2 | Train Loss: 0.219 Vali Loss: 1.217 Vali Acc: 0.619 Test Loss: 1.217 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8097505569458008
Epoch: 69, Steps: 2 | Train Loss: 0.215 Vali Loss: 1.213 Vali Acc: 0.619 Test Loss: 1.213 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.7756357192993164
Epoch: 70, Steps: 2 | Train Loss: 0.211 Vali Loss: 1.210 Vali Acc: 0.622 Test Loss: 1.210 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8473217487335205
Epoch: 71, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.207 Vali Acc: 0.622 Test Loss: 1.207 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.026308298110962
Epoch: 72, Steps: 2 | Train Loss: 0.192 Vali Loss: 1.204 Vali Acc: 0.619 Test Loss: 1.204 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7832159996032715
Epoch: 73, Steps: 2 | Train Loss: 0.186 Vali Loss: 1.200 Vali Acc: 0.619 Test Loss: 1.200 Test Acc: 0.619
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7201492786407471
Epoch: 74, Steps: 2 | Train Loss: 0.176 Vali Loss: 1.196 Vali Acc: 0.622 Test Loss: 1.196 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7467947006225586
Epoch: 75, Steps: 2 | Train Loss: 0.174 Vali Loss: 1.192 Vali Acc: 0.622 Test Loss: 1.192 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.9247362613677979
Epoch: 76, Steps: 2 | Train Loss: 0.187 Vali Loss: 1.187 Vali Acc: 0.619 Test Loss: 1.187 Test Acc: 0.619
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.8956282138824463
Epoch: 77, Steps: 2 | Train Loss: 0.162 Vali Loss: 1.183 Vali Acc: 0.622 Test Loss: 1.183 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w9_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6259259259259259
model parameter : 37304
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9506783485412598
Epoch: 1, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.889 Vali Acc: 0.133 Test Loss: 1.889 Test Acc: 0.133
Validation loss decreased (inf --> -0.133314).  Saving model ...
Epoch: 2 cost time: 0.6661539077758789
Epoch: 2, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.885 Vali Acc: 0.141 Test Loss: 1.885 Test Acc: 0.141
Validation loss decreased (-0.133314 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 0.7301154136657715
Epoch: 3, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.880 Vali Acc: 0.144 Test Loss: 1.880 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 0.6804251670837402
Epoch: 4, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.875 Vali Acc: 0.144 Test Loss: 1.875 Test Acc: 0.144
Validation loss decreased (-0.144426 --> -0.144426).  Saving model ...
Epoch: 5 cost time: 0.8032543659210205
Epoch: 5, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.869 Vali Acc: 0.144 Test Loss: 1.869 Test Acc: 0.144
Validation loss decreased (-0.144426 --> -0.144426).  Saving model ...
Epoch: 6 cost time: 0.6266591548919678
Epoch: 6, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.861 Vali Acc: 0.144 Test Loss: 1.861 Test Acc: 0.144
Validation loss decreased (-0.144426 --> -0.144426).  Saving model ...
Epoch: 7 cost time: 0.5898013114929199
Epoch: 7, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.853 Vali Acc: 0.148 Test Loss: 1.853 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148130).  Saving model ...
Epoch: 8 cost time: 0.6183207035064697
Epoch: 8, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.844 Vali Acc: 0.159 Test Loss: 1.844 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159241).  Saving model ...
Epoch: 9 cost time: 0.6465713977813721
Epoch: 9, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.834 Vali Acc: 0.167 Test Loss: 1.834 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166648).  Saving model ...
Epoch: 10 cost time: 0.8185429573059082
Epoch: 10, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.825 Vali Acc: 0.189 Test Loss: 1.825 Test Acc: 0.189
Validation loss decreased (-0.166648 --> -0.188871).  Saving model ...
Epoch: 11 cost time: 0.6462080478668213
Epoch: 11, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.814 Vali Acc: 0.207 Test Loss: 1.814 Test Acc: 0.207
Validation loss decreased (-0.188871 --> -0.207389).  Saving model ...
Epoch: 12 cost time: 0.8756422996520996
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.802 Vali Acc: 0.219 Test Loss: 1.802 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218501).  Saving model ...
Epoch: 13 cost time: 0.6951174736022949
Epoch: 13, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.790 Vali Acc: 0.222 Test Loss: 1.790 Test Acc: 0.222
Validation loss decreased (-0.218501 --> -0.222204).  Saving model ...
Epoch: 14 cost time: 0.8912801742553711
Epoch: 14, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.778 Vali Acc: 0.230 Test Loss: 1.778 Test Acc: 0.230
Validation loss decreased (-0.222204 --> -0.229612).  Saving model ...
Epoch: 15 cost time: 1.0019590854644775
Epoch: 15, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.767 Vali Acc: 0.233 Test Loss: 1.767 Test Acc: 0.233
Validation loss decreased (-0.229612 --> -0.233316).  Saving model ...
Epoch: 16 cost time: 0.7591135501861572
Epoch: 16, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.755 Vali Acc: 0.241 Test Loss: 1.755 Test Acc: 0.241
Validation loss decreased (-0.233316 --> -0.240723).  Saving model ...
Epoch: 17 cost time: 0.8885204792022705
Epoch: 17, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.743 Vali Acc: 0.259 Test Loss: 1.743 Test Acc: 0.259
Validation loss decreased (-0.240723 --> -0.259242).  Saving model ...
Epoch: 18 cost time: 0.8712053298950195
Epoch: 18, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.731 Vali Acc: 0.270 Test Loss: 1.731 Test Acc: 0.270
Validation loss decreased (-0.259242 --> -0.270353).  Saving model ...
Epoch: 19 cost time: 0.956007719039917
Epoch: 19, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.720 Vali Acc: 0.289 Test Loss: 1.720 Test Acc: 0.289
Validation loss decreased (-0.270353 --> -0.288872).  Saving model ...
Epoch: 20 cost time: 0.9920203685760498
Epoch: 20, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.708 Vali Acc: 0.296 Test Loss: 1.708 Test Acc: 0.296
Validation loss decreased (-0.288872 --> -0.296279).  Saving model ...
Epoch: 21 cost time: 0.7533314228057861
Epoch: 21, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.696 Vali Acc: 0.300 Test Loss: 1.696 Test Acc: 0.300
Validation loss decreased (-0.296279 --> -0.299983).  Saving model ...
Epoch: 22 cost time: 0.8477394580841064
Epoch: 22, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.685 Vali Acc: 0.330 Test Loss: 1.685 Test Acc: 0.330
Validation loss decreased (-0.299983 --> -0.329613).  Saving model ...
Epoch: 23 cost time: 0.7651650905609131
Epoch: 23, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.674 Vali Acc: 0.344 Test Loss: 1.674 Test Acc: 0.344
Validation loss decreased (-0.329613 --> -0.344428).  Saving model ...
Epoch: 24 cost time: 0.9548454284667969
Epoch: 24, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.664 Vali Acc: 0.359 Test Loss: 1.664 Test Acc: 0.359
Validation loss decreased (-0.344428 --> -0.359243).  Saving model ...
Epoch: 25 cost time: 0.8898401260375977
Epoch: 25, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.654 Vali Acc: 0.370 Test Loss: 1.654 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370354).  Saving model ...
Epoch: 26 cost time: 0.6297934055328369
Epoch: 26, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.642 Vali Acc: 0.385 Test Loss: 1.642 Test Acc: 0.385
Validation loss decreased (-0.370354 --> -0.385169).  Saving model ...
Epoch: 27 cost time: 0.8071227073669434
Epoch: 27, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.632 Vali Acc: 0.419 Test Loss: 1.632 Test Acc: 0.419
Validation loss decreased (-0.385169 --> -0.418502).  Saving model ...
Epoch: 28 cost time: 0.7443902492523193
Epoch: 28, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.621 Vali Acc: 0.426 Test Loss: 1.621 Test Acc: 0.426
Validation loss decreased (-0.418502 --> -0.425910).  Saving model ...
Epoch: 29 cost time: 0.9519703388214111
Epoch: 29, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.610 Vali Acc: 0.433 Test Loss: 1.610 Test Acc: 0.433
Validation loss decreased (-0.425910 --> -0.433317).  Saving model ...
Epoch: 30 cost time: 0.7735776901245117
Epoch: 30, Steps: 2 | Train Loss: 0.883 Vali Loss: 1.599 Vali Acc: 0.459 Test Loss: 1.599 Test Acc: 0.459
Validation loss decreased (-0.433317 --> -0.459243).  Saving model ...
Epoch: 31 cost time: 0.7499687671661377
Epoch: 31, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.588 Vali Acc: 0.470 Test Loss: 1.588 Test Acc: 0.470
Validation loss decreased (-0.459243 --> -0.470354).  Saving model ...
Epoch: 32 cost time: 0.7729225158691406
Epoch: 32, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.577 Vali Acc: 0.470 Test Loss: 1.577 Test Acc: 0.470
Validation loss decreased (-0.470354 --> -0.470355).  Saving model ...
Epoch: 33 cost time: 0.8678653240203857
Epoch: 33, Steps: 2 | Train Loss: 0.776 Vali Loss: 1.567 Vali Acc: 0.493 Test Loss: 1.567 Test Acc: 0.493
Validation loss decreased (-0.470355 --> -0.492577).  Saving model ...
Epoch: 34 cost time: 1.067901372909546
Epoch: 34, Steps: 2 | Train Loss: 0.742 Vali Loss: 1.557 Vali Acc: 0.500 Test Loss: 1.557 Test Acc: 0.500
Validation loss decreased (-0.492577 --> -0.499984).  Saving model ...
Epoch: 35 cost time: 0.8851628303527832
Epoch: 35, Steps: 2 | Train Loss: 0.760 Vali Loss: 1.547 Vali Acc: 0.537 Test Loss: 1.547 Test Acc: 0.537
Validation loss decreased (-0.499984 --> -0.537022).  Saving model ...
Epoch: 36 cost time: 0.8974287509918213
Epoch: 36, Steps: 2 | Train Loss: 0.702 Vali Loss: 1.538 Vali Acc: 0.544 Test Loss: 1.538 Test Acc: 0.544
Validation loss decreased (-0.537022 --> -0.544429).  Saving model ...
Epoch: 37 cost time: 0.7218930721282959
Epoch: 37, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.529 Vali Acc: 0.537 Test Loss: 1.529 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7516250610351562
Epoch: 38, Steps: 2 | Train Loss: 0.680 Vali Loss: 1.522 Vali Acc: 0.548 Test Loss: 1.522 Test Acc: 0.548
Validation loss decreased (-0.544429 --> -0.548133).  Saving model ...
Epoch: 39 cost time: 0.6564412117004395
Epoch: 39, Steps: 2 | Train Loss: 0.635 Vali Loss: 1.514 Vali Acc: 0.548 Test Loss: 1.514 Test Acc: 0.548
Validation loss decreased (-0.548133 --> -0.548133).  Saving model ...
Epoch: 40 cost time: 0.8068230152130127
Epoch: 40, Steps: 2 | Train Loss: 0.628 Vali Loss: 1.506 Vali Acc: 0.552 Test Loss: 1.506 Test Acc: 0.552
Validation loss decreased (-0.548133 --> -0.551837).  Saving model ...
Epoch: 41 cost time: 0.7515029907226562
Epoch: 41, Steps: 2 | Train Loss: 0.582 Vali Loss: 1.499 Vali Acc: 0.559 Test Loss: 1.499 Test Acc: 0.559
Validation loss decreased (-0.551837 --> -0.559244).  Saving model ...
Epoch: 42 cost time: 0.9562172889709473
Epoch: 42, Steps: 2 | Train Loss: 0.574 Vali Loss: 1.491 Vali Acc: 0.570 Test Loss: 1.491 Test Acc: 0.570
Validation loss decreased (-0.559244 --> -0.570355).  Saving model ...
Epoch: 43 cost time: 0.6828064918518066
Epoch: 43, Steps: 2 | Train Loss: 0.561 Vali Loss: 1.484 Vali Acc: 0.567 Test Loss: 1.484 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9117109775543213
Epoch: 44, Steps: 2 | Train Loss: 0.546 Vali Loss: 1.476 Vali Acc: 0.563 Test Loss: 1.476 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7791247367858887
Epoch: 45, Steps: 2 | Train Loss: 0.513 Vali Loss: 1.469 Vali Acc: 0.570 Test Loss: 1.469 Test Acc: 0.570
Validation loss decreased (-0.570355 --> -0.570356).  Saving model ...
Epoch: 46 cost time: 0.6740245819091797
Epoch: 46, Steps: 2 | Train Loss: 0.501 Vali Loss: 1.461 Vali Acc: 0.578 Test Loss: 1.461 Test Acc: 0.578
Validation loss decreased (-0.570356 --> -0.577763).  Saving model ...
Epoch: 47 cost time: 0.6200900077819824
Epoch: 47, Steps: 2 | Train Loss: 0.463 Vali Loss: 1.453 Vali Acc: 0.570 Test Loss: 1.453 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7927677631378174
Epoch: 48, Steps: 2 | Train Loss: 0.447 Vali Loss: 1.445 Vali Acc: 0.578 Test Loss: 1.445 Test Acc: 0.578
Validation loss decreased (-0.577763 --> -0.577763).  Saving model ...
Epoch: 49 cost time: 0.9166548252105713
Epoch: 49, Steps: 2 | Train Loss: 0.427 Vali Loss: 1.436 Vali Acc: 0.585 Test Loss: 1.436 Test Acc: 0.585
Validation loss decreased (-0.577763 --> -0.585171).  Saving model ...
Epoch: 50 cost time: 0.7156350612640381
Epoch: 50, Steps: 2 | Train Loss: 0.406 Vali Loss: 1.429 Vali Acc: 0.593 Test Loss: 1.429 Test Acc: 0.593
Validation loss decreased (-0.585171 --> -0.592578).  Saving model ...
Epoch: 51 cost time: 0.7756423950195312
Epoch: 51, Steps: 2 | Train Loss: 0.421 Vali Loss: 1.422 Vali Acc: 0.600 Test Loss: 1.422 Test Acc: 0.600
Validation loss decreased (-0.592578 --> -0.599986).  Saving model ...
Epoch: 52 cost time: 0.7885446548461914
Epoch: 52, Steps: 2 | Train Loss: 0.377 Vali Loss: 1.415 Vali Acc: 0.596 Test Loss: 1.415 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7524621486663818
Epoch: 53, Steps: 2 | Train Loss: 0.363 Vali Loss: 1.409 Vali Acc: 0.600 Test Loss: 1.409 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 54 cost time: 0.690176248550415
Epoch: 54, Steps: 2 | Train Loss: 0.368 Vali Loss: 1.403 Vali Acc: 0.596 Test Loss: 1.403 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7638645172119141
Epoch: 55, Steps: 2 | Train Loss: 0.331 Vali Loss: 1.398 Vali Acc: 0.596 Test Loss: 1.398 Test Acc: 0.596
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7842838764190674
Epoch: 56, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.393 Vali Acc: 0.600 Test Loss: 1.393 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 57 cost time: 0.6660144329071045
Epoch: 57, Steps: 2 | Train Loss: 0.321 Vali Loss: 1.387 Vali Acc: 0.607 Test Loss: 1.387 Test Acc: 0.607
Validation loss decreased (-0.599986 --> -0.607394).  Saving model ...
Epoch: 58 cost time: 0.7766504287719727
Epoch: 58, Steps: 2 | Train Loss: 0.307 Vali Loss: 1.382 Vali Acc: 0.600 Test Loss: 1.382 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7060940265655518
Epoch: 59, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.377 Vali Acc: 0.600 Test Loss: 1.377 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7714591026306152
Epoch: 60, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.371 Vali Acc: 0.600 Test Loss: 1.371 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.834111213684082
Epoch: 61, Steps: 2 | Train Loss: 0.269 Vali Loss: 1.365 Vali Acc: 0.607 Test Loss: 1.365 Test Acc: 0.607
Validation loss decreased (-0.607394 --> -0.607394).  Saving model ...
Epoch: 62 cost time: 0.8181717395782471
Epoch: 62, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.359 Vali Acc: 0.604 Test Loss: 1.359 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8007898330688477
Epoch: 63, Steps: 2 | Train Loss: 0.253 Vali Loss: 1.353 Vali Acc: 0.604 Test Loss: 1.353 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.016704797744751
Epoch: 64, Steps: 2 | Train Loss: 0.235 Vali Loss: 1.348 Vali Acc: 0.607 Test Loss: 1.348 Test Acc: 0.607
Validation loss decreased (-0.607394 --> -0.607394).  Saving model ...
Epoch: 65 cost time: 0.8748459815979004
Epoch: 65, Steps: 2 | Train Loss: 0.228 Vali Loss: 1.343 Vali Acc: 0.607 Test Loss: 1.343 Test Acc: 0.607
Validation loss decreased (-0.607394 --> -0.607394).  Saving model ...
Epoch: 66 cost time: 0.7750053405761719
Epoch: 66, Steps: 2 | Train Loss: 0.224 Vali Loss: 1.338 Vali Acc: 0.604 Test Loss: 1.338 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8460776805877686
Epoch: 67, Steps: 2 | Train Loss: 0.212 Vali Loss: 1.333 Vali Acc: 0.607 Test Loss: 1.333 Test Acc: 0.607
Validation loss decreased (-0.607394 --> -0.607394).  Saving model ...
Epoch: 68 cost time: 0.6982028484344482
Epoch: 68, Steps: 2 | Train Loss: 0.203 Vali Loss: 1.329 Vali Acc: 0.611 Test Loss: 1.329 Test Acc: 0.611
Validation loss decreased (-0.607394 --> -0.611098).  Saving model ...
Epoch: 69 cost time: 0.6835813522338867
Epoch: 69, Steps: 2 | Train Loss: 0.195 Vali Loss: 1.324 Vali Acc: 0.611 Test Loss: 1.324 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 70 cost time: 0.6873073577880859
Epoch: 70, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.319 Vali Acc: 0.611 Test Loss: 1.319 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 71 cost time: 1.125028133392334
Epoch: 71, Steps: 2 | Train Loss: 0.182 Vali Loss: 1.315 Vali Acc: 0.611 Test Loss: 1.315 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 72 cost time: 0.9042279720306396
Epoch: 72, Steps: 2 | Train Loss: 0.193 Vali Loss: 1.310 Vali Acc: 0.611 Test Loss: 1.310 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611098).  Saving model ...
Epoch: 73 cost time: 0.952174186706543
Epoch: 73, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.305 Vali Acc: 0.615 Test Loss: 1.305 Test Acc: 0.615
Validation loss decreased (-0.611098 --> -0.614802).  Saving model ...
Epoch: 74 cost time: 0.6950232982635498
Epoch: 74, Steps: 2 | Train Loss: 0.167 Vali Loss: 1.301 Vali Acc: 0.615 Test Loss: 1.301 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 75 cost time: 0.8565917015075684
Epoch: 75, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.297 Vali Acc: 0.615 Test Loss: 1.297 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 76 cost time: 0.7055032253265381
Epoch: 76, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.295 Vali Acc: 0.619 Test Loss: 1.295 Test Acc: 0.619
Validation loss decreased (-0.614802 --> -0.618506).  Saving model ...
Epoch: 77 cost time: 0.9617602825164795
Epoch: 77, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.292 Vali Acc: 0.619 Test Loss: 1.292 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 78 cost time: 0.7403812408447266
Epoch: 78, Steps: 2 | Train Loss: 0.148 Vali Loss: 1.290 Vali Acc: 0.619 Test Loss: 1.290 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 79 cost time: 0.9400453567504883
Epoch: 79, Steps: 2 | Train Loss: 0.142 Vali Loss: 1.288 Vali Acc: 0.619 Test Loss: 1.288 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 80 cost time: 0.865142822265625
Epoch: 80, Steps: 2 | Train Loss: 0.134 Vali Loss: 1.285 Vali Acc: 0.626 Test Loss: 1.285 Test Acc: 0.626
Validation loss decreased (-0.618506 --> -0.625913).  Saving model ...
Epoch: 81 cost time: 0.7160789966583252
Epoch: 81, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.283 Vali Acc: 0.626 Test Loss: 1.283 Test Acc: 0.626
Validation loss decreased (-0.625913 --> -0.625913).  Saving model ...
Epoch: 82 cost time: 0.8207006454467773
Epoch: 82, Steps: 2 | Train Loss: 0.127 Vali Loss: 1.280 Vali Acc: 0.622 Test Loss: 1.280 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8864078521728516
Epoch: 83, Steps: 2 | Train Loss: 0.126 Vali Loss: 1.278 Vali Acc: 0.622 Test Loss: 1.278 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.8964190483093262
Epoch: 84, Steps: 2 | Train Loss: 0.123 Vali Loss: 1.276 Vali Acc: 0.607 Test Loss: 1.276 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.7859799861907959
Epoch: 85, Steps: 2 | Train Loss: 0.120 Vali Loss: 1.274 Vali Acc: 0.611 Test Loss: 1.274 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.7535457611083984
Epoch: 86, Steps: 2 | Train Loss: 0.109 Vali Loss: 1.272 Vali Acc: 0.611 Test Loss: 1.272 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.9607534408569336
Epoch: 87, Steps: 2 | Train Loss: 0.106 Vali Loss: 1.270 Vali Acc: 0.615 Test Loss: 1.270 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.8862473964691162
Epoch: 88, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.268 Vali Acc: 0.615 Test Loss: 1.268 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.7121891975402832
Epoch: 89, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.265 Vali Acc: 0.615 Test Loss: 1.265 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.1156187057495117
Epoch: 90, Steps: 2 | Train Loss: 0.101 Vali Loss: 1.263 Vali Acc: 0.615 Test Loss: 1.263 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.8658871650695801
Epoch: 91, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.260 Vali Acc: 0.615 Test Loss: 1.260 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6259259259259259
model parameter : 36792
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.524091958999634
Epoch: 1, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.751 Vali Acc: 0.244 Test Loss: 1.751 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.7558598518371582
Epoch: 2, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.745 Vali Acc: 0.248 Test Loss: 1.745 Test Acc: 0.248
Validation loss decreased (-0.244427 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 0.8027193546295166
Epoch: 3, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.740 Vali Acc: 0.248 Test Loss: 1.740 Test Acc: 0.248
Validation loss decreased (-0.248131 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.8211362361907959
Epoch: 4, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.734 Vali Acc: 0.259 Test Loss: 1.734 Test Acc: 0.259
Validation loss decreased (-0.248131 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.8879330158233643
Epoch: 5, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.726 Vali Acc: 0.267 Test Loss: 1.726 Test Acc: 0.267
Validation loss decreased (-0.259242 --> -0.266649).  Saving model ...
Epoch: 6 cost time: 0.9118087291717529
Epoch: 6, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.717 Vali Acc: 0.281 Test Loss: 1.717 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281464).  Saving model ...
Epoch: 7 cost time: 0.827120304107666
Epoch: 7, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.706 Vali Acc: 0.293 Test Loss: 1.706 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292576).  Saving model ...
Epoch: 8 cost time: 0.6865212917327881
Epoch: 8, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.694 Vali Acc: 0.296 Test Loss: 1.694 Test Acc: 0.296
Validation loss decreased (-0.292576 --> -0.296279).  Saving model ...
Epoch: 9 cost time: 0.7840640544891357
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.682 Vali Acc: 0.315 Test Loss: 1.682 Test Acc: 0.315
Validation loss decreased (-0.296279 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.8599197864532471
Epoch: 10, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.670 Vali Acc: 0.330 Test Loss: 1.670 Test Acc: 0.330
Validation loss decreased (-0.314798 --> -0.329613).  Saving model ...
Epoch: 11 cost time: 0.6813335418701172
Epoch: 11, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.657 Vali Acc: 0.344 Test Loss: 1.657 Test Acc: 0.344
Validation loss decreased (-0.329613 --> -0.344428).  Saving model ...
Epoch: 12 cost time: 0.6307170391082764
Epoch: 12, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.645 Vali Acc: 0.356 Test Loss: 1.645 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355539).  Saving model ...
Epoch: 13 cost time: 0.7864081859588623
Epoch: 13, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.633 Vali Acc: 0.363 Test Loss: 1.633 Test Acc: 0.363
Validation loss decreased (-0.355539 --> -0.362947).  Saving model ...
Epoch: 14 cost time: 0.6435108184814453
Epoch: 14, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.622 Vali Acc: 0.378 Test Loss: 1.622 Test Acc: 0.378
Validation loss decreased (-0.362947 --> -0.377762).  Saving model ...
Epoch: 15 cost time: 0.8590192794799805
Epoch: 15, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.610 Vali Acc: 0.385 Test Loss: 1.610 Test Acc: 0.385
Validation loss decreased (-0.377762 --> -0.385169).  Saving model ...
Epoch: 16 cost time: 0.6866352558135986
Epoch: 16, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.597 Vali Acc: 0.393 Test Loss: 1.597 Test Acc: 0.393
Validation loss decreased (-0.385169 --> -0.392577).  Saving model ...
Epoch: 17 cost time: 0.5577118396759033
Epoch: 17, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.585 Vali Acc: 0.400 Test Loss: 1.585 Test Acc: 0.400
Validation loss decreased (-0.392577 --> -0.399984).  Saving model ...
Epoch: 18 cost time: 0.765979528427124
Epoch: 18, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.573 Vali Acc: 0.415 Test Loss: 1.573 Test Acc: 0.415
Validation loss decreased (-0.399984 --> -0.414799).  Saving model ...
Epoch: 19 cost time: 0.7634541988372803
Epoch: 19, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.561 Vali Acc: 0.430 Test Loss: 1.561 Test Acc: 0.430
Validation loss decreased (-0.414799 --> -0.429614).  Saving model ...
Epoch: 20 cost time: 0.6349689960479736
Epoch: 20, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.548 Vali Acc: 0.444 Test Loss: 1.548 Test Acc: 0.444
Validation loss decreased (-0.429614 --> -0.444429).  Saving model ...
Epoch: 21 cost time: 0.7908337116241455
Epoch: 21, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.535 Vali Acc: 0.448 Test Loss: 1.535 Test Acc: 0.448
Validation loss decreased (-0.444429 --> -0.448133).  Saving model ...
Epoch: 22 cost time: 0.7185709476470947
Epoch: 22, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.522 Vali Acc: 0.470 Test Loss: 1.522 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 23 cost time: 0.7514317035675049
Epoch: 23, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.509 Vali Acc: 0.481 Test Loss: 1.509 Test Acc: 0.481
Validation loss decreased (-0.470355 --> -0.481466).  Saving model ...
Epoch: 24 cost time: 0.7588188648223877
Epoch: 24, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.498 Vali Acc: 0.504 Test Loss: 1.498 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503689).  Saving model ...
Epoch: 25 cost time: 0.5828075408935547
Epoch: 25, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.486 Vali Acc: 0.519 Test Loss: 1.486 Test Acc: 0.519
Validation loss decreased (-0.503689 --> -0.518504).  Saving model ...
Epoch: 26 cost time: 0.7218236923217773
Epoch: 26, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
Validation loss decreased (-0.518504 --> -0.518504).  Saving model ...
Epoch: 27 cost time: 0.6230380535125732
Epoch: 27, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.463 Vali Acc: 0.537 Test Loss: 1.463 Test Acc: 0.537
Validation loss decreased (-0.518504 --> -0.537022).  Saving model ...
Epoch: 28 cost time: 0.7822439670562744
Epoch: 28, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.452 Vali Acc: 0.544 Test Loss: 1.452 Test Acc: 0.544
Validation loss decreased (-0.537022 --> -0.544430).  Saving model ...
Epoch: 29 cost time: 0.7880086898803711
Epoch: 29, Steps: 2 | Train Loss: 0.803 Vali Loss: 1.442 Vali Acc: 0.556 Test Loss: 1.442 Test Acc: 0.556
Validation loss decreased (-0.544430 --> -0.555541).  Saving model ...
Epoch: 30 cost time: 1.0332551002502441
Epoch: 30, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.432 Vali Acc: 0.552 Test Loss: 1.432 Test Acc: 0.552
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0093460083007812
Epoch: 31, Steps: 2 | Train Loss: 0.725 Vali Loss: 1.422 Vali Acc: 0.559 Test Loss: 1.422 Test Acc: 0.559
Validation loss decreased (-0.555541 --> -0.559245).  Saving model ...
Epoch: 32 cost time: 0.9445297718048096
Epoch: 32, Steps: 2 | Train Loss: 0.717 Vali Loss: 1.412 Vali Acc: 0.559 Test Loss: 1.412 Test Acc: 0.559
Validation loss decreased (-0.559245 --> -0.559245).  Saving model ...
Epoch: 33 cost time: 0.7064104080200195
Epoch: 33, Steps: 2 | Train Loss: 0.690 Vali Loss: 1.402 Vali Acc: 0.559 Test Loss: 1.402 Test Acc: 0.559
Validation loss decreased (-0.559245 --> -0.559245).  Saving model ...
Epoch: 34 cost time: 0.9352569580078125
Epoch: 34, Steps: 2 | Train Loss: 0.665 Vali Loss: 1.392 Vali Acc: 0.563 Test Loss: 1.392 Test Acc: 0.563
Validation loss decreased (-0.559245 --> -0.562949).  Saving model ...
Epoch: 35 cost time: 1.0788214206695557
Epoch: 35, Steps: 2 | Train Loss: 0.632 Vali Loss: 1.383 Vali Acc: 0.567 Test Loss: 1.383 Test Acc: 0.567
Validation loss decreased (-0.562949 --> -0.566653).  Saving model ...
Epoch: 36 cost time: 0.7322301864624023
Epoch: 36, Steps: 2 | Train Loss: 0.611 Vali Loss: 1.374 Vali Acc: 0.570 Test Loss: 1.374 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.570357).  Saving model ...
Epoch: 37 cost time: 0.6988978385925293
Epoch: 37, Steps: 2 | Train Loss: 0.581 Vali Loss: 1.366 Vali Acc: 0.563 Test Loss: 1.366 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8596994876861572
Epoch: 38, Steps: 2 | Train Loss: 0.539 Vali Loss: 1.358 Vali Acc: 0.567 Test Loss: 1.358 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7649784088134766
Epoch: 39, Steps: 2 | Train Loss: 0.518 Vali Loss: 1.351 Vali Acc: 0.567 Test Loss: 1.351 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9385802745819092
Epoch: 40, Steps: 2 | Train Loss: 0.521 Vali Loss: 1.343 Vali Acc: 0.567 Test Loss: 1.343 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9402139186859131
Epoch: 41, Steps: 2 | Train Loss: 0.507 Vali Loss: 1.336 Vali Acc: 0.570 Test Loss: 1.336 Test Acc: 0.570
Validation loss decreased (-0.570357 --> -0.570357).  Saving model ...
Epoch: 42 cost time: 1.0160613059997559
Epoch: 42, Steps: 2 | Train Loss: 0.505 Vali Loss: 1.329 Vali Acc: 0.574 Test Loss: 1.329 Test Acc: 0.574
Validation loss decreased (-0.570357 --> -0.574061).  Saving model ...
Epoch: 43 cost time: 0.8838696479797363
Epoch: 43, Steps: 2 | Train Loss: 0.465 Vali Loss: 1.322 Vali Acc: 0.581 Test Loss: 1.322 Test Acc: 0.581
Validation loss decreased (-0.574061 --> -0.581468).  Saving model ...
Epoch: 44 cost time: 0.7457997798919678
Epoch: 44, Steps: 2 | Train Loss: 0.441 Vali Loss: 1.315 Vali Acc: 0.593 Test Loss: 1.315 Test Acc: 0.593
Validation loss decreased (-0.581468 --> -0.592579).  Saving model ...
Epoch: 45 cost time: 0.693565845489502
Epoch: 45, Steps: 2 | Train Loss: 0.424 Vali Loss: 1.309 Vali Acc: 0.600 Test Loss: 1.309 Test Acc: 0.600
Validation loss decreased (-0.592579 --> -0.599987).  Saving model ...
Epoch: 46 cost time: 0.7467706203460693
Epoch: 46, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.303 Vali Acc: 0.596 Test Loss: 1.303 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8227338790893555
Epoch: 47, Steps: 2 | Train Loss: 0.402 Vali Loss: 1.297 Vali Acc: 0.593 Test Loss: 1.297 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7740049362182617
Epoch: 48, Steps: 2 | Train Loss: 0.390 Vali Loss: 1.291 Vali Acc: 0.585 Test Loss: 1.291 Test Acc: 0.585
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8507657051086426
Epoch: 49, Steps: 2 | Train Loss: 0.352 Vali Loss: 1.285 Vali Acc: 0.585 Test Loss: 1.285 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8277323246002197
Epoch: 50, Steps: 2 | Train Loss: 0.336 Vali Loss: 1.279 Vali Acc: 0.589 Test Loss: 1.279 Test Acc: 0.589
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7260258197784424
Epoch: 51, Steps: 2 | Train Loss: 0.325 Vali Loss: 1.274 Vali Acc: 0.585 Test Loss: 1.274 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6989965438842773
Epoch: 52, Steps: 2 | Train Loss: 0.320 Vali Loss: 1.269 Vali Acc: 0.585 Test Loss: 1.269 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.6822898387908936
Epoch: 53, Steps: 2 | Train Loss: 0.308 Vali Loss: 1.265 Vali Acc: 0.589 Test Loss: 1.265 Test Acc: 0.589
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.7883901596069336
Epoch: 54, Steps: 2 | Train Loss: 0.312 Vali Loss: 1.260 Vali Acc: 0.578 Test Loss: 1.260 Test Acc: 0.578
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8416614532470703
Epoch: 55, Steps: 2 | Train Loss: 0.283 Vali Loss: 1.255 Vali Acc: 0.574 Test Loss: 1.255 Test Acc: 0.574
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6
model parameter : 36280
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.167048215866089
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.855 Vali Acc: 0.178 Test Loss: 1.855 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.6240105628967285
Epoch: 2, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.849 Vali Acc: 0.178 Test Loss: 1.849 Test Acc: 0.178
Validation loss decreased (-0.177759 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.6252901554107666
Epoch: 3, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.844 Vali Acc: 0.178 Test Loss: 1.844 Test Acc: 0.178
Validation loss decreased (-0.177759 --> -0.177759).  Saving model ...
Epoch: 4 cost time: 0.657050609588623
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.838 Vali Acc: 0.185 Test Loss: 1.838 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.6305363178253174
Epoch: 5, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.830 Vali Acc: 0.189 Test Loss: 1.830 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 6 cost time: 0.6098625659942627
Epoch: 6, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.820 Vali Acc: 0.204 Test Loss: 1.820 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 7 cost time: 0.6456112861633301
Epoch: 7, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.809 Vali Acc: 0.222 Test Loss: 1.809 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222204).  Saving model ...
Epoch: 8 cost time: 0.9026939868927002
Epoch: 8, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.797 Vali Acc: 0.237 Test Loss: 1.797 Test Acc: 0.237
Validation loss decreased (-0.222204 --> -0.237019).  Saving model ...
Epoch: 9 cost time: 0.6064615249633789
Epoch: 9, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.785 Vali Acc: 0.248 Test Loss: 1.785 Test Acc: 0.248
Validation loss decreased (-0.237019 --> -0.248130).  Saving model ...
Epoch: 10 cost time: 0.5617318153381348
Epoch: 10, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.771 Vali Acc: 0.263 Test Loss: 1.771 Test Acc: 0.263
Validation loss decreased (-0.248130 --> -0.262945).  Saving model ...
Epoch: 11 cost time: 0.6430516242980957
Epoch: 11, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.757 Vali Acc: 0.270 Test Loss: 1.757 Test Acc: 0.270
Validation loss decreased (-0.262945 --> -0.270353).  Saving model ...
Epoch: 12 cost time: 0.7109603881835938
Epoch: 12, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.744 Vali Acc: 0.289 Test Loss: 1.744 Test Acc: 0.289
Validation loss decreased (-0.270353 --> -0.288871).  Saving model ...
Epoch: 13 cost time: 0.6676058769226074
Epoch: 13, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.729 Vali Acc: 0.293 Test Loss: 1.729 Test Acc: 0.293
Validation loss decreased (-0.288871 --> -0.292575).  Saving model ...
Epoch: 14 cost time: 0.5859761238098145
Epoch: 14, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.715 Vali Acc: 0.300 Test Loss: 1.715 Test Acc: 0.300
Validation loss decreased (-0.292575 --> -0.299983).  Saving model ...
Epoch: 15 cost time: 0.6310086250305176
Epoch: 15, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.699 Vali Acc: 0.315 Test Loss: 1.699 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 16 cost time: 0.6038525104522705
Epoch: 16, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.684 Vali Acc: 0.330 Test Loss: 1.684 Test Acc: 0.330
Validation loss decreased (-0.314798 --> -0.329613).  Saving model ...
Epoch: 17 cost time: 0.8399777412414551
Epoch: 17, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.667 Vali Acc: 0.333 Test Loss: 1.667 Test Acc: 0.333
Validation loss decreased (-0.329613 --> -0.333317).  Saving model ...
Epoch: 18 cost time: 0.6615772247314453
Epoch: 18, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.651 Vali Acc: 0.363 Test Loss: 1.651 Test Acc: 0.363
Validation loss decreased (-0.333317 --> -0.362946).  Saving model ...
Epoch: 19 cost time: 0.6938974857330322
Epoch: 19, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.635 Vali Acc: 0.400 Test Loss: 1.635 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399984).  Saving model ...
Epoch: 20 cost time: 0.5526151657104492
Epoch: 20, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.618 Vali Acc: 0.411 Test Loss: 1.618 Test Acc: 0.411
Validation loss decreased (-0.399984 --> -0.411095).  Saving model ...
Epoch: 21 cost time: 0.549983024597168
Epoch: 21, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.603 Vali Acc: 0.426 Test Loss: 1.603 Test Acc: 0.426
Validation loss decreased (-0.411095 --> -0.425910).  Saving model ...
Epoch: 22 cost time: 0.8810710906982422
Epoch: 22, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.587 Vali Acc: 0.441 Test Loss: 1.587 Test Acc: 0.441
Validation loss decreased (-0.425910 --> -0.440725).  Saving model ...
Epoch: 23 cost time: 0.6045804023742676
Epoch: 23, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.573 Vali Acc: 0.463 Test Loss: 1.573 Test Acc: 0.463
Validation loss decreased (-0.440725 --> -0.462947).  Saving model ...
Epoch: 24 cost time: 0.5394494533538818
Epoch: 24, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.561 Vali Acc: 0.481 Test Loss: 1.561 Test Acc: 0.481
Validation loss decreased (-0.462947 --> -0.481466).  Saving model ...
Epoch: 25 cost time: 0.6269371509552002
Epoch: 25, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.548 Vali Acc: 0.496 Test Loss: 1.548 Test Acc: 0.496
Validation loss decreased (-0.481466 --> -0.496281).  Saving model ...
Epoch: 26 cost time: 0.7160015106201172
Epoch: 26, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.535 Vali Acc: 0.515 Test Loss: 1.535 Test Acc: 0.515
Validation loss decreased (-0.496281 --> -0.514799).  Saving model ...
Epoch: 27 cost time: 0.6744518280029297
Epoch: 27, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.522 Vali Acc: 0.511 Test Loss: 1.522 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.674931526184082
Epoch: 28, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.509 Vali Acc: 0.530 Test Loss: 1.509 Test Acc: 0.530
Validation loss decreased (-0.514799 --> -0.529615).  Saving model ...
Epoch: 29 cost time: 0.5865819454193115
Epoch: 29, Steps: 2 | Train Loss: 0.872 Vali Loss: 1.496 Vali Acc: 0.541 Test Loss: 1.496 Test Acc: 0.541
Validation loss decreased (-0.529615 --> -0.540726).  Saving model ...
Epoch: 30 cost time: 0.6876749992370605
Epoch: 30, Steps: 2 | Train Loss: 0.782 Vali Loss: 1.485 Vali Acc: 0.541 Test Loss: 1.485 Test Acc: 0.541
Validation loss decreased (-0.540726 --> -0.540726).  Saving model ...
Epoch: 31 cost time: 0.538405179977417
Epoch: 31, Steps: 2 | Train Loss: 0.782 Vali Loss: 1.474 Vali Acc: 0.548 Test Loss: 1.474 Test Acc: 0.548
Validation loss decreased (-0.540726 --> -0.548133).  Saving model ...
Epoch: 32 cost time: 0.7091758251190186
Epoch: 32, Steps: 2 | Train Loss: 0.774 Vali Loss: 1.463 Vali Acc: 0.548 Test Loss: 1.463 Test Acc: 0.548
Validation loss decreased (-0.548133 --> -0.548134).  Saving model ...
Epoch: 33 cost time: 0.6667995452880859
Epoch: 33, Steps: 2 | Train Loss: 0.739 Vali Loss: 1.451 Vali Acc: 0.556 Test Loss: 1.451 Test Acc: 0.556
Validation loss decreased (-0.548134 --> -0.555541).  Saving model ...
Epoch: 34 cost time: 0.5908174514770508
Epoch: 34, Steps: 2 | Train Loss: 0.700 Vali Loss: 1.440 Vali Acc: 0.559 Test Loss: 1.440 Test Acc: 0.559
Validation loss decreased (-0.555541 --> -0.559245).  Saving model ...
Epoch: 35 cost time: 0.6086344718933105
Epoch: 35, Steps: 2 | Train Loss: 0.672 Vali Loss: 1.429 Vali Acc: 0.563 Test Loss: 1.429 Test Acc: 0.563
Validation loss decreased (-0.559245 --> -0.562949).  Saving model ...
Epoch: 36 cost time: 0.6151425838470459
Epoch: 36, Steps: 2 | Train Loss: 0.629 Vali Loss: 1.418 Vali Acc: 0.567 Test Loss: 1.418 Test Acc: 0.567
Validation loss decreased (-0.562949 --> -0.566652).  Saving model ...
Epoch: 37 cost time: 0.6654312610626221
Epoch: 37, Steps: 2 | Train Loss: 0.609 Vali Loss: 1.409 Vali Acc: 0.574 Test Loss: 1.409 Test Acc: 0.574
Validation loss decreased (-0.566652 --> -0.574060).  Saving model ...
Epoch: 38 cost time: 0.616462230682373
Epoch: 38, Steps: 2 | Train Loss: 0.590 Vali Loss: 1.400 Vali Acc: 0.574 Test Loss: 1.400 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 39 cost time: 0.624927282333374
Epoch: 39, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.390 Vali Acc: 0.581 Test Loss: 1.390 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 40 cost time: 0.6734020709991455
Epoch: 40, Steps: 2 | Train Loss: 0.548 Vali Loss: 1.381 Vali Acc: 0.578 Test Loss: 1.381 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7467525005340576
Epoch: 41, Steps: 2 | Train Loss: 0.494 Vali Loss: 1.372 Vali Acc: 0.578 Test Loss: 1.372 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7001051902770996
Epoch: 42, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.364 Vali Acc: 0.589 Test Loss: 1.364 Test Acc: 0.589
Validation loss decreased (-0.581468 --> -0.588875).  Saving model ...
Epoch: 43 cost time: 0.6384344100952148
Epoch: 43, Steps: 2 | Train Loss: 0.459 Vali Loss: 1.355 Vali Acc: 0.596 Test Loss: 1.355 Test Acc: 0.596
Validation loss decreased (-0.588875 --> -0.596283).  Saving model ...
Epoch: 44 cost time: 0.7226314544677734
Epoch: 44, Steps: 2 | Train Loss: 0.464 Vali Loss: 1.346 Vali Acc: 0.596 Test Loss: 1.346 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 45 cost time: 0.5521774291992188
Epoch: 45, Steps: 2 | Train Loss: 0.430 Vali Loss: 1.337 Vali Acc: 0.607 Test Loss: 1.337 Test Acc: 0.607
Validation loss decreased (-0.596283 --> -0.607394).  Saving model ...
Epoch: 46 cost time: 0.5754408836364746
Epoch: 46, Steps: 2 | Train Loss: 0.407 Vali Loss: 1.329 Vali Acc: 0.611 Test Loss: 1.329 Test Acc: 0.611
Validation loss decreased (-0.607394 --> -0.611098).  Saving model ...
Epoch: 47 cost time: 0.6244704723358154
Epoch: 47, Steps: 2 | Train Loss: 0.424 Vali Loss: 1.320 Vali Acc: 0.615 Test Loss: 1.320 Test Acc: 0.615
Validation loss decreased (-0.611098 --> -0.614802).  Saving model ...
Epoch: 48 cost time: 0.5432479381561279
Epoch: 48, Steps: 2 | Train Loss: 0.404 Vali Loss: 1.311 Vali Acc: 0.615 Test Loss: 1.311 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 49 cost time: 0.7386209964752197
Epoch: 49, Steps: 2 | Train Loss: 0.376 Vali Loss: 1.303 Vali Acc: 0.615 Test Loss: 1.303 Test Acc: 0.615
Validation loss decreased (-0.614802 --> -0.614802).  Saving model ...
Epoch: 50 cost time: 0.5834839344024658
Epoch: 50, Steps: 2 | Train Loss: 0.341 Vali Loss: 1.295 Vali Acc: 0.619 Test Loss: 1.295 Test Acc: 0.619
Validation loss decreased (-0.614802 --> -0.618506).  Saving model ...
Epoch: 51 cost time: 0.5490233898162842
Epoch: 51, Steps: 2 | Train Loss: 0.345 Vali Loss: 1.287 Vali Acc: 0.611 Test Loss: 1.287 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.677178144454956
Epoch: 52, Steps: 2 | Train Loss: 0.321 Vali Loss: 1.280 Vali Acc: 0.611 Test Loss: 1.280 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6141443252563477
Epoch: 53, Steps: 2 | Train Loss: 0.301 Vali Loss: 1.273 Vali Acc: 0.615 Test Loss: 1.273 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8617820739746094
Epoch: 54, Steps: 2 | Train Loss: 0.310 Vali Loss: 1.267 Vali Acc: 0.615 Test Loss: 1.267 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7580695152282715
Epoch: 55, Steps: 2 | Train Loss: 0.287 Vali Loss: 1.261 Vali Acc: 0.619 Test Loss: 1.261 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 56 cost time: 0.637608528137207
Epoch: 56, Steps: 2 | Train Loss: 0.268 Vali Loss: 1.255 Vali Acc: 0.619 Test Loss: 1.255 Test Acc: 0.619
Validation loss decreased (-0.618506 --> -0.618506).  Saving model ...
Epoch: 57 cost time: 0.636906623840332
Epoch: 57, Steps: 2 | Train Loss: 0.259 Vali Loss: 1.249 Vali Acc: 0.622 Test Loss: 1.249 Test Acc: 0.622
Validation loss decreased (-0.618506 --> -0.622210).  Saving model ...
Epoch: 58 cost time: 0.8216807842254639
Epoch: 58, Steps: 2 | Train Loss: 0.258 Vali Loss: 1.242 Vali Acc: 0.630 Test Loss: 1.242 Test Acc: 0.630
Validation loss decreased (-0.622210 --> -0.629617).  Saving model ...
Epoch: 59 cost time: 0.5989065170288086
Epoch: 59, Steps: 2 | Train Loss: 0.256 Vali Loss: 1.237 Vali Acc: 0.630 Test Loss: 1.237 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 60 cost time: 0.5986943244934082
Epoch: 60, Steps: 2 | Train Loss: 0.232 Vali Loss: 1.231 Vali Acc: 0.630 Test Loss: 1.231 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629617).  Saving model ...
Epoch: 61 cost time: 0.6456537246704102
Epoch: 61, Steps: 2 | Train Loss: 0.226 Vali Loss: 1.226 Vali Acc: 0.619 Test Loss: 1.226 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7131645679473877
Epoch: 62, Steps: 2 | Train Loss: 0.220 Vali Loss: 1.221 Vali Acc: 0.622 Test Loss: 1.221 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8452303409576416
Epoch: 63, Steps: 2 | Train Loss: 0.216 Vali Loss: 1.216 Vali Acc: 0.622 Test Loss: 1.216 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8611211776733398
Epoch: 64, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.211 Vali Acc: 0.622 Test Loss: 1.211 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.7755331993103027
Epoch: 65, Steps: 2 | Train Loss: 0.185 Vali Loss: 1.207 Vali Acc: 0.622 Test Loss: 1.207 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.783872127532959
Epoch: 66, Steps: 2 | Train Loss: 0.190 Vali Loss: 1.203 Vali Acc: 0.630 Test Loss: 1.203 Test Acc: 0.630
Validation loss decreased (-0.629617 --> -0.629618).  Saving model ...
Epoch: 67 cost time: 0.6878511905670166
Epoch: 67, Steps: 2 | Train Loss: 0.181 Vali Loss: 1.199 Vali Acc: 0.630 Test Loss: 1.199 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 68 cost time: 0.6650693416595459
Epoch: 68, Steps: 2 | Train Loss: 0.172 Vali Loss: 1.195 Vali Acc: 0.630 Test Loss: 1.195 Test Acc: 0.630
Validation loss decreased (-0.629618 --> -0.629618).  Saving model ...
Epoch: 69 cost time: 0.6945500373840332
Epoch: 69, Steps: 2 | Train Loss: 0.164 Vali Loss: 1.191 Vali Acc: 0.633 Test Loss: 1.191 Test Acc: 0.633
Validation loss decreased (-0.629618 --> -0.633321).  Saving model ...
Epoch: 70 cost time: 0.6684110164642334
Epoch: 70, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.188 Vali Acc: 0.630 Test Loss: 1.188 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7957522869110107
Epoch: 71, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.184 Vali Acc: 0.630 Test Loss: 1.184 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.0326528549194336
Epoch: 72, Steps: 2 | Train Loss: 0.147 Vali Loss: 1.181 Vali Acc: 0.633 Test Loss: 1.181 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633322).  Saving model ...
Epoch: 73 cost time: 0.9879677295684814
Epoch: 73, Steps: 2 | Train Loss: 0.140 Vali Loss: 1.178 Vali Acc: 0.633 Test Loss: 1.178 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 74 cost time: 0.8152616024017334
Epoch: 74, Steps: 2 | Train Loss: 0.138 Vali Loss: 1.175 Vali Acc: 0.633 Test Loss: 1.175 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 75 cost time: 0.683509349822998
Epoch: 75, Steps: 2 | Train Loss: 0.122 Vali Loss: 1.172 Vali Acc: 0.630 Test Loss: 1.172 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7081449031829834
Epoch: 76, Steps: 2 | Train Loss: 0.125 Vali Loss: 1.169 Vali Acc: 0.622 Test Loss: 1.169 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7503764629364014
Epoch: 77, Steps: 2 | Train Loss: 0.126 Vali Loss: 1.167 Vali Acc: 0.622 Test Loss: 1.167 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.704641580581665
Epoch: 78, Steps: 2 | Train Loss: 0.119 Vali Loss: 1.164 Vali Acc: 0.622 Test Loss: 1.164 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.760777473449707
Epoch: 79, Steps: 2 | Train Loss: 0.111 Vali Loss: 1.162 Vali Acc: 0.626 Test Loss: 1.162 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.90189528465271
Epoch: 80, Steps: 2 | Train Loss: 0.113 Vali Loss: 1.160 Vali Acc: 0.630 Test Loss: 1.160 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.6458125114440918
Epoch: 81, Steps: 2 | Train Loss: 0.106 Vali Loss: 1.157 Vali Acc: 0.630 Test Loss: 1.157 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.5116939544677734
Epoch: 82, Steps: 2 | Train Loss: 0.097 Vali Loss: 1.155 Vali Acc: 0.630 Test Loss: 1.155 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.7727375030517578
Epoch: 83, Steps: 2 | Train Loss: 0.095 Vali Loss: 1.153 Vali Acc: 0.626 Test Loss: 1.153 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.8050332069396973
Epoch: 84, Steps: 2 | Train Loss: 0.096 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6333333333333333
model parameter : 36024
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9952449798583984
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.885 Vali Acc: 0.193 Test Loss: 1.885 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.7514238357543945
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.878 Vali Acc: 0.196 Test Loss: 1.878 Test Acc: 0.196
Validation loss decreased (-0.192574 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6473274230957031
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.873 Vali Acc: 0.204 Test Loss: 1.873 Test Acc: 0.204
Validation loss decreased (-0.196278 --> -0.203685).  Saving model ...
Epoch: 4 cost time: 0.8054168224334717
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.866 Vali Acc: 0.211 Test Loss: 1.866 Test Acc: 0.211
Validation loss decreased (-0.203685 --> -0.211092).  Saving model ...
Epoch: 5 cost time: 0.7616157531738281
Epoch: 5, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.858 Vali Acc: 0.219 Test Loss: 1.858 Test Acc: 0.219
Validation loss decreased (-0.211092 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.7988595962524414
Epoch: 6, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.848 Vali Acc: 0.230 Test Loss: 1.848 Test Acc: 0.230
Validation loss decreased (-0.218500 --> -0.229611).  Saving model ...
Epoch: 7 cost time: 0.7851035594940186
Epoch: 7, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.836 Vali Acc: 0.241 Test Loss: 1.836 Test Acc: 0.241
Validation loss decreased (-0.229611 --> -0.240722).  Saving model ...
Epoch: 8 cost time: 0.7421486377716064
Epoch: 8, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.825 Vali Acc: 0.244 Test Loss: 1.825 Test Acc: 0.244
Validation loss decreased (-0.240722 --> -0.244426).  Saving model ...
Epoch: 9 cost time: 0.5503027439117432
Epoch: 9, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.812 Vali Acc: 0.256 Test Loss: 1.812 Test Acc: 0.256
Validation loss decreased (-0.244426 --> -0.255537).  Saving model ...
Epoch: 10 cost time: 0.5791797637939453
Epoch: 10, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.799 Vali Acc: 0.256 Test Loss: 1.799 Test Acc: 0.256
Validation loss decreased (-0.255537 --> -0.255538).  Saving model ...
Epoch: 11 cost time: 0.952946662902832
Epoch: 11, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.785 Vali Acc: 0.263 Test Loss: 1.785 Test Acc: 0.263
Validation loss decreased (-0.255538 --> -0.262945).  Saving model ...
Epoch: 12 cost time: 0.7673592567443848
Epoch: 12, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.771 Vali Acc: 0.267 Test Loss: 1.771 Test Acc: 0.267
Validation loss decreased (-0.262945 --> -0.266649).  Saving model ...
Epoch: 13 cost time: 0.852349042892456
Epoch: 13, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.757 Vali Acc: 0.263 Test Loss: 1.757 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6111125946044922
Epoch: 14, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.743 Vali Acc: 0.270 Test Loss: 1.743 Test Acc: 0.270
Validation loss decreased (-0.266649 --> -0.270353).  Saving model ...
Epoch: 15 cost time: 0.5519194602966309
Epoch: 15, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.729 Vali Acc: 0.285 Test Loss: 1.729 Test Acc: 0.285
Validation loss decreased (-0.270353 --> -0.285168).  Saving model ...
Epoch: 16 cost time: 0.7718493938446045
Epoch: 16, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.714 Vali Acc: 0.300 Test Loss: 1.714 Test Acc: 0.300
Validation loss decreased (-0.285168 --> -0.299983).  Saving model ...
Epoch: 17 cost time: 0.8497278690338135
Epoch: 17, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.699 Vali Acc: 0.315 Test Loss: 1.699 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 18 cost time: 0.8125143051147461
Epoch: 18, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.684 Vali Acc: 0.326 Test Loss: 1.684 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 19 cost time: 0.9752631187438965
Epoch: 19, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.669 Vali Acc: 0.341 Test Loss: 1.669 Test Acc: 0.341
Validation loss decreased (-0.325909 --> -0.340724).  Saving model ...
Epoch: 20 cost time: 0.940192461013794
Epoch: 20, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.655 Vali Acc: 0.341 Test Loss: 1.655 Test Acc: 0.341
Validation loss decreased (-0.340724 --> -0.340724).  Saving model ...
Epoch: 21 cost time: 0.6879823207855225
Epoch: 21, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.642 Vali Acc: 0.359 Test Loss: 1.642 Test Acc: 0.359
Validation loss decreased (-0.340724 --> -0.359243).  Saving model ...
Epoch: 22 cost time: 1.0375282764434814
Epoch: 22, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.630 Vali Acc: 0.374 Test Loss: 1.630 Test Acc: 0.374
Validation loss decreased (-0.359243 --> -0.374058).  Saving model ...
Epoch: 23 cost time: 0.7205462455749512
Epoch: 23, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.617 Vali Acc: 0.385 Test Loss: 1.617 Test Acc: 0.385
Validation loss decreased (-0.374058 --> -0.385169).  Saving model ...
Epoch: 24 cost time: 0.8224189281463623
Epoch: 24, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.607 Vali Acc: 0.389 Test Loss: 1.607 Test Acc: 0.389
Validation loss decreased (-0.385169 --> -0.388873).  Saving model ...
Epoch: 25 cost time: 0.9388654232025146
Epoch: 25, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.596 Vali Acc: 0.400 Test Loss: 1.596 Test Acc: 0.400
Validation loss decreased (-0.388873 --> -0.399984).  Saving model ...
Epoch: 26 cost time: 0.7485198974609375
Epoch: 26, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.587 Vali Acc: 0.411 Test Loss: 1.587 Test Acc: 0.411
Validation loss decreased (-0.399984 --> -0.411095).  Saving model ...
Epoch: 27 cost time: 0.7836942672729492
Epoch: 27, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.578 Vali Acc: 0.422 Test Loss: 1.578 Test Acc: 0.422
Validation loss decreased (-0.411095 --> -0.422206).  Saving model ...
Epoch: 28 cost time: 0.769512414932251
Epoch: 28, Steps: 2 | Train Loss: 0.781 Vali Loss: 1.569 Vali Acc: 0.419 Test Loss: 1.569 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.828397274017334
Epoch: 29, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.560 Vali Acc: 0.430 Test Loss: 1.560 Test Acc: 0.430
Validation loss decreased (-0.422206 --> -0.429614).  Saving model ...
Epoch: 30 cost time: 0.8686246871948242
Epoch: 30, Steps: 2 | Train Loss: 0.712 Vali Loss: 1.551 Vali Acc: 0.426 Test Loss: 1.551 Test Acc: 0.426
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7412381172180176
Epoch: 31, Steps: 2 | Train Loss: 0.695 Vali Loss: 1.541 Vali Acc: 0.433 Test Loss: 1.541 Test Acc: 0.433
Validation loss decreased (-0.429614 --> -0.433318).  Saving model ...
Epoch: 32 cost time: 0.811396598815918
Epoch: 32, Steps: 2 | Train Loss: 0.641 Vali Loss: 1.532 Vali Acc: 0.430 Test Loss: 1.532 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9454445838928223
Epoch: 33, Steps: 2 | Train Loss: 0.624 Vali Loss: 1.524 Vali Acc: 0.437 Test Loss: 1.524 Test Acc: 0.437
Validation loss decreased (-0.433318 --> -0.437022).  Saving model ...
Epoch: 34 cost time: 0.834761381149292
Epoch: 34, Steps: 2 | Train Loss: 0.606 Vali Loss: 1.515 Vali Acc: 0.444 Test Loss: 1.515 Test Acc: 0.444
Validation loss decreased (-0.437022 --> -0.444429).  Saving model ...
Epoch: 35 cost time: 0.6948800086975098
Epoch: 35, Steps: 2 | Train Loss: 0.570 Vali Loss: 1.507 Vali Acc: 0.452 Test Loss: 1.507 Test Acc: 0.452
Validation loss decreased (-0.444429 --> -0.451837).  Saving model ...
Epoch: 36 cost time: 0.7243945598602295
Epoch: 36, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.499 Vali Acc: 0.470 Test Loss: 1.499 Test Acc: 0.470
Validation loss decreased (-0.451837 --> -0.470355).  Saving model ...
Epoch: 37 cost time: 0.8669900894165039
Epoch: 37, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.490 Vali Acc: 0.474 Test Loss: 1.490 Test Acc: 0.474
Validation loss decreased (-0.470355 --> -0.474059).  Saving model ...
Epoch: 38 cost time: 1.0106236934661865
Epoch: 38, Steps: 2 | Train Loss: 0.517 Vali Loss: 1.482 Vali Acc: 0.485 Test Loss: 1.482 Test Acc: 0.485
Validation loss decreased (-0.474059 --> -0.485170).  Saving model ...
Epoch: 39 cost time: 0.8894472122192383
Epoch: 39, Steps: 2 | Train Loss: 0.477 Vali Loss: 1.474 Vali Acc: 0.485 Test Loss: 1.474 Test Acc: 0.485
Validation loss decreased (-0.485170 --> -0.485170).  Saving model ...
Epoch: 40 cost time: 0.6487975120544434
Epoch: 40, Steps: 2 | Train Loss: 0.481 Vali Loss: 1.467 Vali Acc: 0.504 Test Loss: 1.467 Test Acc: 0.504
Validation loss decreased (-0.485170 --> -0.503689).  Saving model ...
Epoch: 41 cost time: 0.7954432964324951
Epoch: 41, Steps: 2 | Train Loss: 0.426 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
Validation loss decreased (-0.503689 --> -0.511097).  Saving model ...
Epoch: 42 cost time: 0.6208064556121826
Epoch: 42, Steps: 2 | Train Loss: 0.443 Vali Loss: 1.452 Vali Acc: 0.526 Test Loss: 1.452 Test Acc: 0.526
Validation loss decreased (-0.511097 --> -0.525911).  Saving model ...
Epoch: 43 cost time: 0.6264932155609131
Epoch: 43, Steps: 2 | Train Loss: 0.384 Vali Loss: 1.445 Vali Acc: 0.526 Test Loss: 1.445 Test Acc: 0.526
Validation loss decreased (-0.525911 --> -0.525911).  Saving model ...
Epoch: 44 cost time: 0.7313950061798096
Epoch: 44, Steps: 2 | Train Loss: 0.400 Vali Loss: 1.437 Vali Acc: 0.533 Test Loss: 1.437 Test Acc: 0.533
Validation loss decreased (-0.525911 --> -0.533319).  Saving model ...
Epoch: 45 cost time: 0.780303955078125
Epoch: 45, Steps: 2 | Train Loss: 0.385 Vali Loss: 1.430 Vali Acc: 0.533 Test Loss: 1.430 Test Acc: 0.533
Validation loss decreased (-0.533319 --> -0.533319).  Saving model ...
Epoch: 46 cost time: 0.6419179439544678
Epoch: 46, Steps: 2 | Train Loss: 0.360 Vali Loss: 1.424 Vali Acc: 0.530 Test Loss: 1.424 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7573292255401611
Epoch: 47, Steps: 2 | Train Loss: 0.331 Vali Loss: 1.418 Vali Acc: 0.530 Test Loss: 1.418 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7953879833221436
Epoch: 48, Steps: 2 | Train Loss: 0.335 Vali Loss: 1.411 Vali Acc: 0.530 Test Loss: 1.411 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8482742309570312
Epoch: 49, Steps: 2 | Train Loss: 0.299 Vali Loss: 1.405 Vali Acc: 0.530 Test Loss: 1.405 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6683754920959473
Epoch: 50, Steps: 2 | Train Loss: 0.299 Vali Loss: 1.398 Vali Acc: 0.526 Test Loss: 1.398 Test Acc: 0.526
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6620485782623291
Epoch: 51, Steps: 2 | Train Loss: 0.300 Vali Loss: 1.392 Vali Acc: 0.530 Test Loss: 1.392 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5571999549865723
Epoch: 52, Steps: 2 | Train Loss: 0.274 Vali Loss: 1.386 Vali Acc: 0.541 Test Loss: 1.386 Test Acc: 0.541
Validation loss decreased (-0.533319 --> -0.540727).  Saving model ...
Epoch: 53 cost time: 0.6719377040863037
Epoch: 53, Steps: 2 | Train Loss: 0.260 Vali Loss: 1.381 Vali Acc: 0.556 Test Loss: 1.381 Test Acc: 0.556
Validation loss decreased (-0.540727 --> -0.555542).  Saving model ...
Epoch: 54 cost time: 0.8620848655700684
Epoch: 54, Steps: 2 | Train Loss: 0.271 Vali Loss: 1.375 Vali Acc: 0.559 Test Loss: 1.375 Test Acc: 0.559
Validation loss decreased (-0.555542 --> -0.559246).  Saving model ...
Epoch: 55 cost time: 0.8214597702026367
Epoch: 55, Steps: 2 | Train Loss: 0.249 Vali Loss: 1.370 Vali Acc: 0.559 Test Loss: 1.370 Test Acc: 0.559
Validation loss decreased (-0.559246 --> -0.559246).  Saving model ...
Epoch: 56 cost time: 0.6260640621185303
Epoch: 56, Steps: 2 | Train Loss: 0.233 Vali Loss: 1.365 Vali Acc: 0.556 Test Loss: 1.365 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7399787902832031
Epoch: 57, Steps: 2 | Train Loss: 0.225 Vali Loss: 1.361 Vali Acc: 0.552 Test Loss: 1.361 Test Acc: 0.552
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9123899936676025
Epoch: 58, Steps: 2 | Train Loss: 0.205 Vali Loss: 1.357 Vali Acc: 0.556 Test Loss: 1.357 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6741712093353271
Epoch: 59, Steps: 2 | Train Loss: 0.218 Vali Loss: 1.353 Vali Acc: 0.563 Test Loss: 1.353 Test Acc: 0.563
Validation loss decreased (-0.559246 --> -0.562949).  Saving model ...
Epoch: 60 cost time: 0.670330286026001
Epoch: 60, Steps: 2 | Train Loss: 0.199 Vali Loss: 1.349 Vali Acc: 0.567 Test Loss: 1.349 Test Acc: 0.567
Validation loss decreased (-0.562949 --> -0.566653).  Saving model ...
Epoch: 61 cost time: 0.7852647304534912
Epoch: 61, Steps: 2 | Train Loss: 0.194 Vali Loss: 1.346 Vali Acc: 0.567 Test Loss: 1.346 Test Acc: 0.567
Validation loss decreased (-0.566653 --> -0.566653).  Saving model ...
Epoch: 62 cost time: 0.7964777946472168
Epoch: 62, Steps: 2 | Train Loss: 0.192 Vali Loss: 1.343 Vali Acc: 0.570 Test Loss: 1.343 Test Acc: 0.570
Validation loss decreased (-0.566653 --> -0.570357).  Saving model ...
Epoch: 63 cost time: 0.8912568092346191
Epoch: 63, Steps: 2 | Train Loss: 0.197 Vali Loss: 1.339 Vali Acc: 0.570 Test Loss: 1.339 Test Acc: 0.570
Validation loss decreased (-0.570357 --> -0.570357).  Saving model ...
Epoch: 64 cost time: 0.67423415184021
Epoch: 64, Steps: 2 | Train Loss: 0.172 Vali Loss: 1.336 Vali Acc: 0.570 Test Loss: 1.336 Test Acc: 0.570
Validation loss decreased (-0.570357 --> -0.570357).  Saving model ...
Epoch: 65 cost time: 0.5922105312347412
Epoch: 65, Steps: 2 | Train Loss: 0.159 Vali Loss: 1.333 Vali Acc: 0.574 Test Loss: 1.333 Test Acc: 0.574
Validation loss decreased (-0.570357 --> -0.574061).  Saving model ...
Epoch: 66 cost time: 0.7293975353240967
Epoch: 66, Steps: 2 | Train Loss: 0.157 Vali Loss: 1.329 Vali Acc: 0.574 Test Loss: 1.329 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 67 cost time: 0.6677396297454834
Epoch: 67, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.326 Vali Acc: 0.574 Test Loss: 1.326 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 68 cost time: 0.6568880081176758
Epoch: 68, Steps: 2 | Train Loss: 0.143 Vali Loss: 1.322 Vali Acc: 0.574 Test Loss: 1.322 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 69 cost time: 0.8024840354919434
Epoch: 69, Steps: 2 | Train Loss: 0.139 Vali Loss: 1.319 Vali Acc: 0.574 Test Loss: 1.319 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 70 cost time: 0.5345666408538818
Epoch: 70, Steps: 2 | Train Loss: 0.144 Vali Loss: 1.316 Vali Acc: 0.570 Test Loss: 1.316 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.76698899269104
Epoch: 71, Steps: 2 | Train Loss: 0.139 Vali Loss: 1.313 Vali Acc: 0.570 Test Loss: 1.313 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7295122146606445
Epoch: 72, Steps: 2 | Train Loss: 0.139 Vali Loss: 1.310 Vali Acc: 0.574 Test Loss: 1.310 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 73 cost time: 0.7359213829040527
Epoch: 73, Steps: 2 | Train Loss: 0.127 Vali Loss: 1.307 Vali Acc: 0.574 Test Loss: 1.307 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 74 cost time: 0.6082203388214111
Epoch: 74, Steps: 2 | Train Loss: 0.118 Vali Loss: 1.304 Vali Acc: 0.574 Test Loss: 1.304 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 75 cost time: 0.6575932502746582
Epoch: 75, Steps: 2 | Train Loss: 0.110 Vali Loss: 1.301 Vali Acc: 0.574 Test Loss: 1.301 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 76 cost time: 0.702629804611206
Epoch: 76, Steps: 2 | Train Loss: 0.115 Vali Loss: 1.299 Vali Acc: 0.574 Test Loss: 1.299 Test Acc: 0.574
Validation loss decreased (-0.574061 --> -0.574061).  Saving model ...
Epoch: 77 cost time: 0.7309904098510742
Epoch: 77, Steps: 2 | Train Loss: 0.115 Vali Loss: 1.296 Vali Acc: 0.570 Test Loss: 1.296 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6415364742279053
Epoch: 78, Steps: 2 | Train Loss: 0.108 Vali Loss: 1.293 Vali Acc: 0.570 Test Loss: 1.293 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.6847786903381348
Epoch: 79, Steps: 2 | Train Loss: 0.100 Vali Loss: 1.290 Vali Acc: 0.570 Test Loss: 1.290 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.6145484447479248
Epoch: 80, Steps: 2 | Train Loss: 0.099 Vali Loss: 1.288 Vali Acc: 0.570 Test Loss: 1.288 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.7546336650848389
Epoch: 81, Steps: 2 | Train Loss: 0.098 Vali Loss: 1.285 Vali Acc: 0.570 Test Loss: 1.285 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.6869692802429199
Epoch: 82, Steps: 2 | Train Loss: 0.093 Vali Loss: 1.283 Vali Acc: 0.570 Test Loss: 1.283 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.6240746974945068
Epoch: 83, Steps: 2 | Train Loss: 0.084 Vali Loss: 1.281 Vali Acc: 0.570 Test Loss: 1.281 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.6112003326416016
Epoch: 84, Steps: 2 | Train Loss: 0.091 Vali Loss: 1.279 Vali Acc: 0.570 Test Loss: 1.279 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.857999324798584
Epoch: 85, Steps: 2 | Train Loss: 0.089 Vali Loss: 1.277 Vali Acc: 0.570 Test Loss: 1.277 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.6191160678863525
Epoch: 86, Steps: 2 | Train Loss: 0.085 Vali Loss: 1.274 Vali Acc: 0.570 Test Loss: 1.274 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.5740740740740741
model parameter : 35512
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.514725685119629
Epoch: 1, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.827 Vali Acc: 0.193 Test Loss: 1.827 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.681957483291626
Epoch: 2, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.822 Vali Acc: 0.200 Test Loss: 1.822 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.5635087490081787
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.817 Vali Acc: 0.200 Test Loss: 1.817 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.5764272212982178
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.811 Vali Acc: 0.207 Test Loss: 1.811 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 0.6900231838226318
Epoch: 5, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.803 Vali Acc: 0.211 Test Loss: 1.803 Test Acc: 0.211
Validation loss decreased (-0.207389 --> -0.211093).  Saving model ...
Epoch: 6 cost time: 0.6353981494903564
Epoch: 6, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.795 Vali Acc: 0.222 Test Loss: 1.795 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222204).  Saving model ...
Epoch: 7 cost time: 0.5939610004425049
Epoch: 7, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.784 Vali Acc: 0.222 Test Loss: 1.784 Test Acc: 0.222
Validation loss decreased (-0.222204 --> -0.222204).  Saving model ...
Epoch: 8 cost time: 0.6324687004089355
Epoch: 8, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.773 Vali Acc: 0.241 Test Loss: 1.773 Test Acc: 0.241
Validation loss decreased (-0.222204 --> -0.240723).  Saving model ...
Epoch: 9 cost time: 0.6629409790039062
Epoch: 9, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.761 Vali Acc: 0.252 Test Loss: 1.761 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 10 cost time: 0.6727144718170166
Epoch: 10, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.747 Vali Acc: 0.256 Test Loss: 1.747 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 11 cost time: 0.6275875568389893
Epoch: 11, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.733 Vali Acc: 0.274 Test Loss: 1.733 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 12 cost time: 0.5762984752655029
Epoch: 12, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.719 Vali Acc: 0.304 Test Loss: 1.719 Test Acc: 0.304
Validation loss decreased (-0.274057 --> -0.303687).  Saving model ...
Epoch: 13 cost time: 0.7968478202819824
Epoch: 13, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.704 Vali Acc: 0.311 Test Loss: 1.704 Test Acc: 0.311
Validation loss decreased (-0.303687 --> -0.311094).  Saving model ...
Epoch: 14 cost time: 0.6896445751190186
Epoch: 14, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.689 Vali Acc: 0.337 Test Loss: 1.689 Test Acc: 0.337
Validation loss decreased (-0.311094 --> -0.337020).  Saving model ...
Epoch: 15 cost time: 0.7344284057617188
Epoch: 15, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.674 Vali Acc: 0.352 Test Loss: 1.674 Test Acc: 0.352
Validation loss decreased (-0.337020 --> -0.351835).  Saving model ...
Epoch: 16 cost time: 0.755408763885498
Epoch: 16, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.659 Vali Acc: 0.381 Test Loss: 1.659 Test Acc: 0.381
Validation loss decreased (-0.351835 --> -0.381465).  Saving model ...
Epoch: 17 cost time: 0.8287112712860107
Epoch: 17, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.645 Vali Acc: 0.393 Test Loss: 1.645 Test Acc: 0.393
Validation loss decreased (-0.381465 --> -0.392576).  Saving model ...
Epoch: 18 cost time: 0.7349090576171875
Epoch: 18, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.631 Vali Acc: 0.419 Test Loss: 1.631 Test Acc: 0.419
Validation loss decreased (-0.392576 --> -0.418502).  Saving model ...
Epoch: 19 cost time: 0.6771371364593506
Epoch: 19, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.617 Vali Acc: 0.430 Test Loss: 1.617 Test Acc: 0.430
Validation loss decreased (-0.418502 --> -0.429613).  Saving model ...
Epoch: 20 cost time: 0.8495621681213379
Epoch: 20, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.605 Vali Acc: 0.433 Test Loss: 1.605 Test Acc: 0.433
Validation loss decreased (-0.429613 --> -0.433317).  Saving model ...
Epoch: 21 cost time: 0.6955692768096924
Epoch: 21, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.593 Vali Acc: 0.448 Test Loss: 1.593 Test Acc: 0.448
Validation loss decreased (-0.433317 --> -0.448132).  Saving model ...
Epoch: 22 cost time: 0.7626538276672363
Epoch: 22, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.582 Vali Acc: 0.467 Test Loss: 1.582 Test Acc: 0.467
Validation loss decreased (-0.448132 --> -0.466651).  Saving model ...
Epoch: 23 cost time: 1.040215253829956
Epoch: 23, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.571 Vali Acc: 0.478 Test Loss: 1.571 Test Acc: 0.478
Validation loss decreased (-0.466651 --> -0.477762).  Saving model ...
Epoch: 24 cost time: 0.8343513011932373
Epoch: 24, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.560 Vali Acc: 0.485 Test Loss: 1.560 Test Acc: 0.485
Validation loss decreased (-0.477762 --> -0.485170).  Saving model ...
Epoch: 25 cost time: 0.9577116966247559
Epoch: 25, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.549 Vali Acc: 0.507 Test Loss: 1.549 Test Acc: 0.507
Validation loss decreased (-0.485170 --> -0.507392).  Saving model ...
Epoch: 26 cost time: 0.9623045921325684
Epoch: 26, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.538 Vali Acc: 0.526 Test Loss: 1.538 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 27 cost time: 0.6475801467895508
Epoch: 27, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.528 Vali Acc: 0.522 Test Loss: 1.528 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8110790252685547
Epoch: 28, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.519 Vali Acc: 0.515 Test Loss: 1.519 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8397941589355469
Epoch: 29, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.510 Vali Acc: 0.522 Test Loss: 1.510 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.766026496887207
Epoch: 30, Steps: 2 | Train Loss: 0.700 Vali Loss: 1.501 Vali Acc: 0.544 Test Loss: 1.501 Test Acc: 0.544
Validation loss decreased (-0.525911 --> -0.544429).  Saving model ...
Epoch: 31 cost time: 0.6963129043579102
Epoch: 31, Steps: 2 | Train Loss: 0.676 Vali Loss: 1.493 Vali Acc: 0.544 Test Loss: 1.493 Test Acc: 0.544
Validation loss decreased (-0.544429 --> -0.544430).  Saving model ...
Epoch: 32 cost time: 0.6900861263275146
Epoch: 32, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.484 Vali Acc: 0.552 Test Loss: 1.484 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551837).  Saving model ...
Epoch: 33 cost time: 0.7738821506500244
Epoch: 33, Steps: 2 | Train Loss: 0.604 Vali Loss: 1.475 Vali Acc: 0.563 Test Loss: 1.475 Test Acc: 0.563
Validation loss decreased (-0.551837 --> -0.562948).  Saving model ...
Epoch: 34 cost time: 0.9361701011657715
Epoch: 34, Steps: 2 | Train Loss: 0.592 Vali Loss: 1.465 Vali Acc: 0.559 Test Loss: 1.465 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7527549266815186
Epoch: 35, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.457 Vali Acc: 0.556 Test Loss: 1.457 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7468664646148682
Epoch: 36, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.447 Vali Acc: 0.570 Test Loss: 1.447 Test Acc: 0.570
Validation loss decreased (-0.562948 --> -0.570356).  Saving model ...
Epoch: 37 cost time: 0.8435771465301514
Epoch: 37, Steps: 2 | Train Loss: 0.497 Vali Loss: 1.438 Vali Acc: 0.567 Test Loss: 1.438 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5524392127990723
Epoch: 38, Steps: 2 | Train Loss: 0.470 Vali Loss: 1.430 Vali Acc: 0.574 Test Loss: 1.430 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 39 cost time: 0.6784212589263916
Epoch: 39, Steps: 2 | Train Loss: 0.467 Vali Loss: 1.422 Vali Acc: 0.574 Test Loss: 1.422 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 40 cost time: 0.7810976505279541
Epoch: 40, Steps: 2 | Train Loss: 0.448 Vali Loss: 1.414 Vali Acc: 0.570 Test Loss: 1.414 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9504187107086182
Epoch: 41, Steps: 2 | Train Loss: 0.407 Vali Loss: 1.406 Vali Acc: 0.570 Test Loss: 1.406 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7392876148223877
Epoch: 42, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.398 Vali Acc: 0.567 Test Loss: 1.398 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8303465843200684
Epoch: 43, Steps: 2 | Train Loss: 0.390 Vali Loss: 1.391 Vali Acc: 0.570 Test Loss: 1.391 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7689154148101807
Epoch: 44, Steps: 2 | Train Loss: 0.395 Vali Loss: 1.383 Vali Acc: 0.574 Test Loss: 1.383 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 45 cost time: 0.695838451385498
Epoch: 45, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.376 Vali Acc: 0.570 Test Loss: 1.376 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7456190586090088
Epoch: 46, Steps: 2 | Train Loss: 0.334 Vali Loss: 1.370 Vali Acc: 0.574 Test Loss: 1.370 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 47 cost time: 0.6814446449279785
Epoch: 47, Steps: 2 | Train Loss: 0.333 Vali Loss: 1.365 Vali Acc: 0.578 Test Loss: 1.365 Test Acc: 0.578
Validation loss decreased (-0.574060 --> -0.577764).  Saving model ...
Epoch: 48 cost time: 0.7642285823822021
Epoch: 48, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.359 Vali Acc: 0.581 Test Loss: 1.359 Test Acc: 0.581
Validation loss decreased (-0.577764 --> -0.581468).  Saving model ...
Epoch: 49 cost time: 0.6170039176940918
Epoch: 49, Steps: 2 | Train Loss: 0.303 Vali Loss: 1.354 Vali Acc: 0.593 Test Loss: 1.354 Test Acc: 0.593
Validation loss decreased (-0.581468 --> -0.592579).  Saving model ...
Epoch: 50 cost time: 0.5949833393096924
Epoch: 50, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.349 Vali Acc: 0.589 Test Loss: 1.349 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7114803791046143
Epoch: 51, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.345 Vali Acc: 0.589 Test Loss: 1.345 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7197051048278809
Epoch: 52, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.340 Vali Acc: 0.593 Test Loss: 1.340 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 53 cost time: 0.5694491863250732
Epoch: 53, Steps: 2 | Train Loss: 0.250 Vali Loss: 1.336 Vali Acc: 0.593 Test Loss: 1.336 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 54 cost time: 0.8227744102478027
Epoch: 54, Steps: 2 | Train Loss: 0.243 Vali Loss: 1.331 Vali Acc: 0.593 Test Loss: 1.331 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 55 cost time: 0.6843266487121582
Epoch: 55, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.326 Vali Acc: 0.593 Test Loss: 1.326 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 56 cost time: 0.7521405220031738
Epoch: 56, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.320 Vali Acc: 0.589 Test Loss: 1.320 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7130842208862305
Epoch: 57, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.316 Vali Acc: 0.593 Test Loss: 1.316 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 58 cost time: 0.654700756072998
Epoch: 58, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.311 Vali Acc: 0.596 Test Loss: 1.311 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 59 cost time: 0.5762066841125488
Epoch: 59, Steps: 2 | Train Loss: 0.197 Vali Loss: 1.307 Vali Acc: 0.596 Test Loss: 1.307 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 60 cost time: 0.7508983612060547
Epoch: 60, Steps: 2 | Train Loss: 0.188 Vali Loss: 1.304 Vali Acc: 0.596 Test Loss: 1.304 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 61 cost time: 0.6271910667419434
Epoch: 61, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
Validation loss decreased (-0.596283 --> -0.599987).  Saving model ...
Epoch: 62 cost time: 0.7476825714111328
Epoch: 62, Steps: 2 | Train Loss: 0.183 Vali Loss: 1.296 Vali Acc: 0.604 Test Loss: 1.296 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603691).  Saving model ...
Epoch: 63 cost time: 0.5827877521514893
Epoch: 63, Steps: 2 | Train Loss: 0.175 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7743527889251709
Epoch: 64, Steps: 2 | Train Loss: 0.151 Vali Loss: 1.288 Vali Acc: 0.596 Test Loss: 1.288 Test Acc: 0.596
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7023050785064697
Epoch: 65, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.284 Vali Acc: 0.593 Test Loss: 1.284 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.6678478717803955
Epoch: 66, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.282 Vali Acc: 0.596 Test Loss: 1.282 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5465145111083984
Epoch: 67, Steps: 2 | Train Loss: 0.148 Vali Loss: 1.278 Vali Acc: 0.596 Test Loss: 1.278 Test Acc: 0.596
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.962069034576416
Epoch: 68, Steps: 2 | Train Loss: 0.149 Vali Loss: 1.275 Vali Acc: 0.593 Test Loss: 1.275 Test Acc: 0.593
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.7233309745788574
Epoch: 69, Steps: 2 | Train Loss: 0.141 Vali Loss: 1.273 Vali Acc: 0.593 Test Loss: 1.273 Test Acc: 0.593
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.66214919090271
Epoch: 70, Steps: 2 | Train Loss: 0.140 Vali Loss: 1.270 Vali Acc: 0.596 Test Loss: 1.270 Test Acc: 0.596
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6148285865783691
Epoch: 71, Steps: 2 | Train Loss: 0.124 Vali Loss: 1.267 Vali Acc: 0.596 Test Loss: 1.267 Test Acc: 0.596
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.9759187698364258
Epoch: 72, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.265 Vali Acc: 0.596 Test Loss: 1.265 Test Acc: 0.596
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6037037037037037
model parameter : 35256
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4672255516052246
Epoch: 1, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.827 Vali Acc: 0.193 Test Loss: 1.827 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.6241745948791504
Epoch: 2, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.822 Vali Acc: 0.200 Test Loss: 1.822 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6643891334533691
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.817 Vali Acc: 0.200 Test Loss: 1.817 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.6055779457092285
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.811 Vali Acc: 0.207 Test Loss: 1.811 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 0.5500226020812988
Epoch: 5, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.803 Vali Acc: 0.211 Test Loss: 1.803 Test Acc: 0.211
Validation loss decreased (-0.207389 --> -0.211093).  Saving model ...
Epoch: 6 cost time: 0.578073263168335
Epoch: 6, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.795 Vali Acc: 0.222 Test Loss: 1.795 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222204).  Saving model ...
Epoch: 7 cost time: 0.725517988204956
Epoch: 7, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.784 Vali Acc: 0.222 Test Loss: 1.784 Test Acc: 0.222
Validation loss decreased (-0.222204 --> -0.222204).  Saving model ...
Epoch: 8 cost time: 0.7095005512237549
Epoch: 8, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.773 Vali Acc: 0.241 Test Loss: 1.773 Test Acc: 0.241
Validation loss decreased (-0.222204 --> -0.240723).  Saving model ...
Epoch: 9 cost time: 0.7537980079650879
Epoch: 9, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.761 Vali Acc: 0.252 Test Loss: 1.761 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 10 cost time: 0.7077672481536865
Epoch: 10, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.747 Vali Acc: 0.256 Test Loss: 1.747 Test Acc: 0.256
Validation loss decreased (-0.251834 --> -0.255538).  Saving model ...
Epoch: 11 cost time: 0.6772763729095459
Epoch: 11, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.733 Vali Acc: 0.274 Test Loss: 1.733 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274057).  Saving model ...
Epoch: 12 cost time: 0.7891056537628174
Epoch: 12, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.719 Vali Acc: 0.304 Test Loss: 1.719 Test Acc: 0.304
Validation loss decreased (-0.274057 --> -0.303687).  Saving model ...
Epoch: 13 cost time: 0.5318186283111572
Epoch: 13, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.704 Vali Acc: 0.311 Test Loss: 1.704 Test Acc: 0.311
Validation loss decreased (-0.303687 --> -0.311094).  Saving model ...
Epoch: 14 cost time: 0.8101673126220703
Epoch: 14, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.689 Vali Acc: 0.337 Test Loss: 1.689 Test Acc: 0.337
Validation loss decreased (-0.311094 --> -0.337020).  Saving model ...
Epoch: 15 cost time: 0.6838548183441162
Epoch: 15, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.674 Vali Acc: 0.352 Test Loss: 1.674 Test Acc: 0.352
Validation loss decreased (-0.337020 --> -0.351835).  Saving model ...
Epoch: 16 cost time: 0.6733436584472656
Epoch: 16, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.659 Vali Acc: 0.381 Test Loss: 1.659 Test Acc: 0.381
Validation loss decreased (-0.351835 --> -0.381465).  Saving model ...
Epoch: 17 cost time: 0.8960709571838379
Epoch: 17, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.645 Vali Acc: 0.393 Test Loss: 1.645 Test Acc: 0.393
Validation loss decreased (-0.381465 --> -0.392576).  Saving model ...
Epoch: 18 cost time: 0.9200625419616699
Epoch: 18, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.631 Vali Acc: 0.419 Test Loss: 1.631 Test Acc: 0.419
Validation loss decreased (-0.392576 --> -0.418502).  Saving model ...
Epoch: 19 cost time: 1.005241870880127
Epoch: 19, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.617 Vali Acc: 0.430 Test Loss: 1.617 Test Acc: 0.430
Validation loss decreased (-0.418502 --> -0.429613).  Saving model ...
Epoch: 20 cost time: 0.7176194190979004
Epoch: 20, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.605 Vali Acc: 0.433 Test Loss: 1.605 Test Acc: 0.433
Validation loss decreased (-0.429613 --> -0.433317).  Saving model ...
Epoch: 21 cost time: 0.5644214153289795
Epoch: 21, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.593 Vali Acc: 0.448 Test Loss: 1.593 Test Acc: 0.448
Validation loss decreased (-0.433317 --> -0.448132).  Saving model ...
Epoch: 22 cost time: 0.8537797927856445
Epoch: 22, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.582 Vali Acc: 0.467 Test Loss: 1.582 Test Acc: 0.467
Validation loss decreased (-0.448132 --> -0.466651).  Saving model ...
Epoch: 23 cost time: 0.717918872833252
Epoch: 23, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.571 Vali Acc: 0.478 Test Loss: 1.571 Test Acc: 0.478
Validation loss decreased (-0.466651 --> -0.477762).  Saving model ...
Epoch: 24 cost time: 0.7430605888366699
Epoch: 24, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.560 Vali Acc: 0.485 Test Loss: 1.560 Test Acc: 0.485
Validation loss decreased (-0.477762 --> -0.485170).  Saving model ...
Epoch: 25 cost time: 0.7728440761566162
Epoch: 25, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.549 Vali Acc: 0.507 Test Loss: 1.549 Test Acc: 0.507
Validation loss decreased (-0.485170 --> -0.507392).  Saving model ...
Epoch: 26 cost time: 0.6203615665435791
Epoch: 26, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.538 Vali Acc: 0.526 Test Loss: 1.538 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525911).  Saving model ...
Epoch: 27 cost time: 0.6426823139190674
Epoch: 27, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.528 Vali Acc: 0.522 Test Loss: 1.528 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6297299861907959
Epoch: 28, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.519 Vali Acc: 0.515 Test Loss: 1.519 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7309021949768066
Epoch: 29, Steps: 2 | Train Loss: 0.733 Vali Loss: 1.510 Vali Acc: 0.522 Test Loss: 1.510 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8126680850982666
Epoch: 30, Steps: 2 | Train Loss: 0.700 Vali Loss: 1.501 Vali Acc: 0.544 Test Loss: 1.501 Test Acc: 0.544
Validation loss decreased (-0.525911 --> -0.544429).  Saving model ...
Epoch: 31 cost time: 0.7747218608856201
Epoch: 31, Steps: 2 | Train Loss: 0.676 Vali Loss: 1.493 Vali Acc: 0.544 Test Loss: 1.493 Test Acc: 0.544
Validation loss decreased (-0.544429 --> -0.544430).  Saving model ...
Epoch: 32 cost time: 0.6356322765350342
Epoch: 32, Steps: 2 | Train Loss: 0.633 Vali Loss: 1.484 Vali Acc: 0.552 Test Loss: 1.484 Test Acc: 0.552
Validation loss decreased (-0.544430 --> -0.551837).  Saving model ...
Epoch: 33 cost time: 0.6693210601806641
Epoch: 33, Steps: 2 | Train Loss: 0.604 Vali Loss: 1.475 Vali Acc: 0.563 Test Loss: 1.475 Test Acc: 0.563
Validation loss decreased (-0.551837 --> -0.562948).  Saving model ...
Epoch: 34 cost time: 0.7070486545562744
Epoch: 34, Steps: 2 | Train Loss: 0.592 Vali Loss: 1.465 Vali Acc: 0.559 Test Loss: 1.465 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6840133666992188
Epoch: 35, Steps: 2 | Train Loss: 0.541 Vali Loss: 1.457 Vali Acc: 0.556 Test Loss: 1.457 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.77195143699646
Epoch: 36, Steps: 2 | Train Loss: 0.562 Vali Loss: 1.447 Vali Acc: 0.570 Test Loss: 1.447 Test Acc: 0.570
Validation loss decreased (-0.562948 --> -0.570356).  Saving model ...
Epoch: 37 cost time: 0.8199975490570068
Epoch: 37, Steps: 2 | Train Loss: 0.497 Vali Loss: 1.438 Vali Acc: 0.567 Test Loss: 1.438 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6116693019866943
Epoch: 38, Steps: 2 | Train Loss: 0.470 Vali Loss: 1.430 Vali Acc: 0.574 Test Loss: 1.430 Test Acc: 0.574
Validation loss decreased (-0.570356 --> -0.574060).  Saving model ...
Epoch: 39 cost time: 0.6869633197784424
Epoch: 39, Steps: 2 | Train Loss: 0.467 Vali Loss: 1.422 Vali Acc: 0.574 Test Loss: 1.422 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 40 cost time: 0.8500618934631348
Epoch: 40, Steps: 2 | Train Loss: 0.448 Vali Loss: 1.414 Vali Acc: 0.570 Test Loss: 1.414 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0118846893310547
Epoch: 41, Steps: 2 | Train Loss: 0.407 Vali Loss: 1.406 Vali Acc: 0.570 Test Loss: 1.406 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8695998191833496
Epoch: 42, Steps: 2 | Train Loss: 0.433 Vali Loss: 1.398 Vali Acc: 0.567 Test Loss: 1.398 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6194252967834473
Epoch: 43, Steps: 2 | Train Loss: 0.390 Vali Loss: 1.391 Vali Acc: 0.570 Test Loss: 1.391 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5476250648498535
Epoch: 44, Steps: 2 | Train Loss: 0.395 Vali Loss: 1.383 Vali Acc: 0.574 Test Loss: 1.383 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 45 cost time: 0.6793918609619141
Epoch: 45, Steps: 2 | Train Loss: 0.364 Vali Loss: 1.376 Vali Acc: 0.570 Test Loss: 1.376 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7432692050933838
Epoch: 46, Steps: 2 | Train Loss: 0.334 Vali Loss: 1.370 Vali Acc: 0.574 Test Loss: 1.370 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 47 cost time: 0.7396454811096191
Epoch: 47, Steps: 2 | Train Loss: 0.333 Vali Loss: 1.365 Vali Acc: 0.578 Test Loss: 1.365 Test Acc: 0.578
Validation loss decreased (-0.574060 --> -0.577764).  Saving model ...
Epoch: 48 cost time: 0.7922980785369873
Epoch: 48, Steps: 2 | Train Loss: 0.315 Vali Loss: 1.359 Vali Acc: 0.581 Test Loss: 1.359 Test Acc: 0.581
Validation loss decreased (-0.577764 --> -0.581468).  Saving model ...
Epoch: 49 cost time: 0.6595540046691895
Epoch: 49, Steps: 2 | Train Loss: 0.303 Vali Loss: 1.354 Vali Acc: 0.593 Test Loss: 1.354 Test Acc: 0.593
Validation loss decreased (-0.581468 --> -0.592579).  Saving model ...
Epoch: 50 cost time: 0.6276242733001709
Epoch: 50, Steps: 2 | Train Loss: 0.285 Vali Loss: 1.349 Vali Acc: 0.589 Test Loss: 1.349 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6180696487426758
Epoch: 51, Steps: 2 | Train Loss: 0.276 Vali Loss: 1.345 Vali Acc: 0.589 Test Loss: 1.345 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7184350490570068
Epoch: 52, Steps: 2 | Train Loss: 0.261 Vali Loss: 1.340 Vali Acc: 0.593 Test Loss: 1.340 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 53 cost time: 0.665900707244873
Epoch: 53, Steps: 2 | Train Loss: 0.250 Vali Loss: 1.336 Vali Acc: 0.593 Test Loss: 1.336 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 54 cost time: 0.7585160732269287
Epoch: 54, Steps: 2 | Train Loss: 0.243 Vali Loss: 1.331 Vali Acc: 0.593 Test Loss: 1.331 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 55 cost time: 0.6486537456512451
Epoch: 55, Steps: 2 | Train Loss: 0.230 Vali Loss: 1.326 Vali Acc: 0.593 Test Loss: 1.326 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 56 cost time: 0.5677874088287354
Epoch: 56, Steps: 2 | Train Loss: 0.227 Vali Loss: 1.320 Vali Acc: 0.589 Test Loss: 1.320 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7132999897003174
Epoch: 57, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.316 Vali Acc: 0.593 Test Loss: 1.316 Test Acc: 0.593
Validation loss decreased (-0.592579 --> -0.592579).  Saving model ...
Epoch: 58 cost time: 0.8192989826202393
Epoch: 58, Steps: 2 | Train Loss: 0.209 Vali Loss: 1.311 Vali Acc: 0.596 Test Loss: 1.311 Test Acc: 0.596
Validation loss decreased (-0.592579 --> -0.596283).  Saving model ...
Epoch: 59 cost time: 0.8907041549682617
Epoch: 59, Steps: 2 | Train Loss: 0.197 Vali Loss: 1.307 Vali Acc: 0.596 Test Loss: 1.307 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 60 cost time: 0.7701942920684814
Epoch: 60, Steps: 2 | Train Loss: 0.188 Vali Loss: 1.304 Vali Acc: 0.596 Test Loss: 1.304 Test Acc: 0.596
Validation loss decreased (-0.596283 --> -0.596283).  Saving model ...
Epoch: 61 cost time: 0.9890332221984863
Epoch: 61, Steps: 2 | Train Loss: 0.189 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
Validation loss decreased (-0.596283 --> -0.599987).  Saving model ...
Epoch: 62 cost time: 0.6551523208618164
Epoch: 62, Steps: 2 | Train Loss: 0.183 Vali Loss: 1.296 Vali Acc: 0.604 Test Loss: 1.296 Test Acc: 0.604
Validation loss decreased (-0.599987 --> -0.603691).  Saving model ...
Epoch: 63 cost time: 0.7065801620483398
Epoch: 63, Steps: 2 | Train Loss: 0.175 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.755563497543335
Epoch: 64, Steps: 2 | Train Loss: 0.151 Vali Loss: 1.288 Vali Acc: 0.596 Test Loss: 1.288 Test Acc: 0.596
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7844593524932861
Epoch: 65, Steps: 2 | Train Loss: 0.160 Vali Loss: 1.284 Vali Acc: 0.593 Test Loss: 1.284 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9302825927734375
Epoch: 66, Steps: 2 | Train Loss: 0.156 Vali Loss: 1.282 Vali Acc: 0.596 Test Loss: 1.282 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7012104988098145
Epoch: 67, Steps: 2 | Train Loss: 0.148 Vali Loss: 1.278 Vali Acc: 0.596 Test Loss: 1.278 Test Acc: 0.596
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9292488098144531
Epoch: 68, Steps: 2 | Train Loss: 0.149 Vali Loss: 1.275 Vali Acc: 0.593 Test Loss: 1.275 Test Acc: 0.593
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.804903507232666
Epoch: 69, Steps: 2 | Train Loss: 0.141 Vali Loss: 1.273 Vali Acc: 0.593 Test Loss: 1.273 Test Acc: 0.593
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5554218292236328
Epoch: 70, Steps: 2 | Train Loss: 0.140 Vali Loss: 1.270 Vali Acc: 0.596 Test Loss: 1.270 Test Acc: 0.596
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6740477085113525
Epoch: 71, Steps: 2 | Train Loss: 0.124 Vali Loss: 1.267 Vali Acc: 0.596 Test Loss: 1.267 Test Acc: 0.596
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.8319754600524902
Epoch: 72, Steps: 2 | Train Loss: 0.131 Vali Loss: 1.265 Vali Acc: 0.596 Test Loss: 1.265 Test Acc: 0.596
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_MTSMixer_UEA_ftM_sl65_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.6037037037037037
model parameter : 35256
model size : 0.14MB
