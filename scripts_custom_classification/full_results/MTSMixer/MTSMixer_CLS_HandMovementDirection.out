Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.298126459121704
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.350 Vali Acc: 0.378 Test Loss: 1.350 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 2.396083354949951
Epoch: 2, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8870058059692383
Epoch: 3, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.276 Vali Acc: 0.432 Test Loss: 1.276 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 2.2650699615478516
Epoch: 4, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 2.601055145263672
Epoch: 5, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.256136894226074
Epoch: 6, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 2.701899290084839
Epoch: 7, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 2.823935031890869
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.042 Vali Acc: 0.581 Test Loss: 1.042 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 2.8046741485595703
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 2.314497470855713
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6030197143554688
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.976 Vali Acc: 0.608 Test Loss: 0.976 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 2.477426290512085
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.962 Vali Acc: 0.608 Test Loss: 0.962 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 2.5693411827087402
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.956 Vali Acc: 0.608 Test Loss: 0.956 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 14 cost time: 2.8938517570495605
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.949 Vali Acc: 0.622 Test Loss: 0.949 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 15 cost time: 2.6920294761657715
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.944 Vali Acc: 0.622 Test Loss: 0.944 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 2.359081268310547
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.939 Vali Acc: 0.608 Test Loss: 0.939 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.381683111190796
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.939 Vali Acc: 0.608 Test Loss: 0.939 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.680360794067383
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.937 Vali Acc: 0.608 Test Loss: 0.937 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.876180648803711
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.935 Vali Acc: 0.608 Test Loss: 0.935 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.601541042327881
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.935 Vali Acc: 0.622 Test Loss: 0.935 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 21 cost time: 2.253969430923462
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.939 Vali Acc: 0.622 Test Loss: 0.939 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.508335828781128
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.933 Vali Acc: 0.622 Test Loss: 0.933 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 23 cost time: 2.739975690841675
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.931 Vali Acc: 0.622 Test Loss: 0.931 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 24 cost time: 2.6159186363220215
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 25 cost time: 2.2999253273010254
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.198258399963379
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.925 Vali Acc: 0.622 Test Loss: 0.925 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 27 cost time: 2.4262914657592773
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.929 Vali Acc: 0.622 Test Loss: 0.929 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4478487968444824
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.931 Vali Acc: 0.622 Test Loss: 0.931 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.34421443939209
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.928 Vali Acc: 0.622 Test Loss: 0.928 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.558485984802246
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.0100929737091064
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.928 Vali Acc: 0.622 Test Loss: 0.928 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.722407341003418
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.925 Vali Acc: 0.622 Test Loss: 0.925 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 33 cost time: 2.6563689708709717
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.937082529067993
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.622 Test Loss: 0.924 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 35 cost time: 2.4938127994537354
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.9947168827056885
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.925 Vali Acc: 0.622 Test Loss: 0.925 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.2197632789611816
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.925 Vali Acc: 0.622 Test Loss: 0.925 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.352720260620117
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.0003721714019775
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.925 Vali Acc: 0.622 Test Loss: 0.925 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.9041717052459717
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.622 Test Loss: 0.923 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 41 cost time: 2.9586238861083984
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.622 Test Loss: 0.923 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 42 cost time: 3.308922529220581
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.622 Test Loss: 0.923 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 43 cost time: 3.051760673522949
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.3066160678863525
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.089073896408081
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.2597720623016357
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.1417226791381836
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.056191921234131
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.951594591140747
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.608 Test Loss: 0.927 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.4133188724517822
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.608 Test Loss: 0.927 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.6571531295776367
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.622 Test Loss: 0.928 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.0596625804901123
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.608 Test Loss: 0.927 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1758020
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.973559617996216
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.377 Vali Acc: 0.311 Test Loss: 1.377 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.0721185207366943
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.314 Vali Acc: 0.324 Test Loss: 1.314 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 2.741419553756714
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.264 Vali Acc: 0.392 Test Loss: 1.264 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.4122166633605957
Epoch: 4, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.214 Vali Acc: 0.486 Test Loss: 1.214 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 2.050382614135742
Epoch: 5, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 2.124119997024536
Epoch: 6, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 2.3935203552246094
Epoch: 7, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.065 Vali Acc: 0.514 Test Loss: 1.065 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1423542499542236
Epoch: 8, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 2.383664131164551
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.973 Vali Acc: 0.608 Test Loss: 0.973 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 2.1867315769195557
Epoch: 10, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.997 Vali Acc: 0.527 Test Loss: 0.997 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.479865789413452
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.966 Vali Acc: 0.568 Test Loss: 0.966 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.690458059310913
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.955 Vali Acc: 0.568 Test Loss: 0.955 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.238966703414917
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.951 Vali Acc: 0.568 Test Loss: 0.951 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.078429937362671
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.952 Vali Acc: 0.581 Test Loss: 0.952 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2395973205566406
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.945 Vali Acc: 0.568 Test Loss: 0.945 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1624324321746826
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.951 Vali Acc: 0.581 Test Loss: 0.951 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4228084087371826
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.942 Vali Acc: 0.568 Test Loss: 0.942 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3306214809417725
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.938 Vali Acc: 0.568 Test Loss: 0.938 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5000081062316895
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.940 Vali Acc: 0.595 Test Loss: 0.940 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1737540
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7659249305725098
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.368 Vali Acc: 0.351 Test Loss: 1.368 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.095121383666992
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.278455972671509
Epoch: 3, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 2.0374467372894287
Epoch: 4, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 2.1941468715667725
Epoch: 5, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.155 Vali Acc: 0.581 Test Loss: 1.155 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 1.9364376068115234
Epoch: 6, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.092 Vali Acc: 0.554 Test Loss: 1.092 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.083961009979248
Epoch: 7, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 1.7589526176452637
Epoch: 8, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.035 Vali Acc: 0.568 Test Loss: 1.035 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0628249645233154
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.019 Vali Acc: 0.608 Test Loss: 1.019 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 2.148444175720215
Epoch: 10, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3583498001098633
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8929712772369385
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.996 Vali Acc: 0.568 Test Loss: 0.996 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3030190467834473
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.223742961883545
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.980 Vali Acc: 0.581 Test Loss: 0.980 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4946491718292236
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.980 Vali Acc: 0.581 Test Loss: 0.980 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1941561698913574
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 17 cost time: 2.121875762939453
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.967 Vali Acc: 0.595 Test Loss: 0.967 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.096139907836914
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.973 Vali Acc: 0.581 Test Loss: 0.973 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9426634311676025
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.968 Vali Acc: 0.581 Test Loss: 0.968 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0987446308135986
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.039848566055298
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.970 Vali Acc: 0.595 Test Loss: 0.970 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.280104875564575
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.966 Vali Acc: 0.595 Test Loss: 0.966 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.02219557762146
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.964 Vali Acc: 0.595 Test Loss: 0.964 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.017186403274536
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.969 Vali Acc: 0.595 Test Loss: 0.969 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.896902084350586
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.969 Vali Acc: 0.608 Test Loss: 0.969 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 26 cost time: 1.716313123703003
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.965 Vali Acc: 0.608 Test Loss: 0.965 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 27 cost time: 2.113213300704956
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.968 Vali Acc: 0.608 Test Loss: 0.968 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.88675856590271
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9584605693817139
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.967 Vali Acc: 0.608 Test Loss: 0.967 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.008188009262085
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.0434248447418213
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0245609283447266
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.967 Vali Acc: 0.608 Test Loss: 0.967 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9126017093658447
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.966 Vali Acc: 0.595 Test Loss: 0.966 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.3570945262908936
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.522836685180664
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.969 Vali Acc: 0.595 Test Loss: 0.969 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.767315149307251
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.967 Vali Acc: 0.595 Test Loss: 0.967 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1717060
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9913082122802734
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.438 Vali Acc: 0.203 Test Loss: 1.438 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.8723640441894531
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.343 Vali Acc: 0.351 Test Loss: 1.343 Test Acc: 0.351
Validation loss decreased (-0.202688 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.5597269535064697
Epoch: 3, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.259 Vali Acc: 0.419 Test Loss: 1.259 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.5533702373504639
Epoch: 4, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.783212661743164
Epoch: 5, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.5850577354431152
Epoch: 6, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.020 Vali Acc: 0.595 Test Loss: 1.020 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 1.5739068984985352
Epoch: 7, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.980 Vali Acc: 0.608 Test Loss: 0.980 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 1.7661030292510986
Epoch: 8, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.944 Vali Acc: 0.635 Test Loss: 0.944 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635126).  Saving model ...
Epoch: 9 cost time: 1.6540181636810303
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.924 Vali Acc: 0.622 Test Loss: 0.924 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.855330467224121
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.908 Vali Acc: 0.622 Test Loss: 0.908 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8404195308685303
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.905 Vali Acc: 0.635 Test Loss: 0.905 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 12 cost time: 1.947030782699585
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.908 Vali Acc: 0.649 Test Loss: 0.908 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648640).  Saving model ...
Epoch: 13 cost time: 2.114232301712036
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.899 Vali Acc: 0.635 Test Loss: 0.899 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2037065029144287
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.886 Vali Acc: 0.635 Test Loss: 0.886 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9754469394683838
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.887 Vali Acc: 0.635 Test Loss: 0.887 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0801162719726562
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.890 Vali Acc: 0.649 Test Loss: 0.890 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 17 cost time: 2.4258065223693848
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.887 Vali Acc: 0.635 Test Loss: 0.887 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9207789897918701
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.883 Vali Acc: 0.635 Test Loss: 0.883 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9826819896697998
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.881 Vali Acc: 0.649 Test Loss: 0.881 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 20 cost time: 1.9729626178741455
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.876 Vali Acc: 0.635 Test Loss: 0.876 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9742865562438965
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.877 Vali Acc: 0.622 Test Loss: 0.877 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8750097751617432
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.880 Vali Acc: 0.635 Test Loss: 0.880 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9545207023620605
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.881 Vali Acc: 0.649 Test Loss: 0.881 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 24 cost time: 1.861344337463379
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.881 Vali Acc: 0.662 Test Loss: 0.881 Test Acc: 0.662
Validation loss decreased (-0.648640 --> -0.662153).  Saving model ...
Epoch: 25 cost time: 1.925182580947876
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.880 Vali Acc: 0.662 Test Loss: 0.880 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 26 cost time: 1.5118257999420166
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.879 Vali Acc: 0.635 Test Loss: 0.879 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.97440505027771
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.881 Vali Acc: 0.635 Test Loss: 0.881 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8248260021209717
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.882 Vali Acc: 0.662 Test Loss: 0.882 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.974029302597046
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.881 Vali Acc: 0.635 Test Loss: 0.881 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9590868949890137
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.883 Vali Acc: 0.662 Test Loss: 0.883 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9622135162353516
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.880 Vali Acc: 0.635 Test Loss: 0.880 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0543508529663086
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.635 Test Loss: 0.878 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9944236278533936
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.635 Test Loss: 0.878 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0675809383392334
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.881 Vali Acc: 0.635 Test Loss: 0.881 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9190185070037842
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.880 Vali Acc: 0.635 Test Loss: 0.880 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1696580
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5228991508483887
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.455 Vali Acc: 0.230 Test Loss: 1.455 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.150040626525879
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.377 Vali Acc: 0.365 Test Loss: 1.377 Test Acc: 0.365
Validation loss decreased (-0.229715 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.0615284442901611
Epoch: 3, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.323 Vali Acc: 0.392 Test Loss: 1.323 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.2716639041900635
Epoch: 4, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.300 Vali Acc: 0.378 Test Loss: 1.300 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2715232372283936
Epoch: 5, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1853337287902832
Epoch: 6, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.172 Vali Acc: 0.473 Test Loss: 1.172 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0444386005401611
Epoch: 7, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.1456482410430908
Epoch: 8, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1411974430084229
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.073 Vali Acc: 0.514 Test Loss: 1.073 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.290010690689087
Epoch: 10, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.027367353439331
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.039 Vali Acc: 0.595 Test Loss: 1.039 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.4002130031585693
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 1.64717435836792
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2128880023956299
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.032 Vali Acc: 0.581 Test Loss: 1.032 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.150599479675293
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.029 Vali Acc: 0.581 Test Loss: 1.029 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3540966510772705
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1686151027679443
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.027 Vali Acc: 0.608 Test Loss: 1.027 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 18 cost time: 1.302957534790039
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.028 Vali Acc: 0.622 Test Loss: 1.028 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 19 cost time: 1.3023536205291748
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 20 cost time: 1.4556167125701904
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.027 Vali Acc: 0.608 Test Loss: 1.027 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3736436367034912
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.027 Vali Acc: 0.608 Test Loss: 1.027 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4637560844421387
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.025 Vali Acc: 0.622 Test Loss: 1.025 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 23 cost time: 1.273956298828125
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.622 Test Loss: 1.025 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 24 cost time: 1.3058087825775146
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.622 Test Loss: 1.025 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3705334663391113
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2749361991882324
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.026 Vali Acc: 0.622 Test Loss: 1.026 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.337078332901001
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4013919830322266
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2206451892852783
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.026 Vali Acc: 0.608 Test Loss: 1.026 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2407500743865967
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.028 Vali Acc: 0.608 Test Loss: 1.028 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3237450122833252
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.030 Vali Acc: 0.608 Test Loss: 1.030 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1286888122558594
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.031 Vali Acc: 0.608 Test Loss: 1.031 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5238430500030518
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.033 Vali Acc: 0.622 Test Loss: 1.033 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1680196
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.117567300796509
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.413 Vali Acc: 0.351 Test Loss: 1.413 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 1.2670753002166748
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.349 Vali Acc: 0.351 Test Loss: 1.349 Test Acc: 0.351
Validation loss decreased (-0.351337 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.2016723155975342
Epoch: 3, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.295 Vali Acc: 0.392 Test Loss: 1.295 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.2023909091949463
Epoch: 4, Steps: 10 | Train Loss: 0.772 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.170417308807373
Epoch: 5, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1850032806396484
Epoch: 6, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.1873688697814941
Epoch: 7, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 1.169435977935791
Epoch: 8, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 1.3136777877807617
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.007 Vali Acc: 0.595 Test Loss: 1.007 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1685380935668945
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 11 cost time: 1.2278287410736084
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.962 Vali Acc: 0.608 Test Loss: 0.962 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.1128993034362793
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.956 Vali Acc: 0.608 Test Loss: 0.956 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 13 cost time: 1.1402218341827393
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.958 Vali Acc: 0.635 Test Loss: 0.958 Test Acc: 0.635
Validation loss decreased (-0.608099 --> -0.635126).  Saving model ...
Epoch: 14 cost time: 1.0156655311584473
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.954 Vali Acc: 0.622 Test Loss: 0.954 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.124706745147705
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.952 Vali Acc: 0.608 Test Loss: 0.952 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2582135200500488
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.951 Vali Acc: 0.635 Test Loss: 0.951 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 17 cost time: 1.0935356616973877
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.948 Vali Acc: 0.635 Test Loss: 0.948 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 18 cost time: 1.0819075107574463
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.944 Vali Acc: 0.635 Test Loss: 0.944 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 19 cost time: 1.1656959056854248
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.946 Vali Acc: 0.635 Test Loss: 0.946 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1392340660095215
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.942 Vali Acc: 0.635 Test Loss: 0.942 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 21 cost time: 1.2497506141662598
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.940 Vali Acc: 0.635 Test Loss: 0.940 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 22 cost time: 1.1299395561218262
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.938 Vali Acc: 0.635 Test Loss: 0.938 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 23 cost time: 1.1603484153747559
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.939 Vali Acc: 0.635 Test Loss: 0.939 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0474638938903809
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.939 Vali Acc: 0.635 Test Loss: 0.939 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3847565650939941
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.937 Vali Acc: 0.635 Test Loss: 0.937 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 26 cost time: 1.0452897548675537
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.939 Vali Acc: 0.622 Test Loss: 0.939 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0768027305603027
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.937 Vali Acc: 0.622 Test Loss: 0.937 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9089322090148926
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.937 Vali Acc: 0.622 Test Loss: 0.937 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9821186065673828
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.935 Vali Acc: 0.622 Test Loss: 0.935 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1712257862091064
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.938 Vali Acc: 0.622 Test Loss: 0.938 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0869934558868408
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.622 Test Loss: 0.936 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0974576473236084
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.635 Test Loss: 0.934 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 33 cost time: 1.0029397010803223
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.635 Test Loss: 0.934 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2174286842346191
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.937 Vali Acc: 0.635 Test Loss: 0.937 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0497667789459229
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.937 Vali Acc: 0.635 Test Loss: 0.937 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9734201431274414
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.937 Vali Acc: 0.635 Test Loss: 0.937 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.003727674484253
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.622 Test Loss: 0.938 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0294461250305176
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.635 Test Loss: 0.939 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1882908344268799
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.635 Test Loss: 0.939 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9895145893096924
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.635 Test Loss: 0.940 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.248164415359497
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.635 Test Loss: 0.940 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1169352531433105
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.939 Vali Acc: 0.635 Test Loss: 0.939 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1672004
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6915650367736816
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.372 Vali Acc: 0.284 Test Loss: 1.372 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1344892978668213
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.361 Vali Acc: 0.351 Test Loss: 1.361 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.1793928146362305
Epoch: 3, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.285 Vali Acc: 0.419 Test Loss: 1.285 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.9000508785247803
Epoch: 4, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
Validation loss decreased (-0.418906 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 1.0469670295715332
Epoch: 5, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.160 Vali Acc: 0.554 Test Loss: 1.160 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.098301649093628
Epoch: 6, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.074 Vali Acc: 0.649 Test Loss: 1.074 Test Acc: 0.649
Validation loss decreased (-0.567556 --> -0.648638).  Saving model ...
Epoch: 7 cost time: 1.0772013664245605
Epoch: 7, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.049 Vali Acc: 0.649 Test Loss: 1.049 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 8 cost time: 0.985410213470459
Epoch: 8, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.007 Vali Acc: 0.649 Test Loss: 1.007 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 9 cost time: 0.919797420501709
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.982 Vali Acc: 0.662 Test Loss: 0.982 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 10 cost time: 0.8865854740142822
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.966 Vali Acc: 0.662 Test Loss: 0.966 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662153).  Saving model ...
Epoch: 11 cost time: 1.114776849746704
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.954 Vali Acc: 0.662 Test Loss: 0.954 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 12 cost time: 0.9403519630432129
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.953 Vali Acc: 0.662 Test Loss: 0.953 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 13 cost time: 1.034285306930542
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.951 Vali Acc: 0.676 Test Loss: 0.951 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 14 cost time: 1.0549683570861816
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.947 Vali Acc: 0.662 Test Loss: 0.947 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0926847457885742
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.942 Vali Acc: 0.662 Test Loss: 0.942 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1371068954467773
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.939 Vali Acc: 0.649 Test Loss: 0.939 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0745012760162354
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.940 Vali Acc: 0.662 Test Loss: 0.940 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2904925346374512
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.938 Vali Acc: 0.649 Test Loss: 0.938 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.021453619003296
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.939 Vali Acc: 0.662 Test Loss: 0.939 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9162530899047852
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.939 Vali Acc: 0.662 Test Loss: 0.939 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1850388050079346
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.937 Vali Acc: 0.662 Test Loss: 0.937 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1564984321594238
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.939 Vali Acc: 0.662 Test Loss: 0.939 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2541084289550781
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 1663812
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.636963129043579
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.7503247261047363
Epoch: 2, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.332 Vali Acc: 0.392 Test Loss: 1.332 Test Acc: 0.392
Validation loss decreased (-0.297284 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7610681056976318
Epoch: 3, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.829096794128418
Epoch: 4, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.8843305110931396
Epoch: 5, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.123 Vali Acc: 0.527 Test Loss: 1.123 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.689206600189209
Epoch: 6, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 0.7872567176818848
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.059 Vali Acc: 0.595 Test Loss: 1.059 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.7626199722290039
Epoch: 8, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.021 Vali Acc: 0.581 Test Loss: 1.021 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9533548355102539
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.005 Vali Acc: 0.581 Test Loss: 1.005 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7405126094818115
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.999 Vali Acc: 0.581 Test Loss: 0.999 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8091537952423096
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 12 cost time: 0.8974025249481201
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.998 Vali Acc: 0.595 Test Loss: 0.998 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 13 cost time: 0.8783555030822754
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.996 Vali Acc: 0.595 Test Loss: 0.996 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 14 cost time: 0.7967133522033691
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.991 Vali Acc: 0.608 Test Loss: 0.991 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 0.7132656574249268
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.992 Vali Acc: 0.608 Test Loss: 0.992 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8600058555603027
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.995 Vali Acc: 0.581 Test Loss: 0.995 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7940387725830078
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8042359352111816
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.992 Vali Acc: 0.581 Test Loss: 0.992 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7330174446105957
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.993 Vali Acc: 0.581 Test Loss: 0.993 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8443119525909424
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9666211605072021
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.995 Vali Acc: 0.581 Test Loss: 0.995 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.006957769393921
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.595 Test Loss: 0.996 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.723872184753418
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.581 Test Loss: 0.996 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7574746608734131
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.995 Vali Acc: 0.568 Test Loss: 0.995 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1657668
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7269415855407715
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.357 Vali Acc: 0.324 Test Loss: 1.357 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.8449795246124268
Epoch: 2, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 3.430213451385498
Epoch: 3, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.216 Vali Acc: 0.459 Test Loss: 1.216 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 3.0605053901672363
Epoch: 4, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 2.642256021499634
Epoch: 5, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
Validation loss decreased (-0.486475 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 3.4072439670562744
Epoch: 6, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 2.5313947200775146
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.037 Vali Acc: 0.581 Test Loss: 1.037 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0223236083984375
Epoch: 8, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 9 cost time: 3.3507471084594727
Epoch: 9, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.915 Vali Acc: 0.635 Test Loss: 0.915 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 10 cost time: 2.8984599113464355
Epoch: 10, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.903 Vali Acc: 0.649 Test Loss: 0.903 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648640).  Saving model ...
Epoch: 11 cost time: 2.698413848876953
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.882 Vali Acc: 0.649 Test Loss: 0.882 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 12 cost time: 2.9884836673736572
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.874 Vali Acc: 0.649 Test Loss: 0.874 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 13 cost time: 3.44319486618042
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.875 Vali Acc: 0.662 Test Loss: 0.875 Test Acc: 0.662
Validation loss decreased (-0.648640 --> -0.662153).  Saving model ...
Epoch: 14 cost time: 2.9956254959106445
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.861 Vali Acc: 0.662 Test Loss: 0.861 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662154).  Saving model ...
Epoch: 15 cost time: 3.150632619857788
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.863 Vali Acc: 0.662 Test Loss: 0.863 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8381435871124268
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.865 Vali Acc: 0.649 Test Loss: 0.865 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.726229429244995
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.858 Vali Acc: 0.649 Test Loss: 0.858 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.592445135116577
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.853 Vali Acc: 0.635 Test Loss: 0.853 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.872819185256958
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.851 Vali Acc: 0.662 Test Loss: 0.851 Test Acc: 0.662
Validation loss decreased (-0.662154 --> -0.662154).  Saving model ...
Epoch: 20 cost time: 3.1895387172698975
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.854 Vali Acc: 0.662 Test Loss: 0.854 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7434444427490234
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.847 Vali Acc: 0.662 Test Loss: 0.847 Test Acc: 0.662
Validation loss decreased (-0.662154 --> -0.662154).  Saving model ...
Epoch: 22 cost time: 2.978161096572876
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.849 Vali Acc: 0.662 Test Loss: 0.849 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8152143955230713
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.856 Vali Acc: 0.662 Test Loss: 0.856 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6578707695007324
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.856 Vali Acc: 0.676 Test Loss: 0.856 Test Acc: 0.676
Validation loss decreased (-0.662154 --> -0.675667).  Saving model ...
Epoch: 25 cost time: 2.8506875038146973
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.854 Vali Acc: 0.676 Test Loss: 0.854 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 26 cost time: 3.1644155979156494
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.856 Vali Acc: 0.676 Test Loss: 0.856 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.986553907394409
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.861 Vali Acc: 0.662 Test Loss: 0.861 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.643983840942383
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.859 Vali Acc: 0.662 Test Loss: 0.859 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8336029052734375
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.860 Vali Acc: 0.662 Test Loss: 0.860 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6807639598846436
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.855 Vali Acc: 0.662 Test Loss: 0.855 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2545089721679688
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.662 Test Loss: 0.862 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.7277309894561768
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.662 Test Loss: 0.862 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.003995656967163
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.662 Test Loss: 0.863 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.7568204402923584
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.864 Vali Acc: 0.662 Test Loss: 0.864 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.621746063232422
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.662 Test Loss: 0.863 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 1757852
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9460744857788086
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.516333818435669
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.380 Vali Acc: 0.311 Test Loss: 1.380 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.1411728858947754
Epoch: 3, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.360 Vali Acc: 0.351 Test Loss: 1.360 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 2.4247865676879883
Epoch: 4, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.281 Vali Acc: 0.392 Test Loss: 1.281 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 2.2826008796691895
Epoch: 5, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.231 Vali Acc: 0.432 Test Loss: 1.231 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.5114762783050537
Epoch: 6, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.3800532817840576
Epoch: 7, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8294312953948975
Epoch: 8, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 2.4386134147644043
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.131 Vali Acc: 0.568 Test Loss: 1.131 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 2.322361946105957
Epoch: 10, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.101 Vali Acc: 0.514 Test Loss: 1.101 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4107825756073
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 2.4996821880340576
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.28997540473938
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.104 Vali Acc: 0.568 Test Loss: 1.104 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4519946575164795
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.082 Vali Acc: 0.568 Test Loss: 1.082 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 2.6366539001464844
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.022721290588379
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.085 Vali Acc: 0.568 Test Loss: 1.085 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.157506227493286
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.087 Vali Acc: 0.568 Test Loss: 1.087 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.536424398422241
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4943785667419434
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9263129234313965
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.705698013305664
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8683745861053467
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.6095902919769287
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.57431697845459
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1737372
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9482529163360596
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.426 Vali Acc: 0.270 Test Loss: 1.426 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.856900691986084
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.343 Vali Acc: 0.324 Test Loss: 1.343 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.9763154983520508
Epoch: 3, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.309 Vali Acc: 0.351 Test Loss: 1.309 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 2.168037176132202
Epoch: 4, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.280 Vali Acc: 0.405 Test Loss: 1.280 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 2.496399164199829
Epoch: 5, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 2.644355297088623
Epoch: 6, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.1722676753997803
Epoch: 7, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.3276782035827637
Epoch: 8, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 2.112464427947998
Epoch: 9, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.062 Vali Acc: 0.541 Test Loss: 1.062 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 2.238898992538452
Epoch: 10, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.0046799182891846
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.052 Vali Acc: 0.541 Test Loss: 1.052 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9932348728179932
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 2.0886263847351074
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.030 Vali Acc: 0.554 Test Loss: 1.030 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 14 cost time: 2.720396041870117
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 2.2486941814422607
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 2.2724082469940186
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.021 Vali Acc: 0.554 Test Loss: 1.021 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3484556674957275
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.018 Vali Acc: 0.554 Test Loss: 1.018 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9919586181640625
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.327146291732788
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 20 cost time: 2.0426714420318604
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.009 Vali Acc: 0.581 Test Loss: 1.009 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 2.8683791160583496
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.011 Vali Acc: 0.581 Test Loss: 1.011 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8167221546173096
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.443437337875366
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.010 Vali Acc: 0.568 Test Loss: 1.010 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3193624019622803
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.009 Vali Acc: 0.595 Test Loss: 1.009 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 25 cost time: 2.422330141067505
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.270643472671509
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.002 Vali Acc: 0.568 Test Loss: 1.002 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1386032104492188
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.998 Vali Acc: 0.568 Test Loss: 0.998 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5715041160583496
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.001 Vali Acc: 0.581 Test Loss: 1.001 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6245529651641846
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.410238742828369
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9950988292694092
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.090317964553833
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.005 Vali Acc: 0.581 Test Loss: 1.005 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.3841216564178467
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 34 cost time: 2.389050245285034
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.5433924198150635
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3224573135375977
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.007 Vali Acc: 0.595 Test Loss: 1.007 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.4282424449920654
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.608 Test Loss: 1.004 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 38 cost time: 2.6187515258789062
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 39 cost time: 2.434478759765625
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.725200891494751
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.78376841545105
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.01578688621521
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.6284232139587402
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.608 Test Loss: 1.007 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.050053596496582
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.608 Test Loss: 1.007 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.7354624271392822
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.429802656173706
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.008 Vali Acc: 0.608 Test Loss: 1.008 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.4486212730407715
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.410003185272217
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1716892
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.213381290435791
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.432 Vali Acc: 0.311 Test Loss: 1.432 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.7175886631011963
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.390 Vali Acc: 0.365 Test Loss: 1.390 Test Acc: 0.365
Validation loss decreased (-0.310796 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.5567567348480225
Epoch: 3, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.328 Vali Acc: 0.405 Test Loss: 1.328 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.5578439235687256
Epoch: 4, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.259 Vali Acc: 0.432 Test Loss: 1.259 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.770911455154419
Epoch: 5, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.0264244079589844
Epoch: 6, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.5739996433258057
Epoch: 7, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.4878034591674805
Epoch: 8, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.8707056045532227
Epoch: 9, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.069 Vali Acc: 0.554 Test Loss: 1.069 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.5164122581481934
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.050 Vali Acc: 0.541 Test Loss: 1.050 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4950180053710938
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.044 Vali Acc: 0.527 Test Loss: 1.044 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3839194774627686
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.044 Vali Acc: 0.554 Test Loss: 1.044 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 1.4097230434417725
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.043 Vali Acc: 0.554 Test Loss: 1.043 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 14 cost time: 1.4438629150390625
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 15 cost time: 1.5772523880004883
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 16 cost time: 1.4430806636810303
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.028 Vali Acc: 0.541 Test Loss: 1.028 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4547080993652344
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.034 Vali Acc: 0.541 Test Loss: 1.034 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.05300235748291
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.035 Vali Acc: 0.541 Test Loss: 1.035 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4803545475006104
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.027 Vali Acc: 0.527 Test Loss: 1.027 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8043065071105957
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.029 Vali Acc: 0.541 Test Loss: 1.029 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7000863552093506
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.028 Vali Acc: 0.541 Test Loss: 1.028 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7157752513885498
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.031 Vali Acc: 0.541 Test Loss: 1.031 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4865872859954834
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.031 Vali Acc: 0.541 Test Loss: 1.031 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5745635032653809
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.029 Vali Acc: 0.541 Test Loss: 1.029 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1034271717071533
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 26 cost time: 1.9497430324554443
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8464820384979248
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.034 Vali Acc: 0.554 Test Loss: 1.034 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.114593982696533
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.034 Vali Acc: 0.554 Test Loss: 1.034 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.099090099334717
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8485887050628662
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.036 Vali Acc: 0.554 Test Loss: 1.036 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8955283164978027
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.038 Vali Acc: 0.554 Test Loss: 1.038 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9444448947906494
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.042 Vali Acc: 0.568 Test Loss: 1.042 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 33 cost time: 2.0116944313049316
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.447770118713379
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9025239944458008
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.2638192176818848
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.777559757232666
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.047 Vali Acc: 0.554 Test Loss: 1.047 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.9004719257354736
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.581 Test Loss: 1.046 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 39 cost time: 1.7841837406158447
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8980793952941895
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.094963312149048
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.279301643371582
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.0378382205963135
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.581 Test Loss: 1.055 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.2361223697662354
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.010509967803955
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.6931869983673096
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.8711469173431396
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.9143314361572266
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1696412
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4423468112945557
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.409 Vali Acc: 0.216 Test Loss: 1.409 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.5082411766052246
Epoch: 2, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.290 Vali Acc: 0.419 Test Loss: 1.290 Test Acc: 0.419
Validation loss decreased (-0.216202 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.8145415782928467
Epoch: 3, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.216 Vali Acc: 0.541 Test Loss: 1.216 Test Acc: 0.541
Validation loss decreased (-0.418906 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.781820297241211
Epoch: 4, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 1.6893534660339355
Epoch: 5, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.050 Vali Acc: 0.676 Test Loss: 1.050 Test Acc: 0.676
Validation loss decreased (-0.567556 --> -0.675665).  Saving model ...
Epoch: 6 cost time: 1.5776584148406982
Epoch: 6, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.995 Vali Acc: 0.676 Test Loss: 0.995 Test Acc: 0.676
Validation loss decreased (-0.675665 --> -0.675666).  Saving model ...
Epoch: 7 cost time: 1.83740234375
Epoch: 7, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.944 Vali Acc: 0.635 Test Loss: 0.944 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6193666458129883
Epoch: 8, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.909 Vali Acc: 0.676 Test Loss: 0.909 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675667).  Saving model ...
Epoch: 9 cost time: 1.4041147232055664
Epoch: 9, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.899 Vali Acc: 0.676 Test Loss: 0.899 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 10 cost time: 1.8487300872802734
Epoch: 10, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.858 Vali Acc: 0.676 Test Loss: 0.858 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 11 cost time: 1.8750357627868652
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.861 Vali Acc: 0.676 Test Loss: 0.861 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6709425449371338
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.864 Vali Acc: 0.676 Test Loss: 0.864 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5056350231170654
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.850 Vali Acc: 0.676 Test Loss: 0.850 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 14 cost time: 1.3000929355621338
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.854 Vali Acc: 0.676 Test Loss: 0.854 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4685626029968262
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.854 Vali Acc: 0.676 Test Loss: 0.854 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6123411655426025
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.849 Vali Acc: 0.676 Test Loss: 0.849 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 17 cost time: 1.7063183784484863
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.843 Vali Acc: 0.676 Test Loss: 0.843 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 18 cost time: 1.634465217590332
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.848 Vali Acc: 0.676 Test Loss: 0.848 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7745985984802246
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.850 Vali Acc: 0.676 Test Loss: 0.850 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8625876903533936
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.856 Vali Acc: 0.662 Test Loss: 0.856 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7400586605072021
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.854 Vali Acc: 0.676 Test Loss: 0.854 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6764860153198242
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.853 Vali Acc: 0.676 Test Loss: 0.853 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6956028938293457
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.851 Vali Acc: 0.676 Test Loss: 0.851 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6196229457855225
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.852 Vali Acc: 0.676 Test Loss: 0.852 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.497556447982788
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.858 Vali Acc: 0.662 Test Loss: 0.858 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7834644317626953
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.857 Vali Acc: 0.662 Test Loss: 0.857 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.616142749786377
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.858 Vali Acc: 0.662 Test Loss: 0.858 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 1680028
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4776382446289062
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.453 Vali Acc: 0.216 Test Loss: 1.453 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.2414381504058838
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.336 Vali Acc: 0.338 Test Loss: 1.336 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.0577237606048584
Epoch: 3, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.276 Vali Acc: 0.378 Test Loss: 1.276 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 1.208458662033081
Epoch: 4, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.378366 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.1327407360076904
Epoch: 5, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.9785528182983398
Epoch: 6, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.2193012237548828
Epoch: 7, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 1.0261437892913818
Epoch: 8, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4175746440887451
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.041 Vali Acc: 0.554 Test Loss: 1.041 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554044).  Saving model ...
Epoch: 10 cost time: 1.2936184406280518
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.043 Vali Acc: 0.527 Test Loss: 1.043 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1209304332733154
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.052 Vali Acc: 0.514 Test Loss: 1.052 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.180347204208374
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.043 Vali Acc: 0.527 Test Loss: 1.043 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4329335689544678
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.043 Vali Acc: 0.541 Test Loss: 1.043 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3614232540130615
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.041 Vali Acc: 0.514 Test Loss: 1.041 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.552988052368164
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.041 Vali Acc: 0.514 Test Loss: 1.041 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2531864643096924
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.041 Vali Acc: 0.514 Test Loss: 1.041 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2211971282958984
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.047 Vali Acc: 0.514 Test Loss: 1.047 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4369471073150635
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.042 Vali Acc: 0.486 Test Loss: 1.042 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1386749744415283
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.043 Vali Acc: 0.514 Test Loss: 1.043 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1671836
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9207370281219482
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.390 Vali Acc: 0.230 Test Loss: 1.390 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.2224359512329102
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.363 Vali Acc: 0.351 Test Loss: 1.363 Test Acc: 0.351
Validation loss decreased (-0.229716 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.2130625247955322
Epoch: 3, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.303 Vali Acc: 0.378 Test Loss: 1.303 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.1513960361480713
Epoch: 4, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1602880954742432
Epoch: 5, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.4219200611114502
Epoch: 6, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.048 Vali Acc: 0.608 Test Loss: 1.048 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 1.0036723613739014
Epoch: 7, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.984 Vali Acc: 0.635 Test Loss: 0.984 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 8 cost time: 1.2355225086212158
Epoch: 8, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.953 Vali Acc: 0.622 Test Loss: 0.953 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1812758445739746
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.932 Vali Acc: 0.608 Test Loss: 0.932 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.223844051361084
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.915 Vali Acc: 0.608 Test Loss: 0.915 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1751599311828613
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.900 Vali Acc: 0.608 Test Loss: 0.900 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3235142230987549
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.911 Vali Acc: 0.608 Test Loss: 0.911 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3154253959655762
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.916 Vali Acc: 0.635 Test Loss: 0.916 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 14 cost time: 1.320497989654541
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.902 Vali Acc: 0.635 Test Loss: 0.902 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 15 cost time: 1.3918488025665283
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.889 Vali Acc: 0.595 Test Loss: 0.889 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1399297714233398
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.891 Vali Acc: 0.622 Test Loss: 0.891 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1514346599578857
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.896 Vali Acc: 0.635 Test Loss: 0.896 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 18 cost time: 1.5838825702667236
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.899 Vali Acc: 0.635 Test Loss: 0.899 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0079233646392822
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.900 Vali Acc: 0.635 Test Loss: 0.900 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5034620761871338
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.902 Vali Acc: 0.635 Test Loss: 0.902 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4176521301269531
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.899 Vali Acc: 0.635 Test Loss: 0.899 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3441779613494873
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.900 Vali Acc: 0.635 Test Loss: 0.900 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3269987106323242
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.905 Vali Acc: 0.635 Test Loss: 0.905 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2980074882507324
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.903 Vali Acc: 0.635 Test Loss: 0.903 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2432010173797607
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.899 Vali Acc: 0.635 Test Loss: 0.899 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.155134677886963
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.900 Vali Acc: 0.635 Test Loss: 0.900 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1535632610321045
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.635 Test Loss: 0.902 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1663644
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.418454647064209
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.383 Vali Acc: 0.365 Test Loss: 1.383 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 0.9684309959411621
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.339 Vali Acc: 0.365 Test Loss: 1.339 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 0.7939836978912354
Epoch: 3, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.270 Vali Acc: 0.446 Test Loss: 1.270 Test Acc: 0.446
Validation loss decreased (-0.364851 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.9957714080810547
Epoch: 4, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8597941398620605
Epoch: 5, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.103 Vali Acc: 0.595 Test Loss: 1.103 Test Acc: 0.595
Validation loss decreased (-0.513502 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 0.913632869720459
Epoch: 6, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 1.3294298648834229
Epoch: 7, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.997 Vali Acc: 0.622 Test Loss: 0.997 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 8 cost time: 0.9126899242401123
Epoch: 8, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.968 Vali Acc: 0.581 Test Loss: 0.968 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9444217681884766
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.934 Vali Acc: 0.635 Test Loss: 0.934 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 10 cost time: 0.9008543491363525
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.937 Vali Acc: 0.622 Test Loss: 0.937 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1232414245605469
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.936 Vali Acc: 0.622 Test Loss: 0.936 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0257534980773926
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.933 Vali Acc: 0.608 Test Loss: 0.933 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9299085140228271
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.930 Vali Acc: 0.635 Test Loss: 0.930 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 14 cost time: 0.9618568420410156
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.922 Vali Acc: 0.622 Test Loss: 0.922 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5926525592803955
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.924 Vali Acc: 0.635 Test Loss: 0.924 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 16 cost time: 1.1799919605255127
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.925 Vali Acc: 0.635 Test Loss: 0.925 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0245790481567383
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.921 Vali Acc: 0.635 Test Loss: 0.921 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 18 cost time: 1.1199274063110352
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.923 Vali Acc: 0.649 Test Loss: 0.923 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 19 cost time: 1.04931640625
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.921 Vali Acc: 0.649 Test Loss: 0.921 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 20 cost time: 1.1717915534973145
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.108238935470581
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.928 Vali Acc: 0.662 Test Loss: 0.928 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 22 cost time: 1.2618441581726074
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.928 Vali Acc: 0.662 Test Loss: 0.928 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.419961929321289
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.930 Vali Acc: 0.662 Test Loss: 0.930 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0464534759521484
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.928 Vali Acc: 0.649 Test Loss: 0.928 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9940986633300781
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.929 Vali Acc: 0.649 Test Loss: 0.929 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0449113845825195
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.931 Vali Acc: 0.649 Test Loss: 0.931 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0035295486450195
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.929 Vali Acc: 0.649 Test Loss: 0.929 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9952175617218018
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.649 Test Loss: 0.933 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3877346515655518
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.088125467300415
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.649 Test Loss: 0.938 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.269360065460205
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.649 Test Loss: 0.940 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1657500
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.416783571243286
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.396 Vali Acc: 0.351 Test Loss: 1.396 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 4.585320711135864
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.384 Vali Acc: 0.203 Test Loss: 1.384 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.211195945739746
Epoch: 3, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.314 Vali Acc: 0.297 Test Loss: 1.314 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.0940046310424805
Epoch: 4, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.238 Vali Acc: 0.378 Test Loss: 1.238 Test Acc: 0.378
Validation loss decreased (-0.351337 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 4.393791913986206
Epoch: 5, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
Validation loss decreased (-0.378366 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 4.192078590393066
Epoch: 6, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 3.915625810623169
Epoch: 7, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 4.7752439975738525
Epoch: 8, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.040 Vali Acc: 0.568 Test Loss: 1.040 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 4.20665168762207
Epoch: 9, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.981 Vali Acc: 0.581 Test Loss: 0.981 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 3.597033739089966
Epoch: 10, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.959 Vali Acc: 0.608 Test Loss: 0.959 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608099).  Saving model ...
Epoch: 11 cost time: 4.491446256637573
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 12 cost time: 3.9789931774139404
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.948 Vali Acc: 0.595 Test Loss: 0.948 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0259575843811035
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.919 Vali Acc: 0.595 Test Loss: 0.919 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.685572624206543
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.918 Vali Acc: 0.595 Test Loss: 0.918 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.587513446807861
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.923 Vali Acc: 0.595 Test Loss: 0.923 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9589686393737793
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.914 Vali Acc: 0.595 Test Loss: 0.914 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.112386226654053
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.910 Vali Acc: 0.595 Test Loss: 0.910 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.249474287033081
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.910 Vali Acc: 0.595 Test Loss: 0.910 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.361508846282959
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.912 Vali Acc: 0.595 Test Loss: 0.912 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.8803353309631348
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.915 Vali Acc: 0.595 Test Loss: 0.915 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.4996726512908936
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.913 Vali Acc: 0.608 Test Loss: 0.913 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 22 cost time: 3.8477401733398438
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.917 Vali Acc: 0.608 Test Loss: 0.917 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6700069904327393
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.916 Vali Acc: 0.595 Test Loss: 0.916 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.034447193145752
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.919 Vali Acc: 0.595 Test Loss: 0.919 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.264206647872925
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.920 Vali Acc: 0.608 Test Loss: 0.920 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.152067184448242
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.922 Vali Acc: 0.608 Test Loss: 0.922 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.426983594894409
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.927 Vali Acc: 0.608 Test Loss: 0.927 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.299145221710205
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.927 Vali Acc: 0.608 Test Loss: 0.927 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.3849499225616455
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.930 Vali Acc: 0.608 Test Loss: 0.930 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.9043569564819336
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.934 Vali Acc: 0.608 Test Loss: 0.934 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.0084474086761475
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.934 Vali Acc: 0.608 Test Loss: 0.934 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1757768
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.40716028213501
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 3.3127877712249756
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.626051902770996
Epoch: 3, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.333 Vali Acc: 0.311 Test Loss: 1.333 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1406664848327637
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.272 Vali Acc: 0.405 Test Loss: 1.272 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 3.6330337524414062
Epoch: 5, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.257 Vali Acc: 0.378 Test Loss: 1.257 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.22811222076416
Epoch: 6, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 3.7865042686462402
Epoch: 7, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 3.050990343093872
Epoch: 8, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.174 Vali Acc: 0.459 Test Loss: 1.174 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3752362728118896
Epoch: 9, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.870260715484619
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.103 Vali Acc: 0.486 Test Loss: 1.103 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5565593242645264
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7885262966156006
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.075 Vali Acc: 0.500 Test Loss: 1.075 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7683956623077393
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.371093511581421
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.075 Vali Acc: 0.527 Test Loss: 1.075 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 3.424342632293701
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.082 Vali Acc: 0.527 Test Loss: 1.082 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9590132236480713
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.074 Vali Acc: 0.541 Test Loss: 1.074 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 17 cost time: 3.440882682800293
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.059 Vali Acc: 0.527 Test Loss: 1.059 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4818062782287598
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.786980390548706
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 20 cost time: 3.0941102504730225
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.199927806854248
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.073 Vali Acc: 0.527 Test Loss: 1.073 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0660064220428467
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9693210124969482
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 24 cost time: 3.746436357498169
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9136152267456055
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7848401069641113
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.086 Vali Acc: 0.541 Test Loss: 1.086 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3219308853149414
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4206840991973877
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.099 Vali Acc: 0.541 Test Loss: 1.099 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.362579107284546
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.099 Vali Acc: 0.541 Test Loss: 1.099 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.446854591369629
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.6706082820892334
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.127617120742798
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.1983277797698975
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.113 Vali Acc: 0.541 Test Loss: 1.113 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1737288
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.741351127624512
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.416 Vali Acc: 0.257 Test Loss: 1.416 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.4123499393463135
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.360 Vali Acc: 0.311 Test Loss: 1.360 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.702045440673828
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.304 Vali Acc: 0.405 Test Loss: 1.304 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.350149393081665
Epoch: 4, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.7881696224212646
Epoch: 5, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 2.513021230697632
Epoch: 6, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.189 Vali Acc: 0.486 Test Loss: 1.189 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.476881504058838
Epoch: 7, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 2.5026586055755615
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.086 Vali Acc: 0.541 Test Loss: 1.086 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 2.801495313644409
Epoch: 9, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 2.666741371154785
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.048 Vali Acc: 0.527 Test Loss: 1.048 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3194055557250977
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.010 Vali Acc: 0.514 Test Loss: 1.010 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5744009017944336
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 2.9080212116241455
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 2.324328660964966
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.020 Vali Acc: 0.541 Test Loss: 1.020 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1307034492492676
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.019 Vali Acc: 0.541 Test Loss: 1.019 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7667269706726074
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.020 Vali Acc: 0.541 Test Loss: 1.020 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.783907890319824
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 18 cost time: 3.1304407119750977
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.027 Vali Acc: 0.554 Test Loss: 1.027 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6929969787597656
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.025 Vali Acc: 0.554 Test Loss: 1.025 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7273759841918945
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.015 Vali Acc: 0.527 Test Loss: 1.015 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.421381711959839
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.014 Vali Acc: 0.527 Test Loss: 1.014 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6796183586120605
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.028 Vali Acc: 0.554 Test Loss: 1.028 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.0422203540802
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.6845664978027344
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.021 Vali Acc: 0.541 Test Loss: 1.021 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.1710901260375977
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.022 Vali Acc: 0.527 Test Loss: 1.022 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0598301887512207
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.541 Test Loss: 1.025 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6105403900146484
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.024 Vali Acc: 0.541 Test Loss: 1.024 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1716808
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.312270402908325
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.419 Vali Acc: 0.230 Test Loss: 1.419 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.7128376960754395
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.349 Vali Acc: 0.324 Test Loss: 1.349 Test Acc: 0.324
Validation loss decreased (-0.229716 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.8024048805236816
Epoch: 3, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.298 Vali Acc: 0.378 Test Loss: 1.298 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.9849653244018555
Epoch: 4, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.287 Vali Acc: 0.392 Test Loss: 1.287 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.889406442642212
Epoch: 5, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
Validation loss decreased (-0.391879 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.9169666767120361
Epoch: 6, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.155 Vali Acc: 0.581 Test Loss: 1.155 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.4868299961090088
Epoch: 7, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.525573492050171
Epoch: 8, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.69447922706604
Epoch: 9, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.000 Vali Acc: 0.541 Test Loss: 1.000 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9922657012939453
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.023 Vali Acc: 0.608 Test Loss: 1.023 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 1.7583942413330078
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.997 Vali Acc: 0.622 Test Loss: 0.997 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 1.5425333976745605
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.955 Vali Acc: 0.608 Test Loss: 0.955 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6753273010253906
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.959 Vali Acc: 0.622 Test Loss: 0.959 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 14 cost time: 2.0160717964172363
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.981 Vali Acc: 0.608 Test Loss: 0.981 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5738494396209717
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.980 Vali Acc: 0.608 Test Loss: 0.980 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3166911602020264
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.963 Vali Acc: 0.622 Test Loss: 0.963 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8630876541137695
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.966 Vali Acc: 0.608 Test Loss: 0.966 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6238353252410889
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.962 Vali Acc: 0.608 Test Loss: 0.962 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6311628818511963
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.971 Vali Acc: 0.622 Test Loss: 0.971 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8081574440002441
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.971 Vali Acc: 0.622 Test Loss: 0.971 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8645105361938477
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.972 Vali Acc: 0.622 Test Loss: 0.972 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2918026447296143
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.971 Vali Acc: 0.622 Test Loss: 0.971 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6271131038665771
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.972 Vali Acc: 0.622 Test Loss: 0.972 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1696328
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.587054491043091
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.408 Vali Acc: 0.230 Test Loss: 1.408 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.5022337436676025
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.372 Vali Acc: 0.243 Test Loss: 1.372 Test Acc: 0.243
Validation loss decreased (-0.229716 --> -0.243230).  Saving model ...
Epoch: 3 cost time: 1.480431318283081
Epoch: 3, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.318 Vali Acc: 0.311 Test Loss: 1.318 Test Acc: 0.311
Validation loss decreased (-0.243230 --> -0.310798).  Saving model ...
Epoch: 4 cost time: 1.5220956802368164
Epoch: 4, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.263 Vali Acc: 0.378 Test Loss: 1.263 Test Acc: 0.378
Validation loss decreased (-0.310798 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 1.4458990097045898
Epoch: 5, Steps: 10 | Train Loss: 0.583 Vali Loss: 1.190 Vali Acc: 0.432 Test Loss: 1.190 Test Acc: 0.432
Validation loss decreased (-0.378366 --> -0.432421).  Saving model ...
Epoch: 6 cost time: 1.6935114860534668
Epoch: 6, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.165 Vali Acc: 0.459 Test Loss: 1.165 Test Acc: 0.459
Validation loss decreased (-0.432421 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 1.5119538307189941
Epoch: 7, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.156 Vali Acc: 0.432 Test Loss: 1.156 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.468278169631958
Epoch: 8, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.708512544631958
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.075 Vali Acc: 0.527 Test Loss: 1.075 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.3598742485046387
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.085 Vali Acc: 0.459 Test Loss: 1.085 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4285926818847656
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 1.9501569271087646
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.5613179206848145
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.052 Vali Acc: 0.581 Test Loss: 1.052 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 1.6679894924163818
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.050 Vali Acc: 0.541 Test Loss: 1.050 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5337934494018555
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.047 Vali Acc: 0.554 Test Loss: 1.047 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6675524711608887
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 17 cost time: 1.4579505920410156
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 18 cost time: 1.6678223609924316
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7147817611694336
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.615983009338379
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.050 Vali Acc: 0.595 Test Loss: 1.050 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.36356782913208
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.049 Vali Acc: 0.595 Test Loss: 1.049 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6138813495635986
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.049 Vali Acc: 0.608 Test Loss: 1.049 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4362952709197998
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.046 Vali Acc: 0.622 Test Loss: 1.046 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5240445137023926
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8451733589172363
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.715125560760498
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.052 Vali Acc: 0.608 Test Loss: 1.052 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3312649726867676
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.055 Vali Acc: 0.608 Test Loss: 1.055 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1679944
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8897171020507812
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.390 Vali Acc: 0.257 Test Loss: 1.390 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.4939610958099365
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.386 Vali Acc: 0.311 Test Loss: 1.386 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.1995108127593994
Epoch: 3, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.333 Vali Acc: 0.365 Test Loss: 1.333 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.181999683380127
Epoch: 4, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.284 Vali Acc: 0.405 Test Loss: 1.284 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.1278951168060303
Epoch: 5, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.0789854526519775
Epoch: 6, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.189 Vali Acc: 0.473 Test Loss: 1.189 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3246872425079346
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.1102471351623535
Epoch: 8, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1464309692382812
Epoch: 9, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.483558177947998
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.074 Vali Acc: 0.581 Test Loss: 1.074 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.3454596996307373
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.4485547542572021
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3319323062896729
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6115169525146484
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.064 Vali Acc: 0.554 Test Loss: 1.064 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3897514343261719
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.650841236114502
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.071 Vali Acc: 0.554 Test Loss: 1.071 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2583520412445068
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6577033996582031
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6778483390808105
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6778109073638916
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.075 Vali Acc: 0.568 Test Loss: 1.075 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2655222415924072
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1671752
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8916099071502686
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.353 Vali Acc: 0.365 Test Loss: 1.353 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.0189118385314941
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1300508975982666
Epoch: 3, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.310 Vali Acc: 0.365 Test Loss: 1.310 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.1271076202392578
Epoch: 4, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.252 Vali Acc: 0.459 Test Loss: 1.252 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.095909833908081
Epoch: 5, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.157 Vali Acc: 0.568 Test Loss: 1.157 Test Acc: 0.568
Validation loss decreased (-0.459447 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.8561437129974365
Epoch: 6, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2779872417449951
Epoch: 7, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 1.0807411670684814
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 1.050055742263794
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.020 Vali Acc: 0.595 Test Loss: 1.020 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1018977165222168
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.0658574104309082
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 1.031508445739746
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.007 Vali Acc: 0.635 Test Loss: 1.007 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 13 cost time: 0.7972569465637207
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2002406120300293
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.015 Vali Acc: 0.622 Test Loss: 1.015 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0339293479919434
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.014 Vali Acc: 0.635 Test Loss: 1.014 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0299880504608154
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.020 Vali Acc: 0.622 Test Loss: 1.020 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9314804077148438
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.019 Vali Acc: 0.635 Test Loss: 1.019 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0660603046417236
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.025 Vali Acc: 0.635 Test Loss: 1.025 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9539709091186523
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.032 Vali Acc: 0.635 Test Loss: 1.032 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2639782428741455
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.032 Vali Acc: 0.635 Test Loss: 1.032 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.204291582107544
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.035 Vali Acc: 0.635 Test Loss: 1.035 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0334703922271729
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.040 Vali Acc: 0.635 Test Loss: 1.040 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1663560
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.861983060836792
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.447 Vali Acc: 0.284 Test Loss: 1.447 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 0.814760684967041
Epoch: 2, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.393 Vali Acc: 0.351 Test Loss: 1.393 Test Acc: 0.351
Validation loss decreased (-0.283769 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 0.845163106918335
Epoch: 3, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
Validation loss decreased (-0.351337 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.8003177642822266
Epoch: 4, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.258 Vali Acc: 0.392 Test Loss: 1.258 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0622954368591309
Epoch: 5, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.182 Vali Acc: 0.459 Test Loss: 1.182 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 0.8924989700317383
Epoch: 6, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.112 Vali Acc: 0.486 Test Loss: 1.112 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.8905003070831299
Epoch: 7, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.082 Vali Acc: 0.514 Test Loss: 1.082 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 0.9637398719787598
Epoch: 8, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.049 Vali Acc: 0.527 Test Loss: 1.049 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527017).  Saving model ...
Epoch: 9 cost time: 0.733443021774292
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.009 Vali Acc: 0.568 Test Loss: 1.009 Test Acc: 0.568
Validation loss decreased (-0.527017 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.9087557792663574
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.011 Vali Acc: 0.541 Test Loss: 1.011 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.07039475440979
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.014 Vali Acc: 0.541 Test Loss: 1.014 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1423699855804443
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.003 Vali Acc: 0.568 Test Loss: 1.003 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 13 cost time: 1.1307964324951172
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.988 Vali Acc: 0.568 Test Loss: 0.988 Test Acc: 0.568
Validation loss decreased (-0.567558 --> -0.567558).  Saving model ...
Epoch: 14 cost time: 1.1093928813934326
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.983 Vali Acc: 0.581 Test Loss: 0.983 Test Acc: 0.581
Validation loss decreased (-0.567558 --> -0.581071).  Saving model ...
Epoch: 15 cost time: 0.7439699172973633
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.985 Vali Acc: 0.568 Test Loss: 0.985 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1160426139831543
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.980 Vali Acc: 0.581 Test Loss: 0.980 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 17 cost time: 1.1707398891448975
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.980 Vali Acc: 0.581 Test Loss: 0.980 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 18 cost time: 0.8550560474395752
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.982 Vali Acc: 0.568 Test Loss: 0.982 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1806669235229492
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.980 Vali Acc: 0.581 Test Loss: 0.980 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9390273094177246
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.976 Vali Acc: 0.581 Test Loss: 0.976 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 0.8749518394470215
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.976 Vali Acc: 0.595 Test Loss: 0.976 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 22 cost time: 0.9791667461395264
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.975 Vali Acc: 0.581 Test Loss: 0.975 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.002380609512329
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.974 Vali Acc: 0.608 Test Loss: 0.974 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 24 cost time: 0.8890659809112549
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.595 Test Loss: 0.973 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9346659183502197
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.974 Vali Acc: 0.595 Test Loss: 0.974 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2879571914672852
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2210814952850342
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0782296657562256
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.976 Vali Acc: 0.595 Test Loss: 0.976 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3013103008270264
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.978 Vali Acc: 0.595 Test Loss: 0.978 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3337898254394531
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.978 Vali Acc: 0.595 Test Loss: 0.978 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0344359874725342
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.595 Test Loss: 0.980 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8848528861999512
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.595 Test Loss: 0.981 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.139172077178955
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.595 Test Loss: 0.982 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 1657416
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.434710502624512
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.406 Vali Acc: 0.203 Test Loss: 1.406 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 3.0471479892730713
Epoch: 2, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.340 Vali Acc: 0.311 Test Loss: 1.340 Test Acc: 0.311
Validation loss decreased (-0.202689 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 3.6479861736297607
Epoch: 3, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.246 Vali Acc: 0.459 Test Loss: 1.246 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 3.8228633403778076
Epoch: 4, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.181 Vali Acc: 0.568 Test Loss: 1.181 Test Acc: 0.568
Validation loss decreased (-0.459447 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 2.7101027965545654
Epoch: 5, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9857866764068604
Epoch: 6, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 3.053682327270508
Epoch: 7, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 2.8926188945770264
Epoch: 8, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.042 Vali Acc: 0.635 Test Loss: 1.042 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 3.1053314208984375
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.053 Vali Acc: 0.635 Test Loss: 1.053 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4343361854553223
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.107732534408569
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8492298126220703
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.029 Vali Acc: 0.622 Test Loss: 1.029 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9985692501068115
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.028 Vali Acc: 0.622 Test Loss: 1.028 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6601340770721436
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.032 Vali Acc: 0.622 Test Loss: 1.032 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4223475456237793
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.033 Vali Acc: 0.622 Test Loss: 1.033 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2001261711120605
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.028 Vali Acc: 0.635 Test Loss: 1.028 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 3.553576946258545
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.020 Vali Acc: 0.635 Test Loss: 1.020 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 18 cost time: 3.6203973293304443
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.022 Vali Acc: 0.635 Test Loss: 1.022 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7914257049560547
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.022 Vali Acc: 0.649 Test Loss: 1.022 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 20 cost time: 3.8862104415893555
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.025 Vali Acc: 0.635 Test Loss: 1.025 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3669581413269043
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.028 Vali Acc: 0.635 Test Loss: 1.028 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3825438022613525
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.027 Vali Acc: 0.635 Test Loss: 1.027 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6394169330596924
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.026 Vali Acc: 0.649 Test Loss: 1.026 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1838436126708984
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.019 Vali Acc: 0.635 Test Loss: 1.019 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.226323127746582
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.649 Test Loss: 1.017 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 26 cost time: 4.085597038269043
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.016 Vali Acc: 0.635 Test Loss: 1.016 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.525428056716919
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.015 Vali Acc: 0.649 Test Loss: 1.015 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 28 cost time: 3.061009645462036
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0903079509735107
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.014 Vali Acc: 0.635 Test Loss: 1.014 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.595593690872192
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.649 Test Loss: 1.011 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 31 cost time: 4.127641916275024
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.662 Test Loss: 1.011 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 32 cost time: 3.1754701137542725
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.662 Test Loss: 1.011 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 33 cost time: 2.871504545211792
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.009 Vali Acc: 0.649 Test Loss: 1.009 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.9815545082092285
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 35 cost time: 3.939323902130127
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.009 Vali Acc: 0.662 Test Loss: 1.009 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.777928113937378
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.7351815700531006
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.662 Test Loss: 1.011 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.3069565296173096
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.662 Test Loss: 1.015 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.4996044635772705
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.662 Test Loss: 1.011 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.5424106121063232
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.662 Test Loss: 1.010 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.606910467147827
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.4876294136047363
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.662 Test Loss: 1.009 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.983630418777466
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.662 Test Loss: 1.007 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 44 cost time: 3.3830220699310303
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.662 Test Loss: 1.007 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 45 cost time: 2.696699619293213
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.662 Test Loss: 1.005 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 46 cost time: 3.3352913856506348
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.662 Test Loss: 1.007 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.6778178215026855
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.2608306407928467
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.662 Test Loss: 1.010 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.3270182609558105
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.662 Test Loss: 1.011 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.8814632892608643
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.65858793258667
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.356323003768921
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.662 Test Loss: 1.003 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 53 cost time: 3.107692003250122
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.649 Test Loss: 1.003 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.3312551975250244
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.649 Test Loss: 1.005 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.219733476638794
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.958134889602661
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.662 Test Loss: 1.006 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.0285704135894775
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.662 Test Loss: 1.007 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.0306951999664307
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.662 Test Loss: 1.009 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.010230779647827
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.662 Test Loss: 1.012 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.118333578109741
Epoch: 60, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.649 Test Loss: 1.010 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.9960782527923584
Epoch: 61, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.649 Test Loss: 1.008 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.3587889671325684
Epoch: 62, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.649 Test Loss: 1.004 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1757664
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.374197483062744
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.365 Vali Acc: 0.351 Test Loss: 1.365 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.5820298194885254
Epoch: 2, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.308 Vali Acc: 0.405 Test Loss: 1.308 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 2.5064799785614014
Epoch: 3, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.228 Vali Acc: 0.554 Test Loss: 1.228 Test Acc: 0.554
Validation loss decreased (-0.405392 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 2.773764133453369
Epoch: 4, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.170 Vali Acc: 0.581 Test Loss: 1.170 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 5 cost time: 3.341254472732544
Epoch: 5, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0555803775787354
Epoch: 6, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.115 Vali Acc: 0.568 Test Loss: 1.115 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.838844060897827
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 3.3292272090911865
Epoch: 8, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.071 Vali Acc: 0.554 Test Loss: 1.071 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1665303707122803
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.082944393157959
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1175613403320312
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.3710672855377197
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.062 Vali Acc: 0.527 Test Loss: 1.062 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4717278480529785
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.057 Vali Acc: 0.541 Test Loss: 1.057 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6512985229492188
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.060 Vali Acc: 0.514 Test Loss: 1.060 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.473750114440918
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.056 Vali Acc: 0.527 Test Loss: 1.056 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.787177324295044
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.053 Vali Acc: 0.527 Test Loss: 1.053 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8370726108551025
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.051 Vali Acc: 0.527 Test Loss: 1.051 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1737184
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8371965885162354
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.848644733428955
Epoch: 2, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.293 Vali Acc: 0.446 Test Loss: 1.293 Test Acc: 0.446
Validation loss decreased (-0.270256 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.8737328052520752
Epoch: 3, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.030324935913086
Epoch: 4, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.145 Vali Acc: 0.581 Test Loss: 1.145 Test Acc: 0.581
Validation loss decreased (-0.445933 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 1.9991824626922607
Epoch: 5, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.105 Vali Acc: 0.622 Test Loss: 1.105 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 6 cost time: 1.737513542175293
Epoch: 6, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.090 Vali Acc: 0.622 Test Loss: 1.090 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 1.999258279800415
Epoch: 7, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1110808849334717
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3554749488830566
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.040 Vali Acc: 0.608 Test Loss: 1.040 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3603458404541016
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.035 Vali Acc: 0.622 Test Loss: 1.035 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 2.4465460777282715
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.025 Vali Acc: 0.635 Test Loss: 1.025 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 2.0868139266967773
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.022 Vali Acc: 0.608 Test Loss: 1.022 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5051112174987793
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.019 Vali Acc: 0.622 Test Loss: 1.019 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6111130714416504
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.017 Vali Acc: 0.622 Test Loss: 1.017 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8120980262756348
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.011 Vali Acc: 0.649 Test Loss: 1.011 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 2.1448166370391846
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8233428001403809
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.009 Vali Acc: 0.622 Test Loss: 1.009 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.108506202697754
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.327486753463745
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.006 Vali Acc: 0.635 Test Loss: 1.006 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.411210298538208
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3337008953094482
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8554248809814453
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5339956283569336
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.463245391845703
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.794565200805664
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.001 Vali Acc: 0.635 Test Loss: 1.001 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1716704
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.939385414123535
Epoch: 1, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.380 Vali Acc: 0.297 Test Loss: 1.380 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 2.054926872253418
Epoch: 2, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.312 Vali Acc: 0.351 Test Loss: 1.312 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.0775809288024902
Epoch: 3, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 2.401470184326172
Epoch: 4, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.7978248596191406
Epoch: 5, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.5298008918762207
Epoch: 6, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 1.601750373840332
Epoch: 7, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.3792574405670166
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 1.661027431488037
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.057 Vali Acc: 0.541 Test Loss: 1.057 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.557152509689331
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.052 Vali Acc: 0.541 Test Loss: 1.052 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.5672111511230469
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.052 Vali Acc: 0.541 Test Loss: 1.052 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 1.5648291110992432
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 1.6462202072143555
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.047 Vali Acc: 0.554 Test Loss: 1.047 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 14 cost time: 1.9636919498443604
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.046 Vali Acc: 0.554 Test Loss: 1.046 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 15 cost time: 1.681196928024292
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.043 Vali Acc: 0.554 Test Loss: 1.043 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 16 cost time: 2.2388246059417725
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 17 cost time: 1.9953229427337646
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.038 Vali Acc: 0.554 Test Loss: 1.038 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 18 cost time: 1.8346056938171387
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.038 Vali Acc: 0.554 Test Loss: 1.038 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 19 cost time: 1.8473098278045654
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 20 cost time: 1.9859623908996582
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 21 cost time: 1.7466907501220703
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.031 Vali Acc: 0.568 Test Loss: 1.031 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 22 cost time: 1.9202163219451904
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.030 Vali Acc: 0.568 Test Loss: 1.030 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 23 cost time: 1.8280632495880127
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.031 Vali Acc: 0.568 Test Loss: 1.031 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8036110401153564
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.568 Test Loss: 1.034 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9713773727416992
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3821115493774414
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.030 Vali Acc: 0.568 Test Loss: 1.030 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 27 cost time: 2.167985200881958
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 28 cost time: 1.585740089416504
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8533618450164795
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.581 Test Loss: 1.025 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 30 cost time: 1.802964210510254
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.581 Test Loss: 1.026 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.00866961479187
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.581 Test Loss: 1.026 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.158816337585449
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.581 Test Loss: 1.026 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.5165457725524902
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 34 cost time: 1.6320455074310303
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 35 cost time: 1.8093998432159424
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7394657135009766
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.568 Test Loss: 1.024 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8409333229064941
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.568 Test Loss: 1.023 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.72957181930542
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.568 Test Loss: 1.022 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8053009510040283
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.9230577945709229
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.9716897010803223
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.5814917087554932
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.581 Test Loss: 1.021 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 43 cost time: 1.8618113994598389
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.581 Test Loss: 1.021 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 44 cost time: 1.905843734741211
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.581 Test Loss: 1.020 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 45 cost time: 1.7393691539764404
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 46 cost time: 2.087611675262451
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 47 cost time: 1.8514745235443115
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 48 cost time: 1.6472249031066895
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.0279579162597656
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.9376623630523682
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 51 cost time: 1.9230186939239502
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.568 Test Loss: 1.016 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.9560456275939941
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.568 Test Loss: 1.016 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.0600216388702393
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.568 Test Loss: 1.017 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.230801582336426
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.568 Test Loss: 1.017 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.7442998886108398
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.581 Test Loss: 1.017 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 56 cost time: 1.5633299350738525
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.581 Test Loss: 1.015 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 57 cost time: 1.7922217845916748
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.3477401733398438
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.06071138381958
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.0332067012786865
Epoch: 60, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.9645094871520996
Epoch: 61, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.734318494796753
Epoch: 62, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.9695606231689453
Epoch: 63, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.8162007331848145
Epoch: 64, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.026848554611206
Epoch: 65, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.568 Test Loss: 1.016 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.6028692722320557
Epoch: 66, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.568 Test Loss: 1.015 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1696224
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8869528770446777
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.374 Vali Acc: 0.297 Test Loss: 1.374 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.3250763416290283
Epoch: 2, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.275 Vali Acc: 0.419 Test Loss: 1.275 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.326493263244629
Epoch: 3, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.409719467163086
Epoch: 4, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 1.5187656879425049
Epoch: 5, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 1.2701780796051025
Epoch: 6, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 7 cost time: 1.368851661682129
Epoch: 7, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 1.232541799545288
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
Validation loss decreased (-0.581071 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 1.36580228805542
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.018 Vali Acc: 0.608 Test Loss: 1.018 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8780839443206787
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2315027713775635
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1324703693389893
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.746497392654419
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.013 Vali Acc: 0.608 Test Loss: 1.013 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3637425899505615
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5216987133026123
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.008 Vali Acc: 0.608 Test Loss: 1.008 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3362646102905273
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.006 Vali Acc: 0.608 Test Loss: 1.006 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.603630781173706
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.007 Vali Acc: 0.608 Test Loss: 1.007 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2524442672729492
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.005 Vali Acc: 0.608 Test Loss: 1.005 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1679840
model size : 6.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0002222061157227
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.419 Vali Acc: 0.338 Test Loss: 1.419 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.342806100845337
Epoch: 2, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.336 Vali Acc: 0.446 Test Loss: 1.336 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.681368350982666
Epoch: 3, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.280869483947754
Epoch: 4, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3170599937438965
Epoch: 5, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.3916521072387695
Epoch: 6, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.2577903270721436
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.3658747673034668
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.2486767768859863
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 1.2463486194610596
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1490986347198486
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.065 Vali Acc: 0.622 Test Loss: 1.065 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 1.7004380226135254
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.066 Vali Acc: 0.622 Test Loss: 1.066 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3952176570892334
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.064 Vali Acc: 0.622 Test Loss: 1.064 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 14 cost time: 1.0512454509735107
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.060 Vali Acc: 0.608 Test Loss: 1.060 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4642457962036133
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.059 Vali Acc: 0.622 Test Loss: 1.059 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 16 cost time: 1.371739149093628
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.060 Vali Acc: 0.635 Test Loss: 1.060 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 1.590743064880371
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.061 Vali Acc: 0.622 Test Loss: 1.061 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.25266432762146
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3904798030853271
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.608 Test Loss: 1.058 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3935256004333496
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5335423946380615
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2626428604125977
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2150697708129883
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.622 Test Loss: 1.057 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.272895336151123
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.622 Test Loss: 1.056 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0666766166687012
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.098905324935913
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1671648
model size : 6.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6496100425720215
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.403 Vali Acc: 0.311 Test Loss: 1.403 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.1322503089904785
Epoch: 2, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.4076578617095947
Epoch: 3, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.0483744144439697
Epoch: 4, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.0472750663757324
Epoch: 5, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.115 Vali Acc: 0.568 Test Loss: 1.115 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.3461642265319824
Epoch: 6, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.090 Vali Acc: 0.608 Test Loss: 1.090 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 7 cost time: 1.2861626148223877
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.075 Vali Acc: 0.608 Test Loss: 1.075 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 0.9188604354858398
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.071 Vali Acc: 0.608 Test Loss: 1.071 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.055901288986206
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 1.149540901184082
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.064 Vali Acc: 0.608 Test Loss: 1.064 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0119760036468506
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.060 Vali Acc: 0.608 Test Loss: 1.060 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1514012813568115
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3025693893432617
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.057 Vali Acc: 0.595 Test Loss: 1.057 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4024617671966553
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.057 Vali Acc: 0.595 Test Loss: 1.057 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8724582195281982
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.055 Vali Acc: 0.608 Test Loss: 1.055 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9865260124206543
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.608 Test Loss: 1.054 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.870915412902832
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.608 Test Loss: 1.054 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8698868751525879
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0472748279571533
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1663456
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0726284980773926
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.381 Vali Acc: 0.257 Test Loss: 1.381 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.7985551357269287
Epoch: 2, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.273 Vali Acc: 0.486 Test Loss: 1.273 Test Acc: 0.486
Validation loss decreased (-0.256743 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 0.8461413383483887
Epoch: 3, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 1.004401683807373
Epoch: 4, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.061 Vali Acc: 0.622 Test Loss: 1.061 Test Acc: 0.622
Validation loss decreased (-0.554042 --> -0.621611).  Saving model ...
Epoch: 5 cost time: 0.8326706886291504
Epoch: 5, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6861429214477539
Epoch: 6, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.017 Vali Acc: 0.608 Test Loss: 1.017 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7676405906677246
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.999 Vali Acc: 0.635 Test Loss: 0.999 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 8 cost time: 0.8495919704437256
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.993 Vali Acc: 0.635 Test Loss: 0.993 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 0.9297714233398438
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.987 Vali Acc: 0.635 Test Loss: 0.987 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 10 cost time: 1.0064055919647217
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.983 Vali Acc: 0.635 Test Loss: 0.983 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 11 cost time: 0.8735840320587158
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.980 Vali Acc: 0.649 Test Loss: 0.980 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 0.9529457092285156
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.975 Vali Acc: 0.649 Test Loss: 0.975 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 1.219062089920044
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.635 Test Loss: 0.973 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.965935230255127
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.972 Vali Acc: 0.635 Test Loss: 0.972 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1218695640563965
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.973 Vali Acc: 0.635 Test Loss: 0.973 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9722230434417725
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.971 Vali Acc: 0.635 Test Loss: 0.971 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8330042362213135
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.970 Vali Acc: 0.635 Test Loss: 0.970 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0748264789581299
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.971 Vali Acc: 0.635 Test Loss: 0.971 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1099121570587158
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.968 Vali Acc: 0.635 Test Loss: 0.968 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9999814033508301
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.635 Test Loss: 0.966 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.162447214126587
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.635 Test Loss: 0.966 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7154927253723145
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.964 Vali Acc: 0.635 Test Loss: 0.964 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1657312
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.779527187347412
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.403 Vali Acc: 0.216 Test Loss: 1.403 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 4.160224914550781
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 3.48028302192688
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.342 Vali Acc: 0.297 Test Loss: 1.342 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 3.504950761795044
Epoch: 4, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.323 Vali Acc: 0.378 Test Loss: 1.323 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 4.198626756668091
Epoch: 5, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.276 Vali Acc: 0.405 Test Loss: 1.276 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 3.6694672107696533
Epoch: 6, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.243 Vali Acc: 0.419 Test Loss: 1.243 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 3.7341761589050293
Epoch: 7, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.200 Vali Acc: 0.446 Test Loss: 1.200 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 3.811633348464966
Epoch: 8, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 3.7751317024230957
Epoch: 9, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.2704453468322754
Epoch: 10, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 3.3015687465667725
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 3.485107421875
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 3.281162977218628
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.10249400138855
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.045304298400879
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 3.84309458732605
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.074 Vali Acc: 0.595 Test Loss: 1.074 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 3.5257277488708496
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.087 Vali Acc: 0.595 Test Loss: 1.087 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7336344718933105
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.074 Vali Acc: 0.595 Test Loss: 1.074 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 19 cost time: 3.955528736114502
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 20 cost time: 4.080068588256836
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 21 cost time: 4.009971380233765
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.019457817077637
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.53462553024292
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.071 Vali Acc: 0.608 Test Loss: 1.071 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.2480247020721436
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.7480452060699463
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.074 Vali Acc: 0.608 Test Loss: 1.074 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.348973035812378
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.321500301361084
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.077 Vali Acc: 0.595 Test Loss: 1.077 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.751791477203369
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.073 Vali Acc: 0.595 Test Loss: 1.073 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.295123338699341
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.333878517150879
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.079 Vali Acc: 0.595 Test Loss: 1.079 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 887620
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.898767709732056
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.360 Vali Acc: 0.338 Test Loss: 1.360 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 2.797318935394287
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.335 Vali Acc: 0.473 Test Loss: 1.335 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 2.630305290222168
Epoch: 3, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.309 Vali Acc: 0.473 Test Loss: 1.309 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 2.9424333572387695
Epoch: 4, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.247 Vali Acc: 0.514 Test Loss: 1.247 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 2.751648187637329
Epoch: 5, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.791106939315796
Epoch: 6, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 2.4642419815063477
Epoch: 7, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 3.2508723735809326
Epoch: 8, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 2.7131004333496094
Epoch: 9, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 2.9197371006011963
Epoch: 10, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 2.614086389541626
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6735007762908936
Epoch: 12, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.034 Vali Acc: 0.581 Test Loss: 1.034 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 2.6845529079437256
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.016 Vali Acc: 0.541 Test Loss: 1.016 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0012893676757812
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.023 Vali Acc: 0.581 Test Loss: 1.023 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 15 cost time: 2.9561872482299805
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7059640884399414
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.021 Vali Acc: 0.595 Test Loss: 1.021 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 3.0359747409820557
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.015 Vali Acc: 0.595 Test Loss: 1.015 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 18 cost time: 2.514272451400757
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.014 Vali Acc: 0.581 Test Loss: 1.014 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.760593891143799
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.017 Vali Acc: 0.595 Test Loss: 1.017 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0179080963134766
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.020 Vali Acc: 0.568 Test Loss: 1.020 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5267655849456787
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.811523675918579
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.023 Vali Acc: 0.554 Test Loss: 1.023 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.0579867362976074
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.022 Vali Acc: 0.568 Test Loss: 1.022 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4214982986450195
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.022 Vali Acc: 0.554 Test Loss: 1.022 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3474817276000977
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9789397716522217
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.758859634399414
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.026 Vali Acc: 0.554 Test Loss: 1.026 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 877380
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.486832618713379
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.424 Vali Acc: 0.257 Test Loss: 1.424 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.578906536102295
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.387 Vali Acc: 0.324 Test Loss: 1.387 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 2.291464328765869
Epoch: 3, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.350 Vali Acc: 0.365 Test Loss: 1.350 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 2.1288068294525146
Epoch: 4, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.308 Vali Acc: 0.419 Test Loss: 1.308 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.4196882247924805
Epoch: 5, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.247 Vali Acc: 0.405 Test Loss: 1.247 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6483583450317383
Epoch: 6, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.217 Vali Acc: 0.432 Test Loss: 1.217 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.362170457839966
Epoch: 7, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.165 Vali Acc: 0.459 Test Loss: 1.165 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 8 cost time: 2.8267781734466553
Epoch: 8, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.129 Vali Acc: 0.432 Test Loss: 1.129 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3859071731567383
Epoch: 9, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.101 Vali Acc: 0.446 Test Loss: 1.101 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.868600368499756
Epoch: 10, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.076 Vali Acc: 0.473 Test Loss: 1.076 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 11 cost time: 2.453963041305542
Epoch: 11, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.062 Vali Acc: 0.473 Test Loss: 1.062 Test Acc: 0.473
Validation loss decreased (-0.472962 --> -0.472962).  Saving model ...
Epoch: 12 cost time: 3.0973634719848633
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.047 Vali Acc: 0.459 Test Loss: 1.047 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8475379943847656
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.051 Vali Acc: 0.486 Test Loss: 1.051 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486476).  Saving model ...
Epoch: 14 cost time: 2.265083074569702
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.050 Vali Acc: 0.514 Test Loss: 1.050 Test Acc: 0.514
Validation loss decreased (-0.486476 --> -0.513503).  Saving model ...
Epoch: 15 cost time: 2.843888282775879
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.043 Vali Acc: 0.527 Test Loss: 1.043 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527017).  Saving model ...
Epoch: 16 cost time: 2.385791540145874
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.036 Vali Acc: 0.554 Test Loss: 1.036 Test Acc: 0.554
Validation loss decreased (-0.527017 --> -0.554044).  Saving model ...
Epoch: 17 cost time: 3.195141315460205
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.034 Vali Acc: 0.527 Test Loss: 1.034 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.642085075378418
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.030 Vali Acc: 0.554 Test Loss: 1.030 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 19 cost time: 2.4732775688171387
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.030 Vali Acc: 0.568 Test Loss: 1.030 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 20 cost time: 2.8274037837982178
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.034 Vali Acc: 0.581 Test Loss: 1.034 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 2.5940439701080322
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 22 cost time: 2.531165361404419
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.033 Vali Acc: 0.595 Test Loss: 1.033 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.752898931503296
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 24 cost time: 2.321523427963257
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.436774969100952
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 26 cost time: 2.331490993499756
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.032 Vali Acc: 0.608 Test Loss: 1.032 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 27 cost time: 2.2033305168151855
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.032 Vali Acc: 0.608 Test Loss: 1.032 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.37162709236145
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8238024711608887
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0475757122039795
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.3714427947998047
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 32 cost time: 1.9150934219360352
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 33 cost time: 1.8728022575378418
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8779468536376953
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.998844861984253
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.864891767501831
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.997556447982788
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.048966646194458
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.2164597511291504
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.8907461166381836
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.044 Vali Acc: 0.622 Test Loss: 1.044 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.887183427810669
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.044 Vali Acc: 0.622 Test Loss: 1.044 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.6146371364593506
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.043 Vali Acc: 0.622 Test Loss: 1.043 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 867140
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.009623289108276
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.452 Vali Acc: 0.176 Test Loss: 1.452 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 2.2768936157226562
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (-0.175661 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.9645042419433594
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.307 Vali Acc: 0.324 Test Loss: 1.307 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.664130449295044
Epoch: 4, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.263 Vali Acc: 0.459 Test Loss: 1.263 Test Acc: 0.459
Validation loss decreased (-0.324311 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.5679128170013428
Epoch: 5, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.222 Vali Acc: 0.473 Test Loss: 1.222 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.034217596054077
Epoch: 6, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.7666277885437012
Epoch: 7, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.106 Vali Acc: 0.486 Test Loss: 1.106 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.9512660503387451
Epoch: 8, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 9 cost time: 1.6930041313171387
Epoch: 9, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.047 Vali Acc: 0.486 Test Loss: 1.047 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7261276245117188
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.012 Vali Acc: 0.554 Test Loss: 1.012 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554044).  Saving model ...
Epoch: 11 cost time: 1.76912260055542
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.998 Vali Acc: 0.527 Test Loss: 0.998 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9112021923065186
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.983 Vali Acc: 0.554 Test Loss: 0.983 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 1.8896775245666504
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.978 Vali Acc: 0.595 Test Loss: 0.978 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594585).  Saving model ...
Epoch: 14 cost time: 2.1303939819335938
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.968 Vali Acc: 0.608 Test Loss: 0.968 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 1.7666749954223633
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.966 Vali Acc: 0.554 Test Loss: 0.966 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.19633412361145
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.960 Vali Acc: 0.554 Test Loss: 0.960 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.912764549255371
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.957 Vali Acc: 0.581 Test Loss: 0.957 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8637635707855225
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.954 Vali Acc: 0.581 Test Loss: 0.954 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.017771005630493
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.953 Vali Acc: 0.581 Test Loss: 0.953 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9628880023956299
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.953 Vali Acc: 0.581 Test Loss: 0.953 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7254161834716797
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.956 Vali Acc: 0.608 Test Loss: 0.956 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 22 cost time: 1.5888817310333252
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.953 Vali Acc: 0.595 Test Loss: 0.953 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5137429237365723
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.952 Vali Acc: 0.608 Test Loss: 0.952 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 24 cost time: 1.6402995586395264
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.954 Vali Acc: 0.608 Test Loss: 0.954 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6789276599884033
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.954 Vali Acc: 0.608 Test Loss: 0.954 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6228604316711426
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.954 Vali Acc: 0.608 Test Loss: 0.954 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4026997089385986
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.955 Vali Acc: 0.608 Test Loss: 0.955 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.302734375
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.956 Vali Acc: 0.622 Test Loss: 0.956 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 29 cost time: 1.5581512451171875
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.956 Vali Acc: 0.608 Test Loss: 0.956 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.597010612487793
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.957 Vali Acc: 0.622 Test Loss: 0.957 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4669127464294434
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.958 Vali Acc: 0.622 Test Loss: 0.958 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5026586055755615
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.958 Vali Acc: 0.622 Test Loss: 0.958 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.396442174911499
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.958 Vali Acc: 0.622 Test Loss: 0.958 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6055378913879395
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.959 Vali Acc: 0.622 Test Loss: 0.959 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.5629818439483643
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.959 Vali Acc: 0.622 Test Loss: 0.959 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7984566688537598
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.960 Vali Acc: 0.622 Test Loss: 0.960 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.7639975547790527
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.622 Test Loss: 0.959 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8477482795715332
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.622 Test Loss: 0.959 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 856900
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8585739135742188
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.414 Vali Acc: 0.311 Test Loss: 1.414 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.5952000617980957
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.412 Vali Acc: 0.284 Test Loss: 1.412 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.510227918624878
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.343 Vali Acc: 0.351 Test Loss: 1.343 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.2800679206848145
Epoch: 4, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.300 Vali Acc: 0.378 Test Loss: 1.300 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.3111140727996826
Epoch: 5, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.7515923976898193
Epoch: 6, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.841020107269287
Epoch: 7, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.6909658908843994
Epoch: 8, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.6955797672271729
Epoch: 9, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.009 Vali Acc: 0.554 Test Loss: 1.009 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 10 cost time: 1.2515861988067627
Epoch: 10, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 1.5033860206604004
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.981 Vali Acc: 0.568 Test Loss: 0.981 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6573212146759033
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.968 Vali Acc: 0.581 Test Loss: 0.968 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 1.2221784591674805
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.948 Vali Acc: 0.581 Test Loss: 0.948 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581072).  Saving model ...
Epoch: 14 cost time: 1.5718557834625244
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.943 Vali Acc: 0.595 Test Loss: 0.943 Test Acc: 0.595
Validation loss decreased (-0.581072 --> -0.594585).  Saving model ...
Epoch: 15 cost time: 1.7825095653533936
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.941 Vali Acc: 0.622 Test Loss: 0.941 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 1.8908812999725342
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.942 Vali Acc: 0.635 Test Loss: 0.942 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 17 cost time: 1.5844676494598389
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.943 Vali Acc: 0.622 Test Loss: 0.943 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8590989112854004
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.942 Vali Acc: 0.622 Test Loss: 0.942 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7729241847991943
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.938 Vali Acc: 0.622 Test Loss: 0.938 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5742342472076416
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7623109817504883
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8331191539764404
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.943 Vali Acc: 0.608 Test Loss: 0.943 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3921146392822266
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.941 Vali Acc: 0.622 Test Loss: 0.941 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5473065376281738
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.941 Vali Acc: 0.622 Test Loss: 0.941 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6784131526947021
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.941 Vali Acc: 0.622 Test Loss: 0.941 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3936753273010254
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.942 Vali Acc: 0.635 Test Loss: 0.942 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 848708
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.933793067932129
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.472 Vali Acc: 0.189 Test Loss: 1.472 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 1.250002384185791
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.411 Vali Acc: 0.257 Test Loss: 1.411 Test Acc: 0.257
Validation loss decreased (-0.189174 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.1931018829345703
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.356 Vali Acc: 0.392 Test Loss: 1.356 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 1.5054662227630615
Epoch: 4, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.311 Vali Acc: 0.405 Test Loss: 1.311 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.0729851722717285
Epoch: 5, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.242 Vali Acc: 0.473 Test Loss: 1.242 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.269784927368164
Epoch: 6, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.163 Vali Acc: 0.486 Test Loss: 1.163 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.367750883102417
Epoch: 7, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.1699481010437012
Epoch: 8, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.2106125354766846
Epoch: 9, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.068 Vali Acc: 0.527 Test Loss: 1.068 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.350705623626709
Epoch: 10, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.998 Vali Acc: 0.581 Test Loss: 0.998 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 1.1382718086242676
Epoch: 11, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.989 Vali Acc: 0.595 Test Loss: 0.989 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 12 cost time: 1.272472858428955
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4614193439483643
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.989 Vali Acc: 0.581 Test Loss: 0.989 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.247056484222412
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.979 Vali Acc: 0.595 Test Loss: 0.979 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 15 cost time: 1.0972139835357666
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.978 Vali Acc: 0.581 Test Loss: 0.978 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1174194812774658
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.976 Vali Acc: 0.595 Test Loss: 0.976 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 17 cost time: 1.3830721378326416
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.973 Vali Acc: 0.608 Test Loss: 0.973 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 18 cost time: 1.121598482131958
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.972 Vali Acc: 0.608 Test Loss: 0.972 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 19 cost time: 1.2481544017791748
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.974 Vali Acc: 0.608 Test Loss: 0.974 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4166696071624756
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.977 Vali Acc: 0.581 Test Loss: 0.977 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3337416648864746
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.976 Vali Acc: 0.581 Test Loss: 0.976 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2711493968963623
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.979 Vali Acc: 0.581 Test Loss: 0.979 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4691486358642578
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.976 Vali Acc: 0.622 Test Loss: 0.976 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 24 cost time: 1.2580556869506836
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.980 Vali Acc: 0.608 Test Loss: 0.980 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.405747890472412
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.979 Vali Acc: 0.622 Test Loss: 0.979 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1320993900299072
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.980 Vali Acc: 0.622 Test Loss: 0.980 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2750062942504883
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.983 Vali Acc: 0.622 Test Loss: 0.983 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3987352848052979
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 29 cost time: 1.3886322975158691
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.985 Vali Acc: 0.608 Test Loss: 0.985 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3007869720458984
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.986 Vali Acc: 0.635 Test Loss: 0.986 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2813372611999512
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.988 Vali Acc: 0.622 Test Loss: 0.988 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4916987419128418
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.993 Vali Acc: 0.608 Test Loss: 0.993 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3969366550445557
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.993 Vali Acc: 0.608 Test Loss: 0.993 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4186100959777832
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.990 Vali Acc: 0.622 Test Loss: 0.990 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3494091033935547
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.991 Vali Acc: 0.635 Test Loss: 0.991 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.533740758895874
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1122033596038818
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.997 Vali Acc: 0.622 Test Loss: 0.997 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2373313903808594
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.999 Vali Acc: 0.622 Test Loss: 0.999 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 844612
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3895225524902344
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.354 Vali Acc: 0.338 Test Loss: 1.354 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.9792301654815674
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.322 Vali Acc: 0.405 Test Loss: 1.322 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.9554450511932373
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.295 Vali Acc: 0.459 Test Loss: 1.295 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.096364974975586
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.237 Vali Acc: 0.527 Test Loss: 1.237 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.851809024810791
Epoch: 5, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.180 Vali Acc: 0.541 Test Loss: 1.180 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.0155260562896729
Epoch: 6, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.141 Vali Acc: 0.581 Test Loss: 1.141 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.1671569347381592
Epoch: 7, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.099 Vali Acc: 0.595 Test Loss: 1.099 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 1.0421645641326904
Epoch: 8, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.042 Vali Acc: 0.581 Test Loss: 1.042 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3080334663391113
Epoch: 9, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 1.210991621017456
Epoch: 10, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.002 Vali Acc: 0.595 Test Loss: 1.002 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 11 cost time: 1.121201753616333
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.978 Vali Acc: 0.608 Test Loss: 0.978 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.0134191513061523
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.966 Vali Acc: 0.608 Test Loss: 0.966 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 0.9327001571655273
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.968 Vali Acc: 0.608 Test Loss: 0.968 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9456031322479248
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.965 Vali Acc: 0.595 Test Loss: 0.965 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.28668212890625
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.961 Vali Acc: 0.608 Test Loss: 0.961 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 16 cost time: 1.0951058864593506
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.956 Vali Acc: 0.608 Test Loss: 0.956 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 17 cost time: 0.8553497791290283
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 18 cost time: 1.18605375289917
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3168132305145264
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.949 Vali Acc: 0.622 Test Loss: 0.949 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1020259857177734
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.952 Vali Acc: 0.635 Test Loss: 0.952 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 21 cost time: 1.2359273433685303
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.952 Vali Acc: 0.635 Test Loss: 0.952 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0671358108520508
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.954 Vali Acc: 0.635 Test Loss: 0.954 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.207369089126587
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.953 Vali Acc: 0.635 Test Loss: 0.953 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9313585758209229
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.955 Vali Acc: 0.635 Test Loss: 0.955 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9328691959381104
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.956 Vali Acc: 0.635 Test Loss: 0.956 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9727127552032471
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.953 Vali Acc: 0.635 Test Loss: 0.953 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9078884124755859
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.954 Vali Acc: 0.635 Test Loss: 0.954 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1024463176727295
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.956 Vali Acc: 0.635 Test Loss: 0.956 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9813268184661865
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.959 Vali Acc: 0.635 Test Loss: 0.959 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2622978687286377
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.957 Vali Acc: 0.635 Test Loss: 0.957 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 840516
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.810270071029663
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.816997766494751
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.352 Vali Acc: 0.324 Test Loss: 1.352 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.6974050998687744
Epoch: 3, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.297 Vali Acc: 0.419 Test Loss: 1.297 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.8597385883331299
Epoch: 4, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.246 Vali Acc: 0.432 Test Loss: 1.246 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.9121975898742676
Epoch: 5, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.174 Vali Acc: 0.446 Test Loss: 1.174 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.8930559158325195
Epoch: 6, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 0.8238356113433838
Epoch: 7, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.052 Vali Acc: 0.581 Test Loss: 1.052 Test Acc: 0.581
Validation loss decreased (-0.513503 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 0.8488569259643555
Epoch: 8, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 0.7850551605224609
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.962 Vali Acc: 0.595 Test Loss: 0.962 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 0.9078183174133301
Epoch: 10, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.926 Vali Acc: 0.568 Test Loss: 0.926 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.852895975112915
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.924 Vali Acc: 0.595 Test Loss: 0.924 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 12 cost time: 0.764493465423584
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.921 Vali Acc: 0.608 Test Loss: 0.921 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 13 cost time: 0.9048430919647217
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.911 Vali Acc: 0.608 Test Loss: 0.911 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 14 cost time: 0.7247309684753418
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.899 Vali Acc: 0.608 Test Loss: 0.899 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 15 cost time: 0.7734615802764893
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.897 Vali Acc: 0.622 Test Loss: 0.897 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621613).  Saving model ...
Epoch: 16 cost time: 0.8180811405181885
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.892 Vali Acc: 0.608 Test Loss: 0.892 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9581987857818604
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.890 Vali Acc: 0.622 Test Loss: 0.890 Test Acc: 0.622
Validation loss decreased (-0.621613 --> -0.621613).  Saving model ...
Epoch: 18 cost time: 0.9434511661529541
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.884 Vali Acc: 0.608 Test Loss: 0.884 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9352693557739258
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.881 Vali Acc: 0.608 Test Loss: 0.881 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8350725173950195
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.878 Vali Acc: 0.608 Test Loss: 0.878 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1055166721343994
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.877 Vali Acc: 0.608 Test Loss: 0.877 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9263432025909424
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.877 Vali Acc: 0.622 Test Loss: 0.877 Test Acc: 0.622
Validation loss decreased (-0.621613 --> -0.621613).  Saving model ...
Epoch: 23 cost time: 0.9653732776641846
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.873 Vali Acc: 0.622 Test Loss: 0.873 Test Acc: 0.622
Validation loss decreased (-0.621613 --> -0.621613).  Saving model ...
Epoch: 24 cost time: 1.0369155406951904
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.874 Vali Acc: 0.622 Test Loss: 0.874 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0795695781707764
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.874 Vali Acc: 0.622 Test Loss: 0.874 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.135972261428833
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.870 Vali Acc: 0.622 Test Loss: 0.870 Test Acc: 0.622
Validation loss decreased (-0.621613 --> -0.621613).  Saving model ...
Epoch: 27 cost time: 0.9130332469940186
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.635 Test Loss: 0.868 Test Acc: 0.635
Validation loss decreased (-0.621613 --> -0.635126).  Saving model ...
Epoch: 28 cost time: 0.9575948715209961
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.867 Vali Acc: 0.635 Test Loss: 0.867 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 29 cost time: 0.8399779796600342
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.622 Test Loss: 0.868 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1438186168670654
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.635 Test Loss: 0.866 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 31 cost time: 0.9727678298950195
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.635 Test Loss: 0.865 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 32 cost time: 0.7311875820159912
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.635 Test Loss: 0.866 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.253891944885254
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.622 Test Loss: 0.865 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9540145397186279
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.622 Test Loss: 0.865 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.993384599685669
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.622 Test Loss: 0.866 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9824895858764648
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.635 Test Loss: 0.866 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0451560020446777
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.867 Vali Acc: 0.635 Test Loss: 0.867 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8164350986480713
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.635 Test Loss: 0.866 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0216686725616455
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.635 Test Loss: 0.866 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9586427211761475
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.635 Test Loss: 0.866 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9220085144042969
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.622 Test Loss: 0.866 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 837444
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.273611545562744
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.375 Vali Acc: 0.324 Test Loss: 1.375 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 3.3126962184906006
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.384 Vali Acc: 0.338 Test Loss: 1.384 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 3.0573527812957764
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.345 Vali Acc: 0.351 Test Loss: 1.345 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 3.3369102478027344
Epoch: 4, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.280 Vali Acc: 0.432 Test Loss: 1.280 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 3.8675413131713867
Epoch: 5, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.256 Vali Acc: 0.446 Test Loss: 1.256 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 3.1078784465789795
Epoch: 6, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.256 Vali Acc: 0.432 Test Loss: 1.256 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7242648601531982
Epoch: 7, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 3.8575491905212402
Epoch: 8, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 2.9493401050567627
Epoch: 9, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.145 Vali Acc: 0.581 Test Loss: 1.145 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 3.0525715351104736
Epoch: 10, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.087 Vali Acc: 0.581 Test Loss: 1.087 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 2.921844244003296
Epoch: 11, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 3.105978488922119
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 3.355639696121216
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.074 Vali Acc: 0.608 Test Loss: 1.074 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0609524250030518
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.048 Vali Acc: 0.595 Test Loss: 1.048 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.204545736312866
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 16 cost time: 3.734281063079834
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.184585809707642
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.048 Vali Acc: 0.595 Test Loss: 1.048 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4293923377990723
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.09423828125
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.041 Vali Acc: 0.608 Test Loss: 1.041 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.8399434089660645
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.536109685897827
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.052 Vali Acc: 0.608 Test Loss: 1.052 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6533854007720947
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.055 Vali Acc: 0.595 Test Loss: 1.055 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.585089921951294
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.052 Vali Acc: 0.595 Test Loss: 1.052 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.432392120361328
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.048 Vali Acc: 0.608 Test Loss: 1.048 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.6737453937530518
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.053 Vali Acc: 0.595 Test Loss: 1.053 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 887452
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.790257215499878
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.427 Vali Acc: 0.284 Test Loss: 1.427 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.7801337242126465
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.549640655517578
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.370 Vali Acc: 0.392 Test Loss: 1.370 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 2.7342705726623535
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.329 Vali Acc: 0.378 Test Loss: 1.329 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8026301860809326
Epoch: 5, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.291 Vali Acc: 0.473 Test Loss: 1.291 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 2.946627616882324
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.257 Vali Acc: 0.473 Test Loss: 1.257 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 3.2327799797058105
Epoch: 7, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 2.642667531967163
Epoch: 8, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.161 Vali Acc: 0.473 Test Loss: 1.161 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.82958984375
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.555543899536133
Epoch: 10, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.5735018253326416
Epoch: 11, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7577457427978516
Epoch: 12, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 2.8919153213500977
Epoch: 13, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.023 Vali Acc: 0.514 Test Loss: 1.023 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0580132007598877
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.012 Vali Acc: 0.527 Test Loss: 1.012 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7760534286499023
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.008 Vali Acc: 0.554 Test Loss: 1.008 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 16 cost time: 2.6861491203308105
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.002 Vali Acc: 0.554 Test Loss: 1.002 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 17 cost time: 2.0313239097595215
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.002 Vali Acc: 0.554 Test Loss: 1.002 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 18 cost time: 2.7374072074890137
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.995 Vali Acc: 0.554 Test Loss: 0.995 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 19 cost time: 2.5347483158111572
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.991 Vali Acc: 0.554 Test Loss: 0.991 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 20 cost time: 3.2063982486724854
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.988 Vali Acc: 0.554 Test Loss: 0.988 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 21 cost time: 3.314002513885498
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.987 Vali Acc: 0.554 Test Loss: 0.987 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 22 cost time: 3.011239767074585
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.987 Vali Acc: 0.554 Test Loss: 0.987 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8182055950164795
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.988 Vali Acc: 0.568 Test Loss: 0.988 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567558).  Saving model ...
Epoch: 24 cost time: 3.092841863632202
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.988 Vali Acc: 0.581 Test Loss: 0.988 Test Acc: 0.581
Validation loss decreased (-0.567558 --> -0.581071).  Saving model ...
Epoch: 25 cost time: 2.7633988857269287
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.983 Vali Acc: 0.568 Test Loss: 0.983 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9654479026794434
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.981 Vali Acc: 0.568 Test Loss: 0.981 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6406171321868896
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.981 Vali Acc: 0.568 Test Loss: 0.981 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2954061031341553
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.982 Vali Acc: 0.568 Test Loss: 0.982 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4139556884765625
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.986 Vali Acc: 0.581 Test Loss: 0.986 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 30 cost time: 2.3808248043060303
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.982 Vali Acc: 0.581 Test Loss: 0.982 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 31 cost time: 3.1207919120788574
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.980 Vali Acc: 0.581 Test Loss: 0.980 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 32 cost time: 2.9485011100769043
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.982 Vali Acc: 0.581 Test Loss: 0.982 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.508838176727295
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.985 Vali Acc: 0.581 Test Loss: 0.985 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.7393109798431396
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.984 Vali Acc: 0.581 Test Loss: 0.984 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.8369455337524414
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.984 Vali Acc: 0.581 Test Loss: 0.984 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.5865871906280518
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.984 Vali Acc: 0.568 Test Loss: 0.984 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.532672166824341
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.983 Vali Acc: 0.581 Test Loss: 0.983 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.1588847637176514
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.983 Vali Acc: 0.581 Test Loss: 0.983 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.576935052871704
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.985 Vali Acc: 0.581 Test Loss: 0.985 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.434122323989868
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.986 Vali Acc: 0.581 Test Loss: 0.986 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.1756136417388916
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.988 Vali Acc: 0.581 Test Loss: 0.988 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 877212
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7955002784729
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.455 Vali Acc: 0.176 Test Loss: 1.455 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 2.1684200763702393
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.424 Vali Acc: 0.230 Test Loss: 1.424 Test Acc: 0.230
Validation loss decreased (-0.175661 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 1.931368112564087
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.413 Vali Acc: 0.257 Test Loss: 1.413 Test Acc: 0.257
Validation loss decreased (-0.229715 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 2.2091546058654785
Epoch: 4, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.339 Vali Acc: 0.284 Test Loss: 1.339 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 2.150574207305908
Epoch: 5, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.298 Vali Acc: 0.405 Test Loss: 1.298 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 2.356473207473755
Epoch: 6, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.275 Vali Acc: 0.432 Test Loss: 1.275 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.2023799419403076
Epoch: 7, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.5060489177703857
Epoch: 8, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.160 Vali Acc: 0.554 Test Loss: 1.160 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 2.350748300552368
Epoch: 9, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9317317008972168
Epoch: 10, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 1.908637523651123
Epoch: 11, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.055 Vali Acc: 0.595 Test Loss: 1.055 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.9867188930511475
Epoch: 12, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 13 cost time: 2.7450478076934814
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.034 Vali Acc: 0.595 Test Loss: 1.034 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0246803760528564
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.008 Vali Acc: 0.581 Test Loss: 1.008 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.925842523574829
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.018 Vali Acc: 0.608 Test Loss: 1.018 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 16 cost time: 1.8753583431243896
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.004 Vali Acc: 0.635 Test Loss: 1.004 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 2.113032102584839
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.987 Vali Acc: 0.608 Test Loss: 0.987 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.128690004348755
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1160974502563477
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7122232913970947
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.980 Vali Acc: 0.622 Test Loss: 0.980 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1149322986602783
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.974 Vali Acc: 0.649 Test Loss: 0.974 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 22 cost time: 1.95375394821167
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.967 Vali Acc: 0.649 Test Loss: 0.967 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 23 cost time: 1.8956034183502197
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.967 Vali Acc: 0.649 Test Loss: 0.967 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9705724716186523
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 25 cost time: 2.222672700881958
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.965 Vali Acc: 0.635 Test Loss: 0.965 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9838368892669678
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 27 cost time: 2.147043466567993
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 28 cost time: 1.9646568298339844
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.955 Vali Acc: 0.635 Test Loss: 0.955 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2931501865386963
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.947 Vali Acc: 0.662 Test Loss: 0.947 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 30 cost time: 2.0146191120147705
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.945 Vali Acc: 0.676 Test Loss: 0.945 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 31 cost time: 2.630187749862671
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.947 Vali Acc: 0.676 Test Loss: 0.947 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3744864463806152
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.949 Vali Acc: 0.676 Test Loss: 0.949 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.232722759246826
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.947 Vali Acc: 0.676 Test Loss: 0.947 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.1396172046661377
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.946 Vali Acc: 0.676 Test Loss: 0.946 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.851823329925537
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.943 Vali Acc: 0.676 Test Loss: 0.943 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 36 cost time: 2.0617096424102783
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.940 Vali Acc: 0.676 Test Loss: 0.940 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 37 cost time: 2.4575464725494385
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.941 Vali Acc: 0.676 Test Loss: 0.941 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.5736031532287598
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.942 Vali Acc: 0.676 Test Loss: 0.942 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.9280147552490234
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.943 Vali Acc: 0.676 Test Loss: 0.943 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.1415297985076904
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.676 Test Loss: 0.944 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.7694272994995117
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.676 Test Loss: 0.944 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.0453481674194336
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.941 Vali Acc: 0.676 Test Loss: 0.941 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.413423776626587
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 44 cost time: 2.7444651126861572
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.676 Test Loss: 0.936 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 45 cost time: 2.7406668663024902
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.676 Test Loss: 0.936 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.3693795204162598
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.676 Test Loss: 0.936 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.398817300796509
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.676 Test Loss: 0.938 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.2746691703796387
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.5303196907043457
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.2557966709136963
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.689 Test Loss: 0.938 Test Acc: 0.689
Validation loss decreased (-0.675666 --> -0.689180).  Saving model ...
Epoch: 51 cost time: 2.5257909297943115
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.689 Test Loss: 0.938 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.0386862754821777
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.937 Vali Acc: 0.689 Test Loss: 0.937 Test Acc: 0.689
Validation loss decreased (-0.689180 --> -0.689180).  Saving model ...
Epoch: 53 cost time: 2.342571496963501
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.689 Test Loss: 0.934 Test Acc: 0.689
Validation loss decreased (-0.689180 --> -0.689180).  Saving model ...
Epoch: 54 cost time: 2.234165906906128
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.689 Test Loss: 0.936 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.238555908203125
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
Validation loss decreased (-0.689180 --> -0.702693).  Saving model ...
Epoch: 56 cost time: 2.7450203895568848
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.703 Test Loss: 0.933 Test Acc: 0.703
Validation loss decreased (-0.702693 --> -0.702693).  Saving model ...
Epoch: 57 cost time: 2.4169135093688965
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.703 Test Loss: 0.933 Test Acc: 0.703
Validation loss decreased (-0.702693 --> -0.702693).  Saving model ...
Epoch: 58 cost time: 2.568124771118164
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.971769332885742
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.7402350902557373
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.4775583744049072
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.703 Test Loss: 0.936 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.6060869693756104
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.703 Test Loss: 0.934 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.516810178756714
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.703 Test Loss: 0.934 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.2915141582489014
Epoch: 64, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.703 Test Loss: 0.933 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.5738525390625
Epoch: 65, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.703 Test Loss: 0.932 Test Acc: 0.703
Validation loss decreased (-0.702693 --> -0.702693).  Saving model ...
Epoch: 66 cost time: 2.400085210800171
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.703 Test Loss: 0.932 Test Acc: 0.703
Validation loss decreased (-0.702693 --> -0.702693).  Saving model ...
Epoch: 67 cost time: 2.345506429672241
Epoch: 67, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.703 Test Loss: 0.932 Test Acc: 0.703
Validation loss decreased (-0.702693 --> -0.702693).  Saving model ...
Epoch: 68 cost time: 2.32844614982605
Epoch: 68, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.703 Test Loss: 0.933 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.800313711166382
Epoch: 69, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.703 Test Loss: 0.934 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.377372980117798
Epoch: 70, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 2.3028337955474854
Epoch: 71, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.703 Test Loss: 0.936 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.4731059074401855
Epoch: 72, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 2.554234027862549
Epoch: 73, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 2.44928240776062
Epoch: 74, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.703 Test Loss: 0.934 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 2.0269856452941895
Epoch: 75, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 2.5689003467559814
Epoch: 76, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.937 Vali Acc: 0.703 Test Loss: 0.937 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 3.097543954849243
Epoch: 77, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.703 Test Loss: 0.936 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7027027027027027
model parameter : 866972
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.328869819641113
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.342 Vali Acc: 0.243 Test Loss: 1.342 Test Acc: 0.243
Validation loss decreased (inf --> -0.243230).  Saving model ...
Epoch: 2 cost time: 1.6562588214874268
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.299 Vali Acc: 0.459 Test Loss: 1.299 Test Acc: 0.459
Validation loss decreased (-0.243230 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.782088041305542
Epoch: 3, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.280 Vali Acc: 0.446 Test Loss: 1.280 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8651819229125977
Epoch: 4, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.229 Vali Acc: 0.514 Test Loss: 1.229 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.736647367477417
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.188 Vali Acc: 0.595 Test Loss: 1.188 Test Acc: 0.595
Validation loss decreased (-0.513501 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 1.9012508392333984
Epoch: 6, Steps: 10 | Train Loss: 0.665 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8130207061767578
Epoch: 7, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.106 Vali Acc: 0.581 Test Loss: 1.106 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.260376214981079
Epoch: 8, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8481855392456055
Epoch: 9, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.009 Vali Acc: 0.581 Test Loss: 1.009 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8917887210845947
Epoch: 10, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.014 Vali Acc: 0.568 Test Loss: 1.014 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0311026573181152
Epoch: 11, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6106595993041992
Epoch: 12, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.969 Vali Acc: 0.568 Test Loss: 0.969 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5647554397583008
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.974 Vali Acc: 0.541 Test Loss: 0.974 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.074730396270752
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.973 Vali Acc: 0.568 Test Loss: 0.973 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8037700653076172
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.961 Vali Acc: 0.568 Test Loss: 0.961 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 856732
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2306792736053467
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.377 Vali Acc: 0.284 Test Loss: 1.377 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.18410062789917
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.346 Vali Acc: 0.351 Test Loss: 1.346 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.5113654136657715
Epoch: 3, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.344 Vali Acc: 0.392 Test Loss: 1.344 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 1.2847299575805664
Epoch: 4, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.336211919784546
Epoch: 5, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1700518131256104
Epoch: 6, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1763319969177246
Epoch: 7, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.4339210987091064
Epoch: 8, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.1671113967895508
Epoch: 9, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.4201366901397705
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.995 Vali Acc: 0.622 Test Loss: 0.995 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.1312017440795898
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.964 Vali Acc: 0.608 Test Loss: 0.964 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4091548919677734
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.948 Vali Acc: 0.608 Test Loss: 0.948 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3192188739776611
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.946 Vali Acc: 0.635 Test Loss: 0.946 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 14 cost time: 1.1059832572937012
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3375849723815918
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 1.328721046447754
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.934 Vali Acc: 0.649 Test Loss: 0.934 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 17 cost time: 1.1526963710784912
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.931 Vali Acc: 0.649 Test Loss: 0.931 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 18 cost time: 1.2574372291564941
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.929 Vali Acc: 0.649 Test Loss: 0.929 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 19 cost time: 1.2038238048553467
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.934 Vali Acc: 0.649 Test Loss: 0.934 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1218647956848145
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.937 Vali Acc: 0.649 Test Loss: 0.937 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3636109828948975
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.223628044128418
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.932 Vali Acc: 0.649 Test Loss: 0.932 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2965238094329834
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.935 Vali Acc: 0.649 Test Loss: 0.935 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2188379764556885
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.934 Vali Acc: 0.649 Test Loss: 0.934 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2922308444976807
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.938 Vali Acc: 0.649 Test Loss: 0.938 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5017082691192627
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.942 Vali Acc: 0.649 Test Loss: 0.942 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4613945484161377
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.940 Vali Acc: 0.649 Test Loss: 0.940 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6089951992034912
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 848540
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.521914005279541
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.343 Vali Acc: 0.338 Test Loss: 1.343 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.243807077407837
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.329 Vali Acc: 0.338 Test Loss: 1.329 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 1.0556068420410156
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.310 Vali Acc: 0.338 Test Loss: 1.310 Test Acc: 0.338
Validation loss decreased (-0.337825 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 1.2047357559204102
Epoch: 4, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.255 Vali Acc: 0.432 Test Loss: 1.255 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.1437170505523682
Epoch: 5, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1633203029632568
Epoch: 6, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.171 Vali Acc: 0.554 Test Loss: 1.171 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.9551308155059814
Epoch: 7, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.140 Vali Acc: 0.581 Test Loss: 1.140 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.9276604652404785
Epoch: 8, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.110 Vali Acc: 0.608 Test Loss: 1.110 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.2663078308105469
Epoch: 9, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.088 Vali Acc: 0.622 Test Loss: 1.088 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 1.7335104942321777
Epoch: 10, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.059 Vali Acc: 0.635 Test Loss: 1.059 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 11 cost time: 1.0872154235839844
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.052 Vali Acc: 0.635 Test Loss: 1.052 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 1.048351764678955
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.048 Vali Acc: 0.608 Test Loss: 1.048 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0620317459106445
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.045 Vali Acc: 0.622 Test Loss: 1.045 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.119598388671875
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.042 Vali Acc: 0.608 Test Loss: 1.042 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9810919761657715
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.043 Vali Acc: 0.622 Test Loss: 1.043 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1411454677581787
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.037 Vali Acc: 0.608 Test Loss: 1.037 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.308565378189087
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.216787576675415
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.038 Vali Acc: 0.608 Test Loss: 1.038 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1353802680969238
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.041 Vali Acc: 0.622 Test Loss: 1.041 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0828821659088135
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2123379707336426
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 844444
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7290945053100586
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.451 Vali Acc: 0.338 Test Loss: 1.451 Test Acc: 0.338
Validation loss decreased (inf --> -0.337823).  Saving model ...
Epoch: 2 cost time: 0.9007284641265869
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.457 Vali Acc: 0.203 Test Loss: 1.457 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9779238700866699
Epoch: 3, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.406 Vali Acc: 0.284 Test Loss: 1.406 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0547215938568115
Epoch: 4, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.370 Vali Acc: 0.311 Test Loss: 1.370 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0538015365600586
Epoch: 5, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.302 Vali Acc: 0.432 Test Loss: 1.302 Test Acc: 0.432
Validation loss decreased (-0.337823 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 1.1109156608581543
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.275 Vali Acc: 0.378 Test Loss: 1.275 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9775090217590332
Epoch: 7, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.0943076610565186
Epoch: 8, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0701966285705566
Epoch: 9, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.159 Vali Acc: 0.486 Test Loss: 1.159 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.027967929840088
Epoch: 10, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.175 Vali Acc: 0.459 Test Loss: 1.175 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9478070735931396
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.0544562339782715
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.0622105598449707
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1429924964904785
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9956254959106445
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.0750653743743896
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.138 Vali Acc: 0.486 Test Loss: 1.138 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1793265342712402
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9701321125030518
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 19 cost time: 1.0374791622161865
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0021510124206543
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.141 Vali Acc: 0.527 Test Loss: 1.141 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.090489387512207
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1027202606201172
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0405621528625488
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2841691970825195
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9171645641326904
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1857554912567139
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.160 Vali Acc: 0.527 Test Loss: 1.160 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1193671226501465
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2724294662475586
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 840348
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7318267822265625
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.412 Vali Acc: 0.284 Test Loss: 1.412 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9061217308044434
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.364 Vali Acc: 0.284 Test Loss: 1.364 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.8960411548614502
Epoch: 3, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.311 Vali Acc: 0.284 Test Loss: 1.311 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283771).  Saving model ...
Epoch: 4 cost time: 0.8499002456665039
Epoch: 4, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.242 Vali Acc: 0.378 Test Loss: 1.242 Test Acc: 0.378
Validation loss decreased (-0.283771 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 0.9328098297119141
Epoch: 5, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.192 Vali Acc: 0.459 Test Loss: 1.192 Test Acc: 0.459
Validation loss decreased (-0.378366 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.2481017112731934
Epoch: 6, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.0157413482666016
Epoch: 7, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9830124378204346
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.033 Vali Acc: 0.527 Test Loss: 1.033 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527017).  Saving model ...
Epoch: 9 cost time: 0.823746919631958
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.989 Vali Acc: 0.554 Test Loss: 0.989 Test Acc: 0.554
Validation loss decreased (-0.527017 --> -0.554044).  Saving model ...
Epoch: 10 cost time: 0.6749422550201416
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.985 Vali Acc: 0.541 Test Loss: 0.985 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.808173418045044
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.989 Vali Acc: 0.554 Test Loss: 0.989 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 12 cost time: 1.050445795059204
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.980 Vali Acc: 0.541 Test Loss: 0.980 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0876991748809814
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.967 Vali Acc: 0.554 Test Loss: 0.967 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 14 cost time: 0.8240149021148682
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.965 Vali Acc: 0.568 Test Loss: 0.965 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567558).  Saving model ...
Epoch: 15 cost time: 1.0731070041656494
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.965 Vali Acc: 0.554 Test Loss: 0.965 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7567927837371826
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.965 Vali Acc: 0.541 Test Loss: 0.965 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9500164985656738
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.960 Vali Acc: 0.554 Test Loss: 0.960 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.799649715423584
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.961 Vali Acc: 0.541 Test Loss: 0.961 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8969466686248779
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.959 Vali Acc: 0.541 Test Loss: 0.959 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8828084468841553
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.959 Vali Acc: 0.541 Test Loss: 0.959 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.820239782333374
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.958 Vali Acc: 0.541 Test Loss: 0.958 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9150223731994629
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.960 Vali Acc: 0.541 Test Loss: 0.960 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.102356195449829
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.959 Vali Acc: 0.541 Test Loss: 0.959 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9080610275268555
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.959 Vali Acc: 0.541 Test Loss: 0.959 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 837276
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.439411401748657
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.407 Vali Acc: 0.230 Test Loss: 1.407 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 3.8851277828216553
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.348 Vali Acc: 0.311 Test Loss: 1.348 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 3.5422275066375732
Epoch: 3, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.304 Vali Acc: 0.432 Test Loss: 1.304 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 3.4142191410064697
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.262 Vali Acc: 0.486 Test Loss: 1.262 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 3.2337541580200195
Epoch: 5, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.234 Vali Acc: 0.405 Test Loss: 1.234 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.332207679748535
Epoch: 6, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 3.8535425662994385
Epoch: 7, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.132 Vali Acc: 0.554 Test Loss: 1.132 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 4.172298192977905
Epoch: 8, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.083 Vali Acc: 0.622 Test Loss: 1.083 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 3.5674455165863037
Epoch: 9, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
Validation loss decreased (-0.621611 --> -0.648638).  Saving model ...
Epoch: 10 cost time: 3.5517401695251465
Epoch: 10, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.990 Vali Acc: 0.649 Test Loss: 0.990 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 11 cost time: 3.776221752166748
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.942 Vali Acc: 0.689 Test Loss: 0.942 Test Acc: 0.689
Validation loss decreased (-0.648639 --> -0.689180).  Saving model ...
Epoch: 12 cost time: 3.668726921081543
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.934 Vali Acc: 0.676 Test Loss: 0.934 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5848469734191895
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.921 Vali Acc: 0.662 Test Loss: 0.921 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3757808208465576
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.910 Vali Acc: 0.689 Test Loss: 0.910 Test Acc: 0.689
Validation loss decreased (-0.689180 --> -0.689180).  Saving model ...
Epoch: 15 cost time: 2.835993528366089
Epoch: 15, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.897 Vali Acc: 0.689 Test Loss: 0.897 Test Acc: 0.689
Validation loss decreased (-0.689180 --> -0.689180).  Saving model ...
Epoch: 16 cost time: 3.150083065032959
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.899 Vali Acc: 0.676 Test Loss: 0.899 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9374821186065674
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.898 Vali Acc: 0.676 Test Loss: 0.898 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8305516242980957
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.889 Vali Acc: 0.676 Test Loss: 0.889 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0232157707214355
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.890 Vali Acc: 0.676 Test Loss: 0.890 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.962415933609009
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.894 Vali Acc: 0.676 Test Loss: 0.894 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0121490955352783
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.895 Vali Acc: 0.676 Test Loss: 0.895 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.535444736480713
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.894 Vali Acc: 0.676 Test Loss: 0.894 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.472445249557495
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.892 Vali Acc: 0.676 Test Loss: 0.892 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.332456588745117
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.896 Vali Acc: 0.676 Test Loss: 0.896 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.5097815990448
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.901 Vali Acc: 0.676 Test Loss: 0.901 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 887368
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.877888202667236
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.422 Vali Acc: 0.176 Test Loss: 1.422 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.1527631282806396
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.397 Vali Acc: 0.230 Test Loss: 1.397 Test Acc: 0.230
Validation loss decreased (-0.175661 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 2.830671548843384
Epoch: 3, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.344 Vali Acc: 0.311 Test Loss: 1.344 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 2.6116888523101807
Epoch: 4, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.323 Vali Acc: 0.297 Test Loss: 1.323 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6530280113220215
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.276 Vali Acc: 0.378 Test Loss: 1.276 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378366).  Saving model ...
Epoch: 6 cost time: 2.2737226486206055
Epoch: 6, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.227 Vali Acc: 0.446 Test Loss: 1.227 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 2.722147226333618
Epoch: 7, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 2.6432974338531494
Epoch: 8, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 2.9005374908447266
Epoch: 9, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 2.3952505588531494
Epoch: 10, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 2.5884273052215576
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.049 Vali Acc: 0.581 Test Loss: 1.049 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 2.270902395248413
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.019 Vali Acc: 0.595 Test Loss: 1.019 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 3.0013511180877686
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.024 Vali Acc: 0.635 Test Loss: 1.024 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 2.7594187259674072
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.005 Vali Acc: 0.595 Test Loss: 1.005 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.239751100540161
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3593432903289795
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0524966716766357
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.604665756225586
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.000 Vali Acc: 0.608 Test Loss: 1.000 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.40336537361145
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.004 Vali Acc: 0.608 Test Loss: 1.004 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.457465171813965
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.452324151992798
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.004 Vali Acc: 0.608 Test Loss: 1.004 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.156005620956421
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2153661251068115
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 877128
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.2550132274627686
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.395 Vali Acc: 0.297 Test Loss: 1.395 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.0078954696655273
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.366 Vali Acc: 0.324 Test Loss: 1.366 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.7817926406860352
Epoch: 3, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.333 Vali Acc: 0.365 Test Loss: 1.333 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 2.90673565864563
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.295 Vali Acc: 0.432 Test Loss: 1.295 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 2.5365190505981445
Epoch: 5, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.231 Vali Acc: 0.473 Test Loss: 1.231 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.65170955657959
Epoch: 6, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.9903099536895752
Epoch: 7, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.162 Vali Acc: 0.568 Test Loss: 1.162 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 2.408292293548584
Epoch: 8, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.111 Vali Acc: 0.581 Test Loss: 1.111 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 2.117945671081543
Epoch: 9, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.117 Vali Acc: 0.622 Test Loss: 1.117 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621610).  Saving model ...
Epoch: 10 cost time: 2.776839017868042
Epoch: 10, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.063 Vali Acc: 0.595 Test Loss: 1.063 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0484344959259033
Epoch: 11, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.052 Vali Acc: 0.635 Test Loss: 1.052 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 2.463355302810669
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.058 Vali Acc: 0.622 Test Loss: 1.058 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.501011848449707
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.035 Vali Acc: 0.649 Test Loss: 1.035 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 14 cost time: 2.4296717643737793
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.034 Vali Acc: 0.649 Test Loss: 1.034 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 15 cost time: 2.308643341064453
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.031 Vali Acc: 0.649 Test Loss: 1.031 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 16 cost time: 2.3062937259674072
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.033 Vali Acc: 0.635 Test Loss: 1.033 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1591379642486572
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.031 Vali Acc: 0.635 Test Loss: 1.031 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4391026496887207
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.028 Vali Acc: 0.649 Test Loss: 1.028 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 19 cost time: 2.248809814453125
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.024 Vali Acc: 0.649 Test Loss: 1.024 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 20 cost time: 2.422680139541626
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.027 Vali Acc: 0.649 Test Loss: 1.027 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.052764415740967
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.022 Vali Acc: 0.649 Test Loss: 1.022 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 22 cost time: 2.081164598464966
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.023 Vali Acc: 0.649 Test Loss: 1.023 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9418327808380127
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.023 Vali Acc: 0.649 Test Loss: 1.023 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0358638763427734
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.023 Vali Acc: 0.649 Test Loss: 1.023 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8265018463134766
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.024 Vali Acc: 0.649 Test Loss: 1.024 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.459411382675171
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.027 Vali Acc: 0.649 Test Loss: 1.027 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1341311931610107
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.032 Vali Acc: 0.662 Test Loss: 1.032 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662152).  Saving model ...
Epoch: 28 cost time: 1.7931933403015137
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.032 Vali Acc: 0.662 Test Loss: 1.032 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9161953926086426
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.035 Vali Acc: 0.662 Test Loss: 1.035 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.117659330368042
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.032 Vali Acc: 0.649 Test Loss: 1.032 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7828936576843262
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.033 Vali Acc: 0.649 Test Loss: 1.033 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7955067157745361
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.034 Vali Acc: 0.662 Test Loss: 1.034 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7630314826965332
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.040 Vali Acc: 0.662 Test Loss: 1.040 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.284173011779785
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.038 Vali Acc: 0.662 Test Loss: 1.038 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.8139207363128662
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.039 Vali Acc: 0.662 Test Loss: 1.039 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2061166763305664
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.040 Vali Acc: 0.662 Test Loss: 1.040 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.176990032196045
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.040 Vali Acc: 0.662 Test Loss: 1.040 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 866888
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.515256881713867
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.397 Vali Acc: 0.189 Test Loss: 1.397 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.8534791469573975
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.346 Vali Acc: 0.338 Test Loss: 1.346 Test Acc: 0.338
Validation loss decreased (-0.189175 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.7747471332550049
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.312 Vali Acc: 0.405 Test Loss: 1.312 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.7758831977844238
Epoch: 4, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.248 Vali Acc: 0.446 Test Loss: 1.248 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.62565279006958
Epoch: 5, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.222 Vali Acc: 0.432 Test Loss: 1.222 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8482697010040283
Epoch: 6, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.160 Vali Acc: 0.473 Test Loss: 1.160 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.9085040092468262
Epoch: 7, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.9011118412017822
Epoch: 8, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.866750717163086
Epoch: 9, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.026 Vali Acc: 0.554 Test Loss: 1.026 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 10 cost time: 1.797529697418213
Epoch: 10, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.017 Vali Acc: 0.541 Test Loss: 1.017 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8621776103973389
Epoch: 11, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.997 Vali Acc: 0.554 Test Loss: 0.997 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 12 cost time: 2.2468912601470947
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.966 Vali Acc: 0.554 Test Loss: 0.966 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 2.033871650695801
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.968 Vali Acc: 0.554 Test Loss: 0.968 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0787765979766846
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.958 Vali Acc: 0.581 Test Loss: 0.958 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 15 cost time: 2.0734550952911377
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.947 Vali Acc: 0.595 Test Loss: 0.947 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 16 cost time: 1.4816203117370605
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.956 Vali Acc: 0.568 Test Loss: 0.956 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5816996097564697
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.946 Vali Acc: 0.595 Test Loss: 0.946 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 18 cost time: 1.5031843185424805
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.948 Vali Acc: 0.595 Test Loss: 0.948 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7758162021636963
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.943 Vali Acc: 0.595 Test Loss: 0.943 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 20 cost time: 1.569420576095581
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.942 Vali Acc: 0.608 Test Loss: 0.942 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 21 cost time: 2.299224853515625
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.946 Vali Acc: 0.608 Test Loss: 0.946 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9141457080841064
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.945 Vali Acc: 0.608 Test Loss: 0.945 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.070085287094116
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0049479007720947
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.946 Vali Acc: 0.608 Test Loss: 0.946 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.835005283355713
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2865304946899414
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.948 Vali Acc: 0.622 Test Loss: 0.948 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 27 cost time: 1.7009975910186768
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.390866994857788
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.951 Vali Acc: 0.622 Test Loss: 0.951 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8087737560272217
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.951 Vali Acc: 0.622 Test Loss: 0.951 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0633678436279297
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.951 Vali Acc: 0.622 Test Loss: 0.951 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5369203090667725
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.950 Vali Acc: 0.622 Test Loss: 0.950 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.9897055625915527
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.952 Vali Acc: 0.622 Test Loss: 0.952 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.8472979068756104
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.956 Vali Acc: 0.635 Test Loss: 0.956 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 34 cost time: 1.740201711654663
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.956 Vali Acc: 0.649 Test Loss: 0.956 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 35 cost time: 2.050577402114868
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.1321444511413574
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.739619493484497
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8841843605041504
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9125823974609375
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.961 Vali Acc: 0.649 Test Loss: 0.961 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.8181407451629639
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.962 Vali Acc: 0.649 Test Loss: 0.962 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.302936315536499
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.115090847015381
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.966 Vali Acc: 0.649 Test Loss: 0.966 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.7775979042053223
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.969 Vali Acc: 0.649 Test Loss: 0.969 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.7805557250976562
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.968 Vali Acc: 0.649 Test Loss: 0.968 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 856648
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8498003482818604
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.450 Vali Acc: 0.284 Test Loss: 1.450 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.2193374633789062
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.433 Vali Acc: 0.216 Test Loss: 1.433 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1131024360656738
Epoch: 3, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.394 Vali Acc: 0.324 Test Loss: 1.394 Test Acc: 0.324
Validation loss decreased (-0.283769 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.2418866157531738
Epoch: 4, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.316 Vali Acc: 0.432 Test Loss: 1.316 Test Acc: 0.432
Validation loss decreased (-0.324310 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.6075654029846191
Epoch: 5, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.236 Vali Acc: 0.473 Test Loss: 1.236 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.311924934387207
Epoch: 6, Steps: 10 | Train Loss: 0.633 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.484126091003418
Epoch: 7, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.137 Vali Acc: 0.568 Test Loss: 1.137 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.2195076942443848
Epoch: 8, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.041 Vali Acc: 0.568 Test Loss: 1.041 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.3346343040466309
Epoch: 9, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.040 Vali Acc: 0.527 Test Loss: 1.040 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5355677604675293
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.997 Vali Acc: 0.554 Test Loss: 0.997 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.195612907409668
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.965 Vali Acc: 0.568 Test Loss: 0.965 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 12 cost time: 1.6075358390808105
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.952 Vali Acc: 0.581 Test Loss: 0.952 Test Acc: 0.581
Validation loss decreased (-0.567558 --> -0.581072).  Saving model ...
Epoch: 13 cost time: 1.6285369396209717
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.962 Vali Acc: 0.568 Test Loss: 0.962 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6073284149169922
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.942 Vali Acc: 0.608 Test Loss: 0.942 Test Acc: 0.608
Validation loss decreased (-0.581072 --> -0.608099).  Saving model ...
Epoch: 15 cost time: 1.4522721767425537
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.940 Vali Acc: 0.608 Test Loss: 0.940 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 16 cost time: 1.2406830787658691
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.939 Vali Acc: 0.608 Test Loss: 0.939 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 17 cost time: 1.2467446327209473
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.941 Vali Acc: 0.595 Test Loss: 0.941 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3761506080627441
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.938 Vali Acc: 0.608 Test Loss: 0.938 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 19 cost time: 1.390533208847046
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.930 Vali Acc: 0.595 Test Loss: 0.930 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5349171161651611
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.937 Vali Acc: 0.608 Test Loss: 0.937 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 21 cost time: 1.450348138809204
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.940 Vali Acc: 0.608 Test Loss: 0.940 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4741289615631104
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.934 Vali Acc: 0.608 Test Loss: 0.934 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 23 cost time: 1.3637967109680176
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.934 Vali Acc: 0.608 Test Loss: 0.934 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.314000129699707
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.936 Vali Acc: 0.608 Test Loss: 0.936 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2946693897247314
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.935 Vali Acc: 0.608 Test Loss: 0.935 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4298524856567383
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.935 Vali Acc: 0.608 Test Loss: 0.935 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4288232326507568
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4438128471374512
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.937 Vali Acc: 0.608 Test Loss: 0.937 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4527690410614014
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.934 Vali Acc: 0.622 Test Loss: 0.934 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 30 cost time: 1.2467730045318604
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.937 Vali Acc: 0.608 Test Loss: 0.937 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2973501682281494
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.936 Vali Acc: 0.608 Test Loss: 0.936 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5245728492736816
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.945 Vali Acc: 0.608 Test Loss: 0.945 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3637378215789795
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.944 Vali Acc: 0.608 Test Loss: 0.944 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.446195125579834
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.942 Vali Acc: 0.608 Test Loss: 0.942 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4672222137451172
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.946 Vali Acc: 0.608 Test Loss: 0.946 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.250641107559204
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1832947731018066
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.948 Vali Acc: 0.608 Test Loss: 0.948 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3331480026245117
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2690153121948242
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.608 Test Loss: 0.944 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 848456
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.02445125579834
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.326 Vali Acc: 0.351 Test Loss: 1.326 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.2359330654144287
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.338 Vali Acc: 0.297 Test Loss: 1.338 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1307399272918701
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.295 Vali Acc: 0.446 Test Loss: 1.295 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.082878828048706
Epoch: 4, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.219 Vali Acc: 0.541 Test Loss: 1.219 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 0.9613401889801025
Epoch: 5, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.180288314819336
Epoch: 6, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.1549909114837646
Epoch: 7, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5746221542358398
Epoch: 8, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 0.9260220527648926
Epoch: 9, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.029 Vali Acc: 0.554 Test Loss: 1.029 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.206916332244873
Epoch: 10, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.991 Vali Acc: 0.581 Test Loss: 0.991 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0445442199707031
Epoch: 11, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.984 Vali Acc: 0.649 Test Loss: 0.984 Test Acc: 0.649
Validation loss decreased (-0.608097 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 1.0498816967010498
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.978 Vali Acc: 0.649 Test Loss: 0.978 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 1.0521764755249023
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.969 Vali Acc: 0.649 Test Loss: 0.969 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 14 cost time: 1.2885701656341553
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.974 Vali Acc: 0.676 Test Loss: 0.974 Test Acc: 0.676
Validation loss decreased (-0.648639 --> -0.675666).  Saving model ...
Epoch: 15 cost time: 1.2411210536956787
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.979 Vali Acc: 0.676 Test Loss: 0.979 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2476277351379395
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.972 Vali Acc: 0.649 Test Loss: 0.972 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.038835048675537
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.973 Vali Acc: 0.649 Test Loss: 0.973 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1908533573150635
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.977 Vali Acc: 0.649 Test Loss: 0.977 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2103242874145508
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.974 Vali Acc: 0.649 Test Loss: 0.974 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1387076377868652
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.985 Vali Acc: 0.649 Test Loss: 0.985 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0672571659088135
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.989 Vali Acc: 0.649 Test Loss: 0.989 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1660337448120117
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.986 Vali Acc: 0.649 Test Loss: 0.986 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9515299797058105
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.989 Vali Acc: 0.649 Test Loss: 0.989 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0091214179992676
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.992 Vali Acc: 0.662 Test Loss: 0.992 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 844360
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1856181621551514
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.397 Vali Acc: 0.338 Test Loss: 1.397 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.1572835445404053
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.346 Vali Acc: 0.365 Test Loss: 1.346 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 0.8826069831848145
Epoch: 3, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0818226337432861
Epoch: 4, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.294 Vali Acc: 0.378 Test Loss: 1.294 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.9899008274078369
Epoch: 5, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.0873379707336426
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 0.9536542892456055
Epoch: 7, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.8704781532287598
Epoch: 8, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.164 Vali Acc: 0.473 Test Loss: 1.164 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.9515719413757324
Epoch: 9, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 0.8798108100891113
Epoch: 10, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.9096653461456299
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 0.9675476551055908
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.111 Vali Acc: 0.527 Test Loss: 1.111 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.783376932144165
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9229123592376709
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0915005207061768
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9570698738098145
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 17 cost time: 0.9529886245727539
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0118658542633057
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8913576602935791
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8784832954406738
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8109097480773926
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0869154930114746
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1230063438415527
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.979466438293457
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0863382816314697
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7537317276000977
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 840264
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.785611867904663
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.8133113384246826
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.356 Vali Acc: 0.351 Test Loss: 1.356 Test Acc: 0.351
Validation loss decreased (-0.256743 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.7741153240203857
Epoch: 3, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.319 Vali Acc: 0.378 Test Loss: 1.319 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.7760660648345947
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.281 Vali Acc: 0.419 Test Loss: 1.281 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.8221926689147949
Epoch: 5, Steps: 10 | Train Loss: 0.798 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.7077322006225586
Epoch: 6, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.8876450061798096
Epoch: 7, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.165 Vali Acc: 0.486 Test Loss: 1.165 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0495152473449707
Epoch: 8, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.073 Vali Acc: 0.514 Test Loss: 1.073 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513503).  Saving model ...
Epoch: 9 cost time: 1.01177978515625
Epoch: 9, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 0.8921725749969482
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.056 Vali Acc: 0.595 Test Loss: 1.056 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.8495705127716064
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8348879814147949
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8967554569244385
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.792503833770752
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9202783107757568
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.075 Vali Acc: 0.568 Test Loss: 1.075 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.031965970993042
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0288305282592773
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.086 Vali Acc: 0.568 Test Loss: 1.086 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0134618282318115
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8597595691680908
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8712739944458008
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 837192
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.243055105209351
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.284 Vali Acc: 0.432 Test Loss: 1.284 Test Acc: 0.432
Validation loss decreased (inf --> -0.432420).  Saving model ...
Epoch: 2 cost time: 3.513601064682007
Epoch: 2, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 3.4122681617736816
Epoch: 3, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.166 Vali Acc: 0.568 Test Loss: 1.166 Test Acc: 0.568
Validation loss decreased (-0.486474 --> -0.567556).  Saving model ...
Epoch: 4 cost time: 2.8796870708465576
Epoch: 4, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.115 Vali Acc: 0.581 Test Loss: 1.115 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 3.324869155883789
Epoch: 5, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 2.8595144748687744
Epoch: 6, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.040 Vali Acc: 0.595 Test Loss: 1.040 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 3.317203998565674
Epoch: 7, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.029 Vali Acc: 0.649 Test Loss: 1.029 Test Acc: 0.649
Validation loss decreased (-0.594584 --> -0.648638).  Saving model ...
Epoch: 8 cost time: 3.451068639755249
Epoch: 8, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.976 Vali Acc: 0.649 Test Loss: 0.976 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 9 cost time: 3.3246350288391113
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.959 Vali Acc: 0.662 Test Loss: 0.959 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 10 cost time: 3.1378607749938965
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.969 Vali Acc: 0.676 Test Loss: 0.969 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 11 cost time: 3.688742160797119
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.964 Vali Acc: 0.662 Test Loss: 0.964 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0732386112213135
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.952 Vali Acc: 0.662 Test Loss: 0.952 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.39396333694458
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.950 Vali Acc: 0.662 Test Loss: 0.950 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4027791023254395
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.944 Vali Acc: 0.662 Test Loss: 0.944 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6207082271575928
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.936 Vali Acc: 0.662 Test Loss: 0.936 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.943241834640503
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.931 Vali Acc: 0.649 Test Loss: 0.931 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0840539932250977
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4412055015563965
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.920 Vali Acc: 0.649 Test Loss: 0.920 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.114536762237549
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.917 Vali Acc: 0.662 Test Loss: 0.917 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.401520013809204
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.916 Vali Acc: 0.662 Test Loss: 0.916 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 887264
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.343469858169556
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.386 Vali Acc: 0.243 Test Loss: 1.386 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.55869460105896
Epoch: 2, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.308 Vali Acc: 0.351 Test Loss: 1.308 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.763120174407959
Epoch: 3, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 2.310018301010132
Epoch: 4, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 2.7123165130615234
Epoch: 5, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 2.9455347061157227
Epoch: 6, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.061 Vali Acc: 0.581 Test Loss: 1.061 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 3.2144947052001953
Epoch: 7, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.881822347640991
Epoch: 8, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.007 Vali Acc: 0.554 Test Loss: 1.007 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8367984294891357
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 2.6901659965515137
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.996 Vali Acc: 0.568 Test Loss: 0.996 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2644736766815186
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.988 Vali Acc: 0.541 Test Loss: 0.988 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9940898418426514
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.981 Vali Acc: 0.581 Test Loss: 0.981 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.44242787361145
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 14 cost time: 2.7239222526550293
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.975 Vali Acc: 0.595 Test Loss: 0.975 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 15 cost time: 2.7611818313598633
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.975 Vali Acc: 0.568 Test Loss: 0.975 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6295576095581055
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.969 Vali Acc: 0.595 Test Loss: 0.969 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 17 cost time: 2.490130662918091
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.966 Vali Acc: 0.581 Test Loss: 0.966 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.818254232406616
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.965 Vali Acc: 0.581 Test Loss: 0.965 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6805760860443115
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.967 Vali Acc: 0.568 Test Loss: 0.967 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.517568588256836
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.967 Vali Acc: 0.568 Test Loss: 0.967 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.345607042312622
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.962 Vali Acc: 0.581 Test Loss: 0.962 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.544552803039551
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.958 Vali Acc: 0.581 Test Loss: 0.958 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.7576546669006348
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.957 Vali Acc: 0.581 Test Loss: 0.957 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.463134288787842
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.956 Vali Acc: 0.581 Test Loss: 0.956 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.8159780502319336
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.957 Vali Acc: 0.595 Test Loss: 0.957 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 26 cost time: 2.525980234146118
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.958 Vali Acc: 0.595 Test Loss: 0.958 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.421844244003296
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.957 Vali Acc: 0.608 Test Loss: 0.957 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 28 cost time: 2.8145387172698975
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.956 Vali Acc: 0.595 Test Loss: 0.956 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6987555027008057
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.956 Vali Acc: 0.581 Test Loss: 0.956 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1729254722595215
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.956 Vali Acc: 0.581 Test Loss: 0.956 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.8822543621063232
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.956 Vali Acc: 0.581 Test Loss: 0.956 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.3497393131256104
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.957 Vali Acc: 0.581 Test Loss: 0.957 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.7011220455169678
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.554 Test Loss: 0.959 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.4864797592163086
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.957 Vali Acc: 0.568 Test Loss: 0.957 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.8299906253814697
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.581 Test Loss: 0.958 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.907463312149048
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.957 Vali Acc: 0.581 Test Loss: 0.957 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.096510887145996
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.956 Vali Acc: 0.568 Test Loss: 0.956 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 877024
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.504281759262085
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.376 Vali Acc: 0.365 Test Loss: 1.376 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 2.320071220397949
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.320 Vali Acc: 0.338 Test Loss: 1.320 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0774223804473877
Epoch: 3, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.261 Vali Acc: 0.419 Test Loss: 1.261 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.8944847583770752
Epoch: 4, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
Validation loss decreased (-0.418906 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.816965103149414
Epoch: 5, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.149 Vali Acc: 0.541 Test Loss: 1.149 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.7046504020690918
Epoch: 6, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 2.1435420513153076
Epoch: 7, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 8 cost time: 1.8904576301574707
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.285440683364868
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.028 Vali Acc: 0.581 Test Loss: 1.028 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.12390398979187
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2642672061920166
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.015 Vali Acc: 0.595 Test Loss: 1.015 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0235888957977295
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.014 Vali Acc: 0.581 Test Loss: 1.014 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.900597095489502
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7471697330474854
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6553640365600586
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.996 Vali Acc: 0.581 Test Loss: 0.996 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.006629467010498
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.145860433578491
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.991 Vali Acc: 0.622 Test Loss: 0.991 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 18 cost time: 1.809476613998413
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.986 Vali Acc: 0.635 Test Loss: 0.986 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 19 cost time: 1.9755346775054932
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.983 Vali Acc: 0.608 Test Loss: 0.983 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0103163719177246
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.985 Vali Acc: 0.595 Test Loss: 0.985 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.42950439453125
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.982 Vali Acc: 0.595 Test Loss: 0.982 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7610280513763428
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.978 Vali Acc: 0.595 Test Loss: 0.978 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9160304069519043
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.975 Vali Acc: 0.595 Test Loss: 0.975 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.671849250793457
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.972 Vali Acc: 0.595 Test Loss: 0.972 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8725147247314453
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.972 Vali Acc: 0.595 Test Loss: 0.972 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9949665069580078
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.971 Vali Acc: 0.595 Test Loss: 0.971 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.733186960220337
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.970 Vali Acc: 0.595 Test Loss: 0.970 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0325868129730225
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.969 Vali Acc: 0.595 Test Loss: 0.969 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 866784
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.400583505630493
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.449 Vali Acc: 0.297 Test Loss: 1.449 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.6610875129699707
Epoch: 2, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.372 Vali Acc: 0.365 Test Loss: 1.372 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.5145642757415771
Epoch: 3, Steps: 10 | Train Loss: 0.879 Vali Loss: 1.314 Vali Acc: 0.378 Test Loss: 1.314 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.8676483631134033
Epoch: 4, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.8194808959960938
Epoch: 5, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 2.161970615386963
Epoch: 6, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.6694459915161133
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.8418290615081787
Epoch: 8, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.6521546840667725
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.6258807182312012
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 1.876387119293213
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.032 Vali Acc: 0.608 Test Loss: 1.032 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.8487775325775146
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6668705940246582
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.024 Vali Acc: 0.595 Test Loss: 1.024 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6704587936401367
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.024 Vali Acc: 0.608 Test Loss: 1.024 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 1.5822882652282715
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.024 Vali Acc: 0.595 Test Loss: 1.024 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6671442985534668
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.003796339035034
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1417622566223145
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.019 Vali Acc: 0.595 Test Loss: 1.019 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.671032428741455
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.014 Vali Acc: 0.608 Test Loss: 1.014 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 20 cost time: 2.14680814743042
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.013 Vali Acc: 0.595 Test Loss: 1.013 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9323937892913818
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.015 Vali Acc: 0.595 Test Loss: 1.015 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3545446395874023
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.013 Vali Acc: 0.595 Test Loss: 1.013 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7913694381713867
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0872960090637207
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.86155366897583
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9534385204315186
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.010 Vali Acc: 0.595 Test Loss: 1.010 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8134777545928955
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.010 Vali Acc: 0.595 Test Loss: 1.010 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9426007270812988
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.007 Vali Acc: 0.595 Test Loss: 1.007 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0883750915527344
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.008 Vali Acc: 0.595 Test Loss: 1.008 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 856544
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0909433364868164
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.372 Vali Acc: 0.324 Test Loss: 1.372 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.0451269149780273
Epoch: 2, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.1186907291412354
Epoch: 3, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.246 Vali Acc: 0.446 Test Loss: 1.246 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.137052297592163
Epoch: 4, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2931082248687744
Epoch: 5, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.120253562927246
Epoch: 6, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.1335368156433105
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.055483341217041
Epoch: 8, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1880278587341309
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.3226776123046875
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.023 Vali Acc: 0.568 Test Loss: 1.023 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1456685066223145
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.014 Vali Acc: 0.568 Test Loss: 1.014 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2358689308166504
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.005 Vali Acc: 0.568 Test Loss: 1.005 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0441243648529053
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.002 Vali Acc: 0.568 Test Loss: 1.002 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1158661842346191
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.996 Vali Acc: 0.568 Test Loss: 0.996 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1079485416412354
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.994 Vali Acc: 0.568 Test Loss: 0.994 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1518352031707764
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.992 Vali Acc: 0.554 Test Loss: 0.992 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.250924825668335
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.989 Vali Acc: 0.554 Test Loss: 0.989 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1302824020385742
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.988 Vali Acc: 0.554 Test Loss: 0.988 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1452691555023193
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.985 Vali Acc: 0.554 Test Loss: 0.985 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 848352
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.935476303100586
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.437 Vali Acc: 0.284 Test Loss: 1.437 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 0.9791793823242188
Epoch: 2, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.369 Vali Acc: 0.324 Test Loss: 1.369 Test Acc: 0.324
Validation loss decreased (-0.283769 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.1264002323150635
Epoch: 3, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.301 Vali Acc: 0.419 Test Loss: 1.301 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.0288782119750977
Epoch: 4, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.218 Vali Acc: 0.446 Test Loss: 1.218 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.101212978363037
Epoch: 5, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
Validation loss decreased (-0.445934 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.0862317085266113
Epoch: 6, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 1.1692893505096436
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.074 Vali Acc: 0.568 Test Loss: 1.074 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.0901570320129395
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.0700476169586182
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9775433540344238
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9610128402709961
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.044 Vali Acc: 0.595 Test Loss: 1.044 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.1017932891845703
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.038 Vali Acc: 0.581 Test Loss: 1.038 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0405559539794922
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.035 Vali Acc: 0.568 Test Loss: 1.035 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.163771152496338
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.034 Vali Acc: 0.568 Test Loss: 1.034 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1592185497283936
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.031 Vali Acc: 0.568 Test Loss: 1.031 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.141207218170166
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.40928316116333
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.247016429901123
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2199327945709229
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.024 Vali Acc: 0.568 Test Loss: 1.024 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4629595279693604
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.022 Vali Acc: 0.568 Test Loss: 1.022 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3584246635437012
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 844256
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9602949619293213
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.362 Vali Acc: 0.284 Test Loss: 1.362 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.013798475265503
Epoch: 2, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.052781343460083
Epoch: 3, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.7757680416107178
Epoch: 4, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
Validation loss decreased (-0.499988 --> -0.594583).  Saving model ...
Epoch: 5 cost time: 0.8878262042999268
Epoch: 5, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.087 Vali Acc: 0.608 Test Loss: 1.087 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 0.9965677261352539
Epoch: 6, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 1.0260088443756104
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.005 Vali Acc: 0.676 Test Loss: 1.005 Test Acc: 0.676
Validation loss decreased (-0.621611 --> -0.675666).  Saving model ...
Epoch: 8 cost time: 1.030273199081421
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.991 Vali Acc: 0.662 Test Loss: 0.991 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.909843921661377
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.982 Vali Acc: 0.662 Test Loss: 0.982 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.188046932220459
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.970 Vali Acc: 0.662 Test Loss: 0.970 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.145491600036621
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.967 Vali Acc: 0.649 Test Loss: 0.967 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.176184892654419
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.961 Vali Acc: 0.662 Test Loss: 0.961 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.975883960723877
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.957 Vali Acc: 0.662 Test Loss: 0.957 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9965915679931641
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.953 Vali Acc: 0.662 Test Loss: 0.953 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0912203788757324
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.949 Vali Acc: 0.662 Test Loss: 0.949 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9771547317504883
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.949 Vali Acc: 0.662 Test Loss: 0.949 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9258651733398438
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.946 Vali Acc: 0.662 Test Loss: 0.946 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 840160
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7445993423461914
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.364 Vali Acc: 0.338 Test Loss: 1.364 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.6467766761779785
Epoch: 2, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.7089455127716064
Epoch: 3, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.7526984214782715
Epoch: 4, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.7220537662506104
Epoch: 5, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.6962909698486328
Epoch: 6, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.6882612705230713
Epoch: 7, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.6010153293609619
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6847987174987793
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.050 Vali Acc: 0.568 Test Loss: 1.050 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6609675884246826
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.049 Vali Acc: 0.554 Test Loss: 1.049 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6629452705383301
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.046 Vali Acc: 0.554 Test Loss: 1.046 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6587297916412354
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.043 Vali Acc: 0.541 Test Loss: 1.043 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7459213733673096
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.594059944152832
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8077957630157471
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.034 Vali Acc: 0.554 Test Loss: 1.034 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8144793510437012
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.031 Vali Acc: 0.554 Test Loss: 1.031 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8311605453491211
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.030 Vali Acc: 0.554 Test Loss: 1.030 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 837088
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.224285840988159
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.311 Vali Acc: 0.419 Test Loss: 1.311 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 3.298764228820801
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2938971519470215
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.288 Vali Acc: 0.378 Test Loss: 1.288 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.757646083831787
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.238 Vali Acc: 0.514 Test Loss: 1.238 Test Acc: 0.514
Validation loss decreased (-0.418906 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 2.8520283699035645
Epoch: 5, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 2.9824094772338867
Epoch: 6, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.170 Vali Acc: 0.608 Test Loss: 1.170 Test Acc: 0.608
Validation loss decreased (-0.513501 --> -0.608096).  Saving model ...
Epoch: 7 cost time: 2.61892032623291
Epoch: 7, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.148 Vali Acc: 0.595 Test Loss: 1.148 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.514932155609131
Epoch: 8, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.088 Vali Acc: 0.635 Test Loss: 1.088 Test Acc: 0.635
Validation loss decreased (-0.608096 --> -0.635124).  Saving model ...
Epoch: 9 cost time: 3.7172939777374268
Epoch: 9, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.074 Vali Acc: 0.622 Test Loss: 1.074 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4361448287963867
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.048 Vali Acc: 0.595 Test Loss: 1.048 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.341219186782837
Epoch: 11, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.014 Vali Acc: 0.568 Test Loss: 1.014 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.202777862548828
Epoch: 12, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
Validation loss decreased (-0.635124 --> -0.635125).  Saving model ...
Epoch: 13 cost time: 3.1115076541900635
Epoch: 13, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.990 Vali Acc: 0.635 Test Loss: 0.990 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 2.9962117671966553
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.981 Vali Acc: 0.608 Test Loss: 0.981 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3083457946777344
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.965 Vali Acc: 0.635 Test Loss: 0.965 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 16 cost time: 2.607316255569458
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.965 Vali Acc: 0.635 Test Loss: 0.965 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 3.1400606632232666
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.960 Vali Acc: 0.635 Test Loss: 0.960 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 18 cost time: 2.9969561100006104
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.959 Vali Acc: 0.608 Test Loss: 0.959 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.163557767868042
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.962 Vali Acc: 0.622 Test Loss: 0.962 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.955706834793091
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.953 Vali Acc: 0.635 Test Loss: 0.953 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 21 cost time: 2.896036148071289
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.953 Vali Acc: 0.622 Test Loss: 0.953 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.975386381149292
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.952 Vali Acc: 0.622 Test Loss: 0.952 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3384268283843994
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.948 Vali Acc: 0.635 Test Loss: 0.948 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 24 cost time: 3.024163007736206
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.950 Vali Acc: 0.635 Test Loss: 0.950 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.535874605178833
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.954 Vali Acc: 0.635 Test Loss: 0.954 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.545501708984375
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.958 Vali Acc: 0.635 Test Loss: 0.958 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3393540382385254
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.967 Vali Acc: 0.608 Test Loss: 0.967 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.206509828567505
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.962 Vali Acc: 0.635 Test Loss: 0.962 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.2697575092315674
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.955 Vali Acc: 0.635 Test Loss: 0.955 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.202998399734497
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.957 Vali Acc: 0.635 Test Loss: 0.957 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.1576149463653564
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.956 Vali Acc: 0.635 Test Loss: 0.956 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.1644556522369385
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.958 Vali Acc: 0.635 Test Loss: 0.958 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.775209665298462
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.955 Vali Acc: 0.635 Test Loss: 0.955 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 452420
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.9345502853393555
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.390 Vali Acc: 0.311 Test Loss: 1.390 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.509063720703125
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.381 Vali Acc: 0.284 Test Loss: 1.381 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9739649295806885
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.350 Vali Acc: 0.378 Test Loss: 1.350 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.6822853088378906
Epoch: 4, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.312 Vali Acc: 0.378 Test Loss: 1.312 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 2.6177327632904053
Epoch: 5, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.271 Vali Acc: 0.405 Test Loss: 1.271 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 2.7320141792297363
Epoch: 6, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.218 Vali Acc: 0.446 Test Loss: 1.218 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 2.4211926460266113
Epoch: 7, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.763701915740967
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 2.8097317218780518
Epoch: 9, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 2.397534132003784
Epoch: 10, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.35018253326416
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6385064125061035
Epoch: 12, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5846364498138428
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 2.5732197761535645
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 2.5898735523223877
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7847819328308105
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.045 Vali Acc: 0.554 Test Loss: 1.045 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7001919746398926
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.535672903060913
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.041 Vali Acc: 0.568 Test Loss: 1.041 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 2.6863622665405273
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 20 cost time: 2.3461313247680664
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.036 Vali Acc: 0.568 Test Loss: 1.036 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0650906562805176
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.034 Vali Acc: 0.581 Test Loss: 1.034 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 22 cost time: 2.6359212398529053
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.037 Vali Acc: 0.595 Test Loss: 1.037 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 23 cost time: 2.4702861309051514
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4118876457214355
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 25 cost time: 2.4171953201293945
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.032 Vali Acc: 0.568 Test Loss: 1.032 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5483245849609375
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.032 Vali Acc: 0.568 Test Loss: 1.032 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3658061027526855
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.033 Vali Acc: 0.595 Test Loss: 1.033 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 28 cost time: 2.206188201904297
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.034 Vali Acc: 0.581 Test Loss: 1.034 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3491787910461426
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 30 cost time: 2.5915372371673584
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.273977279663086
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.037 Vali Acc: 0.581 Test Loss: 1.037 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1683835983276367
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.0527327060699463
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.6400671005249023
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.7213759422302246
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.0144851207733154
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.099137544631958
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.038 Vali Acc: 0.581 Test Loss: 1.038 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.965653896331787
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.038 Vali Acc: 0.581 Test Loss: 1.038 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.626044273376465
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 447300
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.709970235824585
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.324 Vali Acc: 0.365 Test Loss: 1.324 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 2.1417300701141357
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.295 Vali Acc: 0.419 Test Loss: 1.295 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.651928186416626
Epoch: 3, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.254 Vali Acc: 0.486 Test Loss: 1.254 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.010749578475952
Epoch: 4, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.200 Vali Acc: 0.541 Test Loss: 1.200 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 2.0165855884552
Epoch: 5, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.155 Vali Acc: 0.608 Test Loss: 1.155 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 2.0759947299957275
Epoch: 6, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.112 Vali Acc: 0.595 Test Loss: 1.112 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.96876859664917
Epoch: 7, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.083 Vali Acc: 0.608 Test Loss: 1.083 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 2.0250661373138428
Epoch: 8, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 2.349699020385742
Epoch: 9, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.982 Vali Acc: 0.676 Test Loss: 0.982 Test Acc: 0.676
Validation loss decreased (-0.608098 --> -0.675666).  Saving model ...
Epoch: 10 cost time: 2.241034984588623
Epoch: 10, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.979 Vali Acc: 0.635 Test Loss: 0.979 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4074950218200684
Epoch: 11, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.944 Vali Acc: 0.649 Test Loss: 0.944 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4156875610351562
Epoch: 12, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.940 Vali Acc: 0.635 Test Loss: 0.940 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.826658010482788
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.943 Vali Acc: 0.635 Test Loss: 0.943 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1168596744537354
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.890653371810913
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.941833257675171
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.933 Vali Acc: 0.608 Test Loss: 0.933 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9216303825378418
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0508522987365723
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.925 Vali Acc: 0.635 Test Loss: 0.925 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.282236099243164
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.933 Vali Acc: 0.635 Test Loss: 0.933 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 442180
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.423419952392578
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.439 Vali Acc: 0.270 Test Loss: 1.439 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.919287919998169
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.415 Vali Acc: 0.311 Test Loss: 1.415 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.642542839050293
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.350 Vali Acc: 0.405 Test Loss: 1.350 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.7227098941802979
Epoch: 4, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.311 Vali Acc: 0.405 Test Loss: 1.311 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.9158742427825928
Epoch: 5, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.251 Vali Acc: 0.473 Test Loss: 1.251 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.7092742919921875
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.782268762588501
Epoch: 7, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.5535874366760254
Epoch: 8, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.7146680355072021
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.053 Vali Acc: 0.649 Test Loss: 1.053 Test Acc: 0.649
Validation loss decreased (-0.594584 --> -0.648638).  Saving model ...
Epoch: 10 cost time: 1.826373815536499
Epoch: 10, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.995 Vali Acc: 0.635 Test Loss: 0.995 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.661510944366455
Epoch: 11, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.973 Vali Acc: 0.649 Test Loss: 0.973 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 1.4248580932617188
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.943 Vali Acc: 0.649 Test Loss: 0.943 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 1.5095877647399902
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.914 Vali Acc: 0.649 Test Loss: 0.914 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648640).  Saving model ...
Epoch: 14 cost time: 1.3324129581451416
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.919 Vali Acc: 0.649 Test Loss: 0.919 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6331450939178467
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.909 Vali Acc: 0.649 Test Loss: 0.909 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 16 cost time: 1.53936767578125
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.898 Vali Acc: 0.649 Test Loss: 0.898 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 17 cost time: 1.6183786392211914
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.890 Vali Acc: 0.649 Test Loss: 0.890 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 18 cost time: 1.7840559482574463
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.894 Vali Acc: 0.649 Test Loss: 0.894 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6913049221038818
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.885 Vali Acc: 0.649 Test Loss: 0.885 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 20 cost time: 1.8921997547149658
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.876 Vali Acc: 0.649 Test Loss: 0.876 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 21 cost time: 1.7473771572113037
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.878 Vali Acc: 0.649 Test Loss: 0.878 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7045743465423584
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.876 Vali Acc: 0.649 Test Loss: 0.876 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 23 cost time: 1.4516916275024414
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.880 Vali Acc: 0.649 Test Loss: 0.880 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2697668075561523
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.879 Vali Acc: 0.649 Test Loss: 0.879 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.466364860534668
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.874 Vali Acc: 0.649 Test Loss: 0.874 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 26 cost time: 1.6763904094696045
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.873 Vali Acc: 0.649 Test Loss: 0.873 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 27 cost time: 1.3012497425079346
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.873 Vali Acc: 0.649 Test Loss: 0.873 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 28 cost time: 1.6491165161132812
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.872 Vali Acc: 0.649 Test Loss: 0.872 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 29 cost time: 1.8523828983306885
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.870 Vali Acc: 0.649 Test Loss: 0.870 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 30 cost time: 1.5832765102386475
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.865 Vali Acc: 0.649 Test Loss: 0.865 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 31 cost time: 1.6835482120513916
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.869 Vali Acc: 0.649 Test Loss: 0.869 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4961154460906982
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.872 Vali Acc: 0.649 Test Loss: 0.872 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4569079875946045
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.872 Vali Acc: 0.649 Test Loss: 0.872 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7734904289245605
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.867 Vali Acc: 0.649 Test Loss: 0.867 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6055526733398438
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.865 Vali Acc: 0.649 Test Loss: 0.865 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6817266941070557
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.868 Vali Acc: 0.635 Test Loss: 0.868 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6127712726593018
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.873 Vali Acc: 0.635 Test Loss: 0.873 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.668647050857544
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.874 Vali Acc: 0.635 Test Loss: 0.874 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.590043306350708
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.874 Vali Acc: 0.635 Test Loss: 0.874 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6597793102264404
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.877 Vali Acc: 0.635 Test Loss: 0.877 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 437060
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.873239040374756
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.403 Vali Acc: 0.284 Test Loss: 1.403 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.195568323135376
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.377 Vali Acc: 0.284 Test Loss: 1.377 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.2576096057891846
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.341 Vali Acc: 0.365 Test Loss: 1.341 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.6922404766082764
Epoch: 4, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.303 Vali Acc: 0.419 Test Loss: 1.303 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.423699140548706
Epoch: 5, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.256 Vali Acc: 0.473 Test Loss: 1.256 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.3158767223358154
Epoch: 6, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.232 Vali Acc: 0.514 Test Loss: 1.232 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.556105613708496
Epoch: 7, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.6079895496368408
Epoch: 8, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.6678650379180908
Epoch: 9, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.4143409729003906
Epoch: 10, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.3802204132080078
Epoch: 11, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.041 Vali Acc: 0.608 Test Loss: 1.041 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.5308446884155273
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.038 Vali Acc: 0.622 Test Loss: 1.038 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 1.1025481224060059
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.031 Vali Acc: 0.622 Test Loss: 1.031 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 14 cost time: 1.1994001865386963
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.022 Vali Acc: 0.635 Test Loss: 1.022 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 1.0845191478729248
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.008 Vali Acc: 0.649 Test Loss: 1.008 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 1.4255025386810303
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.009 Vali Acc: 0.649 Test Loss: 1.009 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3467509746551514
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.006 Vali Acc: 0.649 Test Loss: 1.006 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 18 cost time: 1.3356049060821533
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.006 Vali Acc: 0.635 Test Loss: 1.006 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3626463413238525
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.999 Vali Acc: 0.649 Test Loss: 0.999 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 20 cost time: 1.2814650535583496
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.996 Vali Acc: 0.649 Test Loss: 0.996 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 21 cost time: 1.0685148239135742
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.996 Vali Acc: 0.649 Test Loss: 0.996 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 22 cost time: 1.1963753700256348
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.999 Vali Acc: 0.635 Test Loss: 0.999 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2936363220214844
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.000 Vali Acc: 0.635 Test Loss: 1.000 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.350276231765747
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.998 Vali Acc: 0.635 Test Loss: 0.998 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3404862880706787
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.997 Vali Acc: 0.635 Test Loss: 0.997 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3326871395111084
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.995 Vali Acc: 0.635 Test Loss: 0.995 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2777011394500732
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.995 Vali Acc: 0.635 Test Loss: 0.995 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.162844181060791
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.995 Vali Acc: 0.635 Test Loss: 0.995 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3051228523254395
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.997 Vali Acc: 0.635 Test Loss: 0.997 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3335847854614258
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.001 Vali Acc: 0.635 Test Loss: 1.001 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6690270900726318
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.001 Vali Acc: 0.635 Test Loss: 1.001 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 432964
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4084858894348145
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.449 Vali Acc: 0.189 Test Loss: 1.449 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.306265115737915
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.385 Vali Acc: 0.338 Test Loss: 1.385 Test Acc: 0.338
Validation loss decreased (-0.189175 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.1416759490966797
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.339 Vali Acc: 0.365 Test Loss: 1.339 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.150393009185791
Epoch: 4, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.301 Vali Acc: 0.446 Test Loss: 1.301 Test Acc: 0.446
Validation loss decreased (-0.364851 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.2429089546203613
Epoch: 5, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.263 Vali Acc: 0.459 Test Loss: 1.263 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.270918846130371
Epoch: 6, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.0825691223144531
Epoch: 7, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.4307353496551514
Epoch: 8, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.159 Vali Acc: 0.568 Test Loss: 1.159 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.0409033298492432
Epoch: 9, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.135 Vali Acc: 0.554 Test Loss: 1.135 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2713868618011475
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.119 Vali Acc: 0.554 Test Loss: 1.119 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9999964237213135
Epoch: 11, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1544404029846191
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4261376857757568
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1677579879760742
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4170196056365967
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.085 Vali Acc: 0.514 Test Loss: 1.085 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2784571647644043
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.082 Vali Acc: 0.527 Test Loss: 1.082 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5589656829833984
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.074 Vali Acc: 0.541 Test Loss: 1.074 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1480786800384521
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.075 Vali Acc: 0.527 Test Loss: 1.075 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 430916
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5196802616119385
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.352 Vali Acc: 0.284 Test Loss: 1.352 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9211411476135254
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.340 Vali Acc: 0.311 Test Loss: 1.340 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.0233359336853027
Epoch: 3, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.297 Vali Acc: 0.392 Test Loss: 1.297 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8550615310668945
Epoch: 4, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.240 Vali Acc: 0.446 Test Loss: 1.240 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.9321365356445312
Epoch: 5, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.162 Vali Acc: 0.568 Test Loss: 1.162 Test Acc: 0.568
Validation loss decreased (-0.445934 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.8437807559967041
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.102 Vali Acc: 0.622 Test Loss: 1.102 Test Acc: 0.622
Validation loss decreased (-0.567556 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 1.1376712322235107
Epoch: 7, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9738857746124268
Epoch: 8, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.028 Vali Acc: 0.622 Test Loss: 1.028 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 0.8688952922821045
Epoch: 9, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.961 Vali Acc: 0.635 Test Loss: 0.961 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635126).  Saving model ...
Epoch: 10 cost time: 0.884199857711792
Epoch: 10, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.935 Vali Acc: 0.595 Test Loss: 0.935 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0405302047729492
Epoch: 11, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.920 Vali Acc: 0.635 Test Loss: 0.920 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 12 cost time: 0.7577176094055176
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.900 Vali Acc: 0.581 Test Loss: 0.900 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1590180397033691
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.903 Vali Acc: 0.608 Test Loss: 0.903 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8143670558929443
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.896 Vali Acc: 0.608 Test Loss: 0.896 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8612384796142578
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.886 Vali Acc: 0.581 Test Loss: 0.886 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7729682922363281
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.883 Vali Acc: 0.608 Test Loss: 0.883 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0876352787017822
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.885 Vali Acc: 0.622 Test Loss: 0.885 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7279284000396729
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.885 Vali Acc: 0.608 Test Loss: 0.885 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0257930755615234
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.883 Vali Acc: 0.622 Test Loss: 0.883 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9267964363098145
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.885 Vali Acc: 0.622 Test Loss: 0.885 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8180749416351318
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.886 Vali Acc: 0.622 Test Loss: 0.886 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 428868
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1088874340057373
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.464 Vali Acc: 0.189 Test Loss: 1.464 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.094163417816162
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.422 Vali Acc: 0.284 Test Loss: 1.422 Test Acc: 0.284
Validation loss decreased (-0.189175 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.8008346557617188
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.388 Vali Acc: 0.324 Test Loss: 1.388 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.0049798488616943
Epoch: 4, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.4103515148162842
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.305 Vali Acc: 0.378 Test Loss: 1.305 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 0.7426345348358154
Epoch: 6, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.270 Vali Acc: 0.419 Test Loss: 1.270 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.9366133213043213
Epoch: 7, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.212 Vali Acc: 0.446 Test Loss: 1.212 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 1.0077297687530518
Epoch: 8, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 9 cost time: 1.1517689228057861
Epoch: 9, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.144 Vali Acc: 0.473 Test Loss: 1.144 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 10 cost time: 0.8571529388427734
Epoch: 10, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 0.9441821575164795
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.0436515808105469
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.1032519340515137
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.0084900856018066
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1070764064788818
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 1.0597918033599854
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 1.0394854545593262
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 18 cost time: 1.0398626327514648
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1193971633911133
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9605765342712402
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1659903526306152
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8253188133239746
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8559715747833252
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8415300846099854
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8647725582122803
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9451444149017334
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8759205341339111
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 427332
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.6883931159973145
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.357 Vali Acc: 0.284 Test Loss: 1.357 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.953549385070801
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.339 Vali Acc: 0.270 Test Loss: 1.339 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8186583518981934
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.316 Vali Acc: 0.392 Test Loss: 1.316 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 3.1716909408569336
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.266 Vali Acc: 0.459 Test Loss: 1.266 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 3.454458475112915
Epoch: 5, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.198 Vali Acc: 0.541 Test Loss: 1.198 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 2.796466112136841
Epoch: 6, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.138 Vali Acc: 0.595 Test Loss: 1.138 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 7 cost time: 3.8592281341552734
Epoch: 7, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.776052474975586
Epoch: 8, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2222981452941895
Epoch: 9, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.031 Vali Acc: 0.635 Test Loss: 1.031 Test Acc: 0.635
Validation loss decreased (-0.594583 --> -0.635125).  Saving model ...
Epoch: 10 cost time: 3.752150774002075
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.991 Vali Acc: 0.635 Test Loss: 0.991 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 11 cost time: 3.5296430587768555
Epoch: 11, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.004 Vali Acc: 0.635 Test Loss: 1.004 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.195223093032837
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.950 Vali Acc: 0.676 Test Loss: 0.950 Test Acc: 0.676
Validation loss decreased (-0.635125 --> -0.675666).  Saving model ...
Epoch: 13 cost time: 3.7663819789886475
Epoch: 13, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.457932472229004
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.938 Vali Acc: 0.649 Test Loss: 0.938 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3376450538635254
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.938 Vali Acc: 0.676 Test Loss: 0.938 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 16 cost time: 3.490919351577759
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.927 Vali Acc: 0.676 Test Loss: 0.927 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 17 cost time: 3.393141984939575
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.936 Vali Acc: 0.662 Test Loss: 0.936 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8335351943969727
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.929 Vali Acc: 0.676 Test Loss: 0.929 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.321643590927124
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.938 Vali Acc: 0.689 Test Loss: 0.938 Test Acc: 0.689
Validation loss decreased (-0.675666 --> -0.689180).  Saving model ...
Epoch: 20 cost time: 3.282949447631836
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.939 Vali Acc: 0.676 Test Loss: 0.939 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4334776401519775
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.933 Vali Acc: 0.676 Test Loss: 0.933 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.297138214111328
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.939 Vali Acc: 0.662 Test Loss: 0.939 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0855605602264404
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.947 Vali Acc: 0.662 Test Loss: 0.947 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8282461166381836
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.956 Vali Acc: 0.662 Test Loss: 0.956 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.910167932510376
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.956 Vali Acc: 0.676 Test Loss: 0.956 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.837735176086426
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.959 Vali Acc: 0.676 Test Loss: 0.959 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.402332067489624
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.956 Vali Acc: 0.676 Test Loss: 0.956 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.245619773864746
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.968 Vali Acc: 0.676 Test Loss: 0.968 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.962390184402466
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.973 Vali Acc: 0.676 Test Loss: 0.973 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 452252
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.165263652801514
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.386 Vali Acc: 0.311 Test Loss: 1.386 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.4946489334106445
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.388 Vali Acc: 0.270 Test Loss: 1.388 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.512042284011841
Epoch: 3, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.364 Vali Acc: 0.257 Test Loss: 1.364 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4010066986083984
Epoch: 4, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.302 Vali Acc: 0.365 Test Loss: 1.302 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 2.659088373184204
Epoch: 5, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 2.9062581062316895
Epoch: 6, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.190 Vali Acc: 0.473 Test Loss: 1.190 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 2.7766735553741455
Epoch: 7, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.152 Vali Acc: 0.541 Test Loss: 1.152 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 2.311121702194214
Epoch: 8, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6548869609832764
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.062 Vali Acc: 0.649 Test Loss: 1.062 Test Acc: 0.649
Validation loss decreased (-0.540529 --> -0.648638).  Saving model ...
Epoch: 10 cost time: 2.131108283996582
Epoch: 10, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.255631685256958
Epoch: 11, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.001 Vali Acc: 0.649 Test Loss: 1.001 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 2.4409122467041016
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.987 Vali Acc: 0.608 Test Loss: 0.987 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6575393676757812
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.955 Vali Acc: 0.649 Test Loss: 0.955 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 14 cost time: 2.7860617637634277
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.945 Vali Acc: 0.649 Test Loss: 0.945 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 15 cost time: 2.980771541595459
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.933 Vali Acc: 0.635 Test Loss: 0.933 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4545841217041016
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.925 Vali Acc: 0.622 Test Loss: 0.925 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4673593044281006
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.914 Vali Acc: 0.649 Test Loss: 0.914 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648640).  Saving model ...
Epoch: 18 cost time: 2.591158866882324
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.911 Vali Acc: 0.622 Test Loss: 0.911 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8647406101226807
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.913 Vali Acc: 0.635 Test Loss: 0.913 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5784497261047363
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.906 Vali Acc: 0.649 Test Loss: 0.906 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 21 cost time: 2.4330894947052
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.900 Vali Acc: 0.649 Test Loss: 0.900 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 22 cost time: 2.214797019958496
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.897 Vali Acc: 0.649 Test Loss: 0.897 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 23 cost time: 2.2858545780181885
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.900 Vali Acc: 0.649 Test Loss: 0.900 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6612086296081543
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.896 Vali Acc: 0.635 Test Loss: 0.896 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.545168161392212
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.896 Vali Acc: 0.635 Test Loss: 0.896 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.7839882373809814
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.894 Vali Acc: 0.635 Test Loss: 0.894 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3863582611083984
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.892 Vali Acc: 0.649 Test Loss: 0.892 Test Acc: 0.649
Validation loss decreased (-0.648640 --> -0.648640).  Saving model ...
Epoch: 28 cost time: 2.317929983139038
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.894 Vali Acc: 0.649 Test Loss: 0.894 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2699973583221436
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.892 Vali Acc: 0.662 Test Loss: 0.892 Test Acc: 0.662
Validation loss decreased (-0.648640 --> -0.662153).  Saving model ...
Epoch: 30 cost time: 2.064809799194336
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.889 Vali Acc: 0.649 Test Loss: 0.889 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.013859272003174
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.891 Vali Acc: 0.649 Test Loss: 0.891 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.304497241973877
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.896 Vali Acc: 0.649 Test Loss: 0.896 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.0962603092193604
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.894 Vali Acc: 0.662 Test Loss: 0.894 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.556699275970459
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.894 Vali Acc: 0.649 Test Loss: 0.894 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.566298007965088
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.892 Vali Acc: 0.662 Test Loss: 0.892 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 36 cost time: 2.2077832221984863
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.676 Test Loss: 0.893 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675667).  Saving model ...
Epoch: 37 cost time: 2.1948609352111816
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.662 Test Loss: 0.893 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.6231799125671387
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.893 Vali Acc: 0.662 Test Loss: 0.893 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.4029335975646973
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.895 Vali Acc: 0.662 Test Loss: 0.895 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.5995335578918457
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.897 Vali Acc: 0.662 Test Loss: 0.897 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.351032018661499
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.898 Vali Acc: 0.662 Test Loss: 0.898 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.5922207832336426
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.898 Vali Acc: 0.662 Test Loss: 0.898 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.5807383060455322
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.900 Vali Acc: 0.662 Test Loss: 0.900 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.5510239601135254
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.898 Vali Acc: 0.662 Test Loss: 0.898 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.282435417175293
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.900 Vali Acc: 0.662 Test Loss: 0.900 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.0536653995513916
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.900 Vali Acc: 0.662 Test Loss: 0.900 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 447132
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.364740371704102
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.433 Vali Acc: 0.189 Test Loss: 1.433 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 2.253979206085205
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.387 Vali Acc: 0.257 Test Loss: 1.387 Test Acc: 0.257
Validation loss decreased (-0.189175 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 2.859525442123413
Epoch: 3, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.348 Vali Acc: 0.284 Test Loss: 1.348 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 2.6617865562438965
Epoch: 4, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.306 Vali Acc: 0.324 Test Loss: 1.306 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 2.4417030811309814
Epoch: 5, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.260 Vali Acc: 0.378 Test Loss: 1.260 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 6 cost time: 2.2830119132995605
Epoch: 6, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.225 Vali Acc: 0.446 Test Loss: 1.225 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 2.1686415672302246
Epoch: 7, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.2491748332977295
Epoch: 8, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
Validation loss decreased (-0.499988 --> -0.594583).  Saving model ...
Epoch: 9 cost time: 2.1612110137939453
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.099 Vali Acc: 0.635 Test Loss: 1.099 Test Acc: 0.635
Validation loss decreased (-0.594583 --> -0.635124).  Saving model ...
Epoch: 10 cost time: 1.8436336517333984
Epoch: 10, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.072 Vali Acc: 0.649 Test Loss: 1.072 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648638).  Saving model ...
Epoch: 11 cost time: 2.306107759475708
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.061 Vali Acc: 0.635 Test Loss: 1.061 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.428170919418335
Epoch: 12, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.032 Vali Acc: 0.635 Test Loss: 1.032 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3078818321228027
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.037 Vali Acc: 0.662 Test Loss: 1.037 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662152).  Saving model ...
Epoch: 14 cost time: 2.604764699935913
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.029 Vali Acc: 0.649 Test Loss: 1.029 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5941081047058105
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.016 Vali Acc: 0.635 Test Loss: 1.016 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.832131862640381
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.412846803665161
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.017 Vali Acc: 0.662 Test Loss: 1.017 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 18 cost time: 2.3208656311035156
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.029 Vali Acc: 0.635 Test Loss: 1.029 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.357940196990967
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.021 Vali Acc: 0.635 Test Loss: 1.021 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.577322244644165
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.016 Vali Acc: 0.622 Test Loss: 1.016 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.204413414001465
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.019 Vali Acc: 0.622 Test Loss: 1.019 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.226884126663208
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.020 Vali Acc: 0.622 Test Loss: 1.020 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.540235996246338
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.020 Vali Acc: 0.622 Test Loss: 1.020 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5445775985717773
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.022 Vali Acc: 0.635 Test Loss: 1.022 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.372893810272217
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0729634761810303
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.484950304031372
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 442012
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.640059232711792
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.440 Vali Acc: 0.243 Test Loss: 1.440 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.5622789859771729
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.374 Vali Acc: 0.351 Test Loss: 1.374 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.6871874332427979
Epoch: 3, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.336 Vali Acc: 0.378 Test Loss: 1.336 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.887521743774414
Epoch: 4, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.8598110675811768
Epoch: 5, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.289 Vali Acc: 0.432 Test Loss: 1.289 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.6521458625793457
Epoch: 6, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.243 Vali Acc: 0.446 Test Loss: 1.243 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 1.7940573692321777
Epoch: 7, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.5902767181396484
Epoch: 8, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.693366289138794
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.150 Vali Acc: 0.554 Test Loss: 1.150 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 2.1261725425720215
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8842947483062744
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.1112728118896484
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1125993728637695
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9487214088439941
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.065 Vali Acc: 0.527 Test Loss: 1.065 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.167074680328369
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.688905954360962
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.061 Vali Acc: 0.527 Test Loss: 1.061 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4470348358154297
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 18 cost time: 1.9362144470214844
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.59110426902771
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6859872341156006
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9076616764068604
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9932713508605957
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.064 Vali Acc: 0.581 Test Loss: 1.064 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5761146545410156
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.071 Vali Acc: 0.568 Test Loss: 1.071 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7783102989196777
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.067 Vali Acc: 0.568 Test Loss: 1.067 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.656540870666504
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6677539348602295
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6259050369262695
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.076 Vali Acc: 0.581 Test Loss: 1.076 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 436892
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.661292791366577
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.431 Vali Acc: 0.216 Test Loss: 1.431 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.624316692352295
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.397 Vali Acc: 0.284 Test Loss: 1.397 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.4908912181854248
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.3538758754730225
Epoch: 4, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.357 Vali Acc: 0.311 Test Loss: 1.357 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 1.1474764347076416
Epoch: 5, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.340 Vali Acc: 0.311 Test Loss: 1.340 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 6 cost time: 1.3563063144683838
Epoch: 6, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.296 Vali Acc: 0.365 Test Loss: 1.296 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 1.2458767890930176
Epoch: 7, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.271 Vali Acc: 0.378 Test Loss: 1.271 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378366).  Saving model ...
Epoch: 8 cost time: 1.2318544387817383
Epoch: 8, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.228 Vali Acc: 0.446 Test Loss: 1.228 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.3786048889160156
Epoch: 9, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 1.3374736309051514
Epoch: 10, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.2815828323364258
Epoch: 11, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.230729103088379
Epoch: 12, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.219329833984375
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.4368300437927246
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1705832481384277
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 1.1131196022033691
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.133 Vali Acc: 0.581 Test Loss: 1.133 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 1.2682065963745117
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.122 Vali Acc: 0.581 Test Loss: 1.122 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 18 cost time: 1.3266565799713135
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5381455421447754
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1658704280853271
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.133 Vali Acc: 0.581 Test Loss: 1.133 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.466284990310669
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5185956954956055
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.129 Vali Acc: 0.568 Test Loss: 1.129 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7240312099456787
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6825010776519775
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.637216329574585
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.434539794921875
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.136 Vali Acc: 0.595 Test Loss: 1.136 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 27 cost time: 1.5493953227996826
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.139 Vali Acc: 0.608 Test Loss: 1.139 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 28 cost time: 1.3412070274353027
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.140 Vali Acc: 0.595 Test Loss: 1.140 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5861854553222656
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.139 Vali Acc: 0.568 Test Loss: 1.139 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5845530033111572
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.140 Vali Acc: 0.568 Test Loss: 1.140 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.907250165939331
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.145 Vali Acc: 0.595 Test Loss: 1.145 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8260862827301025
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.147 Vali Acc: 0.595 Test Loss: 1.147 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5403547286987305
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.149 Vali Acc: 0.595 Test Loss: 1.149 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5113942623138428
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3517069816589355
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.152 Vali Acc: 0.581 Test Loss: 1.152 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4102880954742432
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7394413948059082
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.153 Vali Acc: 0.595 Test Loss: 1.153 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 432796
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.362711191177368
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.443 Vali Acc: 0.230 Test Loss: 1.443 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.0870091915130615
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.1412708759307861
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.371 Vali Acc: 0.230 Test Loss: 1.371 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.335810661315918
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.9083461761474609
Epoch: 5, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.279 Vali Acc: 0.365 Test Loss: 1.279 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 1.1285958290100098
Epoch: 6, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.273 Vali Acc: 0.338 Test Loss: 1.273 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3159875869750977
Epoch: 7, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.207 Vali Acc: 0.432 Test Loss: 1.207 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 1.0839669704437256
Epoch: 8, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.145 Vali Acc: 0.459 Test Loss: 1.145 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 9 cost time: 1.2074549198150635
Epoch: 9, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.144 Vali Acc: 0.473 Test Loss: 1.144 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 10 cost time: 1.224433422088623
Epoch: 10, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.099 Vali Acc: 0.486 Test Loss: 1.099 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 1.0724577903747559
Epoch: 11, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.053 Vali Acc: 0.541 Test Loss: 1.053 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 0.9836781024932861
Epoch: 12, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.059 Vali Acc: 0.527 Test Loss: 1.059 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0511550903320312
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.034 Vali Acc: 0.554 Test Loss: 1.034 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 14 cost time: 1.202800989151001
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.017 Vali Acc: 0.554 Test Loss: 1.017 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 15 cost time: 1.0262696743011475
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.024 Vali Acc: 0.554 Test Loss: 1.024 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0935499668121338
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.014 Vali Acc: 0.541 Test Loss: 1.014 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1969869136810303
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.010 Vali Acc: 0.568 Test Loss: 1.010 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 18 cost time: 1.1689033508300781
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.007 Vali Acc: 0.568 Test Loss: 1.007 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 19 cost time: 1.064091682434082
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.007 Vali Acc: 0.568 Test Loss: 1.007 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0291407108306885
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.007 Vali Acc: 0.581 Test Loss: 1.007 Test Acc: 0.581
Validation loss decreased (-0.567558 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 1.0041604042053223
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.003 Vali Acc: 0.568 Test Loss: 1.003 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0092658996582031
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.001 Vali Acc: 0.568 Test Loss: 1.001 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9272534847259521
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.002 Vali Acc: 0.595 Test Loss: 1.002 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 24 cost time: 1.3004045486450195
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2658562660217285
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 26 cost time: 1.2476739883422852
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.001 Vali Acc: 0.581 Test Loss: 1.001 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.139739990234375
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.999 Vali Acc: 0.581 Test Loss: 0.999 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4266321659088135
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.001 Vali Acc: 0.581 Test Loss: 1.001 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1597020626068115
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.001 Vali Acc: 0.581 Test Loss: 1.001 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.131521463394165
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.000 Vali Acc: 0.581 Test Loss: 1.000 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1827850341796875
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.999 Vali Acc: 0.581 Test Loss: 0.999 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2790849208831787
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3716917037963867
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.005 Vali Acc: 0.581 Test Loss: 1.005 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1402366161346436
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.118408441543579
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 430748
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3552796840667725
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.390 Vali Acc: 0.297 Test Loss: 1.390 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.8356435298919678
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.329 Vali Acc: 0.392 Test Loss: 1.329 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7800095081329346
Epoch: 3, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.279 Vali Acc: 0.473 Test Loss: 1.279 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.8317313194274902
Epoch: 4, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.8034355640411377
Epoch: 5, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.201 Vali Acc: 0.568 Test Loss: 1.201 Test Acc: 0.568
Validation loss decreased (-0.486474 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.8588628768920898
Epoch: 6, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7545082569122314
Epoch: 7, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.116 Vali Acc: 0.595 Test Loss: 1.116 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 0.9488134384155273
Epoch: 8, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.063 Vali Acc: 0.541 Test Loss: 1.063 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8287665843963623
Epoch: 9, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.027 Vali Acc: 0.595 Test Loss: 1.027 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 0.8105247020721436
Epoch: 10, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.986 Vali Acc: 0.595 Test Loss: 0.986 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 11 cost time: 0.7347533702850342
Epoch: 11, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.967 Vali Acc: 0.595 Test Loss: 0.967 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 12 cost time: 0.7415883541107178
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 13 cost time: 0.9249603748321533
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.942 Vali Acc: 0.608 Test Loss: 0.942 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 14 cost time: 0.8531672954559326
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.933 Vali Acc: 0.608 Test Loss: 0.933 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 15 cost time: 0.8125271797180176
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.919 Vali Acc: 0.595 Test Loss: 0.919 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9223456382751465
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.916 Vali Acc: 0.622 Test Loss: 0.916 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 17 cost time: 0.9670774936676025
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.919 Vali Acc: 0.608 Test Loss: 0.919 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8013136386871338
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.917 Vali Acc: 0.622 Test Loss: 0.917 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8574328422546387
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.907 Vali Acc: 0.608 Test Loss: 0.907 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.800243616104126
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.902 Vali Acc: 0.622 Test Loss: 0.902 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621613).  Saving model ...
Epoch: 21 cost time: 0.845473051071167
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.900 Vali Acc: 0.622 Test Loss: 0.900 Test Acc: 0.622
Validation loss decreased (-0.621613 --> -0.621613).  Saving model ...
Epoch: 22 cost time: 0.7804839611053467
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.900 Vali Acc: 0.622 Test Loss: 0.900 Test Acc: 0.622
Validation loss decreased (-0.621613 --> -0.621613).  Saving model ...
Epoch: 23 cost time: 0.7420165538787842
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.901 Vali Acc: 0.622 Test Loss: 0.901 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8245499134063721
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.901 Vali Acc: 0.622 Test Loss: 0.901 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9889068603515625
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.902 Vali Acc: 0.635 Test Loss: 0.902 Test Acc: 0.635
Validation loss decreased (-0.621613 --> -0.635126).  Saving model ...
Epoch: 26 cost time: 0.8887600898742676
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.902 Vali Acc: 0.635 Test Loss: 0.902 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 27 cost time: 0.7385149002075195
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.899 Vali Acc: 0.622 Test Loss: 0.899 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9666073322296143
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.898 Vali Acc: 0.622 Test Loss: 0.898 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8977677822113037
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.899 Vali Acc: 0.635 Test Loss: 0.899 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 30 cost time: 0.8038778305053711
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.901 Vali Acc: 0.635 Test Loss: 0.901 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9472696781158447
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.635 Test Loss: 0.904 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9617147445678711
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.904 Vali Acc: 0.635 Test Loss: 0.904 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8529491424560547
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.905 Vali Acc: 0.635 Test Loss: 0.905 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9223575592041016
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.905 Vali Acc: 0.635 Test Loss: 0.905 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9332458972930908
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.907 Vali Acc: 0.635 Test Loss: 0.907 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8318603038787842
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.907 Vali Acc: 0.635 Test Loss: 0.907 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.83382248878479
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.908 Vali Acc: 0.635 Test Loss: 0.908 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9199907779693604
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.909 Vali Acc: 0.635 Test Loss: 0.909 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9613728523254395
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.909 Vali Acc: 0.635 Test Loss: 0.909 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 428700
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3779947757720947
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.364 Vali Acc: 0.270 Test Loss: 1.364 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.9181818962097168
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.363 Vali Acc: 0.351 Test Loss: 1.363 Test Acc: 0.351
Validation loss decreased (-0.270257 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.7959232330322266
Epoch: 3, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.327 Vali Acc: 0.365 Test Loss: 1.327 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.9572057723999023
Epoch: 4, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.275 Vali Acc: 0.419 Test Loss: 1.275 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.7898988723754883
Epoch: 5, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.7056903839111328
Epoch: 6, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.203 Vali Acc: 0.459 Test Loss: 1.203 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.9822547435760498
Epoch: 7, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.150 Vali Acc: 0.473 Test Loss: 1.150 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.909991979598999
Epoch: 8, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.8392260074615479
Epoch: 9, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.056 Vali Acc: 0.541 Test Loss: 1.056 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7634334564208984
Epoch: 10, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.069 Vali Acc: 0.514 Test Loss: 1.069 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.872084379196167
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.020 Vali Acc: 0.554 Test Loss: 1.020 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 12 cost time: 0.8818528652191162
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 0.8424680233001709
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8335103988647461
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.009 Vali Acc: 0.581 Test Loss: 1.009 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0288519859313965
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 16 cost time: 0.8274550437927246
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.011 Vali Acc: 0.581 Test Loss: 1.011 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9978320598602295
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.012 Vali Acc: 0.581 Test Loss: 1.012 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9046387672424316
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.011 Vali Acc: 0.581 Test Loss: 1.011 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8541748523712158
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.012 Vali Acc: 0.581 Test Loss: 1.012 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7573051452636719
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.015 Vali Acc: 0.568 Test Loss: 1.015 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.923151969909668
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.017 Vali Acc: 0.568 Test Loss: 1.017 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8689732551574707
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9633927345275879
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0961475372314453
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.032 Vali Acc: 0.568 Test Loss: 1.032 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.958491325378418
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 427164
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.2285449504852295
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.342 Vali Acc: 0.365 Test Loss: 1.342 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 3.218806505203247
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.290 Vali Acc: 0.459 Test Loss: 1.290 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 2.606349229812622
Epoch: 3, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.274 Vali Acc: 0.473 Test Loss: 1.274 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 3.093111515045166
Epoch: 4, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 3.0589821338653564
Epoch: 5, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 3.2436649799346924
Epoch: 6, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.088412046432495
Epoch: 7, Steps: 10 | Train Loss: 0.795 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 3.1959280967712402
Epoch: 8, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8369481563568115
Epoch: 9, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1570165157318115
Epoch: 10, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594585).  Saving model ...
Epoch: 11 cost time: 2.5492265224456787
Epoch: 11, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.987 Vali Acc: 0.608 Test Loss: 0.987 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 3.1593196392059326
Epoch: 12, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.967 Vali Acc: 0.595 Test Loss: 0.967 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.230762004852295
Epoch: 13, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.949 Vali Acc: 0.622 Test Loss: 0.949 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 14 cost time: 3.4016613960266113
Epoch: 14, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.936 Vali Acc: 0.635 Test Loss: 0.936 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 15 cost time: 3.2558627128601074
Epoch: 15, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.933 Vali Acc: 0.608 Test Loss: 0.933 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1787190437316895
Epoch: 16, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.950 Vali Acc: 0.635 Test Loss: 0.950 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0612809658050537
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.925 Vali Acc: 0.635 Test Loss: 0.925 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 18 cost time: 3.4151499271392822
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.923 Vali Acc: 0.622 Test Loss: 0.923 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.485572338104248
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.939 Vali Acc: 0.622 Test Loss: 0.939 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.115715265274048
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.938 Vali Acc: 0.635 Test Loss: 0.938 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.278590440750122
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.937 Vali Acc: 0.635 Test Loss: 0.937 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2935571670532227
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.938 Vali Acc: 0.635 Test Loss: 0.938 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.755120277404785
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.944 Vali Acc: 0.635 Test Loss: 0.944 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2639544010162354
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.941 Vali Acc: 0.635 Test Loss: 0.941 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.7803282737731934
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.937 Vali Acc: 0.622 Test Loss: 0.937 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0724213123321533
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.947 Vali Acc: 0.635 Test Loss: 0.947 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.1663477420806885
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.951 Vali Acc: 0.635 Test Loss: 0.951 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 452168
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.267899513244629
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.380 Vali Acc: 0.338 Test Loss: 1.380 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 2.4047176837921143
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.373701572418213
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.361 Vali Acc: 0.257 Test Loss: 1.361 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.146942138671875
Epoch: 4, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.316 Vali Acc: 0.365 Test Loss: 1.316 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 2.358010768890381
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.288 Vali Acc: 0.405 Test Loss: 1.288 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 2.1005849838256836
Epoch: 6, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 2.3538825511932373
Epoch: 7, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.227 Vali Acc: 0.473 Test Loss: 1.227 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6679458618164062
Epoch: 8, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.164 Vali Acc: 0.527 Test Loss: 1.164 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 2.4230566024780273
Epoch: 9, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 2.4613986015319824
Epoch: 10, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.6792094707489014
Epoch: 11, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2019758224487305
Epoch: 12, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.074 Vali Acc: 0.514 Test Loss: 1.074 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.06168532371521
Epoch: 13, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.042 Vali Acc: 0.541 Test Loss: 1.042 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.212506055831909
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.048 Vali Acc: 0.514 Test Loss: 1.048 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0988550186157227
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.027 Vali Acc: 0.541 Test Loss: 1.027 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.35573673248291
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.036 Vali Acc: 0.500 Test Loss: 1.036 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.535587787628174
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.023 Vali Acc: 0.581 Test Loss: 1.023 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 18 cost time: 2.3007326126098633
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.020 Vali Acc: 0.554 Test Loss: 1.020 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.52836537361145
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.034 Vali Acc: 0.554 Test Loss: 1.034 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2000415325164795
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1998143196105957
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.028 Vali Acc: 0.554 Test Loss: 1.028 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4394097328186035
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.36575984954834
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.031 Vali Acc: 0.568 Test Loss: 1.031 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.151895523071289
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.426607131958008
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.411573886871338
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3205504417419434
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.038 Vali Acc: 0.568 Test Loss: 1.038 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 447048
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.891738176345825
Epoch: 1, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.423 Vali Acc: 0.284 Test Loss: 1.423 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.750659704208374
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.8361639976501465
Epoch: 3, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.340 Vali Acc: 0.378 Test Loss: 1.340 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.062682628631592
Epoch: 4, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.314 Vali Acc: 0.419 Test Loss: 1.314 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 2.056950569152832
Epoch: 5, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.271 Vali Acc: 0.405 Test Loss: 1.271 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1364166736602783
Epoch: 6, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.217 Vali Acc: 0.432 Test Loss: 1.217 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.8460326194763184
Epoch: 7, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 2.505023241043091
Epoch: 8, Steps: 10 | Train Loss: 0.600 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 2.29921293258667
Epoch: 9, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.087573766708374
Epoch: 10, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9402973651885986
Epoch: 11, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.042 Vali Acc: 0.541 Test Loss: 1.042 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7463886737823486
Epoch: 12, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.026 Vali Acc: 0.554 Test Loss: 1.026 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.445991039276123
Epoch: 13, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.936323642730713
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.008 Vali Acc: 0.541 Test Loss: 1.008 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.356656789779663
Epoch: 15, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.003 Vali Acc: 0.554 Test Loss: 1.003 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.242884397506714
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.006 Vali Acc: 0.554 Test Loss: 1.006 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3308537006378174
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.997 Vali Acc: 0.568 Test Loss: 0.997 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0094494819641113
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.000 Vali Acc: 0.568 Test Loss: 1.000 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 441928
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8294241428375244
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.385 Vali Acc: 0.284 Test Loss: 1.385 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.685410499572754
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.370 Vali Acc: 0.351 Test Loss: 1.370 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.6883244514465332
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.333 Vali Acc: 0.405 Test Loss: 1.333 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.8545606136322021
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.310 Vali Acc: 0.432 Test Loss: 1.310 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.5976598262786865
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.50657320022583
Epoch: 6, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.4440090656280518
Epoch: 7, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.3811454772949219
Epoch: 8, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.437779188156128
Epoch: 9, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.091 Vali Acc: 0.527 Test Loss: 1.091 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7006945610046387
Epoch: 10, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.103 Vali Acc: 0.608 Test Loss: 1.103 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 1.7438833713531494
Epoch: 11, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6368494033813477
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.033 Vali Acc: 0.622 Test Loss: 1.033 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 1.4265623092651367
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.037 Vali Acc: 0.608 Test Loss: 1.037 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.552731990814209
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.030 Vali Acc: 0.662 Test Loss: 1.030 Test Acc: 0.662
Validation loss decreased (-0.621611 --> -0.662152).  Saving model ...
Epoch: 15 cost time: 1.4809980392456055
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.027 Vali Acc: 0.649 Test Loss: 1.027 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4757137298583984
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.035 Vali Acc: 0.635 Test Loss: 1.035 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.532815933227539
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.016 Vali Acc: 0.635 Test Loss: 1.016 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6322956085205078
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.025 Vali Acc: 0.649 Test Loss: 1.025 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.145198106765747
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.022 Vali Acc: 0.662 Test Loss: 1.022 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 20 cost time: 1.6288564205169678
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.040 Vali Acc: 0.649 Test Loss: 1.040 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5209524631500244
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.031 Vali Acc: 0.649 Test Loss: 1.031 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8545136451721191
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.024 Vali Acc: 0.649 Test Loss: 1.024 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.720444917678833
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.025 Vali Acc: 0.635 Test Loss: 1.025 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5941581726074219
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.041 Vali Acc: 0.649 Test Loss: 1.041 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.621835470199585
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.036 Vali Acc: 0.649 Test Loss: 1.036 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7325282096862793
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.035 Vali Acc: 0.662 Test Loss: 1.035 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8338496685028076
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.039 Vali Acc: 0.662 Test Loss: 1.039 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6165862083435059
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.041 Vali Acc: 0.635 Test Loss: 1.041 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.760547399520874
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.042 Vali Acc: 0.662 Test Loss: 1.042 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 436808
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3961782455444336
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.400 Vali Acc: 0.216 Test Loss: 1.400 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.5668699741363525
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.381 Vali Acc: 0.270 Test Loss: 1.381 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.671339988708496
Epoch: 3, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.343 Vali Acc: 0.311 Test Loss: 1.343 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.3007004261016846
Epoch: 4, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.286 Vali Acc: 0.392 Test Loss: 1.286 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.2861905097961426
Epoch: 5, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.3719539642333984
Epoch: 6, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.241 Vali Acc: 0.514 Test Loss: 1.241 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.1057963371276855
Epoch: 7, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.196180820465088
Epoch: 8, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.181 Vali Acc: 0.541 Test Loss: 1.181 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.2311279773712158
Epoch: 9, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.102 Vali Acc: 0.514 Test Loss: 1.102 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2693085670471191
Epoch: 10, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.3813467025756836
Epoch: 11, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.054 Vali Acc: 0.486 Test Loss: 1.054 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3925631046295166
Epoch: 12, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.457993507385254
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.005 Vali Acc: 0.527 Test Loss: 1.005 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1190860271453857
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.005 Vali Acc: 0.500 Test Loss: 1.005 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1802637577056885
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.016 Vali Acc: 0.514 Test Loss: 1.016 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.16395902633667
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.999 Vali Acc: 0.514 Test Loss: 0.999 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.146061897277832
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.982 Vali Acc: 0.527 Test Loss: 0.982 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2636613845825195
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.988 Vali Acc: 0.541 Test Loss: 0.988 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540531).  Saving model ...
Epoch: 19 cost time: 1.0234906673431396
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.996 Vali Acc: 0.527 Test Loss: 0.996 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2499701976776123
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.993 Vali Acc: 0.541 Test Loss: 0.993 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.515256643295288
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.982 Vali Acc: 0.554 Test Loss: 0.982 Test Acc: 0.554
Validation loss decreased (-0.540531 --> -0.554044).  Saving model ...
Epoch: 22 cost time: 1.2532248497009277
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.981 Vali Acc: 0.541 Test Loss: 0.981 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1499359607696533
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.992 Vali Acc: 0.527 Test Loss: 0.992 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4426813125610352
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.993 Vali Acc: 0.541 Test Loss: 0.993 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3814799785614014
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.993 Vali Acc: 0.541 Test Loss: 0.993 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3388350009918213
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.995 Vali Acc: 0.541 Test Loss: 0.995 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4194138050079346
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.994 Vali Acc: 0.541 Test Loss: 0.994 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1078357696533203
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.994 Vali Acc: 0.541 Test Loss: 0.994 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4772746562957764
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.995 Vali Acc: 0.541 Test Loss: 0.995 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0533688068389893
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.994 Vali Acc: 0.568 Test Loss: 0.994 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567558).  Saving model ...
Epoch: 31 cost time: 1.3687396049499512
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.995 Vali Acc: 0.568 Test Loss: 0.995 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.531952142715454
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.998 Vali Acc: 0.554 Test Loss: 0.998 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.373640537261963
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.000 Vali Acc: 0.568 Test Loss: 1.000 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7175283432006836
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.001 Vali Acc: 0.568 Test Loss: 1.001 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.474855899810791
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.007 Vali Acc: 0.541 Test Loss: 1.007 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3990964889526367
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.009 Vali Acc: 0.554 Test Loss: 1.009 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.241556167602539
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.008 Vali Acc: 0.554 Test Loss: 1.008 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6370749473571777
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.554 Test Loss: 1.012 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7056632041931152
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.554 Test Loss: 1.012 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.328014850616455
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.554 Test Loss: 1.012 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 432712
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8512814044952393
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.409 Vali Acc: 0.216 Test Loss: 1.409 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.9304251670837402
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.341 Vali Acc: 0.378 Test Loss: 1.341 Test Acc: 0.378
Validation loss decreased (-0.216202 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.2386846542358398
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.309 Vali Acc: 0.446 Test Loss: 1.309 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.1103763580322266
Epoch: 4, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.285 Vali Acc: 0.392 Test Loss: 1.285 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0825576782226562
Epoch: 5, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.266 Vali Acc: 0.378 Test Loss: 1.266 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1406502723693848
Epoch: 6, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.233 Vali Acc: 0.446 Test Loss: 1.233 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 1.2482271194458008
Epoch: 7, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.176 Vali Acc: 0.473 Test Loss: 1.176 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.2890050411224365
Epoch: 8, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.1106481552124023
Epoch: 9, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.1733546257019043
Epoch: 10, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.088 Vali Acc: 0.541 Test Loss: 1.088 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 1.089989423751831
Epoch: 11, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.091 Vali Acc: 0.527 Test Loss: 1.091 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.026249647140503
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 13 cost time: 1.0776536464691162
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.1307237148284912
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.046 Vali Acc: 0.541 Test Loss: 1.046 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.065412998199463
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.053 Vali Acc: 0.541 Test Loss: 1.053 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3609700202941895
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.051 Vali Acc: 0.568 Test Loss: 1.051 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 17 cost time: 1.0064523220062256
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 18 cost time: 0.9258549213409424
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.966313362121582
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.049 Vali Acc: 0.581 Test Loss: 1.049 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 20 cost time: 0.9661991596221924
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 1.2645149230957031
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0476605892181396
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0517151355743408
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.051 Vali Acc: 0.568 Test Loss: 1.051 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0989227294921875
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.054 Vali Acc: 0.568 Test Loss: 1.054 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.186424732208252
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9266510009765625
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 27 cost time: 1.1012179851531982
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 28 cost time: 1.3203668594360352
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.059 Vali Acc: 0.595 Test Loss: 1.059 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 29 cost time: 1.2099297046661377
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0797326564788818
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.065 Vali Acc: 0.608 Test Loss: 1.065 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 31 cost time: 1.2441818714141846
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.066 Vali Acc: 0.595 Test Loss: 1.066 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.041100263595581
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0769050121307373
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.069 Vali Acc: 0.608 Test Loss: 1.069 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1601266860961914
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2002513408660889
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.344778299331665
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.076 Vali Acc: 0.608 Test Loss: 1.076 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4155352115631104
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.356762409210205
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.386399745941162
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.084 Vali Acc: 0.608 Test Loss: 1.084 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3899264335632324
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.086 Vali Acc: 0.595 Test Loss: 1.086 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 430664
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.637680768966675
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.383 Vali Acc: 0.284 Test Loss: 1.383 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8923318386077881
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.371 Vali Acc: 0.324 Test Loss: 1.371 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.9137318134307861
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.334 Vali Acc: 0.338 Test Loss: 1.334 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.9475953578948975
Epoch: 4, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.276 Vali Acc: 0.405 Test Loss: 1.276 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.0083906650543213
Epoch: 5, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.253 Vali Acc: 0.405 Test Loss: 1.253 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.9175577163696289
Epoch: 6, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.210 Vali Acc: 0.405 Test Loss: 1.210 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 0.8837332725524902
Epoch: 7, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.159 Vali Acc: 0.432 Test Loss: 1.159 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432421).  Saving model ...
Epoch: 8 cost time: 1.0875816345214844
Epoch: 8, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.107 Vali Acc: 0.432 Test Loss: 1.107 Test Acc: 0.432
Validation loss decreased (-0.432421 --> -0.432421).  Saving model ...
Epoch: 9 cost time: 0.8746774196624756
Epoch: 9, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.104 Vali Acc: 0.473 Test Loss: 1.104 Test Acc: 0.473
Validation loss decreased (-0.432421 --> -0.472962).  Saving model ...
Epoch: 10 cost time: 1.0259227752685547
Epoch: 10, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.050 Vali Acc: 0.486 Test Loss: 1.050 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486476).  Saving model ...
Epoch: 11 cost time: 0.932689905166626
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.045 Vali Acc: 0.459 Test Loss: 1.045 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9204328060150146
Epoch: 12, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.029 Vali Acc: 0.486 Test Loss: 1.029 Test Acc: 0.486
Validation loss decreased (-0.486476 --> -0.486476).  Saving model ...
Epoch: 13 cost time: 0.9596219062805176
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
Validation loss decreased (-0.486476 --> -0.499990).  Saving model ...
Epoch: 14 cost time: 0.9360823631286621
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.090782880783081
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.011 Vali Acc: 0.527 Test Loss: 1.011 Test Acc: 0.527
Validation loss decreased (-0.499990 --> -0.527017).  Saving model ...
Epoch: 16 cost time: 0.894399881362915
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.019 Vali Acc: 0.514 Test Loss: 1.019 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8698439598083496
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.028 Vali Acc: 0.500 Test Loss: 1.028 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0587995052337646
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.033 Vali Acc: 0.514 Test Loss: 1.033 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1439464092254639
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.033 Vali Acc: 0.514 Test Loss: 1.033 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2847111225128174
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.029 Vali Acc: 0.514 Test Loss: 1.029 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.061126708984375
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.028 Vali Acc: 0.541 Test Loss: 1.028 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540530).  Saving model ...
Epoch: 22 cost time: 0.9347543716430664
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.038 Vali Acc: 0.500 Test Loss: 1.038 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2868640422821045
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.041 Vali Acc: 0.514 Test Loss: 1.041 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9264926910400391
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.044 Vali Acc: 0.514 Test Loss: 1.044 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8991773128509521
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.048 Vali Acc: 0.514 Test Loss: 1.048 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.061493158340454
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.052 Vali Acc: 0.514 Test Loss: 1.052 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8434572219848633
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0260765552520752
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 29 cost time: 0.9032034873962402
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.059 Vali Acc: 0.527 Test Loss: 1.059 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.008516550064087
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.059 Vali Acc: 0.554 Test Loss: 1.059 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2686498165130615
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1147558689117432
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8018679618835449
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9200479984283447
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.072 Vali Acc: 0.568 Test Loss: 1.072 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 35 cost time: 1.0121605396270752
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1146855354309082
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0518317222595215
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8889946937561035
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.086 Vali Acc: 0.568 Test Loss: 1.086 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0344836711883545
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.088 Vali Acc: 0.568 Test Loss: 1.088 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8485479354858398
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.03656005859375
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8723850250244141
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9362883567810059
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9461619853973389
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 428616
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.280641555786133
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.371 Vali Acc: 0.351 Test Loss: 1.371 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.8010108470916748
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9408228397369385
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.365 Vali Acc: 0.284 Test Loss: 1.365 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6777379512786865
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.282 Vali Acc: 0.324 Test Loss: 1.282 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7816212177276611
Epoch: 5, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.245 Vali Acc: 0.365 Test Loss: 1.245 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 0.8728783130645752
Epoch: 6, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.214 Vali Acc: 0.392 Test Loss: 1.214 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391880).  Saving model ...
Epoch: 7 cost time: 0.7523193359375
Epoch: 7, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.150 Vali Acc: 0.473 Test Loss: 1.150 Test Acc: 0.473
Validation loss decreased (-0.391880 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.8197767734527588
Epoch: 8, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.120 Vali Acc: 0.446 Test Loss: 1.120 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9620482921600342
Epoch: 9, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.095 Vali Acc: 0.473 Test Loss: 1.095 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 10 cost time: 0.8217847347259521
Epoch: 10, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.054 Vali Acc: 0.486 Test Loss: 1.054 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486476).  Saving model ...
Epoch: 11 cost time: 0.8548030853271484
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.063 Vali Acc: 0.514 Test Loss: 1.063 Test Acc: 0.514
Validation loss decreased (-0.486476 --> -0.513503).  Saving model ...
Epoch: 12 cost time: 0.7929861545562744
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9278976917266846
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.031346082687378
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8922700881958008
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.088 Vali Acc: 0.514 Test Loss: 1.088 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7722485065460205
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.092 Vali Acc: 0.514 Test Loss: 1.092 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7938005924224854
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8440604209899902
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7817983627319336
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8353989124298096
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8187398910522461
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 427080
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.513766765594482
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.7177510261535645
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.303785562515259
Epoch: 3, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.309 Vali Acc: 0.365 Test Loss: 1.309 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 2.4992551803588867
Epoch: 4, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.266 Vali Acc: 0.392 Test Loss: 1.266 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 2.576145648956299
Epoch: 5, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 2.7966556549072266
Epoch: 6, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.161 Vali Acc: 0.446 Test Loss: 1.161 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0545573234558105
Epoch: 7, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 2.8369386196136475
Epoch: 8, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 2.569606065750122
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 2.539618492126465
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9717369079589844
Epoch: 11, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.797180652618408
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 3.451054334640503
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.695019483566284
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.051 Vali Acc: 0.527 Test Loss: 1.051 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.981318950653076
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.045 Vali Acc: 0.568 Test Loss: 1.045 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3309566974639893
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.509643316268921
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.573657274246216
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.036 Vali Acc: 0.568 Test Loss: 1.036 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9740889072418213
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.039 Vali Acc: 0.554 Test Loss: 1.039 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.602907180786133
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.037 Vali Acc: 0.541 Test Loss: 1.037 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8482439517974854
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.718440294265747
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 452064
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.660233736038208
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.390 Vali Acc: 0.284 Test Loss: 1.390 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.723355770111084
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.361 Vali Acc: 0.351 Test Loss: 1.361 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 3.0067615509033203
Epoch: 3, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.324 Vali Acc: 0.351 Test Loss: 1.324 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 2.3854877948760986
Epoch: 4, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.244 Vali Acc: 0.392 Test Loss: 1.244 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 2.5012738704681396
Epoch: 5, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 2.5934150218963623
Epoch: 6, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.412107229232788
Epoch: 7, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.090 Vali Acc: 0.541 Test Loss: 1.090 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 2.8417258262634277
Epoch: 8, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.055 Vali Acc: 0.554 Test Loss: 1.055 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 2.764714002609253
Epoch: 9, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.024 Vali Acc: 0.568 Test Loss: 1.024 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 2.431445360183716
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.013 Vali Acc: 0.608 Test Loss: 1.013 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 2.5820934772491455
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1011581420898438
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.984 Vali Acc: 0.595 Test Loss: 0.984 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.354841470718384
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.976 Vali Acc: 0.595 Test Loss: 0.976 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.51540207862854
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.310336112976074
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.964 Vali Acc: 0.595 Test Loss: 0.964 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.1194634437561035
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.957 Vali Acc: 0.595 Test Loss: 0.957 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5528976917266846
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.952 Vali Acc: 0.595 Test Loss: 0.952 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1533303260803223
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.947 Vali Acc: 0.595 Test Loss: 0.947 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4798569679260254
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.941 Vali Acc: 0.595 Test Loss: 0.941 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4130806922912598
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 21 cost time: 2.393352746963501
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.938 Vali Acc: 0.608 Test Loss: 0.938 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 22 cost time: 2.951798915863037
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.936 Vali Acc: 0.608 Test Loss: 0.936 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 23 cost time: 2.626962900161743
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.935 Vali Acc: 0.608 Test Loss: 0.935 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 24 cost time: 2.6854028701782227
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.934 Vali Acc: 0.608 Test Loss: 0.934 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 25 cost time: 2.463836431503296
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.935 Vali Acc: 0.608 Test Loss: 0.935 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5301437377929688
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.933 Vali Acc: 0.608 Test Loss: 0.933 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 27 cost time: 2.816347599029541
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.931 Vali Acc: 0.608 Test Loss: 0.931 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 28 cost time: 3.1010141372680664
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.929 Vali Acc: 0.608 Test Loss: 0.929 Test Acc: 0.608
Validation loss decreased (-0.608099 --> -0.608099).  Saving model ...
Epoch: 29 cost time: 2.8199431896209717
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.929 Vali Acc: 0.608 Test Loss: 0.929 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.725285053253174
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.928 Vali Acc: 0.622 Test Loss: 0.928 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 31 cost time: 2.58534836769104
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.928 Vali Acc: 0.622 Test Loss: 0.928 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 32 cost time: 2.806346893310547
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 33 cost time: 2.7593092918395996
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.988640308380127
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.925 Vali Acc: 0.622 Test Loss: 0.925 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 35 cost time: 2.823086977005005
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.923 Vali Acc: 0.622 Test Loss: 0.923 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 36 cost time: 2.789355754852295
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.923 Vali Acc: 0.622 Test Loss: 0.923 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 37 cost time: 2.8938584327697754
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.923 Vali Acc: 0.622 Test Loss: 0.923 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 38 cost time: 2.7415740489959717
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.622 Test Loss: 0.924 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.4935693740844727
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.622 Test Loss: 0.924 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.4855010509490967
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.622 Test Loss: 0.922 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 41 cost time: 2.651556968688965
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.622 Test Loss: 0.922 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 42 cost time: 2.839599132537842
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.921 Vali Acc: 0.622 Test Loss: 0.921 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 43 cost time: 2.8790833950042725
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.622 Test Loss: 0.919 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 44 cost time: 2.4909565448760986
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.622 Test Loss: 0.919 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 45 cost time: 2.49869441986084
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.622 Test Loss: 0.919 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 46 cost time: 2.5370683670043945
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.635 Test Loss: 0.919 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 47 cost time: 2.8465640544891357
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.918 Vali Acc: 0.635 Test Loss: 0.918 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 48 cost time: 2.7066149711608887
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.918 Vali Acc: 0.635 Test Loss: 0.918 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.4334702491760254
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.635 Test Loss: 0.918 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 50 cost time: 2.8021137714385986
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.635 Test Loss: 0.918 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.870774030685425
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 52 cost time: 3.0994112491607666
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 53 cost time: 2.975510835647583
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.649 Test Loss: 0.917 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 54 cost time: 3.182636022567749
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.649 Test Loss: 0.917 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.9935548305511475
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.649 Test Loss: 0.917 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.872321844100952
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.649 Test Loss: 0.917 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 57 cost time: 3.147210121154785
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.649 Test Loss: 0.916 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 58 cost time: 2.6586737632751465
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.649 Test Loss: 0.916 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 59 cost time: 3.252471685409546
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.649 Test Loss: 0.916 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.7246108055114746
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.649 Test Loss: 0.916 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.447263479232788
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.649 Test Loss: 0.917 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.063342571258545
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.1366472244262695
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 4.37337851524353
Epoch: 64, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 2.8194615840911865
Epoch: 65, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.005415439605713
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.649 Test Loss: 0.917 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 2.9518580436706543
Epoch: 67, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 2.7406041622161865
Epoch: 68, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.649 Test Loss: 0.918 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 446944
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.238797187805176
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.425 Vali Acc: 0.230 Test Loss: 1.425 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.7208328247070312
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.373 Vali Acc: 0.351 Test Loss: 1.373 Test Acc: 0.351
Validation loss decreased (-0.229715 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.6999924182891846
Epoch: 3, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.304 Vali Acc: 0.432 Test Loss: 1.304 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.7327044010162354
Epoch: 4, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 2.050065279006958
Epoch: 5, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.221 Vali Acc: 0.514 Test Loss: 1.221 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 2.093853235244751
Epoch: 6, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 2.2956299781799316
Epoch: 7, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.125 Vali Acc: 0.581 Test Loss: 1.125 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 1.9319465160369873
Epoch: 8, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3927195072174072
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.092 Vali Acc: 0.568 Test Loss: 1.092 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5779342651367188
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.064 Vali Acc: 0.581 Test Loss: 1.064 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.9840075969696045
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 2.7637856006622314
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.841806650161743
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.049 Vali Acc: 0.595 Test Loss: 1.049 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 2.566394090652466
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 2.15592098236084
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.038 Vali Acc: 0.595 Test Loss: 1.038 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 16 cost time: 2.2260515689849854
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 2.4047164916992188
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 18 cost time: 2.202814817428589
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.038 Vali Acc: 0.595 Test Loss: 1.038 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2354342937469482
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.21883487701416
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4627747535705566
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.031 Vali Acc: 0.608 Test Loss: 1.031 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 22 cost time: 2.250394582748413
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.031 Vali Acc: 0.595 Test Loss: 1.031 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.213526487350464
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.030 Vali Acc: 0.608 Test Loss: 1.030 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 24 cost time: 2.2920143604278564
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.029 Vali Acc: 0.608 Test Loss: 1.029 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 25 cost time: 2.1746463775634766
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.029 Vali Acc: 0.595 Test Loss: 1.029 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4734842777252197
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2324371337890625
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.027 Vali Acc: 0.595 Test Loss: 1.027 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8100695610046387
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.025 Vali Acc: 0.608 Test Loss: 1.025 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 29 cost time: 1.94783353805542
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.487579107284546
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.324709415435791
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.510148048400879
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.027 Vali Acc: 0.595 Test Loss: 1.027 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.1511096954345703
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7762067317962646
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8139538764953613
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.595 Test Loss: 1.027 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.8842074871063232
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.2898504734039307
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.595 Test Loss: 1.027 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.414616584777832
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.595 Test Loss: 1.027 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 441824
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9005966186523438
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.431 Vali Acc: 0.297 Test Loss: 1.431 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.6162428855895996
Epoch: 2, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.402 Vali Acc: 0.324 Test Loss: 1.402 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 2.0285887718200684
Epoch: 3, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.369 Vali Acc: 0.365 Test Loss: 1.369 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.851475715637207
Epoch: 4, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.320 Vali Acc: 0.405 Test Loss: 1.320 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.9438164234161377
Epoch: 5, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.6788647174835205
Epoch: 6, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.209 Vali Acc: 0.527 Test Loss: 1.209 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.596409797668457
Epoch: 7, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581069).  Saving model ...
Epoch: 8 cost time: 1.791318655014038
Epoch: 8, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.136 Vali Acc: 0.635 Test Loss: 1.136 Test Acc: 0.635
Validation loss decreased (-0.581069 --> -0.635124).  Saving model ...
Epoch: 9 cost time: 1.530864953994751
Epoch: 9, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.110 Vali Acc: 0.635 Test Loss: 1.110 Test Acc: 0.635
Validation loss decreased (-0.635124 --> -0.635124).  Saving model ...
Epoch: 10 cost time: 1.9297478199005127
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.085 Vali Acc: 0.622 Test Loss: 1.085 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.186629056930542
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.073 Vali Acc: 0.649 Test Loss: 1.073 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648638).  Saving model ...
Epoch: 12 cost time: 1.8729352951049805
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.068 Vali Acc: 0.649 Test Loss: 1.068 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 13 cost time: 2.266512632369995
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.057 Vali Acc: 0.649 Test Loss: 1.057 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 14 cost time: 1.9148387908935547
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.049 Vali Acc: 0.649 Test Loss: 1.049 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 15 cost time: 1.6431317329406738
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.047 Vali Acc: 0.649 Test Loss: 1.047 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 16 cost time: 1.6722166538238525
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.045 Vali Acc: 0.649 Test Loss: 1.045 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 17 cost time: 2.036081314086914
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.047 Vali Acc: 0.649 Test Loss: 1.047 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4261987209320068
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.044 Vali Acc: 0.649 Test Loss: 1.044 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 19 cost time: 1.7323076725006104
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.041 Vali Acc: 0.649 Test Loss: 1.041 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 20 cost time: 2.235654354095459
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.035 Vali Acc: 0.649 Test Loss: 1.035 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 21 cost time: 1.66176438331604
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.032 Vali Acc: 0.649 Test Loss: 1.032 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 22 cost time: 1.5957634449005127
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.031 Vali Acc: 0.649 Test Loss: 1.031 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 23 cost time: 2.3073370456695557
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.029 Vali Acc: 0.662 Test Loss: 1.029 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662152).  Saving model ...
Epoch: 24 cost time: 2.052577018737793
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.028 Vali Acc: 0.662 Test Loss: 1.028 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 25 cost time: 2.0170724391937256
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.027 Vali Acc: 0.662 Test Loss: 1.027 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 26 cost time: 1.8872416019439697
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.025 Vali Acc: 0.662 Test Loss: 1.025 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 27 cost time: 1.9950788021087646
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.024 Vali Acc: 0.662 Test Loss: 1.024 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 28 cost time: 1.5759618282318115
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.022 Vali Acc: 0.662 Test Loss: 1.022 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 29 cost time: 1.8011283874511719
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.023 Vali Acc: 0.662 Test Loss: 1.023 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7175850868225098
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.021 Vali Acc: 0.662 Test Loss: 1.021 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 31 cost time: 1.8281996250152588
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.022 Vali Acc: 0.662 Test Loss: 1.022 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7840852737426758
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.019 Vali Acc: 0.649 Test Loss: 1.019 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7730262279510498
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.020 Vali Acc: 0.649 Test Loss: 1.020 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7349002361297607
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.020 Vali Acc: 0.649 Test Loss: 1.020 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5875067710876465
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5033304691314697
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.649 Test Loss: 1.017 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6425323486328125
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.0628979206085205
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.016 Vali Acc: 0.649 Test Loss: 1.016 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4804389476776123
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.813662052154541
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 436704
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4742913246154785
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.433 Vali Acc: 0.216 Test Loss: 1.433 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.4881715774536133
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.365 Vali Acc: 0.297 Test Loss: 1.365 Test Acc: 0.297
Validation loss decreased (-0.216202 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.3269269466400146
Epoch: 3, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.296 Vali Acc: 0.405 Test Loss: 1.296 Test Acc: 0.405
Validation loss decreased (-0.297284 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.0831961631774902
Epoch: 4, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
Validation loss decreased (-0.405392 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.0872061252593994
Epoch: 5, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.1747539043426514
Epoch: 6, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.1511714458465576
Epoch: 7, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 1.436582088470459
Epoch: 8, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.054 Vali Acc: 0.622 Test Loss: 1.054 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 1.3393681049346924
Epoch: 9, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.030 Vali Acc: 0.635 Test Loss: 1.030 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 10 cost time: 1.3819084167480469
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 11 cost time: 1.288611888885498
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.000 Vali Acc: 0.635 Test Loss: 1.000 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 1.1699695587158203
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.997 Vali Acc: 0.635 Test Loss: 0.997 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 13 cost time: 1.168463945388794
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.994 Vali Acc: 0.649 Test Loss: 0.994 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 14 cost time: 1.0991051197052002
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.988 Vali Acc: 0.649 Test Loss: 0.988 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 15 cost time: 1.3012430667877197
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.985 Vali Acc: 0.649 Test Loss: 0.985 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 1.2596557140350342
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.980 Vali Acc: 0.649 Test Loss: 0.980 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 17 cost time: 1.2952499389648438
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.973 Vali Acc: 0.649 Test Loss: 0.973 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 18 cost time: 1.3306453227996826
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.971 Vali Acc: 0.649 Test Loss: 0.971 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 19 cost time: 1.2717974185943604
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.972 Vali Acc: 0.649 Test Loss: 0.972 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4976794719696045
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.970 Vali Acc: 0.649 Test Loss: 0.970 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 21 cost time: 1.5867836475372314
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.970 Vali Acc: 0.649 Test Loss: 0.970 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3468194007873535
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.969 Vali Acc: 0.649 Test Loss: 0.969 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 23 cost time: 1.3460612297058105
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.967 Vali Acc: 0.649 Test Loss: 0.967 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 24 cost time: 1.2929530143737793
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 25 cost time: 1.3033709526062012
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 26 cost time: 1.402338981628418
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4177908897399902
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.964 Vali Acc: 0.649 Test Loss: 0.964 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 28 cost time: 1.3797502517700195
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.963 Vali Acc: 0.649 Test Loss: 0.963 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 29 cost time: 1.3499293327331543
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.963 Vali Acc: 0.649 Test Loss: 0.963 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 30 cost time: 1.3459124565124512
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 31 cost time: 1.5245206356048584
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 32 cost time: 1.6938960552215576
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 33 cost time: 1.2687633037567139
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.169149398803711
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 35 cost time: 1.1569230556488037
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2006585597991943
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3994121551513672
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6104116439819336
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6423592567443848
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2914981842041016
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1068305969238281
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 42 cost time: 1.2173471450805664
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 43 cost time: 1.1245501041412354
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 44 cost time: 1.317101240158081
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1870169639587402
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2232215404510498
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.560955286026001
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 48 cost time: 1.0271849632263184
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0824978351593018
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.368229627609253
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.040731430053711
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2738251686096191
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.400599718093872
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1590535640716553
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2345809936523438
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.2248239517211914
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.662 Test Loss: 0.959 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 57 cost time: 1.2930457592010498
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.662 Test Loss: 0.959 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 58 cost time: 1.2165138721466064
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.662 Test Loss: 0.958 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 59 cost time: 1.1700901985168457
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0949952602386475
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.2121622562408447
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.289229393005371
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1121766567230225
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0329909324645996
Epoch: 64, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.2445783615112305
Epoch: 65, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.3782575130462646
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.649 Test Loss: 0.959 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.315075159072876
Epoch: 67, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.1575241088867188
Epoch: 68, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 432608
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2850396633148193
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9135417938232422
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.371 Vali Acc: 0.351 Test Loss: 1.371 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8864259719848633
Epoch: 3, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.010387897491455
Epoch: 4, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.252 Vali Acc: 0.459 Test Loss: 1.252 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9872622489929199
Epoch: 5, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.207 Vali Acc: 0.527 Test Loss: 1.207 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.8179192543029785
Epoch: 6, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.8781154155731201
Epoch: 7, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.9741346836090088
Epoch: 8, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.0331790447235107
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0648162364959717
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9671878814697266
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 0.9092161655426025
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.0114009380340576
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 0.9470744132995605
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.044 Vali Acc: 0.581 Test Loss: 1.044 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 15 cost time: 0.9386765956878662
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 16 cost time: 1.0957698822021484
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.037 Vali Acc: 0.581 Test Loss: 1.037 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 17 cost time: 1.0132765769958496
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.144350528717041
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0182485580444336
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.034 Vali Acc: 0.541 Test Loss: 1.034 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.859450101852417
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.030 Vali Acc: 0.554 Test Loss: 1.030 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0703320503234863
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.031 Vali Acc: 0.541 Test Loss: 1.031 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3628809452056885
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.032 Vali Acc: 0.541 Test Loss: 1.032 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0537550449371338
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.031 Vali Acc: 0.541 Test Loss: 1.031 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9413926601409912
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.029 Vali Acc: 0.541 Test Loss: 1.029 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1024253368377686
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.026 Vali Acc: 0.541 Test Loss: 1.026 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1646623611450195
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.026 Vali Acc: 0.541 Test Loss: 1.026 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 430560
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4456918239593506
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.413 Vali Acc: 0.230 Test Loss: 1.413 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.2263541221618652
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (-0.229716 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.4357924461364746
Epoch: 3, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.335 Vali Acc: 0.378 Test Loss: 1.335 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.9031631946563721
Epoch: 4, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.257 Vali Acc: 0.473 Test Loss: 1.257 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.1138393878936768
Epoch: 5, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8832454681396484
Epoch: 6, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.9968838691711426
Epoch: 7, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.7921018600463867
Epoch: 8, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.098 Vali Acc: 0.608 Test Loss: 1.098 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.0726943016052246
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.074 Vali Acc: 0.608 Test Loss: 1.074 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 1.0640294551849365
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.061 Vali Acc: 0.608 Test Loss: 1.061 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 1.045569896697998
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.052 Vali Acc: 0.608 Test Loss: 1.052 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.0994784832000732
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.049 Vali Acc: 0.608 Test Loss: 1.049 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 1.0809407234191895
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.043 Vali Acc: 0.622 Test Loss: 1.043 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 14 cost time: 1.0402586460113525
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.038 Vali Acc: 0.622 Test Loss: 1.038 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 15 cost time: 0.8583865165710449
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.035 Vali Acc: 0.622 Test Loss: 1.035 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 16 cost time: 1.0864179134368896
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.033 Vali Acc: 0.622 Test Loss: 1.033 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 17 cost time: 0.99863600730896
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.029 Vali Acc: 0.622 Test Loss: 1.029 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 18 cost time: 1.0029277801513672
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 19 cost time: 0.9221587181091309
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 20 cost time: 1.0209763050079346
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 21 cost time: 0.993401050567627
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.018 Vali Acc: 0.622 Test Loss: 1.018 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 22 cost time: 0.939824104309082
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.016 Vali Acc: 0.622 Test Loss: 1.016 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 23 cost time: 1.1020050048828125
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.622 Test Loss: 1.014 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 24 cost time: 0.9215719699859619
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.013 Vali Acc: 0.622 Test Loss: 1.013 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 25 cost time: 0.9363677501678467
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 26 cost time: 1.0350048542022705
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.010 Vali Acc: 0.622 Test Loss: 1.010 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 27 cost time: 0.9571566581726074
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.011 Vali Acc: 0.622 Test Loss: 1.011 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2525641918182373
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.009 Vali Acc: 0.622 Test Loss: 1.009 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 29 cost time: 1.2829828262329102
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 30 cost time: 1.0319514274597168
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 31 cost time: 0.9770336151123047
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 32 cost time: 1.1565561294555664
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0159590244293213
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 34 cost time: 0.8946566581726074
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 35 cost time: 0.9141716957092285
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9392209053039551
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8530406951904297
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 38 cost time: 1.0373260974884033
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 39 cost time: 1.0635459423065186
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8535435199737549
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.635 Test Loss: 1.003 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 41 cost time: 1.0766832828521729
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.635 Test Loss: 1.002 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 42 cost time: 1.0388214588165283
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.635 Test Loss: 1.003 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.800623893737793
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9532642364501953
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.81394362449646
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8752908706665039
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0682423114776611
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0218310356140137
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.005556583404541
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9884648323059082
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.054537057876587
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 428512
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.735261917114258
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.379 Vali Acc: 0.243 Test Loss: 1.379 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.886202335357666
Epoch: 2, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.330 Vali Acc: 0.297 Test Loss: 1.330 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.8777399063110352
Epoch: 3, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.279 Vali Acc: 0.365 Test Loss: 1.279 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.9277307987213135
Epoch: 4, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.197 Vali Acc: 0.446 Test Loss: 1.197 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.8265678882598877
Epoch: 5, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.445934 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.8155398368835449
Epoch: 6, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.9569234848022461
Epoch: 7, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.6824939250946045
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 0.8650038242340088
Epoch: 9, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.1050803661346436
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.021 Vali Acc: 0.595 Test Loss: 1.021 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.7791106700897217
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.017 Vali Acc: 0.595 Test Loss: 1.017 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.9624764919281006
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 0.9996213912963867
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 14 cost time: 0.9925210475921631
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 15 cost time: 0.9910247325897217
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 16 cost time: 0.8881123065948486
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 17 cost time: 0.7729392051696777
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7772438526153564
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 19 cost time: 0.9732840061187744
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 20 cost time: 0.8138275146484375
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.595 Test Loss: 0.996 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 21 cost time: 0.9103584289550781
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 22 cost time: 0.8894414901733398
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 23 cost time: 0.8961455821990967
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 24 cost time: 0.6919097900390625
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8907065391540527
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.990 Vali Acc: 0.595 Test Loss: 0.990 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 26 cost time: 0.9381768703460693
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.859417200088501
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8988561630249023
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9670395851135254
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9021527767181396
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9542267322540283
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7431395053863525
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9224903583526611
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8757293224334717
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7074675559997559
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 426976
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.284716606140137
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.411 Vali Acc: 0.351 Test Loss: 1.411 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 2.6930153369903564
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.406 Vali Acc: 0.338 Test Loss: 1.406 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.812394380569458
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.382 Vali Acc: 0.284 Test Loss: 1.382 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0099031925201416
Epoch: 4, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.353 Vali Acc: 0.284 Test Loss: 1.353 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.842963457107544
Epoch: 5, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.296 Vali Acc: 0.324 Test Loss: 1.296 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8300037384033203
Epoch: 6, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
Validation loss decreased (-0.351337 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 3.106917381286621
Epoch: 7, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.229 Vali Acc: 0.459 Test Loss: 1.229 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 3.7902889251708984
Epoch: 8, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 3.6187820434570312
Epoch: 9, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.294088840484619
Epoch: 10, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 3.0407800674438477
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.116 Vali Acc: 0.514 Test Loss: 1.116 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.387578010559082
Epoch: 12, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 3.206315755844116
Epoch: 13, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3548264503479004
Epoch: 14, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4085819721221924
Epoch: 15, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 16 cost time: 3.524746894836426
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.088 Vali Acc: 0.568 Test Loss: 1.088 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 17 cost time: 3.570152521133423
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3423726558685303
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.059 Vali Acc: 0.554 Test Loss: 1.059 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8005177974700928
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.071 Vali Acc: 0.595 Test Loss: 1.071 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 20 cost time: 3.0053470134735107
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.072 Vali Acc: 0.581 Test Loss: 1.072 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.539259672164917
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.011237621307373
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.064 Vali Acc: 0.581 Test Loss: 1.064 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1255414485931396
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 24 cost time: 3.8960232734680176
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 25 cost time: 3.0590927600860596
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.064 Vali Acc: 0.581 Test Loss: 1.064 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3680837154388428
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.068 Vali Acc: 0.595 Test Loss: 1.068 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0530593395233154
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.074 Vali Acc: 0.595 Test Loss: 1.074 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.260838270187378
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.2491190433502197
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.076 Vali Acc: 0.581 Test Loss: 1.076 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.284191608428955
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.070 Vali Acc: 0.581 Test Loss: 1.070 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.2776055335998535
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.2102341651916504
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 33 cost time: 2.7104921340942383
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 34 cost time: 3.6040680408477783
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.074 Vali Acc: 0.608 Test Loss: 1.074 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.144696474075317
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.077 Vali Acc: 0.608 Test Loss: 1.077 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.4996204376220703
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.7824199199676514
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.6590611934661865
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.917546272277832
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.556652784347534
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.26219630241394
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.301056146621704
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.086 Vali Acc: 0.608 Test Loss: 1.086 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.093294382095337
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 234820
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.725462198257446
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.365 Vali Acc: 0.311 Test Loss: 1.365 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.943399429321289
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.344 Vali Acc: 0.351 Test Loss: 1.344 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.6228373050689697
Epoch: 3, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.316 Vali Acc: 0.405 Test Loss: 1.316 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.4062132835388184
Epoch: 4, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.282 Vali Acc: 0.446 Test Loss: 1.282 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.299973964691162
Epoch: 5, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.235 Vali Acc: 0.432 Test Loss: 1.235 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3896543979644775
Epoch: 6, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 2.3548269271850586
Epoch: 7, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 2.710672616958618
Epoch: 8, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 2.9517548084259033
Epoch: 9, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.393450975418091
Epoch: 10, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 2.587089776992798
Epoch: 11, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5788064002990723
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.994 Vali Acc: 0.622 Test Loss: 0.994 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 13 cost time: 2.635253429412842
Epoch: 13, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.967 Vali Acc: 0.622 Test Loss: 0.967 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 14 cost time: 2.5099546909332275
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 2.4921369552612305
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.974 Vali Acc: 0.608 Test Loss: 0.974 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.581723690032959
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.947 Vali Acc: 0.595 Test Loss: 0.947 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5320582389831543
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.946 Vali Acc: 0.595 Test Loss: 0.946 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.516345500946045
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.951 Vali Acc: 0.622 Test Loss: 0.951 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6448395252227783
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.951 Vali Acc: 0.649 Test Loss: 0.951 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 20 cost time: 2.215148448944092
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.946 Vali Acc: 0.635 Test Loss: 0.946 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3348500728607178
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.942 Vali Acc: 0.622 Test Loss: 0.942 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3918251991271973
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.935 Vali Acc: 0.622 Test Loss: 0.935 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.889512300491333
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.942 Vali Acc: 0.649 Test Loss: 0.942 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 24 cost time: 2.518824815750122
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.946 Vali Acc: 0.649 Test Loss: 0.946 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.368898868560791
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.946 Vali Acc: 0.662 Test Loss: 0.946 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 26 cost time: 3.0608808994293213
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.946 Vali Acc: 0.662 Test Loss: 0.946 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 27 cost time: 2.4072301387786865
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.943 Vali Acc: 0.649 Test Loss: 0.943 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2267253398895264
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.943 Vali Acc: 0.649 Test Loss: 0.943 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3634653091430664
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.946 Vali Acc: 0.649 Test Loss: 0.946 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.471111536026001
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.949 Vali Acc: 0.649 Test Loss: 0.949 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.9591736793518066
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.950 Vali Acc: 0.662 Test Loss: 0.950 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.808570146560669
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.949 Vali Acc: 0.662 Test Loss: 0.949 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.6362178325653076
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.948 Vali Acc: 0.676 Test Loss: 0.948 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 34 cost time: 2.471865653991699
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.949 Vali Acc: 0.676 Test Loss: 0.949 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.969038724899292
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.951 Vali Acc: 0.676 Test Loss: 0.951 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.1416702270507812
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.955 Vali Acc: 0.676 Test Loss: 0.955 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.7622084617614746
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.958 Vali Acc: 0.676 Test Loss: 0.958 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.2293009757995605
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.961 Vali Acc: 0.676 Test Loss: 0.961 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.997952699661255
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.962 Vali Acc: 0.676 Test Loss: 0.962 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.1152923107147217
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.961 Vali Acc: 0.676 Test Loss: 0.961 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.758195638656616
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.965 Vali Acc: 0.676 Test Loss: 0.965 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.664003849029541
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.963 Vali Acc: 0.676 Test Loss: 0.963 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.7819600105285645
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.966 Vali Acc: 0.676 Test Loss: 0.966 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 232260
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.615880012512207
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.554 Vali Acc: 0.149 Test Loss: 1.554 Test Acc: 0.149
Validation loss decreased (inf --> -0.148633).  Saving model ...
Epoch: 2 cost time: 2.4927079677581787
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.494 Vali Acc: 0.149 Test Loss: 1.494 Test Acc: 0.149
Validation loss decreased (-0.148633 --> -0.148634).  Saving model ...
Epoch: 3 cost time: 2.700226306915283
Epoch: 3, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.445 Vali Acc: 0.203 Test Loss: 1.445 Test Acc: 0.203
Validation loss decreased (-0.148634 --> -0.202688).  Saving model ...
Epoch: 4 cost time: 2.4059293270111084
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (-0.202688 --> -0.270256).  Saving model ...
Epoch: 5 cost time: 2.5086045265197754
Epoch: 5, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.365 Vali Acc: 0.311 Test Loss: 1.365 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 6 cost time: 2.0851523876190186
Epoch: 6, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.332 Vali Acc: 0.351 Test Loss: 1.332 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 7 cost time: 2.5310418605804443
Epoch: 7, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.288 Vali Acc: 0.338 Test Loss: 1.288 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7510693073272705
Epoch: 8, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 2.653730630874634
Epoch: 9, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.211 Vali Acc: 0.405 Test Loss: 1.211 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7641968727111816
Epoch: 10, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.155 Vali Acc: 0.446 Test Loss: 1.155 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 11 cost time: 2.4623465538024902
Epoch: 11, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.150 Vali Acc: 0.473 Test Loss: 1.150 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 12 cost time: 2.438659429550171
Epoch: 12, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.148 Vali Acc: 0.459 Test Loss: 1.148 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3990542888641357
Epoch: 13, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.105 Vali Acc: 0.459 Test Loss: 1.105 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.362104654312134
Epoch: 14, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.109 Vali Acc: 0.459 Test Loss: 1.109 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0610783100128174
Epoch: 15, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 3.0085489749908447
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 3.132629156112671
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.093 Vali Acc: 0.486 Test Loss: 1.093 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.783357858657837
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 19 cost time: 2.834289312362671
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 20 cost time: 2.7889041900634766
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0560076236724854
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.080 Vali Acc: 0.514 Test Loss: 1.080 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5149402618408203
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6164052486419678
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 24 cost time: 2.592784881591797
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.074 Vali Acc: 0.514 Test Loss: 1.074 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.260474443435669
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.071 Vali Acc: 0.514 Test Loss: 1.071 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.065235137939453
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.065 Vali Acc: 0.527 Test Loss: 1.065 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 27 cost time: 2.327216386795044
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.069 Vali Acc: 0.527 Test Loss: 1.069 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4034061431884766
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 29 cost time: 2.550713300704956
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 30 cost time: 3.152045249938965
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.067 Vali Acc: 0.568 Test Loss: 1.067 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 31 cost time: 2.4957520961761475
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.411066770553589
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.069 Vali Acc: 0.554 Test Loss: 1.069 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0282697677612305
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.2010281085968018
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.072 Vali Acc: 0.568 Test Loss: 1.072 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.317868947982788
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.071 Vali Acc: 0.568 Test Loss: 1.071 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.684872627258301
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.074 Vali Acc: 0.581 Test Loss: 1.074 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 37 cost time: 1.9953370094299316
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.074627161026001
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.078 Vali Acc: 0.568 Test Loss: 1.078 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.735605001449585
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.077 Vali Acc: 0.568 Test Loss: 1.077 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.089423656463623
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.077 Vali Acc: 0.568 Test Loss: 1.077 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.3119349479675293
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.078 Vali Acc: 0.568 Test Loss: 1.078 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.57002592086792
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.735079765319824
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.082 Vali Acc: 0.568 Test Loss: 1.082 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.839303731918335
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.5663790702819824
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.581 Test Loss: 1.083 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.0665533542633057
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 229700
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5067081451416016
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.388 Vali Acc: 0.243 Test Loss: 1.388 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.6371264457702637
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.351 Vali Acc: 0.284 Test Loss: 1.351 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.562708854675293
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.322 Vali Acc: 0.392 Test Loss: 1.322 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.4291577339172363
Epoch: 4, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.276 Vali Acc: 0.405 Test Loss: 1.276 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.6720490455627441
Epoch: 5, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.223 Vali Acc: 0.514 Test Loss: 1.223 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.6718690395355225
Epoch: 6, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.179 Vali Acc: 0.568 Test Loss: 1.179 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 1.575047254562378
Epoch: 7, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.448622465133667
Epoch: 8, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.5152828693389893
Epoch: 9, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.078 Vali Acc: 0.635 Test Loss: 1.078 Test Acc: 0.635
Validation loss decreased (-0.581070 --> -0.635124).  Saving model ...
Epoch: 10 cost time: 1.384812831878662
Epoch: 10, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.040 Vali Acc: 0.649 Test Loss: 1.040 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648638).  Saving model ...
Epoch: 11 cost time: 1.2967092990875244
Epoch: 11, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4212779998779297
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.421844482421875
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.024 Vali Acc: 0.635 Test Loss: 1.024 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3565492630004883
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4051532745361328
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.999 Vali Acc: 0.649 Test Loss: 0.999 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 1.5116384029388428
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5400967597961426
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.014 Vali Acc: 0.622 Test Loss: 1.014 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4552667140960693
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.019 Vali Acc: 0.622 Test Loss: 1.019 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.477820634841919
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.019 Vali Acc: 0.622 Test Loss: 1.019 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6098406314849854
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.015 Vali Acc: 0.622 Test Loss: 1.015 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3782963752746582
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4986326694488525
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.020 Vali Acc: 0.635 Test Loss: 1.020 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4495856761932373
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.018 Vali Acc: 0.635 Test Loss: 1.018 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5709941387176514
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.022 Vali Acc: 0.635 Test Loss: 1.022 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.710301399230957
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.019 Vali Acc: 0.635 Test Loss: 1.019 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 227140
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0116817951202393
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.411 Vali Acc: 0.311 Test Loss: 1.411 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.201099157333374
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.370 Vali Acc: 0.338 Test Loss: 1.370 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.2538197040557861
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 1.348865270614624
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.294 Vali Acc: 0.432 Test Loss: 1.294 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.034958839416504
Epoch: 5, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.246 Vali Acc: 0.473 Test Loss: 1.246 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.1665432453155518
Epoch: 6, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540528).  Saving model ...
Epoch: 7 cost time: 1.212829828262329
Epoch: 7, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.159 Vali Acc: 0.541 Test Loss: 1.159 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.1514816284179688
Epoch: 8, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.138 Vali Acc: 0.554 Test Loss: 1.138 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.2958436012268066
Epoch: 9, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.081 Vali Acc: 0.595 Test Loss: 1.081 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.3179636001586914
Epoch: 10, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.042 Vali Acc: 0.581 Test Loss: 1.042 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2146167755126953
Epoch: 11, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.023 Vali Acc: 0.608 Test Loss: 1.023 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.2318086624145508
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.988 Vali Acc: 0.595 Test Loss: 0.988 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1302385330200195
Epoch: 13, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.984 Vali Acc: 0.622 Test Loss: 0.984 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 14 cost time: 1.5382845401763916
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.965 Vali Acc: 0.595 Test Loss: 0.965 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4329540729522705
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3250343799591064
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.962 Vali Acc: 0.595 Test Loss: 0.962 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6479439735412598
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.946 Vali Acc: 0.622 Test Loss: 0.946 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 18 cost time: 1.2858574390411377
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.940 Vali Acc: 0.622 Test Loss: 0.940 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 19 cost time: 1.211045265197754
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.941 Vali Acc: 0.622 Test Loss: 0.941 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.045529842376709
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.946 Vali Acc: 0.622 Test Loss: 0.946 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2871427536010742
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.948 Vali Acc: 0.622 Test Loss: 0.948 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1221389770507812
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.946 Vali Acc: 0.622 Test Loss: 0.946 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3221702575683594
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.938 Vali Acc: 0.635 Test Loss: 0.938 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 24 cost time: 1.2668423652648926
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.938 Vali Acc: 0.635 Test Loss: 0.938 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.166334867477417
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.942 Vali Acc: 0.635 Test Loss: 0.942 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.195446252822876
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.942 Vali Acc: 0.649 Test Loss: 0.942 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 27 cost time: 1.0351130962371826
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.943 Vali Acc: 0.649 Test Loss: 0.943 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0799198150634766
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.939 Vali Acc: 0.635 Test Loss: 0.939 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2564451694488525
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 30 cost time: 1.3109700679779053
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.944 Vali Acc: 0.649 Test Loss: 0.944 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.221696138381958
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.948 Vali Acc: 0.649 Test Loss: 0.948 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.392261028289795
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.947 Vali Acc: 0.649 Test Loss: 0.947 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3783459663391113
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.947 Vali Acc: 0.649 Test Loss: 0.947 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3524997234344482
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.950 Vali Acc: 0.649 Test Loss: 0.950 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.125763177871704
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.951 Vali Acc: 0.649 Test Loss: 0.951 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2308573722839355
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.951 Vali Acc: 0.635 Test Loss: 0.951 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.352372646331787
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.950 Vali Acc: 0.649 Test Loss: 0.950 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.264402151107788
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.952 Vali Acc: 0.635 Test Loss: 0.952 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.6018881797790527
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.954 Vali Acc: 0.635 Test Loss: 0.954 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 225092
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2419939041137695
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.326 Vali Acc: 0.351 Test Loss: 1.326 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.3447988033294678
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.315 Vali Acc: 0.351 Test Loss: 1.315 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.4393718242645264
Epoch: 3, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.281 Vali Acc: 0.432 Test Loss: 1.281 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.6305723190307617
Epoch: 4, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.256 Vali Acc: 0.473 Test Loss: 1.256 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.274076223373413
Epoch: 5, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.2886059284210205
Epoch: 6, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.2201313972473145
Epoch: 7, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.152 Vali Acc: 0.568 Test Loss: 1.152 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 1.615079641342163
Epoch: 8, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.348198413848877
Epoch: 9, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.4989285469055176
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.063 Vali Acc: 0.581 Test Loss: 1.063 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.208380937576294
Epoch: 11, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.044 Vali Acc: 0.581 Test Loss: 1.044 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 1.3060500621795654
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 1.5860164165496826
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 1.5967397689819336
Epoch: 14, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.007 Vali Acc: 0.608 Test Loss: 1.007 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 1.1845824718475342
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 1.3369355201721191
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.004 Vali Acc: 0.635 Test Loss: 1.004 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 1.3626701831817627
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.002 Vali Acc: 0.608 Test Loss: 1.002 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.378213882446289
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.999 Vali Acc: 0.635 Test Loss: 0.999 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 19 cost time: 1.188746452331543
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.996 Vali Acc: 0.635 Test Loss: 0.996 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 20 cost time: 1.257568359375
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.998 Vali Acc: 0.635 Test Loss: 0.998 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.554718255996704
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.999 Vali Acc: 0.649 Test Loss: 0.999 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 22 cost time: 1.3955416679382324
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.999 Vali Acc: 0.635 Test Loss: 0.999 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2597284317016602
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.003 Vali Acc: 0.649 Test Loss: 1.003 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2856359481811523
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.007 Vali Acc: 0.649 Test Loss: 1.007 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2037827968597412
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.007 Vali Acc: 0.649 Test Loss: 1.007 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3498632907867432
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.008 Vali Acc: 0.649 Test Loss: 1.008 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5831530094146729
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.011 Vali Acc: 0.649 Test Loss: 1.011 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4578139781951904
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.012 Vali Acc: 0.649 Test Loss: 1.012 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3652608394622803
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.013 Vali Acc: 0.649 Test Loss: 1.013 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.250365972518921
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.013 Vali Acc: 0.649 Test Loss: 1.013 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3420345783233643
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.016 Vali Acc: 0.649 Test Loss: 1.016 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 224068
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.188582181930542
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.475 Vali Acc: 0.230 Test Loss: 1.475 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.8105099201202393
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.439 Vali Acc: 0.230 Test Loss: 1.439 Test Acc: 0.230
Validation loss decreased (-0.229715 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 0.9007160663604736
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.389 Vali Acc: 0.284 Test Loss: 1.389 Test Acc: 0.284
Validation loss decreased (-0.229715 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.0048534870147705
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.338 Vali Acc: 0.324 Test Loss: 1.338 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 0.8919525146484375
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.304 Vali Acc: 0.324 Test Loss: 1.304 Test Acc: 0.324
Validation loss decreased (-0.324311 --> -0.324311).  Saving model ...
Epoch: 6 cost time: 0.9578120708465576
Epoch: 6, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.268 Vali Acc: 0.405 Test Loss: 1.268 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 0.8939409255981445
Epoch: 7, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.929126501083374
Epoch: 8, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 0.8598361015319824
Epoch: 9, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.137 Vali Acc: 0.541 Test Loss: 1.137 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.8674540519714355
Epoch: 10, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.087 Vali Acc: 0.514 Test Loss: 1.087 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9807496070861816
Epoch: 11, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 1.114227533340454
Epoch: 12, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 0.9081645011901855
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.015 Vali Acc: 0.554 Test Loss: 1.015 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.901179313659668
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.007 Vali Acc: 0.595 Test Loss: 1.007 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 15 cost time: 0.8558847904205322
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 16 cost time: 0.9259958267211914
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.990 Vali Acc: 0.595 Test Loss: 0.990 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 17 cost time: 0.9645648002624512
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.985 Vali Acc: 0.581 Test Loss: 0.985 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9032955169677734
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.993 Vali Acc: 0.622 Test Loss: 0.993 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621612).  Saving model ...
Epoch: 19 cost time: 0.8709573745727539
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.988 Vali Acc: 0.608 Test Loss: 0.988 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.878058910369873
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.983 Vali Acc: 0.622 Test Loss: 0.983 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 21 cost time: 0.7386589050292969
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 22 cost time: 0.8989536762237549
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.981 Vali Acc: 0.649 Test Loss: 0.981 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 23 cost time: 0.8027429580688477
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.981 Vali Acc: 0.649 Test Loss: 0.981 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9607946872711182
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.979 Vali Acc: 0.649 Test Loss: 0.979 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 25 cost time: 0.8970377445220947
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.982 Vali Acc: 0.649 Test Loss: 0.982 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8596796989440918
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.985 Vali Acc: 0.649 Test Loss: 0.985 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8508486747741699
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.987 Vali Acc: 0.649 Test Loss: 0.987 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9044256210327148
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.984 Vali Acc: 0.649 Test Loss: 0.984 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.941373348236084
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.986 Vali Acc: 0.649 Test Loss: 0.986 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9265563488006592
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.988 Vali Acc: 0.635 Test Loss: 0.988 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9342138767242432
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.991 Vali Acc: 0.622 Test Loss: 0.991 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7726726531982422
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0226011276245117
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8243060111999512
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.993 Vali Acc: 0.649 Test Loss: 0.993 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 223044
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.050049066543579
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.006714105606079
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.405 Vali Acc: 0.230 Test Loss: 1.405 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.873471736907959
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.370 Vali Acc: 0.284 Test Loss: 1.370 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.0263729095458984
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.315 Vali Acc: 0.365 Test Loss: 1.315 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.9214041233062744
Epoch: 5, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.259 Vali Acc: 0.459 Test Loss: 1.259 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.9316036701202393
Epoch: 6, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.207 Vali Acc: 0.473 Test Loss: 1.207 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 0.819920539855957
Epoch: 7, Steps: 10 | Train Loss: 0.644 Vali Loss: 1.153 Vali Acc: 0.486 Test Loss: 1.153 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.9429690837860107
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 0.8290061950683594
Epoch: 9, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.023 Vali Acc: 0.568 Test Loss: 1.023 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.8883130550384521
Epoch: 10, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.980 Vali Acc: 0.608 Test Loss: 0.980 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 0.965017557144165
Epoch: 11, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.985 Vali Acc: 0.635 Test Loss: 0.985 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 0.9417884349822998
Epoch: 12, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.935 Vali Acc: 0.622 Test Loss: 0.935 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8622522354125977
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.941 Vali Acc: 0.635 Test Loss: 0.941 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 14 cost time: 0.8241257667541504
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.965 Vali Acc: 0.635 Test Loss: 0.965 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9117655754089355
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.962 Vali Acc: 0.635 Test Loss: 0.962 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.991387128829956
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.951 Vali Acc: 0.649 Test Loss: 0.951 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 17 cost time: 0.8467092514038086
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.951 Vali Acc: 0.649 Test Loss: 0.951 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9728667736053467
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.964 Vali Acc: 0.649 Test Loss: 0.964 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0853068828582764
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.974 Vali Acc: 0.649 Test Loss: 0.974 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0349407196044922
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.983 Vali Acc: 0.649 Test Loss: 0.983 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9597601890563965
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.984 Vali Acc: 0.649 Test Loss: 0.984 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8366234302520752
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.991 Vali Acc: 0.649 Test Loss: 0.991 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0634877681732178
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.995 Vali Acc: 0.649 Test Loss: 0.995 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7608785629272461
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.000 Vali Acc: 0.649 Test Loss: 1.000 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8369400501251221
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.006 Vali Acc: 0.649 Test Loss: 1.006 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8495464324951172
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.013 Vali Acc: 0.649 Test Loss: 1.013 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 222276
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.820624828338623
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.442 Vali Acc: 0.176 Test Loss: 1.442 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 3.1482765674591064
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
Validation loss decreased (-0.175661 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 2.8966619968414307
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 3.6409828662872314
Epoch: 4, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.345 Vali Acc: 0.351 Test Loss: 1.345 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 2.8141708374023438
Epoch: 5, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.318 Vali Acc: 0.378 Test Loss: 1.318 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 2.717134475708008
Epoch: 6, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.267 Vali Acc: 0.446 Test Loss: 1.267 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 2.8000376224517822
Epoch: 7, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 3.1666929721832275
Epoch: 8, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 3.0604658126831055
Epoch: 9, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.097524881362915
Epoch: 10, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.151 Vali Acc: 0.541 Test Loss: 1.151 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 2.691289186477661
Epoch: 11, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 3.081435441970825
Epoch: 12, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 2.7855594158172607
Epoch: 13, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5631134510040283
Epoch: 14, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 2.968144416809082
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.833913803100586
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6587953567504883
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5520737171173096
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.072 Vali Acc: 0.568 Test Loss: 1.072 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.412343740463257
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.071 Vali Acc: 0.568 Test Loss: 1.071 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.002899169921875
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.078 Vali Acc: 0.568 Test Loss: 1.078 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.5284931659698486
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8440780639648438
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.675112724304199
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.8882486820220947
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.078 Vali Acc: 0.568 Test Loss: 1.078 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 234652
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.307867527008057
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.356 Vali Acc: 0.297 Test Loss: 1.356 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 2.676274299621582
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.356 Vali Acc: 0.378 Test Loss: 1.356 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 2.8175392150878906
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.323 Vali Acc: 0.338 Test Loss: 1.323 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8918981552124023
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.5114595890045166
Epoch: 5, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.286 Vali Acc: 0.405 Test Loss: 1.286 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.669999599456787
Epoch: 6, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 2.911984920501709
Epoch: 7, Steps: 10 | Train Loss: 0.816 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 2.672322988510132
Epoch: 8, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 3.339069366455078
Epoch: 9, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 2.8408398628234863
Epoch: 10, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.126 Vali Acc: 0.527 Test Loss: 1.126 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.797154426574707
Epoch: 11, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8744726181030273
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.023618221282959
Epoch: 13, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 2.232349395751953
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 2.8731508255004883
Epoch: 15, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9249720573425293
Epoch: 16, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 2.8622984886169434
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.017 Vali Acc: 0.554 Test Loss: 1.017 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.123148202896118
Epoch: 18, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.023 Vali Acc: 0.554 Test Loss: 1.023 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0775363445281982
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.417975902557373
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.017 Vali Acc: 0.568 Test Loss: 1.017 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3938887119293213
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.307960271835327
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.018 Vali Acc: 0.581 Test Loss: 1.018 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5021893978118896
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.4213695526123047
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.016 Vali Acc: 0.595 Test Loss: 1.016 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.002661228179932
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.016 Vali Acc: 0.595 Test Loss: 1.016 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.0071675777435303
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.018 Vali Acc: 0.608 Test Loss: 1.018 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 27 cost time: 2.927987575531006
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2125015258789062
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.020 Vali Acc: 0.595 Test Loss: 1.020 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.02534818649292
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.027 Vali Acc: 0.595 Test Loss: 1.027 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1853535175323486
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.759962320327759
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.027 Vali Acc: 0.608 Test Loss: 1.027 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.466376781463623
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 33 cost time: 3.624661922454834
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2994818687438965
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.031 Vali Acc: 0.608 Test Loss: 1.031 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.3315305709838867
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.29270601272583
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.040 Vali Acc: 0.608 Test Loss: 1.040 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.37835431098938
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.791518449783325
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.037 Vali Acc: 0.608 Test Loss: 1.037 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.616590976715088
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.666151523590088
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.6903772354125977
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.433910846710205
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.045 Vali Acc: 0.595 Test Loss: 1.045 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 232092
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8387019634246826
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.463 Vali Acc: 0.162 Test Loss: 1.463 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 2.4620468616485596
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.447 Vali Acc: 0.216 Test Loss: 1.447 Test Acc: 0.216
Validation loss decreased (-0.162148 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 2.2963380813598633
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 2.1188161373138428
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.372 Vali Acc: 0.270 Test Loss: 1.372 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270257).  Saving model ...
Epoch: 5 cost time: 2.2108609676361084
Epoch: 5, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.322 Vali Acc: 0.378 Test Loss: 1.322 Test Acc: 0.378
Validation loss decreased (-0.270257 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 2.8485093116760254
Epoch: 6, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.267 Vali Acc: 0.446 Test Loss: 1.267 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 2.368516683578491
Epoch: 7, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.260 Vali Acc: 0.446 Test Loss: 1.260 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 2.3972818851470947
Epoch: 8, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.206 Vali Acc: 0.486 Test Loss: 1.206 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 2.481377601623535
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 2.572258472442627
Epoch: 10, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.056112289428711
Epoch: 11, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 2.506897211074829
Epoch: 12, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.094 Vali Acc: 0.581 Test Loss: 1.094 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 2.6292009353637695
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.059 Vali Acc: 0.541 Test Loss: 1.059 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0511422157287598
Epoch: 14, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.837804079055786
Epoch: 15, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.469403028488159
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 2.252797842025757
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.021 Vali Acc: 0.581 Test Loss: 1.021 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.775259256362915
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.031 Vali Acc: 0.595 Test Loss: 1.031 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 19 cost time: 2.797408103942871
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.032 Vali Acc: 0.554 Test Loss: 1.032 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3011457920074463
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4386022090911865
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 22 cost time: 2.4118340015411377
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4167518615722656
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.023 Vali Acc: 0.581 Test Loss: 1.023 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2487294673919678
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.011 Vali Acc: 0.581 Test Loss: 1.011 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3765835762023926
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.8441250324249268
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.017 Vali Acc: 0.581 Test Loss: 1.017 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8180410861968994
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2108922004699707
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.025 Vali Acc: 0.581 Test Loss: 1.025 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9216113090515137
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9435131549835205
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.020 Vali Acc: 0.581 Test Loss: 1.020 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9698636531829834
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 229532
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6127190589904785
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.962601661682129
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.372 Vali Acc: 0.270 Test Loss: 1.372 Test Acc: 0.270
Validation loss decreased (-0.229716 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 1.6691956520080566
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.343 Vali Acc: 0.365 Test Loss: 1.343 Test Acc: 0.365
Validation loss decreased (-0.270257 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.641063928604126
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.310 Vali Acc: 0.365 Test Loss: 1.310 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.45235276222229
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.296 Vali Acc: 0.419 Test Loss: 1.296 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.5963106155395508
Epoch: 6, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.258 Vali Acc: 0.419 Test Loss: 1.258 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 2.0637569427490234
Epoch: 7, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.261 Vali Acc: 0.473 Test Loss: 1.261 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.8446571826934814
Epoch: 8, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.216 Vali Acc: 0.527 Test Loss: 1.216 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.850325107574463
Epoch: 9, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.190 Vali Acc: 0.473 Test Loss: 1.190 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.562049388885498
Epoch: 10, Steps: 10 | Train Loss: 0.509 Vali Loss: 1.177 Vali Acc: 0.541 Test Loss: 1.177 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 2.076876163482666
Epoch: 11, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.0381784439086914
Epoch: 12, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1359481811523438
Epoch: 13, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.129 Vali Acc: 0.568 Test Loss: 1.129 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2007436752319336
Epoch: 14, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 1.8822226524353027
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.004378318786621
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.023378610610962
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.096 Vali Acc: 0.595 Test Loss: 1.096 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 18 cost time: 2.083493709564209
Epoch: 18, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 19 cost time: 1.93355131149292
Epoch: 19, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8335020542144775
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.088 Vali Acc: 0.581 Test Loss: 1.088 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8678367137908936
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.321645736694336
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.920032024383545
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.706407070159912
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9694912433624268
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6096117496490479
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.094 Vali Acc: 0.581 Test Loss: 1.094 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.581373929977417
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9696321487426758
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.104 Vali Acc: 0.581 Test Loss: 1.104 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 226972
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0359129905700684
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.416 Vali Acc: 0.324 Test Loss: 1.416 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.0989882946014404
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.409 Vali Acc: 0.216 Test Loss: 1.409 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.432267189025879
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.393 Vali Acc: 0.297 Test Loss: 1.393 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3486638069152832
Epoch: 4, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.349 Vali Acc: 0.324 Test Loss: 1.349 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.3079619407653809
Epoch: 5, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.290 Vali Acc: 0.378 Test Loss: 1.290 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.230473279953003
Epoch: 6, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.270 Vali Acc: 0.392 Test Loss: 1.270 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.0903291702270508
Epoch: 7, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.211 Vali Acc: 0.419 Test Loss: 1.211 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418907).  Saving model ...
Epoch: 8 cost time: 1.0846502780914307
Epoch: 8, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
Validation loss decreased (-0.418907 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.3248918056488037
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.1282479763031006
Epoch: 10, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.2768502235412598
Epoch: 11, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0337660312652588
Epoch: 12, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.060 Vali Acc: 0.581 Test Loss: 1.060 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.2508900165557861
Epoch: 13, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 1.2374589443206787
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.055 Vali Acc: 0.608 Test Loss: 1.055 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 1.3468422889709473
Epoch: 15, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.019 Vali Acc: 0.622 Test Loss: 1.019 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 16 cost time: 1.2383449077606201
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 1.274524450302124
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.031 Vali Acc: 0.635 Test Loss: 1.031 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.465430736541748
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.026 Vali Acc: 0.635 Test Loss: 1.026 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3231663703918457
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.015 Vali Acc: 0.649 Test Loss: 1.015 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 20 cost time: 1.6068992614746094
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.013 Vali Acc: 0.649 Test Loss: 1.013 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 21 cost time: 1.1594741344451904
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.017 Vali Acc: 0.649 Test Loss: 1.017 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0490450859069824
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.022 Vali Acc: 0.635 Test Loss: 1.022 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1090106964111328
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.014 Vali Acc: 0.649 Test Loss: 1.014 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2835884094238281
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.019 Vali Acc: 0.662 Test Loss: 1.019 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 25 cost time: 1.3227806091308594
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.020 Vali Acc: 0.649 Test Loss: 1.020 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2428183555603027
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.017 Vali Acc: 0.649 Test Loss: 1.017 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3923652172088623
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3499884605407715
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.017 Vali Acc: 0.662 Test Loss: 1.017 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 29 cost time: 1.3374342918395996
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.023 Vali Acc: 0.649 Test Loss: 1.023 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3600950241088867
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.028 Vali Acc: 0.649 Test Loss: 1.028 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3002498149871826
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.030 Vali Acc: 0.649 Test Loss: 1.030 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6019532680511475
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.033 Vali Acc: 0.649 Test Loss: 1.033 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.387965202331543
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.032 Vali Acc: 0.649 Test Loss: 1.032 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.344843864440918
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.034 Vali Acc: 0.649 Test Loss: 1.034 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2557671070098877
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.033 Vali Acc: 0.649 Test Loss: 1.033 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2991282939910889
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.038 Vali Acc: 0.649 Test Loss: 1.038 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3189120292663574
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.042 Vali Acc: 0.649 Test Loss: 1.042 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.428591012954712
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.043 Vali Acc: 0.649 Test Loss: 1.043 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 224924
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9585750102996826
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.386 Vali Acc: 0.311 Test Loss: 1.386 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0944445133209229
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.407 Vali Acc: 0.270 Test Loss: 1.407 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3008263111114502
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.384 Vali Acc: 0.297 Test Loss: 1.384 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.167189598083496
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.329 Vali Acc: 0.297 Test Loss: 1.329 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2295162677764893
Epoch: 5, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.284 Vali Acc: 0.365 Test Loss: 1.284 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 1.0100464820861816
Epoch: 6, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.264 Vali Acc: 0.405 Test Loss: 1.264 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 1.0362625122070312
Epoch: 7, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.208 Vali Acc: 0.432 Test Loss: 1.208 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 1.0243992805480957
Epoch: 8, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.191 Vali Acc: 0.459 Test Loss: 1.191 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 9 cost time: 1.0855960845947266
Epoch: 9, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.0260913372039795
Epoch: 10, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2525699138641357
Epoch: 11, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.125 Vali Acc: 0.541 Test Loss: 1.125 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 1.0312738418579102
Epoch: 12, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.115471363067627
Epoch: 13, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0326886177062988
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 1.171741247177124
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.076 Vali Acc: 0.608 Test Loss: 1.076 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 16 cost time: 0.9991307258605957
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2245776653289795
Epoch: 17, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 18 cost time: 1.1320557594299316
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 19 cost time: 0.9968736171722412
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.061 Vali Acc: 0.635 Test Loss: 1.061 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 20 cost time: 1.0039010047912598
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0981004238128662
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.077 Vali Acc: 0.622 Test Loss: 1.077 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9760444164276123
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.068 Vali Acc: 0.622 Test Loss: 1.068 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1189613342285156
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.073 Vali Acc: 0.622 Test Loss: 1.073 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0636532306671143
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.072 Vali Acc: 0.622 Test Loss: 1.072 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1866626739501953
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.077 Vali Acc: 0.622 Test Loss: 1.077 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2648284435272217
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.082 Vali Acc: 0.622 Test Loss: 1.082 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1172435283660889
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.084 Vali Acc: 0.622 Test Loss: 1.084 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.264209508895874
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.087 Vali Acc: 0.622 Test Loss: 1.087 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0276615619659424
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.091 Vali Acc: 0.622 Test Loss: 1.091 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 223900
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0664873123168945
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0720999240875244
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.410 Vali Acc: 0.216 Test Loss: 1.410 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0187971591949463
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.372 Vali Acc: 0.284 Test Loss: 1.372 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 0.8933978080749512
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.350 Vali Acc: 0.378 Test Loss: 1.350 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.8162369728088379
Epoch: 5, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.318 Vali Acc: 0.459 Test Loss: 1.318 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459446).  Saving model ...
Epoch: 6 cost time: 0.8578872680664062
Epoch: 6, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.286 Vali Acc: 0.419 Test Loss: 1.286 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9301812648773193
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.262 Vali Acc: 0.419 Test Loss: 1.262 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1928751468658447
Epoch: 8, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 0.9175364971160889
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.8359568119049072
Epoch: 10, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.172 Vali Acc: 0.541 Test Loss: 1.172 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 0.9912729263305664
Epoch: 11, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 0.73561692237854
Epoch: 12, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 0.9627234935760498
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9253091812133789
Epoch: 14, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.107 Vali Acc: 0.581 Test Loss: 1.107 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 1.1643719673156738
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 1.029752492904663
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.096 Vali Acc: 0.608 Test Loss: 1.096 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 17 cost time: 0.8992507457733154
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.102 Vali Acc: 0.595 Test Loss: 1.102 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1030826568603516
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.083 Vali Acc: 0.608 Test Loss: 1.083 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 19 cost time: 0.8694803714752197
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.793997049331665
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.086 Vali Acc: 0.595 Test Loss: 1.086 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8572936058044434
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9430224895477295
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.103 Vali Acc: 0.581 Test Loss: 1.103 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8090734481811523
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.103 Vali Acc: 0.581 Test Loss: 1.103 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8843693733215332
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1038992404937744
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0880954265594482
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.103 Vali Acc: 0.595 Test Loss: 1.103 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9529635906219482
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0688037872314453
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.113 Vali Acc: 0.595 Test Loss: 1.113 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 222876
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1556196212768555
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.392 Vali Acc: 0.284 Test Loss: 1.392 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7266032695770264
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.727745532989502
Epoch: 3, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.331 Vali Acc: 0.365 Test Loss: 1.331 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.8764424324035645
Epoch: 4, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.293 Vali Acc: 0.446 Test Loss: 1.293 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.7823753356933594
Epoch: 5, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.249 Vali Acc: 0.459 Test Loss: 1.249 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.7839739322662354
Epoch: 6, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.8155770301818848
Epoch: 7, Steps: 10 | Train Loss: 0.632 Vali Loss: 1.134 Vali Acc: 0.554 Test Loss: 1.134 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.8051273822784424
Epoch: 8, Steps: 10 | Train Loss: 0.482 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.7873520851135254
Epoch: 9, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 0.787029504776001
Epoch: 10, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6671459674835205
Epoch: 11, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.012 Vali Acc: 0.608 Test Loss: 1.012 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 0.6496250629425049
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 0.7799921035766602
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.990 Vali Acc: 0.595 Test Loss: 0.990 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0299184322357178
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.987 Vali Acc: 0.581 Test Loss: 0.987 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0140047073364258
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.982 Vali Acc: 0.608 Test Loss: 0.982 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 16 cost time: 0.7167813777923584
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.984 Vali Acc: 0.622 Test Loss: 0.984 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 17 cost time: 0.7380380630493164
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.985 Vali Acc: 0.622 Test Loss: 0.985 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9300107955932617
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.997 Vali Acc: 0.622 Test Loss: 0.997 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8250439167022705
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8470559120178223
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.008 Vali Acc: 0.635 Test Loss: 1.008 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 21 cost time: 0.8293139934539795
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.014 Vali Acc: 0.635 Test Loss: 1.014 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.874500036239624
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.020 Vali Acc: 0.622 Test Loss: 1.020 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8836736679077148
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.022 Vali Acc: 0.622 Test Loss: 1.022 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7202131748199463
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.029 Vali Acc: 0.635 Test Loss: 1.029 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8283290863037109
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.036 Vali Acc: 0.635 Test Loss: 1.036 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7534191608428955
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.041 Vali Acc: 0.635 Test Loss: 1.041 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6892406940460205
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.045 Vali Acc: 0.635 Test Loss: 1.045 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8653481006622314
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.051 Vali Acc: 0.635 Test Loss: 1.051 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8568155765533447
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.058 Vali Acc: 0.635 Test Loss: 1.058 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8466041088104248
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.066 Vali Acc: 0.635 Test Loss: 1.066 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 222108
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.6180877685546875
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.403 Vali Acc: 0.351 Test Loss: 1.403 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 2.9666671752929688
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.409 Vali Acc: 0.365 Test Loss: 1.409 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 2.611231565475464
Epoch: 3, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.363 Vali Acc: 0.365 Test Loss: 1.363 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 2.9229753017425537
Epoch: 4, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.340 Vali Acc: 0.378 Test Loss: 1.340 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 2.622203826904297
Epoch: 5, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.307 Vali Acc: 0.392 Test Loss: 1.307 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 2.856475353240967
Epoch: 6, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 2.706526279449463
Epoch: 7, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.232 Vali Acc: 0.446 Test Loss: 1.232 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8642797470092773
Epoch: 8, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 2.917959451675415
Epoch: 9, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 2.761733055114746
Epoch: 10, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.140 Vali Acc: 0.581 Test Loss: 1.140 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 2.5048556327819824
Epoch: 11, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.337096929550171
Epoch: 12, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.086 Vali Acc: 0.554 Test Loss: 1.086 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6119883060455322
Epoch: 13, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.056 Vali Acc: 0.608 Test Loss: 1.056 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 2.6467368602752686
Epoch: 14, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.055 Vali Acc: 0.608 Test Loss: 1.055 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 2.814713716506958
Epoch: 15, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0476253032684326
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.041 Vali Acc: 0.595 Test Loss: 1.041 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.19417405128479
Epoch: 17, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.311985492706299
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8686273097991943
Epoch: 19, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.045 Vali Acc: 0.595 Test Loss: 1.045 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3811769485473633
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.987370491027832
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.049 Vali Acc: 0.581 Test Loss: 1.049 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6054699420928955
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.053 Vali Acc: 0.568 Test Loss: 1.053 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.815978765487671
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6321167945861816
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 234568
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.270407438278198
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.436 Vali Acc: 0.216 Test Loss: 1.436 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 2.3422703742980957
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.407 Vali Acc: 0.311 Test Loss: 1.407 Test Acc: 0.311
Validation loss decreased (-0.216202 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.504794120788574
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 2.3498716354370117
Epoch: 4, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.329 Vali Acc: 0.338 Test Loss: 1.329 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 2.69301176071167
Epoch: 5, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.301 Vali Acc: 0.405 Test Loss: 1.301 Test Acc: 0.405
Validation loss decreased (-0.337825 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 3.3975322246551514
Epoch: 6, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.244 Vali Acc: 0.432 Test Loss: 1.244 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.8329617977142334
Epoch: 7, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.199 Vali Acc: 0.459 Test Loss: 1.199 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 3.3263697624206543
Epoch: 8, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.151 Vali Acc: 0.568 Test Loss: 1.151 Test Acc: 0.568
Validation loss decreased (-0.459447 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 2.8577139377593994
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8780908584594727
Epoch: 10, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.081 Vali Acc: 0.595 Test Loss: 1.081 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 3.357103109359741
Epoch: 11, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 2.929936170578003
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 2.88265061378479
Epoch: 13, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8508713245391846
Epoch: 14, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.990 Vali Acc: 0.635 Test Loss: 0.990 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 2.8739356994628906
Epoch: 15, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.991 Vali Acc: 0.649 Test Loss: 0.991 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 2.93208384513855
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.969 Vali Acc: 0.662 Test Loss: 0.969 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 17 cost time: 3.5139198303222656
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.971 Vali Acc: 0.662 Test Loss: 0.971 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7575464248657227
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.961 Vali Acc: 0.662 Test Loss: 0.961 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662153).  Saving model ...
Epoch: 19 cost time: 2.644012928009033
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.958 Vali Acc: 0.676 Test Loss: 0.958 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 20 cost time: 3.1617565155029297
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.953 Vali Acc: 0.662 Test Loss: 0.953 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.883409261703491
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.958 Vali Acc: 0.676 Test Loss: 0.958 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 22 cost time: 2.5254204273223877
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.969 Vali Acc: 0.662 Test Loss: 0.969 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6974234580993652
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.963 Vali Acc: 0.662 Test Loss: 0.963 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.712529420852661
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.952 Vali Acc: 0.676 Test Loss: 0.952 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 25 cost time: 2.6802279949188232
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.956 Vali Acc: 0.676 Test Loss: 0.956 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5213429927825928
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.950 Vali Acc: 0.649 Test Loss: 0.950 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.541926145553589
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.956 Vali Acc: 0.649 Test Loss: 0.956 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.757852554321289
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.956 Vali Acc: 0.649 Test Loss: 0.956 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.719392776489258
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.954 Vali Acc: 0.662 Test Loss: 0.954 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.45849347114563
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.955 Vali Acc: 0.662 Test Loss: 0.955 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.680814266204834
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.961 Vali Acc: 0.649 Test Loss: 0.961 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.6013224124908447
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.962 Vali Acc: 0.649 Test Loss: 0.962 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.3143787384033203
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.965 Vali Acc: 0.649 Test Loss: 0.965 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.094912528991699
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.964 Vali Acc: 0.649 Test Loss: 0.964 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 232008
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.169825792312622
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.438 Vali Acc: 0.230 Test Loss: 1.438 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.807422399520874
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.380 Vali Acc: 0.270 Test Loss: 1.380 Test Acc: 0.270
Validation loss decreased (-0.229715 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 2.082157611846924
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.353 Vali Acc: 0.351 Test Loss: 1.353 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.8462483882904053
Epoch: 4, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.8782048225402832
Epoch: 5, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.285 Vali Acc: 0.419 Test Loss: 1.285 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 2.089231491088867
Epoch: 6, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.259 Vali Acc: 0.419 Test Loss: 1.259 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 2.1438493728637695
Epoch: 7, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.220 Vali Acc: 0.459 Test Loss: 1.220 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 2.3268184661865234
Epoch: 8, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.203 Vali Acc: 0.473 Test Loss: 1.203 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 2.30301570892334
Epoch: 9, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.121 Vali Acc: 0.486 Test Loss: 1.121 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 2.294893264770508
Epoch: 10, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.007443428039551
Epoch: 11, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.067 Vali Acc: 0.527 Test Loss: 1.067 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 2.1970174312591553
Epoch: 12, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.096 Vali Acc: 0.514 Test Loss: 1.096 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4062249660491943
Epoch: 13, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9301142692565918
Epoch: 14, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.018 Vali Acc: 0.541 Test Loss: 1.018 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 15 cost time: 2.406586170196533
Epoch: 15, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.037 Vali Acc: 0.486 Test Loss: 1.037 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8877665996551514
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.007 Vali Acc: 0.514 Test Loss: 1.007 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2730278968811035
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.998 Vali Acc: 0.554 Test Loss: 0.998 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 18 cost time: 1.9411869049072266
Epoch: 18, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.010 Vali Acc: 0.527 Test Loss: 1.010 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.143311023712158
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.005 Vali Acc: 0.554 Test Loss: 1.005 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0390779972076416
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 2.0248758792877197
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.998 Vali Acc: 0.581 Test Loss: 0.998 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7258899211883545
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.998 Vali Acc: 0.568 Test Loss: 0.998 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1920008659362793
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.993 Vali Acc: 0.554 Test Loss: 0.993 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9681873321533203
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 25 cost time: 1.8597509860992432
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7590348720550537
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
Validation loss decreased (-0.594585 --> -0.635125).  Saving model ...
Epoch: 27 cost time: 1.975752592086792
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.994 Vali Acc: 0.622 Test Loss: 0.994 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.157998561859131
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.003 Vali Acc: 0.608 Test Loss: 1.003 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1508872509002686
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8848998546600342
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.0291154384613037
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0737497806549072
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.009 Vali Acc: 0.635 Test Loss: 1.009 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9329068660736084
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.012 Vali Acc: 0.635 Test Loss: 1.012 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8793590068817139
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.016 Vali Acc: 0.622 Test Loss: 1.016 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.8011863231658936
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.014 Vali Acc: 0.622 Test Loss: 1.014 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9106011390686035
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.018 Vali Acc: 0.635 Test Loss: 1.018 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 229448
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6135950088500977
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.8192083835601807
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.384 Vali Acc: 0.230 Test Loss: 1.384 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2728371620178223
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.364 Vali Acc: 0.284 Test Loss: 1.364 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 2.1769795417785645
Epoch: 4, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.315 Vali Acc: 0.351 Test Loss: 1.315 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 2.3450710773468018
Epoch: 5, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.299 Vali Acc: 0.365 Test Loss: 1.299 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 1.9888536930084229
Epoch: 6, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.244 Vali Acc: 0.432 Test Loss: 1.244 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.858149766921997
Epoch: 7, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 2.1456401348114014
Epoch: 8, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.193 Vali Acc: 0.568 Test Loss: 1.193 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 2.217456579208374
Epoch: 9, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.169 Vali Acc: 0.568 Test Loss: 1.169 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.562922716140747
Epoch: 10, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.137 Vali Acc: 0.608 Test Loss: 1.137 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 1.6528537273406982
Epoch: 11, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.105 Vali Acc: 0.622 Test Loss: 1.105 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 1.5977580547332764
Epoch: 12, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.082 Vali Acc: 0.622 Test Loss: 1.082 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 1.8730638027191162
Epoch: 13, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.084 Vali Acc: 0.622 Test Loss: 1.084 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.506176233291626
Epoch: 14, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 15 cost time: 1.554511547088623
Epoch: 15, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 16 cost time: 2.26771879196167
Epoch: 16, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9040405750274658
Epoch: 17, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.256404161453247
Epoch: 18, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.040318727493286
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8310391902923584
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.998 Vali Acc: 0.595 Test Loss: 0.998 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0087668895721436
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.079153060913086
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7805705070495605
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.999 Vali Acc: 0.608 Test Loss: 0.999 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8546929359436035
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.008 Vali Acc: 0.608 Test Loss: 1.008 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9041802883148193
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.013 Vali Acc: 0.581 Test Loss: 1.013 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 226888
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.07951545715332
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.364 Vali Acc: 0.351 Test Loss: 1.364 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.4316484928131104
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.366 Vali Acc: 0.324 Test Loss: 1.366 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4388771057128906
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.333 Vali Acc: 0.338 Test Loss: 1.333 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6610169410705566
Epoch: 4, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.312 Vali Acc: 0.419 Test Loss: 1.312 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.3303015232086182
Epoch: 5, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.259 Vali Acc: 0.446 Test Loss: 1.259 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.30930757522583
Epoch: 6, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.234 Vali Acc: 0.473 Test Loss: 1.234 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.3013334274291992
Epoch: 7, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.246 Vali Acc: 0.432 Test Loss: 1.246 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3736894130706787
Epoch: 8, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.3089752197265625
Epoch: 9, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4005985260009766
Epoch: 10, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.150 Vali Acc: 0.473 Test Loss: 1.150 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2293059825897217
Epoch: 11, Steps: 10 | Train Loss: 0.483 Vali Loss: 1.107 Vali Acc: 0.527 Test Loss: 1.107 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 1.5949342250823975
Epoch: 12, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5540969371795654
Epoch: 13, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.081 Vali Acc: 0.514 Test Loss: 1.081 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1920368671417236
Epoch: 14, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.066 Vali Acc: 0.527 Test Loss: 1.066 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 1.408510684967041
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.081 Vali Acc: 0.486 Test Loss: 1.081 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3304085731506348
Epoch: 16, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 17 cost time: 1.2411816120147705
Epoch: 17, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.339449167251587
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1365196704864502
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4238154888153076
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.263641119003296
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 22 cost time: 1.4090015888214111
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.069 Vali Acc: 0.554 Test Loss: 1.069 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2444679737091064
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.074 Vali Acc: 0.568 Test Loss: 1.074 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 24 cost time: 1.3924121856689453
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3234434127807617
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.076 Vali Acc: 0.541 Test Loss: 1.076 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.249047040939331
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.080 Vali Acc: 0.541 Test Loss: 1.080 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.384821891784668
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2922286987304688
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4526431560516357
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.082 Vali Acc: 0.541 Test Loss: 1.082 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5980064868927002
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8101134300231934
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8304955959320068
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6198360919952393
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 224840
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7723515033721924
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.391 Vali Acc: 0.311 Test Loss: 1.391 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8542094230651855
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.0986883640289307
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.320 Vali Acc: 0.365 Test Loss: 1.320 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.9654941558837891
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.0689315795898438
Epoch: 5, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.248 Vali Acc: 0.514 Test Loss: 1.248 Test Acc: 0.514
Validation loss decreased (-0.418906 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.0510730743408203
Epoch: 6, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9426844120025635
Epoch: 7, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1017429828643799
Epoch: 8, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.2567648887634277
Epoch: 9, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1119334697723389
Epoch: 10, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.053 Vali Acc: 0.595 Test Loss: 1.053 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 1.0542387962341309
Epoch: 11, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.026 Vali Acc: 0.554 Test Loss: 1.026 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0643222332000732
Epoch: 12, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.991 Vali Acc: 0.595 Test Loss: 0.991 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 13 cost time: 1.0413720607757568
Epoch: 13, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.986 Vali Acc: 0.581 Test Loss: 0.986 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.042083740234375
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.962 Vali Acc: 0.595 Test Loss: 0.962 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 15 cost time: 1.1717653274536133
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.959 Vali Acc: 0.595 Test Loss: 0.959 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 16 cost time: 0.9881772994995117
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.963 Vali Acc: 0.581 Test Loss: 0.963 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9747612476348877
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.952 Vali Acc: 0.595 Test Loss: 0.952 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 18 cost time: 0.902703046798706
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.943 Vali Acc: 0.581 Test Loss: 0.943 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9437520503997803
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.948 Vali Acc: 0.568 Test Loss: 0.948 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9084084033966064
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.952 Vali Acc: 0.581 Test Loss: 0.952 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9493861198425293
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.951 Vali Acc: 0.581 Test Loss: 0.951 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0501034259796143
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.952 Vali Acc: 0.608 Test Loss: 0.952 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 23 cost time: 1.027170181274414
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.953 Vali Acc: 0.608 Test Loss: 0.953 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8412449359893799
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.953 Vali Acc: 0.581 Test Loss: 0.953 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3111615180969238
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.953 Vali Acc: 0.622 Test Loss: 0.953 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 26 cost time: 1.0461516380310059
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.961 Vali Acc: 0.595 Test Loss: 0.961 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.279327630996704
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.966 Vali Acc: 0.595 Test Loss: 0.966 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1985955238342285
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.967 Vali Acc: 0.595 Test Loss: 0.967 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9350752830505371
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.967 Vali Acc: 0.608 Test Loss: 0.967 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3127806186676025
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.967 Vali Acc: 0.608 Test Loss: 0.967 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0652141571044922
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.974 Vali Acc: 0.608 Test Loss: 0.974 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2160680294036865
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.978 Vali Acc: 0.622 Test Loss: 0.978 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.183194875717163
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.979 Vali Acc: 0.622 Test Loss: 0.979 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.474416971206665
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.978 Vali Acc: 0.608 Test Loss: 0.978 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.231351613998413
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.978 Vali Acc: 0.635 Test Loss: 0.978 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 36 cost time: 1.2963628768920898
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1610112190246582
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3759193420410156
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.992 Vali Acc: 0.622 Test Loss: 0.992 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0724432468414307
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.994 Vali Acc: 0.622 Test Loss: 0.994 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3847415447235107
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.622 Test Loss: 0.996 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2045550346374512
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.635 Test Loss: 0.996 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2881710529327393
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.998 Vali Acc: 0.635 Test Loss: 0.998 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0211234092712402
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.000 Vali Acc: 0.635 Test Loss: 1.000 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2738003730773926
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.002 Vali Acc: 0.635 Test Loss: 1.002 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0902903079986572
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.635 Test Loss: 1.004 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 223816
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5846199989318848
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.414 Vali Acc: 0.257 Test Loss: 1.414 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.816091775894165
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.425 Vali Acc: 0.230 Test Loss: 1.425 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8460466861724854
Epoch: 3, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.391 Vali Acc: 0.297 Test Loss: 1.391 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297283).  Saving model ...
Epoch: 4 cost time: 0.7996838092803955
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.317 Vali Acc: 0.392 Test Loss: 1.317 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.9047248363494873
Epoch: 5, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.265 Vali Acc: 0.432 Test Loss: 1.265 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.061201572418213
Epoch: 6, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.8068118095397949
Epoch: 7, Steps: 10 | Train Loss: 0.723 Vali Loss: 1.230 Vali Acc: 0.459 Test Loss: 1.230 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8257789611816406
Epoch: 8, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.117 Vali Acc: 0.486 Test Loss: 1.117 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1289520263671875
Epoch: 9, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.0162527561187744
Epoch: 10, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.087 Vali Acc: 0.568 Test Loss: 1.087 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.808070182800293
Epoch: 11, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.044 Vali Acc: 0.554 Test Loss: 1.044 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0339250564575195
Epoch: 12, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.025 Vali Acc: 0.608 Test Loss: 1.025 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 1.1269090175628662
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 14 cost time: 1.07354736328125
Epoch: 14, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.996 Vali Acc: 0.622 Test Loss: 0.996 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 15 cost time: 0.8188674449920654
Epoch: 15, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0180375576019287
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9846043586730957
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.002 Vali Acc: 0.635 Test Loss: 1.002 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 18 cost time: 0.9562890529632568
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.756723165512085
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8261394500732422
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.017 Vali Acc: 0.608 Test Loss: 1.017 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9529514312744141
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.018 Vali Acc: 0.622 Test Loss: 1.018 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9245917797088623
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0175995826721191
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.018 Vali Acc: 0.622 Test Loss: 1.018 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9610393047332764
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.021 Vali Acc: 0.622 Test Loss: 1.021 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.223233938217163
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.020 Vali Acc: 0.622 Test Loss: 1.020 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9974770545959473
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.028 Vali Acc: 0.622 Test Loss: 1.028 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.987619161605835
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 222792
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9462201595306396
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.065619707107544
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.358 Vali Acc: 0.270 Test Loss: 1.358 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 1.0189249515533447
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.305 Vali Acc: 0.378 Test Loss: 1.305 Test Acc: 0.378
Validation loss decreased (-0.270257 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.976381778717041
Epoch: 4, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.294 Vali Acc: 0.365 Test Loss: 1.294 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.903721809387207
Epoch: 5, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.263 Vali Acc: 0.432 Test Loss: 1.263 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.8206250667572021
Epoch: 6, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9705815315246582
Epoch: 7, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0022120475769043
Epoch: 8, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.154 Vali Acc: 0.581 Test Loss: 1.154 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.3204197883605957
Epoch: 9, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 0.9513258934020996
Epoch: 10, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 0.9770863056182861
Epoch: 11, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.0680639743804932
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.041 Vali Acc: 0.595 Test Loss: 1.041 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8753042221069336
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.038 Vali Acc: 0.568 Test Loss: 1.038 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8380811214447021
Epoch: 14, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 15 cost time: 1.2150378227233887
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.996 Vali Acc: 0.622 Test Loss: 0.996 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 0.972761869430542
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.990 Vali Acc: 0.622 Test Loss: 0.990 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 17 cost time: 0.98417067527771
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.996 Vali Acc: 0.622 Test Loss: 0.996 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7004327774047852
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.002 Vali Acc: 0.608 Test Loss: 1.002 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.022165060043335
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.955829381942749
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.002 Vali Acc: 0.622 Test Loss: 1.002 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9018459320068359
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8466269969940186
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.998 Vali Acc: 0.608 Test Loss: 0.998 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0040628910064697
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8607325553894043
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.010 Vali Acc: 0.622 Test Loss: 1.010 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9723513126373291
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.010 Vali Acc: 0.622 Test Loss: 1.010 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8689606189727783
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.012 Vali Acc: 0.635 Test Loss: 1.012 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 27 cost time: 1.0625848770141602
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.013 Vali Acc: 0.608 Test Loss: 1.013 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0887796878814697
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.019 Vali Acc: 0.608 Test Loss: 1.019 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.969994068145752
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.020 Vali Acc: 0.608 Test Loss: 1.020 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9104328155517578
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.023 Vali Acc: 0.608 Test Loss: 1.023 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2066478729248047
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.025 Vali Acc: 0.608 Test Loss: 1.025 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8024420738220215
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.027 Vali Acc: 0.608 Test Loss: 1.027 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.926668643951416
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.031 Vali Acc: 0.622 Test Loss: 1.031 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.02955961227417
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.030 Vali Acc: 0.608 Test Loss: 1.030 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.928753137588501
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0796918869018555
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.039 Vali Acc: 0.622 Test Loss: 1.039 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 222024
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.653801679611206
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.502 Vali Acc: 0.189 Test Loss: 1.502 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 3.0350468158721924
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.472 Vali Acc: 0.230 Test Loss: 1.472 Test Acc: 0.230
Validation loss decreased (-0.189174 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 2.8076634407043457
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 2.8952765464782715
Epoch: 4, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 2.971224069595337
Epoch: 5, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.317 Vali Acc: 0.311 Test Loss: 1.317 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310798).  Saving model ...
Epoch: 6 cost time: 3.2432212829589844
Epoch: 6, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.270 Vali Acc: 0.365 Test Loss: 1.270 Test Acc: 0.365
Validation loss decreased (-0.310798 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 2.9348502159118652
Epoch: 7, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.203 Vali Acc: 0.405 Test Loss: 1.203 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 8 cost time: 2.632321834564209
Epoch: 8, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 2.2972891330718994
Epoch: 9, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.112 Vali Acc: 0.459 Test Loss: 1.112 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6873204708099365
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 2.635786533355713
Epoch: 11, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.4678850173950195
Epoch: 12, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5378143787384033
Epoch: 13, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.046 Vali Acc: 0.581 Test Loss: 1.046 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 14 cost time: 2.721604824066162
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.031 Vali Acc: 0.595 Test Loss: 1.031 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 2.705592393875122
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.023 Vali Acc: 0.595 Test Loss: 1.023 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 16 cost time: 2.8461356163024902
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.015 Vali Acc: 0.595 Test Loss: 1.015 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 2.5853500366210938
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9555745124816895
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9553163051605225
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.008 Vali Acc: 0.581 Test Loss: 1.008 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9215266704559326
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.340172052383423
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.000 Vali Acc: 0.581 Test Loss: 1.000 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.744645357131958
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.996 Vali Acc: 0.595 Test Loss: 0.996 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 23 cost time: 2.7060234546661377
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 24 cost time: 2.449882984161377
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.994 Vali Acc: 0.608 Test Loss: 0.994 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 25 cost time: 2.673330068588257
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.819711446762085
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.995 Vali Acc: 0.608 Test Loss: 0.995 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.212468385696411
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.993 Vali Acc: 0.581 Test Loss: 0.993 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.852374792098999
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.988 Vali Acc: 0.595 Test Loss: 0.988 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6856796741485596
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.986 Vali Acc: 0.622 Test Loss: 0.986 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 30 cost time: 2.6562042236328125
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.986 Vali Acc: 0.622 Test Loss: 0.986 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.87198543548584
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.986 Vali Acc: 0.608 Test Loss: 0.986 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4287302494049072
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.985 Vali Acc: 0.608 Test Loss: 0.985 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.7880592346191406
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.985 Vali Acc: 0.608 Test Loss: 0.985 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.383829593658447
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.984 Vali Acc: 0.622 Test Loss: 0.984 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 35 cost time: 3.186018705368042
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.984 Vali Acc: 0.622 Test Loss: 0.984 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 36 cost time: 3.0817627906799316
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.984 Vali Acc: 0.622 Test Loss: 0.984 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.9003429412841797
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 38 cost time: 2.9424796104431152
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 39 cost time: 2.8618574142456055
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.199826240539551
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.983 Vali Acc: 0.635 Test Loss: 0.983 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.55157208442688
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 42 cost time: 3.7171332836151123
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 43 cost time: 3.633638620376587
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.366758108139038
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 45 cost time: 4.677563190460205
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 46 cost time: 3.2655489444732666
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.979 Vali Acc: 0.635 Test Loss: 0.979 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 47 cost time: 3.789045572280884
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.541835308074951
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.3303613662719727
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.9084346294403076
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.9931228160858154
Epoch: 51, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.984 Vali Acc: 0.635 Test Loss: 0.984 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.9859588146209717
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.984 Vali Acc: 0.635 Test Loss: 0.984 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.823139190673828
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.984 Vali Acc: 0.635 Test Loss: 0.984 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.25699520111084
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.983 Vali Acc: 0.635 Test Loss: 0.983 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.5098154544830322
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.635 Test Loss: 0.985 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.448096752166748
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.635 Test Loss: 0.985 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 234464
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.555670738220215
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.473 Vali Acc: 0.189 Test Loss: 1.473 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 2.3497116565704346
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.440 Vali Acc: 0.203 Test Loss: 1.440 Test Acc: 0.203
Validation loss decreased (-0.189174 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 2.1482133865356445
Epoch: 3, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.390 Vali Acc: 0.257 Test Loss: 1.390 Test Acc: 0.257
Validation loss decreased (-0.202688 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 2.5365965366363525
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.345 Vali Acc: 0.324 Test Loss: 1.345 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 2.5039167404174805
Epoch: 5, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.291 Vali Acc: 0.365 Test Loss: 1.291 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 2.7049877643585205
Epoch: 6, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 2.373628616333008
Epoch: 7, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.5154876708984375
Epoch: 8, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 2.3235628604888916
Epoch: 9, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.172992467880249
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7456979751586914
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.6110827922821045
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.830275535583496
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.054 Vali Acc: 0.595 Test Loss: 1.054 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 2.540637731552124
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.048 Vali Acc: 0.608 Test Loss: 1.048 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 2.0208818912506104
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 16 cost time: 2.199681520462036
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.022 Vali Acc: 0.608 Test Loss: 1.022 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.572077989578247
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.018 Vali Acc: 0.608 Test Loss: 1.018 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6693243980407715
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8695735931396484
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.63600754737854
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.009 Vali Acc: 0.595 Test Loss: 1.009 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4908642768859863
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.002 Vali Acc: 0.608 Test Loss: 1.002 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3011701107025146
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3178834915161133
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5317304134368896
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.995 Vali Acc: 0.581 Test Loss: 0.995 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.900022268295288
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w40_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 231904
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7430713176727295
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.410 Vali Acc: 0.257 Test Loss: 1.410 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.8287599086761475
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.357 Vali Acc: 0.311 Test Loss: 1.357 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.040513277053833
Epoch: 3, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.322 Vali Acc: 0.338 Test Loss: 1.322 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 2.006740093231201
Epoch: 4, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.284 Vali Acc: 0.392 Test Loss: 1.284 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 2.12184739112854
Epoch: 5, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.238 Vali Acc: 0.432 Test Loss: 1.238 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.0468389987945557
Epoch: 6, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 2.1666529178619385
Epoch: 7, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 2.1779158115386963
Epoch: 8, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 2.1699273586273193
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 2.2705721855163574
Epoch: 10, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4119985103607178
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.329955577850342
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2090437412261963
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.024 Vali Acc: 0.568 Test Loss: 1.024 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 2.5005195140838623
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.021 Vali Acc: 0.554 Test Loss: 1.021 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9399898052215576
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8577804565429688
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.012 Vali Acc: 0.554 Test Loss: 1.012 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.354445219039917
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.013 Vali Acc: 0.568 Test Loss: 1.013 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 18 cost time: 2.44421124458313
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 19 cost time: 2.0804250240325928
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.009 Vali Acc: 0.595 Test Loss: 1.009 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 20 cost time: 2.0257437229156494
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.183485746383667
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3590469360351562
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.001 Vali Acc: 0.581 Test Loss: 1.001 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3806540966033936
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7042386531829834
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.000 Vali Acc: 0.581 Test Loss: 1.000 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.311358690261841
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.999 Vali Acc: 0.608 Test Loss: 0.999 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 26 cost time: 2.1372246742248535
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.001 Vali Acc: 0.581 Test Loss: 1.001 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9063830375671387
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.998 Vali Acc: 0.608 Test Loss: 0.998 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 28 cost time: 1.9565303325653076
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1653811931610107
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2004408836364746
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.002 Vali Acc: 0.595 Test Loss: 1.002 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.505984306335449
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9417626857757568
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.8512516021728516
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.6816298961639404
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.2632830142974854
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.001 Vali Acc: 0.608 Test Loss: 1.001 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.8999128341674805
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.2360782623291016
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.001 Vali Acc: 0.581 Test Loss: 1.001 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w30_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 229344
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5014290809631348
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.5863540172576904
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.4318740367889404
Epoch: 3, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.345 Vali Acc: 0.378 Test Loss: 1.345 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.458613634109497
Epoch: 4, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.290 Vali Acc: 0.405 Test Loss: 1.290 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.6111102104187012
Epoch: 5, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.648386001586914
Epoch: 6, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.450664758682251
Epoch: 7, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.4557247161865234
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.7748055458068848
Epoch: 9, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 1.698007345199585
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.998 Vali Acc: 0.649 Test Loss: 0.998 Test Acc: 0.649
Validation loss decreased (-0.608098 --> -0.648639).  Saving model ...
Epoch: 11 cost time: 1.4165120124816895
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.983 Vali Acc: 0.635 Test Loss: 0.983 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7076449394226074
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.961 Vali Acc: 0.635 Test Loss: 0.961 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.489081621170044
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.949 Vali Acc: 0.635 Test Loss: 0.949 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5300121307373047
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.940 Vali Acc: 0.662 Test Loss: 0.940 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 15 cost time: 1.3037569522857666
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.933 Vali Acc: 0.649 Test Loss: 0.933 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8295464515686035
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.927 Vali Acc: 0.662 Test Loss: 0.927 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 17 cost time: 1.4743554592132568
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.922 Vali Acc: 0.662 Test Loss: 0.922 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 18 cost time: 1.6492609977722168
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.920 Vali Acc: 0.676 Test Loss: 0.920 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 19 cost time: 1.4685444831848145
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.916 Vali Acc: 0.662 Test Loss: 0.916 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3855876922607422
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.913 Vali Acc: 0.662 Test Loss: 0.913 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.556445837020874
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.910 Vali Acc: 0.662 Test Loss: 0.910 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5716571807861328
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.909 Vali Acc: 0.662 Test Loss: 0.909 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.503537893295288
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.906 Vali Acc: 0.662 Test Loss: 0.906 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4304893016815186
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.905 Vali Acc: 0.662 Test Loss: 0.905 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4802367687225342
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.903 Vali Acc: 0.662 Test Loss: 0.903 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5140917301177979
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.902 Vali Acc: 0.662 Test Loss: 0.902 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5475099086761475
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.899 Vali Acc: 0.662 Test Loss: 0.899 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5413448810577393
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.899 Vali Acc: 0.662 Test Loss: 0.899 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w20_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 226784
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.532114267349243
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.433 Vali Acc: 0.203 Test Loss: 1.433 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.3500006198883057
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
Validation loss decreased (-0.202688 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.7619125843048096
Epoch: 3, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.364 Vali Acc: 0.257 Test Loss: 1.364 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 1.5843229293823242
Epoch: 4, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.305 Vali Acc: 0.324 Test Loss: 1.305 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.338932991027832
Epoch: 5, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.251 Vali Acc: 0.392 Test Loss: 1.251 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.212587594985962
Epoch: 6, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.201 Vali Acc: 0.446 Test Loss: 1.201 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 1.4831123352050781
Epoch: 7, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.832719326019287
Epoch: 8, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.469245433807373
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.062 Vali Acc: 0.541 Test Loss: 1.062 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.562483549118042
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.024 Vali Acc: 0.568 Test Loss: 1.024 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 1.594770908355713
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 1.7876667976379395
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.991 Vali Acc: 0.595 Test Loss: 0.991 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 13 cost time: 1.5660979747772217
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.980 Vali Acc: 0.608 Test Loss: 0.980 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 1.2721805572509766
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.972 Vali Acc: 0.622 Test Loss: 0.972 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 15 cost time: 1.350435733795166
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.965 Vali Acc: 0.622 Test Loss: 0.965 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 1.566988229751587
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.956 Vali Acc: 0.635 Test Loss: 0.956 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 17 cost time: 1.739591121673584
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.951 Vali Acc: 0.649 Test Loss: 0.951 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 18 cost time: 1.3600893020629883
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 19 cost time: 1.537600040435791
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.934 Vali Acc: 0.635 Test Loss: 0.934 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3379206657409668
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.932 Vali Acc: 0.649 Test Loss: 0.932 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 21 cost time: 1.3605425357818604
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.928 Vali Acc: 0.662 Test Loss: 0.928 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 22 cost time: 1.4761059284210205
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3204503059387207
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.919 Vali Acc: 0.662 Test Loss: 0.919 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 24 cost time: 1.4762485027313232
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.916 Vali Acc: 0.662 Test Loss: 0.916 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 25 cost time: 1.573843002319336
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.914 Vali Acc: 0.662 Test Loss: 0.914 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 26 cost time: 1.6349446773529053
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.912 Vali Acc: 0.662 Test Loss: 0.912 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 27 cost time: 1.5277705192565918
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.909 Vali Acc: 0.662 Test Loss: 0.909 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 28 cost time: 1.3734056949615479
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.907 Vali Acc: 0.662 Test Loss: 0.907 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 29 cost time: 1.3351566791534424
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.905 Vali Acc: 0.662 Test Loss: 0.905 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 30 cost time: 1.4610779285430908
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.662 Test Loss: 0.904 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 31 cost time: 1.5366630554199219
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.903 Vali Acc: 0.662 Test Loss: 0.903 Test Acc: 0.662
Validation loss decreased (-0.662153 --> -0.662153).  Saving model ...
Epoch: 32 cost time: 1.5833916664123535
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.903 Vali Acc: 0.649 Test Loss: 0.903 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5309169292449951
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.901 Vali Acc: 0.649 Test Loss: 0.901 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4262807369232178
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.898 Vali Acc: 0.649 Test Loss: 0.898 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5274271965026855
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.897 Vali Acc: 0.649 Test Loss: 0.897 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.368422031402588
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.895 Vali Acc: 0.649 Test Loss: 0.895 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6820435523986816
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.649 Test Loss: 0.893 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2450673580169678
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.649 Test Loss: 0.893 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7283706665039062
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.649 Test Loss: 0.893 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5399575233459473
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.892 Vali Acc: 0.649 Test Loss: 0.892 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6562926769256592
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.649 Test Loss: 0.889 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w12_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 224736
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2756307125091553
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.458 Vali Acc: 0.149 Test Loss: 1.458 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 1.0712969303131104
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.435 Vali Acc: 0.270 Test Loss: 1.435 Test Acc: 0.270
Validation loss decreased (-0.148634 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 0.8922762870788574
Epoch: 3, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.395 Vali Acc: 0.324 Test Loss: 1.395 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.013580560684204
Epoch: 4, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.346 Vali Acc: 0.324 Test Loss: 1.346 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 0.9816107749938965
Epoch: 5, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.301 Vali Acc: 0.351 Test Loss: 1.301 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.1201493740081787
Epoch: 6, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.267 Vali Acc: 0.392 Test Loss: 1.267 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 0.8771877288818359
Epoch: 7, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.209 Vali Acc: 0.446 Test Loss: 1.209 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.8560552597045898
Epoch: 8, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.193 Vali Acc: 0.405 Test Loss: 1.193 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9928300380706787
Epoch: 9, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.174 Vali Acc: 0.459 Test Loss: 1.174 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 10 cost time: 1.0038442611694336
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.145 Vali Acc: 0.473 Test Loss: 1.145 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472962).  Saving model ...
Epoch: 11 cost time: 1.0018341541290283
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
Validation loss decreased (-0.472962 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 1.2326021194458008
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9823780059814453
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9986350536346436
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0597147941589355
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9964139461517334
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.111 Vali Acc: 0.514 Test Loss: 1.111 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8440794944763184
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 18 cost time: 0.9260995388031006
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 19 cost time: 1.0631520748138428
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3916337490081787
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.005875825881958
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 22 cost time: 0.9320931434631348
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 23 cost time: 1.0956778526306152
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1619000434875488
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 25 cost time: 1.08160400390625
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 26 cost time: 1.1715264320373535
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 27 cost time: 1.084665060043335
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3470709323883057
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 29 cost time: 1.0661232471466064
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.180788278579712
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0307636260986328
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3155715465545654
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1088573932647705
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.145519733428955
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9512741565704346
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.951685905456543
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 37 cost time: 1.1630682945251465
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.107452154159546
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 39 cost time: 0.9194445610046387
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0434730052947998
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1450743675231934
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1770703792572021
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2595889568328857
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2028560638427734
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.104 Vali Acc: 0.568 Test Loss: 1.104 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3461599349975586
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.14359450340271
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.3737058639526367
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0722949504852295
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w8_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 223712
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.347278594970703
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.405 Vali Acc: 0.297 Test Loss: 1.405 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.8210933208465576
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.382 Vali Acc: 0.311 Test Loss: 1.382 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.8416931629180908
Epoch: 3, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.348 Vali Acc: 0.351 Test Loss: 1.348 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7352590560913086
Epoch: 4, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.325 Vali Acc: 0.405 Test Loss: 1.325 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.6850254535675049
Epoch: 5, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.254 Vali Acc: 0.432 Test Loss: 1.254 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.8114662170410156
Epoch: 6, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.216 Vali Acc: 0.459 Test Loss: 1.216 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.8448708057403564
Epoch: 7, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.183 Vali Acc: 0.446 Test Loss: 1.183 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8606147766113281
Epoch: 8, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.7136032581329346
Epoch: 9, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 0.8216559886932373
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8650789260864258
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8623316287994385
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8517017364501953
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8948004245758057
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7770142555236816
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8249771595001221
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8343331813812256
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 18 cost time: 0.712338924407959
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 0.7498989105224609
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 20 cost time: 0.9382979869842529
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9858508110046387
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 22 cost time: 0.8679955005645752
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 23 cost time: 0.874218225479126
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8639042377471924
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.060 Vali Acc: 0.581 Test Loss: 1.060 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 25 cost time: 1.0744681358337402
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.059 Vali Acc: 0.581 Test Loss: 1.059 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 26 cost time: 0.9485962390899658
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 27 cost time: 0.9350264072418213
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 28 cost time: 0.9217195510864258
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8305566310882568
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.000504970550537
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 31 cost time: 0.888338565826416
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 32 cost time: 0.9418385028839111
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.057 Vali Acc: 0.595 Test Loss: 1.057 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 33 cost time: 0.9588279724121094
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0043561458587646
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9722776412963867
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0183720588684082
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0173063278198242
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6921067237854004
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.881866455078125
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0452001094818115
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0193264484405518
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9931392669677734
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 222688
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.036987781524658
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9929704666137695
Epoch: 2, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.368 Vali Acc: 0.257 Test Loss: 1.368 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.0787396430969238
Epoch: 3, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.322 Vali Acc: 0.365 Test Loss: 1.322 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.9760029315948486
Epoch: 4, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.261 Vali Acc: 0.419 Test Loss: 1.261 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.7122905254364014
Epoch: 5, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.047905445098877
Epoch: 6, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.8083581924438477
Epoch: 7, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.144 Vali Acc: 0.473 Test Loss: 1.144 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9596400260925293
Epoch: 8, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8598453998565674
Epoch: 9, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.065 Vali Acc: 0.486 Test Loss: 1.065 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9438929557800293
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.840829610824585
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.067 Vali Acc: 0.527 Test Loss: 1.067 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 0.9914324283599854
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.056 Vali Acc: 0.527 Test Loss: 1.056 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 0.9118568897247314
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527017).  Saving model ...
Epoch: 14 cost time: 0.9899277687072754
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
Validation loss decreased (-0.527017 --> -0.527017).  Saving model ...
Epoch: 15 cost time: 0.9294595718383789
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.048 Vali Acc: 0.527 Test Loss: 1.048 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7063086032867432
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
Validation loss decreased (-0.527017 --> -0.527017).  Saving model ...
Epoch: 17 cost time: 0.8235189914703369
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7307693958282471
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.048 Vali Acc: 0.527 Test Loss: 1.048 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0550024509429932
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.044 Vali Acc: 0.527 Test Loss: 1.044 Test Acc: 0.527
Validation loss decreased (-0.527017 --> -0.527017).  Saving model ...
Epoch: 20 cost time: 0.9174721240997314
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.044 Vali Acc: 0.527 Test Loss: 1.044 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9657087326049805
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0392045974731445
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8271491527557373
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8417913913726807
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.044 Vali Acc: 0.527 Test Loss: 1.044 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7055528163909912
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.044 Vali Acc: 0.527 Test Loss: 1.044 Test Acc: 0.527
Validation loss decreased (-0.527017 --> -0.527017).  Saving model ...
Epoch: 26 cost time: 0.8859636783599854
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.046 Vali Acc: 0.527 Test Loss: 1.046 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7785840034484863
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.861583948135376
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7877407073974609
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.527 Test Loss: 1.046 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9115025997161865
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.514 Test Loss: 1.046 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7886228561401367
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.048 Vali Acc: 0.514 Test Loss: 1.048 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.836467981338501
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.048 Vali Acc: 0.514 Test Loss: 1.048 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7441294193267822
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.049 Vali Acc: 0.514 Test Loss: 1.049 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8917238712310791
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.049 Vali Acc: 0.514 Test Loss: 1.049 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7875151634216309
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.514 Test Loss: 1.049 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_MTSMixer_UEA_ftM_sl400_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 221920
model size : 0.85MB
