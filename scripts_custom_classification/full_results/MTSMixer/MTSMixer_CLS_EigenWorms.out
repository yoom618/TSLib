Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 62.72429609298706
Epoch: 1, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.672 Vali Acc: 0.420 Test Loss: 1.672 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 56.223904848098755
Epoch: 2, Steps: 8 | Train Loss: 0.800 Vali Loss: 1.418 Vali Acc: 0.443 Test Loss: 1.418 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442734).  Saving model ...
Epoch: 3 cost time: 57.565840005874634
Epoch: 3, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.360 Vali Acc: 0.519 Test Loss: 1.360 Test Acc: 0.519
Validation loss decreased (-0.442734 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 57.96800518035889
Epoch: 4, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.478 Vali Acc: 0.550 Test Loss: 1.478 Test Acc: 0.550
Validation loss decreased (-0.519070 --> -0.549604).  Saving model ...
Epoch: 5 cost time: 58.931045055389404
Epoch: 5, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.924 Vali Acc: 0.519 Test Loss: 1.924 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 60.19859457015991
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.899 Vali Acc: 0.504 Test Loss: 1.899 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 59.02022981643677
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.473 Test Loss: 1.857 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 58.111905097961426
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.519 Test Loss: 1.782 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 56.95089244842529
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.542 Test Loss: 1.738 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 52.21862554550171
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.542 Test Loss: 1.731 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 52.92358064651489
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.542 Test Loss: 1.736 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 58.14187145233154
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.542 Test Loss: 1.738 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 55.74273920059204
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.542 Test Loss: 1.732 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 54.4158878326416
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.542 Test Loss: 1.725 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 78842013
model size : 307.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 45.19339942932129
Epoch: 1, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.580 Vali Acc: 0.374 Test Loss: 1.580 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 44.54754614830017
Epoch: 2, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.310 Vali Acc: 0.542 Test Loss: 1.310 Test Acc: 0.542
Validation loss decreased (-0.374030 --> -0.541972).  Saving model ...
Epoch: 3 cost time: 41.80782890319824
Epoch: 3, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.289 Vali Acc: 0.557 Test Loss: 1.289 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557239).  Saving model ...
Epoch: 4 cost time: 43.69370770454407
Epoch: 4, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.671 Vali Acc: 0.557 Test Loss: 1.671 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.23514270782471
Epoch: 5, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.580 Test Loss: 1.674 Test Acc: 0.580
Validation loss decreased (-0.557239 --> -0.580136).  Saving model ...
Epoch: 6 cost time: 42.67718863487244
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.489 Test Loss: 1.520 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 45.97292637825012
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.374 Test Loss: 1.739 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 44.595123052597046
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.435 Test Loss: 1.700 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 42.47890782356262
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.489 Test Loss: 1.638 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 43.249468088150024
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.534 Test Loss: 1.631 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 45.4910192489624
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.519 Test Loss: 1.628 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 43.876643657684326
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.534 Test Loss: 1.611 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 42.832292795181274
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.534 Test Loss: 1.592 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 44.09161353111267
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.527 Test Loss: 1.576 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 45.128817558288574
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.527 Test Loss: 1.564 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 77922461
model size : 302.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.4059534072876
Epoch: 1, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.472 Vali Acc: 0.473 Test Loss: 1.472 Test Acc: 0.473
Validation loss decreased (inf --> -0.473268).  Saving model ...
Epoch: 2 cost time: 36.180296897888184
Epoch: 2, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.362 Vali Acc: 0.466 Test Loss: 1.362 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.36374831199646
Epoch: 3, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.571 Vali Acc: 0.534 Test Loss: 1.571 Test Acc: 0.534
Validation loss decreased (-0.473268 --> -0.534335).  Saving model ...
Epoch: 4 cost time: 32.834893465042114
Epoch: 4, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 36.46592617034912
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.496 Test Loss: 1.589 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 33.66956281661987
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.682 Vali Acc: 0.557 Test Loss: 1.682 Test Acc: 0.557
Validation loss decreased (-0.534335 --> -0.557235).  Saving model ...
Epoch: 7 cost time: 33.07577323913574
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.565 Test Loss: 1.803 Test Acc: 0.565
Validation loss decreased (-0.557235 --> -0.564867).  Saving model ...
Epoch: 8 cost time: 32.522666215896606
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.565 Test Loss: 1.856 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 32.4310200214386
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.565 Test Loss: 1.855 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 32.84805202484131
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.565 Test Loss: 1.838 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 33.63042378425598
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.565 Test Loss: 1.815 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 32.80433487892151
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.557 Test Loss: 1.797 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 32.09980225563049
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.550 Test Loss: 1.785 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 34.81798791885376
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.550 Test Loss: 1.782 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 30.500406742095947
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.550 Test Loss: 1.778 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 35.14148712158203
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.542 Test Loss: 1.778 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 32.91478085517883
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.550 Test Loss: 1.779 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 77000861
model size : 297.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.134551763534546
Epoch: 1, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.584 Vali Acc: 0.435 Test Loss: 1.584 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 22.137251377105713
Epoch: 2, Steps: 8 | Train Loss: 0.800 Vali Loss: 1.369 Vali Acc: 0.481 Test Loss: 1.369 Test Acc: 0.481
Validation loss decreased (-0.435099 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 19.968339443206787
Epoch: 3, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.403 Vali Acc: 0.420 Test Loss: 1.403 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.42948603630066
Epoch: 4, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.572 Vali Acc: 0.550 Test Loss: 1.572 Test Acc: 0.550
Validation loss decreased (-0.480902 --> -0.549603).  Saving model ...
Epoch: 5 cost time: 20.52017855644226
Epoch: 5, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.664 Vali Acc: 0.542 Test Loss: 1.664 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.872141122817993
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.856 Vali Acc: 0.580 Test Loss: 1.856 Test Acc: 0.580
Validation loss decreased (-0.549603 --> -0.580134).  Saving model ...
Epoch: 7 cost time: 22.88119673728943
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.542 Test Loss: 1.537 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.623162746429443
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.550 Test Loss: 1.695 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.13891339302063
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.519 Test Loss: 1.668 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.436164617538452
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.542 Test Loss: 1.594 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.60070013999939
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.534 Test Loss: 1.587 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 21.740625381469727
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.557 Test Loss: 1.597 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 19.282429933547974
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.565 Test Loss: 1.599 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.92749285697937
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.565 Test Loss: 1.599 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 21.925828218460083
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.565 Test Loss: 1.600 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 23.38523817062378
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.565 Test Loss: 1.600 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 76081309
model size : 293.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.293876886367798
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.853 Vali Acc: 0.420 Test Loss: 1.853 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 14.9971444606781
Epoch: 2, Steps: 8 | Train Loss: 0.903 Vali Loss: 1.447 Vali Acc: 0.511 Test Loss: 1.447 Test Acc: 0.511
Validation loss decreased (-0.419829 --> -0.511436).  Saving model ...
Epoch: 3 cost time: 12.813817739486694
Epoch: 3, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.882 Vali Acc: 0.496 Test Loss: 1.882 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.420350790023804
Epoch: 4, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.444 Vali Acc: 0.435 Test Loss: 1.444 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.580333709716797
Epoch: 5, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.504 Test Loss: 1.669 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.671377182006836
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.893 Vali Acc: 0.511 Test Loss: 1.893 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.178624153137207
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.511 Test Loss: 1.901 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.081159353256226
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.504 Test Loss: 1.840 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.772626161575317
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.496 Test Loss: 1.793 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.01908540725708
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.496 Test Loss: 1.776 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.237074613571167
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.496 Test Loss: 1.772 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.769446611404419
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.504 Test Loss: 1.779 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 75344029
model size : 289.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.675946474075317
Epoch: 1, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.617 Vali Acc: 0.420 Test Loss: 1.617 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 8.541772842407227
Epoch: 2, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.352 Vali Acc: 0.573 Test Loss: 1.352 Test Acc: 0.573
Validation loss decreased (-0.419831 --> -0.572506).  Saving model ...
Epoch: 3 cost time: 8.682631492614746
Epoch: 3, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.313 Vali Acc: 0.565 Test Loss: 1.313 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.386234283447266
Epoch: 4, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.484 Vali Acc: 0.557 Test Loss: 1.484 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.428297996520996
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.978 Vali Acc: 0.534 Test Loss: 1.978 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.048053503036499
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.550 Test Loss: 1.807 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.894500970840454
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.557 Test Loss: 1.606 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.595314025878906
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.565 Test Loss: 1.529 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.877824783325195
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.565 Test Loss: 1.513 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.131209135055542
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.565 Test Loss: 1.527 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.502988576889038
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.557 Test Loss: 1.553 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.3394193649292
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.557 Test Loss: 1.581 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 74975389
model size : 287.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.095393657684326
Epoch: 1, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.617 Vali Acc: 0.435 Test Loss: 1.617 Test Acc: 0.435
Validation loss decreased (inf --> -0.435098).  Saving model ...
Epoch: 2 cost time: 4.912659645080566
Epoch: 2, Steps: 8 | Train Loss: 0.671 Vali Loss: 1.434 Vali Acc: 0.351 Test Loss: 1.434 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.928797006607056
Epoch: 3, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.331 Vali Acc: 0.573 Test Loss: 1.331 Test Acc: 0.573
Validation loss decreased (-0.435098 --> -0.572506).  Saving model ...
Epoch: 4 cost time: 5.49918007850647
Epoch: 4, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.538 Vali Acc: 0.573 Test Loss: 1.538 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.933100461959839
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.588 Test Loss: 1.763 Test Acc: 0.588
Validation loss decreased (-0.572506 --> -0.587769).  Saving model ...
Epoch: 6 cost time: 4.68476939201355
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.580 Test Loss: 1.843 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.682401895523071
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.573 Test Loss: 1.856 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.8915770053863525
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.573 Test Loss: 1.841 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.616804361343384
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.557 Test Loss: 1.819 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.024472951889038
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.557 Test Loss: 1.801 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.8930511474609375
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.557 Test Loss: 1.785 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.684520483016968
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.557 Test Loss: 1.773 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.749706983566284
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.557 Test Loss: 1.761 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.42618465423584
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.573 Test Loss: 1.752 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.390553712844849
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.573 Test Loss: 1.745 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 74606749
model size : 285.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4731388092041016
Epoch: 1, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.607 Vali Acc: 0.420 Test Loss: 1.607 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5441231727600098
Epoch: 2, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.364 Vali Acc: 0.466 Test Loss: 1.364 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465635).  Saving model ...
Epoch: 3 cost time: 1.5389971733093262
Epoch: 3, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.886 Vali Acc: 0.534 Test Loss: 1.886 Test Acc: 0.534
Validation loss decreased (-0.465635 --> -0.534332).  Saving model ...
Epoch: 4 cost time: 1.5151441097259521
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.917 Vali Acc: 0.542 Test Loss: 1.917 Test Acc: 0.542
Validation loss decreased (-0.534332 --> -0.541966).  Saving model ...
Epoch: 5 cost time: 1.5477309226989746
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.550 Test Loss: 1.860 Test Acc: 0.550
Validation loss decreased (-0.541966 --> -0.549600).  Saving model ...
Epoch: 6 cost time: 1.5544631481170654
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.557 Test Loss: 1.849 Test Acc: 0.557
Validation loss decreased (-0.549600 --> -0.557233).  Saving model ...
Epoch: 7 cost time: 1.525362253189087
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.557 Test Loss: 1.859 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.449841022491455
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.557 Test Loss: 1.874 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4477252960205078
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.557 Test Loss: 1.886 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4131171703338623
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.899 Vali Acc: 0.557 Test Loss: 1.899 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3763363361358643
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.557 Test Loss: 1.909 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.402512550354004
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.557 Test Loss: 1.916 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3975214958190918
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.557 Test Loss: 1.924 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4587008953094482
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.557 Test Loss: 1.929 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3623619079589844
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.935 Vali Acc: 0.557 Test Loss: 1.935 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.395801305770874
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.557 Test Loss: 1.942 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 74240157
model size : 283.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 59.667879581451416
Epoch: 1, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.729 Vali Acc: 0.420 Test Loss: 1.729 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 54.62665319442749
Epoch: 2, Steps: 8 | Train Loss: 1.133 Vali Loss: 1.479 Vali Acc: 0.504 Test Loss: 1.479 Test Acc: 0.504
Validation loss decreased (-0.419830 --> -0.503802).  Saving model ...
Epoch: 3 cost time: 55.27508807182312
Epoch: 3, Steps: 8 | Train Loss: 0.286 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
Validation loss decreased (-0.503802 --> -0.549604).  Saving model ...
Epoch: 4 cost time: 56.84001040458679
Epoch: 4, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.589 Vali Acc: 0.557 Test Loss: 1.589 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557236).  Saving model ...
Epoch: 5 cost time: 55.47679615020752
Epoch: 5, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.538 Vali Acc: 0.511 Test Loss: 1.538 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 58.373693227767944
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.876 Vali Acc: 0.534 Test Loss: 1.876 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 53.97173190116882
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.550 Test Loss: 1.952 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 54.31897568702698
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.550 Test Loss: 1.788 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 60.59042048454285
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.550 Test Loss: 1.766 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 59.02930665016174
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.550 Test Loss: 1.807 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 59.36479830741882
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.557 Test Loss: 1.851 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 54.648409843444824
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.573 Test Loss: 1.859 Test Acc: 0.573
Validation loss decreased (-0.557236 --> -0.572500).  Saving model ...
Epoch: 13 cost time: 58.23512077331543
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.550 Test Loss: 1.865 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 52.529467821121216
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.565 Test Loss: 1.848 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 56.9586398601532
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.557 Test Loss: 1.832 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 57.68419528007507
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.557 Test Loss: 1.837 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 58.177722692489624
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.565 Test Loss: 1.844 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 57.35009574890137
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.550 Test Loss: 1.853 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 56.95266819000244
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.550 Test Loss: 1.856 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 60.43509006500244
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.550 Test Loss: 1.863 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 58.47986698150635
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.550 Test Loss: 1.855 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 58.064531564712524
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.550 Test Loss: 1.851 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 78841961
model size : 307.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 50.03812766075134
Epoch: 1, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.719 Vali Acc: 0.412 Test Loss: 1.719 Test Acc: 0.412
Validation loss decreased (inf --> -0.412197).  Saving model ...
Epoch: 2 cost time: 43.40060329437256
Epoch: 2, Steps: 8 | Train Loss: 1.062 Vali Loss: 1.526 Vali Acc: 0.458 Test Loss: 1.526 Test Acc: 0.458
Validation loss decreased (-0.412197 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 41.68076252937317
Epoch: 3, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.377 Vali Acc: 0.473 Test Loss: 1.377 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473269).  Saving model ...
Epoch: 4 cost time: 42.08657240867615
Epoch: 4, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.484 Vali Acc: 0.504 Test Loss: 1.484 Test Acc: 0.504
Validation loss decreased (-0.473269 --> -0.503802).  Saving model ...
Epoch: 5 cost time: 42.131229877471924
Epoch: 5, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.956 Vali Acc: 0.519 Test Loss: 1.956 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519064).  Saving model ...
Epoch: 6 cost time: 42.32679533958435
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.549 Vali Acc: 0.473 Test Loss: 1.549 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 43.25140190124512
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.817 Vali Acc: 0.527 Test Loss: 1.817 Test Acc: 0.527
Validation loss decreased (-0.519064 --> -0.526699).  Saving model ...
Epoch: 8 cost time: 40.88509154319763
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.527 Test Loss: 1.844 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 42.577131509780884
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.504 Test Loss: 1.768 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 41.14018535614014
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.473 Test Loss: 1.749 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 42.65627861022949
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.504 Test Loss: 1.772 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 43.75375509262085
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.504 Test Loss: 1.800 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 42.04950451850891
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.527 Test Loss: 1.816 Test Acc: 0.527
Validation loss decreased (-0.526699 --> -0.526699).  Saving model ...
Epoch: 14 cost time: 47.32172155380249
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.519 Test Loss: 1.806 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 44.64338183403015
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.511 Test Loss: 1.796 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 46.47376537322998
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.511 Test Loss: 1.791 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 47.44941449165344
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.511 Test Loss: 1.789 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 45.40741229057312
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.511 Test Loss: 1.785 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 46.722240924835205
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.519 Test Loss: 1.789 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 44.649068117141724
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.519 Test Loss: 1.796 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 45.661534547805786
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.519 Test Loss: 1.802 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 45.94948196411133
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.519 Test Loss: 1.804 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 48.44113612174988
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.519 Test Loss: 1.799 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 77922409
model size : 302.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.7441782951355
Epoch: 1, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.502 Vali Acc: 0.489 Test Loss: 1.502 Test Acc: 0.489
Validation loss decreased (inf --> -0.488535).  Saving model ...
Epoch: 2 cost time: 32.858453035354614
Epoch: 2, Steps: 8 | Train Loss: 0.789 Vali Loss: 1.463 Vali Acc: 0.496 Test Loss: 1.463 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 32.57717180252075
Epoch: 3, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.787 Vali Acc: 0.580 Test Loss: 1.787 Test Acc: 0.580
Validation loss decreased (-0.496169 --> -0.580135).  Saving model ...
Epoch: 4 cost time: 32.97348213195801
Epoch: 4, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.421 Vali Acc: 0.534 Test Loss: 1.421 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.880242109298706
Epoch: 5, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.592 Vali Acc: 0.534 Test Loss: 1.592 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 33.42340707778931
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.481 Test Loss: 1.810 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 32.17083978652954
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.450 Test Loss: 1.991 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 32.43924641609192
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.496 Test Loss: 1.894 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 30.73118543624878
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.534 Test Loss: 1.821 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 30.943928718566895
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.542 Test Loss: 1.793 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 31.04002547264099
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.542 Test Loss: 1.782 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 31.74220895767212
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.550 Test Loss: 1.776 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 36.96541786193848
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.550 Test Loss: 1.772 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 77000809
model size : 297.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.827327251434326
Epoch: 1, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.607 Vali Acc: 0.420 Test Loss: 1.607 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 20.07866930961609
Epoch: 2, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.546 Vali Acc: 0.260 Test Loss: 1.546 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.066866397857666
Epoch: 3, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.510 Vali Acc: 0.458 Test Loss: 1.510 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 22.785369873046875
Epoch: 4, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.522 Vali Acc: 0.550 Test Loss: 1.522 Test Acc: 0.550
Validation loss decreased (-0.458000 --> -0.549603).  Saving model ...
Epoch: 5 cost time: 21.436740159988403
Epoch: 5, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.561 Vali Acc: 0.542 Test Loss: 1.561 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.138122081756592
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.603 Test Loss: 1.589 Test Acc: 0.603
Validation loss decreased (-0.549603 --> -0.603038).  Saving model ...
Epoch: 7 cost time: 24.59983253479004
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.580 Test Loss: 1.579 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.8136146068573
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.573 Test Loss: 1.465 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.5378680229187
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.573 Test Loss: 1.400 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.435715198516846
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.588 Test Loss: 1.376 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.626492738723755
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.588 Test Loss: 1.395 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 21.564820051193237
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.588 Test Loss: 1.426 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 20.763656854629517
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.588 Test Loss: 1.451 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 23.411436796188354
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.588 Test Loss: 1.462 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.310091257095337
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.588 Test Loss: 1.469 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.265087842941284
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.588 Test Loss: 1.474 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 76081257
model size : 293.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.909823179244995
Epoch: 1, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.752 Vali Acc: 0.412 Test Loss: 1.752 Test Acc: 0.412
Validation loss decreased (inf --> -0.412196).  Saving model ...
Epoch: 2 cost time: 12.42819881439209
Epoch: 2, Steps: 8 | Train Loss: 0.981 Vali Loss: 1.615 Vali Acc: 0.473 Test Loss: 1.615 Test Acc: 0.473
Validation loss decreased (-0.412196 --> -0.473266).  Saving model ...
Epoch: 3 cost time: 12.074759244918823
Epoch: 3, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.377 Vali Acc: 0.519 Test Loss: 1.377 Test Acc: 0.519
Validation loss decreased (-0.473266 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 12.556272983551025
Epoch: 4, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.796 Vali Acc: 0.511 Test Loss: 1.796 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.278570413589478
Epoch: 5, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.374 Vali Acc: 0.519 Test Loss: 1.374 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 12.894543170928955
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.519 Test Loss: 1.484 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.612941026687622
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.511 Test Loss: 1.743 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.326351404190063
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.519 Test Loss: 1.818 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.686278104782104
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.519 Test Loss: 1.824 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.04610800743103
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.519 Test Loss: 1.808 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.355561017990112
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.519 Test Loss: 1.808 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.431926965713501
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.519 Test Loss: 1.818 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.421236276626587
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.519 Test Loss: 1.833 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.782691717147827
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.527 Test Loss: 1.840 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526699).  Saving model ...
Epoch: 15 cost time: 13.403932809829712
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.850 Vali Acc: 0.527 Test Loss: 1.850 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.37995719909668
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.527 Test Loss: 1.857 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.39124083518982
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.527 Test Loss: 1.858 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.795422315597534
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.527 Test Loss: 1.856 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.199954271316528
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.534 Test Loss: 1.860 Test Acc: 0.534
Validation loss decreased (-0.526699 --> -0.534333).  Saving model ...
Epoch: 20 cost time: 13.547871828079224
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.527 Test Loss: 1.871 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.100517749786377
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.527 Test Loss: 1.866 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.599918127059937
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.534 Test Loss: 1.862 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 12.824655294418335
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.527 Test Loss: 1.871 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 12.269744873046875
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.527 Test Loss: 1.880 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 13.683353662490845
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.527 Test Loss: 1.881 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 13.615382671356201
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.527 Test Loss: 1.881 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 12.61977767944336
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.527 Test Loss: 1.884 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 12.998957395553589
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.527 Test Loss: 1.894 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.696464538574219
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.527 Test Loss: 1.897 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 75343977
model size : 289.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.843033075332642
Epoch: 1, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.624 Vali Acc: 0.420 Test Loss: 1.624 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 9.706416845321655
Epoch: 2, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.290 Vali Acc: 0.496 Test Loss: 1.290 Test Acc: 0.496
Validation loss decreased (-0.419831 --> -0.496170).  Saving model ...
Epoch: 3 cost time: 9.409698009490967
Epoch: 3, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.197 Vali Acc: 0.595 Test Loss: 1.197 Test Acc: 0.595
Validation loss decreased (-0.496170 --> -0.595408).  Saving model ...
Epoch: 4 cost time: 9.66887092590332
Epoch: 4, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.246 Vali Acc: 0.565 Test Loss: 1.246 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.640479564666748
Epoch: 5, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.316 Vali Acc: 0.603 Test Loss: 1.316 Test Acc: 0.603
Validation loss decreased (-0.595408 --> -0.603040).  Saving model ...
Epoch: 6 cost time: 9.074236631393433
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.618 Test Loss: 1.360 Test Acc: 0.618
Validation loss decreased (-0.603040 --> -0.618307).  Saving model ...
Epoch: 7 cost time: 9.465512752532959
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.611 Test Loss: 1.387 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.791834831237793
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.634 Test Loss: 1.368 Test Acc: 0.634
Validation loss decreased (-0.618307 --> -0.633574).  Saving model ...
Epoch: 9 cost time: 9.907885074615479
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.634 Test Loss: 1.350 Test Acc: 0.634
Validation loss decreased (-0.633574 --> -0.633574).  Saving model ...
Epoch: 10 cost time: 9.718952655792236
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.626 Test Loss: 1.344 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.292858839035034
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.618 Test Loss: 1.345 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.90729808807373
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.626 Test Loss: 1.354 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.686167478561401
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.364 Vali Acc: 0.618 Test Loss: 1.364 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.119653940200806
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.611 Test Loss: 1.371 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.467382192611694
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.378 Vali Acc: 0.611 Test Loss: 1.378 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.399098634719849
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.611 Test Loss: 1.382 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.07416844367981
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.603 Test Loss: 1.388 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.571816205978394
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.603 Test Loss: 1.392 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.072932720184326
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.603 Test Loss: 1.395 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 74975337
model size : 287.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.768381595611572
Epoch: 1, Steps: 8 | Train Loss: 1.695 Vali Loss: 1.834 Vali Acc: 0.420 Test Loss: 1.834 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 4.770185470581055
Epoch: 2, Steps: 8 | Train Loss: 0.991 Vali Loss: 1.284 Vali Acc: 0.511 Test Loss: 1.284 Test Acc: 0.511
Validation loss decreased (-0.419829 --> -0.511438).  Saving model ...
Epoch: 3 cost time: 4.676513910293579
Epoch: 3, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.337 Vali Acc: 0.511 Test Loss: 1.337 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.9518351554870605
Epoch: 4, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.469 Vali Acc: 0.496 Test Loss: 1.469 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.40179705619812
Epoch: 5, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.681 Vali Acc: 0.580 Test Loss: 1.681 Test Acc: 0.580
Validation loss decreased (-0.511438 --> -0.580136).  Saving model ...
Epoch: 6 cost time: 4.3408496379852295
Epoch: 6, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.496 Vali Acc: 0.634 Test Loss: 1.496 Test Acc: 0.634
Validation loss decreased (-0.580136 --> -0.633573).  Saving model ...
Epoch: 7 cost time: 4.796842098236084
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.595 Test Loss: 1.491 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.507976531982422
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.573 Test Loss: 1.576 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.687906742095947
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.580 Test Loss: 1.543 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.46199893951416
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.580 Test Loss: 1.516 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.648633241653442
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.573 Test Loss: 1.506 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.513923406600952
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.580 Test Loss: 1.505 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.556744575500488
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.588 Test Loss: 1.507 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.079984426498413
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.580 Test Loss: 1.511 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.203216552734375
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.580 Test Loss: 1.517 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.210419654846191
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.580 Test Loss: 1.520 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 74606697
model size : 285.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2231597900390625
Epoch: 1, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.608 Vali Acc: 0.397 Test Loss: 1.608 Test Acc: 0.397
Validation loss decreased (inf --> -0.396930).  Saving model ...
Epoch: 2 cost time: 1.3935492038726807
Epoch: 2, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.432 Vali Acc: 0.496 Test Loss: 1.432 Test Acc: 0.496
Validation loss decreased (-0.396930 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 1.4736146926879883
Epoch: 3, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.758 Vali Acc: 0.504 Test Loss: 1.758 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503799).  Saving model ...
Epoch: 4 cost time: 1.4525654315948486
Epoch: 4, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.496 Test Loss: 1.862 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4367256164550781
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.240 Vali Acc: 0.527 Test Loss: 2.240 Test Acc: 0.527
Validation loss decreased (-0.503799 --> -0.526695).  Saving model ...
Epoch: 6 cost time: 1.526026725769043
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.336 Vali Acc: 0.527 Test Loss: 2.336 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5147104263305664
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.325 Vali Acc: 0.519 Test Loss: 2.325 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5118815898895264
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.298 Vali Acc: 0.504 Test Loss: 2.298 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5375778675079346
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.289 Vali Acc: 0.496 Test Loss: 2.289 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5368266105651855
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.290 Vali Acc: 0.496 Test Loss: 2.290 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4867610931396484
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.496 Test Loss: 2.296 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.480100154876709
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.496 Test Loss: 2.303 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3872849941253662
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.312 Vali Acc: 0.496 Test Loss: 2.312 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4453365802764893
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.316 Vali Acc: 0.496 Test Loss: 2.316 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4151325225830078
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.496 Test Loss: 2.319 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 74240105
model size : 283.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 55.524863719940186
Epoch: 1, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.701 Vali Acc: 0.420 Test Loss: 1.701 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 51.9965181350708
Epoch: 2, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.300 Vali Acc: 0.511 Test Loss: 1.300 Test Acc: 0.511
Validation loss decreased (-0.419830 --> -0.511437).  Saving model ...
Epoch: 3 cost time: 53.43255662918091
Epoch: 3, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.080 Vali Acc: 0.519 Test Loss: 2.080 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519063).  Saving model ...
Epoch: 4 cost time: 53.32553243637085
Epoch: 4, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.412 Vali Acc: 0.519 Test Loss: 2.412 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 52.22181534767151
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.524 Vali Acc: 0.519 Test Loss: 2.524 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 51.065991163253784
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.559 Vali Acc: 0.519 Test Loss: 2.559 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 52.304336071014404
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.581 Vali Acc: 0.519 Test Loss: 2.581 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 51.303730487823486
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.589 Vali Acc: 0.519 Test Loss: 2.589 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 51.917694091796875
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.587 Vali Acc: 0.519 Test Loss: 2.587 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 51.85655164718628
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.573 Vali Acc: 0.519 Test Loss: 2.573 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 49.46987509727478
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.561 Vali Acc: 0.519 Test Loss: 2.561 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 54.24406433105469
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.519 Test Loss: 2.549 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 54.14347219467163
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.535 Vali Acc: 0.519 Test Loss: 2.535 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 78841897
model size : 307.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 47.836549520492554
Epoch: 1, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.662 Vali Acc: 0.420 Test Loss: 1.662 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 42.114983320236206
Epoch: 2, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
Validation loss decreased (-0.419831 --> -0.526704).  Saving model ...
Epoch: 3 cost time: 44.60184335708618
Epoch: 3, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.637 Vali Acc: 0.527 Test Loss: 1.637 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 42.75348877906799
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.527 Test Loss: 1.832 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 40.39873290061951
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.527 Test Loss: 1.980 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 41.67963624000549
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.077 Vali Acc: 0.527 Test Loss: 2.077 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 41.13919019699097
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.527 Test Loss: 2.132 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 42.68795824050903
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.527 Test Loss: 2.165 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 38.623135805130005
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.185 Vali Acc: 0.527 Test Loss: 2.185 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 40.130537271499634
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.202 Vali Acc: 0.527 Test Loss: 2.202 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 41.857452392578125
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.214 Vali Acc: 0.527 Test Loss: 2.214 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 40.579808473587036
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.527 Test Loss: 2.225 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 77922345
model size : 302.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.218892097473145
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.515 Vali Acc: 0.435 Test Loss: 1.515 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 30.29751420021057
Epoch: 2, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.329 Vali Acc: 0.534 Test Loss: 1.329 Test Acc: 0.534
Validation loss decreased (-0.435099 --> -0.534338).  Saving model ...
Epoch: 3 cost time: 31.509928941726685
Epoch: 3, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.764 Vali Acc: 0.527 Test Loss: 1.764 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.32658839225769
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.861 Vali Acc: 0.511 Test Loss: 1.861 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.50359010696411
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.074 Vali Acc: 0.473 Test Loss: 2.074 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.1409695148468
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.209 Vali Acc: 0.473 Test Loss: 2.209 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.276710271835327
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.473 Test Loss: 2.271 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 31.499524116516113
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.292 Vali Acc: 0.489 Test Loss: 2.292 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 32.331512689590454
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.496 Test Loss: 2.303 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 31.673816919326782
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.310 Vali Acc: 0.504 Test Loss: 2.310 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 26.94084405899048
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.312 Vali Acc: 0.496 Test Loss: 2.312 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 31.685885906219482
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.312 Vali Acc: 0.511 Test Loss: 2.312 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 77000745
model size : 297.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.754997730255127
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.598 Vali Acc: 0.420 Test Loss: 1.598 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 20.34761357307434
Epoch: 2, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.296 Vali Acc: 0.519 Test Loss: 1.296 Test Acc: 0.519
Validation loss decreased (-0.419831 --> -0.519071).  Saving model ...
Epoch: 3 cost time: 20.706089973449707
Epoch: 3, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.126 Vali Acc: 0.519 Test Loss: 2.126 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.86682629585266
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.328 Vali Acc: 0.519 Test Loss: 2.328 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.93746829032898
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.519 Test Loss: 2.447 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 20.2167387008667
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.511 Vali Acc: 0.519 Test Loss: 2.511 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.89865756034851
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.547 Vali Acc: 0.519 Test Loss: 2.547 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.225876569747925
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.567 Vali Acc: 0.519 Test Loss: 2.567 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 20.906447887420654
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.578 Vali Acc: 0.519 Test Loss: 2.578 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 24.20976209640503
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.586 Vali Acc: 0.519 Test Loss: 2.586 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 20.19398045539856
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.590 Vali Acc: 0.519 Test Loss: 2.590 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 21.01040744781494
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.592 Vali Acc: 0.519 Test Loss: 2.592 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 76081193
model size : 293.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.12294054031372
Epoch: 1, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.669 Vali Acc: 0.420 Test Loss: 1.669 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 11.79776644706726
Epoch: 2, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.405 Vali Acc: 0.466 Test Loss: 1.405 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465635).  Saving model ...
Epoch: 3 cost time: 11.201210021972656
Epoch: 3, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.316 Vali Acc: 0.519 Test Loss: 2.316 Test Acc: 0.519
Validation loss decreased (-0.465635 --> -0.519061).  Saving model ...
Epoch: 4 cost time: 12.649495124816895
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.843 Vali Acc: 0.519 Test Loss: 2.843 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.122268438339233
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.079 Vali Acc: 0.519 Test Loss: 3.079 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.435107231140137
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.165 Vali Acc: 0.519 Test Loss: 3.165 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.852036476135254
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.519 Test Loss: 3.189 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.624238967895508
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.519 Test Loss: 3.189 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.965608835220337
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.180 Vali Acc: 0.519 Test Loss: 3.180 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.551848888397217
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.519 Test Loss: 3.166 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.066369771957397
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.151 Vali Acc: 0.519 Test Loss: 3.151 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.933292150497437
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.137 Vali Acc: 0.519 Test Loss: 3.137 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.759958982467651
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.123 Vali Acc: 0.519 Test Loss: 3.123 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 75343913
model size : 289.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.880496501922607
Epoch: 1, Steps: 8 | Train Loss: 1.630 Vali Loss: 1.701 Vali Acc: 0.420 Test Loss: 1.701 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 8.143930912017822
Epoch: 2, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.323 Vali Acc: 0.489 Test Loss: 1.323 Test Acc: 0.489
Validation loss decreased (-0.419830 --> -0.488536).  Saving model ...
Epoch: 3 cost time: 9.628735780715942
Epoch: 3, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.680 Vali Acc: 0.519 Test Loss: 1.680 Test Acc: 0.519
Validation loss decreased (-0.488536 --> -0.519067).  Saving model ...
Epoch: 4 cost time: 8.478145122528076
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.574 Vali Acc: 0.519 Test Loss: 2.574 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.544219255447388
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.519 Test Loss: 3.029 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.885900974273682
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.210 Vali Acc: 0.519 Test Loss: 3.210 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.717193603515625
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.255 Vali Acc: 0.519 Test Loss: 3.255 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.732797384262085
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.251 Vali Acc: 0.519 Test Loss: 3.251 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.656543016433716
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.225 Vali Acc: 0.519 Test Loss: 3.225 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.021929264068604
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.193 Vali Acc: 0.519 Test Loss: 3.193 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.814657211303711
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.519 Test Loss: 3.166 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.363147497177124
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.136 Vali Acc: 0.519 Test Loss: 3.136 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.690650463104248
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.110 Vali Acc: 0.519 Test Loss: 3.110 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 74975273
model size : 287.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.229187250137329
Epoch: 1, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.685 Vali Acc: 0.420 Test Loss: 1.685 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 4.744328022003174
Epoch: 2, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.438 Vali Acc: 0.412 Test Loss: 1.438 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.703970670700073
Epoch: 3, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.221 Vali Acc: 0.519 Test Loss: 2.221 Test Acc: 0.519
Validation loss decreased (-0.419830 --> -0.519062).  Saving model ...
Epoch: 4 cost time: 4.897337436676025
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.088 Vali Acc: 0.519 Test Loss: 3.088 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.3132734298706055
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.563 Vali Acc: 0.519 Test Loss: 3.563 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.730736494064331
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.777 Vali Acc: 0.519 Test Loss: 3.777 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.0737409591674805
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.849 Vali Acc: 0.519 Test Loss: 3.849 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.669146299362183
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.857 Vali Acc: 0.519 Test Loss: 3.857 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.533710241317749
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.843 Vali Acc: 0.519 Test Loss: 3.843 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.4510338306427
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.821 Vali Acc: 0.519 Test Loss: 3.821 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.136402606964111
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.796 Vali Acc: 0.519 Test Loss: 3.796 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.893409013748169
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.773 Vali Acc: 0.519 Test Loss: 3.773 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.1082603931427
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.752 Vali Acc: 0.519 Test Loss: 3.752 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 74606633
model size : 285.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2993996143341064
Epoch: 1, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.497 Vali Acc: 0.489 Test Loss: 1.497 Test Acc: 0.489
Validation loss decreased (inf --> -0.488535).  Saving model ...
Epoch: 2 cost time: 0.9927978515625
Epoch: 2, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.447 Vali Acc: 0.435 Test Loss: 1.447 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9705898761749268
Epoch: 3, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.886 Vali Acc: 0.473 Test Loss: 1.886 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0349843502044678
Epoch: 4, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.991 Vali Acc: 0.450 Test Loss: 1.991 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0330233573913574
Epoch: 5, Steps: 8 | Train Loss: 0.037 Vali Loss: 2.591 Vali Acc: 0.443 Test Loss: 2.591 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.004063606262207
Epoch: 6, Steps: 8 | Train Loss: 0.020 Vali Loss: 3.172 Vali Acc: 0.420 Test Loss: 3.172 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9900965690612793
Epoch: 7, Steps: 8 | Train Loss: 0.078 Vali Loss: 3.364 Vali Acc: 0.405 Test Loss: 3.364 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0422887802124023
Epoch: 8, Steps: 8 | Train Loss: 0.204 Vali Loss: 4.073 Vali Acc: 0.420 Test Loss: 4.073 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0338475704193115
Epoch: 9, Steps: 8 | Train Loss: 0.119 Vali Loss: 5.322 Vali Acc: 0.336 Test Loss: 5.322 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0047805309295654
Epoch: 10, Steps: 8 | Train Loss: 0.314 Vali Loss: 6.628 Vali Acc: 0.374 Test Loss: 6.628 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.015777587890625
Epoch: 11, Steps: 8 | Train Loss: 0.300 Vali Loss: 9.514 Vali Acc: 0.321 Test Loss: 9.514 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 74240041
model size : 283.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 50.7042179107666
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.709 Vali Acc: 0.420 Test Loss: 1.709 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 50.00277280807495
Epoch: 2, Steps: 8 | Train Loss: 1.129 Vali Loss: 1.333 Vali Acc: 0.489 Test Loss: 1.333 Test Acc: 0.489
Validation loss decreased (-0.419830 --> -0.488536).  Saving model ...
Epoch: 3 cost time: 51.996978521347046
Epoch: 3, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.333 Vali Acc: 0.489 Test Loss: 1.333 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 50.79517197608948
Epoch: 4, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.597 Vali Acc: 0.565 Test Loss: 1.597 Test Acc: 0.565
Validation loss decreased (-0.488536 --> -0.564870).  Saving model ...
Epoch: 5 cost time: 48.84371209144592
Epoch: 5, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.550 Vali Acc: 0.496 Test Loss: 1.550 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 50.420665979385376
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.458 Vali Acc: 0.557 Test Loss: 1.458 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 51.654433727264404
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.519 Test Loss: 1.542 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 51.03061270713806
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.550 Test Loss: 1.761 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 52.52927327156067
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.550 Test Loss: 1.791 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 56.81425738334656
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.542 Test Loss: 1.624 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 55.68119168281555
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.519 Test Loss: 1.554 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 51.62897562980652
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.534 Test Loss: 1.545 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 53.05758023262024
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.542 Test Loss: 1.575 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 58.14787316322327
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.542 Test Loss: 1.610 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 39708829
model size : 158.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 43.89146542549133
Epoch: 1, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.678 Vali Acc: 0.420 Test Loss: 1.678 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 41.883251428604126
Epoch: 2, Steps: 8 | Train Loss: 0.899 Vali Loss: 1.477 Vali Acc: 0.481 Test Loss: 1.477 Test Acc: 0.481
Validation loss decreased (-0.419831 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 41.08408331871033
Epoch: 3, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.444 Vali Acc: 0.542 Test Loss: 1.444 Test Acc: 0.542
Validation loss decreased (-0.480901 --> -0.541970).  Saving model ...
Epoch: 4 cost time: 43.517759799957275
Epoch: 4, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.588 Vali Acc: 0.420 Test Loss: 1.588 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.38017129898071
Epoch: 5, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.461 Vali Acc: 0.527 Test Loss: 2.461 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 41.164119243621826
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.218 Vali Acc: 0.511 Test Loss: 2.218 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 39.646005153656006
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.534 Test Loss: 2.038 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 41.75687313079834
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.011 Vali Acc: 0.519 Test Loss: 2.011 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 37.60202217102051
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.504 Test Loss: 2.064 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 39.77630829811096
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.121 Vali Acc: 0.511 Test Loss: 2.121 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 38.689701795578
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.511 Test Loss: 2.171 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 37.00226426124573
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.190 Vali Acc: 0.511 Test Loss: 2.190 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 42.74059295654297
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.200 Vali Acc: 0.511 Test Loss: 2.200 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 39249053
model size : 155.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.119611740112305
Epoch: 1, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.670 Vali Acc: 0.420 Test Loss: 1.670 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 32.613136291503906
Epoch: 2, Steps: 8 | Train Loss: 1.014 Vali Loss: 1.325 Vali Acc: 0.511 Test Loss: 1.325 Test Acc: 0.511
Validation loss decreased (-0.419831 --> -0.511437).  Saving model ...
Epoch: 3 cost time: 28.198992252349854
Epoch: 3, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.479 Vali Acc: 0.511 Test Loss: 1.479 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.872422695159912
Epoch: 4, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.773 Vali Acc: 0.519 Test Loss: 1.773 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519066).  Saving model ...
Epoch: 5 cost time: 28.85696053504944
Epoch: 5, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.492 Vali Acc: 0.527 Test Loss: 1.492 Test Acc: 0.527
Validation loss decreased (-0.519066 --> -0.526703).  Saving model ...
Epoch: 6 cost time: 32.4924042224884
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.677 Vali Acc: 0.557 Test Loss: 1.677 Test Acc: 0.557
Validation loss decreased (-0.526703 --> -0.557235).  Saving model ...
Epoch: 7 cost time: 27.65372085571289
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.519 Test Loss: 1.678 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 31.361127614974976
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.550 Test Loss: 1.864 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 29.591468811035156
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.082 Vali Acc: 0.550 Test Loss: 2.082 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.53386950492859
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.550 Test Loss: 1.965 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 28.960108518600464
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.542 Test Loss: 1.847 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 31.73554754257202
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.542 Test Loss: 1.799 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 30.29312300682068
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.542 Test Loss: 1.802 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 29.091790199279785
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.542 Test Loss: 1.829 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 29.70687198638916
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.550 Test Loss: 1.851 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 29.73253083229065
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.550 Test Loss: 1.855 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 38788253
model size : 152.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.223334789276123
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.809 Vali Acc: 0.298 Test Loss: 1.809 Test Acc: 0.298
Validation loss decreased (inf --> -0.297692).  Saving model ...
Epoch: 2 cost time: 19.477532625198364
Epoch: 2, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.484 Vali Acc: 0.473 Test Loss: 1.484 Test Acc: 0.473
Validation loss decreased (-0.297692 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 19.594698429107666
Epoch: 3, Steps: 8 | Train Loss: 0.445 Vali Loss: 1.512 Vali Acc: 0.496 Test Loss: 1.512 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 19.62539005279541
Epoch: 4, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.540 Vali Acc: 0.489 Test Loss: 1.540 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.63555884361267
Epoch: 5, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.248 Vali Acc: 0.351 Test Loss: 2.248 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.552552938461304
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.290 Vali Acc: 0.519 Test Loss: 2.290 Test Acc: 0.519
Validation loss decreased (-0.496168 --> -0.519061).  Saving model ...
Epoch: 7 cost time: 18.492847442626953
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.867 Vali Acc: 0.405 Test Loss: 1.867 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.978923320770264
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.120 Vali Acc: 0.504 Test Loss: 2.120 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.079303741455078
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.233 Vali Acc: 0.534 Test Loss: 2.233 Test Acc: 0.534
Validation loss decreased (-0.519061 --> -0.534329).  Saving model ...
Epoch: 10 cost time: 18.657227277755737
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.458 Test Loss: 2.003 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.512896299362183
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.458 Test Loss: 2.026 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.349243640899658
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.109 Vali Acc: 0.519 Test Loss: 2.109 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 20.687806129455566
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.527 Test Loss: 2.206 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 20.46261215209961
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.205 Vali Acc: 0.527 Test Loss: 2.205 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.78008222579956
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.148 Vali Acc: 0.527 Test Loss: 2.148 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.113413095474243
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.527 Test Loss: 2.098 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 17.902404069900513
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.068 Vali Acc: 0.527 Test Loss: 2.068 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 22.775044441223145
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.527 Test Loss: 2.064 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 21.5873703956604
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.077 Vali Acc: 0.527 Test Loss: 2.077 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 38328477
model size : 149.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.167186498641968
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.607 Vali Acc: 0.412 Test Loss: 1.607 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 12.334591388702393
Epoch: 2, Steps: 8 | Train Loss: 0.727 Vali Loss: 1.355 Vali Acc: 0.511 Test Loss: 1.355 Test Acc: 0.511
Validation loss decreased (-0.412198 --> -0.511437).  Saving model ...
Epoch: 3 cost time: 12.002732276916504
Epoch: 3, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.220 Vali Acc: 0.534 Test Loss: 1.220 Test Acc: 0.534
Validation loss decreased (-0.511437 --> -0.534339).  Saving model ...
Epoch: 4 cost time: 11.544104814529419
Epoch: 4, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.454 Vali Acc: 0.511 Test Loss: 1.454 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.134503841400146
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.193 Vali Acc: 0.519 Test Loss: 2.193 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.211641073226929
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.169 Vali Acc: 0.527 Test Loss: 2.169 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.869060039520264
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.872 Vali Acc: 0.550 Test Loss: 1.872 Test Acc: 0.550
Validation loss decreased (-0.534339 --> -0.549600).  Saving model ...
Epoch: 8 cost time: 12.831777095794678
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.557 Test Loss: 1.722 Test Acc: 0.557
Validation loss decreased (-0.549600 --> -0.557235).  Saving model ...
Epoch: 9 cost time: 11.855154752731323
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.657 Vali Acc: 0.550 Test Loss: 1.657 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.565511226654053
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.550 Test Loss: 1.630 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.862155199050903
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.550 Test Loss: 1.621 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.814781665802002
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.550 Test Loss: 1.620 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.626536846160889
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.542 Test Loss: 1.625 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.25476598739624
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.550 Test Loss: 1.631 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.344618797302246
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.550 Test Loss: 1.639 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.219369411468506
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.542 Test Loss: 1.646 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.426891803741455
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.550 Test Loss: 1.650 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.199718236923218
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.550 Test Loss: 1.656 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 37959837
model size : 146.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.031080961227417
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.710 Vali Acc: 0.420 Test Loss: 1.710 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 8.271224975585938
Epoch: 2, Steps: 8 | Train Loss: 0.998 Vali Loss: 1.423 Vali Acc: 0.473 Test Loss: 1.423 Test Acc: 0.473
Validation loss decreased (-0.419830 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 7.653557300567627
Epoch: 3, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.486 Vali Acc: 0.557 Test Loss: 1.486 Test Acc: 0.557
Validation loss decreased (-0.473268 --> -0.557237).  Saving model ...
Epoch: 4 cost time: 7.67801833152771
Epoch: 4, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.990 Vali Acc: 0.511 Test Loss: 1.990 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.585515260696411
Epoch: 5, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.113 Vali Acc: 0.450 Test Loss: 2.113 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.399743795394897
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.550 Test Loss: 1.960 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.80936336517334
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.542 Test Loss: 1.921 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.724560022354126
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.534 Test Loss: 1.761 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.933272838592529
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.527 Test Loss: 1.718 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.422145843505859
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.527 Test Loss: 1.750 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.249194622039795
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.534 Test Loss: 1.801 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.055673837661743
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.534 Test Loss: 1.853 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.90826940536499
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.550 Test Loss: 1.898 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 37775517
model size : 145.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.283878326416016
Epoch: 1, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.639 Vali Acc: 0.412 Test Loss: 1.639 Test Acc: 0.412
Validation loss decreased (inf --> -0.412197).  Saving model ...
Epoch: 2 cost time: 4.559911251068115
Epoch: 2, Steps: 8 | Train Loss: 1.011 Vali Loss: 1.559 Vali Acc: 0.458 Test Loss: 1.559 Test Acc: 0.458
Validation loss decreased (-0.412197 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 4.916228532791138
Epoch: 3, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.303 Vali Acc: 0.542 Test Loss: 1.303 Test Acc: 0.542
Validation loss decreased (-0.458000 --> -0.541972).  Saving model ...
Epoch: 4 cost time: 4.906630277633667
Epoch: 4, Steps: 8 | Train Loss: 0.114 Vali Loss: 2.016 Vali Acc: 0.275 Test Loss: 2.016 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.603983163833618
Epoch: 5, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.936 Vali Acc: 0.481 Test Loss: 1.936 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.446331024169922
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.891 Vali Acc: 0.542 Test Loss: 2.891 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.355595111846924
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.115 Vali Acc: 0.557 Test Loss: 2.115 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557231).  Saving model ...
Epoch: 8 cost time: 4.421937465667725
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.931 Vali Acc: 0.550 Test Loss: 1.931 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.0542871952056885
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.550 Test Loss: 2.107 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.504475355148315
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.311 Vali Acc: 0.550 Test Loss: 2.311 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.150679349899292
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.401 Vali Acc: 0.550 Test Loss: 2.401 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.45736289024353
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.401 Vali Acc: 0.550 Test Loss: 2.401 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.575898170471191
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.352 Vali Acc: 0.550 Test Loss: 2.352 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.725846767425537
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.314 Vali Acc: 0.550 Test Loss: 2.314 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.508092403411865
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.285 Vali Acc: 0.550 Test Loss: 2.285 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.331160545349121
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.287 Vali Acc: 0.550 Test Loss: 2.287 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.536826133728027
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.550 Test Loss: 2.296 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 37591197
model size : 143.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.348543167114258
Epoch: 1, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.596 Vali Acc: 0.389 Test Loss: 1.596 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.1678082942962646
Epoch: 2, Steps: 8 | Train Loss: 0.572 Vali Loss: 1.323 Vali Acc: 0.534 Test Loss: 1.323 Test Acc: 0.534
Validation loss decreased (-0.389297 --> -0.534338).  Saving model ...
Epoch: 3 cost time: 1.2704496383666992
Epoch: 3, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.512 Vali Acc: 0.542 Test Loss: 1.512 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541970).  Saving model ...
Epoch: 4 cost time: 1.1696357727050781
Epoch: 4, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.750 Vali Acc: 0.550 Test Loss: 1.750 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549601).  Saving model ...
Epoch: 5 cost time: 1.1853060722351074
Epoch: 5, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.246 Vali Acc: 0.511 Test Loss: 2.246 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1545124053955078
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.844 Vali Acc: 0.534 Test Loss: 1.844 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1420087814331055
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.796 Vali Acc: 0.527 Test Loss: 2.796 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2195420265197754
Epoch: 8, Steps: 8 | Train Loss: 0.070 Vali Loss: 2.423 Vali Acc: 0.389 Test Loss: 2.423 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2002472877502441
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.440 Vali Acc: 0.458 Test Loss: 2.440 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1602799892425537
Epoch: 10, Steps: 8 | Train Loss: 0.115 Vali Loss: 3.995 Vali Acc: 0.458 Test Loss: 3.995 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1384766101837158
Epoch: 11, Steps: 8 | Train Loss: 0.263 Vali Loss: 3.723 Vali Acc: 0.298 Test Loss: 3.723 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1474411487579346
Epoch: 12, Steps: 8 | Train Loss: 0.371 Vali Loss: 5.017 Vali Acc: 0.420 Test Loss: 5.017 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1422641277313232
Epoch: 13, Steps: 8 | Train Loss: 0.228 Vali Loss: 4.776 Vali Acc: 0.412 Test Loss: 4.776 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2157948017120361
Epoch: 14, Steps: 8 | Train Loss: 0.097 Vali Loss: 5.832 Vali Acc: 0.435 Test Loss: 5.832 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 37407901
model size : 142.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 53.31474447250366
Epoch: 1, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.628 Vali Acc: 0.427 Test Loss: 1.628 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 50.55510997772217
Epoch: 2, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.558 Vali Acc: 0.481 Test Loss: 1.558 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480900).  Saving model ...
Epoch: 3 cost time: 51.478233337402344
Epoch: 3, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.906 Vali Acc: 0.321 Test Loss: 1.906 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 50.888059854507446
Epoch: 4, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.548 Vali Acc: 0.519 Test Loss: 1.548 Test Acc: 0.519
Validation loss decreased (-0.480900 --> -0.519068).  Saving model ...
Epoch: 5 cost time: 49.59110140800476
Epoch: 5, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.011 Vali Acc: 0.359 Test Loss: 2.011 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 50.84410333633423
Epoch: 6, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.204 Vali Acc: 0.534 Test Loss: 2.204 Test Acc: 0.534
Validation loss decreased (-0.519068 --> -0.534329).  Saving model ...
Epoch: 7 cost time: 51.909958600997925
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.036 Vali Acc: 0.405 Test Loss: 2.036 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 51.290305376052856
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.450 Vali Acc: 0.527 Test Loss: 2.450 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 50.67139530181885
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.478 Vali Acc: 0.534 Test Loss: 2.478 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 51.99990487098694
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.290 Vali Acc: 0.450 Test Loss: 2.290 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 52.26991534233093
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.435 Test Loss: 2.284 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 48.888426303863525
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.473 Test Loss: 2.355 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 50.83728861808777
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.489 Test Loss: 2.448 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 52.14612030982971
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.485 Vali Acc: 0.519 Test Loss: 2.485 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 48.262497425079346
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.465 Vali Acc: 0.519 Test Loss: 2.465 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 50.12112236022949
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.413 Vali Acc: 0.511 Test Loss: 2.413 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 39708777
model size : 158.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 42.41964817047119
Epoch: 1, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.583 Vali Acc: 0.351 Test Loss: 1.583 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 42.22149705886841
Epoch: 2, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.352 Vali Acc: 0.527 Test Loss: 1.352 Test Acc: 0.527
Validation loss decreased (-0.351129 --> -0.526704).  Saving model ...
Epoch: 3 cost time: 40.19295310974121
Epoch: 3, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.361 Vali Acc: 0.580 Test Loss: 1.361 Test Acc: 0.580
Validation loss decreased (-0.526704 --> -0.580139).  Saving model ...
Epoch: 4 cost time: 41.06153154373169
Epoch: 4, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.518 Vali Acc: 0.466 Test Loss: 1.518 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 41.97368597984314
Epoch: 5, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.431 Vali Acc: 0.489 Test Loss: 1.431 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 42.14454793930054
Epoch: 6, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.350 Vali Acc: 0.511 Test Loss: 1.350 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 42.2981653213501
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.644 Vali Acc: 0.588 Test Loss: 1.644 Test Acc: 0.588
Validation loss decreased (-0.580139 --> -0.587770).  Saving model ...
Epoch: 8 cost time: 41.07087707519531
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.611 Vali Acc: 0.603 Test Loss: 1.611 Test Acc: 0.603
Validation loss decreased (-0.587770 --> -0.603037).  Saving model ...
Epoch: 9 cost time: 38.863892555236816
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.580 Test Loss: 1.447 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 42.00934433937073
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.557 Test Loss: 1.389 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 37.55789017677307
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.573 Test Loss: 1.384 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 41.935553312301636
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.573 Test Loss: 1.406 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 40.34185242652893
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.565 Test Loss: 1.425 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 42.69542336463928
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.573 Test Loss: 1.431 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 42.35924243927002
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.573 Test Loss: 1.429 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 44.7969708442688
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.573 Test Loss: 1.428 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 39.96367120742798
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.573 Test Loss: 1.428 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 40.69829249382019
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.573 Test Loss: 1.430 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 39249001
model size : 155.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.11887526512146
Epoch: 1, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 30.633039236068726
Epoch: 2, Steps: 8 | Train Loss: 1.115 Vali Loss: 1.310 Vali Acc: 0.519 Test Loss: 1.310 Test Acc: 0.519
Validation loss decreased (-0.419832 --> -0.519071).  Saving model ...
Epoch: 3 cost time: 29.650121927261353
Epoch: 3, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.519071 --> -0.549606).  Saving model ...
Epoch: 4 cost time: 29.83243465423584
Epoch: 4, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.160 Vali Acc: 0.542 Test Loss: 1.160 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.739253520965576
Epoch: 5, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.216 Vali Acc: 0.542 Test Loss: 1.216 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 31.594332933425903
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.302 Vali Acc: 0.534 Test Loss: 1.302 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 29.654195547103882
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 31.047969102859497
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.588 Test Loss: 1.488 Test Acc: 0.588
Validation loss decreased (-0.549606 --> -0.587771).  Saving model ...
Epoch: 9 cost time: 31.438048362731934
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.573 Test Loss: 1.300 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 31.151055574417114
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.489 Test Loss: 1.392 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 31.9433650970459
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.504 Test Loss: 1.403 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 30.26957392692566
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.550 Test Loss: 1.385 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 31.86414623260498
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.580 Test Loss: 1.391 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 34.33512878417969
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.580 Test Loss: 1.369 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 32.44420289993286
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.580 Test Loss: 1.344 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 34.00905776023865
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.580 Test Loss: 1.333 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 33.65584373474121
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.580 Test Loss: 1.332 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 32.57028913497925
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.580 Test Loss: 1.335 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 38788201
model size : 152.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.458601713180542
Epoch: 1, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.634 Vali Acc: 0.450 Test Loss: 1.634 Test Acc: 0.450
Validation loss decreased (inf --> -0.450365).  Saving model ...
Epoch: 2 cost time: 22.36084771156311
Epoch: 2, Steps: 8 | Train Loss: 1.075 Vali Loss: 1.377 Vali Acc: 0.496 Test Loss: 1.377 Test Acc: 0.496
Validation loss decreased (-0.450365 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 21.4955313205719
Epoch: 3, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.263 Vali Acc: 0.534 Test Loss: 1.263 Test Acc: 0.534
Validation loss decreased (-0.496169 --> -0.534339).  Saving model ...
Epoch: 4 cost time: 21.70581030845642
Epoch: 4, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.769 Vali Acc: 0.489 Test Loss: 1.769 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.97983193397522
Epoch: 5, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.454 Vali Acc: 0.603 Test Loss: 1.454 Test Acc: 0.603
Validation loss decreased (-0.534339 --> -0.603039).  Saving model ...
Epoch: 6 cost time: 20.10934352874756
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.835 Vali Acc: 0.443 Test Loss: 1.835 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.954503297805786
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.893 Vali Acc: 0.550 Test Loss: 1.893 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.731482982635498
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.550 Test Loss: 1.443 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.540953636169434
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.542 Test Loss: 1.628 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.253167390823364
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 20.55263876914978
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.557 Test Loss: 1.591 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 21.922677040100098
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.550 Test Loss: 1.601 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 22.592894077301025
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.550 Test Loss: 1.620 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 21.487332344055176
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.527 Test Loss: 1.638 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.91955542564392
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.648 Vali Acc: 0.519 Test Loss: 1.648 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 38328425
model size : 149.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.152512073516846
Epoch: 1, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.697 Vali Acc: 0.458 Test Loss: 1.697 Test Acc: 0.458
Validation loss decreased (inf --> -0.457998).  Saving model ...
Epoch: 2 cost time: 11.201541423797607
Epoch: 2, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.370 Vali Acc: 0.481 Test Loss: 1.370 Test Acc: 0.481
Validation loss decreased (-0.457998 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 11.243277788162231
Epoch: 3, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.456 Vali Acc: 0.542 Test Loss: 1.456 Test Acc: 0.542
Validation loss decreased (-0.480902 --> -0.541970).  Saving model ...
Epoch: 4 cost time: 10.921424150466919
Epoch: 4, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.195 Vali Acc: 0.565 Test Loss: 1.195 Test Acc: 0.565
Validation loss decreased (-0.541970 --> -0.564874).  Saving model ...
Epoch: 5 cost time: 11.333673000335693
Epoch: 5, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.414 Vali Acc: 0.580 Test Loss: 1.414 Test Acc: 0.580
Validation loss decreased (-0.564874 --> -0.580139).  Saving model ...
Epoch: 6 cost time: 12.976595163345337
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.611 Test Loss: 1.359 Test Acc: 0.611
Validation loss decreased (-0.580139 --> -0.610673).  Saving model ...
Epoch: 7 cost time: 11.083784818649292
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.303 Vali Acc: 0.634 Test Loss: 1.303 Test Acc: 0.634
Validation loss decreased (-0.610673 --> -0.633575).  Saving model ...
Epoch: 8 cost time: 12.622310400009155
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.603 Test Loss: 1.320 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.422118425369263
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.588 Test Loss: 1.365 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.37968897819519
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.588 Test Loss: 1.384 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.791250944137573
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.595 Test Loss: 1.375 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.036372661590576
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.595 Test Loss: 1.380 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.746953964233398
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.588 Test Loss: 1.383 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.755995273590088
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.595 Test Loss: 1.377 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.373409271240234
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.595 Test Loss: 1.385 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.977625370025635
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.595 Test Loss: 1.396 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.647876501083374
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.595 Test Loss: 1.399 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 37959785
model size : 146.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.986045598983765
Epoch: 1, Steps: 8 | Train Loss: 1.697 Vali Loss: 1.720 Vali Acc: 0.160 Test Loss: 1.720 Test Acc: 0.160
Validation loss decreased (inf --> -0.160288).  Saving model ...
Epoch: 2 cost time: 8.542614936828613
Epoch: 2, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
Validation loss decreased (-0.160288 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 7.143403053283691
Epoch: 3, Steps: 8 | Train Loss: 0.789 Vali Loss: 1.672 Vali Acc: 0.290 Test Loss: 1.672 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.26504135131836
Epoch: 4, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.453 Vali Acc: 0.382 Test Loss: 1.453 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.86638331413269
Epoch: 5, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.529 Vali Acc: 0.450 Test Loss: 1.529 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.501465082168579
Epoch: 6, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.527 Vali Acc: 0.565 Test Loss: 1.527 Test Acc: 0.565
Validation loss decreased (-0.480901 --> -0.564870).  Saving model ...
Epoch: 7 cost time: 9.270883083343506
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.489 Vali Acc: 0.588 Test Loss: 1.489 Test Acc: 0.588
Validation loss decreased (-0.564870 --> -0.587771).  Saving model ...
Epoch: 8 cost time: 8.885320901870728
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.583 Vali Acc: 0.473 Test Loss: 1.583 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.521114110946655
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.420 Vali Acc: 0.519 Test Loss: 1.420 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.602323293685913
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.557 Test Loss: 1.751 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.361198425292969
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.580 Test Loss: 1.553 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.747158288955688
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.519 Test Loss: 1.468 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.211224555969238
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.534 Test Loss: 1.476 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.766640186309814
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.527 Test Loss: 1.488 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.76791763305664
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.550 Test Loss: 1.490 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.293193817138672
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.565 Test Loss: 1.487 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.006645679473877
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.565 Test Loss: 1.484 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 37775465
model size : 145.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.424278497695923
Epoch: 1, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.844 Vali Acc: 0.420 Test Loss: 1.844 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 4.329958915710449
Epoch: 2, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.515 Vali Acc: 0.458 Test Loss: 1.515 Test Acc: 0.458
Validation loss decreased (-0.419829 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 4.5682532787323
Epoch: 3, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.549 Vali Acc: 0.550 Test Loss: 1.549 Test Acc: 0.550
Validation loss decreased (-0.458000 --> -0.549603).  Saving model ...
Epoch: 4 cost time: 4.971102476119995
Epoch: 4, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.700 Vali Acc: 0.534 Test Loss: 1.700 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.406212091445923
Epoch: 5, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.958 Vali Acc: 0.527 Test Loss: 1.958 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.642825126647949
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.865 Vali Acc: 0.550 Test Loss: 1.865 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.123480319976807
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.981 Vali Acc: 0.557 Test Loss: 1.981 Test Acc: 0.557
Validation loss decreased (-0.549603 --> -0.557232).  Saving model ...
Epoch: 8 cost time: 5.031779527664185
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.139 Vali Acc: 0.534 Test Loss: 2.139 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.509260654449463
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.276 Vali Acc: 0.534 Test Loss: 2.276 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.348207712173462
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.351 Vali Acc: 0.534 Test Loss: 2.351 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.218454837799072
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.534 Test Loss: 2.373 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.991358995437622
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.366 Vali Acc: 0.534 Test Loss: 2.366 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9807019233703613
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.356 Vali Acc: 0.534 Test Loss: 2.356 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.152519702911377
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.534 Test Loss: 2.342 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.198942422866821
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.534 Test Loss: 2.331 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.13424277305603
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.330 Vali Acc: 0.534 Test Loss: 2.330 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.07431697845459
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.318 Vali Acc: 0.534 Test Loss: 2.318 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 37591145
model size : 143.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.072788953781128
Epoch: 1, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.679 Vali Acc: 0.420 Test Loss: 1.679 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2028121948242188
Epoch: 2, Steps: 8 | Train Loss: 0.845 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
Validation loss decreased (-0.419831 --> -0.526703).  Saving model ...
Epoch: 3 cost time: 1.2415614128112793
Epoch: 3, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.523 Vali Acc: 0.435 Test Loss: 1.523 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2511656284332275
Epoch: 4, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.288 Vali Acc: 0.504 Test Loss: 2.288 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.206998348236084
Epoch: 5, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.103 Vali Acc: 0.405 Test Loss: 2.103 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2698478698730469
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.931 Vali Acc: 0.466 Test Loss: 2.931 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2397973537445068
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.218 Vali Acc: 0.443 Test Loss: 3.218 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.280122995376587
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.214 Vali Acc: 0.435 Test Loss: 3.214 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.174515724182129
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.239 Vali Acc: 0.443 Test Loss: 3.239 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.286064863204956
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.269 Vali Acc: 0.443 Test Loss: 3.269 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1852033138275146
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.292 Vali Acc: 0.427 Test Loss: 3.292 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2513890266418457
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.310 Vali Acc: 0.427 Test Loss: 3.310 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 37407849
model size : 142.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 49.8167610168457
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.702 Vali Acc: 0.420 Test Loss: 1.702 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 46.75829219818115
Epoch: 2, Steps: 8 | Train Loss: 0.550 Vali Loss: 1.315 Vali Acc: 0.534 Test Loss: 1.315 Test Acc: 0.534
Validation loss decreased (-0.419830 --> -0.534338).  Saving model ...
Epoch: 3 cost time: 51.79905581474304
Epoch: 3, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.674 Vali Acc: 0.519 Test Loss: 1.674 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 52.69538187980652
Epoch: 4, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.874 Vali Acc: 0.534 Test Loss: 1.874 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 52.94763255119324
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.545 Vali Acc: 0.519 Test Loss: 2.545 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 53.38544178009033
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.953 Vali Acc: 0.519 Test Loss: 2.953 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 46.753220319747925
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.992 Vali Acc: 0.519 Test Loss: 2.992 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 47.40169668197632
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.927 Vali Acc: 0.519 Test Loss: 2.927 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 51.79546022415161
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.519 Test Loss: 2.828 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 52.424476623535156
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.742 Vali Acc: 0.519 Test Loss: 2.742 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 50.21011400222778
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.670 Vali Acc: 0.519 Test Loss: 2.670 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 53.092172145843506
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.615 Vali Acc: 0.519 Test Loss: 2.615 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 39708713
model size : 158.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 46.049489974975586
Epoch: 1, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.683 Vali Acc: 0.420 Test Loss: 1.683 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 37.8064284324646
Epoch: 2, Steps: 8 | Train Loss: 0.516 Vali Loss: 1.414 Vali Acc: 0.542 Test Loss: 1.414 Test Acc: 0.542
Validation loss decreased (-0.419830 --> -0.541971).  Saving model ...
Epoch: 3 cost time: 41.788108110427856
Epoch: 3, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.010 Vali Acc: 0.519 Test Loss: 2.010 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 41.430537939071655
Epoch: 4, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.085 Vali Acc: 0.511 Test Loss: 2.085 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 38.37115263938904
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.220 Vali Acc: 0.504 Test Loss: 2.220 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 40.45132827758789
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.496 Test Loss: 2.339 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 41.136531829833984
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.511 Test Loss: 2.444 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 42.517698764801025
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.522 Vali Acc: 0.519 Test Loss: 2.522 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 42.360800981521606
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.573 Vali Acc: 0.511 Test Loss: 2.573 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 39.6099750995636
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.599 Vali Acc: 0.519 Test Loss: 2.599 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 40.16690254211426
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.612 Vali Acc: 0.519 Test Loss: 2.612 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 41.42923545837402
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.621 Vali Acc: 0.519 Test Loss: 2.621 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 39248937
model size : 155.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.806089878082275
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.824 Vali Acc: 0.420 Test Loss: 1.824 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 31.984296321868896
Epoch: 2, Steps: 8 | Train Loss: 0.624 Vali Loss: 1.406 Vali Acc: 0.504 Test Loss: 1.406 Test Acc: 0.504
Validation loss decreased (-0.419829 --> -0.503803).  Saving model ...
Epoch: 3 cost time: 28.108304262161255
Epoch: 3, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.801 Vali Acc: 0.519 Test Loss: 1.801 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519066).  Saving model ...
Epoch: 4 cost time: 31.140044927597046
Epoch: 4, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.143 Vali Acc: 0.511 Test Loss: 2.143 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.264087200164795
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.412 Vali Acc: 0.504 Test Loss: 2.412 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 30.1737003326416
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.583 Vali Acc: 0.519 Test Loss: 2.583 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 32.175763845443726
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.676 Vali Acc: 0.519 Test Loss: 2.676 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 29.52080273628235
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.720 Vali Acc: 0.519 Test Loss: 2.720 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 29.55484175682068
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.519 Test Loss: 2.731 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.596675872802734
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.726 Vali Acc: 0.519 Test Loss: 2.726 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 31.873955726623535
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.519 Test Loss: 2.714 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 29.74747896194458
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.519 Test Loss: 2.703 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 28.942534685134888
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.691 Vali Acc: 0.519 Test Loss: 2.691 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 38788137
model size : 152.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.250859022140503
Epoch: 1, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.620 Vali Acc: 0.420 Test Loss: 1.620 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 21.851983070373535
Epoch: 2, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.394 Vali Acc: 0.511 Test Loss: 1.394 Test Acc: 0.511
Validation loss decreased (-0.419831 --> -0.511436).  Saving model ...
Epoch: 3 cost time: 20.26419997215271
Epoch: 3, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.891 Vali Acc: 0.519 Test Loss: 1.891 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519065).  Saving model ...
Epoch: 4 cost time: 21.199825525283813
Epoch: 4, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.957 Vali Acc: 0.534 Test Loss: 1.957 Test Acc: 0.534
Validation loss decreased (-0.519065 --> -0.534332).  Saving model ...
Epoch: 5 cost time: 20.563141345977783
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.114 Vali Acc: 0.527 Test Loss: 2.114 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.85729742050171
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.534 Test Loss: 2.256 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.960191249847412
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.363 Vali Acc: 0.527 Test Loss: 2.363 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.934716939926147
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.433 Vali Acc: 0.519 Test Loss: 2.433 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.030611038208008
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.480 Vali Acc: 0.519 Test Loss: 2.480 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 23.170697689056396
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.510 Vali Acc: 0.519 Test Loss: 2.510 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 20.053534984588623
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.519 Test Loss: 2.530 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 21.311357498168945
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.546 Vali Acc: 0.519 Test Loss: 2.546 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 20.50108766555786
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.558 Vali Acc: 0.519 Test Loss: 2.558 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 22.231513023376465
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.566 Vali Acc: 0.519 Test Loss: 2.566 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 38328361
model size : 149.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.220230340957642
Epoch: 1, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.617 Vali Acc: 0.420 Test Loss: 1.617 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 12.438827514648438
Epoch: 2, Steps: 8 | Train Loss: 0.438 Vali Loss: 1.401 Vali Acc: 0.519 Test Loss: 1.401 Test Acc: 0.519
Validation loss decreased (-0.419831 --> -0.519070).  Saving model ...
Epoch: 3 cost time: 11.4643075466156
Epoch: 3, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.704 Vali Acc: 0.519 Test Loss: 1.704 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.903660535812378
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.168 Vali Acc: 0.519 Test Loss: 2.168 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.145219326019287
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.453 Vali Acc: 0.527 Test Loss: 2.453 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526693).  Saving model ...
Epoch: 6 cost time: 11.370447874069214
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.608 Vali Acc: 0.519 Test Loss: 2.608 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.008631467819214
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.680 Vali Acc: 0.519 Test Loss: 2.680 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.930352449417114
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.713 Vali Acc: 0.519 Test Loss: 2.713 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.647729873657227
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.723 Vali Acc: 0.519 Test Loss: 2.723 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.78410816192627
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.722 Vali Acc: 0.519 Test Loss: 2.722 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.791978597640991
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.718 Vali Acc: 0.519 Test Loss: 2.718 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.795440912246704
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.519 Test Loss: 2.711 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.038100481033325
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.705 Vali Acc: 0.519 Test Loss: 2.705 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.382739782333374
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.519 Test Loss: 2.696 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.581870794296265
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.690 Vali Acc: 0.519 Test Loss: 2.690 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 37959721
model size : 146.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.102386474609375
Epoch: 1, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.826 Vali Acc: 0.420 Test Loss: 1.826 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 9.049899816513062
Epoch: 2, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.663 Vali Acc: 0.282 Test Loss: 1.663 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.35753583908081
Epoch: 3, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.963 Vali Acc: 0.519 Test Loss: 1.963 Test Acc: 0.519
Validation loss decreased (-0.419829 --> -0.519064).  Saving model ...
Epoch: 4 cost time: 9.531532049179077
Epoch: 4, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.703 Vali Acc: 0.527 Test Loss: 1.703 Test Acc: 0.527
Validation loss decreased (-0.519064 --> -0.526701).  Saving model ...
Epoch: 5 cost time: 9.57202696800232
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.851 Vali Acc: 0.550 Test Loss: 1.851 Test Acc: 0.550
Validation loss decreased (-0.526701 --> -0.549600).  Saving model ...
Epoch: 6 cost time: 9.329835653305054
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.542 Test Loss: 2.013 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.446218729019165
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.519 Test Loss: 2.129 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.273529052734375
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.504 Test Loss: 2.204 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.75957465171814
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.251 Vali Acc: 0.511 Test Loss: 2.251 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.845438480377197
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.279 Vali Acc: 0.511 Test Loss: 2.279 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.697962760925293
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.511 Test Loss: 2.296 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.104110956192017
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.307 Vali Acc: 0.511 Test Loss: 2.307 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.344507455825806
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.316 Vali Acc: 0.511 Test Loss: 2.316 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.1862633228302
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.324 Vali Acc: 0.511 Test Loss: 2.324 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.319698333740234
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.330 Vali Acc: 0.511 Test Loss: 2.330 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 37775401
model size : 145.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.048488616943359
Epoch: 1, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.769 Vali Acc: 0.427 Test Loss: 1.769 Test Acc: 0.427
Validation loss decreased (inf --> -0.427463).  Saving model ...
Epoch: 2 cost time: 4.34022855758667
Epoch: 2, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.342 Vali Acc: 0.450 Test Loss: 1.342 Test Acc: 0.450
Validation loss decreased (-0.427463 --> -0.450368).  Saving model ...
Epoch: 3 cost time: 4.232989072799683
Epoch: 3, Steps: 8 | Train Loss: 0.022 Vali Loss: 2.177 Vali Acc: 0.511 Test Loss: 2.177 Test Acc: 0.511
Validation loss decreased (-0.450368 --> -0.511429).  Saving model ...
Epoch: 4 cost time: 4.457808494567871
Epoch: 4, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.527 Test Loss: 1.902 Test Acc: 0.527
Validation loss decreased (-0.511429 --> -0.526699).  Saving model ...
Epoch: 5 cost time: 4.518479108810425
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.996 Vali Acc: 0.511 Test Loss: 1.996 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.7215492725372314
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.082 Vali Acc: 0.504 Test Loss: 2.082 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.849038600921631
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.155 Vali Acc: 0.504 Test Loss: 2.155 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.75981879234314
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.217 Vali Acc: 0.527 Test Loss: 2.217 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.153696060180664
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.527 Test Loss: 2.263 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.1727259159088135
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.298 Vali Acc: 0.527 Test Loss: 2.298 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.090254783630371
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.326 Vali Acc: 0.527 Test Loss: 2.326 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.31046199798584
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.527 Test Loss: 2.349 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.426452398300171
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.368 Vali Acc: 0.527 Test Loss: 2.368 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.601126670837402
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.387 Vali Acc: 0.527 Test Loss: 2.387 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 37591081
model size : 143.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.0343127250671387
Epoch: 1, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.654 Vali Acc: 0.466 Test Loss: 1.654 Test Acc: 0.466
Validation loss decreased (inf --> -0.465632).  Saving model ...
Epoch: 2 cost time: 1.0420482158660889
Epoch: 2, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.414 Vali Acc: 0.458 Test Loss: 1.414 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0079665184020996
Epoch: 3, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.823 Vali Acc: 0.534 Test Loss: 1.823 Test Acc: 0.534
Validation loss decreased (-0.465632 --> -0.534333).  Saving model ...
Epoch: 4 cost time: 1.1459877490997314
Epoch: 4, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.052 Vali Acc: 0.450 Test Loss: 2.052 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.067626953125
Epoch: 5, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.934 Vali Acc: 0.458 Test Loss: 2.934 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9839200973510742
Epoch: 6, Steps: 8 | Train Loss: 0.078 Vali Loss: 2.878 Vali Acc: 0.504 Test Loss: 2.878 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0436084270477295
Epoch: 7, Steps: 8 | Train Loss: 0.071 Vali Loss: 2.977 Vali Acc: 0.504 Test Loss: 2.977 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9942998886108398
Epoch: 8, Steps: 8 | Train Loss: 0.103 Vali Loss: 4.068 Vali Acc: 0.458 Test Loss: 4.068 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0797061920166016
Epoch: 9, Steps: 8 | Train Loss: 0.262 Vali Loss: 5.070 Vali Acc: 0.420 Test Loss: 5.070 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0354411602020264
Epoch: 10, Steps: 8 | Train Loss: 0.101 Vali Loss: 5.276 Vali Acc: 0.420 Test Loss: 5.276 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0797734260559082
Epoch: 11, Steps: 8 | Train Loss: 0.087 Vali Loss: 5.973 Vali Acc: 0.458 Test Loss: 5.973 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0449607372283936
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 6.468 Vali Acc: 0.412 Test Loss: 6.468 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.068150520324707
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 6.667 Vali Acc: 0.374 Test Loss: 6.667 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 37407785
model size : 142.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.49399018287659
Epoch: 1, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.592 Vali Acc: 0.412 Test Loss: 1.592 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 53.0763463973999
Epoch: 2, Steps: 8 | Train Loss: 0.976 Vali Loss: 1.482 Vali Acc: 0.313 Test Loss: 1.482 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 54.710346937179565
Epoch: 3, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.299 Vali Acc: 0.550 Test Loss: 1.299 Test Acc: 0.550
Validation loss decreased (-0.412198 --> -0.549605).  Saving model ...
Epoch: 4 cost time: 53.80589175224304
Epoch: 4, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.229 Vali Acc: 0.527 Test Loss: 1.229 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 54.02570080757141
Epoch: 5, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.243 Vali Acc: 0.557 Test Loss: 1.243 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 6 cost time: 53.961281061172485
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.284 Vali Acc: 0.550 Test Loss: 1.284 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 52.446178913116455
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.588 Test Loss: 1.402 Test Acc: 0.588
Validation loss decreased (-0.557239 --> -0.587772).  Saving model ...
Epoch: 8 cost time: 53.09995651245117
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.321 Vali Acc: 0.580 Test Loss: 1.321 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 54.09772610664368
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.573 Test Loss: 1.229 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 55.50337243080139
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.211 Vali Acc: 0.565 Test Loss: 1.211 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 52.08744144439697
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.573 Test Loss: 1.233 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 52.566893577575684
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.573 Test Loss: 1.265 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 54.363643169403076
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.573 Test Loss: 1.274 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 50.94391322135925
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.573 Test Loss: 1.274 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 55.44805288314819
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.274 Vali Acc: 0.573 Test Loss: 1.274 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 55.23304343223572
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.565 Test Loss: 1.268 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 55.36394166946411
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.580 Test Loss: 1.269 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 20142237
model size : 83.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 44.41193699836731
Epoch: 1, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.755 Vali Acc: 0.252 Test Loss: 1.755 Test Acc: 0.252
Validation loss decreased (inf --> -0.251891).  Saving model ...
Epoch: 2 cost time: 40.481881618499756
Epoch: 2, Steps: 8 | Train Loss: 1.379 Vali Loss: 1.560 Vali Acc: 0.321 Test Loss: 1.560 Test Acc: 0.321
Validation loss decreased (-0.251891 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 45.18182325363159
Epoch: 3, Steps: 8 | Train Loss: 0.700 Vali Loss: 1.637 Vali Acc: 0.290 Test Loss: 1.637 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 42.76237154006958
Epoch: 4, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.777 Vali Acc: 0.366 Test Loss: 1.777 Test Acc: 0.366
Validation loss decreased (-0.320595 --> -0.366394).  Saving model ...
Epoch: 5 cost time: 45.60808992385864
Epoch: 5, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.415 Vali Acc: 0.504 Test Loss: 1.415 Test Acc: 0.504
Validation loss decreased (-0.366394 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 44.45538544654846
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.371 Vali Acc: 0.550 Test Loss: 1.371 Test Acc: 0.550
Validation loss decreased (-0.503803 --> -0.549605).  Saving model ...
Epoch: 7 cost time: 45.47956466674805
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 46.02410435676575
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.632 Vali Acc: 0.565 Test Loss: 1.632 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564869).  Saving model ...
Epoch: 9 cost time: 45.03829050064087
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.574 Vali Acc: 0.580 Test Loss: 1.574 Test Acc: 0.580
Validation loss decreased (-0.564869 --> -0.580137).  Saving model ...
Epoch: 10 cost time: 44.145400047302246
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.580 Test Loss: 1.548 Test Acc: 0.580
Validation loss decreased (-0.580137 --> -0.580137).  Saving model ...
Epoch: 11 cost time: 44.651994943618774
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.603 Test Loss: 1.605 Test Acc: 0.603
Validation loss decreased (-0.580137 --> -0.603037).  Saving model ...
Epoch: 12 cost time: 48.880199670791626
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.595 Test Loss: 1.676 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 45.092862367630005
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.595 Test Loss: 1.704 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 45.293126821517944
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.580 Test Loss: 1.711 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 41.45761752128601
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.595 Test Loss: 1.718 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 45.06670904159546
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.595 Test Loss: 1.706 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 45.0603928565979
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.603 Test Loss: 1.705 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 43.167004346847534
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.595 Test Loss: 1.707 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 44.489038705825806
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.595 Test Loss: 1.707 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 41.87770104408264
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.595 Test Loss: 1.721 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 48.22647428512573
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.595 Test Loss: 1.715 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 19912349
model size : 81.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 33.52452778816223
Epoch: 1, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 33.74045538902283
Epoch: 2, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.387 Vali Acc: 0.481 Test Loss: 1.387 Test Acc: 0.481
Validation loss decreased (-0.419831 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 32.26237630844116
Epoch: 3, Steps: 8 | Train Loss: 0.487 Vali Loss: 1.342 Vali Acc: 0.519 Test Loss: 1.342 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519071).  Saving model ...
Epoch: 4 cost time: 31.91971230506897
Epoch: 4, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.593 Vali Acc: 0.534 Test Loss: 1.593 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534335).  Saving model ...
Epoch: 5 cost time: 33.01933932304382
Epoch: 5, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.720 Vali Acc: 0.420 Test Loss: 1.720 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.70182800292969
Epoch: 6, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.946 Vali Acc: 0.427 Test Loss: 1.946 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 35.09465432167053
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.847 Vali Acc: 0.519 Test Loss: 1.847 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.840216636657715
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.080 Vali Acc: 0.511 Test Loss: 2.080 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 33.559305906295776
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.481 Test Loss: 1.752 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 29.642044067382812
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.489 Test Loss: 1.676 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 31.507213592529297
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.527 Test Loss: 1.744 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 35.04125094413757
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.534 Test Loss: 1.851 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 30.575582265853882
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.534 Test Loss: 1.896 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 35.547873973846436
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.534 Test Loss: 1.896 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 19681949
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.407682418823242
Epoch: 1, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.578 Vali Acc: 0.435 Test Loss: 1.578 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 19.397135496139526
Epoch: 2, Steps: 8 | Train Loss: 1.005 Vali Loss: 1.465 Vali Acc: 0.366 Test Loss: 1.465 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.68928027153015
Epoch: 3, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.206 Vali Acc: 0.603 Test Loss: 1.206 Test Acc: 0.603
Validation loss decreased (-0.435099 --> -0.603041).  Saving model ...
Epoch: 4 cost time: 21.606873512268066
Epoch: 4, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.208808660507202
Epoch: 5, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.516 Vali Acc: 0.557 Test Loss: 1.516 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.927019596099854
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.726 Vali Acc: 0.389 Test Loss: 1.726 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.514610052108765
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.534 Test Loss: 1.542 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.702176809310913
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.565 Test Loss: 1.742 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.140144109725952
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.565 Test Loss: 1.734 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.801539182662964
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.573 Test Loss: 1.622 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.640469551086426
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.565 Test Loss: 1.549 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 19.32432985305786
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.557 Test Loss: 1.517 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 19.016905784606934
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.565 Test Loss: 1.511 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 19452061
model size : 77.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.95485234260559
Epoch: 1, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.734 Vali Acc: 0.420 Test Loss: 1.734 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 13.333590030670166
Epoch: 2, Steps: 8 | Train Loss: 1.010 Vali Loss: 1.337 Vali Acc: 0.504 Test Loss: 1.337 Test Acc: 0.504
Validation loss decreased (-0.419830 --> -0.503803).  Saving model ...
Epoch: 3 cost time: 11.31783676147461
Epoch: 3, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.464 Vali Acc: 0.397 Test Loss: 1.464 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.243523120880127
Epoch: 4, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.362 Vali Acc: 0.473 Test Loss: 1.362 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.1479971408844
Epoch: 5, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.831 Vali Acc: 0.550 Test Loss: 1.831 Test Acc: 0.550
Validation loss decreased (-0.503803 --> -0.549600).  Saving model ...
Epoch: 6 cost time: 12.323384523391724
Epoch: 6, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.147 Vali Acc: 0.359 Test Loss: 2.147 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.890656471252441
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.189 Vali Acc: 0.557 Test Loss: 2.189 Test Acc: 0.557
Validation loss decreased (-0.549600 --> -0.557230).  Saving model ...
Epoch: 8 cost time: 12.826057434082031
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.375 Vali Acc: 0.565 Test Loss: 2.375 Test Acc: 0.565
Validation loss decreased (-0.557230 --> -0.564862).  Saving model ...
Epoch: 9 cost time: 11.370666742324829
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.998 Vali Acc: 0.542 Test Loss: 1.998 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.972613096237183
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.550 Test Loss: 1.818 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.692898035049438
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.527 Test Loss: 1.740 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.6102614402771
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.550 Test Loss: 1.714 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.248971700668335
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.565 Test Loss: 1.719 Test Acc: 0.565
Validation loss decreased (-0.564862 --> -0.564868).  Saving model ...
Epoch: 14 cost time: 11.663597106933594
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.565 Test Loss: 1.730 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.558058261871338
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.565 Test Loss: 1.739 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.784791469573975
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.565 Test Loss: 1.748 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.766492128372192
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.565 Test Loss: 1.761 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.011794090270996
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.565 Test Loss: 1.761 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.982118844985962
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.565 Test Loss: 1.760 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.292519092559814
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.565 Test Loss: 1.762 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.914642333984375
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.565 Test Loss: 1.763 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 13.831167697906494
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.573 Test Loss: 1.761 Test Acc: 0.573
Validation loss decreased (-0.564868 --> -0.572501).  Saving model ...
Epoch: 23 cost time: 13.737867832183838
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.573 Test Loss: 1.756 Test Acc: 0.573
Validation loss decreased (-0.572501 --> -0.572502).  Saving model ...
Epoch: 24 cost time: 12.081090688705444
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.573 Test Loss: 1.757 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 12.75212025642395
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.573 Test Loss: 1.758 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 12.87685751914978
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.755 Vali Acc: 0.573 Test Loss: 1.755 Test Acc: 0.573
Validation loss decreased (-0.572502 --> -0.572502).  Saving model ...
Epoch: 27 cost time: 11.860111713409424
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.573 Test Loss: 1.757 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 12.45964002609253
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.573 Test Loss: 1.762 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 12.770116329193115
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.573 Test Loss: 1.762 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 13.418819189071655
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.573 Test Loss: 1.760 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 12.32745885848999
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.573 Test Loss: 1.760 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 13.494402647018433
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.573 Test Loss: 1.756 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 13.061042070388794
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.573 Test Loss: 1.757 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 12.453999996185303
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.573 Test Loss: 1.762 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 12.43722414970398
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.573 Test Loss: 1.763 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 12.862885236740112
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.573 Test Loss: 1.768 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 19267741
model size : 75.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.26989197731018
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.980 Vali Acc: 0.420 Test Loss: 1.980 Test Acc: 0.420
Validation loss decreased (inf --> -0.419828).  Saving model ...
Epoch: 2 cost time: 8.290419816970825
Epoch: 2, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.526 Vali Acc: 0.282 Test Loss: 1.526 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.508524417877197
Epoch: 3, Steps: 8 | Train Loss: 0.385 Vali Loss: 1.442 Vali Acc: 0.435 Test Loss: 1.442 Test Acc: 0.435
Validation loss decreased (-0.419828 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 8.801206827163696
Epoch: 4, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.528 Vali Acc: 0.511 Test Loss: 1.528 Test Acc: 0.511
Validation loss decreased (-0.435100 --> -0.511435).  Saving model ...
Epoch: 5 cost time: 8.025380373001099
Epoch: 5, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.985 Vali Acc: 0.527 Test Loss: 1.985 Test Acc: 0.527
Validation loss decreased (-0.511435 --> -0.526698).  Saving model ...
Epoch: 6 cost time: 7.96496319770813
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.542 Test Loss: 1.683 Test Acc: 0.542
Validation loss decreased (-0.526698 --> -0.541968).  Saving model ...
Epoch: 7 cost time: 7.986154317855835
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.800 Vali Acc: 0.557 Test Loss: 1.800 Test Acc: 0.557
Validation loss decreased (-0.541968 --> -0.557234).  Saving model ...
Epoch: 8 cost time: 8.377474784851074
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.937 Vali Acc: 0.534 Test Loss: 1.937 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.095057487487793
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.950 Vali Acc: 0.534 Test Loss: 1.950 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.715211629867554
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.534 Test Loss: 1.938 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.760365009307861
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.534 Test Loss: 1.942 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.615564584732056
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.550 Test Loss: 1.963 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.704541921615601
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.542 Test Loss: 1.991 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.095134973526001
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.542 Test Loss: 2.016 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.615259408950806
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.024 Vali Acc: 0.542 Test Loss: 2.024 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.879271268844604
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.542 Test Loss: 2.023 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.229013919830322
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.542 Test Loss: 2.012 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 19175581
model size : 74.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.581170082092285
Epoch: 1, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.683 Vali Acc: 0.427 Test Loss: 1.683 Test Acc: 0.427
Validation loss decreased (inf --> -0.427464).  Saving model ...
Epoch: 2 cost time: 4.397720575332642
Epoch: 2, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.433 Vali Acc: 0.466 Test Loss: 1.433 Test Acc: 0.466
Validation loss decreased (-0.427464 --> -0.465635).  Saving model ...
Epoch: 3 cost time: 4.233293056488037
Epoch: 3, Steps: 8 | Train Loss: 0.522 Vali Loss: 1.499 Vali Acc: 0.534 Test Loss: 1.499 Test Acc: 0.534
Validation loss decreased (-0.465635 --> -0.534336).  Saving model ...
Epoch: 4 cost time: 4.288090229034424
Epoch: 4, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.350 Vali Acc: 0.504 Test Loss: 1.350 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.6601948738098145
Epoch: 5, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.558 Vali Acc: 0.542 Test Loss: 1.558 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 6 cost time: 4.661331415176392
Epoch: 6, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.701 Vali Acc: 0.550 Test Loss: 1.701 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549601).  Saving model ...
Epoch: 7 cost time: 4.487242937088013
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.712 Vali Acc: 0.519 Test Loss: 1.712 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.389055967330933
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.550 Test Loss: 1.837 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.13081431388855
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.580 Test Loss: 1.938 Test Acc: 0.580
Validation loss decreased (-0.549601 --> -0.580133).  Saving model ...
Epoch: 10 cost time: 4.282872676849365
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.850 Vali Acc: 0.565 Test Loss: 1.850 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.305030822753906
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.565 Test Loss: 1.827 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.333899974822998
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.580 Test Loss: 1.919 Test Acc: 0.580
Validation loss decreased (-0.580133 --> -0.580133).  Saving model ...
Epoch: 13 cost time: 4.507582664489746
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.946 Vali Acc: 0.550 Test Loss: 1.946 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.1911280155181885
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.580 Test Loss: 1.924 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.558885335922241
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.580 Test Loss: 1.886 Test Acc: 0.580
Validation loss decreased (-0.580133 --> -0.580134).  Saving model ...
Epoch: 16 cost time: 4.138104677200317
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.573 Test Loss: 1.900 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.19549298286438
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.928 Vali Acc: 0.580 Test Loss: 1.928 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.017199277877808
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.550 Test Loss: 1.963 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.152775764465332
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.580 Test Loss: 1.931 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.24065637588501
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.580 Test Loss: 1.930 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.721756935119629
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.580 Test Loss: 1.933 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.918123960494995
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.565 Test Loss: 1.953 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.770720481872559
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.565 Test Loss: 1.964 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.660606384277344
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.550 Test Loss: 1.975 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.272977590560913
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.550 Test Loss: 1.973 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 19083421
model size : 73.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.02713942527771
Epoch: 1, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.561 Vali Acc: 0.405 Test Loss: 1.561 Test Acc: 0.405
Validation loss decreased (inf --> -0.404565).  Saving model ...
Epoch: 2 cost time: 1.134113073348999
Epoch: 2, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.314 Vali Acc: 0.511 Test Loss: 1.314 Test Acc: 0.511
Validation loss decreased (-0.404565 --> -0.511437).  Saving model ...
Epoch: 3 cost time: 1.2411882877349854
Epoch: 3, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.638 Vali Acc: 0.542 Test Loss: 1.638 Test Acc: 0.542
Validation loss decreased (-0.511437 --> -0.541968).  Saving model ...
Epoch: 4 cost time: 1.199251651763916
Epoch: 4, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.963 Vali Acc: 0.542 Test Loss: 1.963 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.24648118019104
Epoch: 5, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.130 Vali Acc: 0.473 Test Loss: 2.130 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2105762958526611
Epoch: 6, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.149 Vali Acc: 0.412 Test Loss: 2.149 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2323484420776367
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.588 Vali Acc: 0.504 Test Loss: 2.588 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2755987644195557
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 3.322 Vali Acc: 0.435 Test Loss: 3.322 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2273766994476318
Epoch: 9, Steps: 8 | Train Loss: 0.084 Vali Loss: 3.901 Vali Acc: 0.466 Test Loss: 3.901 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2002909183502197
Epoch: 10, Steps: 8 | Train Loss: 0.029 Vali Loss: 3.657 Vali Acc: 0.420 Test Loss: 3.657 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1846790313720703
Epoch: 11, Steps: 8 | Train Loss: 0.143 Vali Loss: 4.961 Vali Acc: 0.473 Test Loss: 4.961 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2621619701385498
Epoch: 12, Steps: 8 | Train Loss: 0.184 Vali Loss: 5.208 Vali Acc: 0.397 Test Loss: 5.208 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1956944465637207
Epoch: 13, Steps: 8 | Train Loss: 0.110 Vali Loss: 5.021 Vali Acc: 0.427 Test Loss: 5.021 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 18991773
model size : 72.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 53.220463275909424
Epoch: 1, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.649 Vali Acc: 0.412 Test Loss: 1.649 Test Acc: 0.412
Validation loss decreased (inf --> -0.412197).  Saving model ...
Epoch: 2 cost time: 50.463902711868286
Epoch: 2, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.431 Vali Acc: 0.489 Test Loss: 1.431 Test Acc: 0.489
Validation loss decreased (-0.412197 --> -0.488535).  Saving model ...
Epoch: 3 cost time: 50.13941502571106
Epoch: 3, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.512 Vali Acc: 0.366 Test Loss: 1.512 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 53.26272749900818
Epoch: 4, Steps: 8 | Train Loss: 0.238 Vali Loss: 1.569 Vali Acc: 0.290 Test Loss: 1.569 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 48.744407653808594
Epoch: 5, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.544 Vali Acc: 0.458 Test Loss: 1.544 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 50.04132032394409
Epoch: 6, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.591 Vali Acc: 0.389 Test Loss: 1.591 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 52.611655473709106
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.509 Vali Acc: 0.580 Test Loss: 1.509 Test Acc: 0.580
Validation loss decreased (-0.488535 --> -0.580138).  Saving model ...
Epoch: 8 cost time: 52.10551333427429
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.603 Test Loss: 1.536 Test Acc: 0.603
Validation loss decreased (-0.580138 --> -0.603038).  Saving model ...
Epoch: 9 cost time: 48.27518892288208
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.496 Vali Acc: 0.634 Test Loss: 1.496 Test Acc: 0.634
Validation loss decreased (-0.603038 --> -0.633573).  Saving model ...
Epoch: 10 cost time: 51.50608849525452
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.649 Test Loss: 1.499 Test Acc: 0.649
Validation loss decreased (-0.633573 --> -0.648840).  Saving model ...
Epoch: 11 cost time: 49.935407876968384
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.634 Test Loss: 1.524 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 50.56614565849304
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.649 Test Loss: 1.509 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 51.014421701431274
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.656 Test Loss: 1.496 Test Acc: 0.656
Validation loss decreased (-0.648840 --> -0.656474).  Saving model ...
Epoch: 14 cost time: 50.943076372146606
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.664 Test Loss: 1.500 Test Acc: 0.664
Validation loss decreased (-0.656474 --> -0.664107).  Saving model ...
Epoch: 15 cost time: 49.00292706489563
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.664 Test Loss: 1.505 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 50.46886968612671
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.649 Test Loss: 1.511 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 48.600839138031006
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.656 Test Loss: 1.509 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 49.63310122489929
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.656 Test Loss: 1.504 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 48.80917406082153
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.503 Vali Acc: 0.656 Test Loss: 1.503 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 50.73082256317139
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.656 Test Loss: 1.509 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 54.205782651901245
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.649 Test Loss: 1.513 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 51.75711703300476
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.656 Test Loss: 1.512 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 50.81875419616699
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.656 Test Loss: 1.510 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 49.721444606781006
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.656 Test Loss: 1.512 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 20142185
model size : 83.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 46.015806913375854
Epoch: 1, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.766 Vali Acc: 0.420 Test Loss: 1.766 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 40.62393641471863
Epoch: 2, Steps: 8 | Train Loss: 1.128 Vali Loss: 1.629 Vali Acc: 0.466 Test Loss: 1.629 Test Acc: 0.466
Validation loss decreased (-0.419830 --> -0.465633).  Saving model ...
Epoch: 3 cost time: 42.51408815383911
Epoch: 3, Steps: 8 | Train Loss: 0.512 Vali Loss: 1.581 Vali Acc: 0.519 Test Loss: 1.581 Test Acc: 0.519
Validation loss decreased (-0.465633 --> -0.519068).  Saving model ...
Epoch: 4 cost time: 43.83166146278381
Epoch: 4, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.644 Vali Acc: 0.534 Test Loss: 1.644 Test Acc: 0.534
Validation loss decreased (-0.519068 --> -0.534335).  Saving model ...
Epoch: 5 cost time: 44.531612396240234
Epoch: 5, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.569 Vali Acc: 0.527 Test Loss: 1.569 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 42.96620178222656
Epoch: 6, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.911 Vali Acc: 0.397 Test Loss: 1.911 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 43.00137710571289
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.388 Vali Acc: 0.565 Test Loss: 2.388 Test Acc: 0.565
Validation loss decreased (-0.534335 --> -0.564862).  Saving model ...
Epoch: 8 cost time: 47.99044728279114
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.049 Vali Acc: 0.527 Test Loss: 2.049 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 45.07986569404602
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.481 Test Loss: 1.850 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 44.740591526031494
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.550 Test Loss: 1.775 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 43.34788417816162
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.519 Test Loss: 1.890 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 42.12929844856262
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.534 Test Loss: 2.001 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 44.0553023815155
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.041 Vali Acc: 0.527 Test Loss: 2.041 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 48.3957359790802
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.043 Vali Acc: 0.542 Test Loss: 2.043 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 42.84172821044922
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.542 Test Loss: 2.049 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 43.112019300460815
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.066 Vali Acc: 0.542 Test Loss: 2.066 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 43.71786403656006
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.080 Vali Acc: 0.542 Test Loss: 2.080 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 19912297
model size : 81.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 31.978952169418335
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.699 Vali Acc: 0.420 Test Loss: 1.699 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 29.372745990753174
Epoch: 2, Steps: 8 | Train Loss: 1.261 Vali Loss: 1.525 Vali Acc: 0.443 Test Loss: 1.525 Test Acc: 0.443
Validation loss decreased (-0.419830 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 31.096317529678345
Epoch: 3, Steps: 8 | Train Loss: 0.808 Vali Loss: 1.985 Vali Acc: 0.328 Test Loss: 1.985 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.122755527496338
Epoch: 4, Steps: 8 | Train Loss: 0.484 Vali Loss: 1.642 Vali Acc: 0.527 Test Loss: 1.642 Test Acc: 0.527
Validation loss decreased (-0.442733 --> -0.526701).  Saving model ...
Epoch: 5 cost time: 29.48706555366516
Epoch: 5, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.635 Vali Acc: 0.450 Test Loss: 1.635 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.770370483398438
Epoch: 6, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.923 Vali Acc: 0.511 Test Loss: 1.923 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 30.919078588485718
Epoch: 7, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.940 Vali Acc: 0.534 Test Loss: 1.940 Test Acc: 0.534
Validation loss decreased (-0.526701 --> -0.534332).  Saving model ...
Epoch: 8 cost time: 31.48398208618164
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.928 Vali Acc: 0.481 Test Loss: 1.928 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 29.155869007110596
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.920 Vali Acc: 0.527 Test Loss: 1.920 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 29.014667749404907
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.817 Vali Acc: 0.519 Test Loss: 1.817 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 29.418134689331055
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.117 Vali Acc: 0.557 Test Loss: 2.117 Test Acc: 0.557
Validation loss decreased (-0.534332 --> -0.557231).  Saving model ...
Epoch: 12 cost time: 28.89678931236267
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.100 Vali Acc: 0.534 Test Loss: 2.100 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 32.42464756965637
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.534 Test Loss: 2.020 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 30.946011543273926
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.078 Vali Acc: 0.534 Test Loss: 2.078 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 32.58387112617493
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.104 Vali Acc: 0.534 Test Loss: 2.104 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 27.292537212371826
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.527 Test Loss: 2.067 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 29.025856018066406
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.527 Test Loss: 2.029 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 27.80474281311035
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.065 Vali Acc: 0.527 Test Loss: 2.065 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 32.4951536655426
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.080 Vali Acc: 0.527 Test Loss: 2.080 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 28.623653173446655
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.527 Test Loss: 2.069 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 29.260356426239014
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.071 Vali Acc: 0.527 Test Loss: 2.071 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 19681897
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.000507593154907
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.683 Vali Acc: 0.420 Test Loss: 1.683 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 18.167493104934692
Epoch: 2, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.438 Vali Acc: 0.405 Test Loss: 1.438 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.983433723449707
Epoch: 3, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.467 Vali Acc: 0.412 Test Loss: 1.467 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.391278743743896
Epoch: 4, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.731 Vali Acc: 0.443 Test Loss: 1.731 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442731).  Saving model ...
Epoch: 5 cost time: 17.583364486694336
Epoch: 5, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.425 Vali Acc: 0.481 Test Loss: 1.425 Test Acc: 0.481
Validation loss decreased (-0.442731 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 20.30445384979248
Epoch: 6, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.711 Vali Acc: 0.481 Test Loss: 1.711 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.314435958862305
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.855 Vali Acc: 0.542 Test Loss: 1.855 Test Acc: 0.542
Validation loss decreased (-0.480902 --> -0.541966).  Saving model ...
Epoch: 8 cost time: 18.67338991165161
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.260 Vali Acc: 0.527 Test Loss: 2.260 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.595991134643555
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.676 Vali Acc: 0.534 Test Loss: 2.676 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.46315050125122
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.504 Test Loss: 1.822 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.7013840675354
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.534 Test Loss: 1.917 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.25446653366089
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.239 Vali Acc: 0.527 Test Loss: 2.239 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 18.765020608901978
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.412 Vali Acc: 0.534 Test Loss: 2.412 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 19.189770698547363
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.534 Test Loss: 2.402 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.842473030090332
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.328 Vali Acc: 0.527 Test Loss: 2.328 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 19.08328676223755
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.254 Vali Acc: 0.534 Test Loss: 2.254 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.281939268112183
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.236 Vali Acc: 0.534 Test Loss: 2.236 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 19452009
model size : 77.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.109582424163818
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 2.048 Vali Acc: 0.420 Test Loss: 2.048 Test Acc: 0.420
Validation loss decreased (inf --> -0.419827).  Saving model ...
Epoch: 2 cost time: 10.558790445327759
Epoch: 2, Steps: 8 | Train Loss: 1.277 Vali Loss: 1.517 Vali Acc: 0.458 Test Loss: 1.517 Test Acc: 0.458
Validation loss decreased (-0.419827 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 10.772513151168823
Epoch: 3, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.488 Vali Acc: 0.496 Test Loss: 1.488 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 11.395958185195923
Epoch: 4, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.741 Vali Acc: 0.519 Test Loss: 1.741 Test Acc: 0.519
Validation loss decreased (-0.496168 --> -0.519067).  Saving model ...
Epoch: 5 cost time: 11.622997522354126
Epoch: 5, Steps: 8 | Train Loss: 0.044 Vali Loss: 2.032 Vali Acc: 0.511 Test Loss: 2.032 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.538548707962036
Epoch: 6, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.836 Vali Acc: 0.534 Test Loss: 1.836 Test Acc: 0.534
Validation loss decreased (-0.519067 --> -0.534333).  Saving model ...
Epoch: 7 cost time: 10.19711446762085
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.798 Vali Acc: 0.511 Test Loss: 1.798 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.79507040977478
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.511 Test Loss: 1.966 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.136889457702637
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.370 Vali Acc: 0.527 Test Loss: 2.370 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.501385688781738
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.208 Vali Acc: 0.527 Test Loss: 2.208 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.930340051651001
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.542 Test Loss: 2.055 Test Acc: 0.542
Validation loss decreased (-0.534333 --> -0.541964).  Saving model ...
Epoch: 12 cost time: 11.346679210662842
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.527 Test Loss: 2.067 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.935668706893921
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.148 Vali Acc: 0.519 Test Loss: 2.148 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.699335098266602
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.222 Vali Acc: 0.527 Test Loss: 2.222 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.603513240814209
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.214 Vali Acc: 0.519 Test Loss: 2.214 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.56438660621643
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.519 Test Loss: 2.182 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.600564241409302
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.519 Test Loss: 2.203 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.111759424209595
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.226 Vali Acc: 0.519 Test Loss: 2.226 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.9835684299469
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.226 Vali Acc: 0.519 Test Loss: 2.226 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.158654928207397
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.246 Vali Acc: 0.519 Test Loss: 2.246 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.777645349502563
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.254 Vali Acc: 0.527 Test Loss: 2.254 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 19267689
model size : 75.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.76017951965332
Epoch: 1, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.619 Vali Acc: 0.435 Test Loss: 1.619 Test Acc: 0.435
Validation loss decreased (inf --> -0.435098).  Saving model ...
Epoch: 2 cost time: 7.418548107147217
Epoch: 2, Steps: 8 | Train Loss: 1.008 Vali Loss: 1.272 Vali Acc: 0.565 Test Loss: 1.272 Test Acc: 0.565
Validation loss decreased (-0.435098 --> -0.564873).  Saving model ...
Epoch: 3 cost time: 7.168112754821777
Epoch: 3, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.188 Vali Acc: 0.588 Test Loss: 1.188 Test Acc: 0.588
Validation loss decreased (-0.564873 --> -0.587774).  Saving model ...
Epoch: 4 cost time: 7.078248023986816
Epoch: 4, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.152 Vali Acc: 0.588 Test Loss: 1.152 Test Acc: 0.588
Validation loss decreased (-0.587774 --> -0.587775).  Saving model ...
Epoch: 5 cost time: 7.716570138931274
Epoch: 5, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.151 Vali Acc: 0.580 Test Loss: 1.151 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.849364757537842
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.419 Vali Acc: 0.603 Test Loss: 1.419 Test Acc: 0.603
Validation loss decreased (-0.587775 --> -0.603039).  Saving model ...
Epoch: 7 cost time: 7.762364149093628
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.595 Test Loss: 1.507 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.44027853012085
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.595 Test Loss: 1.366 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.495481967926025
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.588 Test Loss: 1.356 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.89595890045166
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.595 Test Loss: 1.408 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.690468072891235
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.588 Test Loss: 1.444 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.33165955543518
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.588 Test Loss: 1.438 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.012535333633423
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.595 Test Loss: 1.419 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.664811372756958
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.595 Test Loss: 1.409 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.913344383239746
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.595 Test Loss: 1.406 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.63172197341919
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.595 Test Loss: 1.418 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 19175529
model size : 74.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.442701101303101
Epoch: 1, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.609 Vali Acc: 0.420 Test Loss: 1.609 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 3.700038433074951
Epoch: 2, Steps: 8 | Train Loss: 1.320 Vali Loss: 1.543 Vali Acc: 0.473 Test Loss: 1.543 Test Acc: 0.473
Validation loss decreased (-0.419831 --> -0.473267).  Saving model ...
Epoch: 3 cost time: 4.242610692977905
Epoch: 3, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.516 Vali Acc: 0.389 Test Loss: 1.516 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.119481563568115
Epoch: 4, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
Validation loss decreased (-0.473267 --> -0.549602).  Saving model ...
Epoch: 5 cost time: 3.8288025856018066
Epoch: 5, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.447 Vali Acc: 0.443 Test Loss: 1.447 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.764895439147949
Epoch: 6, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.077 Vali Acc: 0.435 Test Loss: 2.077 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8283438682556152
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.253 Vali Acc: 0.542 Test Loss: 2.253 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.828673839569092
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.793 Vali Acc: 0.542 Test Loss: 1.793 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9620940685272217
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.981 Vali Acc: 0.534 Test Loss: 1.981 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.1512157917022705
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.229 Vali Acc: 0.542 Test Loss: 2.229 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.363193988800049
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.542 Test Loss: 2.122 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.040957450866699
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.027 Vali Acc: 0.527 Test Loss: 2.027 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.18052864074707
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.527 Test Loss: 2.026 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.073100328445435
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.550 Test Loss: 2.106 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 19083369
model size : 73.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.142021894454956
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.638 Vali Acc: 0.412 Test Loss: 1.638 Test Acc: 0.412
Validation loss decreased (inf --> -0.412197).  Saving model ...
Epoch: 2 cost time: 0.995830774307251
Epoch: 2, Steps: 8 | Train Loss: 0.854 Vali Loss: 1.554 Vali Acc: 0.397 Test Loss: 1.554 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0335767269134521
Epoch: 3, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.716 Vali Acc: 0.527 Test Loss: 1.716 Test Acc: 0.527
Validation loss decreased (-0.412197 --> -0.526700).  Saving model ...
Epoch: 4 cost time: 1.0134079456329346
Epoch: 4, Steps: 8 | Train Loss: 0.031 Vali Loss: 2.419 Vali Acc: 0.527 Test Loss: 2.419 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0188114643096924
Epoch: 5, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.677 Vali Acc: 0.427 Test Loss: 2.677 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0826385021209717
Epoch: 6, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.491 Vali Acc: 0.458 Test Loss: 2.491 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1484613418579102
Epoch: 7, Steps: 8 | Train Loss: 0.036 Vali Loss: 4.040 Vali Acc: 0.427 Test Loss: 4.040 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9862687587738037
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 3.480 Vali Acc: 0.298 Test Loss: 3.480 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.040034532546997
Epoch: 9, Steps: 8 | Train Loss: 0.045 Vali Loss: 4.304 Vali Acc: 0.489 Test Loss: 4.304 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0702147483825684
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 2.839 Vali Acc: 0.511 Test Loss: 2.839 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.045992374420166
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 3.911 Vali Acc: 0.412 Test Loss: 3.911 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0228753089904785
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 4.366 Vali Acc: 0.450 Test Loss: 4.366 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0470972061157227
Epoch: 13, Steps: 8 | Train Loss: 0.140 Vali Loss: 5.160 Vali Acc: 0.359 Test Loss: 5.160 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 18991721
model size : 72.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 56.27153944969177
Epoch: 1, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.719 Vali Acc: 0.420 Test Loss: 1.719 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 49.27960538864136
Epoch: 2, Steps: 8 | Train Loss: 0.697 Vali Loss: 1.444 Vali Acc: 0.496 Test Loss: 1.444 Test Acc: 0.496
Validation loss decreased (-0.419830 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 50.38667392730713
Epoch: 3, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.744 Vali Acc: 0.527 Test Loss: 1.744 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526700).  Saving model ...
Epoch: 4 cost time: 46.218990087509155
Epoch: 4, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.297 Vali Acc: 0.519 Test Loss: 2.297 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 50.301153898239136
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.603 Vali Acc: 0.519 Test Loss: 2.603 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 50.06699514389038
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.704 Vali Acc: 0.519 Test Loss: 2.704 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 50.577433586120605
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.519 Test Loss: 2.703 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 47.07710289955139
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.519 Test Loss: 2.677 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 51.078835248947144
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.638 Vali Acc: 0.519 Test Loss: 2.638 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 52.89207744598389
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.611 Vali Acc: 0.519 Test Loss: 2.611 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 48.00442981719971
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.519 Test Loss: 2.584 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 49.00776743888855
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.562 Vali Acc: 0.519 Test Loss: 2.562 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 52.61307144165039
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.547 Vali Acc: 0.519 Test Loss: 2.547 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 20142121
model size : 83.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 40.62278413772583
Epoch: 1, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.628 Vali Acc: 0.420 Test Loss: 1.628 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 37.800281047821045
Epoch: 2, Steps: 8 | Train Loss: 0.685 Vali Loss: 1.284 Vali Acc: 0.550 Test Loss: 1.284 Test Acc: 0.550
Validation loss decreased (-0.419831 --> -0.549605).  Saving model ...
Epoch: 3 cost time: 39.35120892524719
Epoch: 3, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.598 Vali Acc: 0.527 Test Loss: 1.598 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 41.533454179763794
Epoch: 4, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.885 Vali Acc: 0.527 Test Loss: 1.885 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 37.812848806381226
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.519 Test Loss: 2.122 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 38.49681115150452
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.245 Vali Acc: 0.519 Test Loss: 2.245 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 36.282795429229736
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.288 Vali Acc: 0.519 Test Loss: 2.288 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 39.845542907714844
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.292 Vali Acc: 0.519 Test Loss: 2.292 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 37.999500036239624
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.282 Vali Acc: 0.519 Test Loss: 2.282 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 38.549089431762695
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.519 Test Loss: 2.267 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 38.903839349746704
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.247 Vali Acc: 0.519 Test Loss: 2.247 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 37.46641659736633
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.238 Vali Acc: 0.519 Test Loss: 2.238 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 19912233
model size : 81.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 35.09763813018799
Epoch: 1, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.701 Vali Acc: 0.420 Test Loss: 1.701 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 29.942384004592896
Epoch: 2, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.433 Vali Acc: 0.328 Test Loss: 1.433 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.902897119522095
Epoch: 3, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.693 Vali Acc: 0.519 Test Loss: 1.693 Test Acc: 0.519
Validation loss decreased (-0.419830 --> -0.519067).  Saving model ...
Epoch: 4 cost time: 28.36196804046631
Epoch: 4, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.740 Vali Acc: 0.519 Test Loss: 1.740 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.33877468109131
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.063 Vali Acc: 0.511 Test Loss: 3.063 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 33.838860750198364
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.255 Vali Acc: 0.511 Test Loss: 3.255 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 29.955339908599854
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.925 Vali Acc: 0.519 Test Loss: 2.925 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 30.29590129852295
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.699 Vali Acc: 0.519 Test Loss: 2.699 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 25.889172077178955
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.566 Vali Acc: 0.519 Test Loss: 2.566 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.221308708190918
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.499 Vali Acc: 0.519 Test Loss: 2.499 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 27.892823219299316
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.471 Vali Acc: 0.519 Test Loss: 2.471 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 29.16004753112793
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.519 Test Loss: 2.457 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 30.680843353271484
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.457 Vali Acc: 0.519 Test Loss: 2.457 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 19681833
model size : 79.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.118691205978394
Epoch: 1, Steps: 8 | Train Loss: 1.491 Vali Loss: 1.735 Vali Acc: 0.427 Test Loss: 1.735 Test Acc: 0.427
Validation loss decreased (inf --> -0.427464).  Saving model ...
Epoch: 2 cost time: 18.370285749435425
Epoch: 2, Steps: 8 | Train Loss: 0.707 Vali Loss: 1.402 Vali Acc: 0.412 Test Loss: 1.402 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.666517734527588
Epoch: 3, Steps: 8 | Train Loss: 0.093 Vali Loss: 2.117 Vali Acc: 0.504 Test Loss: 2.117 Test Acc: 0.504
Validation loss decreased (-0.427464 --> -0.503796).  Saving model ...
Epoch: 4 cost time: 19.02402400970459
Epoch: 4, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.784 Vali Acc: 0.527 Test Loss: 1.784 Test Acc: 0.527
Validation loss decreased (-0.503796 --> -0.526700).  Saving model ...
Epoch: 5 cost time: 19.281346559524536
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.975 Vali Acc: 0.527 Test Loss: 1.975 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.55888319015503
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.170 Vali Acc: 0.527 Test Loss: 2.170 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.06030249595642
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.236 Vali Acc: 0.527 Test Loss: 2.236 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.517728090286255
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.255 Vali Acc: 0.527 Test Loss: 2.255 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.953503370285034
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.266 Vali Acc: 0.527 Test Loss: 2.266 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 19.357383966445923
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.270 Vali Acc: 0.527 Test Loss: 2.270 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 19.089762449264526
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.527 Test Loss: 2.267 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.78276538848877
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.527 Test Loss: 2.263 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 17.86752414703369
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.527 Test Loss: 2.263 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 17.986754894256592
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.261 Vali Acc: 0.527 Test Loss: 2.261 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 19451945
model size : 77.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.104050874710083
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.642 Vali Acc: 0.420 Test Loss: 1.642 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 10.515216827392578
Epoch: 2, Steps: 8 | Train Loss: 0.699 Vali Loss: 1.361 Vali Acc: 0.527 Test Loss: 1.361 Test Acc: 0.527
Validation loss decreased (-0.419831 --> -0.526704).  Saving model ...
Epoch: 3 cost time: 12.023236989974976
Epoch: 3, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.802769899368286
Epoch: 4, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.992 Vali Acc: 0.511 Test Loss: 1.992 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.466753959655762
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.143 Vali Acc: 0.511 Test Loss: 3.143 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.566415071487427
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.379 Vali Acc: 0.519 Test Loss: 3.379 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.169526815414429
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.779 Vali Acc: 0.519 Test Loss: 2.779 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.940990209579468
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.473 Vali Acc: 0.519 Test Loss: 2.473 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.330697774887085
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.333 Vali Acc: 0.519 Test Loss: 2.333 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.16924238204956
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.275 Vali Acc: 0.519 Test Loss: 2.275 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.8582763671875
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.259 Vali Acc: 0.519 Test Loss: 2.259 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.187919616699219
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.519 Test Loss: 2.267 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 19267625
model size : 75.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.523107528686523
Epoch: 1, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.805 Vali Acc: 0.420 Test Loss: 1.805 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 7.1814351081848145
Epoch: 2, Steps: 8 | Train Loss: 0.735 Vali Loss: 1.430 Vali Acc: 0.405 Test Loss: 1.430 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.6005120277404785
Epoch: 3, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.738 Vali Acc: 0.519 Test Loss: 1.738 Test Acc: 0.519
Validation loss decreased (-0.419829 --> -0.519067).  Saving model ...
Epoch: 4 cost time: 8.084685325622559
Epoch: 4, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.990 Vali Acc: 0.519 Test Loss: 1.990 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.802687883377075
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.469 Vali Acc: 0.519 Test Loss: 2.469 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.938152551651001
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.519 Test Loss: 2.802 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.27679705619812
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.936 Vali Acc: 0.519 Test Loss: 2.936 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.351976633071899
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.954 Vali Acc: 0.519 Test Loss: 2.954 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.331469297409058
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.922 Vali Acc: 0.519 Test Loss: 2.922 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.113646984100342
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.875 Vali Acc: 0.519 Test Loss: 2.875 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.427528619766235
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.825 Vali Acc: 0.519 Test Loss: 2.825 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.5542542934417725
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.784 Vali Acc: 0.519 Test Loss: 2.784 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.756004571914673
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.748 Vali Acc: 0.519 Test Loss: 2.748 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 19175465
model size : 74.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.353396654129028
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.653 Vali Acc: 0.420 Test Loss: 1.653 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 4.200977325439453
Epoch: 2, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.417 Vali Acc: 0.389 Test Loss: 1.417 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.577913522720337
Epoch: 3, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.746 Vali Acc: 0.519 Test Loss: 1.746 Test Acc: 0.519
Validation loss decreased (-0.419831 --> -0.519067).  Saving model ...
Epoch: 4 cost time: 3.711677074432373
Epoch: 4, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.859 Vali Acc: 0.519 Test Loss: 1.859 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.34076452255249
Epoch: 5, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.519 Test Loss: 2.449 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8668062686920166
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.856 Vali Acc: 0.519 Test Loss: 2.856 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9207839965820312
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.519 Test Loss: 3.029 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7637691497802734
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.077 Vali Acc: 0.519 Test Loss: 3.077 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.852895975112915
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.051 Vali Acc: 0.519 Test Loss: 3.051 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.7892720699310303
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 3.004 Vali Acc: 0.519 Test Loss: 3.004 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.9763758182525635
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.955 Vali Acc: 0.519 Test Loss: 2.955 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.9509830474853516
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.904 Vali Acc: 0.519 Test Loss: 2.904 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.1020660400390625
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.862 Vali Acc: 0.519 Test Loss: 2.862 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 19083305
model size : 73.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 1.898141860961914
Epoch: 1, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.690 Vali Acc: 0.443 Test Loss: 1.690 Test Acc: 0.443
Validation loss decreased (inf --> -0.442731).  Saving model ...
Epoch: 2 cost time: 0.767399787902832
Epoch: 2, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.444 Vali Acc: 0.489 Test Loss: 1.444 Test Acc: 0.489
Validation loss decreased (-0.442731 --> -0.488535).  Saving model ...
Epoch: 3 cost time: 0.807319164276123
Epoch: 3, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.911 Vali Acc: 0.466 Test Loss: 1.911 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8037562370300293
Epoch: 4, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.382 Vali Acc: 0.481 Test Loss: 2.382 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8057239055633545
Epoch: 5, Steps: 8 | Train Loss: 0.049 Vali Loss: 3.072 Vali Acc: 0.504 Test Loss: 3.072 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503786).  Saving model ...
Epoch: 6 cost time: 0.8329963684082031
Epoch: 6, Steps: 8 | Train Loss: 0.134 Vali Loss: 3.337 Vali Acc: 0.473 Test Loss: 3.337 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7817270755767822
Epoch: 7, Steps: 8 | Train Loss: 0.094 Vali Loss: 3.344 Vali Acc: 0.412 Test Loss: 3.344 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8006961345672607
Epoch: 8, Steps: 8 | Train Loss: 0.065 Vali Loss: 3.724 Vali Acc: 0.427 Test Loss: 3.724 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7768089771270752
Epoch: 9, Steps: 8 | Train Loss: 0.120 Vali Loss: 4.373 Vali Acc: 0.389 Test Loss: 4.373 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7463686466217041
Epoch: 10, Steps: 8 | Train Loss: 0.049 Vali Loss: 5.120 Vali Acc: 0.405 Test Loss: 5.120 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7921383380889893
Epoch: 11, Steps: 8 | Train Loss: 0.110 Vali Loss: 5.651 Vali Acc: 0.405 Test Loss: 5.651 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.751070499420166
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 6.232 Vali Acc: 0.397 Test Loss: 6.232 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7541131973266602
Epoch: 13, Steps: 8 | Train Loss: 0.130 Vali Loss: 5.894 Vali Acc: 0.466 Test Loss: 5.894 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7848155498504639
Epoch: 14, Steps: 8 | Train Loss: 0.204 Vali Loss: 6.732 Vali Acc: 0.397 Test Loss: 6.732 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7682232856750488
Epoch: 15, Steps: 8 | Train Loss: 0.147 Vali Loss: 7.640 Vali Acc: 0.435 Test Loss: 7.640 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 18991657
model size : 72.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 54.855915546417236
Epoch: 1, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 48.181610345840454
Epoch: 2, Steps: 8 | Train Loss: 1.172 Vali Loss: 1.517 Vali Acc: 0.351 Test Loss: 1.517 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 47.433605670928955
Epoch: 3, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.803 Vali Acc: 0.290 Test Loss: 1.803 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 50.59778714179993
Epoch: 4, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.403 Vali Acc: 0.450 Test Loss: 1.403 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450368).  Saving model ...
Epoch: 5 cost time: 49.65485239028931
Epoch: 5, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.606 Vali Acc: 0.466 Test Loss: 1.606 Test Acc: 0.466
Validation loss decreased (-0.450368 --> -0.465633).  Saving model ...
Epoch: 6 cost time: 48.59503722190857
Epoch: 6, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.245 Vali Acc: 0.519 Test Loss: 2.245 Test Acc: 0.519
Validation loss decreased (-0.465633 --> -0.519062).  Saving model ...
Epoch: 7 cost time: 48.78107786178589
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.460 Vali Acc: 0.412 Test Loss: 2.460 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 50.54045581817627
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.032 Vali Acc: 0.511 Test Loss: 2.032 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 47.59333896636963
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.108 Vali Acc: 0.511 Test Loss: 2.108 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 44.16278648376465
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.542 Test Loss: 2.013 Test Acc: 0.542
Validation loss decreased (-0.519062 --> -0.541965).  Saving model ...
Epoch: 11 cost time: 47.562084674835205
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.519 Test Loss: 2.018 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 49.01806044578552
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.527 Test Loss: 2.090 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 44.06314516067505
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.534 Test Loss: 2.150 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 46.927263498306274
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.185 Vali Acc: 0.550 Test Loss: 2.185 Test Acc: 0.550
Validation loss decreased (-0.541965 --> -0.549596).  Saving model ...
Epoch: 15 cost time: 49.76934885978699
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.178 Vali Acc: 0.550 Test Loss: 2.178 Test Acc: 0.550
Validation loss decreased (-0.549596 --> -0.549597).  Saving model ...
Epoch: 16 cost time: 50.36461591720581
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.160 Vali Acc: 0.534 Test Loss: 2.160 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 50.90050029754639
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.519 Test Loss: 2.146 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 51.09000778198242
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.519 Test Loss: 2.135 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 49.74243354797363
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.134 Vali Acc: 0.527 Test Loss: 2.134 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 46.12899041175842
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.139 Vali Acc: 0.534 Test Loss: 2.139 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 46.68282389640808
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.133 Vali Acc: 0.527 Test Loss: 2.133 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 49.562689542770386
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.534 Test Loss: 2.140 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 49.04970407485962
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.145 Vali Acc: 0.534 Test Loss: 2.145 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 46.16298270225525
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.151 Vali Acc: 0.527 Test Loss: 2.151 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 46.625913858413696
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.145 Vali Acc: 0.527 Test Loss: 2.145 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w2248_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 10358941
model size : 46.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 40.64102506637573
Epoch: 1, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.598 Vali Acc: 0.427 Test Loss: 1.598 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 40.17903232574463
Epoch: 2, Steps: 8 | Train Loss: 1.109 Vali Loss: 1.620 Vali Acc: 0.466 Test Loss: 1.620 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465633).  Saving model ...
Epoch: 3 cost time: 36.635737657547
Epoch: 3, Steps: 8 | Train Loss: 0.480 Vali Loss: 1.713 Vali Acc: 0.496 Test Loss: 1.713 Test Acc: 0.496
Validation loss decreased (-0.465633 --> -0.496166).  Saving model ...
Epoch: 4 cost time: 40.09140729904175
Epoch: 4, Steps: 8 | Train Loss: 0.168 Vali Loss: 2.223 Vali Acc: 0.496 Test Loss: 2.223 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 36.769036293029785
Epoch: 5, Steps: 8 | Train Loss: 0.055 Vali Loss: 2.575 Vali Acc: 0.527 Test Loss: 2.575 Test Acc: 0.527
Validation loss decreased (-0.496166 --> -0.526692).  Saving model ...
Epoch: 6 cost time: 38.775259256362915
Epoch: 6, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.216 Vali Acc: 0.504 Test Loss: 2.216 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 38.807295083999634
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.079 Vali Acc: 0.504 Test Loss: 2.079 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 36.120410203933716
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.797 Vali Acc: 0.511 Test Loss: 2.797 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 39.85955095291138
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.179 Vali Acc: 0.519 Test Loss: 3.179 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 38.14363098144531
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.888 Vali Acc: 0.519 Test Loss: 2.888 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 39.722378969192505
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.764 Vali Acc: 0.519 Test Loss: 2.764 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 37.477022886276245
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.837 Vali Acc: 0.519 Test Loss: 2.837 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 37.13659453392029
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.519 Test Loss: 2.888 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 39.74192762374878
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.896 Vali Acc: 0.519 Test Loss: 2.896 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 37.50923776626587
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.817 Vali Acc: 0.511 Test Loss: 2.817 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1799_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 10243997
model size : 44.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 29.270837545394897
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.565 Vali Acc: 0.427 Test Loss: 1.565 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 27.970194339752197
Epoch: 2, Steps: 8 | Train Loss: 1.020 Vali Loss: 1.452 Vali Acc: 0.496 Test Loss: 1.452 Test Acc: 0.496
Validation loss decreased (-0.427465 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 29.05407691001892
Epoch: 3, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.421 Vali Acc: 0.573 Test Loss: 1.421 Test Acc: 0.573
Validation loss decreased (-0.496169 --> -0.572505).  Saving model ...
Epoch: 4 cost time: 26.878106594085693
Epoch: 4, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.403 Vali Acc: 0.534 Test Loss: 1.403 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.426985502243042
Epoch: 5, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.464 Vali Acc: 0.542 Test Loss: 1.464 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.44604516029358
Epoch: 6, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.644 Vali Acc: 0.557 Test Loss: 1.644 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.985507488250732
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.104 Vali Acc: 0.565 Test Loss: 2.104 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.86191463470459
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.048 Vali Acc: 0.565 Test Loss: 2.048 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 27.398847103118896
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.557 Test Loss: 1.855 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.07254147529602
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.565 Test Loss: 1.767 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 28.707200288772583
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.565 Test Loss: 1.768 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 28.651222944259644
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.557 Test Loss: 1.813 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 27.030710220336914
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.850 Vali Acc: 0.557 Test Loss: 1.850 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1349_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 10128797
model size : 42.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.054524660110474
Epoch: 1, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.566 Vali Acc: 0.412 Test Loss: 1.566 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 17.75447154045105
Epoch: 2, Steps: 8 | Train Loss: 1.085 Vali Loss: 1.555 Vali Acc: 0.466 Test Loss: 1.555 Test Acc: 0.466
Validation loss decreased (-0.412198 --> -0.465633).  Saving model ...
Epoch: 3 cost time: 17.860242128372192
Epoch: 3, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.662 Vali Acc: 0.504 Test Loss: 1.662 Test Acc: 0.504
Validation loss decreased (-0.465633 --> -0.503800).  Saving model ...
Epoch: 4 cost time: 19.912013292312622
Epoch: 4, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.487 Vali Acc: 0.542 Test Loss: 1.487 Test Acc: 0.542
Validation loss decreased (-0.503800 --> -0.541970).  Saving model ...
Epoch: 5 cost time: 21.174898624420166
Epoch: 5, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.677 Vali Acc: 0.496 Test Loss: 1.677 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.276206016540527
Epoch: 6, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.934 Vali Acc: 0.542 Test Loss: 1.934 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.56264019012451
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.519 Test Loss: 1.679 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.340461015701294
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.527 Test Loss: 1.739 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 18.77202558517456
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.565 Test Loss: 1.918 Test Acc: 0.565
Validation loss decreased (-0.541970 --> -0.564866).  Saving model ...
Epoch: 10 cost time: 18.183090925216675
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.542 Test Loss: 2.006 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.539854049682617
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.550 Test Loss: 1.966 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.851946592330933
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.557 Test Loss: 1.944 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 18.308274507522583
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.557 Test Loss: 1.957 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 20.723118543624878
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.557 Test Loss: 1.990 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 19.835004806518555
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.557 Test Loss: 2.005 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.747110605239868
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.557 Test Loss: 2.026 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 21.28876805305481
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.557 Test Loss: 2.009 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 19.202672719955444
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.002 Vali Acc: 0.557 Test Loss: 2.002 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.980473279953003
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.557 Test Loss: 2.020 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w900_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 10013853
model size : 41.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.576286315917969
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.603 Vali Acc: 0.420 Test Loss: 1.603 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 11.244477272033691
Epoch: 2, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.460 Vali Acc: 0.481 Test Loss: 1.460 Test Acc: 0.481
Validation loss decreased (-0.419831 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 11.331635475158691
Epoch: 3, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.369 Vali Acc: 0.557 Test Loss: 1.369 Test Acc: 0.557
Validation loss decreased (-0.480901 --> -0.557238).  Saving model ...
Epoch: 4 cost time: 11.191269397735596
Epoch: 4, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.581 Vali Acc: 0.534 Test Loss: 1.581 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.375463247299194
Epoch: 5, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.629 Vali Acc: 0.573 Test Loss: 1.629 Test Acc: 0.573
Validation loss decreased (-0.557238 --> -0.572503).  Saving model ...
Epoch: 6 cost time: 13.1338472366333
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.925 Vali Acc: 0.550 Test Loss: 1.925 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.119284629821777
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.070 Vali Acc: 0.550 Test Loss: 2.070 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.944793939590454
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.059 Vali Acc: 0.542 Test Loss: 2.059 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.240905523300171
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.534 Test Loss: 2.069 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.069521188735962
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.096 Vali Acc: 0.534 Test Loss: 2.096 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.883129835128784
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.116 Vali Acc: 0.534 Test Loss: 2.116 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.306976556777954
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.542 Test Loss: 2.129 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.96144986152649
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.125 Vali Acc: 0.542 Test Loss: 2.125 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.881258726119995
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.115 Vali Acc: 0.542 Test Loss: 2.115 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.185970306396484
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.116 Vali Acc: 0.542 Test Loss: 2.116 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w540_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 9921693
model size : 39.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.941110134124756
Epoch: 1, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 8.028431177139282
Epoch: 2, Steps: 8 | Train Loss: 1.027 Vali Loss: 1.333 Vali Acc: 0.542 Test Loss: 1.333 Test Acc: 0.542
Validation loss decreased (-0.419832 --> -0.541971).  Saving model ...
Epoch: 3 cost time: 8.780815601348877
Epoch: 3, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.279 Vali Acc: 0.466 Test Loss: 1.279 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.071303367614746
Epoch: 4, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.154 Vali Acc: 0.588 Test Loss: 1.154 Test Acc: 0.588
Validation loss decreased (-0.541971 --> -0.587775).  Saving model ...
Epoch: 5 cost time: 9.498295068740845
Epoch: 5, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.458 Vali Acc: 0.511 Test Loss: 1.458 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.23063325881958
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.278 Vali Acc: 0.542 Test Loss: 1.278 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.32524299621582
Epoch: 7, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.580 Test Loss: 1.317 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.820019721984863
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.588 Test Loss: 1.332 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.944723606109619
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.580 Test Loss: 1.317 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.141407012939453
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.595 Test Loss: 1.315 Test Acc: 0.595
Validation loss decreased (-0.587775 --> -0.595407).  Saving model ...
Epoch: 11 cost time: 7.52236533164978
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.588 Test Loss: 1.320 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.749849081039429
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.603 Test Loss: 1.324 Test Acc: 0.603
Validation loss decreased (-0.595407 --> -0.603040).  Saving model ...
Epoch: 13 cost time: 8.035809516906738
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.611 Test Loss: 1.323 Test Acc: 0.611
Validation loss decreased (-0.603040 --> -0.610674).  Saving model ...
Epoch: 14 cost time: 7.642635345458984
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.611 Test Loss: 1.317 Test Acc: 0.611
Validation loss decreased (-0.610674 --> -0.610674).  Saving model ...
Epoch: 15 cost time: 8.401150941848755
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.611 Test Loss: 1.317 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.957694053649902
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.611 Test Loss: 1.316 Test Acc: 0.611
Validation loss decreased (-0.610674 --> -0.610674).  Saving model ...
Epoch: 17 cost time: 7.468632936477661
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.603 Test Loss: 1.317 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.312509775161743
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.603 Test Loss: 1.319 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.499308824539185
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.603 Test Loss: 1.320 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.273026466369629
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.603 Test Loss: 1.320 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.440611600875854
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.323 Vali Acc: 0.603 Test Loss: 1.323 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.197094917297363
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.603 Test Loss: 1.322 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.166241884231567
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.603 Test Loss: 1.327 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.166296243667603
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.603 Test Loss: 1.328 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 8.004941940307617
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.603 Test Loss: 1.329 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.419962882995605
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.332 Vali Acc: 0.603 Test Loss: 1.332 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w360_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 9875613
model size : 38.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.258510589599609
Epoch: 1, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.670 Vali Acc: 0.420 Test Loss: 1.670 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 4.112614631652832
Epoch: 2, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.476 Vali Acc: 0.389 Test Loss: 1.476 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.275039911270142
Epoch: 3, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.446 Vali Acc: 0.443 Test Loss: 1.446 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442734).  Saving model ...
Epoch: 4 cost time: 4.319044828414917
Epoch: 4, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.342 Vali Acc: 0.550 Test Loss: 1.342 Test Acc: 0.550
Validation loss decreased (-0.442734 --> -0.549605).  Saving model ...
Epoch: 5 cost time: 4.123270511627197
Epoch: 5, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.398 Vali Acc: 0.573 Test Loss: 1.398 Test Acc: 0.573
Validation loss decreased (-0.549605 --> -0.572505).  Saving model ...
Epoch: 6 cost time: 4.1565773487091064
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.392 Vali Acc: 0.565 Test Loss: 1.392 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.93485689163208
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.557 Test Loss: 1.500 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7502801418304443
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.550 Test Loss: 1.609 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7731966972351074
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.542 Test Loss: 1.638 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.694092273712158
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.534 Test Loss: 1.620 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.87868332862854
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.534 Test Loss: 1.602 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9826738834381104
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.542 Test Loss: 1.592 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.363045930862427
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.542 Test Loss: 1.586 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.14418625831604
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.542 Test Loss: 1.590 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.9720919132232666
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.542 Test Loss: 1.583 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w180_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 9829533
model size : 38.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2138960361480713
Epoch: 1, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.631 Vali Acc: 0.420 Test Loss: 1.631 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9956159591674805
Epoch: 2, Steps: 8 | Train Loss: 0.701 Vali Loss: 1.224 Vali Acc: 0.534 Test Loss: 1.224 Test Acc: 0.534
Validation loss decreased (-0.419831 --> -0.534339).  Saving model ...
Epoch: 3 cost time: 0.9626195430755615
Epoch: 3, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.274 Vali Acc: 0.557 Test Loss: 1.274 Test Acc: 0.557
Validation loss decreased (-0.534339 --> -0.557239).  Saving model ...
Epoch: 4 cost time: 1.0502638816833496
Epoch: 4, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.504 Vali Acc: 0.466 Test Loss: 1.504 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9785687923431396
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.565 Test Loss: 1.609 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564869).  Saving model ...
Epoch: 6 cost time: 1.0205292701721191
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.588 Test Loss: 1.767 Test Acc: 0.588
Validation loss decreased (-0.564869 --> -0.587769).  Saving model ...
Epoch: 7 cost time: 0.9796664714813232
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.573 Test Loss: 1.763 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9244003295898438
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.557 Test Loss: 1.735 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.955019474029541
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.557 Test Loss: 1.711 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9666345119476318
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.699 Vali Acc: 0.557 Test Loss: 1.699 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9690189361572266
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.557 Test Loss: 1.696 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9542219638824463
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.557 Test Loss: 1.697 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9594252109527588
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.557 Test Loss: 1.700 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9833552837371826
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.703 Vali Acc: 0.557 Test Loss: 1.703 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9560997486114502
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.557 Test Loss: 1.707 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.012824535369873
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.557 Test Loss: 1.712 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 9783709
model size : 37.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.68896532058716
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.503 Vali Acc: 0.435 Test Loss: 1.503 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 50.34695339202881
Epoch: 2, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.735 Vali Acc: 0.420 Test Loss: 1.735 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 46.31721782684326
Epoch: 3, Steps: 8 | Train Loss: 0.763 Vali Loss: 1.439 Vali Acc: 0.496 Test Loss: 1.439 Test Acc: 0.496
Validation loss decreased (-0.435099 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 49.857237339019775
Epoch: 4, Steps: 8 | Train Loss: 0.450 Vali Loss: 1.587 Vali Acc: 0.427 Test Loss: 1.587 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 51.99664378166199
Epoch: 5, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.518 Vali Acc: 0.496 Test Loss: 1.518 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 48.18565559387207
Epoch: 6, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.560 Vali Acc: 0.550 Test Loss: 1.560 Test Acc: 0.550
Validation loss decreased (-0.496169 --> -0.549603).  Saving model ...
Epoch: 7 cost time: 46.98899602890015
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.847 Vali Acc: 0.504 Test Loss: 1.847 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 48.62333965301514
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.542 Vali Acc: 0.435 Test Loss: 1.542 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 52.59936189651489
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.078 Vali Acc: 0.534 Test Loss: 2.078 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 48.49834156036377
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.059 Vali Acc: 0.534 Test Loss: 2.059 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 46.89487600326538
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.005 Vali Acc: 0.511 Test Loss: 2.005 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 51.611868381500244
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.042 Vali Acc: 0.511 Test Loss: 2.042 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 53.264527320861816
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.550 Test Loss: 2.067 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 48.57156777381897
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.550 Test Loss: 1.962 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 48.76117658615112
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.550 Test Loss: 1.927 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 48.40202355384827
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.550 Test Loss: 1.970 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w2248_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 10358889
model size : 46.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 44.12118887901306
Epoch: 1, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.711 Vali Acc: 0.420 Test Loss: 1.711 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 40.61532378196716
Epoch: 2, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.639 Vali Acc: 0.466 Test Loss: 1.639 Test Acc: 0.466
Validation loss decreased (-0.419830 --> -0.465632).  Saving model ...
Epoch: 3 cost time: 37.627511739730835
Epoch: 3, Steps: 8 | Train Loss: 0.421 Vali Loss: 1.741 Vali Acc: 0.504 Test Loss: 1.741 Test Acc: 0.504
Validation loss decreased (-0.465632 --> -0.503799).  Saving model ...
Epoch: 4 cost time: 41.658708572387695
Epoch: 4, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.594 Vali Acc: 0.443 Test Loss: 1.594 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 37.2537887096405
Epoch: 5, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.229 Vali Acc: 0.458 Test Loss: 2.229 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 39.991281032562256
Epoch: 6, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.427 Vali Acc: 0.511 Test Loss: 2.427 Test Acc: 0.511
Validation loss decreased (-0.503799 --> -0.511426).  Saving model ...
Epoch: 7 cost time: 41.009910345077515
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.062 Vali Acc: 0.504 Test Loss: 2.062 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 39.8722288608551
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.383 Vali Acc: 0.504 Test Loss: 2.383 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 38.98845386505127
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.504 Test Loss: 2.714 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 37.40350341796875
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.519 Test Loss: 2.703 Test Acc: 0.519
Validation loss decreased (-0.511426 --> -0.519057).  Saving model ...
Epoch: 11 cost time: 39.0796434879303
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.595 Vali Acc: 0.519 Test Loss: 2.595 Test Acc: 0.519
Validation loss decreased (-0.519057 --> -0.519058).  Saving model ...
Epoch: 12 cost time: 39.407777547836304
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.504 Vali Acc: 0.519 Test Loss: 2.504 Test Acc: 0.519
Validation loss decreased (-0.519058 --> -0.519059).  Saving model ...
Epoch: 13 cost time: 40.37491703033447
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.489 Vali Acc: 0.519 Test Loss: 2.489 Test Acc: 0.519
Validation loss decreased (-0.519059 --> -0.519059).  Saving model ...
Epoch: 14 cost time: 37.885838985443115
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.519 Test Loss: 2.528 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 38.23066067695618
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.575 Vali Acc: 0.527 Test Loss: 2.575 Test Acc: 0.527
Validation loss decreased (-0.519059 --> -0.526692).  Saving model ...
Epoch: 16 cost time: 40.45991492271423
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.591 Vali Acc: 0.527 Test Loss: 2.591 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 41.61402654647827
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.601 Vali Acc: 0.527 Test Loss: 2.601 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 40.25647568702698
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.603 Vali Acc: 0.527 Test Loss: 2.603 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 37.293235301971436
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.596 Vali Acc: 0.519 Test Loss: 2.596 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 41.610933780670166
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.589 Vali Acc: 0.519 Test Loss: 2.589 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 43.12924885749817
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.595 Vali Acc: 0.527 Test Loss: 2.595 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 40.51081132888794
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.607 Vali Acc: 0.527 Test Loss: 2.607 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 41.847031593322754
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.607 Vali Acc: 0.527 Test Loss: 2.607 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 38.31956386566162
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.621 Vali Acc: 0.527 Test Loss: 2.621 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 40.393781661987305
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.630 Vali Acc: 0.527 Test Loss: 2.630 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1799_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 10243945
model size : 44.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.328819036483765
Epoch: 1, Steps: 8 | Train Loss: 1.507 Vali Loss: 1.830 Vali Acc: 0.420 Test Loss: 1.830 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 29.587498426437378
Epoch: 2, Steps: 8 | Train Loss: 1.265 Vali Loss: 1.685 Vali Acc: 0.534 Test Loss: 1.685 Test Acc: 0.534
Validation loss decreased (-0.419829 --> -0.534334).  Saving model ...
Epoch: 3 cost time: 29.406375885009766
Epoch: 3, Steps: 8 | Train Loss: 0.706 Vali Loss: 1.498 Vali Acc: 0.443 Test Loss: 1.498 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.667371034622192
Epoch: 4, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.971 Vali Acc: 0.229 Test Loss: 1.971 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 29.485456943511963
Epoch: 5, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.852 Vali Acc: 0.557 Test Loss: 1.852 Test Acc: 0.557
Validation loss decreased (-0.534334 --> -0.557233).  Saving model ...
Epoch: 6 cost time: 27.461917638778687
Epoch: 6, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.104 Vali Acc: 0.504 Test Loss: 2.104 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.605405569076538
Epoch: 7, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.862 Vali Acc: 0.565 Test Loss: 1.862 Test Acc: 0.565
Validation loss decreased (-0.557233 --> -0.564867).  Saving model ...
Epoch: 8 cost time: 30.087339401245117
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.805 Vali Acc: 0.527 Test Loss: 2.805 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.386045217514038
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 3.088 Vali Acc: 0.366 Test Loss: 3.088 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.453670263290405
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.706 Vali Acc: 0.458 Test Loss: 2.706 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 28.524314641952515
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.460 Vali Acc: 0.511 Test Loss: 2.460 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 28.146358489990234
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.527 Test Loss: 2.388 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 28.819084882736206
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.390 Vali Acc: 0.527 Test Loss: 2.390 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 28.33822274208069
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.404 Vali Acc: 0.542 Test Loss: 2.404 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 28.874670267105103
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.434 Vali Acc: 0.534 Test Loss: 2.434 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 28.972412586212158
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.458 Vali Acc: 0.534 Test Loss: 2.458 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 26.61977458000183
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.482 Vali Acc: 0.527 Test Loss: 2.482 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1349_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 10128745
model size : 42.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.53882884979248
Epoch: 1, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.566 Vali Acc: 0.412 Test Loss: 1.566 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 18.142159461975098
Epoch: 2, Steps: 8 | Train Loss: 1.282 Vali Loss: 1.615 Vali Acc: 0.237 Test Loss: 1.615 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.870320558547974
Epoch: 3, Steps: 8 | Train Loss: 0.709 Vali Loss: 1.917 Vali Acc: 0.176 Test Loss: 1.917 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.410412311553955
Epoch: 4, Steps: 8 | Train Loss: 0.296 Vali Loss: 1.523 Vali Acc: 0.389 Test Loss: 1.523 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.14961314201355
Epoch: 5, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.717 Vali Acc: 0.473 Test Loss: 1.717 Test Acc: 0.473
Validation loss decreased (-0.412198 --> -0.473265).  Saving model ...
Epoch: 6 cost time: 18.969537496566772
Epoch: 6, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.588 Vali Acc: 0.565 Test Loss: 1.588 Test Acc: 0.565
Validation loss decreased (-0.473265 --> -0.564870).  Saving model ...
Epoch: 7 cost time: 19.956451177597046
Epoch: 7, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.450 Vali Acc: 0.527 Test Loss: 1.450 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.479225158691406
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.207 Vali Acc: 0.458 Test Loss: 2.207 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.705199241638184
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.686 Vali Acc: 0.534 Test Loss: 1.686 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.272396564483643
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.519 Test Loss: 1.739 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 19.24492120742798
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.540 Vali Acc: 0.588 Test Loss: 1.540 Test Acc: 0.588
Validation loss decreased (-0.564870 --> -0.587771).  Saving model ...
Epoch: 12 cost time: 19.107674837112427
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.534 Test Loss: 1.871 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.054909467697144
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.052 Vali Acc: 0.534 Test Loss: 2.052 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.602213859558105
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.519 Test Loss: 1.989 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 17.227599620819092
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.511 Test Loss: 1.903 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 19.043243646621704
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.534 Test Loss: 1.860 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 17.982678174972534
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.542 Test Loss: 1.843 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 17.26752805709839
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.542 Test Loss: 1.809 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 18.779640913009644
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.542 Test Loss: 1.791 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.460209131240845
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.542 Test Loss: 1.804 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 21.031468868255615
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.542 Test Loss: 1.807 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w900_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 10013801
model size : 41.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.219573259353638
Epoch: 1, Steps: 8 | Train Loss: 1.625 Vali Loss: 1.830 Vali Acc: 0.420 Test Loss: 1.830 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 11.310956478118896
Epoch: 2, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.544 Vali Acc: 0.427 Test Loss: 1.544 Test Acc: 0.427
Validation loss decreased (-0.419829 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 11.856972217559814
Epoch: 3, Steps: 8 | Train Loss: 0.947 Vali Loss: 1.818 Vali Acc: 0.466 Test Loss: 1.818 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465631).  Saving model ...
Epoch: 4 cost time: 11.693515062332153
Epoch: 4, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.592 Vali Acc: 0.550 Test Loss: 1.592 Test Acc: 0.550
Validation loss decreased (-0.465631 --> -0.549602).  Saving model ...
Epoch: 5 cost time: 10.225908279418945
Epoch: 5, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.849 Vali Acc: 0.565 Test Loss: 1.849 Test Acc: 0.565
Validation loss decreased (-0.549602 --> -0.564867).  Saving model ...
Epoch: 6 cost time: 11.119746685028076
Epoch: 6, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.776 Vali Acc: 0.550 Test Loss: 1.776 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.553084135055542
Epoch: 7, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.467 Vali Acc: 0.534 Test Loss: 1.467 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.438724994659424
Epoch: 8, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.783 Vali Acc: 0.580 Test Loss: 1.783 Test Acc: 0.580
Validation loss decreased (-0.564867 --> -0.580135).  Saving model ...
Epoch: 9 cost time: 11.760127544403076
Epoch: 9, Steps: 8 | Train Loss: 0.039 Vali Loss: 2.565 Vali Acc: 0.313 Test Loss: 2.565 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.85344123840332
Epoch: 10, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.405 Vali Acc: 0.344 Test Loss: 2.405 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.57370114326477
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.365 Vali Acc: 0.580 Test Loss: 2.365 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.00129246711731
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.563 Vali Acc: 0.534 Test Loss: 1.563 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.39974331855774
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.145 Vali Acc: 0.603 Test Loss: 2.145 Test Acc: 0.603
Validation loss decreased (-0.580135 --> -0.603032).  Saving model ...
Epoch: 14 cost time: 11.616078853607178
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.710 Vali Acc: 0.573 Test Loss: 1.710 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.360413312911987
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.370 Vali Acc: 0.603 Test Loss: 2.370 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.557886362075806
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.287 Vali Acc: 0.603 Test Loss: 2.287 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.668384790420532
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.169 Vali Acc: 0.595 Test Loss: 2.169 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.546878576278687
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.093 Vali Acc: 0.588 Test Loss: 2.093 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.478847742080688
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.588 Test Loss: 2.067 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.411527872085571
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.061 Vali Acc: 0.595 Test Loss: 2.061 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.82997989654541
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.054 Vali Acc: 0.595 Test Loss: 2.054 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.342754125595093
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.045 Vali Acc: 0.588 Test Loss: 2.045 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.027881145477295
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.041 Vali Acc: 0.588 Test Loss: 2.041 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w540_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 9921641
model size : 39.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.084028244018555
Epoch: 1, Steps: 8 | Train Loss: 1.700 Vali Loss: 1.766 Vali Acc: 0.420 Test Loss: 1.766 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 8.389007568359375
Epoch: 2, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.603 Vali Acc: 0.336 Test Loss: 1.603 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.971940755844116
Epoch: 3, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.701 Vali Acc: 0.397 Test Loss: 1.701 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.186681747436523
Epoch: 4, Steps: 8 | Train Loss: 0.141 Vali Loss: 2.510 Vali Acc: 0.481 Test Loss: 2.510 Test Acc: 0.481
Validation loss decreased (-0.419830 --> -0.480891).  Saving model ...
Epoch: 5 cost time: 7.882649898529053
Epoch: 5, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.096 Vali Acc: 0.519 Test Loss: 2.096 Test Acc: 0.519
Validation loss decreased (-0.480891 --> -0.519063).  Saving model ...
Epoch: 6 cost time: 8.421432495117188
Epoch: 6, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.058 Vali Acc: 0.481 Test Loss: 2.058 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.462403774261475
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.588 Vali Acc: 0.504 Test Loss: 2.588 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.824828386306763
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.779 Vali Acc: 0.511 Test Loss: 2.779 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.361639976501465
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.354 Vali Acc: 0.534 Test Loss: 2.354 Test Acc: 0.534
Validation loss decreased (-0.519063 --> -0.534328).  Saving model ...
Epoch: 10 cost time: 8.639559984207153
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.139 Vali Acc: 0.511 Test Loss: 2.139 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.138187646865845
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.116 Vali Acc: 0.519 Test Loss: 2.116 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.661103963851929
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.195 Vali Acc: 0.511 Test Loss: 2.195 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.586856365203857
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.280 Vali Acc: 0.511 Test Loss: 2.280 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.577054262161255
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.527 Test Loss: 2.339 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.307016134262085
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.527 Test Loss: 2.372 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.487936735153198
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.386 Vali Acc: 0.534 Test Loss: 2.386 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.290513515472412
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.393 Vali Acc: 0.527 Test Loss: 2.393 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.37456750869751
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.397 Vali Acc: 0.527 Test Loss: 2.397 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.946462392807007
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.395 Vali Acc: 0.527 Test Loss: 2.395 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w360_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 9875561
model size : 38.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.49446702003479
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 4.3021745681762695
Epoch: 2, Steps: 8 | Train Loss: 1.175 Vali Loss: 1.542 Vali Acc: 0.489 Test Loss: 1.542 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488534).  Saving model ...
Epoch: 3 cost time: 4.319750070571899
Epoch: 3, Steps: 8 | Train Loss: 0.659 Vali Loss: 1.912 Vali Acc: 0.229 Test Loss: 1.912 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.0557146072387695
Epoch: 4, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.631 Vali Acc: 0.489 Test Loss: 1.631 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.394128322601318
Epoch: 5, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.569 Vali Acc: 0.458 Test Loss: 1.569 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.273310661315918
Epoch: 6, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.451 Vali Acc: 0.443 Test Loss: 2.451 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.252600431442261
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.826 Vali Acc: 0.542 Test Loss: 1.826 Test Acc: 0.542
Validation loss decreased (-0.488534 --> -0.541966).  Saving model ...
Epoch: 8 cost time: 4.250748157501221
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.765 Vali Acc: 0.534 Test Loss: 1.765 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.2885565757751465
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.565 Vali Acc: 0.511 Test Loss: 2.565 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9934661388397217
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.858 Vali Acc: 0.534 Test Loss: 2.858 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.194540023803711
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.998 Vali Acc: 0.466 Test Loss: 1.998 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9868218898773193
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.132 Vali Acc: 0.511 Test Loss: 2.132 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9402272701263428
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.523 Vali Acc: 0.534 Test Loss: 2.523 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.9604177474975586
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.590 Vali Acc: 0.534 Test Loss: 2.590 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.719628095626831
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.409 Vali Acc: 0.519 Test Loss: 2.409 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.376984119415283
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.268 Vali Acc: 0.511 Test Loss: 2.268 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.0498011112213135
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.241 Vali Acc: 0.511 Test Loss: 2.241 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w180_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 9829481
model size : 38.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.0773215293884277
Epoch: 1, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.851 Vali Acc: 0.420 Test Loss: 1.851 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 1.086029291152954
Epoch: 2, Steps: 8 | Train Loss: 0.947 Vali Loss: 1.447 Vali Acc: 0.473 Test Loss: 1.447 Test Acc: 0.473
Validation loss decreased (-0.419829 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.0777888298034668
Epoch: 3, Steps: 8 | Train Loss: 0.226 Vali Loss: 2.015 Vali Acc: 0.328 Test Loss: 2.015 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.037010908126831
Epoch: 4, Steps: 8 | Train Loss: 0.051 Vali Loss: 2.025 Vali Acc: 0.374 Test Loss: 2.025 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0804328918457031
Epoch: 5, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.847 Vali Acc: 0.344 Test Loss: 2.847 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.056199073791504
Epoch: 6, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.791 Vali Acc: 0.412 Test Loss: 2.791 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0604982376098633
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.563 Vali Acc: 0.412 Test Loss: 2.563 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0447957515716553
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 3.125 Vali Acc: 0.405 Test Loss: 3.125 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0451645851135254
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 3.241 Vali Acc: 0.351 Test Loss: 3.241 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.12811279296875
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 3.068 Vali Acc: 0.427 Test Loss: 3.068 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0919461250305176
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 3.477 Vali Acc: 0.374 Test Loss: 3.477 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0685031414031982
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 3.674 Vali Acc: 0.397 Test Loss: 3.674 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 9783657
model size : 37.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.5895299911499
Epoch: 1, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.692 Vali Acc: 0.420 Test Loss: 1.692 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 45.3993353843689
Epoch: 2, Steps: 8 | Train Loss: 0.799 Vali Loss: 1.411 Vali Acc: 0.427 Test Loss: 1.411 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427467).  Saving model ...
Epoch: 3 cost time: 45.5377414226532
Epoch: 3, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.645 Vali Acc: 0.519 Test Loss: 1.645 Test Acc: 0.519
Validation loss decreased (-0.427467 --> -0.519068).  Saving model ...
Epoch: 4 cost time: 50.85341715812683
Epoch: 4, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.717 Vali Acc: 0.519 Test Loss: 1.717 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 51.10456562042236
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.617 Vali Acc: 0.519 Test Loss: 2.617 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 45.42231345176697
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.561 Vali Acc: 0.519 Test Loss: 2.561 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 46.43342185020447
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.361 Vali Acc: 0.519 Test Loss: 2.361 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 49.46456742286682
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.235 Vali Acc: 0.519 Test Loss: 2.235 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 49.58703875541687
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.184 Vali Acc: 0.519 Test Loss: 2.184 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 45.88539385795593
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.519 Test Loss: 2.172 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 47.70461416244507
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.187 Vali Acc: 0.519 Test Loss: 2.187 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 50.78604173660278
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.214 Vali Acc: 0.519 Test Loss: 2.214 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 48.1664662361145
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.246 Vali Acc: 0.519 Test Loss: 2.246 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w2248_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 10358825
model size : 46.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 43.26002216339111
Epoch: 1, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.777 Vali Acc: 0.420 Test Loss: 1.777 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 37.916643381118774
Epoch: 2, Steps: 8 | Train Loss: 0.977 Vali Loss: 1.636 Vali Acc: 0.511 Test Loss: 1.636 Test Acc: 0.511
Validation loss decreased (-0.419830 --> -0.511434).  Saving model ...
Epoch: 3 cost time: 40.58714747428894
Epoch: 3, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.396 Vali Acc: 0.527 Test Loss: 1.396 Test Acc: 0.527
Validation loss decreased (-0.511434 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 40.27287578582764
Epoch: 4, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.142 Vali Acc: 0.519 Test Loss: 2.142 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 41.13233184814453
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.355 Vali Acc: 0.519 Test Loss: 2.355 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 39.690901041030884
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.527 Test Loss: 2.320 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 38.41399526596069
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.248 Vali Acc: 0.527 Test Loss: 2.248 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 34.65976309776306
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.179 Vali Acc: 0.527 Test Loss: 2.179 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 41.00784516334534
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.527 Test Loss: 2.150 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 36.28127956390381
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.527 Test Loss: 2.146 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 36.785584449768066
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.527 Test Loss: 2.164 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 35.51689267158508
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.527 Test Loss: 2.191 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 36.03613066673279
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.210 Vali Acc: 0.527 Test Loss: 2.210 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1799_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 10243881
model size : 44.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.65230655670166
Epoch: 1, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 24.68046283721924
Epoch: 2, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.328 Vali Acc: 0.511 Test Loss: 1.328 Test Acc: 0.511
Validation loss decreased (-0.419831 --> -0.511437).  Saving model ...
Epoch: 3 cost time: 27.184281826019287
Epoch: 3, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.566 Vali Acc: 0.519 Test Loss: 1.566 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519068).  Saving model ...
Epoch: 4 cost time: 24.612539529800415
Epoch: 4, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.092 Vali Acc: 0.519 Test Loss: 2.092 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.02472710609436
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.285 Vali Acc: 0.519 Test Loss: 2.285 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.869052171707153
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.519 Test Loss: 2.320 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.505277633666992
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.305 Vali Acc: 0.519 Test Loss: 2.305 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.47795867919922
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.287 Vali Acc: 0.519 Test Loss: 2.287 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 25.462367057800293
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.519 Test Loss: 2.267 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 25.064027309417725
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.261 Vali Acc: 0.519 Test Loss: 2.261 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 27.57140302658081
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.264 Vali Acc: 0.519 Test Loss: 2.264 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 26.181779384613037
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.265 Vali Acc: 0.519 Test Loss: 2.265 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 28.69303011894226
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.274 Vali Acc: 0.519 Test Loss: 2.274 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w1349_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 10128681
model size : 42.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.52404236793518
Epoch: 1, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.723 Vali Acc: 0.420 Test Loss: 1.723 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 20.11466908454895
Epoch: 2, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.394 Vali Acc: 0.481 Test Loss: 1.394 Test Acc: 0.481
Validation loss decreased (-0.419830 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 18.331165075302124
Epoch: 3, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.465 Vali Acc: 0.557 Test Loss: 1.465 Test Acc: 0.557
Validation loss decreased (-0.480902 --> -0.557237).  Saving model ...
Epoch: 4 cost time: 18.541802167892456
Epoch: 4, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.369 Vali Acc: 0.519 Test Loss: 2.369 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.367587566375732
Epoch: 5, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.747 Vali Acc: 0.519 Test Loss: 2.747 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.57476544380188
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.363 Vali Acc: 0.519 Test Loss: 2.363 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.199341773986816
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.519 Test Loss: 2.166 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.780811548233032
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.103 Vali Acc: 0.519 Test Loss: 2.103 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 20.12322974205017
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.105 Vali Acc: 0.519 Test Loss: 2.105 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.176961183547974
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.147 Vali Acc: 0.519 Test Loss: 2.147 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 20.716599464416504
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.519 Test Loss: 2.196 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 20.036711931228638
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.242 Vali Acc: 0.519 Test Loss: 2.242 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 18.406732320785522
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.279 Vali Acc: 0.519 Test Loss: 2.279 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w900_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 10013737
model size : 41.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.489245653152466
Epoch: 1, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.907 Vali Acc: 0.420 Test Loss: 1.907 Test Acc: 0.420
Validation loss decreased (inf --> -0.419828).  Saving model ...
Epoch: 2 cost time: 10.619629859924316
Epoch: 2, Steps: 8 | Train Loss: 0.841 Vali Loss: 1.388 Vali Acc: 0.550 Test Loss: 1.388 Test Acc: 0.550
Validation loss decreased (-0.419828 --> -0.549604).  Saving model ...
Epoch: 3 cost time: 10.7955482006073
Epoch: 3, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.739 Vali Acc: 0.519 Test Loss: 1.739 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.5845046043396
Epoch: 4, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.998 Vali Acc: 0.527 Test Loss: 1.998 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.304188013076782
Epoch: 5, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.669 Vali Acc: 0.519 Test Loss: 2.669 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.351112604141235
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.920 Vali Acc: 0.519 Test Loss: 2.920 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.92798924446106
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.895 Vali Acc: 0.519 Test Loss: 2.895 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.337394714355469
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.807 Vali Acc: 0.519 Test Loss: 2.807 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.639779806137085
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.721 Vali Acc: 0.519 Test Loss: 2.721 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.852076530456543
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.656 Vali Acc: 0.519 Test Loss: 2.656 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.80423879623413
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.613 Vali Acc: 0.519 Test Loss: 2.613 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.976264238357544
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.584 Vali Acc: 0.519 Test Loss: 2.584 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w540_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 9921577
model size : 39.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.053850412368774
Epoch: 1, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.912 Vali Acc: 0.420 Test Loss: 1.912 Test Acc: 0.420
Validation loss decreased (inf --> -0.419828).  Saving model ...
Epoch: 2 cost time: 7.946738243103027
Epoch: 2, Steps: 8 | Train Loss: 0.865 Vali Loss: 1.563 Vali Acc: 0.382 Test Loss: 1.563 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.436457395553589
Epoch: 3, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.713 Vali Acc: 0.511 Test Loss: 1.713 Test Acc: 0.511
Validation loss decreased (-0.419828 --> -0.511433).  Saving model ...
Epoch: 4 cost time: 8.286526203155518
Epoch: 4, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.816 Vali Acc: 0.519 Test Loss: 1.816 Test Acc: 0.519
Validation loss decreased (-0.511433 --> -0.519066).  Saving model ...
Epoch: 5 cost time: 8.098739624023438
Epoch: 5, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.790 Vali Acc: 0.519 Test Loss: 2.790 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.200813293457031
Epoch: 6, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.568 Vali Acc: 0.519 Test Loss: 2.568 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.536897420883179
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.413 Vali Acc: 0.519 Test Loss: 2.413 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.156503915786743
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.519 Test Loss: 2.331 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.181981563568115
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.291 Vali Acc: 0.519 Test Loss: 2.291 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.226189136505127
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.281 Vali Acc: 0.519 Test Loss: 2.281 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.620108127593994
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.519 Test Loss: 2.284 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.823541879653931
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.519 Test Loss: 2.296 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.731433391571045
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.309 Vali Acc: 0.519 Test Loss: 2.309 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.916230916976929
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.324 Vali Acc: 0.519 Test Loss: 2.324 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w360_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 9875497
model size : 38.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.180859804153442
Epoch: 1, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.920 Vali Acc: 0.420 Test Loss: 1.920 Test Acc: 0.420
Validation loss decreased (inf --> -0.419828).  Saving model ...
Epoch: 2 cost time: 4.115180969238281
Epoch: 2, Steps: 8 | Train Loss: 1.090 Vali Loss: 1.803 Vali Acc: 0.290 Test Loss: 1.803 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.228761196136475
Epoch: 3, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.933 Vali Acc: 0.496 Test Loss: 1.933 Test Acc: 0.496
Validation loss decreased (-0.419828 --> -0.496164).  Saving model ...
Epoch: 4 cost time: 4.0417420864105225
Epoch: 4, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.772 Vali Acc: 0.527 Test Loss: 1.772 Test Acc: 0.527
Validation loss decreased (-0.496164 --> -0.526700).  Saving model ...
Epoch: 5 cost time: 3.862891674041748
Epoch: 5, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.720 Vali Acc: 0.519 Test Loss: 2.720 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7316250801086426
Epoch: 6, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.584 Vali Acc: 0.519 Test Loss: 2.584 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.03537130355835
Epoch: 7, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.386 Vali Acc: 0.519 Test Loss: 2.386 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.972834587097168
Epoch: 8, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.287 Vali Acc: 0.519 Test Loss: 2.287 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.12495756149292
Epoch: 9, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.268 Vali Acc: 0.519 Test Loss: 2.268 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.027425527572632
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.275 Vali Acc: 0.519 Test Loss: 2.275 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.824875831604004
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.519 Test Loss: 2.296 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.634107828140259
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.320 Vali Acc: 0.519 Test Loss: 2.320 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.255380630493164
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.347 Vali Acc: 0.519 Test Loss: 2.347 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.113466262817383
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.363 Vali Acc: 0.519 Test Loss: 2.363 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT1_w180_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 9829417
model size : 38.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 1.7258954048156738
Epoch: 1, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.641 Vali Acc: 0.427 Test Loss: 1.641 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 0.7684593200683594
Epoch: 2, Steps: 8 | Train Loss: 0.469 Vali Loss: 1.469 Vali Acc: 0.389 Test Loss: 1.469 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7808637619018555
Epoch: 3, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.718 Vali Acc: 0.519 Test Loss: 1.718 Test Acc: 0.519
Validation loss decreased (-0.427465 --> -0.519067).  Saving model ...
Epoch: 4 cost time: 0.7531700134277344
Epoch: 4, Steps: 8 | Train Loss: 0.032 Vali Loss: 2.212 Vali Acc: 0.374 Test Loss: 2.212 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7726695537567139
Epoch: 5, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.803 Vali Acc: 0.359 Test Loss: 2.803 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7840397357940674
Epoch: 6, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.998 Vali Acc: 0.351 Test Loss: 2.998 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7806861400604248
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 3.020 Vali Acc: 0.351 Test Loss: 3.020 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8088345527648926
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 3.372 Vali Acc: 0.435 Test Loss: 3.372 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7345383167266846
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 3.992 Vali Acc: 0.382 Test Loss: 3.992 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7258167266845703
Epoch: 10, Steps: 8 | Train Loss: 0.131 Vali Loss: 4.658 Vali Acc: 0.389 Test Loss: 4.658 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7254197597503662
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 5.280 Vali Acc: 0.397 Test Loss: 5.280 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7349884510040283
Epoch: 12, Steps: 8 | Train Loss: 0.103 Vali Loss: 6.007 Vali Acc: 0.397 Test Loss: 6.007 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7510993480682373
Epoch: 13, Steps: 8 | Train Loss: 0.089 Vali Loss: 6.387 Vali Acc: 0.359 Test Loss: 6.387 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_MTSMixer_UEA_ftM_sl17984_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 9783593
model size : 37.33MB
