Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7489614486694336
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.116 Vali Acc: 0.192 Test Loss: 2.116 Test Acc: 0.192
Validation loss decreased (inf --> -0.191871).  Saving model ...
Epoch: 2 cost time: 1.1874315738677979
Epoch: 2, Steps: 17 | Train Loss: 2.067 Vali Loss: 2.010 Vali Acc: 0.368 Test Loss: 2.010 Test Acc: 0.368
Validation loss decreased (-0.191871 --> -0.367547).  Saving model ...
Epoch: 3 cost time: 1.0173258781433105
Epoch: 3, Steps: 17 | Train Loss: 1.942 Vali Loss: 1.887 Vali Acc: 0.522 Test Loss: 1.887 Test Acc: 0.522
Validation loss decreased (-0.367547 --> -0.521603).  Saving model ...
Epoch: 4 cost time: 1.1120431423187256
Epoch: 4, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.758 Vali Acc: 0.657 Test Loss: 1.758 Test Acc: 0.657
Validation loss decreased (-0.521603 --> -0.656739).  Saving model ...
Epoch: 5 cost time: 1.1132793426513672
Epoch: 5, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.630 Vali Acc: 0.751 Test Loss: 1.630 Test Acc: 0.751
Validation loss decreased (-0.656739 --> -0.751335).  Saving model ...
Epoch: 6 cost time: 0.8814759254455566
Epoch: 6, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.518 Vali Acc: 0.792 Test Loss: 1.518 Test Acc: 0.792
Validation loss decreased (-0.751335 --> -0.791877).  Saving model ...
Epoch: 7 cost time: 1.0491108894348145
Epoch: 7, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.394 Vali Acc: 0.808 Test Loss: 1.394 Test Acc: 0.808
Validation loss decreased (-0.791877 --> -0.808094).  Saving model ...
Epoch: 8 cost time: 1.0523512363433838
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.276 Vali Acc: 0.846 Test Loss: 1.276 Test Acc: 0.846
Validation loss decreased (-0.808094 --> -0.845933).  Saving model ...
Epoch: 9 cost time: 0.9224121570587158
Epoch: 9, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.171 Vali Acc: 0.849 Test Loss: 1.171 Test Acc: 0.849
Validation loss decreased (-0.845933 --> -0.848637).  Saving model ...
Epoch: 10 cost time: 1.0506024360656738
Epoch: 10, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.081 Vali Acc: 0.854 Test Loss: 1.081 Test Acc: 0.854
Validation loss decreased (-0.848637 --> -0.854043).  Saving model ...
Epoch: 11 cost time: 1.125474452972412
Epoch: 11, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.005 Vali Acc: 0.865 Test Loss: 1.005 Test Acc: 0.865
Validation loss decreased (-0.854043 --> -0.864855).  Saving model ...
Epoch: 12 cost time: 1.1175377368927002
Epoch: 12, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.918 Vali Acc: 0.881 Test Loss: 0.918 Test Acc: 0.881
Validation loss decreased (-0.864855 --> -0.881072).  Saving model ...
Epoch: 13 cost time: 1.0515072345733643
Epoch: 13, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.849 Vali Acc: 0.886 Test Loss: 0.849 Test Acc: 0.886
Validation loss decreased (-0.881072 --> -0.886478).  Saving model ...
Epoch: 14 cost time: 1.0628776550292969
Epoch: 14, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.785 Vali Acc: 0.900 Test Loss: 0.785 Test Acc: 0.900
Validation loss decreased (-0.886478 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 1.1384882926940918
Epoch: 15, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.728 Vali Acc: 0.897 Test Loss: 0.728 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0742988586425781
Epoch: 16, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.680 Vali Acc: 0.886 Test Loss: 0.680 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2357263565063477
Epoch: 17, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.647 Vali Acc: 0.895 Test Loss: 0.647 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3145906925201416
Epoch: 18, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.610 Vali Acc: 0.903 Test Loss: 0.610 Test Acc: 0.903
Validation loss decreased (-0.899992 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 1.1950030326843262
Epoch: 19, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.583 Vali Acc: 0.911 Test Loss: 0.583 Test Acc: 0.911
Validation loss decreased (-0.902697 --> -0.910805).  Saving model ...
Epoch: 20 cost time: 1.1668331623077393
Epoch: 20, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1733386516571045
Epoch: 21, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 1.0843725204467773
Epoch: 22, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.510 Vali Acc: 0.932 Test Loss: 0.510 Test Acc: 0.932
Validation loss decreased (-0.910806 --> -0.932427).  Saving model ...
Epoch: 23 cost time: 1.0915477275848389
Epoch: 23, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.481 Vali Acc: 0.924 Test Loss: 0.481 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2245585918426514
Epoch: 24, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.450 Vali Acc: 0.932 Test Loss: 0.450 Test Acc: 0.932
Validation loss decreased (-0.932427 --> -0.932428).  Saving model ...
Epoch: 25 cost time: 1.2017602920532227
Epoch: 25, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.439 Vali Acc: 0.919 Test Loss: 0.439 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1469240188598633
Epoch: 26, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.427 Vali Acc: 0.924 Test Loss: 0.427 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1754183769226074
Epoch: 27, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.397 Vali Acc: 0.938 Test Loss: 0.397 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 28 cost time: 1.0221517086029053
Epoch: 28, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.407 Vali Acc: 0.935 Test Loss: 0.407 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.157383918762207
Epoch: 29, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 30 cost time: 0.952683687210083
Epoch: 30, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.368 Vali Acc: 0.943 Test Loss: 0.368 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 31 cost time: 1.0576660633087158
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.135324478149414
Epoch: 32, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.344 Vali Acc: 0.943 Test Loss: 0.344 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 33 cost time: 1.2368552684783936
Epoch: 33, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.334 Vali Acc: 0.943 Test Loss: 0.334 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 34 cost time: 1.0034043788909912
Epoch: 34, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.339 Vali Acc: 0.935 Test Loss: 0.339 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0179600715637207
Epoch: 35, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.337 Vali Acc: 0.938 Test Loss: 0.337 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3749065399169922
Epoch: 36, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.318 Vali Acc: 0.946 Test Loss: 0.318 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 37 cost time: 1.1868572235107422
Epoch: 37, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0594475269317627
Epoch: 38, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.308 Vali Acc: 0.946 Test Loss: 0.308 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 39 cost time: 1.0421082973480225
Epoch: 39, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.294 Vali Acc: 0.943 Test Loss: 0.294 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2221667766571045
Epoch: 40, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.298 Vali Acc: 0.943 Test Loss: 0.298 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3818743228912354
Epoch: 41, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 42 cost time: 1.1824092864990234
Epoch: 42, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.304 Vali Acc: 0.935 Test Loss: 0.304 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1092760562896729
Epoch: 43, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1120166778564453
Epoch: 44, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.276 Vali Acc: 0.946 Test Loss: 0.276 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 45 cost time: 1.2139322757720947
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.288 Vali Acc: 0.938 Test Loss: 0.288 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1157867908477783
Epoch: 46, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.285 Vali Acc: 0.946 Test Loss: 0.285 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.134732961654663
Epoch: 47, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.312 Vali Acc: 0.938 Test Loss: 0.312 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0246455669403076
Epoch: 48, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.286 Vali Acc: 0.943 Test Loss: 0.286 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2448556423187256
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.301 Vali Acc: 0.932 Test Loss: 0.301 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.212270975112915
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.281 Vali Acc: 0.946 Test Loss: 0.281 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1774075031280518
Epoch: 51, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1451938152313232
Epoch: 52, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.296 Vali Acc: 0.943 Test Loss: 0.296 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.2766964435577393
Epoch: 53, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.277 Vali Acc: 0.932 Test Loss: 0.277 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.3044748306274414
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 130671
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5704047679901123
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.174 Vali Acc: 0.108 Test Loss: 2.174 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 1.2136003971099854
Epoch: 2, Steps: 17 | Train Loss: 2.139 Vali Loss: 2.065 Vali Acc: 0.186 Test Loss: 2.065 Test Acc: 0.186
Validation loss decreased (-0.108086 --> -0.186466).  Saving model ...
Epoch: 3 cost time: 1.0644285678863525
Epoch: 3, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.934 Vali Acc: 0.405 Test Loss: 1.934 Test Acc: 0.405
Validation loss decreased (-0.186466 --> -0.405386).  Saving model ...
Epoch: 4 cost time: 1.1528444290161133
Epoch: 4, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.797 Vali Acc: 0.551 Test Loss: 1.797 Test Acc: 0.551
Validation loss decreased (-0.405386 --> -0.551333).  Saving model ...
Epoch: 5 cost time: 1.0474395751953125
Epoch: 5, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.652 Vali Acc: 0.673 Test Loss: 1.652 Test Acc: 0.673
Validation loss decreased (-0.551333 --> -0.672956).  Saving model ...
Epoch: 6 cost time: 1.0814387798309326
Epoch: 6, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.519 Vali Acc: 0.738 Test Loss: 1.519 Test Acc: 0.738
Validation loss decreased (-0.672956 --> -0.737823).  Saving model ...
Epoch: 7 cost time: 1.0798537731170654
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.371 Vali Acc: 0.795 Test Loss: 1.371 Test Acc: 0.795
Validation loss decreased (-0.737823 --> -0.794581).  Saving model ...
Epoch: 8 cost time: 1.0556895732879639
Epoch: 8, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.258 Vali Acc: 0.800 Test Loss: 1.258 Test Acc: 0.800
Validation loss decreased (-0.794581 --> -0.799987).  Saving model ...
Epoch: 9 cost time: 1.1024396419525146
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.146 Vali Acc: 0.832 Test Loss: 1.146 Test Acc: 0.832
Validation loss decreased (-0.799987 --> -0.832421).  Saving model ...
Epoch: 10 cost time: 1.2415978908538818
Epoch: 10, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.026 Vali Acc: 0.865 Test Loss: 1.026 Test Acc: 0.865
Validation loss decreased (-0.832421 --> -0.864855).  Saving model ...
Epoch: 11 cost time: 1.0122034549713135
Epoch: 11, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.947 Vali Acc: 0.868 Test Loss: 0.947 Test Acc: 0.868
Validation loss decreased (-0.864855 --> -0.867558).  Saving model ...
Epoch: 12 cost time: 1.0140390396118164
Epoch: 12, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.870 Vali Acc: 0.884 Test Loss: 0.870 Test Acc: 0.884
Validation loss decreased (-0.867558 --> -0.883775).  Saving model ...
Epoch: 13 cost time: 1.3427026271820068
Epoch: 13, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.787 Vali Acc: 0.895 Test Loss: 0.787 Test Acc: 0.895
Validation loss decreased (-0.883775 --> -0.894587).  Saving model ...
Epoch: 14 cost time: 1.148754358291626
Epoch: 14, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.741 Vali Acc: 0.895 Test Loss: 0.741 Test Acc: 0.895
Validation loss decreased (-0.894587 --> -0.894587).  Saving model ...
Epoch: 15 cost time: 0.9538233280181885
Epoch: 15, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.686 Vali Acc: 0.905 Test Loss: 0.686 Test Acc: 0.905
Validation loss decreased (-0.894587 --> -0.905399).  Saving model ...
Epoch: 16 cost time: 0.9426560401916504
Epoch: 16, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.632 Vali Acc: 0.903 Test Loss: 0.632 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2105193138122559
Epoch: 17, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.592 Vali Acc: 0.911 Test Loss: 0.592 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.0499882698059082
Epoch: 18, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.570 Vali Acc: 0.905 Test Loss: 0.570 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.02382493019104
Epoch: 19, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.530 Vali Acc: 0.914 Test Loss: 0.530 Test Acc: 0.914
Validation loss decreased (-0.910805 --> -0.913508).  Saving model ...
Epoch: 20 cost time: 1.0177297592163086
Epoch: 20, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.504 Vali Acc: 0.916 Test Loss: 0.504 Test Acc: 0.916
Validation loss decreased (-0.913508 --> -0.916211).  Saving model ...
Epoch: 21 cost time: 1.047929048538208
Epoch: 21, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.468 Vali Acc: 0.914 Test Loss: 0.468 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9827618598937988
Epoch: 22, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.442 Vali Acc: 0.914 Test Loss: 0.442 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.925398588180542
Epoch: 23, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.424 Vali Acc: 0.916 Test Loss: 0.424 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916212).  Saving model ...
Epoch: 24 cost time: 1.0392510890960693
Epoch: 24, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.399 Vali Acc: 0.922 Test Loss: 0.399 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921618).  Saving model ...
Epoch: 25 cost time: 0.9727740287780762
Epoch: 25, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.388 Vali Acc: 0.914 Test Loss: 0.388 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1231400966644287
Epoch: 26, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.378 Vali Acc: 0.930 Test Loss: 0.378 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929726).  Saving model ...
Epoch: 27 cost time: 0.9259412288665771
Epoch: 27, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.343 Vali Acc: 0.924 Test Loss: 0.343 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9850947856903076
Epoch: 28, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.349 Vali Acc: 0.922 Test Loss: 0.349 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9323415756225586
Epoch: 29, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.323 Vali Acc: 0.927 Test Loss: 0.323 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.922025203704834
Epoch: 30, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.304 Vali Acc: 0.938 Test Loss: 0.304 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937835).  Saving model ...
Epoch: 31 cost time: 0.8923428058624268
Epoch: 31, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.289 Vali Acc: 0.938 Test Loss: 0.289 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 32 cost time: 1.1336984634399414
Epoch: 32, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.283 Vali Acc: 0.932 Test Loss: 0.283 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.068814754486084
Epoch: 33, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 34 cost time: 1.1091978549957275
Epoch: 34, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.932 Test Loss: 0.273 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.060929536819458
Epoch: 35, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.264 Vali Acc: 0.927 Test Loss: 0.264 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3454251289367676
Epoch: 36, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2335176467895508
Epoch: 37, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 38 cost time: 1.1180434226989746
Epoch: 38, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.252 Vali Acc: 0.938 Test Loss: 0.252 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0618836879730225
Epoch: 39, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2676749229431152
Epoch: 40, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 41 cost time: 1.2356960773468018
Epoch: 41, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 42 cost time: 1.144735336303711
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 43 cost time: 1.054718017578125
Epoch: 43, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951349).  Saving model ...
Epoch: 44 cost time: 1.0577385425567627
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1044976711273193
Epoch: 45, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.212 Vali Acc: 0.946 Test Loss: 0.212 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1020078659057617
Epoch: 46, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9715933799743652
Epoch: 47, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 48 cost time: 1.0594863891601562
Epoch: 48, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1183903217315674
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1654963493347168
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1935663223266602
Epoch: 51, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0346062183380127
Epoch: 52, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.154526710510254
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 54 cost time: 1.2597286701202393
Epoch: 54, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0899617671966553
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0546760559082031
Epoch: 56, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.351567268371582
Epoch: 57, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.1156141757965088
Epoch: 58, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.2134478092193604
Epoch: 59, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.0641071796417236
Epoch: 60, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1682963371276855
Epoch: 61, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 62 cost time: 0.921316385269165
Epoch: 62, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.087738275527954
Epoch: 63, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2196452617645264
Epoch: 64, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.1436083316802979
Epoch: 65, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.117283582687378
Epoch: 66, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.2156095504760742
Epoch: 67, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.1288552284240723
Epoch: 68, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.0275511741638184
Epoch: 69, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.9725527763366699
Epoch: 70, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.9938020706176758
Epoch: 71, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 72 cost time: 1.0157418251037598
Epoch: 72, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 73 cost time: 1.113553524017334
Epoch: 73, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.066239356994629
Epoch: 74, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.2761712074279785
Epoch: 75, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.1923019886016846
Epoch: 76, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.231269121170044
Epoch: 77, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.0293967723846436
Epoch: 78, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.185492992401123
Epoch: 79, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 80 cost time: 1.1106846332550049
Epoch: 80, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.1141576766967773
Epoch: 81, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.9794111251831055
Epoch: 82, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.1958277225494385
Epoch: 83, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.303382396697998
Epoch: 84, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.8765482902526855
Epoch: 85, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.2196247577667236
Epoch: 86, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.0239033699035645
Epoch: 87, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 1.0327627658843994
Epoch: 88, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.949 Test Loss: 0.164 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.9944877624511719
Epoch: 89, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 128623
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.690330982208252
Epoch: 1, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.127 Vali Acc: 0.232 Test Loss: 2.127 Test Acc: 0.232
Validation loss decreased (inf --> -0.232411).  Saving model ...
Epoch: 2 cost time: 1.0319876670837402
Epoch: 2, Steps: 17 | Train Loss: 2.115 Vali Loss: 2.018 Vali Acc: 0.432 Test Loss: 2.018 Test Acc: 0.432
Validation loss decreased (-0.232411 --> -0.432412).  Saving model ...
Epoch: 3 cost time: 1.1811609268188477
Epoch: 3, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.882 Vali Acc: 0.600 Test Loss: 1.882 Test Acc: 0.600
Validation loss decreased (-0.432412 --> -0.599981).  Saving model ...
Epoch: 4 cost time: 1.0895411968231201
Epoch: 4, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.736 Vali Acc: 0.724 Test Loss: 1.736 Test Acc: 0.724
Validation loss decreased (-0.599981 --> -0.724307).  Saving model ...
Epoch: 5 cost time: 0.9120430946350098
Epoch: 5, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.600 Vali Acc: 0.732 Test Loss: 1.600 Test Acc: 0.732
Validation loss decreased (-0.724307 --> -0.732416).  Saving model ...
Epoch: 6 cost time: 0.9190080165863037
Epoch: 6, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.459 Vali Acc: 0.778 Test Loss: 1.459 Test Acc: 0.778
Validation loss decreased (-0.732416 --> -0.778364).  Saving model ...
Epoch: 7 cost time: 1.1140408515930176
Epoch: 7, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.335 Vali Acc: 0.822 Test Loss: 1.335 Test Acc: 0.822
Validation loss decreased (-0.778364 --> -0.821608).  Saving model ...
Epoch: 8 cost time: 0.907261848449707
Epoch: 8, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.198 Vali Acc: 0.830 Test Loss: 1.198 Test Acc: 0.830
Validation loss decreased (-0.821608 --> -0.829718).  Saving model ...
Epoch: 9 cost time: 0.9096059799194336
Epoch: 9, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.118 Vali Acc: 0.846 Test Loss: 1.118 Test Acc: 0.846
Validation loss decreased (-0.829718 --> -0.845935).  Saving model ...
Epoch: 10 cost time: 0.9050166606903076
Epoch: 10, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.988 Vali Acc: 0.865 Test Loss: 0.988 Test Acc: 0.865
Validation loss decreased (-0.845935 --> -0.864855).  Saving model ...
Epoch: 11 cost time: 1.0749237537384033
Epoch: 11, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.901 Vali Acc: 0.911 Test Loss: 0.901 Test Acc: 0.911
Validation loss decreased (-0.864855 --> -0.910802).  Saving model ...
Epoch: 12 cost time: 0.8525357246398926
Epoch: 12, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.799 Vali Acc: 0.924 Test Loss: 0.799 Test Acc: 0.924
Validation loss decreased (-0.910802 --> -0.924316).  Saving model ...
Epoch: 13 cost time: 0.9152250289916992
Epoch: 13, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.728 Vali Acc: 0.922 Test Loss: 0.728 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1728911399841309
Epoch: 14, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.664 Vali Acc: 0.927 Test Loss: 0.664 Test Acc: 0.927
Validation loss decreased (-0.924316 --> -0.927020).  Saving model ...
Epoch: 15 cost time: 0.8600056171417236
Epoch: 15, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.590 Vali Acc: 0.949 Test Loss: 0.590 Test Acc: 0.949
Validation loss decreased (-0.927020 --> -0.948643).  Saving model ...
Epoch: 16 cost time: 0.9687235355377197
Epoch: 16, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.558 Vali Acc: 0.932 Test Loss: 0.558 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9315986633300781
Epoch: 17, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.517 Vali Acc: 0.949 Test Loss: 0.517 Test Acc: 0.949
Validation loss decreased (-0.948643 --> -0.948643).  Saving model ...
Epoch: 18 cost time: 0.9452452659606934
Epoch: 18, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.483 Vali Acc: 0.941 Test Loss: 0.483 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0673301219940186
Epoch: 19, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.453 Vali Acc: 0.941 Test Loss: 0.453 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9949264526367188
Epoch: 20, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.423 Vali Acc: 0.941 Test Loss: 0.423 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8808233737945557
Epoch: 21, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.375 Vali Acc: 0.949 Test Loss: 0.375 Test Acc: 0.949
Validation loss decreased (-0.948643 --> -0.948645).  Saving model ...
Epoch: 22 cost time: 1.2370507717132568
Epoch: 22, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.370 Vali Acc: 0.941 Test Loss: 0.370 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4415102005004883
Epoch: 23, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.345 Vali Acc: 0.946 Test Loss: 0.345 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9948780536651611
Epoch: 24, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.320 Vali Acc: 0.954 Test Loss: 0.320 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 25 cost time: 1.1684365272521973
Epoch: 25, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.307 Vali Acc: 0.951 Test Loss: 0.307 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3642075061798096
Epoch: 26, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.295 Vali Acc: 0.949 Test Loss: 0.295 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.136711597442627
Epoch: 27, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 28 cost time: 1.0959234237670898
Epoch: 28, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.267 Vali Acc: 0.949 Test Loss: 0.267 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.043532133102417
Epoch: 29, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.261 Vali Acc: 0.957 Test Loss: 0.261 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.010180950164795
Epoch: 30, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.257 Vali Acc: 0.954 Test Loss: 0.257 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1292948722839355
Epoch: 31, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.244 Vali Acc: 0.954 Test Loss: 0.244 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9835467338562012
Epoch: 32, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.245 Vali Acc: 0.951 Test Loss: 0.245 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1277821063995361
Epoch: 33, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.240 Vali Acc: 0.951 Test Loss: 0.240 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.029085397720337
Epoch: 34, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0494904518127441
Epoch: 35, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1479156017303467
Epoch: 36, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0230603218078613
Epoch: 37, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 38 cost time: 1.0817034244537354
Epoch: 38, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.215 Vali Acc: 0.954 Test Loss: 0.215 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2575945854187012
Epoch: 39, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1997461318969727
Epoch: 40, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.213 Vali Acc: 0.949 Test Loss: 0.213 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0883681774139404
Epoch: 41, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1257309913635254
Epoch: 42, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1610093116760254
Epoch: 43, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2371904850006104
Epoch: 44, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8640813827514648
Epoch: 45, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9286434650421143
Epoch: 46, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9407503604888916
Epoch: 47, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 126575
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.2434723377227783
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.171 Vali Acc: 0.127 Test Loss: 2.171 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 0.8404867649078369
Epoch: 2, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.053 Vali Acc: 0.259 Test Loss: 2.053 Test Acc: 0.259
Validation loss decreased (-0.127005 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 0.7714505195617676
Epoch: 3, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.921 Vali Acc: 0.432 Test Loss: 1.921 Test Acc: 0.432
Validation loss decreased (-0.259439 --> -0.432413).  Saving model ...
Epoch: 4 cost time: 0.979224681854248
Epoch: 4, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.772 Vali Acc: 0.608 Test Loss: 1.772 Test Acc: 0.608
Validation loss decreased (-0.432413 --> -0.608090).  Saving model ...
Epoch: 5 cost time: 0.8366138935089111
Epoch: 5, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.633 Vali Acc: 0.711 Test Loss: 1.633 Test Acc: 0.711
Validation loss decreased (-0.608090 --> -0.710794).  Saving model ...
Epoch: 6 cost time: 0.9214870929718018
Epoch: 6, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.494 Vali Acc: 0.781 Test Loss: 1.494 Test Acc: 0.781
Validation loss decreased (-0.710794 --> -0.781066).  Saving model ...
Epoch: 7 cost time: 0.9169638156890869
Epoch: 7, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.356 Vali Acc: 0.830 Test Loss: 1.356 Test Acc: 0.830
Validation loss decreased (-0.781066 --> -0.829716).  Saving model ...
Epoch: 8 cost time: 0.947376012802124
Epoch: 8, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.220 Vali Acc: 0.857 Test Loss: 1.220 Test Acc: 0.857
Validation loss decreased (-0.829716 --> -0.856745).  Saving model ...
Epoch: 9 cost time: 1.0163991451263428
Epoch: 9, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.090 Vali Acc: 0.886 Test Loss: 1.090 Test Acc: 0.886
Validation loss decreased (-0.856745 --> -0.886476).  Saving model ...
Epoch: 10 cost time: 1.0964767932891846
Epoch: 10, Steps: 17 | Train Loss: 0.913 Vali Loss: 0.997 Vali Acc: 0.873 Test Loss: 0.997 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0582211017608643
Epoch: 11, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.905 Vali Acc: 0.878 Test Loss: 0.905 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2956359386444092
Epoch: 12, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.816 Vali Acc: 0.914 Test Loss: 0.816 Test Acc: 0.914
Validation loss decreased (-0.886476 --> -0.913505).  Saving model ...
Epoch: 13 cost time: 0.915175199508667
Epoch: 13, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.744 Vali Acc: 0.911 Test Loss: 0.744 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1621029376983643
Epoch: 14, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.678 Vali Acc: 0.922 Test Loss: 0.678 Test Acc: 0.922
Validation loss decreased (-0.913505 --> -0.921615).  Saving model ...
Epoch: 15 cost time: 1.1125333309173584
Epoch: 15, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.620 Vali Acc: 0.924 Test Loss: 0.620 Test Acc: 0.924
Validation loss decreased (-0.921615 --> -0.924318).  Saving model ...
Epoch: 16 cost time: 0.9310195446014404
Epoch: 16, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.573 Vali Acc: 0.924 Test Loss: 0.573 Test Acc: 0.924
Validation loss decreased (-0.924318 --> -0.924319).  Saving model ...
Epoch: 17 cost time: 1.2612946033477783
Epoch: 17, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.550 Vali Acc: 0.927 Test Loss: 0.550 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927022).  Saving model ...
Epoch: 18 cost time: 0.9025650024414062
Epoch: 18, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.511 Vali Acc: 0.930 Test Loss: 0.511 Test Acc: 0.930
Validation loss decreased (-0.927022 --> -0.929725).  Saving model ...
Epoch: 19 cost time: 1.0818068981170654
Epoch: 19, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.470 Vali Acc: 0.927 Test Loss: 0.470 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0670862197875977
Epoch: 20, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.468 Vali Acc: 0.924 Test Loss: 0.468 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1040360927581787
Epoch: 21, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.037505865097046
Epoch: 22, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.424 Vali Acc: 0.916 Test Loss: 0.424 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.189819097518921
Epoch: 23, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.409 Vali Acc: 0.905 Test Loss: 0.409 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0467941761016846
Epoch: 24, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.383 Vali Acc: 0.927 Test Loss: 0.383 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1889960765838623
Epoch: 25, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.366 Vali Acc: 0.932 Test Loss: 0.366 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932429).  Saving model ...
Epoch: 26 cost time: 1.2111663818359375
Epoch: 26, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.337 Vali Acc: 0.927 Test Loss: 0.337 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.255129098892212
Epoch: 27, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2750887870788574
Epoch: 28, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.07963228225708
Epoch: 29, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 30 cost time: 0.8849401473999023
Epoch: 30, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.274158000946045
Epoch: 31, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.462986707687378
Epoch: 32, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1763782501220703
Epoch: 33, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.295 Vali Acc: 0.932 Test Loss: 0.295 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9919965267181396
Epoch: 34, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0554313659667969
Epoch: 35, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.288 Vali Acc: 0.927 Test Loss: 0.288 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0921101570129395
Epoch: 36, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9872763156890869
Epoch: 37, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.284 Vali Acc: 0.916 Test Loss: 0.284 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0182578563690186
Epoch: 38, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9984960556030273
Epoch: 39, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 40 cost time: 1.1327309608459473
Epoch: 40, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.036836862564087
Epoch: 41, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.267 Vali Acc: 0.932 Test Loss: 0.267 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1218760013580322
Epoch: 42, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.261 Vali Acc: 0.924 Test Loss: 0.261 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0864977836608887
Epoch: 43, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8797862529754639
Epoch: 44, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.47536039352417
Epoch: 45, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.924 Test Loss: 0.284 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9349405765533447
Epoch: 46, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8977582454681396
Epoch: 47, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.264 Vali Acc: 0.932 Test Loss: 0.264 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2870569229125977
Epoch: 48, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.344712495803833
Epoch: 49, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 124527
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8044819831848145
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.171 Vali Acc: 0.127 Test Loss: 2.171 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 0.887831449508667
Epoch: 2, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.053 Vali Acc: 0.259 Test Loss: 2.053 Test Acc: 0.259
Validation loss decreased (-0.127005 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 0.898674726486206
Epoch: 3, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.921 Vali Acc: 0.432 Test Loss: 1.921 Test Acc: 0.432
Validation loss decreased (-0.259439 --> -0.432413).  Saving model ...
Epoch: 4 cost time: 0.914254903793335
Epoch: 4, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.772 Vali Acc: 0.608 Test Loss: 1.772 Test Acc: 0.608
Validation loss decreased (-0.432413 --> -0.608090).  Saving model ...
Epoch: 5 cost time: 0.8689243793487549
Epoch: 5, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.633 Vali Acc: 0.711 Test Loss: 1.633 Test Acc: 0.711
Validation loss decreased (-0.608090 --> -0.710794).  Saving model ...
Epoch: 6 cost time: 0.7655813694000244
Epoch: 6, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.494 Vali Acc: 0.781 Test Loss: 1.494 Test Acc: 0.781
Validation loss decreased (-0.710794 --> -0.781066).  Saving model ...
Epoch: 7 cost time: 0.9668309688568115
Epoch: 7, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.356 Vali Acc: 0.830 Test Loss: 1.356 Test Acc: 0.830
Validation loss decreased (-0.781066 --> -0.829716).  Saving model ...
Epoch: 8 cost time: 0.8791301250457764
Epoch: 8, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.220 Vali Acc: 0.857 Test Loss: 1.220 Test Acc: 0.857
Validation loss decreased (-0.829716 --> -0.856745).  Saving model ...
Epoch: 9 cost time: 0.8962113857269287
Epoch: 9, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.090 Vali Acc: 0.886 Test Loss: 1.090 Test Acc: 0.886
Validation loss decreased (-0.856745 --> -0.886476).  Saving model ...
Epoch: 10 cost time: 1.0230190753936768
Epoch: 10, Steps: 17 | Train Loss: 0.913 Vali Loss: 0.997 Vali Acc: 0.873 Test Loss: 0.997 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9402241706848145
Epoch: 11, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.905 Vali Acc: 0.878 Test Loss: 0.905 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7933998107910156
Epoch: 12, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.816 Vali Acc: 0.914 Test Loss: 0.816 Test Acc: 0.914
Validation loss decreased (-0.886476 --> -0.913505).  Saving model ...
Epoch: 13 cost time: 0.960662841796875
Epoch: 13, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.744 Vali Acc: 0.911 Test Loss: 0.744 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9414489269256592
Epoch: 14, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.678 Vali Acc: 0.922 Test Loss: 0.678 Test Acc: 0.922
Validation loss decreased (-0.913505 --> -0.921615).  Saving model ...
Epoch: 15 cost time: 0.9875128269195557
Epoch: 15, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.620 Vali Acc: 0.924 Test Loss: 0.620 Test Acc: 0.924
Validation loss decreased (-0.921615 --> -0.924318).  Saving model ...
Epoch: 16 cost time: 1.0230529308319092
Epoch: 16, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.573 Vali Acc: 0.924 Test Loss: 0.573 Test Acc: 0.924
Validation loss decreased (-0.924318 --> -0.924319).  Saving model ...
Epoch: 17 cost time: 0.8747694492340088
Epoch: 17, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.550 Vali Acc: 0.927 Test Loss: 0.550 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927022).  Saving model ...
Epoch: 18 cost time: 1.0361073017120361
Epoch: 18, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.511 Vali Acc: 0.930 Test Loss: 0.511 Test Acc: 0.930
Validation loss decreased (-0.927022 --> -0.929725).  Saving model ...
Epoch: 19 cost time: 1.1072349548339844
Epoch: 19, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.470 Vali Acc: 0.927 Test Loss: 0.470 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9502580165863037
Epoch: 20, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.468 Vali Acc: 0.924 Test Loss: 0.468 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1426055431365967
Epoch: 21, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9136734008789062
Epoch: 22, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.424 Vali Acc: 0.916 Test Loss: 0.424 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9436461925506592
Epoch: 23, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.409 Vali Acc: 0.905 Test Loss: 0.409 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9232528209686279
Epoch: 24, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.383 Vali Acc: 0.927 Test Loss: 0.383 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9595155715942383
Epoch: 25, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.366 Vali Acc: 0.932 Test Loss: 0.366 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932429).  Saving model ...
Epoch: 26 cost time: 1.0332362651824951
Epoch: 26, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.337 Vali Acc: 0.927 Test Loss: 0.337 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3504910469055176
Epoch: 27, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9246554374694824
Epoch: 28, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9510724544525146
Epoch: 29, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 30 cost time: 0.8176784515380859
Epoch: 30, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0178248882293701
Epoch: 31, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9185009002685547
Epoch: 32, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8428249359130859
Epoch: 33, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.295 Vali Acc: 0.932 Test Loss: 0.295 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8822824954986572
Epoch: 34, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0712337493896484
Epoch: 35, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.288 Vali Acc: 0.927 Test Loss: 0.288 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9944086074829102
Epoch: 36, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8720426559448242
Epoch: 37, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.284 Vali Acc: 0.916 Test Loss: 0.284 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.037348985671997
Epoch: 38, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0672438144683838
Epoch: 39, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 40 cost time: 0.8795726299285889
Epoch: 40, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9009296894073486
Epoch: 41, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.267 Vali Acc: 0.932 Test Loss: 0.267 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0257718563079834
Epoch: 42, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.261 Vali Acc: 0.924 Test Loss: 0.261 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8863093852996826
Epoch: 43, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2396295070648193
Epoch: 44, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0060992240905762
Epoch: 45, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.924 Test Loss: 0.284 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9198012351989746
Epoch: 46, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9731760025024414
Epoch: 47, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.264 Vali Acc: 0.932 Test Loss: 0.264 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9622910022735596
Epoch: 48, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8893599510192871
Epoch: 49, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 124527
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.038907051086426
Epoch: 1, Steps: 17 | Train Loss: 2.292 Vali Loss: 2.241 Vali Acc: 0.068 Test Loss: 2.241 Test Acc: 0.068
Validation loss decreased (inf --> -0.067545).  Saving model ...
Epoch: 2 cost time: 1.0485830307006836
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.113 Vali Acc: 0.186 Test Loss: 2.113 Test Acc: 0.186
Validation loss decreased (-0.067545 --> -0.186465).  Saving model ...
Epoch: 3 cost time: 1.0255498886108398
Epoch: 3, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.945 Vali Acc: 0.397 Test Loss: 1.945 Test Acc: 0.397
Validation loss decreased (-0.186465 --> -0.397278).  Saving model ...
Epoch: 4 cost time: 1.051645278930664
Epoch: 4, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.812 Vali Acc: 0.568 Test Loss: 1.812 Test Acc: 0.568
Validation loss decreased (-0.397278 --> -0.567549).  Saving model ...
Epoch: 5 cost time: 1.2555186748504639
Epoch: 5, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.677 Vali Acc: 0.686 Test Loss: 1.677 Test Acc: 0.686
Validation loss decreased (-0.567549 --> -0.686470).  Saving model ...
Epoch: 6 cost time: 0.8459246158599854
Epoch: 6, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.549 Vali Acc: 0.757 Test Loss: 1.549 Test Acc: 0.757
Validation loss decreased (-0.686470 --> -0.756741).  Saving model ...
Epoch: 7 cost time: 1.107579231262207
Epoch: 7, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.434 Vali Acc: 0.805 Test Loss: 1.434 Test Acc: 0.805
Validation loss decreased (-0.756741 --> -0.805391).  Saving model ...
Epoch: 8 cost time: 1.0475053787231445
Epoch: 8, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.331 Vali Acc: 0.822 Test Loss: 1.331 Test Acc: 0.822
Validation loss decreased (-0.805391 --> -0.821608).  Saving model ...
Epoch: 9 cost time: 1.080690860748291
Epoch: 9, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.223 Vali Acc: 0.841 Test Loss: 1.223 Test Acc: 0.841
Validation loss decreased (-0.821608 --> -0.840528).  Saving model ...
Epoch: 10 cost time: 1.0933253765106201
Epoch: 10, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.133 Vali Acc: 0.857 Test Loss: 1.133 Test Acc: 0.857
Validation loss decreased (-0.840528 --> -0.856745).  Saving model ...
Epoch: 11 cost time: 1.0740442276000977
Epoch: 11, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.027 Vali Acc: 0.876 Test Loss: 1.027 Test Acc: 0.876
Validation loss decreased (-0.856745 --> -0.875665).  Saving model ...
Epoch: 12 cost time: 1.0175507068634033
Epoch: 12, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.951 Vali Acc: 0.884 Test Loss: 0.951 Test Acc: 0.884
Validation loss decreased (-0.875665 --> -0.883774).  Saving model ...
Epoch: 13 cost time: 0.9636318683624268
Epoch: 13, Steps: 17 | Train Loss: 0.771 Vali Loss: 0.865 Vali Acc: 0.897 Test Loss: 0.865 Test Acc: 0.897
Validation loss decreased (-0.883774 --> -0.897289).  Saving model ...
Epoch: 14 cost time: 0.996659517288208
Epoch: 14, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.803 Vali Acc: 0.895 Test Loss: 0.803 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9794576168060303
Epoch: 15, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.743 Vali Acc: 0.892 Test Loss: 0.743 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0027055740356445
Epoch: 16, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.678 Vali Acc: 0.911 Test Loss: 0.678 Test Acc: 0.911
Validation loss decreased (-0.897289 --> -0.910804).  Saving model ...
Epoch: 17 cost time: 1.2308266162872314
Epoch: 17, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.652 Vali Acc: 0.900 Test Loss: 0.652 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1644587516784668
Epoch: 18, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.612 Vali Acc: 0.916 Test Loss: 0.612 Test Acc: 0.916
Validation loss decreased (-0.910804 --> -0.916210).  Saving model ...
Epoch: 19 cost time: 0.8986632823944092
Epoch: 19, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.567 Vali Acc: 0.916 Test Loss: 0.567 Test Acc: 0.916
Validation loss decreased (-0.916210 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 1.0774531364440918
Epoch: 20, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.535 Vali Acc: 0.922 Test Loss: 0.535 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921616).  Saving model ...
Epoch: 21 cost time: 0.9770243167877197
Epoch: 21, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.500 Vali Acc: 0.924 Test Loss: 0.500 Test Acc: 0.924
Validation loss decreased (-0.921616 --> -0.924319).  Saving model ...
Epoch: 22 cost time: 1.2601757049560547
Epoch: 22, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.466 Vali Acc: 0.932 Test Loss: 0.466 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932428).  Saving model ...
Epoch: 23 cost time: 1.1192138195037842
Epoch: 23, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.444 Vali Acc: 0.927 Test Loss: 0.444 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2142612934112549
Epoch: 24, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.429 Vali Acc: 0.938 Test Loss: 0.429 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 25 cost time: 1.0567882061004639
Epoch: 25, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.402 Vali Acc: 0.935 Test Loss: 0.402 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2254447937011719
Epoch: 26, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.384 Vali Acc: 0.938 Test Loss: 0.384 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 27 cost time: 1.0372190475463867
Epoch: 27, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 28 cost time: 1.2326242923736572
Epoch: 28, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.352 Vali Acc: 0.943 Test Loss: 0.352 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 29 cost time: 1.1610054969787598
Epoch: 29, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.331 Vali Acc: 0.938 Test Loss: 0.331 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.130612850189209
Epoch: 30, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.328 Vali Acc: 0.946 Test Loss: 0.328 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 31 cost time: 1.1961333751678467
Epoch: 31, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.326 Vali Acc: 0.943 Test Loss: 0.326 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.231513261795044
Epoch: 32, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.312 Vali Acc: 0.938 Test Loss: 0.312 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3953394889831543
Epoch: 33, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.287 Vali Acc: 0.943 Test Loss: 0.287 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.056455373764038
Epoch: 34, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.297 Vali Acc: 0.932 Test Loss: 0.297 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1576814651489258
Epoch: 35, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.294 Vali Acc: 0.935 Test Loss: 0.294 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9831380844116211
Epoch: 36, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2769975662231445
Epoch: 37, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0809731483459473
Epoch: 38, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.270 Vali Acc: 0.927 Test Loss: 0.270 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0692484378814697
Epoch: 39, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.268 Vali Acc: 0.932 Test Loss: 0.268 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2552752494812012
Epoch: 40, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.275 Vali Acc: 0.938 Test Loss: 0.275 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 130471
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.874645233154297
Epoch: 1, Steps: 17 | Train Loss: 2.298 Vali Loss: 2.256 Vali Acc: 0.068 Test Loss: 2.256 Test Acc: 0.068
Validation loss decreased (inf --> -0.067545).  Saving model ...
Epoch: 2 cost time: 1.14473295211792
Epoch: 2, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.153 Vali Acc: 0.141 Test Loss: 2.153 Test Acc: 0.141
Validation loss decreased (-0.067545 --> -0.140519).  Saving model ...
Epoch: 3 cost time: 1.1788034439086914
Epoch: 3, Steps: 17 | Train Loss: 2.078 Vali Loss: 2.023 Vali Acc: 0.295 Test Loss: 2.023 Test Acc: 0.295
Validation loss decreased (-0.140519 --> -0.294574).  Saving model ...
Epoch: 4 cost time: 1.1523334980010986
Epoch: 4, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.874 Vali Acc: 0.565 Test Loss: 1.874 Test Acc: 0.565
Validation loss decreased (-0.294574 --> -0.564846).  Saving model ...
Epoch: 5 cost time: 1.1390385627746582
Epoch: 5, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.739 Vali Acc: 0.681 Test Loss: 1.739 Test Acc: 0.681
Validation loss decreased (-0.564846 --> -0.681064).  Saving model ...
Epoch: 6 cost time: 1.4105305671691895
Epoch: 6, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.612 Vali Acc: 0.732 Test Loss: 1.612 Test Acc: 0.732
Validation loss decreased (-0.681064 --> -0.732416).  Saving model ...
Epoch: 7 cost time: 1.2304952144622803
Epoch: 7, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.483 Vali Acc: 0.773 Test Loss: 1.483 Test Acc: 0.773
Validation loss decreased (-0.732416 --> -0.772958).  Saving model ...
Epoch: 8 cost time: 1.0139029026031494
Epoch: 8, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.368 Vali Acc: 0.811 Test Loss: 1.368 Test Acc: 0.811
Validation loss decreased (-0.772958 --> -0.810797).  Saving model ...
Epoch: 9 cost time: 1.2371141910552979
Epoch: 9, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.257 Vali Acc: 0.827 Test Loss: 1.257 Test Acc: 0.827
Validation loss decreased (-0.810797 --> -0.827014).  Saving model ...
Epoch: 10 cost time: 1.4673740863800049
Epoch: 10, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.143 Vali Acc: 0.838 Test Loss: 1.143 Test Acc: 0.838
Validation loss decreased (-0.827014 --> -0.837826).  Saving model ...
Epoch: 11 cost time: 1.2302093505859375
Epoch: 11, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.051 Vali Acc: 0.843 Test Loss: 1.051 Test Acc: 0.843
Validation loss decreased (-0.837826 --> -0.843233).  Saving model ...
Epoch: 12 cost time: 1.0872528553009033
Epoch: 12, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.954 Vali Acc: 0.859 Test Loss: 0.954 Test Acc: 0.859
Validation loss decreased (-0.843233 --> -0.859450).  Saving model ...
Epoch: 13 cost time: 1.0791409015655518
Epoch: 13, Steps: 17 | Train Loss: 0.756 Vali Loss: 0.886 Vali Acc: 0.857 Test Loss: 0.886 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8794577121734619
Epoch: 14, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.820 Vali Acc: 0.873 Test Loss: 0.820 Test Acc: 0.873
Validation loss decreased (-0.859450 --> -0.872965).  Saving model ...
Epoch: 15 cost time: 1.0026192665100098
Epoch: 15, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.755 Vali Acc: 0.881 Test Loss: 0.755 Test Acc: 0.881
Validation loss decreased (-0.872965 --> -0.881074).  Saving model ...
Epoch: 16 cost time: 1.120612621307373
Epoch: 16, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.705 Vali Acc: 0.897 Test Loss: 0.705 Test Acc: 0.897
Validation loss decreased (-0.881074 --> -0.897290).  Saving model ...
Epoch: 17 cost time: 0.8794291019439697
Epoch: 17, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
Validation loss decreased (-0.897290 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 1.112950086593628
Epoch: 18, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.588 Vali Acc: 0.903 Test Loss: 0.588 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 1.1593561172485352
Epoch: 19, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.567 Vali Acc: 0.908 Test Loss: 0.567 Test Acc: 0.908
Validation loss decreased (-0.902697 --> -0.908102).  Saving model ...
Epoch: 20 cost time: 1.0600605010986328
Epoch: 20, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.523 Vali Acc: 0.908 Test Loss: 0.523 Test Acc: 0.908
Validation loss decreased (-0.908102 --> -0.908103).  Saving model ...
Epoch: 21 cost time: 1.3164002895355225
Epoch: 21, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.487 Vali Acc: 0.916 Test Loss: 0.487 Test Acc: 0.916
Validation loss decreased (-0.908103 --> -0.916211).  Saving model ...
Epoch: 22 cost time: 1.1623530387878418
Epoch: 22, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.483 Vali Acc: 0.914 Test Loss: 0.483 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0036511421203613
Epoch: 23, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.441 Vali Acc: 0.916 Test Loss: 0.441 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916212).  Saving model ...
Epoch: 24 cost time: 1.0819997787475586
Epoch: 24, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.421 Vali Acc: 0.919 Test Loss: 0.421 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 1.2638695240020752
Epoch: 25, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.410 Vali Acc: 0.919 Test Loss: 0.410 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 26 cost time: 1.2916252613067627
Epoch: 26, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.384 Vali Acc: 0.919 Test Loss: 0.384 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 1.117790937423706
Epoch: 27, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 28 cost time: 1.1423568725585938
Epoch: 28, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0963037014007568
Epoch: 29, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.345 Vali Acc: 0.919 Test Loss: 0.345 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1889512538909912
Epoch: 30, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929727).  Saving model ...
Epoch: 31 cost time: 1.3308038711547852
Epoch: 31, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.326 Vali Acc: 0.927 Test Loss: 0.326 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1733100414276123
Epoch: 32, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.317 Vali Acc: 0.932 Test Loss: 0.317 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932429).  Saving model ...
Epoch: 33 cost time: 1.3719608783721924
Epoch: 33, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.299 Vali Acc: 0.935 Test Loss: 0.299 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 34 cost time: 1.3377294540405273
Epoch: 34, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.284 Vali Acc: 0.935 Test Loss: 0.284 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 35 cost time: 1.4464337825775146
Epoch: 35, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3008460998535156
Epoch: 36, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.266 Vali Acc: 0.943 Test Loss: 0.266 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 37 cost time: 1.4141216278076172
Epoch: 37, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4892334938049316
Epoch: 38, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2588138580322266
Epoch: 39, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.278 Vali Acc: 0.935 Test Loss: 0.278 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2398817539215088
Epoch: 40, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2420523166656494
Epoch: 41, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.274 Vali Acc: 0.938 Test Loss: 0.274 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0818963050842285
Epoch: 42, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3621735572814941
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0743074417114258
Epoch: 44, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1164789199829102
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2072339057922363
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.239 Vali Acc: 0.949 Test Loss: 0.239 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948646).  Saving model ...
Epoch: 47 cost time: 1.3677165508270264
Epoch: 47, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.951 Test Loss: 0.239 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 48 cost time: 1.3787531852722168
Epoch: 48, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.240 Vali Acc: 0.949 Test Loss: 0.240 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2915892601013184
Epoch: 49, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.369830846786499
Epoch: 50, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.949 Test Loss: 0.228 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2101242542266846
Epoch: 51, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.380836009979248
Epoch: 52, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 53 cost time: 1.4426968097686768
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0799553394317627
Epoch: 54, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2768230438232422
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1261897087097168
Epoch: 56, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.3768362998962402
Epoch: 57, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2320928573608398
Epoch: 58, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.3942914009094238
Epoch: 59, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.2901315689086914
Epoch: 60, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.49161958694458
Epoch: 61, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.5651330947875977
Epoch: 62, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 128423
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.144817590713501
Epoch: 1, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.163 Vali Acc: 0.186 Test Loss: 2.163 Test Acc: 0.186
Validation loss decreased (inf --> -0.186465).  Saving model ...
Epoch: 2 cost time: 1.1842796802520752
Epoch: 2, Steps: 17 | Train Loss: 2.097 Vali Loss: 2.054 Vali Acc: 0.295 Test Loss: 2.054 Test Acc: 0.295
Validation loss decreased (-0.186465 --> -0.294574).  Saving model ...
Epoch: 3 cost time: 1.23720383644104
Epoch: 3, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.934 Vali Acc: 0.446 Test Loss: 1.934 Test Acc: 0.446
Validation loss decreased (-0.294574 --> -0.445927).  Saving model ...
Epoch: 4 cost time: 1.0041773319244385
Epoch: 4, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.807 Vali Acc: 0.576 Test Loss: 1.807 Test Acc: 0.576
Validation loss decreased (-0.445927 --> -0.575658).  Saving model ...
Epoch: 5 cost time: 1.3534834384918213
Epoch: 5, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.678 Vali Acc: 0.673 Test Loss: 1.678 Test Acc: 0.673
Validation loss decreased (-0.575658 --> -0.672956).  Saving model ...
Epoch: 6 cost time: 1.1108007431030273
Epoch: 6, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.567 Vali Acc: 0.732 Test Loss: 1.567 Test Acc: 0.732
Validation loss decreased (-0.672956 --> -0.732417).  Saving model ...
Epoch: 7 cost time: 0.9817819595336914
Epoch: 7, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.457 Vali Acc: 0.770 Test Loss: 1.457 Test Acc: 0.770
Validation loss decreased (-0.732417 --> -0.770256).  Saving model ...
Epoch: 8 cost time: 1.0136497020721436
Epoch: 8, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.330 Vali Acc: 0.811 Test Loss: 1.330 Test Acc: 0.811
Validation loss decreased (-0.770256 --> -0.810798).  Saving model ...
Epoch: 9 cost time: 1.029731035232544
Epoch: 9, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.234 Vali Acc: 0.827 Test Loss: 1.234 Test Acc: 0.827
Validation loss decreased (-0.810798 --> -0.827015).  Saving model ...
Epoch: 10 cost time: 1.0834941864013672
Epoch: 10, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.129 Vali Acc: 0.857 Test Loss: 1.129 Test Acc: 0.857
Validation loss decreased (-0.827015 --> -0.856745).  Saving model ...
Epoch: 11 cost time: 1.20343017578125
Epoch: 11, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.048 Vali Acc: 0.849 Test Loss: 1.048 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0900459289550781
Epoch: 12, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.950 Vali Acc: 0.868 Test Loss: 0.950 Test Acc: 0.868
Validation loss decreased (-0.856745 --> -0.867558).  Saving model ...
Epoch: 13 cost time: 1.0687401294708252
Epoch: 13, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.871 Vali Acc: 0.870 Test Loss: 0.871 Test Acc: 0.870
Validation loss decreased (-0.867558 --> -0.870262).  Saving model ...
Epoch: 14 cost time: 1.2677459716796875
Epoch: 14, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.797 Vali Acc: 0.884 Test Loss: 0.797 Test Acc: 0.884
Validation loss decreased (-0.870262 --> -0.883776).  Saving model ...
Epoch: 15 cost time: 1.1647415161132812
Epoch: 15, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.734 Vali Acc: 0.895 Test Loss: 0.734 Test Acc: 0.895
Validation loss decreased (-0.883776 --> -0.894587).  Saving model ...
Epoch: 16 cost time: 1.595285415649414
Epoch: 16, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.691 Vali Acc: 0.903 Test Loss: 0.691 Test Acc: 0.903
Validation loss decreased (-0.894587 --> -0.902696).  Saving model ...
Epoch: 17 cost time: 1.1036405563354492
Epoch: 17, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.631 Vali Acc: 0.892 Test Loss: 0.631 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2588374614715576
Epoch: 18, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.600 Vali Acc: 0.897 Test Loss: 0.600 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3186116218566895
Epoch: 19, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.540 Vali Acc: 0.916 Test Loss: 0.540 Test Acc: 0.916
Validation loss decreased (-0.902696 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 1.3772189617156982
Epoch: 20, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.519 Vali Acc: 0.905 Test Loss: 0.519 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1150364875793457
Epoch: 21, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4402928352355957
Epoch: 22, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.451 Vali Acc: 0.916 Test Loss: 0.451 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916212).  Saving model ...
Epoch: 23 cost time: 1.106435775756836
Epoch: 23, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.449 Vali Acc: 0.908 Test Loss: 0.449 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2207438945770264
Epoch: 24, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 1.3420071601867676
Epoch: 25, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 26 cost time: 1.3187916278839111
Epoch: 26, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.355 Vali Acc: 0.927 Test Loss: 0.355 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927023).  Saving model ...
Epoch: 27 cost time: 1.2283616065979004
Epoch: 27, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3115649223327637
Epoch: 28, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.495180368423462
Epoch: 29, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.327 Vali Acc: 0.924 Test Loss: 0.327 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0614447593688965
Epoch: 30, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.312 Vali Acc: 0.932 Test Loss: 0.312 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 31 cost time: 1.4721696376800537
Epoch: 31, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.315 Vali Acc: 0.916 Test Loss: 0.315 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.186048984527588
Epoch: 32, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2991549968719482
Epoch: 33, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.15926194190979
Epoch: 34, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.538792371749878
Epoch: 35, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.270 Vali Acc: 0.927 Test Loss: 0.270 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.447969675064087
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3011837005615234
Epoch: 37, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4656200408935547
Epoch: 38, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.467296838760376
Epoch: 39, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.258 Vali Acc: 0.927 Test Loss: 0.258 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.185558795928955
Epoch: 40, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.257 Vali Acc: 0.927 Test Loss: 0.257 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9324324324324325
model parameter : 126375
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.440253496170044
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.147 Vali Acc: 0.203 Test Loss: 2.147 Test Acc: 0.203
Validation loss decreased (inf --> -0.202681).  Saving model ...
Epoch: 2 cost time: 1.02583909034729
Epoch: 2, Steps: 17 | Train Loss: 2.134 Vali Loss: 2.017 Vali Acc: 0.397 Test Loss: 2.017 Test Acc: 0.397
Validation loss decreased (-0.202681 --> -0.397277).  Saving model ...
Epoch: 3 cost time: 1.1218762397766113
Epoch: 3, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.870 Vali Acc: 0.576 Test Loss: 1.870 Test Acc: 0.576
Validation loss decreased (-0.397277 --> -0.575657).  Saving model ...
Epoch: 4 cost time: 1.425370693206787
Epoch: 4, Steps: 17 | Train Loss: 1.810 Vali Loss: 1.732 Vali Acc: 0.724 Test Loss: 1.732 Test Acc: 0.724
Validation loss decreased (-0.575657 --> -0.724307).  Saving model ...
Epoch: 5 cost time: 1.0466711521148682
Epoch: 5, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.598 Vali Acc: 0.781 Test Loss: 1.598 Test Acc: 0.781
Validation loss decreased (-0.724307 --> -0.781065).  Saving model ...
Epoch: 6 cost time: 1.2563683986663818
Epoch: 6, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.470 Vali Acc: 0.797 Test Loss: 1.470 Test Acc: 0.797
Validation loss decreased (-0.781065 --> -0.797283).  Saving model ...
Epoch: 7 cost time: 1.2175266742706299
Epoch: 7, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.347 Vali Acc: 0.819 Test Loss: 1.347 Test Acc: 0.819
Validation loss decreased (-0.797283 --> -0.818905).  Saving model ...
Epoch: 8 cost time: 1.2189750671386719
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.225 Vali Acc: 0.832 Test Loss: 1.225 Test Acc: 0.832
Validation loss decreased (-0.818905 --> -0.832420).  Saving model ...
Epoch: 9 cost time: 1.1876106262207031
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.108 Vali Acc: 0.851 Test Loss: 1.108 Test Acc: 0.851
Validation loss decreased (-0.832420 --> -0.851340).  Saving model ...
Epoch: 10 cost time: 0.867609977722168
Epoch: 10, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.026 Vali Acc: 0.843 Test Loss: 1.026 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2054648399353027
Epoch: 11, Steps: 17 | Train Loss: 0.841 Vali Loss: 0.919 Vali Acc: 0.868 Test Loss: 0.919 Test Acc: 0.868
Validation loss decreased (-0.851340 --> -0.867558).  Saving model ...
Epoch: 12 cost time: 1.2301247119903564
Epoch: 12, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.843 Vali Acc: 0.873 Test Loss: 0.843 Test Acc: 0.873
Validation loss decreased (-0.867558 --> -0.872965).  Saving model ...
Epoch: 13 cost time: 1.0169167518615723
Epoch: 13, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.792 Vali Acc: 0.892 Test Loss: 0.792 Test Acc: 0.892
Validation loss decreased (-0.872965 --> -0.891884).  Saving model ...
Epoch: 14 cost time: 0.8656458854675293
Epoch: 14, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.705 Vali Acc: 0.889 Test Loss: 0.705 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9440207481384277
Epoch: 15, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.661 Vali Acc: 0.897 Test Loss: 0.661 Test Acc: 0.897
Validation loss decreased (-0.891884 --> -0.897291).  Saving model ...
Epoch: 16 cost time: 0.8940184116363525
Epoch: 16, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.609 Vali Acc: 0.905 Test Loss: 0.609 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905399).  Saving model ...
Epoch: 17 cost time: 1.362903118133545
Epoch: 17, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.565 Vali Acc: 0.914 Test Loss: 0.565 Test Acc: 0.914
Validation loss decreased (-0.905399 --> -0.913508).  Saving model ...
Epoch: 18 cost time: 1.1912813186645508
Epoch: 18, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.536 Vali Acc: 0.924 Test Loss: 0.536 Test Acc: 0.924
Validation loss decreased (-0.913508 --> -0.924319).  Saving model ...
Epoch: 19 cost time: 1.041780948638916
Epoch: 19, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.522 Vali Acc: 0.908 Test Loss: 0.522 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1246724128723145
Epoch: 20, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.475 Vali Acc: 0.919 Test Loss: 0.475 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3843567371368408
Epoch: 21, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.474 Vali Acc: 0.914 Test Loss: 0.474 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9895963668823242
Epoch: 22, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4592013359069824
Epoch: 23, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.924319 --> -0.924320).  Saving model ...
Epoch: 24 cost time: 1.296180009841919
Epoch: 24, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.401 Vali Acc: 0.916 Test Loss: 0.401 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2206916809082031
Epoch: 25, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5913541316986084
Epoch: 26, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.356 Vali Acc: 0.924 Test Loss: 0.356 Test Acc: 0.924
Validation loss decreased (-0.924320 --> -0.924321).  Saving model ...
Epoch: 27 cost time: 1.0229151248931885
Epoch: 27, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.349 Vali Acc: 0.919 Test Loss: 0.349 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.150141716003418
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2537131309509277
Epoch: 29, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.320 Vali Acc: 0.927 Test Loss: 0.320 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 30 cost time: 1.2042698860168457
Epoch: 30, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3628110885620117
Epoch: 31, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.281585454940796
Epoch: 32, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1664021015167236
Epoch: 33, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.313 Vali Acc: 0.924 Test Loss: 0.313 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1263928413391113
Epoch: 34, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.301 Vali Acc: 0.924 Test Loss: 0.301 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4090211391448975
Epoch: 35, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 36 cost time: 1.1051430702209473
Epoch: 36, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5120289325714111
Epoch: 37, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.290 Vali Acc: 0.924 Test Loss: 0.290 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9737353324890137
Epoch: 38, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.914 Test Loss: 0.299 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1000559329986572
Epoch: 39, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3121092319488525
Epoch: 40, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1747078895568848
Epoch: 41, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.323 Vali Acc: 0.914 Test Loss: 0.323 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.4481844902038574
Epoch: 42, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3933732509613037
Epoch: 43, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.105928659439087
Epoch: 44, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0814931392669678
Epoch: 45, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.927027027027027
model parameter : 124327
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4944868087768555
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.147 Vali Acc: 0.203 Test Loss: 2.147 Test Acc: 0.203
Validation loss decreased (inf --> -0.202681).  Saving model ...
Epoch: 2 cost time: 0.9870240688323975
Epoch: 2, Steps: 17 | Train Loss: 2.134 Vali Loss: 2.017 Vali Acc: 0.397 Test Loss: 2.017 Test Acc: 0.397
Validation loss decreased (-0.202681 --> -0.397277).  Saving model ...
Epoch: 3 cost time: 1.24825119972229
Epoch: 3, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.870 Vali Acc: 0.576 Test Loss: 1.870 Test Acc: 0.576
Validation loss decreased (-0.397277 --> -0.575657).  Saving model ...
Epoch: 4 cost time: 1.1581509113311768
Epoch: 4, Steps: 17 | Train Loss: 1.810 Vali Loss: 1.732 Vali Acc: 0.724 Test Loss: 1.732 Test Acc: 0.724
Validation loss decreased (-0.575657 --> -0.724307).  Saving model ...
Epoch: 5 cost time: 0.8434841632843018
Epoch: 5, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.598 Vali Acc: 0.781 Test Loss: 1.598 Test Acc: 0.781
Validation loss decreased (-0.724307 --> -0.781065).  Saving model ...
Epoch: 6 cost time: 0.9732253551483154
Epoch: 6, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.470 Vali Acc: 0.797 Test Loss: 1.470 Test Acc: 0.797
Validation loss decreased (-0.781065 --> -0.797283).  Saving model ...
Epoch: 7 cost time: 0.9790995121002197
Epoch: 7, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.347 Vali Acc: 0.819 Test Loss: 1.347 Test Acc: 0.819
Validation loss decreased (-0.797283 --> -0.818905).  Saving model ...
Epoch: 8 cost time: 0.926506757736206
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.225 Vali Acc: 0.832 Test Loss: 1.225 Test Acc: 0.832
Validation loss decreased (-0.818905 --> -0.832420).  Saving model ...
Epoch: 9 cost time: 0.9032196998596191
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.108 Vali Acc: 0.851 Test Loss: 1.108 Test Acc: 0.851
Validation loss decreased (-0.832420 --> -0.851340).  Saving model ...
Epoch: 10 cost time: 1.007737159729004
Epoch: 10, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.026 Vali Acc: 0.843 Test Loss: 1.026 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1344413757324219
Epoch: 11, Steps: 17 | Train Loss: 0.841 Vali Loss: 0.919 Vali Acc: 0.868 Test Loss: 0.919 Test Acc: 0.868
Validation loss decreased (-0.851340 --> -0.867558).  Saving model ...
Epoch: 12 cost time: 1.1316685676574707
Epoch: 12, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.843 Vali Acc: 0.873 Test Loss: 0.843 Test Acc: 0.873
Validation loss decreased (-0.867558 --> -0.872965).  Saving model ...
Epoch: 13 cost time: 0.9771478176116943
Epoch: 13, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.792 Vali Acc: 0.892 Test Loss: 0.792 Test Acc: 0.892
Validation loss decreased (-0.872965 --> -0.891884).  Saving model ...
Epoch: 14 cost time: 1.1116368770599365
Epoch: 14, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.705 Vali Acc: 0.889 Test Loss: 0.705 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2933316230773926
Epoch: 15, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.661 Vali Acc: 0.897 Test Loss: 0.661 Test Acc: 0.897
Validation loss decreased (-0.891884 --> -0.897291).  Saving model ...
Epoch: 16 cost time: 1.096580982208252
Epoch: 16, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.609 Vali Acc: 0.905 Test Loss: 0.609 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905399).  Saving model ...
Epoch: 17 cost time: 1.0557105541229248
Epoch: 17, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.565 Vali Acc: 0.914 Test Loss: 0.565 Test Acc: 0.914
Validation loss decreased (-0.905399 --> -0.913508).  Saving model ...
Epoch: 18 cost time: 1.2889177799224854
Epoch: 18, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.536 Vali Acc: 0.924 Test Loss: 0.536 Test Acc: 0.924
Validation loss decreased (-0.913508 --> -0.924319).  Saving model ...
Epoch: 19 cost time: 1.0037391185760498
Epoch: 19, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.522 Vali Acc: 0.908 Test Loss: 0.522 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1198527812957764
Epoch: 20, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.475 Vali Acc: 0.919 Test Loss: 0.475 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9652144908905029
Epoch: 21, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.474 Vali Acc: 0.914 Test Loss: 0.474 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1114416122436523
Epoch: 22, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.104074239730835
Epoch: 23, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.924319 --> -0.924320).  Saving model ...
Epoch: 24 cost time: 1.0982749462127686
Epoch: 24, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.401 Vali Acc: 0.916 Test Loss: 0.401 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.102586030960083
Epoch: 25, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1563763618469238
Epoch: 26, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.356 Vali Acc: 0.924 Test Loss: 0.356 Test Acc: 0.924
Validation loss decreased (-0.924320 --> -0.924321).  Saving model ...
Epoch: 27 cost time: 1.0354528427124023
Epoch: 27, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.349 Vali Acc: 0.919 Test Loss: 0.349 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1625349521636963
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0622951984405518
Epoch: 29, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.320 Vali Acc: 0.927 Test Loss: 0.320 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 30 cost time: 1.1709587574005127
Epoch: 30, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1781015396118164
Epoch: 31, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0879321098327637
Epoch: 32, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3858463764190674
Epoch: 33, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.313 Vali Acc: 0.924 Test Loss: 0.313 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1871137619018555
Epoch: 34, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.301 Vali Acc: 0.924 Test Loss: 0.301 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5408992767333984
Epoch: 35, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 36 cost time: 0.9660530090332031
Epoch: 36, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1498043537139893
Epoch: 37, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.290 Vali Acc: 0.924 Test Loss: 0.290 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1207468509674072
Epoch: 38, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.914 Test Loss: 0.299 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9988038539886475
Epoch: 39, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.229231834411621
Epoch: 40, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0757215023040771
Epoch: 41, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.323 Vali Acc: 0.914 Test Loss: 0.323 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0111339092254639
Epoch: 42, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.128753900527954
Epoch: 43, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.4315099716186523
Epoch: 44, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0669434070587158
Epoch: 45, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.927027027027027
model parameter : 124327
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.066473960876465
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.207 Vali Acc: 0.100 Test Loss: 2.207 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 1.2852604389190674
Epoch: 2, Steps: 17 | Train Loss: 2.106 Vali Loss: 2.093 Vali Acc: 0.232 Test Loss: 2.093 Test Acc: 0.232
Validation loss decreased (-0.099978 --> -0.232412).  Saving model ...
Epoch: 3 cost time: 1.424368143081665
Epoch: 3, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.941 Vali Acc: 0.362 Test Loss: 1.941 Test Acc: 0.362
Validation loss decreased (-0.232412 --> -0.362143).  Saving model ...
Epoch: 4 cost time: 1.0802783966064453
Epoch: 4, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.794 Vali Acc: 0.519 Test Loss: 1.794 Test Acc: 0.519
Validation loss decreased (-0.362143 --> -0.518901).  Saving model ...
Epoch: 5 cost time: 1.369157314300537
Epoch: 5, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.665 Vali Acc: 0.668 Test Loss: 1.665 Test Acc: 0.668
Validation loss decreased (-0.518901 --> -0.667551).  Saving model ...
Epoch: 6 cost time: 1.469472885131836
Epoch: 6, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.545 Vali Acc: 0.711 Test Loss: 1.545 Test Acc: 0.711
Validation loss decreased (-0.667551 --> -0.710795).  Saving model ...
Epoch: 7 cost time: 1.5319766998291016
Epoch: 7, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.431 Vali Acc: 0.732 Test Loss: 1.431 Test Acc: 0.732
Validation loss decreased (-0.710795 --> -0.732418).  Saving model ...
Epoch: 8 cost time: 1.1294357776641846
Epoch: 8, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.295 Vali Acc: 0.776 Test Loss: 1.295 Test Acc: 0.776
Validation loss decreased (-0.732418 --> -0.775663).  Saving model ...
Epoch: 9 cost time: 1.1095292568206787
Epoch: 9, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.185 Vali Acc: 0.805 Test Loss: 1.185 Test Acc: 0.805
Validation loss decreased (-0.775663 --> -0.805394).  Saving model ...
Epoch: 10 cost time: 1.3254425525665283
Epoch: 10, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.074 Vali Acc: 0.814 Test Loss: 1.074 Test Acc: 0.814
Validation loss decreased (-0.805394 --> -0.813503).  Saving model ...
Epoch: 11 cost time: 1.4195570945739746
Epoch: 11, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.968 Vali Acc: 0.849 Test Loss: 0.968 Test Acc: 0.849
Validation loss decreased (-0.813503 --> -0.848639).  Saving model ...
Epoch: 12 cost time: 1.1979341506958008
Epoch: 12, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.899 Vali Acc: 0.854 Test Loss: 0.899 Test Acc: 0.854
Validation loss decreased (-0.848639 --> -0.854045).  Saving model ...
Epoch: 13 cost time: 1.380699634552002
Epoch: 13, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.813 Vali Acc: 0.859 Test Loss: 0.813 Test Acc: 0.859
Validation loss decreased (-0.854045 --> -0.859451).  Saving model ...
Epoch: 14 cost time: 1.2105019092559814
Epoch: 14, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.733 Vali Acc: 0.876 Test Loss: 0.733 Test Acc: 0.876
Validation loss decreased (-0.859451 --> -0.875668).  Saving model ...
Epoch: 15 cost time: 1.3069682121276855
Epoch: 15, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.697 Vali Acc: 0.881 Test Loss: 0.697 Test Acc: 0.881
Validation loss decreased (-0.875668 --> -0.881074).  Saving model ...
Epoch: 16 cost time: 1.1416354179382324
Epoch: 16, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.636 Vali Acc: 0.895 Test Loss: 0.636 Test Acc: 0.895
Validation loss decreased (-0.881074 --> -0.894588).  Saving model ...
Epoch: 17 cost time: 1.3681299686431885
Epoch: 17, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.592 Vali Acc: 0.889 Test Loss: 0.592 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1996803283691406
Epoch: 18, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.550 Vali Acc: 0.905 Test Loss: 0.550 Test Acc: 0.905
Validation loss decreased (-0.894588 --> -0.905400).  Saving model ...
Epoch: 19 cost time: 1.0061545372009277
Epoch: 19, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.510 Vali Acc: 0.914 Test Loss: 0.510 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913508).  Saving model ...
Epoch: 20 cost time: 1.344470500946045
Epoch: 20, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.468 Vali Acc: 0.916 Test Loss: 0.468 Test Acc: 0.916
Validation loss decreased (-0.913508 --> -0.916212).  Saving model ...
Epoch: 21 cost time: 1.4625115394592285
Epoch: 21, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.451 Vali Acc: 0.924 Test Loss: 0.451 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924320).  Saving model ...
Epoch: 22 cost time: 1.4592127799987793
Epoch: 22, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2580041885375977
Epoch: 23, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.398 Vali Acc: 0.927 Test Loss: 0.398 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 24 cost time: 1.1125726699829102
Epoch: 24, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 25 cost time: 1.1528890132904053
Epoch: 25, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.366 Vali Acc: 0.927 Test Loss: 0.366 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6777875423431396
Epoch: 26, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.339 Vali Acc: 0.932 Test Loss: 0.339 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 27 cost time: 0.9703905582427979
Epoch: 27, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940537).  Saving model ...
Epoch: 28 cost time: 1.2489798069000244
Epoch: 28, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.323 Vali Acc: 0.935 Test Loss: 0.323 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0747346878051758
Epoch: 29, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 30 cost time: 1.0440030097961426
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.293 Vali Acc: 0.938 Test Loss: 0.293 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.122370719909668
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 32 cost time: 1.2267053127288818
Epoch: 32, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.122915506362915
Epoch: 33, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.277 Vali Acc: 0.932 Test Loss: 0.277 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.964484691619873
Epoch: 34, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1898736953735352
Epoch: 35, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.289426565170288
Epoch: 36, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.255 Vali Acc: 0.935 Test Loss: 0.255 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3415906429290771
Epoch: 37, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3807721138000488
Epoch: 38, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 39 cost time: 1.2547032833099365
Epoch: 39, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.230 Vali Acc: 0.932 Test Loss: 0.230 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6024255752563477
Epoch: 40, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2482326030731201
Epoch: 41, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.222 Vali Acc: 0.938 Test Loss: 0.222 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.51615309715271
Epoch: 42, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.271291732788086
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4182050228118896
Epoch: 44, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3198590278625488
Epoch: 45, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 46 cost time: 1.1251542568206787
Epoch: 46, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.932 Test Loss: 0.209 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2597849369049072
Epoch: 47, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.218 Vali Acc: 0.938 Test Loss: 0.218 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4966354370117188
Epoch: 48, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2146003246307373
Epoch: 49, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 50 cost time: 1.3080694675445557
Epoch: 50, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 51 cost time: 1.3480350971221924
Epoch: 51, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.938 Test Loss: 0.198 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3848958015441895
Epoch: 52, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.7813572883605957
Epoch: 53, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.432368516921997
Epoch: 54, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2226085662841797
Epoch: 55, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3068530559539795
Epoch: 56, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4093284606933594
Epoch: 57, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.3014123439788818
Epoch: 58, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.431793451309204
Epoch: 59, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.6693115234375
Epoch: 60, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 130371
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.970038652420044
Epoch: 1, Steps: 17 | Train Loss: 2.264 Vali Loss: 2.229 Vali Acc: 0.130 Test Loss: 2.229 Test Acc: 0.130
Validation loss decreased (inf --> -0.129707).  Saving model ...
Epoch: 2 cost time: 1.0249202251434326
Epoch: 2, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.108 Vali Acc: 0.222 Test Loss: 2.108 Test Acc: 0.222
Validation loss decreased (-0.129707 --> -0.221601).  Saving model ...
Epoch: 3 cost time: 1.029266357421875
Epoch: 3, Steps: 17 | Train Loss: 2.036 Vali Loss: 1.964 Vali Acc: 0.427 Test Loss: 1.964 Test Acc: 0.427
Validation loss decreased (-0.221601 --> -0.427007).  Saving model ...
Epoch: 4 cost time: 1.000166654586792
Epoch: 4, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.826 Vali Acc: 0.646 Test Loss: 1.826 Test Acc: 0.646
Validation loss decreased (-0.427007 --> -0.645928).  Saving model ...
Epoch: 5 cost time: 1.091034173965454
Epoch: 5, Steps: 17 | Train Loss: 1.743 Vali Loss: 1.687 Vali Acc: 0.751 Test Loss: 1.687 Test Acc: 0.751
Validation loss decreased (-0.645928 --> -0.751334).  Saving model ...
Epoch: 6 cost time: 1.1243748664855957
Epoch: 6, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.565 Vali Acc: 0.784 Test Loss: 1.565 Test Acc: 0.784
Validation loss decreased (-0.751334 --> -0.783768).  Saving model ...
Epoch: 7 cost time: 0.9993133544921875
Epoch: 7, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.438 Vali Acc: 0.808 Test Loss: 1.438 Test Acc: 0.808
Validation loss decreased (-0.783768 --> -0.808094).  Saving model ...
Epoch: 8 cost time: 1.039693832397461
Epoch: 8, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.316 Vali Acc: 0.835 Test Loss: 1.316 Test Acc: 0.835
Validation loss decreased (-0.808094 --> -0.835122).  Saving model ...
Epoch: 9 cost time: 0.892465353012085
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.189 Vali Acc: 0.843 Test Loss: 1.189 Test Acc: 0.843
Validation loss decreased (-0.835122 --> -0.843231).  Saving model ...
Epoch: 10 cost time: 1.0132746696472168
Epoch: 10, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.077 Vali Acc: 0.851 Test Loss: 1.077 Test Acc: 0.851
Validation loss decreased (-0.843231 --> -0.851341).  Saving model ...
Epoch: 11 cost time: 1.2260148525238037
Epoch: 11, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.979 Vali Acc: 0.873 Test Loss: 0.979 Test Acc: 0.873
Validation loss decreased (-0.851341 --> -0.872963).  Saving model ...
Epoch: 12 cost time: 1.100419521331787
Epoch: 12, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.887 Vali Acc: 0.876 Test Loss: 0.887 Test Acc: 0.876
Validation loss decreased (-0.872963 --> -0.875667).  Saving model ...
Epoch: 13 cost time: 1.1931488513946533
Epoch: 13, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.802 Vali Acc: 0.881 Test Loss: 0.802 Test Acc: 0.881
Validation loss decreased (-0.875667 --> -0.881073).  Saving model ...
Epoch: 14 cost time: 1.0084400177001953
Epoch: 14, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.754 Vali Acc: 0.897 Test Loss: 0.754 Test Acc: 0.897
Validation loss decreased (-0.881073 --> -0.897290).  Saving model ...
Epoch: 15 cost time: 1.019256353378296
Epoch: 15, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.678 Vali Acc: 0.895 Test Loss: 0.678 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0868794918060303
Epoch: 16, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.632 Vali Acc: 0.908 Test Loss: 0.632 Test Acc: 0.908
Validation loss decreased (-0.897290 --> -0.908102).  Saving model ...
Epoch: 17 cost time: 1.0498228073120117
Epoch: 17, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.579 Vali Acc: 0.905 Test Loss: 0.579 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3762977123260498
Epoch: 18, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.532 Vali Acc: 0.911 Test Loss: 0.532 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 19 cost time: 1.4405488967895508
Epoch: 19, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.513 Vali Acc: 0.916 Test Loss: 0.513 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 1.0486738681793213
Epoch: 20, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.481 Vali Acc: 0.916 Test Loss: 0.481 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916211).  Saving model ...
Epoch: 21 cost time: 1.260021448135376
Epoch: 21, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.444 Vali Acc: 0.919 Test Loss: 0.444 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918914).  Saving model ...
Epoch: 22 cost time: 1.4550261497497559
Epoch: 22, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 23 cost time: 1.2507073879241943
Epoch: 23, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.405 Vali Acc: 0.922 Test Loss: 0.405 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.053074598312378
Epoch: 24, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.381 Vali Acc: 0.916 Test Loss: 0.381 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.235689640045166
Epoch: 25, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.367 Vali Acc: 0.927 Test Loss: 0.367 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 26 cost time: 0.9455909729003906
Epoch: 26, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.345 Vali Acc: 0.932 Test Loss: 0.345 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 27 cost time: 1.42036771774292
Epoch: 27, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2693724632263184
Epoch: 28, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.325 Vali Acc: 0.938 Test Loss: 0.325 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 29 cost time: 1.0831687450408936
Epoch: 29, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.309 Vali Acc: 0.938 Test Loss: 0.309 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 30 cost time: 1.3269968032836914
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943240).  Saving model ...
Epoch: 31 cost time: 1.3218605518341064
Epoch: 31, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1501963138580322
Epoch: 32, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2369396686553955
Epoch: 33, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0460009574890137
Epoch: 34, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3947319984436035
Epoch: 35, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.265 Vali Acc: 0.932 Test Loss: 0.265 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.148059368133545
Epoch: 36, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2530717849731445
Epoch: 37, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.251 Vali Acc: 0.932 Test Loss: 0.251 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2199339866638184
Epoch: 38, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1308422088623047
Epoch: 39, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1372218132019043
Epoch: 40, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 128323
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.467320442199707
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.145 Vali Acc: 0.281 Test Loss: 2.145 Test Acc: 0.281
Validation loss decreased (inf --> -0.281060).  Saving model ...
Epoch: 2 cost time: 1.3095145225524902
Epoch: 2, Steps: 17 | Train Loss: 2.063 Vali Loss: 2.041 Vali Acc: 0.373 Test Loss: 2.041 Test Acc: 0.373
Validation loss decreased (-0.281060 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 1.0549418926239014
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.912 Vali Acc: 0.492 Test Loss: 1.912 Test Acc: 0.492
Validation loss decreased (-0.372953 --> -0.491873).  Saving model ...
Epoch: 4 cost time: 1.1420845985412598
Epoch: 4, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.775 Vali Acc: 0.627 Test Loss: 1.775 Test Acc: 0.627
Validation loss decreased (-0.491873 --> -0.627009).  Saving model ...
Epoch: 5 cost time: 1.4319617748260498
Epoch: 5, Steps: 17 | Train Loss: 1.658 Vali Loss: 1.640 Vali Acc: 0.732 Test Loss: 1.640 Test Acc: 0.732
Validation loss decreased (-0.627009 --> -0.732416).  Saving model ...
Epoch: 6 cost time: 1.4970574378967285
Epoch: 6, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.501 Vali Acc: 0.778 Test Loss: 1.501 Test Acc: 0.778
Validation loss decreased (-0.732416 --> -0.778363).  Saving model ...
Epoch: 7 cost time: 1.111985206604004
Epoch: 7, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.369 Vali Acc: 0.800 Test Loss: 1.369 Test Acc: 0.800
Validation loss decreased (-0.778363 --> -0.799986).  Saving model ...
Epoch: 8 cost time: 1.0865161418914795
Epoch: 8, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.241 Vali Acc: 0.827 Test Loss: 1.241 Test Acc: 0.827
Validation loss decreased (-0.799986 --> -0.827015).  Saving model ...
Epoch: 9 cost time: 1.2862958908081055
Epoch: 9, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.123 Vali Acc: 0.849 Test Loss: 1.123 Test Acc: 0.849
Validation loss decreased (-0.827015 --> -0.848637).  Saving model ...
Epoch: 10 cost time: 1.201446533203125
Epoch: 10, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.022 Vali Acc: 0.870 Test Loss: 1.022 Test Acc: 0.870
Validation loss decreased (-0.848637 --> -0.870260).  Saving model ...
Epoch: 11 cost time: 1.1137371063232422
Epoch: 11, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.926 Vali Acc: 0.878 Test Loss: 0.926 Test Acc: 0.878
Validation loss decreased (-0.870260 --> -0.878369).  Saving model ...
Epoch: 12 cost time: 1.096212387084961
Epoch: 12, Steps: 17 | Train Loss: 0.781 Vali Loss: 0.849 Vali Acc: 0.881 Test Loss: 0.849 Test Acc: 0.881
Validation loss decreased (-0.878369 --> -0.881073).  Saving model ...
Epoch: 13 cost time: 1.3869316577911377
Epoch: 13, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.783 Vali Acc: 0.881 Test Loss: 0.783 Test Acc: 0.881
Validation loss decreased (-0.881073 --> -0.881073).  Saving model ...
Epoch: 14 cost time: 1.1451833248138428
Epoch: 14, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.716 Vali Acc: 0.897 Test Loss: 0.716 Test Acc: 0.897
Validation loss decreased (-0.881073 --> -0.897290).  Saving model ...
Epoch: 15 cost time: 1.3163120746612549
Epoch: 15, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.668 Vali Acc: 0.895 Test Loss: 0.668 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1806890964508057
Epoch: 16, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.614 Vali Acc: 0.903 Test Loss: 0.614 Test Acc: 0.903
Validation loss decreased (-0.897290 --> -0.902697).  Saving model ...
Epoch: 17 cost time: 1.2271933555603027
Epoch: 17, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.585 Vali Acc: 0.903 Test Loss: 0.585 Test Acc: 0.903
Validation loss decreased (-0.902697 --> -0.902697).  Saving model ...
Epoch: 18 cost time: 1.122166395187378
Epoch: 18, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.545 Vali Acc: 0.908 Test Loss: 0.545 Test Acc: 0.908
Validation loss decreased (-0.902697 --> -0.908103).  Saving model ...
Epoch: 19 cost time: 1.2656021118164062
Epoch: 19, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.512 Vali Acc: 0.903 Test Loss: 0.512 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2204034328460693
Epoch: 20, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.472 Vali Acc: 0.916 Test Loss: 0.472 Test Acc: 0.916
Validation loss decreased (-0.908103 --> -0.916211).  Saving model ...
Epoch: 21 cost time: 1.300285816192627
Epoch: 21, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.451 Vali Acc: 0.916 Test Loss: 0.451 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916212).  Saving model ...
Epoch: 22 cost time: 1.0860037803649902
Epoch: 22, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.428 Vali Acc: 0.938 Test Loss: 0.428 Test Acc: 0.938
Validation loss decreased (-0.916212 --> -0.937834).  Saving model ...
Epoch: 23 cost time: 1.231062889099121
Epoch: 23, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.406 Vali Acc: 0.941 Test Loss: 0.406 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940536).  Saving model ...
Epoch: 24 cost time: 1.3539025783538818
Epoch: 24, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2580504417419434
Epoch: 25, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.362 Vali Acc: 0.941 Test Loss: 0.362 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 26 cost time: 1.1134061813354492
Epoch: 26, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.352 Vali Acc: 0.941 Test Loss: 0.352 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 27 cost time: 0.9994571208953857
Epoch: 27, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 28 cost time: 1.4461686611175537
Epoch: 28, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.328 Vali Acc: 0.949 Test Loss: 0.328 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948645).  Saving model ...
Epoch: 29 cost time: 0.9612255096435547
Epoch: 29, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.318 Vali Acc: 0.949 Test Loss: 0.318 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948645).  Saving model ...
Epoch: 30 cost time: 1.0656578540802002
Epoch: 30, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.328 Vali Acc: 0.932 Test Loss: 0.328 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1023070812225342
Epoch: 31, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.310 Vali Acc: 0.943 Test Loss: 0.310 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.106116771697998
Epoch: 32, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.289 Vali Acc: 0.946 Test Loss: 0.289 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3041412830352783
Epoch: 33, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.285 Vali Acc: 0.949 Test Loss: 0.285 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 34 cost time: 1.1846942901611328
Epoch: 34, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.286 Vali Acc: 0.951 Test Loss: 0.286 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951348).  Saving model ...
Epoch: 35 cost time: 1.2094225883483887
Epoch: 35, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.946 Test Loss: 0.273 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1036560535430908
Epoch: 36, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.257 Vali Acc: 0.951 Test Loss: 0.257 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 37 cost time: 1.3791673183441162
Epoch: 37, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4384055137634277
Epoch: 38, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.263 Vali Acc: 0.943 Test Loss: 0.263 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0052719116210938
Epoch: 39, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.250 Vali Acc: 0.946 Test Loss: 0.250 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1883347034454346
Epoch: 40, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.243 Vali Acc: 0.949 Test Loss: 0.243 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2023296356201172
Epoch: 41, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.247222900390625
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.241 Vali Acc: 0.951 Test Loss: 0.241 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 43 cost time: 1.1576402187347412
Epoch: 43, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.252 Vali Acc: 0.954 Test Loss: 0.252 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 44 cost time: 1.1681578159332275
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5794036388397217
Epoch: 45, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.240 Vali Acc: 0.954 Test Loss: 0.240 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 46 cost time: 1.0724925994873047
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3555195331573486
Epoch: 47, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.241 Vali Acc: 0.951 Test Loss: 0.241 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4680147171020508
Epoch: 48, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.954 Test Loss: 0.231 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 49 cost time: 1.285116195678711
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1776912212371826
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.951 Test Loss: 0.226 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3005807399749756
Epoch: 51, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.2862958908081055
Epoch: 52, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.954 Test Loss: 0.231 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1950325965881348
Epoch: 53, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3118102550506592
Epoch: 54, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0928688049316406
Epoch: 55, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.0810093879699707
Epoch: 56, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.2425873279571533
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.625671148300171
Epoch: 58, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 126275
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9929983615875244
Epoch: 1, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.166 Vali Acc: 0.114 Test Loss: 2.166 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 1.2546873092651367
Epoch: 2, Steps: 17 | Train Loss: 2.073 Vali Loss: 2.061 Vali Acc: 0.273 Test Loss: 2.061 Test Acc: 0.273
Validation loss decreased (-0.113492 --> -0.272952).  Saving model ...
Epoch: 3 cost time: 1.2194318771362305
Epoch: 3, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.923 Vali Acc: 0.484 Test Loss: 1.923 Test Acc: 0.484
Validation loss decreased (-0.272952 --> -0.483765).  Saving model ...
Epoch: 4 cost time: 1.0054762363433838
Epoch: 4, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.783 Vali Acc: 0.611 Test Loss: 1.783 Test Acc: 0.611
Validation loss decreased (-0.483765 --> -0.610793).  Saving model ...
Epoch: 5 cost time: 1.0355193614959717
Epoch: 5, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.642 Vali Acc: 0.746 Test Loss: 1.642 Test Acc: 0.746
Validation loss decreased (-0.610793 --> -0.745930).  Saving model ...
Epoch: 6 cost time: 1.236682415008545
Epoch: 6, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.508 Vali Acc: 0.789 Test Loss: 1.508 Test Acc: 0.789
Validation loss decreased (-0.745930 --> -0.789174).  Saving model ...
Epoch: 7 cost time: 1.2052464485168457
Epoch: 7, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.383 Vali Acc: 0.822 Test Loss: 1.383 Test Acc: 0.822
Validation loss decreased (-0.789174 --> -0.821608).  Saving model ...
Epoch: 8 cost time: 0.9222073554992676
Epoch: 8, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.267 Vali Acc: 0.838 Test Loss: 1.267 Test Acc: 0.838
Validation loss decreased (-0.821608 --> -0.837825).  Saving model ...
Epoch: 9 cost time: 1.2209579944610596
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.153 Vali Acc: 0.838 Test Loss: 1.153 Test Acc: 0.838
Validation loss decreased (-0.837825 --> -0.837826).  Saving model ...
Epoch: 10 cost time: 1.1659722328186035
Epoch: 10, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.056 Vali Acc: 0.849 Test Loss: 1.056 Test Acc: 0.849
Validation loss decreased (-0.837826 --> -0.848638).  Saving model ...
Epoch: 11 cost time: 1.0357565879821777
Epoch: 11, Steps: 17 | Train Loss: 0.866 Vali Loss: 0.975 Vali Acc: 0.862 Test Loss: 0.975 Test Acc: 0.862
Validation loss decreased (-0.848638 --> -0.862152).  Saving model ...
Epoch: 12 cost time: 1.0911004543304443
Epoch: 12, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.891 Vali Acc: 0.878 Test Loss: 0.891 Test Acc: 0.878
Validation loss decreased (-0.862152 --> -0.878369).  Saving model ...
Epoch: 13 cost time: 0.9976692199707031
Epoch: 13, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.826 Vali Acc: 0.870 Test Loss: 0.826 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.121565580368042
Epoch: 14, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.755 Vali Acc: 0.881 Test Loss: 0.755 Test Acc: 0.881
Validation loss decreased (-0.878369 --> -0.881074).  Saving model ...
Epoch: 15 cost time: 1.1471812725067139
Epoch: 15, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.708 Vali Acc: 0.895 Test Loss: 0.708 Test Acc: 0.895
Validation loss decreased (-0.881074 --> -0.894588).  Saving model ...
Epoch: 16 cost time: 0.8962087631225586
Epoch: 16, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.645 Vali Acc: 0.908 Test Loss: 0.645 Test Acc: 0.908
Validation loss decreased (-0.894588 --> -0.908102).  Saving model ...
Epoch: 17 cost time: 1.2482142448425293
Epoch: 17, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.602 Vali Acc: 0.911 Test Loss: 0.602 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.4055171012878418
Epoch: 18, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.558 Vali Acc: 0.903 Test Loss: 0.558 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1065444946289062
Epoch: 19, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.528 Vali Acc: 0.905 Test Loss: 0.528 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2338902950286865
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.511 Vali Acc: 0.903 Test Loss: 0.511 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.267014980316162
Epoch: 21, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.474 Vali Acc: 0.914 Test Loss: 0.474 Test Acc: 0.914
Validation loss decreased (-0.910805 --> -0.913509).  Saving model ...
Epoch: 22 cost time: 1.231929063796997
Epoch: 22, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.449 Vali Acc: 0.914 Test Loss: 0.449 Test Acc: 0.914
Validation loss decreased (-0.913509 --> -0.913509).  Saving model ...
Epoch: 23 cost time: 1.1894631385803223
Epoch: 23, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 24 cost time: 0.8889765739440918
Epoch: 24, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 1.2431588172912598
Epoch: 25, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3151335716247559
Epoch: 26, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.384 Vali Acc: 0.919 Test Loss: 0.384 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 0.987278938293457
Epoch: 27, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.355 Vali Acc: 0.935 Test Loss: 0.355 Test Acc: 0.935
Validation loss decreased (-0.918915 --> -0.935132).  Saving model ...
Epoch: 28 cost time: 1.2663700580596924
Epoch: 28, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.347 Vali Acc: 0.916 Test Loss: 0.347 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1993987560272217
Epoch: 29, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4668822288513184
Epoch: 30, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.319 Vali Acc: 0.924 Test Loss: 0.319 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.994786262512207
Epoch: 31, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1405768394470215
Epoch: 32, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.293 Vali Acc: 0.932 Test Loss: 0.293 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2044398784637451
Epoch: 33, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.314 Vali Acc: 0.914 Test Loss: 0.314 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.129249095916748
Epoch: 34, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4628016948699951
Epoch: 35, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0652096271514893
Epoch: 36, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9639301300048828
Epoch: 37, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.278 Vali Acc: 0.927 Test Loss: 0.278 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9351351351351351
model parameter : 124227
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.030456066131592
Epoch: 1, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.166 Vali Acc: 0.114 Test Loss: 2.166 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 0.8404843807220459
Epoch: 2, Steps: 17 | Train Loss: 2.073 Vali Loss: 2.061 Vali Acc: 0.273 Test Loss: 2.061 Test Acc: 0.273
Validation loss decreased (-0.113492 --> -0.272952).  Saving model ...
Epoch: 3 cost time: 1.013329029083252
Epoch: 3, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.923 Vali Acc: 0.484 Test Loss: 1.923 Test Acc: 0.484
Validation loss decreased (-0.272952 --> -0.483765).  Saving model ...
Epoch: 4 cost time: 0.9525167942047119
Epoch: 4, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.783 Vali Acc: 0.611 Test Loss: 1.783 Test Acc: 0.611
Validation loss decreased (-0.483765 --> -0.610793).  Saving model ...
Epoch: 5 cost time: 1.0393576622009277
Epoch: 5, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.642 Vali Acc: 0.746 Test Loss: 1.642 Test Acc: 0.746
Validation loss decreased (-0.610793 --> -0.745930).  Saving model ...
Epoch: 6 cost time: 1.149289608001709
Epoch: 6, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.508 Vali Acc: 0.789 Test Loss: 1.508 Test Acc: 0.789
Validation loss decreased (-0.745930 --> -0.789174).  Saving model ...
Epoch: 7 cost time: 1.0230915546417236
Epoch: 7, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.383 Vali Acc: 0.822 Test Loss: 1.383 Test Acc: 0.822
Validation loss decreased (-0.789174 --> -0.821608).  Saving model ...
Epoch: 8 cost time: 1.0161595344543457
Epoch: 8, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.267 Vali Acc: 0.838 Test Loss: 1.267 Test Acc: 0.838
Validation loss decreased (-0.821608 --> -0.837825).  Saving model ...
Epoch: 9 cost time: 0.7867586612701416
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.153 Vali Acc: 0.838 Test Loss: 1.153 Test Acc: 0.838
Validation loss decreased (-0.837825 --> -0.837826).  Saving model ...
Epoch: 10 cost time: 0.8085289001464844
Epoch: 10, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.056 Vali Acc: 0.849 Test Loss: 1.056 Test Acc: 0.849
Validation loss decreased (-0.837826 --> -0.848638).  Saving model ...
Epoch: 11 cost time: 1.0098819732666016
Epoch: 11, Steps: 17 | Train Loss: 0.866 Vali Loss: 0.975 Vali Acc: 0.862 Test Loss: 0.975 Test Acc: 0.862
Validation loss decreased (-0.848638 --> -0.862152).  Saving model ...
Epoch: 12 cost time: 1.1971235275268555
Epoch: 12, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.891 Vali Acc: 0.878 Test Loss: 0.891 Test Acc: 0.878
Validation loss decreased (-0.862152 --> -0.878369).  Saving model ...
Epoch: 13 cost time: 1.0401628017425537
Epoch: 13, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.826 Vali Acc: 0.870 Test Loss: 0.826 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9792928695678711
Epoch: 14, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.755 Vali Acc: 0.881 Test Loss: 0.755 Test Acc: 0.881
Validation loss decreased (-0.878369 --> -0.881074).  Saving model ...
Epoch: 15 cost time: 1.1834664344787598
Epoch: 15, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.708 Vali Acc: 0.895 Test Loss: 0.708 Test Acc: 0.895
Validation loss decreased (-0.881074 --> -0.894588).  Saving model ...
Epoch: 16 cost time: 0.9141478538513184
Epoch: 16, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.645 Vali Acc: 0.908 Test Loss: 0.645 Test Acc: 0.908
Validation loss decreased (-0.894588 --> -0.908102).  Saving model ...
Epoch: 17 cost time: 1.0777654647827148
Epoch: 17, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.602 Vali Acc: 0.911 Test Loss: 0.602 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.002220630645752
Epoch: 18, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.558 Vali Acc: 0.903 Test Loss: 0.558 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0645549297332764
Epoch: 19, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.528 Vali Acc: 0.905 Test Loss: 0.528 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0014116764068604
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.511 Vali Acc: 0.903 Test Loss: 0.511 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1684551239013672
Epoch: 21, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.474 Vali Acc: 0.914 Test Loss: 0.474 Test Acc: 0.914
Validation loss decreased (-0.910805 --> -0.913509).  Saving model ...
Epoch: 22 cost time: 1.0704240798950195
Epoch: 22, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.449 Vali Acc: 0.914 Test Loss: 0.449 Test Acc: 0.914
Validation loss decreased (-0.913509 --> -0.913509).  Saving model ...
Epoch: 23 cost time: 0.8922760486602783
Epoch: 23, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 24 cost time: 0.991218090057373
Epoch: 24, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 1.1212191581726074
Epoch: 25, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.068610668182373
Epoch: 26, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.384 Vali Acc: 0.919 Test Loss: 0.384 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 1.1819207668304443
Epoch: 27, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.355 Vali Acc: 0.935 Test Loss: 0.355 Test Acc: 0.935
Validation loss decreased (-0.918915 --> -0.935132).  Saving model ...
Epoch: 28 cost time: 1.1434688568115234
Epoch: 28, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.347 Vali Acc: 0.916 Test Loss: 0.347 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2960472106933594
Epoch: 29, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2469656467437744
Epoch: 30, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.319 Vali Acc: 0.924 Test Loss: 0.319 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9844639301300049
Epoch: 31, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1170892715454102
Epoch: 32, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.293 Vali Acc: 0.932 Test Loss: 0.293 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.229919195175171
Epoch: 33, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.314 Vali Acc: 0.914 Test Loss: 0.314 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0812759399414062
Epoch: 34, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2109172344207764
Epoch: 35, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1513302326202393
Epoch: 36, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1779298782348633
Epoch: 37, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.278 Vali Acc: 0.927 Test Loss: 0.278 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9351351351351351
model parameter : 124227
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7684857845306396
Epoch: 1, Steps: 17 | Train Loss: 2.128 Vali Loss: 2.022 Vali Acc: 0.341 Test Loss: 2.022 Test Acc: 0.341
Validation loss decreased (inf --> -0.340520).  Saving model ...
Epoch: 2 cost time: 1.0221467018127441
Epoch: 2, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.882 Vali Acc: 0.489 Test Loss: 1.882 Test Acc: 0.489
Validation loss decreased (-0.340520 --> -0.489170).  Saving model ...
Epoch: 3 cost time: 1.0719873905181885
Epoch: 3, Steps: 17 | Train Loss: 1.775 Vali Loss: 1.763 Vali Acc: 0.573 Test Loss: 1.763 Test Acc: 0.573
Validation loss decreased (-0.489170 --> -0.572955).  Saving model ...
Epoch: 4 cost time: 1.0078372955322266
Epoch: 4, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.632 Vali Acc: 0.697 Test Loss: 1.632 Test Acc: 0.697
Validation loss decreased (-0.572955 --> -0.697281).  Saving model ...
Epoch: 5 cost time: 1.1370160579681396
Epoch: 5, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.528 Vali Acc: 0.759 Test Loss: 1.528 Test Acc: 0.759
Validation loss decreased (-0.697281 --> -0.759444).  Saving model ...
Epoch: 6 cost time: 1.1031584739685059
Epoch: 6, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.394 Vali Acc: 0.803 Test Loss: 1.394 Test Acc: 0.803
Validation loss decreased (-0.759444 --> -0.802689).  Saving model ...
Epoch: 7 cost time: 1.1858844757080078
Epoch: 7, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.279 Vali Acc: 0.859 Test Loss: 1.279 Test Acc: 0.859
Validation loss decreased (-0.802689 --> -0.859447).  Saving model ...
Epoch: 8 cost time: 1.203608751296997
Epoch: 8, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.184 Vali Acc: 0.846 Test Loss: 1.184 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0397343635559082
Epoch: 9, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.074 Vali Acc: 0.851 Test Loss: 1.074 Test Acc: 0.851
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0474863052368164
Epoch: 10, Steps: 17 | Train Loss: 0.889 Vali Loss: 0.973 Vali Acc: 0.873 Test Loss: 0.973 Test Acc: 0.873
Validation loss decreased (-0.859447 --> -0.872963).  Saving model ...
Epoch: 11 cost time: 1.0677530765533447
Epoch: 11, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.875 Vali Acc: 0.870 Test Loss: 0.875 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.224501132965088
Epoch: 12, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.794 Vali Acc: 0.881 Test Loss: 0.794 Test Acc: 0.881
Validation loss decreased (-0.872963 --> -0.881073).  Saving model ...
Epoch: 13 cost time: 0.9736552238464355
Epoch: 13, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.735 Vali Acc: 0.881 Test Loss: 0.735 Test Acc: 0.881
Validation loss decreased (-0.881073 --> -0.881074).  Saving model ...
Epoch: 14 cost time: 1.134943962097168
Epoch: 14, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.684 Vali Acc: 0.897 Test Loss: 0.684 Test Acc: 0.897
Validation loss decreased (-0.881074 --> -0.897290).  Saving model ...
Epoch: 15 cost time: 1.0993874073028564
Epoch: 15, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.897290 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 1.1773879528045654
Epoch: 16, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.585 Vali Acc: 0.897 Test Loss: 0.585 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.113466739654541
Epoch: 17, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.537 Vali Acc: 0.908 Test Loss: 0.537 Test Acc: 0.908
Validation loss decreased (-0.899994 --> -0.908103).  Saving model ...
Epoch: 18 cost time: 1.3520684242248535
Epoch: 18, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.518 Vali Acc: 0.916 Test Loss: 0.518 Test Acc: 0.916
Validation loss decreased (-0.908103 --> -0.916211).  Saving model ...
Epoch: 19 cost time: 1.3246798515319824
Epoch: 19, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.482 Vali Acc: 0.916 Test Loss: 0.482 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 1.4849720001220703
Epoch: 20, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.456 Vali Acc: 0.930 Test Loss: 0.456 Test Acc: 0.930
Validation loss decreased (-0.916211 --> -0.929725).  Saving model ...
Epoch: 21 cost time: 1.2623422145843506
Epoch: 21, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.437 Vali Acc: 0.935 Test Loss: 0.437 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 22 cost time: 1.049431324005127
Epoch: 22, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.416 Vali Acc: 0.919 Test Loss: 0.416 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4197981357574463
Epoch: 23, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.397 Vali Acc: 0.927 Test Loss: 0.397 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1871006488800049
Epoch: 24, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.379 Vali Acc: 0.924 Test Loss: 0.379 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1143312454223633
Epoch: 25, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.374 Vali Acc: 0.924 Test Loss: 0.374 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3039882183074951
Epoch: 26, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4251155853271484
Epoch: 27, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.353 Vali Acc: 0.927 Test Loss: 0.353 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0961391925811768
Epoch: 28, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1503808498382568
Epoch: 29, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.319 Vali Acc: 0.924 Test Loss: 0.319 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3255689144134521
Epoch: 30, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2911708354949951
Epoch: 31, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.299 Vali Acc: 0.938 Test Loss: 0.299 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 32 cost time: 1.300044298171997
Epoch: 32, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4277527332305908
Epoch: 33, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.303 Vali Acc: 0.916 Test Loss: 0.303 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5309369564056396
Epoch: 34, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.291 Vali Acc: 0.935 Test Loss: 0.291 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.443655014038086
Epoch: 35, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1205909252166748
Epoch: 36, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.276 Vali Acc: 0.927 Test Loss: 0.276 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2705562114715576
Epoch: 37, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.924 Test Loss: 0.266 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9787671566009521
Epoch: 38, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.289 Vali Acc: 0.924 Test Loss: 0.289 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.033728837966919
Epoch: 39, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.280 Vali Acc: 0.924 Test Loss: 0.280 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1316838264465332
Epoch: 40, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.2174358367919922
Epoch: 41, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.251 Vali Acc: 0.932 Test Loss: 0.251 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 130247
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9084854125976562
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.023 Vali Acc: 0.324 Test Loss: 2.023 Test Acc: 0.324
Validation loss decreased (inf --> -0.324304).  Saving model ...
Epoch: 2 cost time: 1.068234920501709
Epoch: 2, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.858 Vali Acc: 0.557 Test Loss: 1.858 Test Acc: 0.557
Validation loss decreased (-0.324304 --> -0.556738).  Saving model ...
Epoch: 3 cost time: 1.493213176727295
Epoch: 3, Steps: 17 | Train Loss: 1.721 Vali Loss: 1.715 Vali Acc: 0.673 Test Loss: 1.715 Test Acc: 0.673
Validation loss decreased (-0.556738 --> -0.672956).  Saving model ...
Epoch: 4 cost time: 1.0757074356079102
Epoch: 4, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.593 Vali Acc: 0.743 Test Loss: 1.593 Test Acc: 0.743
Validation loss decreased (-0.672956 --> -0.743227).  Saving model ...
Epoch: 5 cost time: 0.9637994766235352
Epoch: 5, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.482 Vali Acc: 0.776 Test Loss: 1.482 Test Acc: 0.776
Validation loss decreased (-0.743227 --> -0.775661).  Saving model ...
Epoch: 6 cost time: 1.2455999851226807
Epoch: 6, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.361 Vali Acc: 0.832 Test Loss: 1.361 Test Acc: 0.832
Validation loss decreased (-0.775661 --> -0.832419).  Saving model ...
Epoch: 7 cost time: 1.0432770252227783
Epoch: 7, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.264 Vali Acc: 0.832 Test Loss: 1.264 Test Acc: 0.832
Validation loss decreased (-0.832419 --> -0.832420).  Saving model ...
Epoch: 8 cost time: 1.039417028427124
Epoch: 8, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.157 Vali Acc: 0.841 Test Loss: 1.157 Test Acc: 0.841
Validation loss decreased (-0.832420 --> -0.840529).  Saving model ...
Epoch: 9 cost time: 1.0806028842926025
Epoch: 9, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.051 Vali Acc: 0.859 Test Loss: 1.051 Test Acc: 0.859
Validation loss decreased (-0.840529 --> -0.859449).  Saving model ...
Epoch: 10 cost time: 1.096590280532837
Epoch: 10, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.965 Vali Acc: 0.889 Test Loss: 0.965 Test Acc: 0.889
Validation loss decreased (-0.859449 --> -0.889180).  Saving model ...
Epoch: 11 cost time: 1.3507263660430908
Epoch: 11, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.870 Vali Acc: 0.900 Test Loss: 0.870 Test Acc: 0.900
Validation loss decreased (-0.889180 --> -0.899991).  Saving model ...
Epoch: 12 cost time: 1.1648001670837402
Epoch: 12, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.787 Vali Acc: 0.905 Test Loss: 0.787 Test Acc: 0.905
Validation loss decreased (-0.899991 --> -0.905398).  Saving model ...
Epoch: 13 cost time: 1.366084337234497
Epoch: 13, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.728 Vali Acc: 0.908 Test Loss: 0.728 Test Acc: 0.908
Validation loss decreased (-0.905398 --> -0.908101).  Saving model ...
Epoch: 14 cost time: 1.2224938869476318
Epoch: 14, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.655 Vali Acc: 0.914 Test Loss: 0.655 Test Acc: 0.914
Validation loss decreased (-0.908101 --> -0.913507).  Saving model ...
Epoch: 15 cost time: 1.0251636505126953
Epoch: 15, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.609 Vali Acc: 0.932 Test Loss: 0.609 Test Acc: 0.932
Validation loss decreased (-0.913507 --> -0.932426).  Saving model ...
Epoch: 16 cost time: 1.0637893676757812
Epoch: 16, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.558 Vali Acc: 0.935 Test Loss: 0.558 Test Acc: 0.935
Validation loss decreased (-0.932426 --> -0.935130).  Saving model ...
Epoch: 17 cost time: 1.2236647605895996
Epoch: 17, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.505 Vali Acc: 0.938 Test Loss: 0.505 Test Acc: 0.938
Validation loss decreased (-0.935130 --> -0.937833).  Saving model ...
Epoch: 18 cost time: 1.2741711139678955
Epoch: 18, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.472 Vali Acc: 0.941 Test Loss: 0.472 Test Acc: 0.941
Validation loss decreased (-0.937833 --> -0.940536).  Saving model ...
Epoch: 19 cost time: 1.1964964866638184
Epoch: 19, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.453 Vali Acc: 0.946 Test Loss: 0.453 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945941).  Saving model ...
Epoch: 20 cost time: 1.0865933895111084
Epoch: 20, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.422 Vali Acc: 0.941 Test Loss: 0.422 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3060460090637207
Epoch: 21, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.420 Vali Acc: 0.943 Test Loss: 0.420 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.143423080444336
Epoch: 22, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.397 Vali Acc: 0.949 Test Loss: 0.397 Test Acc: 0.949
Validation loss decreased (-0.945941 --> -0.948645).  Saving model ...
Epoch: 23 cost time: 1.4158093929290771
Epoch: 23, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.356 Vali Acc: 0.946 Test Loss: 0.356 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5650582313537598
Epoch: 24, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.344 Vali Acc: 0.946 Test Loss: 0.344 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4653923511505127
Epoch: 25, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.353 Vali Acc: 0.922 Test Loss: 0.353 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2426536083221436
Epoch: 26, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.313 Vali Acc: 0.943 Test Loss: 0.313 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2102720737457275
Epoch: 27, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.317 Vali Acc: 0.932 Test Loss: 0.317 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4773435592651367
Epoch: 28, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.283 Vali Acc: 0.951 Test Loss: 0.283 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951349).  Saving model ...
Epoch: 29 cost time: 1.2786436080932617
Epoch: 29, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.270 Vali Acc: 0.954 Test Loss: 0.270 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954051).  Saving model ...
Epoch: 30 cost time: 1.2119941711425781
Epoch: 30, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.273 Vali Acc: 0.949 Test Loss: 0.273 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0018730163574219
Epoch: 31, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2149221897125244
Epoch: 32, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.251 Vali Acc: 0.946 Test Loss: 0.251 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2588741779327393
Epoch: 33, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.253 Vali Acc: 0.943 Test Loss: 0.253 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1271016597747803
Epoch: 34, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1746346950531006
Epoch: 35, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2976880073547363
Epoch: 36, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.228 Vali Acc: 0.943 Test Loss: 0.228 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3523635864257812
Epoch: 37, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.432990550994873
Epoch: 38, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2863216400146484
Epoch: 39, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 128199
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.703244209289551
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.117 Vali Acc: 0.235 Test Loss: 2.117 Test Acc: 0.235
Validation loss decreased (inf --> -0.235114).  Saving model ...
Epoch: 2 cost time: 1.4151451587677002
Epoch: 2, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.928 Vali Acc: 0.427 Test Loss: 1.928 Test Acc: 0.427
Validation loss decreased (-0.235114 --> -0.427008).  Saving model ...
Epoch: 3 cost time: 1.0007948875427246
Epoch: 3, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.795 Vali Acc: 0.532 Test Loss: 1.795 Test Acc: 0.532
Validation loss decreased (-0.427008 --> -0.532414).  Saving model ...
Epoch: 4 cost time: 0.9345123767852783
Epoch: 4, Steps: 17 | Train Loss: 1.662 Vali Loss: 1.696 Vali Acc: 0.627 Test Loss: 1.696 Test Acc: 0.627
Validation loss decreased (-0.532414 --> -0.627010).  Saving model ...
Epoch: 5 cost time: 0.9632747173309326
Epoch: 5, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.578 Vali Acc: 0.711 Test Loss: 1.578 Test Acc: 0.711
Validation loss decreased (-0.627010 --> -0.710795).  Saving model ...
Epoch: 6 cost time: 1.1833653450012207
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.484 Vali Acc: 0.741 Test Loss: 1.484 Test Acc: 0.741
Validation loss decreased (-0.710795 --> -0.740526).  Saving model ...
Epoch: 7 cost time: 1.2790942192077637
Epoch: 7, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.361 Vali Acc: 0.786 Test Loss: 1.361 Test Acc: 0.786
Validation loss decreased (-0.740526 --> -0.786473).  Saving model ...
Epoch: 8 cost time: 1.2660527229309082
Epoch: 8, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.263 Vali Acc: 0.786 Test Loss: 1.263 Test Acc: 0.786
Validation loss decreased (-0.786473 --> -0.786474).  Saving model ...
Epoch: 9 cost time: 1.054973840713501
Epoch: 9, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.158 Vali Acc: 0.822 Test Loss: 1.158 Test Acc: 0.822
Validation loss decreased (-0.786474 --> -0.821610).  Saving model ...
Epoch: 10 cost time: 0.9881885051727295
Epoch: 10, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.064 Vali Acc: 0.854 Test Loss: 1.064 Test Acc: 0.854
Validation loss decreased (-0.821610 --> -0.854043).  Saving model ...
Epoch: 11 cost time: 1.1508605480194092
Epoch: 11, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.973 Vali Acc: 0.843 Test Loss: 0.973 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1141448020935059
Epoch: 12, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.893 Vali Acc: 0.868 Test Loss: 0.893 Test Acc: 0.868
Validation loss decreased (-0.854043 --> -0.867559).  Saving model ...
Epoch: 13 cost time: 1.0663225650787354
Epoch: 13, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.811 Vali Acc: 0.878 Test Loss: 0.811 Test Acc: 0.878
Validation loss decreased (-0.867559 --> -0.878370).  Saving model ...
Epoch: 14 cost time: 1.0166501998901367
Epoch: 14, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.736 Vali Acc: 0.884 Test Loss: 0.736 Test Acc: 0.884
Validation loss decreased (-0.878370 --> -0.883776).  Saving model ...
Epoch: 15 cost time: 1.2572646141052246
Epoch: 15, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.681 Vali Acc: 0.905 Test Loss: 0.681 Test Acc: 0.905
Validation loss decreased (-0.883776 --> -0.905399).  Saving model ...
Epoch: 16 cost time: 1.0917243957519531
Epoch: 16, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.633 Vali Acc: 0.900 Test Loss: 0.633 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.086693525314331
Epoch: 17, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.580 Vali Acc: 0.911 Test Loss: 0.580 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.219041347503662
Epoch: 18, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8849437236785889
Epoch: 19, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.520 Vali Acc: 0.911 Test Loss: 0.520 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 20 cost time: 1.1628742218017578
Epoch: 20, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.466 Vali Acc: 0.922 Test Loss: 0.466 Test Acc: 0.922
Validation loss decreased (-0.910806 --> -0.921617).  Saving model ...
Epoch: 21 cost time: 1.0151631832122803
Epoch: 21, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.461 Vali Acc: 0.903 Test Loss: 0.461 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9432225227355957
Epoch: 22, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.433 Vali Acc: 0.916 Test Loss: 0.433 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0161514282226562
Epoch: 23, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.405 Vali Acc: 0.924 Test Loss: 0.405 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 24 cost time: 0.9317717552185059
Epoch: 24, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.394 Vali Acc: 0.914 Test Loss: 0.394 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8135366439819336
Epoch: 25, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.376 Vali Acc: 0.930 Test Loss: 0.376 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 26 cost time: 1.0948946475982666
Epoch: 26, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
Validation loss decreased (-0.929726 --> -0.929726).  Saving model ...
Epoch: 27 cost time: 0.9310190677642822
Epoch: 27, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.330 Vali Acc: 0.932 Test Loss: 0.330 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 28 cost time: 1.0980186462402344
Epoch: 28, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.323 Vali Acc: 0.941 Test Loss: 0.323 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940537).  Saving model ...
Epoch: 29 cost time: 1.0482332706451416
Epoch: 29, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8520073890686035
Epoch: 30, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9584970474243164
Epoch: 31, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.307 Vali Acc: 0.938 Test Loss: 0.307 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9375510215759277
Epoch: 32, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0513064861297607
Epoch: 33, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.279 Vali Acc: 0.949 Test Loss: 0.279 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 34 cost time: 0.8219220638275146
Epoch: 34, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.938 Test Loss: 0.285 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9375896453857422
Epoch: 35, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.946 Test Loss: 0.266 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9062027931213379
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.263 Vali Acc: 0.946 Test Loss: 0.263 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8574273586273193
Epoch: 37, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0547595024108887
Epoch: 38, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.262 Vali Acc: 0.946 Test Loss: 0.262 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9687714576721191
Epoch: 39, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9460330009460449
Epoch: 40, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0412802696228027
Epoch: 41, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.256 Vali Acc: 0.932 Test Loss: 0.256 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9624645709991455
Epoch: 42, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1302213668823242
Epoch: 43, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 126151
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.763707399368286
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.030 Vali Acc: 0.343 Test Loss: 2.030 Test Acc: 0.343
Validation loss decreased (inf --> -0.343223).  Saving model ...
Epoch: 2 cost time: 0.919783353805542
Epoch: 2, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.882 Vali Acc: 0.503 Test Loss: 1.882 Test Acc: 0.503
Validation loss decreased (-0.343223 --> -0.502684).  Saving model ...
Epoch: 3 cost time: 0.9176790714263916
Epoch: 3, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.763 Vali Acc: 0.562 Test Loss: 1.763 Test Acc: 0.562
Validation loss decreased (-0.502684 --> -0.562145).  Saving model ...
Epoch: 4 cost time: 1.038618564605713
Epoch: 4, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.652 Vali Acc: 0.619 Test Loss: 1.652 Test Acc: 0.619
Validation loss decreased (-0.562145 --> -0.618902).  Saving model ...
Epoch: 5 cost time: 0.9491994380950928
Epoch: 5, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.548 Vali Acc: 0.703 Test Loss: 1.548 Test Acc: 0.703
Validation loss decreased (-0.618902 --> -0.702687).  Saving model ...
Epoch: 6 cost time: 1.1052870750427246
Epoch: 6, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.469 Vali Acc: 0.722 Test Loss: 1.469 Test Acc: 0.722
Validation loss decreased (-0.702687 --> -0.721607).  Saving model ...
Epoch: 7 cost time: 1.032125473022461
Epoch: 7, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.365 Vali Acc: 0.759 Test Loss: 1.365 Test Acc: 0.759
Validation loss decreased (-0.721607 --> -0.759446).  Saving model ...
Epoch: 8 cost time: 0.9218714237213135
Epoch: 8, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.277 Vali Acc: 0.803 Test Loss: 1.277 Test Acc: 0.803
Validation loss decreased (-0.759446 --> -0.802690).  Saving model ...
Epoch: 9 cost time: 0.9098503589630127
Epoch: 9, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.172 Vali Acc: 0.824 Test Loss: 1.172 Test Acc: 0.824
Validation loss decreased (-0.802690 --> -0.824313).  Saving model ...
Epoch: 10 cost time: 0.8580307960510254
Epoch: 10, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.081 Vali Acc: 0.832 Test Loss: 1.081 Test Acc: 0.832
Validation loss decreased (-0.824313 --> -0.832422).  Saving model ...
Epoch: 11 cost time: 1.080695629119873
Epoch: 11, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.991 Vali Acc: 0.851 Test Loss: 0.991 Test Acc: 0.851
Validation loss decreased (-0.832422 --> -0.851341).  Saving model ...
Epoch: 12 cost time: 1.0890610218048096
Epoch: 12, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.914 Vali Acc: 0.846 Test Loss: 0.914 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9079506397247314
Epoch: 13, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.820 Vali Acc: 0.878 Test Loss: 0.820 Test Acc: 0.878
Validation loss decreased (-0.851341 --> -0.878370).  Saving model ...
Epoch: 14 cost time: 1.0352275371551514
Epoch: 14, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.775 Vali Acc: 0.884 Test Loss: 0.775 Test Acc: 0.884
Validation loss decreased (-0.878370 --> -0.883776).  Saving model ...
Epoch: 15 cost time: 0.8747704029083252
Epoch: 15, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.715 Vali Acc: 0.870 Test Loss: 0.715 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9080691337585449
Epoch: 16, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.666 Vali Acc: 0.892 Test Loss: 0.666 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 17 cost time: 1.0978426933288574
Epoch: 17, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.599 Vali Acc: 0.903 Test Loss: 0.599 Test Acc: 0.903
Validation loss decreased (-0.891885 --> -0.902697).  Saving model ...
Epoch: 18 cost time: 1.2589430809020996
Epoch: 18, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.554 Vali Acc: 0.911 Test Loss: 0.554 Test Acc: 0.911
Validation loss decreased (-0.902697 --> -0.910805).  Saving model ...
Epoch: 19 cost time: 1.0166316032409668
Epoch: 19, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2183611392974854
Epoch: 20, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.489 Vali Acc: 0.911 Test Loss: 0.489 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 21 cost time: 1.1832315921783447
Epoch: 21, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.493 Vali Acc: 0.914 Test Loss: 0.493 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 22 cost time: 1.2607707977294922
Epoch: 22, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.461 Vali Acc: 0.905 Test Loss: 0.461 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9706737995147705
Epoch: 23, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.453 Vali Acc: 0.908 Test Loss: 0.453 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0003573894500732
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.420 Vali Acc: 0.919 Test Loss: 0.420 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 0.8947880268096924
Epoch: 25, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.396 Vali Acc: 0.914 Test Loss: 0.396 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2500336170196533
Epoch: 26, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.388 Vali Acc: 0.905 Test Loss: 0.388 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9582741260528564
Epoch: 27, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.380 Vali Acc: 0.916 Test Loss: 0.380 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0139439105987549
Epoch: 28, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.370 Vali Acc: 0.914 Test Loss: 0.370 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9043552875518799
Epoch: 29, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.364 Vali Acc: 0.914 Test Loss: 0.364 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9023141860961914
Epoch: 30, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9349508285522461
Epoch: 31, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918916).  Saving model ...
Epoch: 32 cost time: 1.067225456237793
Epoch: 32, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.324 Vali Acc: 0.916 Test Loss: 0.324 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8262436389923096
Epoch: 33, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918916).  Saving model ...
Epoch: 34 cost time: 1.2567968368530273
Epoch: 34, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921618).  Saving model ...
Epoch: 35 cost time: 0.9856016635894775
Epoch: 35, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.314 Vali Acc: 0.924 Test Loss: 0.314 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 36 cost time: 0.9985148906707764
Epoch: 36, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.226616382598877
Epoch: 37, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0544774532318115
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.277092695236206
Epoch: 39, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.916 Test Loss: 0.297 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2245638370513916
Epoch: 40, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.919 Test Loss: 0.287 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1976518630981445
Epoch: 41, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.914 Test Loss: 0.297 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2417643070220947
Epoch: 42, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.287 Vali Acc: 0.908 Test Loss: 0.287 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1465840339660645
Epoch: 43, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.287 Vali Acc: 0.916 Test Loss: 0.287 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1806843280792236
Epoch: 44, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2471678256988525
Epoch: 45, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 124103
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1515722274780273
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.030 Vali Acc: 0.343 Test Loss: 2.030 Test Acc: 0.343
Validation loss decreased (inf --> -0.343223).  Saving model ...
Epoch: 2 cost time: 1.0983741283416748
Epoch: 2, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.882 Vali Acc: 0.503 Test Loss: 1.882 Test Acc: 0.503
Validation loss decreased (-0.343223 --> -0.502684).  Saving model ...
Epoch: 3 cost time: 1.1052131652832031
Epoch: 3, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.763 Vali Acc: 0.562 Test Loss: 1.763 Test Acc: 0.562
Validation loss decreased (-0.502684 --> -0.562145).  Saving model ...
Epoch: 4 cost time: 1.0346038341522217
Epoch: 4, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.652 Vali Acc: 0.619 Test Loss: 1.652 Test Acc: 0.619
Validation loss decreased (-0.562145 --> -0.618902).  Saving model ...
Epoch: 5 cost time: 1.2745540142059326
Epoch: 5, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.548 Vali Acc: 0.703 Test Loss: 1.548 Test Acc: 0.703
Validation loss decreased (-0.618902 --> -0.702687).  Saving model ...
Epoch: 6 cost time: 1.1403679847717285
Epoch: 6, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.469 Vali Acc: 0.722 Test Loss: 1.469 Test Acc: 0.722
Validation loss decreased (-0.702687 --> -0.721607).  Saving model ...
Epoch: 7 cost time: 0.9642531871795654
Epoch: 7, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.365 Vali Acc: 0.759 Test Loss: 1.365 Test Acc: 0.759
Validation loss decreased (-0.721607 --> -0.759446).  Saving model ...
Epoch: 8 cost time: 0.965935468673706
Epoch: 8, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.277 Vali Acc: 0.803 Test Loss: 1.277 Test Acc: 0.803
Validation loss decreased (-0.759446 --> -0.802690).  Saving model ...
Epoch: 9 cost time: 0.9279718399047852
Epoch: 9, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.172 Vali Acc: 0.824 Test Loss: 1.172 Test Acc: 0.824
Validation loss decreased (-0.802690 --> -0.824313).  Saving model ...
Epoch: 10 cost time: 1.114081859588623
Epoch: 10, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.081 Vali Acc: 0.832 Test Loss: 1.081 Test Acc: 0.832
Validation loss decreased (-0.824313 --> -0.832422).  Saving model ...
Epoch: 11 cost time: 1.3078229427337646
Epoch: 11, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.991 Vali Acc: 0.851 Test Loss: 0.991 Test Acc: 0.851
Validation loss decreased (-0.832422 --> -0.851341).  Saving model ...
Epoch: 12 cost time: 1.1349427700042725
Epoch: 12, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.914 Vali Acc: 0.846 Test Loss: 0.914 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3162822723388672
Epoch: 13, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.820 Vali Acc: 0.878 Test Loss: 0.820 Test Acc: 0.878
Validation loss decreased (-0.851341 --> -0.878370).  Saving model ...
Epoch: 14 cost time: 1.18888258934021
Epoch: 14, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.775 Vali Acc: 0.884 Test Loss: 0.775 Test Acc: 0.884
Validation loss decreased (-0.878370 --> -0.883776).  Saving model ...
Epoch: 15 cost time: 1.226287841796875
Epoch: 15, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.715 Vali Acc: 0.870 Test Loss: 0.715 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9269697666168213
Epoch: 16, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.666 Vali Acc: 0.892 Test Loss: 0.666 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 17 cost time: 1.0627567768096924
Epoch: 17, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.599 Vali Acc: 0.903 Test Loss: 0.599 Test Acc: 0.903
Validation loss decreased (-0.891885 --> -0.902697).  Saving model ...
Epoch: 18 cost time: 1.1410224437713623
Epoch: 18, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.554 Vali Acc: 0.911 Test Loss: 0.554 Test Acc: 0.911
Validation loss decreased (-0.902697 --> -0.910805).  Saving model ...
Epoch: 19 cost time: 1.117250680923462
Epoch: 19, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1218726634979248
Epoch: 20, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.489 Vali Acc: 0.911 Test Loss: 0.489 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 21 cost time: 0.908236026763916
Epoch: 21, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.493 Vali Acc: 0.914 Test Loss: 0.493 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 22 cost time: 0.9364471435546875
Epoch: 22, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.461 Vali Acc: 0.905 Test Loss: 0.461 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1903440952301025
Epoch: 23, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.453 Vali Acc: 0.908 Test Loss: 0.453 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2488658428192139
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.420 Vali Acc: 0.919 Test Loss: 0.420 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 1.2604310512542725
Epoch: 25, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.396 Vali Acc: 0.914 Test Loss: 0.396 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2204515933990479
Epoch: 26, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.388 Vali Acc: 0.905 Test Loss: 0.388 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1609101295471191
Epoch: 27, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.380 Vali Acc: 0.916 Test Loss: 0.380 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1567847728729248
Epoch: 28, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.370 Vali Acc: 0.914 Test Loss: 0.370 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1807847023010254
Epoch: 29, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.364 Vali Acc: 0.914 Test Loss: 0.364 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3689343929290771
Epoch: 30, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0261826515197754
Epoch: 31, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918916).  Saving model ...
Epoch: 32 cost time: 1.0905890464782715
Epoch: 32, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.324 Vali Acc: 0.916 Test Loss: 0.324 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9233345985412598
Epoch: 33, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918916).  Saving model ...
Epoch: 34 cost time: 0.8044979572296143
Epoch: 34, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921618).  Saving model ...
Epoch: 35 cost time: 1.0487122535705566
Epoch: 35, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.314 Vali Acc: 0.924 Test Loss: 0.314 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 36 cost time: 0.966517448425293
Epoch: 36, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3251774311065674
Epoch: 37, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.042527437210083
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1923086643218994
Epoch: 39, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.916 Test Loss: 0.297 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.090266227722168
Epoch: 40, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.919 Test Loss: 0.287 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2451748847961426
Epoch: 41, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.297 Vali Acc: 0.914 Test Loss: 0.297 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.551051139831543
Epoch: 42, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.287 Vali Acc: 0.908 Test Loss: 0.287 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0399479866027832
Epoch: 43, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.287 Vali Acc: 0.916 Test Loss: 0.287 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1000463962554932
Epoch: 44, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9173753261566162
Epoch: 45, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 124103
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.486697196960449
Epoch: 1, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.246 Vali Acc: 0.073 Test Loss: 2.246 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 1.3516552448272705
Epoch: 2, Steps: 17 | Train Loss: 2.167 Vali Loss: 2.154 Vali Acc: 0.157 Test Loss: 2.154 Test Acc: 0.157
Validation loss decreased (-0.072951 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 1.4443011283874512
Epoch: 3, Steps: 17 | Train Loss: 2.061 Vali Loss: 2.042 Vali Acc: 0.343 Test Loss: 2.042 Test Acc: 0.343
Validation loss decreased (-0.156735 --> -0.343223).  Saving model ...
Epoch: 4 cost time: 1.4426329135894775
Epoch: 4, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.924 Vali Acc: 0.484 Test Loss: 1.924 Test Acc: 0.484
Validation loss decreased (-0.343223 --> -0.483765).  Saving model ...
Epoch: 5 cost time: 1.1705076694488525
Epoch: 5, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.800 Vali Acc: 0.603 Test Loss: 1.800 Test Acc: 0.603
Validation loss decreased (-0.483765 --> -0.602685).  Saving model ...
Epoch: 6 cost time: 1.2428226470947266
Epoch: 6, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.662 Vali Acc: 0.697 Test Loss: 1.662 Test Acc: 0.697
Validation loss decreased (-0.602685 --> -0.697281).  Saving model ...
Epoch: 7 cost time: 1.2710237503051758
Epoch: 7, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.521 Vali Acc: 0.768 Test Loss: 1.521 Test Acc: 0.768
Validation loss decreased (-0.697281 --> -0.767552).  Saving model ...
Epoch: 8 cost time: 1.360682725906372
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.387 Vali Acc: 0.835 Test Loss: 1.387 Test Acc: 0.835
Validation loss decreased (-0.767552 --> -0.835121).  Saving model ...
Epoch: 9 cost time: 1.1837329864501953
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.263 Vali Acc: 0.865 Test Loss: 1.263 Test Acc: 0.865
Validation loss decreased (-0.835121 --> -0.864852).  Saving model ...
Epoch: 10 cost time: 1.4314024448394775
Epoch: 10, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.147 Vali Acc: 0.884 Test Loss: 1.147 Test Acc: 0.884
Validation loss decreased (-0.864852 --> -0.883772).  Saving model ...
Epoch: 11 cost time: 1.5649433135986328
Epoch: 11, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.039 Vali Acc: 0.884 Test Loss: 1.039 Test Acc: 0.884
Validation loss decreased (-0.883772 --> -0.883773).  Saving model ...
Epoch: 12 cost time: 1.3122575283050537
Epoch: 12, Steps: 17 | Train Loss: 0.866 Vali Loss: 0.945 Vali Acc: 0.886 Test Loss: 0.945 Test Acc: 0.886
Validation loss decreased (-0.883773 --> -0.886477).  Saving model ...
Epoch: 13 cost time: 1.1346666812896729
Epoch: 13, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.869 Vali Acc: 0.881 Test Loss: 0.869 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6950318813323975
Epoch: 14, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.792 Vali Acc: 0.900 Test Loss: 0.792 Test Acc: 0.900
Validation loss decreased (-0.886477 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 1.5455446243286133
Epoch: 15, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.733 Vali Acc: 0.895 Test Loss: 0.733 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4098212718963623
Epoch: 16, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.679 Vali Acc: 0.903 Test Loss: 0.679 Test Acc: 0.903
Validation loss decreased (-0.899992 --> -0.902696).  Saving model ...
Epoch: 17 cost time: 1.258406400680542
Epoch: 17, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5090320110321045
Epoch: 18, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4643545150756836
Epoch: 19, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4164328575134277
Epoch: 20, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.432027816772461
Epoch: 21, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.495 Vali Acc: 0.908 Test Loss: 0.495 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908103).  Saving model ...
Epoch: 22 cost time: 1.4470601081848145
Epoch: 22, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.471 Vali Acc: 0.908 Test Loss: 0.471 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908103).  Saving model ...
Epoch: 23 cost time: 1.1560170650482178
Epoch: 23, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.449 Vali Acc: 0.908 Test Loss: 0.449 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908104).  Saving model ...
Epoch: 24 cost time: 1.2211570739746094
Epoch: 24, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.439 Vali Acc: 0.903 Test Loss: 0.439 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2379648685455322
Epoch: 25, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.421 Vali Acc: 0.916 Test Loss: 0.421 Test Acc: 0.916
Validation loss decreased (-0.908104 --> -0.916212).  Saving model ...
Epoch: 26 cost time: 1.0718352794647217
Epoch: 26, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.401 Vali Acc: 0.919 Test Loss: 0.401 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 1.324998140335083
Epoch: 27, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2046120166778564
Epoch: 28, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 29 cost time: 1.2554526329040527
Epoch: 29, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.353 Vali Acc: 0.922 Test Loss: 0.353 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
Epoch: 30 cost time: 1.5310862064361572
Epoch: 30, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
Epoch: 31 cost time: 1.1630752086639404
Epoch: 31, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.349 Vali Acc: 0.927 Test Loss: 0.349 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 32 cost time: 1.400141954421997
Epoch: 32, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.327 Vali Acc: 0.908 Test Loss: 0.327 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4474506378173828
Epoch: 33, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 34 cost time: 1.2938499450683594
Epoch: 34, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2038326263427734
Epoch: 35, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.302 Vali Acc: 0.924 Test Loss: 0.302 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3741216659545898
Epoch: 36, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.300 Vali Acc: 0.924 Test Loss: 0.300 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2498962879180908
Epoch: 37, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 38 cost time: 1.194392204284668
Epoch: 38, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.280 Vali Acc: 0.932 Test Loss: 0.280 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 39 cost time: 1.2969694137573242
Epoch: 39, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8285243511199951
Epoch: 40, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3469526767730713
Epoch: 41, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2177999019622803
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.932 Test Loss: 0.264 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 43 cost time: 1.3111515045166016
Epoch: 43, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6483008861541748
Epoch: 44, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1987767219543457
Epoch: 45, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2122471332550049
Epoch: 46, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2697391510009766
Epoch: 47, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.927 Test Loss: 0.255 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.527226448059082
Epoch: 48, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.249 Vali Acc: 0.927 Test Loss: 0.249 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.5462160110473633
Epoch: 49, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.253 Vali Acc: 0.924 Test Loss: 0.253 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3141300678253174
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.246 Vali Acc: 0.927 Test Loss: 0.246 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.4601280689239502
Epoch: 51, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.272524356842041
Epoch: 52, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9324324324324325
model parameter : 67183
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.400526285171509
Epoch: 1, Steps: 17 | Train Loss: 2.138 Vali Loss: 2.154 Vali Acc: 0.214 Test Loss: 2.154 Test Acc: 0.214
Validation loss decreased (inf --> -0.213492).  Saving model ...
Epoch: 2 cost time: 1.373727798461914
Epoch: 2, Steps: 17 | Train Loss: 2.057 Vali Loss: 2.069 Vali Acc: 0.322 Test Loss: 2.069 Test Acc: 0.322
Validation loss decreased (-0.213492 --> -0.321601).  Saving model ...
Epoch: 3 cost time: 1.2425405979156494
Epoch: 3, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.962 Vali Acc: 0.405 Test Loss: 1.962 Test Acc: 0.405
Validation loss decreased (-0.321601 --> -0.405386).  Saving model ...
Epoch: 4 cost time: 1.0747275352478027
Epoch: 4, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.848 Vali Acc: 0.514 Test Loss: 1.848 Test Acc: 0.514
Validation loss decreased (-0.405386 --> -0.513495).  Saving model ...
Epoch: 5 cost time: 1.4749910831451416
Epoch: 5, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.722 Vali Acc: 0.630 Test Loss: 1.722 Test Acc: 0.630
Validation loss decreased (-0.513495 --> -0.629713).  Saving model ...
Epoch: 6 cost time: 1.3341240882873535
Epoch: 6, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.587 Vali Acc: 0.705 Test Loss: 1.587 Test Acc: 0.705
Validation loss decreased (-0.629713 --> -0.705390).  Saving model ...
Epoch: 7 cost time: 1.2946429252624512
Epoch: 7, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.455 Vali Acc: 0.768 Test Loss: 1.455 Test Acc: 0.768
Validation loss decreased (-0.705390 --> -0.767553).  Saving model ...
Epoch: 8 cost time: 1.4644248485565186
Epoch: 8, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.330 Vali Acc: 0.803 Test Loss: 1.330 Test Acc: 0.803
Validation loss decreased (-0.767553 --> -0.802689).  Saving model ...
Epoch: 9 cost time: 1.194859504699707
Epoch: 9, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.212 Vali Acc: 0.819 Test Loss: 1.212 Test Acc: 0.819
Validation loss decreased (-0.802689 --> -0.818907).  Saving model ...
Epoch: 10 cost time: 1.2844257354736328
Epoch: 10, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.107 Vali Acc: 0.849 Test Loss: 1.107 Test Acc: 0.849
Validation loss decreased (-0.818907 --> -0.848638).  Saving model ...
Epoch: 11 cost time: 1.207289218902588
Epoch: 11, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.002 Vali Acc: 0.857 Test Loss: 1.002 Test Acc: 0.857
Validation loss decreased (-0.848638 --> -0.856747).  Saving model ...
Epoch: 12 cost time: 1.2439780235290527
Epoch: 12, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.920 Vali Acc: 0.870 Test Loss: 0.920 Test Acc: 0.870
Validation loss decreased (-0.856747 --> -0.870261).  Saving model ...
Epoch: 13 cost time: 1.294693946838379
Epoch: 13, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.840 Vali Acc: 0.870 Test Loss: 0.840 Test Acc: 0.870
Validation loss decreased (-0.870261 --> -0.870262).  Saving model ...
Epoch: 14 cost time: 1.134599208831787
Epoch: 14, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.777 Vali Acc: 0.876 Test Loss: 0.777 Test Acc: 0.876
Validation loss decreased (-0.870262 --> -0.875668).  Saving model ...
Epoch: 15 cost time: 1.2938251495361328
Epoch: 15, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.714 Vali Acc: 0.892 Test Loss: 0.714 Test Acc: 0.892
Validation loss decreased (-0.875668 --> -0.891885).  Saving model ...
Epoch: 16 cost time: 1.43174409866333
Epoch: 16, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.659 Vali Acc: 0.903 Test Loss: 0.659 Test Acc: 0.903
Validation loss decreased (-0.891885 --> -0.902696).  Saving model ...
Epoch: 17 cost time: 1.5668962001800537
Epoch: 17, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.611 Vali Acc: 0.903 Test Loss: 0.611 Test Acc: 0.903
Validation loss decreased (-0.902696 --> -0.902697).  Saving model ...
Epoch: 18 cost time: 1.3265037536621094
Epoch: 18, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.565 Vali Acc: 0.908 Test Loss: 0.565 Test Acc: 0.908
Validation loss decreased (-0.902697 --> -0.908102).  Saving model ...
Epoch: 19 cost time: 1.312143087387085
Epoch: 19, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.534 Vali Acc: 0.916 Test Loss: 0.534 Test Acc: 0.916
Validation loss decreased (-0.908102 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 1.5443077087402344
Epoch: 20, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.499 Vali Acc: 0.914 Test Loss: 0.499 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3650712966918945
Epoch: 21, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.478 Vali Acc: 0.914 Test Loss: 0.478 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.632755994796753
Epoch: 22, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.450 Vali Acc: 0.924 Test Loss: 0.450 Test Acc: 0.924
Validation loss decreased (-0.916211 --> -0.924320).  Saving model ...
Epoch: 23 cost time: 1.2088727951049805
Epoch: 23, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.418 Vali Acc: 0.927 Test Loss: 0.418 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 24 cost time: 1.0639703273773193
Epoch: 24, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.401 Vali Acc: 0.930 Test Loss: 0.401 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 25 cost time: 1.2524538040161133
Epoch: 25, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.379 Vali Acc: 0.932 Test Loss: 0.379 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 26 cost time: 1.3384335041046143
Epoch: 26, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.359 Vali Acc: 0.935 Test Loss: 0.359 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 27 cost time: 1.2240333557128906
Epoch: 27, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.346 Vali Acc: 0.938 Test Loss: 0.346 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937834).  Saving model ...
Epoch: 28 cost time: 1.318580150604248
Epoch: 28, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.137711763381958
Epoch: 29, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.317 Vali Acc: 0.946 Test Loss: 0.317 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 30 cost time: 1.3877980709075928
Epoch: 30, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.176405429840088
Epoch: 31, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.295 Vali Acc: 0.941 Test Loss: 0.295 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2961828708648682
Epoch: 32, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2318923473358154
Epoch: 33, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.266 Vali Acc: 0.938 Test Loss: 0.266 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1852195262908936
Epoch: 34, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1488535404205322
Epoch: 35, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.949 Test Loss: 0.264 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 36 cost time: 1.2434265613555908
Epoch: 36, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.259 Vali Acc: 0.946 Test Loss: 0.259 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.558814287185669
Epoch: 37, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.249 Vali Acc: 0.949 Test Loss: 0.249 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 38 cost time: 1.2958996295928955
Epoch: 38, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.250 Vali Acc: 0.954 Test Loss: 0.250 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 39 cost time: 1.435539960861206
Epoch: 39, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.237 Vali Acc: 0.951 Test Loss: 0.237 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.198117733001709
Epoch: 40, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3890323638916016
Epoch: 41, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1208229064941406
Epoch: 42, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.233 Vali Acc: 0.949 Test Loss: 0.233 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.468555212020874
Epoch: 43, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2242870330810547
Epoch: 44, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3881678581237793
Epoch: 45, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1566393375396729
Epoch: 46, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2282392978668213
Epoch: 47, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.5906307697296143
Epoch: 48, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 66159
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9914910793304443
Epoch: 1, Steps: 17 | Train Loss: 2.255 Vali Loss: 2.193 Vali Acc: 0.038 Test Loss: 2.193 Test Acc: 0.038
Validation loss decreased (inf --> -0.037816).  Saving model ...
Epoch: 2 cost time: 1.2989039421081543
Epoch: 2, Steps: 17 | Train Loss: 2.177 Vali Loss: 2.103 Vali Acc: 0.111 Test Loss: 2.103 Test Acc: 0.111
Validation loss decreased (-0.037816 --> -0.110790).  Saving model ...
Epoch: 3 cost time: 1.1861965656280518
Epoch: 3, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.989 Vali Acc: 0.324 Test Loss: 1.989 Test Acc: 0.324
Validation loss decreased (-0.110790 --> -0.324304).  Saving model ...
Epoch: 4 cost time: 1.1477994918823242
Epoch: 4, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.853 Vali Acc: 0.600 Test Loss: 1.853 Test Acc: 0.600
Validation loss decreased (-0.324304 --> -0.599981).  Saving model ...
Epoch: 5 cost time: 1.1043651103973389
Epoch: 5, Steps: 17 | Train Loss: 1.764 Vali Loss: 1.708 Vali Acc: 0.714 Test Loss: 1.708 Test Acc: 0.714
Validation loss decreased (-0.599981 --> -0.713496).  Saving model ...
Epoch: 6 cost time: 0.9769775867462158
Epoch: 6, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.563 Vali Acc: 0.800 Test Loss: 1.563 Test Acc: 0.800
Validation loss decreased (-0.713496 --> -0.799984).  Saving model ...
Epoch: 7 cost time: 1.3242762088775635
Epoch: 7, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.423 Vali Acc: 0.827 Test Loss: 1.423 Test Acc: 0.827
Validation loss decreased (-0.799984 --> -0.827013).  Saving model ...
Epoch: 8 cost time: 1.1331334114074707
Epoch: 8, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.302 Vali Acc: 0.838 Test Loss: 1.302 Test Acc: 0.838
Validation loss decreased (-0.827013 --> -0.837825).  Saving model ...
Epoch: 9 cost time: 1.2056119441986084
Epoch: 9, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.177 Vali Acc: 0.849 Test Loss: 1.177 Test Acc: 0.849
Validation loss decreased (-0.837825 --> -0.848637).  Saving model ...
Epoch: 10 cost time: 1.4591093063354492
Epoch: 10, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.072 Vali Acc: 0.859 Test Loss: 1.072 Test Acc: 0.859
Validation loss decreased (-0.848637 --> -0.859449).  Saving model ...
Epoch: 11 cost time: 1.1532635688781738
Epoch: 11, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.970 Vali Acc: 0.870 Test Loss: 0.970 Test Acc: 0.870
Validation loss decreased (-0.859449 --> -0.870261).  Saving model ...
Epoch: 12 cost time: 1.294177532196045
Epoch: 12, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.889 Vali Acc: 0.881 Test Loss: 0.889 Test Acc: 0.881
Validation loss decreased (-0.870261 --> -0.881072).  Saving model ...
Epoch: 13 cost time: 1.220073938369751
Epoch: 13, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.804 Vali Acc: 0.892 Test Loss: 0.804 Test Acc: 0.892
Validation loss decreased (-0.881072 --> -0.891884).  Saving model ...
Epoch: 14 cost time: 1.1822378635406494
Epoch: 14, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.741 Vali Acc: 0.892 Test Loss: 0.741 Test Acc: 0.892
Validation loss decreased (-0.891884 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 0.9986023902893066
Epoch: 15, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.689 Vali Acc: 0.897 Test Loss: 0.689 Test Acc: 0.897
Validation loss decreased (-0.891884 --> -0.897290).  Saving model ...
Epoch: 16 cost time: 1.3586115837097168
Epoch: 16, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.649 Vali Acc: 0.892 Test Loss: 0.649 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0099732875823975
Epoch: 17, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.606 Vali Acc: 0.905 Test Loss: 0.606 Test Acc: 0.905
Validation loss decreased (-0.897290 --> -0.905399).  Saving model ...
Epoch: 18 cost time: 1.326338529586792
Epoch: 18, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.560 Vali Acc: 0.908 Test Loss: 0.560 Test Acc: 0.908
Validation loss decreased (-0.905399 --> -0.908103).  Saving model ...
Epoch: 19 cost time: 1.466264247894287
Epoch: 19, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.534 Vali Acc: 0.903 Test Loss: 0.534 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6159398555755615
Epoch: 20, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.499 Vali Acc: 0.919 Test Loss: 0.499 Test Acc: 0.919
Validation loss decreased (-0.908103 --> -0.918914).  Saving model ...
Epoch: 21 cost time: 1.1706969738006592
Epoch: 21, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.475 Vali Acc: 0.914 Test Loss: 0.475 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2878668308258057
Epoch: 22, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.463 Vali Acc: 0.919 Test Loss: 0.463 Test Acc: 0.919
Validation loss decreased (-0.918914 --> -0.918914).  Saving model ...
Epoch: 23 cost time: 1.0239133834838867
Epoch: 23, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.416 Vali Acc: 0.916 Test Loss: 0.416 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0727262496948242
Epoch: 24, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1768231391906738
Epoch: 25, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.391 Vali Acc: 0.924 Test Loss: 0.391 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 1.0956149101257324
Epoch: 26, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.370 Vali Acc: 0.930 Test Loss: 0.370 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 27 cost time: 1.1801254749298096
Epoch: 27, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1525685787200928
Epoch: 28, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.348 Vali Acc: 0.916 Test Loss: 0.348 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5939364433288574
Epoch: 29, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.220740795135498
Epoch: 30, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.316 Vali Acc: 0.916 Test Loss: 0.316 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1583483219146729
Epoch: 31, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4107608795166016
Epoch: 32, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.308 Vali Acc: 0.916 Test Loss: 0.308 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2505097389221191
Epoch: 33, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.288 Vali Acc: 0.927 Test Loss: 0.288 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.188687801361084
Epoch: 34, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.093294620513916
Epoch: 35, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.07905912399292
Epoch: 36, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.286 Vali Acc: 0.914 Test Loss: 0.286 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9297297297297298
model parameter : 65135
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.338073492050171
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.206 Vali Acc: 0.162 Test Loss: 2.206 Test Acc: 0.162
Validation loss decreased (inf --> -0.162140).  Saving model ...
Epoch: 2 cost time: 1.242168664932251
Epoch: 2, Steps: 17 | Train Loss: 2.088 Vali Loss: 2.113 Vali Acc: 0.235 Test Loss: 2.113 Test Acc: 0.235
Validation loss decreased (-0.162140 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 1.1597728729248047
Epoch: 3, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.997 Vali Acc: 0.362 Test Loss: 1.997 Test Acc: 0.362
Validation loss decreased (-0.235114 --> -0.362142).  Saving model ...
Epoch: 4 cost time: 0.8856379985809326
Epoch: 4, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.874 Vali Acc: 0.473 Test Loss: 1.874 Test Acc: 0.473
Validation loss decreased (-0.362142 --> -0.472954).  Saving model ...
Epoch: 5 cost time: 1.1274244785308838
Epoch: 5, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.742 Vali Acc: 0.592 Test Loss: 1.742 Test Acc: 0.592
Validation loss decreased (-0.472954 --> -0.591874).  Saving model ...
Epoch: 6 cost time: 1.10835599899292
Epoch: 6, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.619 Vali Acc: 0.670 Test Loss: 1.619 Test Acc: 0.670
Validation loss decreased (-0.591874 --> -0.670254).  Saving model ...
Epoch: 7 cost time: 1.0810704231262207
Epoch: 7, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.496 Vali Acc: 0.754 Test Loss: 1.496 Test Acc: 0.754
Validation loss decreased (-0.670254 --> -0.754039).  Saving model ...
Epoch: 8 cost time: 1.323274850845337
Epoch: 8, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.380 Vali Acc: 0.786 Test Loss: 1.380 Test Acc: 0.786
Validation loss decreased (-0.754039 --> -0.786473).  Saving model ...
Epoch: 9 cost time: 1.1843047142028809
Epoch: 9, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.265 Vali Acc: 0.814 Test Loss: 1.265 Test Acc: 0.814
Validation loss decreased (-0.786473 --> -0.813501).  Saving model ...
Epoch: 10 cost time: 1.7778356075286865
Epoch: 10, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.161 Vali Acc: 0.830 Test Loss: 1.161 Test Acc: 0.830
Validation loss decreased (-0.813501 --> -0.829718).  Saving model ...
Epoch: 11 cost time: 1.3385803699493408
Epoch: 11, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.061 Vali Acc: 0.851 Test Loss: 1.061 Test Acc: 0.851
Validation loss decreased (-0.829718 --> -0.851341).  Saving model ...
Epoch: 12 cost time: 1.228224515914917
Epoch: 12, Steps: 17 | Train Loss: 0.822 Vali Loss: 0.975 Vali Acc: 0.838 Test Loss: 0.975 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2276239395141602
Epoch: 13, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.887 Vali Acc: 0.857 Test Loss: 0.887 Test Acc: 0.857
Validation loss decreased (-0.851341 --> -0.856748).  Saving model ...
Epoch: 14 cost time: 1.170588731765747
Epoch: 14, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.820 Vali Acc: 0.859 Test Loss: 0.820 Test Acc: 0.859
Validation loss decreased (-0.856748 --> -0.859451).  Saving model ...
Epoch: 15 cost time: 1.1789357662200928
Epoch: 15, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.758 Vali Acc: 0.859 Test Loss: 0.758 Test Acc: 0.859
Validation loss decreased (-0.859451 --> -0.859452).  Saving model ...
Epoch: 16 cost time: 1.1367175579071045
Epoch: 16, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.707 Vali Acc: 0.870 Test Loss: 0.707 Test Acc: 0.870
Validation loss decreased (-0.859452 --> -0.870263).  Saving model ...
Epoch: 17 cost time: 1.2786848545074463
Epoch: 17, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.649 Vali Acc: 0.884 Test Loss: 0.649 Test Acc: 0.884
Validation loss decreased (-0.870263 --> -0.883777).  Saving model ...
Epoch: 18 cost time: 1.4411141872406006
Epoch: 18, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.617 Vali Acc: 0.876 Test Loss: 0.617 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2432169914245605
Epoch: 19, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.588 Vali Acc: 0.881 Test Loss: 0.588 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2117464542388916
Epoch: 20, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.546 Vali Acc: 0.895 Test Loss: 0.546 Test Acc: 0.895
Validation loss decreased (-0.883777 --> -0.894589).  Saving model ...
Epoch: 21 cost time: 1.2581019401550293
Epoch: 21, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.514 Vali Acc: 0.892 Test Loss: 0.514 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.043933629989624
Epoch: 22, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.523 Vali Acc: 0.886 Test Loss: 0.523 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2179961204528809
Epoch: 23, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.481 Vali Acc: 0.892 Test Loss: 0.481 Test Acc: 0.892
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0248479843139648
Epoch: 24, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.486 Vali Acc: 0.881 Test Loss: 0.486 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2583892345428467
Epoch: 25, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.456 Vali Acc: 0.886 Test Loss: 0.456 Test Acc: 0.886
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9981675148010254
Epoch: 26, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.430 Vali Acc: 0.892 Test Loss: 0.430 Test Acc: 0.892
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.359198808670044
Epoch: 27, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.411 Vali Acc: 0.905 Test Loss: 0.411 Test Acc: 0.905
Validation loss decreased (-0.894589 --> -0.905401).  Saving model ...
Epoch: 28 cost time: 1.0406010150909424
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.045078992843628
Epoch: 29, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.391 Vali Acc: 0.905 Test Loss: 0.391 Test Acc: 0.905
Validation loss decreased (-0.905401 --> -0.905401).  Saving model ...
Epoch: 30 cost time: 0.9538006782531738
Epoch: 30, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2415578365325928
Epoch: 31, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1145741939544678
Epoch: 32, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1120116710662842
Epoch: 33, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.378 Vali Acc: 0.897 Test Loss: 0.378 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.999244213104248
Epoch: 34, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.366 Vali Acc: 0.895 Test Loss: 0.366 Test Acc: 0.895
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0009593963623047
Epoch: 35, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
Validation loss decreased (-0.905401 --> -0.910807).  Saving model ...
Epoch: 36 cost time: 1.0864899158477783
Epoch: 36, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.347 Vali Acc: 0.905 Test Loss: 0.347 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.100050687789917
Epoch: 37, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.344 Vali Acc: 0.908 Test Loss: 0.344 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9164550304412842
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.339 Vali Acc: 0.908 Test Loss: 0.339 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0993218421936035
Epoch: 39, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.336 Vali Acc: 0.914 Test Loss: 0.336 Test Acc: 0.914
Validation loss decreased (-0.910807 --> -0.913510).  Saving model ...
Epoch: 40 cost time: 0.8510572910308838
Epoch: 40, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7524471282958984
Epoch: 41, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9769783020019531
Epoch: 42, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.338 Vali Acc: 0.908 Test Loss: 0.338 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8802125453948975
Epoch: 43, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.317 Vali Acc: 0.908 Test Loss: 0.317 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.961566686630249
Epoch: 44, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.313 Vali Acc: 0.916 Test Loss: 0.313 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916213).  Saving model ...
Epoch: 45 cost time: 1.0547564029693604
Epoch: 45, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.319 Vali Acc: 0.905 Test Loss: 0.319 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1737947463989258
Epoch: 46, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.320 Vali Acc: 0.914 Test Loss: 0.320 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1818478107452393
Epoch: 47, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.321 Vali Acc: 0.908 Test Loss: 0.321 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1945183277130127
Epoch: 48, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1844682693481445
Epoch: 49, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2441482543945312
Epoch: 50, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1731553077697754
Epoch: 51, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.312 Vali Acc: 0.914 Test Loss: 0.312 Test Acc: 0.914
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.15940523147583
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.126779317855835
Epoch: 53, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.309 Vali Acc: 0.916 Test Loss: 0.309 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 54 cost time: 1.1048924922943115
Epoch: 54, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.916 Test Loss: 0.303 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 55 cost time: 1.1457581520080566
Epoch: 55, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.916 Test Loss: 0.293 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 56 cost time: 1.6350300312042236
Epoch: 56, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.293950080871582
Epoch: 57, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.314 Vali Acc: 0.905 Test Loss: 0.314 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9940121173858643
Epoch: 58, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2576003074645996
Epoch: 59, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918916).  Saving model ...
Epoch: 60 cost time: 1.2887182235717773
Epoch: 60, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.286 Vali Acc: 0.916 Test Loss: 0.286 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0547029972076416
Epoch: 61, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.311 Vali Acc: 0.916 Test Loss: 0.311 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1367368698120117
Epoch: 62, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 63 cost time: 1.0376691818237305
Epoch: 63, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.002819538116455
Epoch: 64, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.2684049606323242
Epoch: 65, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.3980247974395752
Epoch: 66, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 67 cost time: 1.4111559391021729
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.149066686630249
Epoch: 68, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9599871635437012
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.916 Test Loss: 0.288 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.2117743492126465
Epoch: 70, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.916 Test Loss: 0.292 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.067448616027832
Epoch: 71, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.919 Test Loss: 0.283 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.2010045051574707
Epoch: 72, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.914 Test Loss: 0.294 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.1581180095672607
Epoch: 73, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.914 Test Loss: 0.289 Test Acc: 0.914
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.030928134918213
Epoch: 74, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.749730110168457
Epoch: 75, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.916 Test Loss: 0.274 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.9629554748535156
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.914 Test Loss: 0.286 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9216216216216216
model parameter : 64111
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4104373455047607
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.206 Vali Acc: 0.162 Test Loss: 2.206 Test Acc: 0.162
Validation loss decreased (inf --> -0.162140).  Saving model ...
Epoch: 2 cost time: 1.1570403575897217
Epoch: 2, Steps: 17 | Train Loss: 2.088 Vali Loss: 2.113 Vali Acc: 0.235 Test Loss: 2.113 Test Acc: 0.235
Validation loss decreased (-0.162140 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 1.0363471508026123
Epoch: 3, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.997 Vali Acc: 0.362 Test Loss: 1.997 Test Acc: 0.362
Validation loss decreased (-0.235114 --> -0.362142).  Saving model ...
Epoch: 4 cost time: 0.9877989292144775
Epoch: 4, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.874 Vali Acc: 0.473 Test Loss: 1.874 Test Acc: 0.473
Validation loss decreased (-0.362142 --> -0.472954).  Saving model ...
Epoch: 5 cost time: 1.0089163780212402
Epoch: 5, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.742 Vali Acc: 0.592 Test Loss: 1.742 Test Acc: 0.592
Validation loss decreased (-0.472954 --> -0.591874).  Saving model ...
Epoch: 6 cost time: 1.095299243927002
Epoch: 6, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.619 Vali Acc: 0.670 Test Loss: 1.619 Test Acc: 0.670
Validation loss decreased (-0.591874 --> -0.670254).  Saving model ...
Epoch: 7 cost time: 1.098444938659668
Epoch: 7, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.496 Vali Acc: 0.754 Test Loss: 1.496 Test Acc: 0.754
Validation loss decreased (-0.670254 --> -0.754039).  Saving model ...
Epoch: 8 cost time: 0.9839291572570801
Epoch: 8, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.380 Vali Acc: 0.786 Test Loss: 1.380 Test Acc: 0.786
Validation loss decreased (-0.754039 --> -0.786473).  Saving model ...
Epoch: 9 cost time: 1.1307156085968018
Epoch: 9, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.265 Vali Acc: 0.814 Test Loss: 1.265 Test Acc: 0.814
Validation loss decreased (-0.786473 --> -0.813501).  Saving model ...
Epoch: 10 cost time: 1.0419671535491943
Epoch: 10, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.161 Vali Acc: 0.830 Test Loss: 1.161 Test Acc: 0.830
Validation loss decreased (-0.813501 --> -0.829718).  Saving model ...
Epoch: 11 cost time: 1.1404950618743896
Epoch: 11, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.061 Vali Acc: 0.851 Test Loss: 1.061 Test Acc: 0.851
Validation loss decreased (-0.829718 --> -0.851341).  Saving model ...
Epoch: 12 cost time: 1.2326686382293701
Epoch: 12, Steps: 17 | Train Loss: 0.822 Vali Loss: 0.975 Vali Acc: 0.838 Test Loss: 0.975 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1591620445251465
Epoch: 13, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.887 Vali Acc: 0.857 Test Loss: 0.887 Test Acc: 0.857
Validation loss decreased (-0.851341 --> -0.856748).  Saving model ...
Epoch: 14 cost time: 1.1220028400421143
Epoch: 14, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.820 Vali Acc: 0.859 Test Loss: 0.820 Test Acc: 0.859
Validation loss decreased (-0.856748 --> -0.859451).  Saving model ...
Epoch: 15 cost time: 1.0743253231048584
Epoch: 15, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.758 Vali Acc: 0.859 Test Loss: 0.758 Test Acc: 0.859
Validation loss decreased (-0.859451 --> -0.859452).  Saving model ...
Epoch: 16 cost time: 0.9827110767364502
Epoch: 16, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.707 Vali Acc: 0.870 Test Loss: 0.707 Test Acc: 0.870
Validation loss decreased (-0.859452 --> -0.870263).  Saving model ...
Epoch: 17 cost time: 1.0001075267791748
Epoch: 17, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.649 Vali Acc: 0.884 Test Loss: 0.649 Test Acc: 0.884
Validation loss decreased (-0.870263 --> -0.883777).  Saving model ...
Epoch: 18 cost time: 1.1668291091918945
Epoch: 18, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.617 Vali Acc: 0.876 Test Loss: 0.617 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2692298889160156
Epoch: 19, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.588 Vali Acc: 0.881 Test Loss: 0.588 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1969661712646484
Epoch: 20, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.546 Vali Acc: 0.895 Test Loss: 0.546 Test Acc: 0.895
Validation loss decreased (-0.883777 --> -0.894589).  Saving model ...
Epoch: 21 cost time: 1.1053333282470703
Epoch: 21, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.514 Vali Acc: 0.892 Test Loss: 0.514 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1303963661193848
Epoch: 22, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.523 Vali Acc: 0.886 Test Loss: 0.523 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.019639015197754
Epoch: 23, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.481 Vali Acc: 0.892 Test Loss: 0.481 Test Acc: 0.892
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0841491222381592
Epoch: 24, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.486 Vali Acc: 0.881 Test Loss: 0.486 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9543967247009277
Epoch: 25, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.456 Vali Acc: 0.886 Test Loss: 0.456 Test Acc: 0.886
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.128286600112915
Epoch: 26, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.430 Vali Acc: 0.892 Test Loss: 0.430 Test Acc: 0.892
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2827012538909912
Epoch: 27, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.411 Vali Acc: 0.905 Test Loss: 0.411 Test Acc: 0.905
Validation loss decreased (-0.894589 --> -0.905401).  Saving model ...
Epoch: 28 cost time: 1.202683925628662
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1250629425048828
Epoch: 29, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.391 Vali Acc: 0.905 Test Loss: 0.391 Test Acc: 0.905
Validation loss decreased (-0.905401 --> -0.905401).  Saving model ...
Epoch: 30 cost time: 1.0440566539764404
Epoch: 30, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9662377834320068
Epoch: 31, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.974384069442749
Epoch: 32, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1285240650177002
Epoch: 33, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.378 Vali Acc: 0.897 Test Loss: 0.378 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1127078533172607
Epoch: 34, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.366 Vali Acc: 0.895 Test Loss: 0.366 Test Acc: 0.895
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0583522319793701
Epoch: 35, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
Validation loss decreased (-0.905401 --> -0.910807).  Saving model ...
Epoch: 36 cost time: 0.9265780448913574
Epoch: 36, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.347 Vali Acc: 0.905 Test Loss: 0.347 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0887467861175537
Epoch: 37, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.344 Vali Acc: 0.908 Test Loss: 0.344 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0963990688323975
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.339 Vali Acc: 0.908 Test Loss: 0.339 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1849355697631836
Epoch: 39, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.336 Vali Acc: 0.914 Test Loss: 0.336 Test Acc: 0.914
Validation loss decreased (-0.910807 --> -0.913510).  Saving model ...
Epoch: 40 cost time: 1.1577303409576416
Epoch: 40, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0481207370758057
Epoch: 41, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.955916166305542
Epoch: 42, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.338 Vali Acc: 0.908 Test Loss: 0.338 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0754387378692627
Epoch: 43, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.317 Vali Acc: 0.908 Test Loss: 0.317 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0875060558319092
Epoch: 44, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.313 Vali Acc: 0.916 Test Loss: 0.313 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916213).  Saving model ...
Epoch: 45 cost time: 1.0354669094085693
Epoch: 45, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.319 Vali Acc: 0.905 Test Loss: 0.319 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9819445610046387
Epoch: 46, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.320 Vali Acc: 0.914 Test Loss: 0.320 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2096188068389893
Epoch: 47, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.321 Vali Acc: 0.908 Test Loss: 0.321 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0335595607757568
Epoch: 48, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1612632274627686
Epoch: 49, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9415104389190674
Epoch: 50, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2819936275482178
Epoch: 51, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.312 Vali Acc: 0.914 Test Loss: 0.312 Test Acc: 0.914
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9018933773040771
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.9893913269042969
Epoch: 53, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.309 Vali Acc: 0.916 Test Loss: 0.309 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 54 cost time: 0.9928925037384033
Epoch: 54, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.916 Test Loss: 0.303 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 55 cost time: 1.051306962966919
Epoch: 55, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.916 Test Loss: 0.293 Test Acc: 0.916
Validation loss decreased (-0.916213 --> -0.916213).  Saving model ...
Epoch: 56 cost time: 0.9891190528869629
Epoch: 56, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9793682098388672
Epoch: 57, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.314 Vali Acc: 0.905 Test Loss: 0.314 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9534149169921875
Epoch: 58, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2326438426971436
Epoch: 59, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918916).  Saving model ...
Epoch: 60 cost time: 0.9475181102752686
Epoch: 60, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.286 Vali Acc: 0.916 Test Loss: 0.286 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1256906986236572
Epoch: 61, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.311 Vali Acc: 0.916 Test Loss: 0.311 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.819469690322876
Epoch: 62, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921619).  Saving model ...
Epoch: 63 cost time: 0.9401142597198486
Epoch: 63, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1037776470184326
Epoch: 64, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.16111159324646
Epoch: 65, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9074110984802246
Epoch: 66, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921619).  Saving model ...
Epoch: 67 cost time: 1.0931801795959473
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1021251678466797
Epoch: 68, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9510014057159424
Epoch: 69, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.916 Test Loss: 0.288 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.088155746459961
Epoch: 70, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.916 Test Loss: 0.292 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.926947832107544
Epoch: 71, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.919 Test Loss: 0.283 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.0017859935760498
Epoch: 72, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.914 Test Loss: 0.294 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.1871058940887451
Epoch: 73, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.914 Test Loss: 0.289 Test Acc: 0.914
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.0491399765014648
Epoch: 74, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.1501493453979492
Epoch: 75, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.916 Test Loss: 0.274 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.9258584976196289
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.914 Test Loss: 0.286 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9216216216216216
model parameter : 64111
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3750388622283936
Epoch: 1, Steps: 17 | Train Loss: 2.236 Vali Loss: 2.245 Vali Acc: 0.159 Test Loss: 2.245 Test Acc: 0.159
Validation loss decreased (inf --> -0.159437).  Saving model ...
Epoch: 2 cost time: 1.2989659309387207
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.161 Vali Acc: 0.254 Test Loss: 2.161 Test Acc: 0.254
Validation loss decreased (-0.159437 --> -0.254032).  Saving model ...
Epoch: 3 cost time: 1.4378111362457275
Epoch: 3, Steps: 17 | Train Loss: 2.060 Vali Loss: 2.062 Vali Acc: 0.357 Test Loss: 2.062 Test Acc: 0.357
Validation loss decreased (-0.254032 --> -0.356736).  Saving model ...
Epoch: 4 cost time: 1.267287015914917
Epoch: 4, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.961 Vali Acc: 0.430 Test Loss: 1.961 Test Acc: 0.430
Validation loss decreased (-0.356736 --> -0.429710).  Saving model ...
Epoch: 5 cost time: 1.1946091651916504
Epoch: 5, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.845 Vali Acc: 0.543 Test Loss: 1.845 Test Acc: 0.543
Validation loss decreased (-0.429710 --> -0.543225).  Saving model ...
Epoch: 6 cost time: 1.3191742897033691
Epoch: 6, Steps: 17 | Train Loss: 1.710 Vali Loss: 1.726 Vali Acc: 0.665 Test Loss: 1.726 Test Acc: 0.665
Validation loss decreased (-0.543225 --> -0.664848).  Saving model ...
Epoch: 7 cost time: 1.1614549160003662
Epoch: 7, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.597 Vali Acc: 0.738 Test Loss: 1.597 Test Acc: 0.738
Validation loss decreased (-0.664848 --> -0.737822).  Saving model ...
Epoch: 8 cost time: 1.2783586978912354
Epoch: 8, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.462 Vali Acc: 0.795 Test Loss: 1.462 Test Acc: 0.795
Validation loss decreased (-0.737822 --> -0.794580).  Saving model ...
Epoch: 9 cost time: 1.1104414463043213
Epoch: 9, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.326 Vali Acc: 0.814 Test Loss: 1.326 Test Acc: 0.814
Validation loss decreased (-0.794580 --> -0.813500).  Saving model ...
Epoch: 10 cost time: 1.4082365036010742
Epoch: 10, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.205 Vali Acc: 0.838 Test Loss: 1.205 Test Acc: 0.838
Validation loss decreased (-0.813500 --> -0.837826).  Saving model ...
Epoch: 11 cost time: 1.3257644176483154
Epoch: 11, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.080 Vali Acc: 0.859 Test Loss: 1.080 Test Acc: 0.859
Validation loss decreased (-0.837826 --> -0.859449).  Saving model ...
Epoch: 12 cost time: 1.1942532062530518
Epoch: 12, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.976 Vali Acc: 0.857 Test Loss: 0.976 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9779443740844727
Epoch: 13, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.869 Vali Acc: 0.876 Test Loss: 0.869 Test Acc: 0.876
Validation loss decreased (-0.859449 --> -0.875667).  Saving model ...
Epoch: 14 cost time: 1.0682361125946045
Epoch: 14, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.784 Vali Acc: 0.892 Test Loss: 0.784 Test Acc: 0.892
Validation loss decreased (-0.875667 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 1.2702839374542236
Epoch: 15, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.719 Vali Acc: 0.892 Test Loss: 0.719 Test Acc: 0.892
Validation loss decreased (-0.891884 --> -0.891885).  Saving model ...
Epoch: 16 cost time: 1.3599433898925781
Epoch: 16, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.658 Vali Acc: 0.897 Test Loss: 0.658 Test Acc: 0.897
Validation loss decreased (-0.891885 --> -0.897291).  Saving model ...
Epoch: 17 cost time: 1.205604076385498
Epoch: 17, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.607 Vali Acc: 0.897 Test Loss: 0.607 Test Acc: 0.897
Validation loss decreased (-0.897291 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 1.3789427280426025
Epoch: 18, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.569 Vali Acc: 0.905 Test Loss: 0.569 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905400).  Saving model ...
Epoch: 19 cost time: 1.2018601894378662
Epoch: 19, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.529 Vali Acc: 0.905 Test Loss: 0.529 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 1.2262213230133057
Epoch: 20, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.498 Vali Acc: 0.908 Test Loss: 0.498 Test Acc: 0.908
Validation loss decreased (-0.905400 --> -0.908103).  Saving model ...
Epoch: 21 cost time: 1.5079593658447266
Epoch: 21, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.470 Vali Acc: 0.919 Test Loss: 0.470 Test Acc: 0.919
Validation loss decreased (-0.908103 --> -0.918914).  Saving model ...
Epoch: 22 cost time: 1.4868907928466797
Epoch: 22, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.443 Vali Acc: 0.914 Test Loss: 0.443 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4161162376403809
Epoch: 23, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.429 Vali Acc: 0.908 Test Loss: 0.429 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5195355415344238
Epoch: 24, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.400 Vali Acc: 0.924 Test Loss: 0.400 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 25 cost time: 1.3814823627471924
Epoch: 25, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.386 Vali Acc: 0.924 Test Loss: 0.386 Test Acc: 0.924
Validation loss decreased (-0.924320 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 1.0585081577301025
Epoch: 26, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.375 Vali Acc: 0.922 Test Loss: 0.375 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.17008376121521
Epoch: 27, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.362 Vali Acc: 0.911 Test Loss: 0.362 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.186694860458374
Epoch: 28, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0741560459136963
Epoch: 29, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1770131587982178
Epoch: 30, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5265483856201172
Epoch: 31, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929727).  Saving model ...
Epoch: 32 cost time: 1.4287810325622559
Epoch: 32, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2944374084472656
Epoch: 33, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.304 Vali Acc: 0.924 Test Loss: 0.304 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.388343334197998
Epoch: 34, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.287 Vali Acc: 0.927 Test Loss: 0.287 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4024884700775146
Epoch: 35, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.299 Vali Acc: 0.916 Test Loss: 0.299 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6340312957763672
Epoch: 36, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5013535022735596
Epoch: 37, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.270 Vali Acc: 0.927 Test Loss: 0.270 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3385727405548096
Epoch: 38, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.271 Vali Acc: 0.924 Test Loss: 0.271 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5936412811279297
Epoch: 39, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 40 cost time: 1.3144586086273193
Epoch: 40, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3837010860443115
Epoch: 41, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.255 Vali Acc: 0.938 Test Loss: 0.255 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937835).  Saving model ...
Epoch: 42 cost time: 1.419896125793457
Epoch: 42, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.255 Vali Acc: 0.924 Test Loss: 0.255 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2508814334869385
Epoch: 43, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2674767971038818
Epoch: 44, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.932 Test Loss: 0.242 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.6223208904266357
Epoch: 45, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.294813632965088
Epoch: 46, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.5782451629638672
Epoch: 47, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.445695161819458
Epoch: 48, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3857367038726807
Epoch: 49, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.5577545166015625
Epoch: 50, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4063968658447266
Epoch: 51, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 66983
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.812079429626465
Epoch: 1, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.125 Vali Acc: 0.170 Test Loss: 2.125 Test Acc: 0.170
Validation loss decreased (inf --> -0.170249).  Saving model ...
Epoch: 2 cost time: 1.185030460357666
Epoch: 2, Steps: 17 | Train Loss: 2.094 Vali Loss: 2.045 Vali Acc: 0.262 Test Loss: 2.045 Test Acc: 0.262
Validation loss decreased (-0.170249 --> -0.262142).  Saving model ...
Epoch: 3 cost time: 1.1040315628051758
Epoch: 3, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.942 Vali Acc: 0.408 Test Loss: 1.942 Test Acc: 0.408
Validation loss decreased (-0.262142 --> -0.408089).  Saving model ...
Epoch: 4 cost time: 1.118415355682373
Epoch: 4, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.821 Vali Acc: 0.559 Test Loss: 1.821 Test Acc: 0.559
Validation loss decreased (-0.408089 --> -0.559441).  Saving model ...
Epoch: 5 cost time: 1.2871689796447754
Epoch: 5, Steps: 17 | Train Loss: 1.718 Vali Loss: 1.701 Vali Acc: 0.643 Test Loss: 1.701 Test Acc: 0.643
Validation loss decreased (-0.559441 --> -0.643226).  Saving model ...
Epoch: 6 cost time: 1.1841659545898438
Epoch: 6, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.576 Vali Acc: 0.730 Test Loss: 1.576 Test Acc: 0.730
Validation loss decreased (-0.643226 --> -0.729714).  Saving model ...
Epoch: 7 cost time: 1.2105119228363037
Epoch: 7, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.453 Vali Acc: 0.786 Test Loss: 1.453 Test Acc: 0.786
Validation loss decreased (-0.729714 --> -0.786472).  Saving model ...
Epoch: 8 cost time: 1.2632958889007568
Epoch: 8, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.340 Vali Acc: 0.816 Test Loss: 1.340 Test Acc: 0.816
Validation loss decreased (-0.786472 --> -0.816203).  Saving model ...
Epoch: 9 cost time: 1.033498764038086
Epoch: 9, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.222 Vali Acc: 0.841 Test Loss: 1.222 Test Acc: 0.841
Validation loss decreased (-0.816203 --> -0.840528).  Saving model ...
Epoch: 10 cost time: 1.1509628295898438
Epoch: 10, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.113 Vali Acc: 0.857 Test Loss: 1.113 Test Acc: 0.857
Validation loss decreased (-0.840528 --> -0.856746).  Saving model ...
Epoch: 11 cost time: 1.238032341003418
Epoch: 11, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.011 Vali Acc: 0.846 Test Loss: 1.011 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.517603874206543
Epoch: 12, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.920 Vali Acc: 0.873 Test Loss: 0.920 Test Acc: 0.873
Validation loss decreased (-0.856746 --> -0.872964).  Saving model ...
Epoch: 13 cost time: 1.2520358562469482
Epoch: 13, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.850 Vali Acc: 0.873 Test Loss: 0.850 Test Acc: 0.873
Validation loss decreased (-0.872964 --> -0.872964).  Saving model ...
Epoch: 14 cost time: 1.1642472743988037
Epoch: 14, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.764 Vali Acc: 0.892 Test Loss: 0.764 Test Acc: 0.892
Validation loss decreased (-0.872964 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 1.1531388759613037
Epoch: 15, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.719 Vali Acc: 0.876 Test Loss: 0.719 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2305214405059814
Epoch: 16, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.658 Vali Acc: 0.895 Test Loss: 0.658 Test Acc: 0.895
Validation loss decreased (-0.891884 --> -0.894588).  Saving model ...
Epoch: 17 cost time: 1.2662644386291504
Epoch: 17, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.614 Vali Acc: 0.886 Test Loss: 0.614 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2764382362365723
Epoch: 18, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.580 Vali Acc: 0.889 Test Loss: 0.580 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3121380805969238
Epoch: 19, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
Validation loss decreased (-0.894588 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 1.4544460773468018
Epoch: 20, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.514 Vali Acc: 0.903 Test Loss: 0.514 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902698).  Saving model ...
Epoch: 21 cost time: 1.1463558673858643
Epoch: 21, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.493 Vali Acc: 0.908 Test Loss: 0.493 Test Acc: 0.908
Validation loss decreased (-0.902698 --> -0.908103).  Saving model ...
Epoch: 22 cost time: 1.1172606945037842
Epoch: 22, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.064598798751831
Epoch: 23, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.440 Vali Acc: 0.903 Test Loss: 0.440 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4020369052886963
Epoch: 24, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.427 Vali Acc: 0.903 Test Loss: 0.427 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.997429370880127
Epoch: 25, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910807).  Saving model ...
Epoch: 26 cost time: 1.152799367904663
Epoch: 26, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.394 Vali Acc: 0.905 Test Loss: 0.394 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3251941204071045
Epoch: 27, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
Validation loss decreased (-0.910807 --> -0.910807).  Saving model ...
Epoch: 28 cost time: 1.3668177127838135
Epoch: 28, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.371 Vali Acc: 0.914 Test Loss: 0.371 Test Acc: 0.914
Validation loss decreased (-0.910807 --> -0.913510).  Saving model ...
Epoch: 29 cost time: 1.4421515464782715
Epoch: 29, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.361 Vali Acc: 0.914 Test Loss: 0.361 Test Acc: 0.914
Validation loss decreased (-0.913510 --> -0.913510).  Saving model ...
Epoch: 30 cost time: 1.164982795715332
Epoch: 30, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.335 Vali Acc: 0.916 Test Loss: 0.335 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916213).  Saving model ...
Epoch: 31 cost time: 1.2117655277252197
Epoch: 31, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.331 Vali Acc: 0.924 Test Loss: 0.331 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924321).  Saving model ...
Epoch: 32 cost time: 1.1988773345947266
Epoch: 32, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2132587432861328
Epoch: 33, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.286653995513916
Epoch: 34, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.317 Vali Acc: 0.914 Test Loss: 0.317 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3878636360168457
Epoch: 35, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.301 Vali Acc: 0.924 Test Loss: 0.301 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 36 cost time: 1.2065930366516113
Epoch: 36, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 37 cost time: 1.0991590023040771
Epoch: 37, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.290 Vali Acc: 0.924 Test Loss: 0.290 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2345249652862549
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 39 cost time: 1.177123785018921
Epoch: 39, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 40 cost time: 1.2478106021881104
Epoch: 40, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.288 Vali Acc: 0.924 Test Loss: 0.288 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.34391188621521
Epoch: 41, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.270 Vali Acc: 0.938 Test Loss: 0.270 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937835).  Saving model ...
Epoch: 42 cost time: 1.1349613666534424
Epoch: 42, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.924 Test Loss: 0.277 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.340749979019165
Epoch: 43, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.266 Vali Acc: 0.924 Test Loss: 0.266 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0384657382965088
Epoch: 44, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.273 Vali Acc: 0.916 Test Loss: 0.273 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0768096446990967
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.263 Vali Acc: 0.924 Test Loss: 0.263 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3076016902923584
Epoch: 46, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.258 Vali Acc: 0.927 Test Loss: 0.258 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2225258350372314
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.257 Vali Acc: 0.927 Test Loss: 0.257 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1039371490478516
Epoch: 48, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.2052078247070312
Epoch: 49, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2685613632202148
Epoch: 50, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.251 Vali Acc: 0.932 Test Loss: 0.251 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.1912813186645508
Epoch: 51, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 65959
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.758573532104492
Epoch: 1, Steps: 17 | Train Loss: 2.154 Vali Loss: 2.101 Vali Acc: 0.303 Test Loss: 2.101 Test Acc: 0.303
Validation loss decreased (inf --> -0.302682).  Saving model ...
Epoch: 2 cost time: 0.9597575664520264
Epoch: 2, Steps: 17 | Train Loss: 2.077 Vali Loss: 2.013 Vali Acc: 0.449 Test Loss: 2.013 Test Acc: 0.449
Validation loss decreased (-0.302682 --> -0.448629).  Saving model ...
Epoch: 3 cost time: 1.221848964691162
Epoch: 3, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.907 Vali Acc: 0.557 Test Loss: 1.907 Test Acc: 0.557
Validation loss decreased (-0.448629 --> -0.556738).  Saving model ...
Epoch: 4 cost time: 0.854931116104126
Epoch: 4, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.795 Vali Acc: 0.646 Test Loss: 1.795 Test Acc: 0.646
Validation loss decreased (-0.556738 --> -0.645928).  Saving model ...
Epoch: 5 cost time: 0.986358642578125
Epoch: 5, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.675 Vali Acc: 0.703 Test Loss: 1.675 Test Acc: 0.703
Validation loss decreased (-0.645928 --> -0.702686).  Saving model ...
Epoch: 6 cost time: 0.9549269676208496
Epoch: 6, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.552 Vali Acc: 0.773 Test Loss: 1.552 Test Acc: 0.773
Validation loss decreased (-0.702686 --> -0.772957).  Saving model ...
Epoch: 7 cost time: 1.094879388809204
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.435 Vali Acc: 0.803 Test Loss: 1.435 Test Acc: 0.803
Validation loss decreased (-0.772957 --> -0.802688).  Saving model ...
Epoch: 8 cost time: 0.8903183937072754
Epoch: 8, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.314 Vali Acc: 0.822 Test Loss: 1.314 Test Acc: 0.822
Validation loss decreased (-0.802688 --> -0.821608).  Saving model ...
Epoch: 9 cost time: 1.123396396636963
Epoch: 9, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.205 Vali Acc: 0.824 Test Loss: 1.205 Test Acc: 0.824
Validation loss decreased (-0.821608 --> -0.824312).  Saving model ...
Epoch: 10 cost time: 1.062117338180542
Epoch: 10, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.100 Vali Acc: 0.854 Test Loss: 1.100 Test Acc: 0.854
Validation loss decreased (-0.824312 --> -0.854043).  Saving model ...
Epoch: 11 cost time: 0.8660852909088135
Epoch: 11, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.011 Vali Acc: 0.865 Test Loss: 1.011 Test Acc: 0.865
Validation loss decreased (-0.854043 --> -0.864855).  Saving model ...
Epoch: 12 cost time: 0.9737229347229004
Epoch: 12, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.931 Vali Acc: 0.878 Test Loss: 0.931 Test Acc: 0.878
Validation loss decreased (-0.864855 --> -0.878369).  Saving model ...
Epoch: 13 cost time: 0.9423937797546387
Epoch: 13, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.846 Vali Acc: 0.884 Test Loss: 0.846 Test Acc: 0.884
Validation loss decreased (-0.878369 --> -0.883775).  Saving model ...
Epoch: 14 cost time: 0.9580345153808594
Epoch: 14, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.779 Vali Acc: 0.897 Test Loss: 0.779 Test Acc: 0.897
Validation loss decreased (-0.883775 --> -0.897290).  Saving model ...
Epoch: 15 cost time: 0.865748405456543
Epoch: 15, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.719 Vali Acc: 0.905 Test Loss: 0.719 Test Acc: 0.905
Validation loss decreased (-0.897290 --> -0.905398).  Saving model ...
Epoch: 16 cost time: 0.873058557510376
Epoch: 16, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.663 Vali Acc: 0.905 Test Loss: 0.663 Test Acc: 0.905
Validation loss decreased (-0.905398 --> -0.905399).  Saving model ...
Epoch: 17 cost time: 0.8971238136291504
Epoch: 17, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.619 Vali Acc: 0.911 Test Loss: 0.619 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 0.8884866237640381
Epoch: 18, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.578 Vali Acc: 0.914 Test Loss: 0.578 Test Acc: 0.914
Validation loss decreased (-0.910805 --> -0.913508).  Saving model ...
Epoch: 19 cost time: 0.8073620796203613
Epoch: 19, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.548 Vali Acc: 0.911 Test Loss: 0.548 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9818239212036133
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.511 Vali Acc: 0.924 Test Loss: 0.511 Test Acc: 0.924
Validation loss decreased (-0.913508 --> -0.924319).  Saving model ...
Epoch: 21 cost time: 1.0066711902618408
Epoch: 21, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.501 Vali Acc: 0.916 Test Loss: 0.501 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8951873779296875
Epoch: 22, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.462 Vali Acc: 0.927 Test Loss: 0.462 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927022).  Saving model ...
Epoch: 23 cost time: 0.8942430019378662
Epoch: 23, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.445 Vali Acc: 0.922 Test Loss: 0.445 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8764989376068115
Epoch: 24, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.415 Vali Acc: 0.932 Test Loss: 0.415 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 25 cost time: 0.8740661144256592
Epoch: 25, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.407 Vali Acc: 0.927 Test Loss: 0.407 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.091038703918457
Epoch: 26, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.394 Vali Acc: 0.932 Test Loss: 0.394 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932428).  Saving model ...
Epoch: 27 cost time: 0.9218025207519531
Epoch: 27, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.380 Vali Acc: 0.932 Test Loss: 0.380 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 28 cost time: 0.8622984886169434
Epoch: 28, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.361 Vali Acc: 0.938 Test Loss: 0.361 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937834).  Saving model ...
Epoch: 29 cost time: 1.1798317432403564
Epoch: 29, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.358 Vali Acc: 0.927 Test Loss: 0.358 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2119343280792236
Epoch: 30, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.344 Vali Acc: 0.927 Test Loss: 0.344 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0723028182983398
Epoch: 31, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.336 Vali Acc: 0.932 Test Loss: 0.336 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.084846019744873
Epoch: 32, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.041538953781128
Epoch: 33, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3094308376312256
Epoch: 34, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9489459991455078
Epoch: 35, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.304 Vali Acc: 0.938 Test Loss: 0.304 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 36 cost time: 1.1340737342834473
Epoch: 36, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.307 Vali Acc: 0.935 Test Loss: 0.307 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0807783603668213
Epoch: 37, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0945754051208496
Epoch: 38, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 39 cost time: 1.2018423080444336
Epoch: 39, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.279 Vali Acc: 0.949 Test Loss: 0.279 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 40 cost time: 1.1438040733337402
Epoch: 40, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.293 Vali Acc: 0.932 Test Loss: 0.293 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1658985614776611
Epoch: 41, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.278 Vali Acc: 0.932 Test Loss: 0.278 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.928673267364502
Epoch: 42, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.932 Test Loss: 0.270 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0731348991394043
Epoch: 43, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.271 Vali Acc: 0.938 Test Loss: 0.271 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0009558200836182
Epoch: 44, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.268 Vali Acc: 0.935 Test Loss: 0.268 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0539822578430176
Epoch: 45, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1407368183135986
Epoch: 46, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.268 Vali Acc: 0.938 Test Loss: 0.268 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9470515251159668
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.268 Vali Acc: 0.938 Test Loss: 0.268 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.047424077987671
Epoch: 48, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.943 Test Loss: 0.261 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9222955703735352
Epoch: 49, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 64935
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.846635580062866
Epoch: 1, Steps: 17 | Train Loss: 2.232 Vali Loss: 2.166 Vali Acc: 0.141 Test Loss: 2.166 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 0.9485280513763428
Epoch: 2, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.074 Vali Acc: 0.316 Test Loss: 2.074 Test Acc: 0.316
Validation loss decreased (-0.140519 --> -0.316195).  Saving model ...
Epoch: 3 cost time: 0.8421890735626221
Epoch: 3, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.966 Vali Acc: 0.522 Test Loss: 1.966 Test Acc: 0.522
Validation loss decreased (-0.316195 --> -0.521602).  Saving model ...
Epoch: 4 cost time: 0.859471321105957
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.847 Vali Acc: 0.622 Test Loss: 1.847 Test Acc: 0.622
Validation loss decreased (-0.521602 --> -0.621603).  Saving model ...
Epoch: 5 cost time: 1.0223369598388672
Epoch: 5, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.727 Vali Acc: 0.732 Test Loss: 1.727 Test Acc: 0.732
Validation loss decreased (-0.621603 --> -0.732415).  Saving model ...
Epoch: 6 cost time: 1.2039194107055664
Epoch: 6, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.605 Vali Acc: 0.789 Test Loss: 1.605 Test Acc: 0.789
Validation loss decreased (-0.732415 --> -0.789173).  Saving model ...
Epoch: 7 cost time: 1.0508677959442139
Epoch: 7, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.482 Vali Acc: 0.814 Test Loss: 1.482 Test Acc: 0.814
Validation loss decreased (-0.789173 --> -0.813499).  Saving model ...
Epoch: 8 cost time: 0.9507284164428711
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.358 Vali Acc: 0.846 Test Loss: 1.358 Test Acc: 0.846
Validation loss decreased (-0.813499 --> -0.845932).  Saving model ...
Epoch: 9 cost time: 0.8581478595733643
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.241 Vali Acc: 0.846 Test Loss: 1.241 Test Acc: 0.846
Validation loss decreased (-0.845932 --> -0.845934).  Saving model ...
Epoch: 10 cost time: 0.9974713325500488
Epoch: 10, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.128 Vali Acc: 0.868 Test Loss: 1.128 Test Acc: 0.868
Validation loss decreased (-0.845934 --> -0.867556).  Saving model ...
Epoch: 11 cost time: 1.1028578281402588
Epoch: 11, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.026 Vali Acc: 0.870 Test Loss: 1.026 Test Acc: 0.870
Validation loss decreased (-0.867556 --> -0.870260).  Saving model ...
Epoch: 12 cost time: 1.0372097492218018
Epoch: 12, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.931 Vali Acc: 0.886 Test Loss: 0.931 Test Acc: 0.886
Validation loss decreased (-0.870260 --> -0.886477).  Saving model ...
Epoch: 13 cost time: 0.9990267753601074
Epoch: 13, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.846 Vali Acc: 0.892 Test Loss: 0.846 Test Acc: 0.892
Validation loss decreased (-0.886477 --> -0.891883).  Saving model ...
Epoch: 14 cost time: 0.8614785671234131
Epoch: 14, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.779 Vali Acc: 0.895 Test Loss: 0.779 Test Acc: 0.895
Validation loss decreased (-0.891883 --> -0.894587).  Saving model ...
Epoch: 15 cost time: 1.0882318019866943
Epoch: 15, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.704 Vali Acc: 0.911 Test Loss: 0.704 Test Acc: 0.911
Validation loss decreased (-0.894587 --> -0.910804).  Saving model ...
Epoch: 16 cost time: 1.0503392219543457
Epoch: 16, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.649 Vali Acc: 0.916 Test Loss: 0.649 Test Acc: 0.916
Validation loss decreased (-0.910804 --> -0.916210).  Saving model ...
Epoch: 17 cost time: 0.8536105155944824
Epoch: 17, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.600 Vali Acc: 0.916 Test Loss: 0.600 Test Acc: 0.916
Validation loss decreased (-0.916210 --> -0.916210).  Saving model ...
Epoch: 18 cost time: 0.9109673500061035
Epoch: 18, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.552 Vali Acc: 0.922 Test Loss: 0.552 Test Acc: 0.922
Validation loss decreased (-0.916210 --> -0.921616).  Saving model ...
Epoch: 19 cost time: 1.0008928775787354
Epoch: 19, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.510 Vali Acc: 0.919 Test Loss: 0.510 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0018396377563477
Epoch: 20, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.471 Vali Acc: 0.927 Test Loss: 0.471 Test Acc: 0.927
Validation loss decreased (-0.921616 --> -0.927022).  Saving model ...
Epoch: 21 cost time: 1.1079223155975342
Epoch: 21, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.443 Vali Acc: 0.935 Test Loss: 0.443 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935131).  Saving model ...
Epoch: 22 cost time: 1.1233818531036377
Epoch: 22, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.421 Vali Acc: 0.930 Test Loss: 0.421 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0101757049560547
Epoch: 23, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.398 Vali Acc: 0.935 Test Loss: 0.398 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 24 cost time: 1.1740977764129639
Epoch: 24, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.374 Vali Acc: 0.935 Test Loss: 0.374 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 25 cost time: 0.8742384910583496
Epoch: 25, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.369 Vali Acc: 0.938 Test Loss: 0.369 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 26 cost time: 1.0475139617919922
Epoch: 26, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.339 Vali Acc: 0.938 Test Loss: 0.339 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 27 cost time: 0.8944742679595947
Epoch: 27, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0826177597045898
Epoch: 28, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.317 Vali Acc: 0.943 Test Loss: 0.317 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 29 cost time: 1.106062412261963
Epoch: 29, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.302 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3401620388031006
Epoch: 30, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.06577467918396
Epoch: 31, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.291 Vali Acc: 0.935 Test Loss: 0.291 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0661580562591553
Epoch: 32, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943241).  Saving model ...
Epoch: 33 cost time: 1.212801218032837
Epoch: 33, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.274 Vali Acc: 0.946 Test Loss: 0.274 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945943).  Saving model ...
Epoch: 34 cost time: 1.3902194499969482
Epoch: 34, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.262 Vali Acc: 0.938 Test Loss: 0.262 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0707945823669434
Epoch: 35, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1231412887573242
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 37 cost time: 1.4561798572540283
Epoch: 37, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.946 Test Loss: 0.245 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1384077072143555
Epoch: 38, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.285635232925415
Epoch: 39, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.002302885055542
Epoch: 40, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.234 Vali Acc: 0.943 Test Loss: 0.234 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.172903060913086
Epoch: 41, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9290409088134766
Epoch: 42, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1668357849121094
Epoch: 43, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9315261840820312
Epoch: 44, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1117939949035645
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.171600103378296
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 63911
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.924999713897705
Epoch: 1, Steps: 17 | Train Loss: 2.232 Vali Loss: 2.166 Vali Acc: 0.141 Test Loss: 2.166 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 1.0139741897583008
Epoch: 2, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.074 Vali Acc: 0.316 Test Loss: 2.074 Test Acc: 0.316
Validation loss decreased (-0.140519 --> -0.316195).  Saving model ...
Epoch: 3 cost time: 1.0057764053344727
Epoch: 3, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.966 Vali Acc: 0.522 Test Loss: 1.966 Test Acc: 0.522
Validation loss decreased (-0.316195 --> -0.521602).  Saving model ...
Epoch: 4 cost time: 0.8713798522949219
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.847 Vali Acc: 0.622 Test Loss: 1.847 Test Acc: 0.622
Validation loss decreased (-0.521602 --> -0.621603).  Saving model ...
Epoch: 5 cost time: 1.2515063285827637
Epoch: 5, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.727 Vali Acc: 0.732 Test Loss: 1.727 Test Acc: 0.732
Validation loss decreased (-0.621603 --> -0.732415).  Saving model ...
Epoch: 6 cost time: 0.9884896278381348
Epoch: 6, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.605 Vali Acc: 0.789 Test Loss: 1.605 Test Acc: 0.789
Validation loss decreased (-0.732415 --> -0.789173).  Saving model ...
Epoch: 7 cost time: 0.8229732513427734
Epoch: 7, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.482 Vali Acc: 0.814 Test Loss: 1.482 Test Acc: 0.814
Validation loss decreased (-0.789173 --> -0.813499).  Saving model ...
Epoch: 8 cost time: 0.8053851127624512
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.358 Vali Acc: 0.846 Test Loss: 1.358 Test Acc: 0.846
Validation loss decreased (-0.813499 --> -0.845932).  Saving model ...
Epoch: 9 cost time: 0.9253296852111816
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.241 Vali Acc: 0.846 Test Loss: 1.241 Test Acc: 0.846
Validation loss decreased (-0.845932 --> -0.845934).  Saving model ...
Epoch: 10 cost time: 1.1181628704071045
Epoch: 10, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.128 Vali Acc: 0.868 Test Loss: 1.128 Test Acc: 0.868
Validation loss decreased (-0.845934 --> -0.867556).  Saving model ...
Epoch: 11 cost time: 0.7794725894927979
Epoch: 11, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.026 Vali Acc: 0.870 Test Loss: 1.026 Test Acc: 0.870
Validation loss decreased (-0.867556 --> -0.870260).  Saving model ...
Epoch: 12 cost time: 0.8268516063690186
Epoch: 12, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.931 Vali Acc: 0.886 Test Loss: 0.931 Test Acc: 0.886
Validation loss decreased (-0.870260 --> -0.886477).  Saving model ...
Epoch: 13 cost time: 1.064969539642334
Epoch: 13, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.846 Vali Acc: 0.892 Test Loss: 0.846 Test Acc: 0.892
Validation loss decreased (-0.886477 --> -0.891883).  Saving model ...
Epoch: 14 cost time: 1.0344164371490479
Epoch: 14, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.779 Vali Acc: 0.895 Test Loss: 0.779 Test Acc: 0.895
Validation loss decreased (-0.891883 --> -0.894587).  Saving model ...
Epoch: 15 cost time: 0.9760258197784424
Epoch: 15, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.704 Vali Acc: 0.911 Test Loss: 0.704 Test Acc: 0.911
Validation loss decreased (-0.894587 --> -0.910804).  Saving model ...
Epoch: 16 cost time: 1.071331262588501
Epoch: 16, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.649 Vali Acc: 0.916 Test Loss: 0.649 Test Acc: 0.916
Validation loss decreased (-0.910804 --> -0.916210).  Saving model ...
Epoch: 17 cost time: 1.0096800327301025
Epoch: 17, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.600 Vali Acc: 0.916 Test Loss: 0.600 Test Acc: 0.916
Validation loss decreased (-0.916210 --> -0.916210).  Saving model ...
Epoch: 18 cost time: 1.0518078804016113
Epoch: 18, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.552 Vali Acc: 0.922 Test Loss: 0.552 Test Acc: 0.922
Validation loss decreased (-0.916210 --> -0.921616).  Saving model ...
Epoch: 19 cost time: 1.0948991775512695
Epoch: 19, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.510 Vali Acc: 0.919 Test Loss: 0.510 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0200436115264893
Epoch: 20, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.471 Vali Acc: 0.927 Test Loss: 0.471 Test Acc: 0.927
Validation loss decreased (-0.921616 --> -0.927022).  Saving model ...
Epoch: 21 cost time: 0.9390342235565186
Epoch: 21, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.443 Vali Acc: 0.935 Test Loss: 0.443 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935131).  Saving model ...
Epoch: 22 cost time: 0.9876840114593506
Epoch: 22, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.421 Vali Acc: 0.930 Test Loss: 0.421 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9318532943725586
Epoch: 23, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.398 Vali Acc: 0.935 Test Loss: 0.398 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 24 cost time: 0.8000209331512451
Epoch: 24, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.374 Vali Acc: 0.935 Test Loss: 0.374 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 25 cost time: 1.0294535160064697
Epoch: 25, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.369 Vali Acc: 0.938 Test Loss: 0.369 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 26 cost time: 0.9275603294372559
Epoch: 26, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.339 Vali Acc: 0.938 Test Loss: 0.339 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 27 cost time: 0.8470571041107178
Epoch: 27, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0284621715545654
Epoch: 28, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.317 Vali Acc: 0.943 Test Loss: 0.317 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 29 cost time: 0.9529159069061279
Epoch: 29, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.302 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.942669153213501
Epoch: 30, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.891148567199707
Epoch: 31, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.291 Vali Acc: 0.935 Test Loss: 0.291 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.893251895904541
Epoch: 32, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943241).  Saving model ...
Epoch: 33 cost time: 0.8862278461456299
Epoch: 33, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.274 Vali Acc: 0.946 Test Loss: 0.274 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945943).  Saving model ...
Epoch: 34 cost time: 0.8504693508148193
Epoch: 34, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.262 Vali Acc: 0.938 Test Loss: 0.262 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.247065782546997
Epoch: 35, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8376455307006836
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 37 cost time: 0.7849576473236084
Epoch: 37, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.946 Test Loss: 0.245 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9026885032653809
Epoch: 38, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0067791938781738
Epoch: 39, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9781725406646729
Epoch: 40, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.234 Vali Acc: 0.943 Test Loss: 0.234 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9120359420776367
Epoch: 41, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9899768829345703
Epoch: 42, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8098750114440918
Epoch: 43, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.785271406173706
Epoch: 44, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7710866928100586
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.88028883934021
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 63911
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2112677097320557
Epoch: 1, Steps: 17 | Train Loss: 2.289 Vali Loss: 2.283 Vali Acc: 0.046 Test Loss: 2.283 Test Acc: 0.046
Validation loss decreased (inf --> -0.045923).  Saving model ...
Epoch: 2 cost time: 1.084590196609497
Epoch: 2, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.187 Vali Acc: 0.111 Test Loss: 2.187 Test Acc: 0.111
Validation loss decreased (-0.045923 --> -0.110789).  Saving model ...
Epoch: 3 cost time: 1.204371452331543
Epoch: 3, Steps: 17 | Train Loss: 2.102 Vali Loss: 2.068 Vali Acc: 0.246 Test Loss: 2.068 Test Acc: 0.246
Validation loss decreased (-0.110789 --> -0.245925).  Saving model ...
Epoch: 4 cost time: 1.1192219257354736
Epoch: 4, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.939 Vali Acc: 0.470 Test Loss: 1.939 Test Acc: 0.470
Validation loss decreased (-0.245925 --> -0.470251).  Saving model ...
Epoch: 5 cost time: 1.0146594047546387
Epoch: 5, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.815 Vali Acc: 0.635 Test Loss: 1.815 Test Acc: 0.635
Validation loss decreased (-0.470251 --> -0.635117).  Saving model ...
Epoch: 6 cost time: 1.1861846446990967
Epoch: 6, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.699 Vali Acc: 0.711 Test Loss: 1.699 Test Acc: 0.711
Validation loss decreased (-0.635117 --> -0.710794).  Saving model ...
Epoch: 7 cost time: 1.0524587631225586
Epoch: 7, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.571 Vali Acc: 0.770 Test Loss: 1.571 Test Acc: 0.770
Validation loss decreased (-0.710794 --> -0.770255).  Saving model ...
Epoch: 8 cost time: 1.0182774066925049
Epoch: 8, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.451 Vali Acc: 0.795 Test Loss: 1.451 Test Acc: 0.795
Validation loss decreased (-0.770255 --> -0.794580).  Saving model ...
Epoch: 9 cost time: 0.9800014495849609
Epoch: 9, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.333 Vali Acc: 0.808 Test Loss: 1.333 Test Acc: 0.808
Validation loss decreased (-0.794580 --> -0.808095).  Saving model ...
Epoch: 10 cost time: 1.097029209136963
Epoch: 10, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.229 Vali Acc: 0.805 Test Loss: 1.229 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.915412187576294
Epoch: 11, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.119 Vali Acc: 0.822 Test Loss: 1.119 Test Acc: 0.822
Validation loss decreased (-0.808095 --> -0.821610).  Saving model ...
Epoch: 12 cost time: 1.0501558780670166
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.027 Vali Acc: 0.835 Test Loss: 1.027 Test Acc: 0.835
Validation loss decreased (-0.821610 --> -0.835125).  Saving model ...
Epoch: 13 cost time: 1.0629684925079346
Epoch: 13, Steps: 17 | Train Loss: 0.851 Vali Loss: 0.941 Vali Acc: 0.851 Test Loss: 0.941 Test Acc: 0.851
Validation loss decreased (-0.835125 --> -0.851342).  Saving model ...
Epoch: 14 cost time: 1.0168547630310059
Epoch: 14, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.862 Vali Acc: 0.854 Test Loss: 0.862 Test Acc: 0.854
Validation loss decreased (-0.851342 --> -0.854045).  Saving model ...
Epoch: 15 cost time: 1.061227560043335
Epoch: 15, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.791 Vali Acc: 0.870 Test Loss: 0.791 Test Acc: 0.870
Validation loss decreased (-0.854045 --> -0.870262).  Saving model ...
Epoch: 16 cost time: 1.0986011028289795
Epoch: 16, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.730 Vali Acc: 0.865 Test Loss: 0.730 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0285236835479736
Epoch: 17, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.679 Vali Acc: 0.892 Test Loss: 0.679 Test Acc: 0.892
Validation loss decreased (-0.870262 --> -0.891885).  Saving model ...
Epoch: 18 cost time: 1.0419976711273193
Epoch: 18, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.638 Vali Acc: 0.876 Test Loss: 0.638 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0376381874084473
Epoch: 19, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.579 Vali Acc: 0.892 Test Loss: 0.579 Test Acc: 0.892
Validation loss decreased (-0.891885 --> -0.891886).  Saving model ...
Epoch: 20 cost time: 0.895012378692627
Epoch: 20, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.548 Vali Acc: 0.897 Test Loss: 0.548 Test Acc: 0.897
Validation loss decreased (-0.891886 --> -0.897292).  Saving model ...
Epoch: 21 cost time: 1.0827701091766357
Epoch: 21, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.509 Vali Acc: 0.897 Test Loss: 0.509 Test Acc: 0.897
Validation loss decreased (-0.897292 --> -0.897292).  Saving model ...
Epoch: 22 cost time: 1.2257957458496094
Epoch: 22, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.897292 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.187009334564209
Epoch: 23, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.444 Vali Acc: 0.914 Test Loss: 0.444 Test Acc: 0.914
Validation loss decreased (-0.899995 --> -0.913509).  Saving model ...
Epoch: 24 cost time: 1.0831913948059082
Epoch: 24, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.446 Vali Acc: 0.903 Test Loss: 0.446 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9233965873718262
Epoch: 25, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 26 cost time: 1.1080021858215332
Epoch: 26, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.389 Vali Acc: 0.916 Test Loss: 0.389 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3295564651489258
Epoch: 27, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.371 Vali Acc: 0.914 Test Loss: 0.371 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4164793491363525
Epoch: 28, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.350 Vali Acc: 0.914 Test Loss: 0.350 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3257651329040527
Epoch: 29, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.339 Vali Acc: 0.927 Test Loss: 0.339 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927024).  Saving model ...
Epoch: 30 cost time: 1.3153584003448486
Epoch: 30, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.327 Vali Acc: 0.919 Test Loss: 0.327 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4016804695129395
Epoch: 31, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.317 Vali Acc: 0.924 Test Loss: 0.317 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1660709381103516
Epoch: 32, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.315 Vali Acc: 0.914 Test Loss: 0.315 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9813740253448486
Epoch: 33, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.297 Vali Acc: 0.932 Test Loss: 0.297 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932429).  Saving model ...
Epoch: 34 cost time: 1.315166711807251
Epoch: 34, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2347078323364258
Epoch: 35, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2484140396118164
Epoch: 36, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.277 Vali Acc: 0.932 Test Loss: 0.277 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 37 cost time: 1.2659821510314941
Epoch: 37, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.268 Vali Acc: 0.924 Test Loss: 0.268 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9549951553344727
Epoch: 38, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.265 Vali Acc: 0.927 Test Loss: 0.265 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1520276069641113
Epoch: 39, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0426359176635742
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1191554069519043
Epoch: 41, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0423083305358887
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.249 Vali Acc: 0.927 Test Loss: 0.249 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0755081176757812
Epoch: 43, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.924 Test Loss: 0.245 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.148719310760498
Epoch: 44, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3118278980255127
Epoch: 45, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.255 Vali Acc: 0.927 Test Loss: 0.255 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2272706031799316
Epoch: 46, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.932 Test Loss: 0.229 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 47 cost time: 1.1678690910339355
Epoch: 47, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.240 Vali Acc: 0.924 Test Loss: 0.240 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2457866668701172
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 49 cost time: 1.1129491329193115
Epoch: 49, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.927 Test Loss: 0.231 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.170823335647583
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.932 Test Loss: 0.229 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9063291549682617
Epoch: 51, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.927 Test Loss: 0.222 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.004530668258667
Epoch: 52, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.927 Test Loss: 0.227 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.486372470855713
Epoch: 53, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.932 Test Loss: 0.219 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0268611907958984
Epoch: 54, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.981724739074707
Epoch: 55, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.0710082054138184
Epoch: 56, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.141190767288208
Epoch: 57, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.1332471370697021
Epoch: 58, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.924 Test Loss: 0.211 Test Acc: 0.924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 66883
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3937788009643555
Epoch: 1, Steps: 17 | Train Loss: 2.352 Vali Loss: 2.333 Vali Acc: 0.070 Test Loss: 2.333 Test Acc: 0.070
Validation loss decreased (inf --> -0.070247).  Saving model ...
Epoch: 2 cost time: 1.3597707748413086
Epoch: 2, Steps: 17 | Train Loss: 2.282 Vali Loss: 2.248 Vali Acc: 0.119 Test Loss: 2.248 Test Acc: 0.119
Validation loss decreased (-0.070247 --> -0.118896).  Saving model ...
Epoch: 3 cost time: 1.2818217277526855
Epoch: 3, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.138 Vali Acc: 0.186 Test Loss: 2.138 Test Acc: 0.186
Validation loss decreased (-0.118896 --> -0.186465).  Saving model ...
Epoch: 4 cost time: 1.2361414432525635
Epoch: 4, Steps: 17 | Train Loss: 2.038 Vali Loss: 2.021 Vali Acc: 0.300 Test Loss: 2.021 Test Acc: 0.300
Validation loss decreased (-0.186465 --> -0.299980).  Saving model ...
Epoch: 5 cost time: 1.4260401725769043
Epoch: 5, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.899 Vali Acc: 0.438 Test Loss: 1.899 Test Acc: 0.438
Validation loss decreased (-0.299980 --> -0.437819).  Saving model ...
Epoch: 6 cost time: 1.1240363121032715
Epoch: 6, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.777 Vali Acc: 0.576 Test Loss: 1.777 Test Acc: 0.576
Validation loss decreased (-0.437819 --> -0.575658).  Saving model ...
Epoch: 7 cost time: 1.242079257965088
Epoch: 7, Steps: 17 | Train Loss: 1.652 Vali Loss: 1.651 Vali Acc: 0.673 Test Loss: 1.651 Test Acc: 0.673
Validation loss decreased (-0.575658 --> -0.672956).  Saving model ...
Epoch: 8 cost time: 0.9981160163879395
Epoch: 8, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.523 Vali Acc: 0.789 Test Loss: 1.523 Test Acc: 0.789
Validation loss decreased (-0.672956 --> -0.789174).  Saving model ...
Epoch: 9 cost time: 1.3974828720092773
Epoch: 9, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.392 Vali Acc: 0.832 Test Loss: 1.392 Test Acc: 0.832
Validation loss decreased (-0.789174 --> -0.832419).  Saving model ...
Epoch: 10 cost time: 1.1766016483306885
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.256 Vali Acc: 0.846 Test Loss: 1.256 Test Acc: 0.846
Validation loss decreased (-0.832419 --> -0.845933).  Saving model ...
Epoch: 11 cost time: 1.1682419776916504
Epoch: 11, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.138 Vali Acc: 0.862 Test Loss: 1.138 Test Acc: 0.862
Validation loss decreased (-0.845933 --> -0.862151).  Saving model ...
Epoch: 12 cost time: 1.208082675933838
Epoch: 12, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.015 Vali Acc: 0.870 Test Loss: 1.015 Test Acc: 0.870
Validation loss decreased (-0.862151 --> -0.870260).  Saving model ...
Epoch: 13 cost time: 1.3126442432403564
Epoch: 13, Steps: 17 | Train Loss: 0.853 Vali Loss: 0.913 Vali Acc: 0.886 Test Loss: 0.913 Test Acc: 0.886
Validation loss decreased (-0.870260 --> -0.886477).  Saving model ...
Epoch: 14 cost time: 1.1396269798278809
Epoch: 14, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.832 Vali Acc: 0.886 Test Loss: 0.832 Test Acc: 0.886
Validation loss decreased (-0.886477 --> -0.886478).  Saving model ...
Epoch: 15 cost time: 1.4403514862060547
Epoch: 15, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.749 Vali Acc: 0.897 Test Loss: 0.749 Test Acc: 0.897
Validation loss decreased (-0.886478 --> -0.897290).  Saving model ...
Epoch: 16 cost time: 1.692147970199585
Epoch: 16, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.677 Vali Acc: 0.903 Test Loss: 0.677 Test Acc: 0.903
Validation loss decreased (-0.897290 --> -0.902696).  Saving model ...
Epoch: 17 cost time: 1.3691344261169434
Epoch: 17, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.620 Vali Acc: 0.900 Test Loss: 0.620 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5049395561218262
Epoch: 18, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.576 Vali Acc: 0.903 Test Loss: 0.576 Test Acc: 0.903
Validation loss decreased (-0.902696 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 1.1890878677368164
Epoch: 19, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.525 Vali Acc: 0.919 Test Loss: 0.525 Test Acc: 0.919
Validation loss decreased (-0.902697 --> -0.918914).  Saving model ...
Epoch: 20 cost time: 1.5251879692077637
Epoch: 20, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.520 Vali Acc: 0.905 Test Loss: 0.520 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1077311038970947
Epoch: 21, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.469 Vali Acc: 0.922 Test Loss: 0.469 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 22 cost time: 1.5096008777618408
Epoch: 22, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.434 Vali Acc: 0.924 Test Loss: 0.434 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 23 cost time: 1.2693512439727783
Epoch: 23, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.403 Vali Acc: 0.922 Test Loss: 0.403 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5363976955413818
Epoch: 24, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.385 Vali Acc: 0.932 Test Loss: 0.385 Test Acc: 0.932
Validation loss decreased (-0.924320 --> -0.932429).  Saving model ...
Epoch: 25 cost time: 1.2833092212677002
Epoch: 25, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.360 Vali Acc: 0.932 Test Loss: 0.360 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 26 cost time: 1.0955891609191895
Epoch: 26, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1764612197875977
Epoch: 27, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.347 Vali Acc: 0.927 Test Loss: 0.347 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1312518119812012
Epoch: 28, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.322 Vali Acc: 0.932 Test Loss: 0.322 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 29 cost time: 1.3376717567443848
Epoch: 29, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1636300086975098
Epoch: 30, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.164992332458496
Epoch: 31, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1740005016326904
Epoch: 32, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.293 Vali Acc: 0.932 Test Loss: 0.293 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 33 cost time: 1.0929560661315918
Epoch: 33, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.935 Test Loss: 0.296 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935132).  Saving model ...
Epoch: 34 cost time: 1.247926950454712
Epoch: 34, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3180022239685059
Epoch: 35, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.296 Vali Acc: 0.927 Test Loss: 0.296 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2576625347137451
Epoch: 36, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.288 Vali Acc: 0.924 Test Loss: 0.288 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.477532148361206
Epoch: 37, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1238102912902832
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4931342601776123
Epoch: 39, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.932 Test Loss: 0.259 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.238898754119873
Epoch: 40, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 41 cost time: 1.116771936416626
Epoch: 41, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 42 cost time: 1.1997385025024414
Epoch: 42, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1889982223510742
Epoch: 43, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4748883247375488
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.932 Test Loss: 0.255 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2278904914855957
Epoch: 45, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.186485767364502
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.3689086437225342
Epoch: 47, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.262 Vali Acc: 0.927 Test Loss: 0.262 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1405494213104248
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.254 Vali Acc: 0.932 Test Loss: 0.254 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.339066743850708
Epoch: 49, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.257 Vali Acc: 0.935 Test Loss: 0.257 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.03354811668396
Epoch: 50, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2485506534576416
Epoch: 51, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 65859
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0618720054626465
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.155 Vali Acc: 0.143 Test Loss: 2.155 Test Acc: 0.143
Validation loss decreased (inf --> -0.143222).  Saving model ...
Epoch: 2 cost time: 0.9776241779327393
Epoch: 2, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.085 Vali Acc: 0.238 Test Loss: 2.085 Test Acc: 0.238
Validation loss decreased (-0.143222 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 0.9330775737762451
Epoch: 3, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.996 Vali Acc: 0.389 Test Loss: 1.996 Test Acc: 0.389
Validation loss decreased (-0.237817 --> -0.389169).  Saving model ...
Epoch: 4 cost time: 0.9579315185546875
Epoch: 4, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.903 Vali Acc: 0.516 Test Loss: 1.903 Test Acc: 0.516
Validation loss decreased (-0.389169 --> -0.516197).  Saving model ...
Epoch: 5 cost time: 1.1401472091674805
Epoch: 5, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.803 Vali Acc: 0.549 Test Loss: 1.803 Test Acc: 0.549
Validation loss decreased (-0.516197 --> -0.548631).  Saving model ...
Epoch: 6 cost time: 0.9578559398651123
Epoch: 6, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.691 Vali Acc: 0.657 Test Loss: 1.691 Test Acc: 0.657
Validation loss decreased (-0.548631 --> -0.656740).  Saving model ...
Epoch: 7 cost time: 1.2045314311981201
Epoch: 7, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.582 Vali Acc: 0.703 Test Loss: 1.582 Test Acc: 0.703
Validation loss decreased (-0.656740 --> -0.702687).  Saving model ...
Epoch: 8 cost time: 1.1017446517944336
Epoch: 8, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.466 Vali Acc: 0.743 Test Loss: 1.466 Test Acc: 0.743
Validation loss decreased (-0.702687 --> -0.743229).  Saving model ...
Epoch: 9 cost time: 0.952423095703125
Epoch: 9, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.358 Vali Acc: 0.778 Test Loss: 1.358 Test Acc: 0.778
Validation loss decreased (-0.743229 --> -0.778365).  Saving model ...
Epoch: 10 cost time: 1.1959500312805176
Epoch: 10, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.241 Vali Acc: 0.805 Test Loss: 1.241 Test Acc: 0.805
Validation loss decreased (-0.778365 --> -0.805393).  Saving model ...
Epoch: 11 cost time: 1.0234026908874512
Epoch: 11, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.143 Vali Acc: 0.808 Test Loss: 1.143 Test Acc: 0.808
Validation loss decreased (-0.805393 --> -0.808097).  Saving model ...
Epoch: 12 cost time: 1.247068166732788
Epoch: 12, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.049 Vali Acc: 0.827 Test Loss: 1.049 Test Acc: 0.827
Validation loss decreased (-0.808097 --> -0.827017).  Saving model ...
Epoch: 13 cost time: 1.0915617942810059
Epoch: 13, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.960 Vali Acc: 0.835 Test Loss: 0.960 Test Acc: 0.835
Validation loss decreased (-0.827017 --> -0.835126).  Saving model ...
Epoch: 14 cost time: 0.9756107330322266
Epoch: 14, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.883 Vali Acc: 0.838 Test Loss: 0.883 Test Acc: 0.838
Validation loss decreased (-0.835126 --> -0.837829).  Saving model ...
Epoch: 15 cost time: 1.1756188869476318
Epoch: 15, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.813 Vali Acc: 0.851 Test Loss: 0.813 Test Acc: 0.851
Validation loss decreased (-0.837829 --> -0.851343).  Saving model ...
Epoch: 16 cost time: 1.4146475791931152
Epoch: 16, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.757 Vali Acc: 0.854 Test Loss: 0.757 Test Acc: 0.854
Validation loss decreased (-0.851343 --> -0.854046).  Saving model ...
Epoch: 17 cost time: 1.019526720046997
Epoch: 17, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.700 Vali Acc: 0.870 Test Loss: 0.700 Test Acc: 0.870
Validation loss decreased (-0.854046 --> -0.870263).  Saving model ...
Epoch: 18 cost time: 0.9759461879730225
Epoch: 18, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.663 Vali Acc: 0.878 Test Loss: 0.663 Test Acc: 0.878
Validation loss decreased (-0.870263 --> -0.878372).  Saving model ...
Epoch: 19 cost time: 1.0496671199798584
Epoch: 19, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.617 Vali Acc: 0.878 Test Loss: 0.617 Test Acc: 0.878
Validation loss decreased (-0.878372 --> -0.878372).  Saving model ...
Epoch: 20 cost time: 1.0844545364379883
Epoch: 20, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.584 Vali Acc: 0.878 Test Loss: 0.584 Test Acc: 0.878
Validation loss decreased (-0.878372 --> -0.878373).  Saving model ...
Epoch: 21 cost time: 1.261291742324829
Epoch: 21, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.555 Vali Acc: 0.886 Test Loss: 0.555 Test Acc: 0.886
Validation loss decreased (-0.878373 --> -0.886481).  Saving model ...
Epoch: 22 cost time: 1.4883055686950684
Epoch: 22, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.886481 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.134331226348877
Epoch: 23, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.494 Vali Acc: 0.903 Test Loss: 0.494 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902698).  Saving model ...
Epoch: 24 cost time: 0.9180624485015869
Epoch: 24, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.465 Vali Acc: 0.914 Test Loss: 0.465 Test Acc: 0.914
Validation loss decreased (-0.902698 --> -0.913509).  Saving model ...
Epoch: 25 cost time: 1.0232653617858887
Epoch: 25, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.444 Vali Acc: 0.908 Test Loss: 0.444 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0769920349121094
Epoch: 26, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.423 Vali Acc: 0.927 Test Loss: 0.423 Test Acc: 0.927
Validation loss decreased (-0.913509 --> -0.927023).  Saving model ...
Epoch: 27 cost time: 1.316239833831787
Epoch: 27, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.408 Vali Acc: 0.919 Test Loss: 0.408 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2236173152923584
Epoch: 28, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.392 Vali Acc: 0.916 Test Loss: 0.392 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4914166927337646
Epoch: 29, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.378 Vali Acc: 0.924 Test Loss: 0.378 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1450915336608887
Epoch: 30, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.365 Vali Acc: 0.941 Test Loss: 0.365 Test Acc: 0.941
Validation loss decreased (-0.927023 --> -0.940537).  Saving model ...
Epoch: 31 cost time: 1.0805103778839111
Epoch: 31, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 32 cost time: 1.1666686534881592
Epoch: 32, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.337 Vali Acc: 0.927 Test Loss: 0.337 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.646064281463623
Epoch: 33, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.339 Vali Acc: 0.930 Test Loss: 0.339 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1140146255493164
Epoch: 34, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.318 Vali Acc: 0.927 Test Loss: 0.318 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2595419883728027
Epoch: 35, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.307 Vali Acc: 0.938 Test Loss: 0.307 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1757068634033203
Epoch: 36, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9567580223083496
Epoch: 37, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.299 Vali Acc: 0.932 Test Loss: 0.299 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1174066066741943
Epoch: 38, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1776373386383057
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.284 Vali Acc: 0.924 Test Loss: 0.284 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.259932041168213
Epoch: 40, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.278 Vali Acc: 0.924 Test Loss: 0.278 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.2821323871612549
Epoch: 41, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.273 Vali Acc: 0.927 Test Loss: 0.273 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 64835
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.820566177368164
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.144 Vali Acc: 0.205 Test Loss: 2.144 Test Acc: 0.205
Validation loss decreased (inf --> -0.205384).  Saving model ...
Epoch: 2 cost time: 1.2440886497497559
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.056 Vali Acc: 0.278 Test Loss: 2.056 Test Acc: 0.278
Validation loss decreased (-0.205384 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 1.050713062286377
Epoch: 3, Steps: 17 | Train Loss: 2.058 Vali Loss: 1.946 Vali Acc: 0.522 Test Loss: 1.946 Test Acc: 0.522
Validation loss decreased (-0.278358 --> -0.521602).  Saving model ...
Epoch: 4 cost time: 1.2302577495574951
Epoch: 4, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.831 Vali Acc: 0.630 Test Loss: 1.831 Test Acc: 0.630
Validation loss decreased (-0.521602 --> -0.629711).  Saving model ...
Epoch: 5 cost time: 1.0397307872772217
Epoch: 5, Steps: 17 | Train Loss: 1.785 Vali Loss: 1.716 Vali Acc: 0.727 Test Loss: 1.716 Test Acc: 0.727
Validation loss decreased (-0.629711 --> -0.727010).  Saving model ...
Epoch: 6 cost time: 0.996086597442627
Epoch: 6, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.598 Vali Acc: 0.765 Test Loss: 1.598 Test Acc: 0.765
Validation loss decreased (-0.727010 --> -0.764849).  Saving model ...
Epoch: 7 cost time: 1.1253740787506104
Epoch: 7, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.476 Vali Acc: 0.795 Test Loss: 1.476 Test Acc: 0.795
Validation loss decreased (-0.764849 --> -0.794580).  Saving model ...
Epoch: 8 cost time: 1.0251562595367432
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.356 Vali Acc: 0.841 Test Loss: 1.356 Test Acc: 0.841
Validation loss decreased (-0.794580 --> -0.840527).  Saving model ...
Epoch: 9 cost time: 1.077317237854004
Epoch: 9, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.242 Vali Acc: 0.849 Test Loss: 1.242 Test Acc: 0.849
Validation loss decreased (-0.840527 --> -0.848636).  Saving model ...
Epoch: 10 cost time: 1.1748335361480713
Epoch: 10, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.144 Vali Acc: 0.843 Test Loss: 1.144 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.06488037109375
Epoch: 11, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.035 Vali Acc: 0.859 Test Loss: 1.035 Test Acc: 0.859
Validation loss decreased (-0.848636 --> -0.859449).  Saving model ...
Epoch: 12 cost time: 0.9652681350708008
Epoch: 12, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.945 Vali Acc: 0.881 Test Loss: 0.945 Test Acc: 0.881
Validation loss decreased (-0.859449 --> -0.881072).  Saving model ...
Epoch: 13 cost time: 1.4063138961791992
Epoch: 13, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.862 Vali Acc: 0.884 Test Loss: 0.862 Test Acc: 0.884
Validation loss decreased (-0.881072 --> -0.883775).  Saving model ...
Epoch: 14 cost time: 1.068711280822754
Epoch: 14, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.789 Vali Acc: 0.903 Test Loss: 0.789 Test Acc: 0.903
Validation loss decreased (-0.883775 --> -0.902695).  Saving model ...
Epoch: 15 cost time: 0.8732483386993408
Epoch: 15, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.728 Vali Acc: 0.903 Test Loss: 0.728 Test Acc: 0.903
Validation loss decreased (-0.902695 --> -0.902695).  Saving model ...
Epoch: 16 cost time: 1.0469775199890137
Epoch: 16, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.668 Vali Acc: 0.908 Test Loss: 0.668 Test Acc: 0.908
Validation loss decreased (-0.902695 --> -0.908101).  Saving model ...
Epoch: 17 cost time: 1.0877470970153809
Epoch: 17, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.613 Vali Acc: 0.911 Test Loss: 0.613 Test Acc: 0.911
Validation loss decreased (-0.908101 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.1153054237365723
Epoch: 18, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.580 Vali Acc: 0.919 Test Loss: 0.580 Test Acc: 0.919
Validation loss decreased (-0.910805 --> -0.918913).  Saving model ...
Epoch: 19 cost time: 1.008378028869629
Epoch: 19, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.527 Vali Acc: 0.927 Test Loss: 0.527 Test Acc: 0.927
Validation loss decreased (-0.918913 --> -0.927022).  Saving model ...
Epoch: 20 cost time: 0.9938557147979736
Epoch: 20, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.507 Vali Acc: 0.914 Test Loss: 0.507 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3269710540771484
Epoch: 21, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.469 Vali Acc: 0.932 Test Loss: 0.469 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 22 cost time: 1.0354382991790771
Epoch: 22, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1903471946716309
Epoch: 23, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.415 Vali Acc: 0.927 Test Loss: 0.415 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0124356746673584
Epoch: 24, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.398 Vali Acc: 0.930 Test Loss: 0.398 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2936937808990479
Epoch: 25, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 26 cost time: 1.1244988441467285
Epoch: 26, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 27 cost time: 1.205749273300171
Epoch: 27, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.333 Vali Acc: 0.932 Test Loss: 0.333 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0839595794677734
Epoch: 28, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.321 Vali Acc: 0.938 Test Loss: 0.321 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.036473274230957
Epoch: 29, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.314 Vali Acc: 0.932 Test Loss: 0.314 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.054941177368164
Epoch: 30, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.306 Vali Acc: 0.938 Test Loss: 0.306 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0901265144348145
Epoch: 31, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9603474140167236
Epoch: 32, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.272714376449585
Epoch: 33, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9250271320343018
Epoch: 34, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 35 cost time: 0.9712295532226562
Epoch: 35, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 36 cost time: 0.956648588180542
Epoch: 36, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.258 Vali Acc: 0.938 Test Loss: 0.258 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0356175899505615
Epoch: 37, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8280971050262451
Epoch: 38, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.164205551147461
Epoch: 39, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 40 cost time: 1.0797407627105713
Epoch: 40, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9144165515899658
Epoch: 41, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2823882102966309
Epoch: 42, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0725526809692383
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1114330291748047
Epoch: 44, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 45 cost time: 0.9029083251953125
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9146883487701416
Epoch: 46, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0547451972961426
Epoch: 47, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3981680870056152
Epoch: 48, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.018824577331543
Epoch: 49, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 50 cost time: 1.1658828258514404
Epoch: 50, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.183807611465454
Epoch: 51, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9281454086303711
Epoch: 52, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 53 cost time: 1.2465004920959473
Epoch: 53, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0694186687469482
Epoch: 54, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.13604736328125
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.0145046710968018
Epoch: 56, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.040752649307251
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2073025703430176
Epoch: 58, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.39858078956604
Epoch: 59, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 60 cost time: 1.1585493087768555
Epoch: 60, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1217362880706787
Epoch: 61, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2244343757629395
Epoch: 62, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1241843700408936
Epoch: 63, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9735159873962402
Epoch: 64, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1422600746154785
Epoch: 65, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.1511473655700684
Epoch: 66, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 67 cost time: 1.0992822647094727
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0638129711151123
Epoch: 68, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.1918208599090576
Epoch: 69, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.1047205924987793
Epoch: 70, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.109931468963623
Epoch: 71, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.2353010177612305
Epoch: 72, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.0409512519836426
Epoch: 73, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 74 cost time: 0.8747425079345703
Epoch: 74, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.134211778640747
Epoch: 75, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.0933704376220703
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.031355619430542
Epoch: 77, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 78 cost time: 0.999643087387085
Epoch: 78, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.12001371383667
Epoch: 79, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.1679635047912598
Epoch: 80, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.9608049392700195
Epoch: 81, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.1536061763763428
Epoch: 82, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.0472192764282227
Epoch: 83, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.9349360466003418
Epoch: 84, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.091766119003296
Epoch: 85, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 1.0840380191802979
Epoch: 86, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 1.080916166305542
Epoch: 87, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 63811
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.000270366668701
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.144 Vali Acc: 0.205 Test Loss: 2.144 Test Acc: 0.205
Validation loss decreased (inf --> -0.205384).  Saving model ...
Epoch: 2 cost time: 0.7964308261871338
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.056 Vali Acc: 0.278 Test Loss: 2.056 Test Acc: 0.278
Validation loss decreased (-0.205384 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 1.1075413227081299
Epoch: 3, Steps: 17 | Train Loss: 2.058 Vali Loss: 1.946 Vali Acc: 0.522 Test Loss: 1.946 Test Acc: 0.522
Validation loss decreased (-0.278358 --> -0.521602).  Saving model ...
Epoch: 4 cost time: 1.0800230503082275
Epoch: 4, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.831 Vali Acc: 0.630 Test Loss: 1.831 Test Acc: 0.630
Validation loss decreased (-0.521602 --> -0.629711).  Saving model ...
Epoch: 5 cost time: 1.048553705215454
Epoch: 5, Steps: 17 | Train Loss: 1.785 Vali Loss: 1.716 Vali Acc: 0.727 Test Loss: 1.716 Test Acc: 0.727
Validation loss decreased (-0.629711 --> -0.727010).  Saving model ...
Epoch: 6 cost time: 1.1636693477630615
Epoch: 6, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.598 Vali Acc: 0.765 Test Loss: 1.598 Test Acc: 0.765
Validation loss decreased (-0.727010 --> -0.764849).  Saving model ...
Epoch: 7 cost time: 1.1930007934570312
Epoch: 7, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.476 Vali Acc: 0.795 Test Loss: 1.476 Test Acc: 0.795
Validation loss decreased (-0.764849 --> -0.794580).  Saving model ...
Epoch: 8 cost time: 1.1642813682556152
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.356 Vali Acc: 0.841 Test Loss: 1.356 Test Acc: 0.841
Validation loss decreased (-0.794580 --> -0.840527).  Saving model ...
Epoch: 9 cost time: 1.140653133392334
Epoch: 9, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.242 Vali Acc: 0.849 Test Loss: 1.242 Test Acc: 0.849
Validation loss decreased (-0.840527 --> -0.848636).  Saving model ...
Epoch: 10 cost time: 0.8535988330841064
Epoch: 10, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.144 Vali Acc: 0.843 Test Loss: 1.144 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7424893379211426
Epoch: 11, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.035 Vali Acc: 0.859 Test Loss: 1.035 Test Acc: 0.859
Validation loss decreased (-0.848636 --> -0.859449).  Saving model ...
Epoch: 12 cost time: 0.8444099426269531
Epoch: 12, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.945 Vali Acc: 0.881 Test Loss: 0.945 Test Acc: 0.881
Validation loss decreased (-0.859449 --> -0.881072).  Saving model ...
Epoch: 13 cost time: 0.850212574005127
Epoch: 13, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.862 Vali Acc: 0.884 Test Loss: 0.862 Test Acc: 0.884
Validation loss decreased (-0.881072 --> -0.883775).  Saving model ...
Epoch: 14 cost time: 1.2960002422332764
Epoch: 14, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.789 Vali Acc: 0.903 Test Loss: 0.789 Test Acc: 0.903
Validation loss decreased (-0.883775 --> -0.902695).  Saving model ...
Epoch: 15 cost time: 0.8804407119750977
Epoch: 15, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.728 Vali Acc: 0.903 Test Loss: 0.728 Test Acc: 0.903
Validation loss decreased (-0.902695 --> -0.902695).  Saving model ...
Epoch: 16 cost time: 0.7995955944061279
Epoch: 16, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.668 Vali Acc: 0.908 Test Loss: 0.668 Test Acc: 0.908
Validation loss decreased (-0.902695 --> -0.908101).  Saving model ...
Epoch: 17 cost time: 0.8216607570648193
Epoch: 17, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.613 Vali Acc: 0.911 Test Loss: 0.613 Test Acc: 0.911
Validation loss decreased (-0.908101 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.002288818359375
Epoch: 18, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.580 Vali Acc: 0.919 Test Loss: 0.580 Test Acc: 0.919
Validation loss decreased (-0.910805 --> -0.918913).  Saving model ...
Epoch: 19 cost time: 0.9799051284790039
Epoch: 19, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.527 Vali Acc: 0.927 Test Loss: 0.527 Test Acc: 0.927
Validation loss decreased (-0.918913 --> -0.927022).  Saving model ...
Epoch: 20 cost time: 0.8639261722564697
Epoch: 20, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.507 Vali Acc: 0.914 Test Loss: 0.507 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9983081817626953
Epoch: 21, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.469 Vali Acc: 0.932 Test Loss: 0.469 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 22 cost time: 0.9154984951019287
Epoch: 22, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8314619064331055
Epoch: 23, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.415 Vali Acc: 0.927 Test Loss: 0.415 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.852374792098999
Epoch: 24, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.398 Vali Acc: 0.930 Test Loss: 0.398 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.119328260421753
Epoch: 25, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 26 cost time: 0.8604238033294678
Epoch: 26, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 27 cost time: 1.2086470127105713
Epoch: 27, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.333 Vali Acc: 0.932 Test Loss: 0.333 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0951731204986572
Epoch: 28, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.321 Vali Acc: 0.938 Test Loss: 0.321 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9885625839233398
Epoch: 29, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.314 Vali Acc: 0.932 Test Loss: 0.314 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8365757465362549
Epoch: 30, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.306 Vali Acc: 0.938 Test Loss: 0.306 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8403334617614746
Epoch: 31, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7683157920837402
Epoch: 32, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7551512718200684
Epoch: 33, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8151395320892334
Epoch: 34, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 35 cost time: 0.7946627140045166
Epoch: 35, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 36 cost time: 0.9290614128112793
Epoch: 36, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.258 Vali Acc: 0.938 Test Loss: 0.258 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8358492851257324
Epoch: 37, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8548374176025391
Epoch: 38, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9300906658172607
Epoch: 39, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 40 cost time: 0.848334789276123
Epoch: 40, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7188255786895752
Epoch: 41, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.826298713684082
Epoch: 42, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8139064311981201
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8629014492034912
Epoch: 44, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 45 cost time: 0.8020634651184082
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.886512041091919
Epoch: 46, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9298439025878906
Epoch: 47, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8992347717285156
Epoch: 48, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.907496452331543
Epoch: 49, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 50 cost time: 0.9108076095581055
Epoch: 50, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7650318145751953
Epoch: 51, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9822559356689453
Epoch: 52, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 53 cost time: 0.893181562423706
Epoch: 53, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8659870624542236
Epoch: 54, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9473361968994141
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9888269901275635
Epoch: 56, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8946089744567871
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.1356136798858643
Epoch: 58, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9655184745788574
Epoch: 59, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 60 cost time: 0.9201211929321289
Epoch: 60, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1237585544586182
Epoch: 61, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0445277690887451
Epoch: 62, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8847086429595947
Epoch: 63, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9083068370819092
Epoch: 64, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.8405849933624268
Epoch: 65, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8851363658905029
Epoch: 66, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 67 cost time: 0.9585046768188477
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1185908317565918
Epoch: 68, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8905293941497803
Epoch: 69, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9387593269348145
Epoch: 70, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9207351207733154
Epoch: 71, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.2402641773223877
Epoch: 72, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.0590107440948486
Epoch: 73, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 74 cost time: 1.075434684753418
Epoch: 74, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1033191680908203
Epoch: 75, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9323019981384277
Epoch: 76, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.8926424980163574
Epoch: 77, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 78 cost time: 0.9246602058410645
Epoch: 78, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9413065910339355
Epoch: 79, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8007879257202148
Epoch: 80, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.9578747749328613
Epoch: 81, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.9899749755859375
Epoch: 82, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.9277634620666504
Epoch: 83, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.883521318435669
Epoch: 84, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.7735424041748047
Epoch: 85, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.8004271984100342
Epoch: 86, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.9264132976531982
Epoch: 87, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 63811
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.890723466873169
Epoch: 1, Steps: 17 | Train Loss: 2.147 Vali Loss: 2.088 Vali Acc: 0.241 Test Loss: 2.088 Test Acc: 0.241
Validation loss decreased (inf --> -0.240520).  Saving model ...
Epoch: 2 cost time: 0.9555389881134033
Epoch: 2, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.942 Vali Acc: 0.446 Test Loss: 1.942 Test Acc: 0.446
Validation loss decreased (-0.240520 --> -0.445927).  Saving model ...
Epoch: 3 cost time: 0.8747847080230713
Epoch: 3, Steps: 17 | Train Loss: 1.794 Vali Loss: 1.797 Vali Acc: 0.570 Test Loss: 1.797 Test Acc: 0.570
Validation loss decreased (-0.445927 --> -0.570252).  Saving model ...
Epoch: 4 cost time: 1.0059494972229004
Epoch: 4, Steps: 17 | Train Loss: 1.639 Vali Loss: 1.661 Vali Acc: 0.697 Test Loss: 1.661 Test Acc: 0.697
Validation loss decreased (-0.570252 --> -0.697281).  Saving model ...
Epoch: 5 cost time: 1.090315341949463
Epoch: 5, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.545 Vali Acc: 0.741 Test Loss: 1.545 Test Acc: 0.741
Validation loss decreased (-0.697281 --> -0.740525).  Saving model ...
Epoch: 6 cost time: 1.0414528846740723
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.439 Vali Acc: 0.754 Test Loss: 1.439 Test Acc: 0.754
Validation loss decreased (-0.740525 --> -0.754040).  Saving model ...
Epoch: 7 cost time: 1.0090522766113281
Epoch: 7, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.339 Vali Acc: 0.784 Test Loss: 1.339 Test Acc: 0.784
Validation loss decreased (-0.754040 --> -0.783770).  Saving model ...
Epoch: 8 cost time: 1.3204171657562256
Epoch: 8, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.242 Vali Acc: 0.803 Test Loss: 1.242 Test Acc: 0.803
Validation loss decreased (-0.783770 --> -0.802690).  Saving model ...
Epoch: 9 cost time: 1.5381321907043457
Epoch: 9, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.137 Vali Acc: 0.843 Test Loss: 1.137 Test Acc: 0.843
Validation loss decreased (-0.802690 --> -0.843232).  Saving model ...
Epoch: 10 cost time: 1.6371502876281738
Epoch: 10, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.049 Vali Acc: 0.859 Test Loss: 1.049 Test Acc: 0.859
Validation loss decreased (-0.843232 --> -0.859449).  Saving model ...
Epoch: 11 cost time: 1.1734366416931152
Epoch: 11, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.968 Vali Acc: 0.849 Test Loss: 0.968 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1149308681488037
Epoch: 12, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.885 Vali Acc: 0.878 Test Loss: 0.885 Test Acc: 0.878
Validation loss decreased (-0.859449 --> -0.878370).  Saving model ...
Epoch: 13 cost time: 1.2154345512390137
Epoch: 13, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.824 Vali Acc: 0.878 Test Loss: 0.824 Test Acc: 0.878
Validation loss decreased (-0.878370 --> -0.878370).  Saving model ...
Epoch: 14 cost time: 1.5237720012664795
Epoch: 14, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.758 Vali Acc: 0.889 Test Loss: 0.758 Test Acc: 0.889
Validation loss decreased (-0.878370 --> -0.889182).  Saving model ...
Epoch: 15 cost time: 1.1871440410614014
Epoch: 15, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.691 Vali Acc: 0.886 Test Loss: 0.691 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9315249919891357
Epoch: 16, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.652 Vali Acc: 0.895 Test Loss: 0.652 Test Acc: 0.895
Validation loss decreased (-0.889182 --> -0.894588).  Saving model ...
Epoch: 17 cost time: 1.350281000137329
Epoch: 17, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.602 Vali Acc: 0.911 Test Loss: 0.602 Test Acc: 0.911
Validation loss decreased (-0.894588 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.2366342544555664
Epoch: 18, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.563 Vali Acc: 0.908 Test Loss: 0.563 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2441978454589844
Epoch: 19, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.529 Vali Acc: 0.914 Test Loss: 0.529 Test Acc: 0.914
Validation loss decreased (-0.910805 --> -0.913508).  Saving model ...
Epoch: 20 cost time: 1.254944086074829
Epoch: 20, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.497 Vali Acc: 0.924 Test Loss: 0.497 Test Acc: 0.924
Validation loss decreased (-0.913508 --> -0.924319).  Saving model ...
Epoch: 21 cost time: 1.2979528903961182
Epoch: 21, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.476 Vali Acc: 0.916 Test Loss: 0.476 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1352531909942627
Epoch: 22, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.447 Vali Acc: 0.919 Test Loss: 0.447 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2678606510162354
Epoch: 23, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.422 Vali Acc: 0.914 Test Loss: 0.422 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1616132259368896
Epoch: 24, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3253459930419922
Epoch: 25, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.381 Vali Acc: 0.916 Test Loss: 0.381 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.070145606994629
Epoch: 26, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4284796714782715
Epoch: 27, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4287233352661133
Epoch: 28, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5349516868591309
Epoch: 29, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.339 Vali Acc: 0.919 Test Loss: 0.339 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9479172229766846
Epoch: 30, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 66759
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.25990629196167
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.097 Vali Acc: 0.203 Test Loss: 2.097 Test Acc: 0.203
Validation loss decreased (inf --> -0.202682).  Saving model ...
Epoch: 2 cost time: 1.0619139671325684
Epoch: 2, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.942 Vali Acc: 0.443 Test Loss: 1.942 Test Acc: 0.443
Validation loss decreased (-0.202682 --> -0.443224).  Saving model ...
Epoch: 3 cost time: 0.9837677478790283
Epoch: 3, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.804 Vali Acc: 0.605 Test Loss: 1.804 Test Acc: 0.605
Validation loss decreased (-0.443224 --> -0.605387).  Saving model ...
Epoch: 4 cost time: 1.0390777587890625
Epoch: 4, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.686 Vali Acc: 0.700 Test Loss: 1.686 Test Acc: 0.700
Validation loss decreased (-0.605387 --> -0.699983).  Saving model ...
Epoch: 5 cost time: 1.085606575012207
Epoch: 5, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.586 Vali Acc: 0.746 Test Loss: 1.586 Test Acc: 0.746
Validation loss decreased (-0.699983 --> -0.745930).  Saving model ...
Epoch: 6 cost time: 1.200777292251587
Epoch: 6, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.475 Vali Acc: 0.784 Test Loss: 1.475 Test Acc: 0.784
Validation loss decreased (-0.745930 --> -0.783769).  Saving model ...
Epoch: 7 cost time: 1.1590867042541504
Epoch: 7, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.368 Vali Acc: 0.830 Test Loss: 1.368 Test Acc: 0.830
Validation loss decreased (-0.783769 --> -0.829716).  Saving model ...
Epoch: 8 cost time: 1.0497970581054688
Epoch: 8, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.269 Vali Acc: 0.854 Test Loss: 1.269 Test Acc: 0.854
Validation loss decreased (-0.829716 --> -0.854041).  Saving model ...
Epoch: 9 cost time: 1.0288515090942383
Epoch: 9, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.160 Vali Acc: 0.857 Test Loss: 1.160 Test Acc: 0.857
Validation loss decreased (-0.854041 --> -0.856745).  Saving model ...
Epoch: 10 cost time: 0.8908135890960693
Epoch: 10, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.070 Vali Acc: 0.889 Test Loss: 1.070 Test Acc: 0.889
Validation loss decreased (-0.856745 --> -0.889178).  Saving model ...
Epoch: 11 cost time: 0.9978232383728027
Epoch: 11, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.981 Vali Acc: 0.897 Test Loss: 0.981 Test Acc: 0.897
Validation loss decreased (-0.889178 --> -0.897287).  Saving model ...
Epoch: 12 cost time: 0.9409937858581543
Epoch: 12, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.908 Vali Acc: 0.900 Test Loss: 0.908 Test Acc: 0.900
Validation loss decreased (-0.897287 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 1.0090515613555908
Epoch: 13, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.841 Vali Acc: 0.916 Test Loss: 0.841 Test Acc: 0.916
Validation loss decreased (-0.899991 --> -0.916208).  Saving model ...
Epoch: 14 cost time: 1.0927789211273193
Epoch: 14, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.773 Vali Acc: 0.908 Test Loss: 0.773 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.989086389541626
Epoch: 15, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.720 Vali Acc: 0.911 Test Loss: 0.720 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9547040462493896
Epoch: 16, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.677 Vali Acc: 0.914 Test Loss: 0.677 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.141408920288086
Epoch: 17, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.620 Vali Acc: 0.914 Test Loss: 0.620 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3042216300964355
Epoch: 18, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.583 Vali Acc: 0.927 Test Loss: 0.583 Test Acc: 0.927
Validation loss decreased (-0.916208 --> -0.927021).  Saving model ...
Epoch: 19 cost time: 1.1536462306976318
Epoch: 19, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.549 Vali Acc: 0.908 Test Loss: 0.549 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2456228733062744
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.516 Vali Acc: 0.919 Test Loss: 0.516 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2049834728240967
Epoch: 21, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.490 Vali Acc: 0.919 Test Loss: 0.490 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.309293508529663
Epoch: 22, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.464 Vali Acc: 0.916 Test Loss: 0.464 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2032718658447266
Epoch: 23, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.463 Vali Acc: 0.927 Test Loss: 0.463 Test Acc: 0.927
Validation loss decreased (-0.927021 --> -0.927022).  Saving model ...
Epoch: 24 cost time: 1.0925962924957275
Epoch: 24, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.418 Vali Acc: 0.924 Test Loss: 0.418 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1887948513031006
Epoch: 25, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.387 Vali Acc: 0.916 Test Loss: 0.387 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1229455471038818
Epoch: 26, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.387 Vali Acc: 0.914 Test Loss: 0.387 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0929863452911377
Epoch: 27, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.384 Vali Acc: 0.922 Test Loss: 0.384 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.29756498336792
Epoch: 28, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.927022 --> -0.929726).  Saving model ...
Epoch: 29 cost time: 1.0217201709747314
Epoch: 29, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.351 Vali Acc: 0.932 Test Loss: 0.351 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 30 cost time: 1.060987949371338
Epoch: 30, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.347 Vali Acc: 0.927 Test Loss: 0.347 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0666072368621826
Epoch: 31, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.327 Vali Acc: 0.916 Test Loss: 0.327 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2924904823303223
Epoch: 32, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.330 Vali Acc: 0.924 Test Loss: 0.330 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0309779644012451
Epoch: 33, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.306 Vali Acc: 0.932 Test Loss: 0.306 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 34 cost time: 1.1145789623260498
Epoch: 34, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8656139373779297
Epoch: 35, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.292 Vali Acc: 0.932 Test Loss: 0.292 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 36 cost time: 1.1597750186920166
Epoch: 36, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.308 Vali Acc: 0.924 Test Loss: 0.308 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0599114894866943
Epoch: 37, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2194545269012451
Epoch: 38, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.280 Vali Acc: 0.924 Test Loss: 0.280 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9038169384002686
Epoch: 39, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3492133617401123
Epoch: 40, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.280 Vali Acc: 0.924 Test Loss: 0.280 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1992883682250977
Epoch: 41, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.274 Vali Acc: 0.924 Test Loss: 0.274 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2053275108337402
Epoch: 42, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.267 Vali Acc: 0.924 Test Loss: 0.267 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1272163391113281
Epoch: 43, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9677450656890869
Epoch: 44, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.263 Vali Acc: 0.924 Test Loss: 0.263 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9268360137939453
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.927 Test Loss: 0.260 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9324324324324325
model parameter : 65735
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.849398612976074
Epoch: 1, Steps: 17 | Train Loss: 2.244 Vali Loss: 2.169 Vali Acc: 0.119 Test Loss: 2.169 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 0.8894836902618408
Epoch: 2, Steps: 17 | Train Loss: 2.074 Vali Loss: 2.017 Vali Acc: 0.368 Test Loss: 2.017 Test Acc: 0.368
Validation loss decreased (-0.118897 --> -0.367547).  Saving model ...
Epoch: 3 cost time: 1.0632381439208984
Epoch: 3, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.885 Vali Acc: 0.489 Test Loss: 1.885 Test Acc: 0.489
Validation loss decreased (-0.367547 --> -0.489170).  Saving model ...
Epoch: 4 cost time: 1.1478033065795898
Epoch: 4, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.761 Vali Acc: 0.624 Test Loss: 1.761 Test Acc: 0.624
Validation loss decreased (-0.489170 --> -0.624307).  Saving model ...
Epoch: 5 cost time: 1.1514956951141357
Epoch: 5, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.648 Vali Acc: 0.681 Test Loss: 1.648 Test Acc: 0.681
Validation loss decreased (-0.624307 --> -0.681065).  Saving model ...
Epoch: 6 cost time: 1.1105070114135742
Epoch: 6, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.529 Vali Acc: 0.741 Test Loss: 1.529 Test Acc: 0.741
Validation loss decreased (-0.681065 --> -0.740525).  Saving model ...
Epoch: 7 cost time: 1.2749481201171875
Epoch: 7, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.413 Vali Acc: 0.797 Test Loss: 1.413 Test Acc: 0.797
Validation loss decreased (-0.740525 --> -0.797283).  Saving model ...
Epoch: 8 cost time: 0.8657064437866211
Epoch: 8, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.308 Vali Acc: 0.811 Test Loss: 1.308 Test Acc: 0.811
Validation loss decreased (-0.797283 --> -0.810798).  Saving model ...
Epoch: 9 cost time: 0.8453552722930908
Epoch: 9, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.192 Vali Acc: 0.824 Test Loss: 1.192 Test Acc: 0.824
Validation loss decreased (-0.810798 --> -0.824312).  Saving model ...
Epoch: 10 cost time: 1.0288829803466797
Epoch: 10, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.110 Vali Acc: 0.835 Test Loss: 1.110 Test Acc: 0.835
Validation loss decreased (-0.824312 --> -0.835124).  Saving model ...
Epoch: 11 cost time: 0.9080038070678711
Epoch: 11, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.009 Vali Acc: 0.857 Test Loss: 1.009 Test Acc: 0.857
Validation loss decreased (-0.835124 --> -0.856747).  Saving model ...
Epoch: 12 cost time: 1.0466279983520508
Epoch: 12, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.913 Vali Acc: 0.873 Test Loss: 0.913 Test Acc: 0.873
Validation loss decreased (-0.856747 --> -0.872964).  Saving model ...
Epoch: 13 cost time: 0.9372081756591797
Epoch: 13, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.857 Vali Acc: 0.870 Test Loss: 0.857 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1858851909637451
Epoch: 14, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.782 Vali Acc: 0.892 Test Loss: 0.782 Test Acc: 0.892
Validation loss decreased (-0.872964 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 1.1028780937194824
Epoch: 15, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.723 Vali Acc: 0.903 Test Loss: 0.723 Test Acc: 0.903
Validation loss decreased (-0.891884 --> -0.902695).  Saving model ...
Epoch: 16 cost time: 1.415391445159912
Epoch: 16, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.659 Vali Acc: 0.903 Test Loss: 0.659 Test Acc: 0.903
Validation loss decreased (-0.902695 --> -0.902696).  Saving model ...
Epoch: 17 cost time: 1.2624268531799316
Epoch: 17, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.631 Vali Acc: 0.903 Test Loss: 0.631 Test Acc: 0.903
Validation loss decreased (-0.902696 --> -0.902696).  Saving model ...
Epoch: 18 cost time: 1.2631871700286865
Epoch: 18, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2334659099578857
Epoch: 19, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.562 Vali Acc: 0.927 Test Loss: 0.562 Test Acc: 0.927
Validation loss decreased (-0.902696 --> -0.927021).  Saving model ...
Epoch: 20 cost time: 1.1014492511749268
Epoch: 20, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.508 Vali Acc: 0.919 Test Loss: 0.508 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.979231595993042
Epoch: 21, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.490 Vali Acc: 0.922 Test Loss: 0.490 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9565892219543457
Epoch: 22, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.472 Vali Acc: 0.919 Test Loss: 0.472 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4131827354431152
Epoch: 23, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.436 Vali Acc: 0.932 Test Loss: 0.436 Test Acc: 0.932
Validation loss decreased (-0.927021 --> -0.932428).  Saving model ...
Epoch: 24 cost time: 1.0780436992645264
Epoch: 24, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.418 Vali Acc: 0.922 Test Loss: 0.418 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0829601287841797
Epoch: 25, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.401 Vali Acc: 0.935 Test Loss: 0.401 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935131).  Saving model ...
Epoch: 26 cost time: 0.9099478721618652
Epoch: 26, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 27 cost time: 0.9819197654724121
Epoch: 27, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9486567974090576
Epoch: 28, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0743043422698975
Epoch: 29, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 30 cost time: 0.8942825794219971
Epoch: 30, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.313 Vali Acc: 0.943 Test Loss: 0.313 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 31 cost time: 0.9172084331512451
Epoch: 31, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.316 Vali Acc: 0.938 Test Loss: 0.316 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0296351909637451
Epoch: 32, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0619785785675049
Epoch: 33, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.315 Vali Acc: 0.938 Test Loss: 0.315 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0464401245117188
Epoch: 34, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.298 Vali Acc: 0.938 Test Loss: 0.298 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9689145088195801
Epoch: 35, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.275 Vali Acc: 0.941 Test Loss: 0.275 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.037184715270996
Epoch: 36, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.280 Vali Acc: 0.938 Test Loss: 0.280 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0268065929412842
Epoch: 37, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2800917625427246
Epoch: 38, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1254584789276123
Epoch: 39, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 40 cost time: 1.0147085189819336
Epoch: 40, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0944335460662842
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9847064018249512
Epoch: 42, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.243351936340332
Epoch: 43, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0407559871673584
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1324899196624756
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2160382270812988
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1382815837860107
Epoch: 47, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2301967144012451
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9683060646057129
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 64711
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8661770820617676
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 2.146 Vali Acc: 0.168 Test Loss: 2.146 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 0.9792454242706299
Epoch: 2, Steps: 17 | Train Loss: 2.021 Vali Loss: 2.005 Vali Acc: 0.357 Test Loss: 2.005 Test Acc: 0.357
Validation loss decreased (-0.167546 --> -0.356737).  Saving model ...
Epoch: 3 cost time: 0.7656245231628418
Epoch: 3, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.879 Vali Acc: 0.527 Test Loss: 1.879 Test Acc: 0.527
Validation loss decreased (-0.356737 --> -0.527008).  Saving model ...
Epoch: 4 cost time: 0.8999338150024414
Epoch: 4, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.730 Vali Acc: 0.649 Test Loss: 1.730 Test Acc: 0.649
Validation loss decreased (-0.527008 --> -0.648631).  Saving model ...
Epoch: 5 cost time: 0.8754072189331055
Epoch: 5, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.599 Vali Acc: 0.703 Test Loss: 1.599 Test Acc: 0.703
Validation loss decreased (-0.648631 --> -0.702687).  Saving model ...
Epoch: 6 cost time: 1.038290023803711
Epoch: 6, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.474 Vali Acc: 0.738 Test Loss: 1.474 Test Acc: 0.738
Validation loss decreased (-0.702687 --> -0.737823).  Saving model ...
Epoch: 7 cost time: 0.9225349426269531
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.354 Vali Acc: 0.795 Test Loss: 1.354 Test Acc: 0.795
Validation loss decreased (-0.737823 --> -0.794581).  Saving model ...
Epoch: 8 cost time: 1.028061866760254
Epoch: 8, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.243 Vali Acc: 0.805 Test Loss: 1.243 Test Acc: 0.805
Validation loss decreased (-0.794581 --> -0.805393).  Saving model ...
Epoch: 9 cost time: 0.9385526180267334
Epoch: 9, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.139 Vali Acc: 0.841 Test Loss: 1.139 Test Acc: 0.841
Validation loss decreased (-0.805393 --> -0.840529).  Saving model ...
Epoch: 10 cost time: 1.1509079933166504
Epoch: 10, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.040 Vali Acc: 0.854 Test Loss: 1.040 Test Acc: 0.854
Validation loss decreased (-0.840529 --> -0.854044).  Saving model ...
Epoch: 11 cost time: 0.9102654457092285
Epoch: 11, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.950 Vali Acc: 0.865 Test Loss: 0.950 Test Acc: 0.865
Validation loss decreased (-0.854044 --> -0.864855).  Saving model ...
Epoch: 12 cost time: 1.0105986595153809
Epoch: 12, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.869 Vali Acc: 0.868 Test Loss: 0.869 Test Acc: 0.868
Validation loss decreased (-0.864855 --> -0.867559).  Saving model ...
Epoch: 13 cost time: 0.9486804008483887
Epoch: 13, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.811 Vali Acc: 0.881 Test Loss: 0.811 Test Acc: 0.881
Validation loss decreased (-0.867559 --> -0.881073).  Saving model ...
Epoch: 14 cost time: 0.938652515411377
Epoch: 14, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.740 Vali Acc: 0.897 Test Loss: 0.740 Test Acc: 0.897
Validation loss decreased (-0.881073 --> -0.897290).  Saving model ...
Epoch: 15 cost time: 1.0497500896453857
Epoch: 15, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.689 Vali Acc: 0.895 Test Loss: 0.689 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9352960586547852
Epoch: 16, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.636 Vali Acc: 0.905 Test Loss: 0.636 Test Acc: 0.905
Validation loss decreased (-0.897290 --> -0.905399).  Saving model ...
Epoch: 17 cost time: 0.8283674716949463
Epoch: 17, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.586 Vali Acc: 0.911 Test Loss: 0.586 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 0.926811933517456
Epoch: 18, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.556 Vali Acc: 0.922 Test Loss: 0.556 Test Acc: 0.922
Validation loss decreased (-0.910805 --> -0.921616).  Saving model ...
Epoch: 19 cost time: 1.0108137130737305
Epoch: 19, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.514 Vali Acc: 0.930 Test Loss: 0.514 Test Acc: 0.930
Validation loss decreased (-0.921616 --> -0.929725).  Saving model ...
Epoch: 20 cost time: 1.2037172317504883
Epoch: 20, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.483 Vali Acc: 0.941 Test Loss: 0.483 Test Acc: 0.941
Validation loss decreased (-0.929725 --> -0.940536).  Saving model ...
Epoch: 21 cost time: 1.0752229690551758
Epoch: 21, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.455 Vali Acc: 0.932 Test Loss: 0.455 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.170539140701294
Epoch: 22, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.449 Vali Acc: 0.941 Test Loss: 0.449 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940536).  Saving model ...
Epoch: 23 cost time: 0.9937455654144287
Epoch: 23, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.422 Vali Acc: 0.946 Test Loss: 0.422 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 24 cost time: 1.1158225536346436
Epoch: 24, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.390 Vali Acc: 0.943 Test Loss: 0.390 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0682077407836914
Epoch: 25, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1193103790283203
Epoch: 26, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.371 Vali Acc: 0.935 Test Loss: 0.371 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.023280143737793
Epoch: 27, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.349 Vali Acc: 0.932 Test Loss: 0.349 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1978771686553955
Epoch: 28, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.349 Vali Acc: 0.932 Test Loss: 0.349 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9638681411743164
Epoch: 29, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.323 Vali Acc: 0.932 Test Loss: 0.323 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9930312633514404
Epoch: 30, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.328 Vali Acc: 0.943 Test Loss: 0.328 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9127404689788818
Epoch: 31, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.315 Vali Acc: 0.932 Test Loss: 0.315 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7454237937927246
Epoch: 32, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9113729000091553
Epoch: 33, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 63687
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.798142910003662
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 2.146 Vali Acc: 0.168 Test Loss: 2.146 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 0.8397531509399414
Epoch: 2, Steps: 17 | Train Loss: 2.021 Vali Loss: 2.005 Vali Acc: 0.357 Test Loss: 2.005 Test Acc: 0.357
Validation loss decreased (-0.167546 --> -0.356737).  Saving model ...
Epoch: 3 cost time: 0.7955482006072998
Epoch: 3, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.879 Vali Acc: 0.527 Test Loss: 1.879 Test Acc: 0.527
Validation loss decreased (-0.356737 --> -0.527008).  Saving model ...
Epoch: 4 cost time: 0.9349005222320557
Epoch: 4, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.730 Vali Acc: 0.649 Test Loss: 1.730 Test Acc: 0.649
Validation loss decreased (-0.527008 --> -0.648631).  Saving model ...
Epoch: 5 cost time: 1.144000768661499
Epoch: 5, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.599 Vali Acc: 0.703 Test Loss: 1.599 Test Acc: 0.703
Validation loss decreased (-0.648631 --> -0.702687).  Saving model ...
Epoch: 6 cost time: 1.086761474609375
Epoch: 6, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.474 Vali Acc: 0.738 Test Loss: 1.474 Test Acc: 0.738
Validation loss decreased (-0.702687 --> -0.737823).  Saving model ...
Epoch: 7 cost time: 1.0765256881713867
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.354 Vali Acc: 0.795 Test Loss: 1.354 Test Acc: 0.795
Validation loss decreased (-0.737823 --> -0.794581).  Saving model ...
Epoch: 8 cost time: 0.9406511783599854
Epoch: 8, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.243 Vali Acc: 0.805 Test Loss: 1.243 Test Acc: 0.805
Validation loss decreased (-0.794581 --> -0.805393).  Saving model ...
Epoch: 9 cost time: 0.9354398250579834
Epoch: 9, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.139 Vali Acc: 0.841 Test Loss: 1.139 Test Acc: 0.841
Validation loss decreased (-0.805393 --> -0.840529).  Saving model ...
Epoch: 10 cost time: 0.9086253643035889
Epoch: 10, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.040 Vali Acc: 0.854 Test Loss: 1.040 Test Acc: 0.854
Validation loss decreased (-0.840529 --> -0.854044).  Saving model ...
Epoch: 11 cost time: 0.7460277080535889
Epoch: 11, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.950 Vali Acc: 0.865 Test Loss: 0.950 Test Acc: 0.865
Validation loss decreased (-0.854044 --> -0.864855).  Saving model ...
Epoch: 12 cost time: 0.9270997047424316
Epoch: 12, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.869 Vali Acc: 0.868 Test Loss: 0.869 Test Acc: 0.868
Validation loss decreased (-0.864855 --> -0.867559).  Saving model ...
Epoch: 13 cost time: 0.8869142532348633
Epoch: 13, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.811 Vali Acc: 0.881 Test Loss: 0.811 Test Acc: 0.881
Validation loss decreased (-0.867559 --> -0.881073).  Saving model ...
Epoch: 14 cost time: 1.1122472286224365
Epoch: 14, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.740 Vali Acc: 0.897 Test Loss: 0.740 Test Acc: 0.897
Validation loss decreased (-0.881073 --> -0.897290).  Saving model ...
Epoch: 15 cost time: 0.9488263130187988
Epoch: 15, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.689 Vali Acc: 0.895 Test Loss: 0.689 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8275682926177979
Epoch: 16, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.636 Vali Acc: 0.905 Test Loss: 0.636 Test Acc: 0.905
Validation loss decreased (-0.897290 --> -0.905399).  Saving model ...
Epoch: 17 cost time: 0.766136646270752
Epoch: 17, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.586 Vali Acc: 0.911 Test Loss: 0.586 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 0.8386495113372803
Epoch: 18, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.556 Vali Acc: 0.922 Test Loss: 0.556 Test Acc: 0.922
Validation loss decreased (-0.910805 --> -0.921616).  Saving model ...
Epoch: 19 cost time: 1.4417929649353027
Epoch: 19, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.514 Vali Acc: 0.930 Test Loss: 0.514 Test Acc: 0.930
Validation loss decreased (-0.921616 --> -0.929725).  Saving model ...
Epoch: 20 cost time: 0.967357873916626
Epoch: 20, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.483 Vali Acc: 0.941 Test Loss: 0.483 Test Acc: 0.941
Validation loss decreased (-0.929725 --> -0.940536).  Saving model ...
Epoch: 21 cost time: 1.058567762374878
Epoch: 21, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.455 Vali Acc: 0.932 Test Loss: 0.455 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8640050888061523
Epoch: 22, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.449 Vali Acc: 0.941 Test Loss: 0.449 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940536).  Saving model ...
Epoch: 23 cost time: 0.932356595993042
Epoch: 23, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.422 Vali Acc: 0.946 Test Loss: 0.422 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 24 cost time: 0.9839222431182861
Epoch: 24, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.390 Vali Acc: 0.943 Test Loss: 0.390 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8689322471618652
Epoch: 25, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8512394428253174
Epoch: 26, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.371 Vali Acc: 0.935 Test Loss: 0.371 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8476109504699707
Epoch: 27, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.349 Vali Acc: 0.932 Test Loss: 0.349 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1180639266967773
Epoch: 28, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.349 Vali Acc: 0.932 Test Loss: 0.349 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8471744060516357
Epoch: 29, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.323 Vali Acc: 0.932 Test Loss: 0.323 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.017890214920044
Epoch: 30, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.328 Vali Acc: 0.943 Test Loss: 0.328 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1049633026123047
Epoch: 31, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.315 Vali Acc: 0.932 Test Loss: 0.315 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1363155841827393
Epoch: 32, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9341280460357666
Epoch: 33, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 63687
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1925277709960938
Epoch: 1, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.176 Vali Acc: 0.097 Test Loss: 2.176 Test Acc: 0.097
Validation loss decreased (inf --> -0.097276).  Saving model ...
Epoch: 2 cost time: 1.088069200515747
Epoch: 2, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.108 Vali Acc: 0.143 Test Loss: 2.108 Test Acc: 0.143
Validation loss decreased (-0.097276 --> -0.143222).  Saving model ...
Epoch: 3 cost time: 1.0367543697357178
Epoch: 3, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.017 Vali Acc: 0.241 Test Loss: 2.017 Test Acc: 0.241
Validation loss decreased (-0.143222 --> -0.240520).  Saving model ...
Epoch: 4 cost time: 0.8981153964996338
Epoch: 4, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.909 Vali Acc: 0.449 Test Loss: 1.909 Test Acc: 0.449
Validation loss decreased (-0.240520 --> -0.448630).  Saving model ...
Epoch: 5 cost time: 1.0423595905303955
Epoch: 5, Steps: 17 | Train Loss: 1.853 Vali Loss: 1.791 Vali Acc: 0.643 Test Loss: 1.791 Test Acc: 0.643
Validation loss decreased (-0.448630 --> -0.643225).  Saving model ...
Epoch: 6 cost time: 0.9783527851104736
Epoch: 6, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.675 Vali Acc: 0.743 Test Loss: 1.675 Test Acc: 0.743
Validation loss decreased (-0.643225 --> -0.743226).  Saving model ...
Epoch: 7 cost time: 1.0503625869750977
Epoch: 7, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.543 Vali Acc: 0.822 Test Loss: 1.543 Test Acc: 0.822
Validation loss decreased (-0.743226 --> -0.821606).  Saving model ...
Epoch: 8 cost time: 1.2632465362548828
Epoch: 8, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.421 Vali Acc: 0.838 Test Loss: 1.421 Test Acc: 0.838
Validation loss decreased (-0.821606 --> -0.837824).  Saving model ...
Epoch: 9 cost time: 0.9183464050292969
Epoch: 9, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.304 Vali Acc: 0.865 Test Loss: 1.304 Test Acc: 0.865
Validation loss decreased (-0.837824 --> -0.864852).  Saving model ...
Epoch: 10 cost time: 1.0726711750030518
Epoch: 10, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.188 Vali Acc: 0.873 Test Loss: 1.188 Test Acc: 0.873
Validation loss decreased (-0.864852 --> -0.872961).  Saving model ...
Epoch: 11 cost time: 1.008448600769043
Epoch: 11, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.074 Vali Acc: 0.876 Test Loss: 1.074 Test Acc: 0.876
Validation loss decreased (-0.872961 --> -0.875665).  Saving model ...
Epoch: 12 cost time: 0.9584352970123291
Epoch: 12, Steps: 17 | Train Loss: 0.919 Vali Loss: 0.984 Vali Acc: 0.870 Test Loss: 0.984 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9353268146514893
Epoch: 13, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.898 Vali Acc: 0.884 Test Loss: 0.898 Test Acc: 0.884
Validation loss decreased (-0.875665 --> -0.883775).  Saving model ...
Epoch: 14 cost time: 1.3402900695800781
Epoch: 14, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.820 Vali Acc: 0.892 Test Loss: 0.820 Test Acc: 0.892
Validation loss decreased (-0.883775 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 1.0113294124603271
Epoch: 15, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.750 Vali Acc: 0.905 Test Loss: 0.750 Test Acc: 0.905
Validation loss decreased (-0.891884 --> -0.905398).  Saving model ...
Epoch: 16 cost time: 1.2066559791564941
Epoch: 16, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.694 Vali Acc: 0.903 Test Loss: 0.694 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.289759874343872
Epoch: 17, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.645 Vali Acc: 0.908 Test Loss: 0.645 Test Acc: 0.908
Validation loss decreased (-0.905398 --> -0.908102).  Saving model ...
Epoch: 18 cost time: 1.1637604236602783
Epoch: 18, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.601 Vali Acc: 0.914 Test Loss: 0.601 Test Acc: 0.914
Validation loss decreased (-0.908102 --> -0.913507).  Saving model ...
Epoch: 19 cost time: 1.2108829021453857
Epoch: 19, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.564 Vali Acc: 0.919 Test Loss: 0.564 Test Acc: 0.919
Validation loss decreased (-0.913507 --> -0.918913).  Saving model ...
Epoch: 20 cost time: 1.0512111186981201
Epoch: 20, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.529 Vali Acc: 0.924 Test Loss: 0.529 Test Acc: 0.924
Validation loss decreased (-0.918913 --> -0.924319).  Saving model ...
Epoch: 21 cost time: 0.9788713455200195
Epoch: 21, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.495 Vali Acc: 0.919 Test Loss: 0.495 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0684361457824707
Epoch: 22, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.463 Vali Acc: 0.932 Test Loss: 0.463 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932428).  Saving model ...
Epoch: 23 cost time: 0.9987719058990479
Epoch: 23, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.441 Vali Acc: 0.938 Test Loss: 0.441 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937833).  Saving model ...
Epoch: 24 cost time: 1.0416340827941895
Epoch: 24, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.421 Vali Acc: 0.935 Test Loss: 0.421 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2487256526947021
Epoch: 25, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.403 Vali Acc: 0.935 Test Loss: 0.403 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1422269344329834
Epoch: 26, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.384 Vali Acc: 0.941 Test Loss: 0.384 Test Acc: 0.941
Validation loss decreased (-0.937833 --> -0.940537).  Saving model ...
Epoch: 27 cost time: 1.1225557327270508
Epoch: 27, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1905481815338135
Epoch: 28, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 29 cost time: 1.4071052074432373
Epoch: 29, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.335 Vali Acc: 0.943 Test Loss: 0.335 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 30 cost time: 1.2236132621765137
Epoch: 30, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1481504440307617
Epoch: 31, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.322 Vali Acc: 0.949 Test Loss: 0.322 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948645).  Saving model ...
Epoch: 32 cost time: 1.299255132675171
Epoch: 32, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.310 Vali Acc: 0.938 Test Loss: 0.310 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0103034973144531
Epoch: 33, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.303 Vali Acc: 0.951 Test Loss: 0.303 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951348).  Saving model ...
Epoch: 34 cost time: 1.1466057300567627
Epoch: 34, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.292 Vali Acc: 0.949 Test Loss: 0.292 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2783820629119873
Epoch: 35, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.283 Vali Acc: 0.954 Test Loss: 0.283 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 36 cost time: 0.9259138107299805
Epoch: 36, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1166489124298096
Epoch: 37, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.272 Vali Acc: 0.954 Test Loss: 0.272 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 38 cost time: 0.9513919353485107
Epoch: 38, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0090367794036865
Epoch: 39, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1587257385253906
Epoch: 40, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1616356372833252
Epoch: 41, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.248 Vali Acc: 0.949 Test Loss: 0.248 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.044823169708252
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.954 Test Loss: 0.242 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 43 cost time: 0.9814999103546143
Epoch: 43, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9661805629730225
Epoch: 44, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.240 Vali Acc: 0.951 Test Loss: 0.240 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8725404739379883
Epoch: 45, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9636468887329102
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9291470050811768
Epoch: 47, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.226 Vali Acc: 0.954 Test Loss: 0.226 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 48 cost time: 1.0452673435211182
Epoch: 48, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 49 cost time: 1.0874073505401611
Epoch: 49, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9719479084014893
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.954 Test Loss: 0.216 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9920105934143066
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.2761712074279785
Epoch: 52, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1717383861541748
Epoch: 53, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.075404405593872
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.1060826778411865
Epoch: 55, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.954 Test Loss: 0.201 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.1574552059173584
Epoch: 56, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.0475287437438965
Epoch: 57, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.0594043731689453
Epoch: 58, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 35439
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6419661045074463
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.180 Vali Acc: 0.105 Test Loss: 2.180 Test Acc: 0.105
Validation loss decreased (inf --> -0.105384).  Saving model ...
Epoch: 2 cost time: 0.9540469646453857
Epoch: 2, Steps: 17 | Train Loss: 2.134 Vali Loss: 2.104 Vali Acc: 0.184 Test Loss: 2.104 Test Acc: 0.184
Validation loss decreased (-0.105384 --> -0.183763).  Saving model ...
Epoch: 3 cost time: 1.0824291706085205
Epoch: 3, Steps: 17 | Train Loss: 2.037 Vali Loss: 2.012 Vali Acc: 0.324 Test Loss: 2.012 Test Acc: 0.324
Validation loss decreased (-0.183763 --> -0.324304).  Saving model ...
Epoch: 4 cost time: 1.3213555812835693
Epoch: 4, Steps: 17 | Train Loss: 1.932 Vali Loss: 1.903 Vali Acc: 0.457 Test Loss: 1.903 Test Acc: 0.457
Validation loss decreased (-0.324304 --> -0.456738).  Saving model ...
Epoch: 5 cost time: 1.260390281677246
Epoch: 5, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.786 Vali Acc: 0.565 Test Loss: 1.786 Test Acc: 0.565
Validation loss decreased (-0.456738 --> -0.564847).  Saving model ...
Epoch: 6 cost time: 1.2680199146270752
Epoch: 6, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.659 Vali Acc: 0.711 Test Loss: 1.659 Test Acc: 0.711
Validation loss decreased (-0.564847 --> -0.710794).  Saving model ...
Epoch: 7 cost time: 1.3906807899475098
Epoch: 7, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.533 Vali Acc: 0.800 Test Loss: 1.533 Test Acc: 0.800
Validation loss decreased (-0.710794 --> -0.799985).  Saving model ...
Epoch: 8 cost time: 1.260251522064209
Epoch: 8, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.406 Vali Acc: 0.838 Test Loss: 1.406 Test Acc: 0.838
Validation loss decreased (-0.799985 --> -0.837824).  Saving model ...
Epoch: 9 cost time: 1.1230072975158691
Epoch: 9, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.281 Vali Acc: 0.859 Test Loss: 1.281 Test Acc: 0.859
Validation loss decreased (-0.837824 --> -0.859447).  Saving model ...
Epoch: 10 cost time: 1.4626007080078125
Epoch: 10, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.159 Vali Acc: 0.862 Test Loss: 1.159 Test Acc: 0.862
Validation loss decreased (-0.859447 --> -0.862151).  Saving model ...
Epoch: 11 cost time: 1.1258304119110107
Epoch: 11, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.050 Vali Acc: 0.876 Test Loss: 1.050 Test Acc: 0.876
Validation loss decreased (-0.862151 --> -0.875665).  Saving model ...
Epoch: 12 cost time: 1.0349011421203613
Epoch: 12, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.955 Vali Acc: 0.884 Test Loss: 0.955 Test Acc: 0.884
Validation loss decreased (-0.875665 --> -0.883774).  Saving model ...
Epoch: 13 cost time: 1.0287654399871826
Epoch: 13, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.865 Vali Acc: 0.886 Test Loss: 0.865 Test Acc: 0.886
Validation loss decreased (-0.883774 --> -0.886478).  Saving model ...
Epoch: 14 cost time: 0.981440544128418
Epoch: 14, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.785 Vali Acc: 0.895 Test Loss: 0.785 Test Acc: 0.895
Validation loss decreased (-0.886478 --> -0.894587).  Saving model ...
Epoch: 15 cost time: 1.0030646324157715
Epoch: 15, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.719 Vali Acc: 0.886 Test Loss: 0.719 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2934989929199219
Epoch: 16, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0825088024139404
Epoch: 17, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.606 Vali Acc: 0.900 Test Loss: 0.606 Test Acc: 0.900
Validation loss decreased (-0.894587 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.8980402946472168
Epoch: 18, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.562 Vali Acc: 0.914 Test Loss: 0.562 Test Acc: 0.914
Validation loss decreased (-0.899994 --> -0.913508).  Saving model ...
Epoch: 19 cost time: 0.9754905700683594
Epoch: 19, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.521 Vali Acc: 0.916 Test Loss: 0.521 Test Acc: 0.916
Validation loss decreased (-0.913508 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 0.9774603843688965
Epoch: 20, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.482 Vali Acc: 0.924 Test Loss: 0.482 Test Acc: 0.924
Validation loss decreased (-0.916211 --> -0.924319).  Saving model ...
Epoch: 21 cost time: 1.0852324962615967
Epoch: 21, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.458 Vali Acc: 0.914 Test Loss: 0.458 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.243140697479248
Epoch: 22, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.433 Vali Acc: 0.916 Test Loss: 0.433 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1262247562408447
Epoch: 23, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.417 Vali Acc: 0.924 Test Loss: 0.417 Test Acc: 0.924
Validation loss decreased (-0.924319 --> -0.924320).  Saving model ...
Epoch: 24 cost time: 1.3041415214538574
Epoch: 24, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.396 Vali Acc: 0.914 Test Loss: 0.396 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.275338888168335
Epoch: 25, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.370 Vali Acc: 0.927 Test Loss: 0.370 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 26 cost time: 1.1827597618103027
Epoch: 26, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.357 Vali Acc: 0.924 Test Loss: 0.357 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0147356986999512
Epoch: 27, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.248075008392334
Epoch: 28, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0356366634368896
Epoch: 29, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2113168239593506
Epoch: 30, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.320 Vali Acc: 0.914 Test Loss: 0.320 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.136470079421997
Epoch: 31, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929727).  Saving model ...
Epoch: 32 cost time: 1.3231570720672607
Epoch: 32, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.295 Vali Acc: 0.927 Test Loss: 0.295 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1055281162261963
Epoch: 33, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.293 Vali Acc: 0.916 Test Loss: 0.293 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9153501987457275
Epoch: 34, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.161034107208252
Epoch: 35, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.285 Vali Acc: 0.914 Test Loss: 0.285 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1034266948699951
Epoch: 36, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9912247657775879
Epoch: 37, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1261012554168701
Epoch: 38, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0400757789611816
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 40 cost time: 1.0408949851989746
Epoch: 40, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2232179641723633
Epoch: 41, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.268 Vali Acc: 0.914 Test Loss: 0.268 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1120362281799316
Epoch: 42, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.914 Test Loss: 0.261 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.380589246749878
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.256 Vali Acc: 0.927 Test Loss: 0.256 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2849411964416504
Epoch: 44, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.258 Vali Acc: 0.908 Test Loss: 0.258 Test Acc: 0.908
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2363636493682861
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2039453983306885
Epoch: 46, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1711359024047852
Epoch: 47, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.259 Vali Acc: 0.924 Test Loss: 0.259 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1036169528961182
Epoch: 48, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.248 Vali Acc: 0.914 Test Loss: 0.248 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2716262340545654
Epoch: 49, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9297297297297298
model parameter : 34927
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8479135036468506
Epoch: 1, Steps: 17 | Train Loss: 2.268 Vali Loss: 2.259 Vali Acc: 0.035 Test Loss: 2.259 Test Acc: 0.035
Validation loss decreased (inf --> -0.035113).  Saving model ...
Epoch: 2 cost time: 1.1215031147003174
Epoch: 2, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.181 Vali Acc: 0.086 Test Loss: 2.181 Test Acc: 0.086
Validation loss decreased (-0.035113 --> -0.086465).  Saving model ...
Epoch: 3 cost time: 1.1745719909667969
Epoch: 3, Steps: 17 | Train Loss: 2.101 Vali Loss: 2.081 Vali Acc: 0.232 Test Loss: 2.081 Test Acc: 0.232
Validation loss decreased (-0.086465 --> -0.232412).  Saving model ...
Epoch: 4 cost time: 1.1320164203643799
Epoch: 4, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.971 Vali Acc: 0.424 Test Loss: 1.971 Test Acc: 0.424
Validation loss decreased (-0.232412 --> -0.424305).  Saving model ...
Epoch: 5 cost time: 0.8182168006896973
Epoch: 5, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.851 Vali Acc: 0.578 Test Loss: 1.851 Test Acc: 0.578
Validation loss decreased (-0.424305 --> -0.578360).  Saving model ...
Epoch: 6 cost time: 1.1136183738708496
Epoch: 6, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.725 Vali Acc: 0.697 Test Loss: 1.725 Test Acc: 0.697
Validation loss decreased (-0.578360 --> -0.697280).  Saving model ...
Epoch: 7 cost time: 1.0366814136505127
Epoch: 7, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.606 Vali Acc: 0.762 Test Loss: 1.606 Test Acc: 0.762
Validation loss decreased (-0.697280 --> -0.762146).  Saving model ...
Epoch: 8 cost time: 1.37046217918396
Epoch: 8, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.481 Vali Acc: 0.805 Test Loss: 1.481 Test Acc: 0.805
Validation loss decreased (-0.762146 --> -0.805391).  Saving model ...
Epoch: 9 cost time: 0.9807090759277344
Epoch: 9, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.356 Vali Acc: 0.832 Test Loss: 1.356 Test Acc: 0.832
Validation loss decreased (-0.805391 --> -0.832419).  Saving model ...
Epoch: 10 cost time: 1.0148277282714844
Epoch: 10, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.240 Vali Acc: 0.849 Test Loss: 1.240 Test Acc: 0.849
Validation loss decreased (-0.832419 --> -0.848636).  Saving model ...
Epoch: 11 cost time: 1.2421529293060303
Epoch: 11, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.128 Vali Acc: 0.849 Test Loss: 1.128 Test Acc: 0.849
Validation loss decreased (-0.848636 --> -0.848637).  Saving model ...
Epoch: 12 cost time: 0.8488402366638184
Epoch: 12, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.023 Vali Acc: 0.854 Test Loss: 1.023 Test Acc: 0.854
Validation loss decreased (-0.848637 --> -0.854044).  Saving model ...
Epoch: 13 cost time: 0.9876582622528076
Epoch: 13, Steps: 17 | Train Loss: 0.822 Vali Loss: 0.929 Vali Acc: 0.868 Test Loss: 0.929 Test Acc: 0.868
Validation loss decreased (-0.854044 --> -0.867558).  Saving model ...
Epoch: 14 cost time: 1.2531700134277344
Epoch: 14, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.853 Vali Acc: 0.886 Test Loss: 0.853 Test Acc: 0.886
Validation loss decreased (-0.867558 --> -0.886478).  Saving model ...
Epoch: 15 cost time: 1.13606595993042
Epoch: 15, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.777 Vali Acc: 0.889 Test Loss: 0.777 Test Acc: 0.889
Validation loss decreased (-0.886478 --> -0.889181).  Saving model ...
Epoch: 16 cost time: 0.9369080066680908
Epoch: 16, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.714 Vali Acc: 0.897 Test Loss: 0.714 Test Acc: 0.897
Validation loss decreased (-0.889181 --> -0.897290).  Saving model ...
Epoch: 17 cost time: 0.930610179901123
Epoch: 17, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.651 Vali Acc: 0.897 Test Loss: 0.651 Test Acc: 0.897
Validation loss decreased (-0.897290 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 0.9544575214385986
Epoch: 18, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.610 Vali Acc: 0.905 Test Loss: 0.610 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905399).  Saving model ...
Epoch: 19 cost time: 1.1416983604431152
Epoch: 19, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.567 Vali Acc: 0.905 Test Loss: 0.567 Test Acc: 0.905
Validation loss decreased (-0.905399 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 1.0424323081970215
Epoch: 20, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.528 Vali Acc: 0.905 Test Loss: 0.528 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905400).  Saving model ...
Epoch: 21 cost time: 0.9224395751953125
Epoch: 21, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.501 Vali Acc: 0.916 Test Loss: 0.501 Test Acc: 0.916
Validation loss decreased (-0.905400 --> -0.916211).  Saving model ...
Epoch: 22 cost time: 0.8351907730102539
Epoch: 22, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.472 Vali Acc: 0.919 Test Loss: 0.472 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918914).  Saving model ...
Epoch: 23 cost time: 0.911348819732666
Epoch: 23, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.452 Vali Acc: 0.919 Test Loss: 0.452 Test Acc: 0.919
Validation loss decreased (-0.918914 --> -0.918914).  Saving model ...
Epoch: 24 cost time: 0.9989283084869385
Epoch: 24, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 25 cost time: 1.255061388015747
Epoch: 25, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.415 Vali Acc: 0.922 Test Loss: 0.415 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8649284839630127
Epoch: 26, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.376 Vali Acc: 0.935 Test Loss: 0.376 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935131).  Saving model ...
Epoch: 27 cost time: 1.0633628368377686
Epoch: 27, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.371 Vali Acc: 0.924 Test Loss: 0.371 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.058450698852539
Epoch: 28, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.350 Vali Acc: 0.927 Test Loss: 0.350 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9822814464569092
Epoch: 29, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.338 Vali Acc: 0.927 Test Loss: 0.338 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0856986045837402
Epoch: 30, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.326 Vali Acc: 0.932 Test Loss: 0.326 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1931746006011963
Epoch: 31, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.316 Vali Acc: 0.932 Test Loss: 0.316 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2899208068847656
Epoch: 32, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 33 cost time: 1.156130075454712
Epoch: 33, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.301 Vali Acc: 0.938 Test Loss: 0.301 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 34 cost time: 1.088134527206421
Epoch: 34, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.291 Vali Acc: 0.935 Test Loss: 0.291 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9310307502746582
Epoch: 35, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.283 Vali Acc: 0.935 Test Loss: 0.283 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1368231773376465
Epoch: 36, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0156245231628418
Epoch: 37, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.935 Test Loss: 0.265 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.002596139907837
Epoch: 38, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.266 Vali Acc: 0.938 Test Loss: 0.266 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 39 cost time: 1.125037670135498
Epoch: 39, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.932 Test Loss: 0.259 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.074862003326416
Epoch: 40, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.254 Vali Acc: 0.938 Test Loss: 0.254 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 41 cost time: 1.0038206577301025
Epoch: 41, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.252 Vali Acc: 0.932 Test Loss: 0.252 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0660746097564697
Epoch: 42, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9770877361297607
Epoch: 43, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 44 cost time: 1.0380420684814453
Epoch: 44, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0335133075714111
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1844687461853027
Epoch: 46, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1392102241516113
Epoch: 47, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9546279907226562
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0682017803192139
Epoch: 49, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0335171222686768
Epoch: 50, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8617274761199951
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.2835047245025635
Epoch: 52, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.932 Test Loss: 0.220 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.202733039855957
Epoch: 53, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 34415
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.462045192718506
Epoch: 1, Steps: 17 | Train Loss: 2.261 Vali Loss: 2.212 Vali Acc: 0.124 Test Loss: 2.212 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 1.0006330013275146
Epoch: 2, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.137 Vali Acc: 0.189 Test Loss: 2.137 Test Acc: 0.189
Validation loss decreased (-0.124302 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 0.8096778392791748
Epoch: 3, Steps: 17 | Train Loss: 2.088 Vali Loss: 2.040 Vali Acc: 0.305 Test Loss: 2.040 Test Acc: 0.305
Validation loss decreased (-0.189168 --> -0.305385).  Saving model ...
Epoch: 4 cost time: 0.9146826267242432
Epoch: 4, Steps: 17 | Train Loss: 1.966 Vali Loss: 1.928 Vali Acc: 0.495 Test Loss: 1.928 Test Acc: 0.495
Validation loss decreased (-0.305385 --> -0.494575).  Saving model ...
Epoch: 5 cost time: 0.8651721477508545
Epoch: 5, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.808 Vali Acc: 0.681 Test Loss: 1.808 Test Acc: 0.681
Validation loss decreased (-0.494575 --> -0.681063).  Saving model ...
Epoch: 6 cost time: 0.8753662109375
Epoch: 6, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.679 Vali Acc: 0.762 Test Loss: 1.679 Test Acc: 0.762
Validation loss decreased (-0.681063 --> -0.762145).  Saving model ...
Epoch: 7 cost time: 1.100752592086792
Epoch: 7, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.541 Vali Acc: 0.827 Test Loss: 1.541 Test Acc: 0.827
Validation loss decreased (-0.762145 --> -0.827012).  Saving model ...
Epoch: 8 cost time: 1.018218755722046
Epoch: 8, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.410 Vali Acc: 0.827 Test Loss: 1.410 Test Acc: 0.827
Validation loss decreased (-0.827012 --> -0.827013).  Saving model ...
Epoch: 9 cost time: 0.876995325088501
Epoch: 9, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.276 Vali Acc: 0.851 Test Loss: 1.276 Test Acc: 0.851
Validation loss decreased (-0.827013 --> -0.851339).  Saving model ...
Epoch: 10 cost time: 0.952965259552002
Epoch: 10, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.157 Vali Acc: 0.849 Test Loss: 1.157 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9662268161773682
Epoch: 11, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.044 Vali Acc: 0.862 Test Loss: 1.044 Test Acc: 0.862
Validation loss decreased (-0.851339 --> -0.862152).  Saving model ...
Epoch: 12 cost time: 0.8998732566833496
Epoch: 12, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.948 Vali Acc: 0.865 Test Loss: 0.948 Test Acc: 0.865
Validation loss decreased (-0.862152 --> -0.864855).  Saving model ...
Epoch: 13 cost time: 0.8606224060058594
Epoch: 13, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.862 Vali Acc: 0.876 Test Loss: 0.862 Test Acc: 0.876
Validation loss decreased (-0.864855 --> -0.875667).  Saving model ...
Epoch: 14 cost time: 0.9386253356933594
Epoch: 14, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.786 Vali Acc: 0.881 Test Loss: 0.786 Test Acc: 0.881
Validation loss decreased (-0.875667 --> -0.881073).  Saving model ...
Epoch: 15 cost time: 0.8715815544128418
Epoch: 15, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.728 Vali Acc: 0.903 Test Loss: 0.728 Test Acc: 0.903
Validation loss decreased (-0.881073 --> -0.902695).  Saving model ...
Epoch: 16 cost time: 0.9729845523834229
Epoch: 16, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.664 Vali Acc: 0.895 Test Loss: 0.664 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8458812236785889
Epoch: 17, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.624 Vali Acc: 0.911 Test Loss: 0.624 Test Acc: 0.911
Validation loss decreased (-0.902695 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 0.7357766628265381
Epoch: 18, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.576 Vali Acc: 0.908 Test Loss: 0.576 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8608694076538086
Epoch: 19, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.539 Vali Acc: 0.916 Test Loss: 0.539 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 1.058929681777954
Epoch: 20, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.501 Vali Acc: 0.908 Test Loss: 0.501 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.141711950302124
Epoch: 21, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.479 Vali Acc: 0.911 Test Loss: 0.479 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.901360034942627
Epoch: 22, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.453 Vali Acc: 0.916 Test Loss: 0.453 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916212).  Saving model ...
Epoch: 23 cost time: 0.9799296855926514
Epoch: 23, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 24 cost time: 0.9816992282867432
Epoch: 24, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.402 Vali Acc: 0.919 Test Loss: 0.402 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 0.8655703067779541
Epoch: 25, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.393 Vali Acc: 0.914 Test Loss: 0.393 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.911945104598999
Epoch: 26, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.376 Vali Acc: 0.916 Test Loss: 0.376 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0858159065246582
Epoch: 27, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 1.0593466758728027
Epoch: 28, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 29 cost time: 1.1167833805084229
Epoch: 29, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.342 Vali Acc: 0.916 Test Loss: 0.342 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4591033458709717
Epoch: 30, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.324 Vali Acc: 0.932 Test Loss: 0.324 Test Acc: 0.932
Validation loss decreased (-0.918915 --> -0.932429).  Saving model ...
Epoch: 31 cost time: 1.073183298110962
Epoch: 31, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2727134227752686
Epoch: 32, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.312 Vali Acc: 0.938 Test Loss: 0.312 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 33 cost time: 0.9056432247161865
Epoch: 33, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9801435470581055
Epoch: 34, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.302 Vali Acc: 0.927 Test Loss: 0.302 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9718432426452637
Epoch: 35, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.292 Vali Acc: 0.932 Test Loss: 0.292 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0992393493652344
Epoch: 36, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1362392902374268
Epoch: 37, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.286 Vali Acc: 0.927 Test Loss: 0.286 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0397703647613525
Epoch: 38, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.276 Vali Acc: 0.932 Test Loss: 0.276 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2694835662841797
Epoch: 39, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0726268291473389
Epoch: 40, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1855430603027344
Epoch: 41, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.282 Vali Acc: 0.924 Test Loss: 0.282 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1288783550262451
Epoch: 42, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.272 Vali Acc: 0.927 Test Loss: 0.272 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 33903
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.761810064315796
Epoch: 1, Steps: 17 | Train Loss: 2.261 Vali Loss: 2.212 Vali Acc: 0.124 Test Loss: 2.212 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 0.8811640739440918
Epoch: 2, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.137 Vali Acc: 0.189 Test Loss: 2.137 Test Acc: 0.189
Validation loss decreased (-0.124302 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 1.1129837036132812
Epoch: 3, Steps: 17 | Train Loss: 2.088 Vali Loss: 2.040 Vali Acc: 0.305 Test Loss: 2.040 Test Acc: 0.305
Validation loss decreased (-0.189168 --> -0.305385).  Saving model ...
Epoch: 4 cost time: 0.9189696311950684
Epoch: 4, Steps: 17 | Train Loss: 1.966 Vali Loss: 1.928 Vali Acc: 0.495 Test Loss: 1.928 Test Acc: 0.495
Validation loss decreased (-0.305385 --> -0.494575).  Saving model ...
Epoch: 5 cost time: 1.0579864978790283
Epoch: 5, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.808 Vali Acc: 0.681 Test Loss: 1.808 Test Acc: 0.681
Validation loss decreased (-0.494575 --> -0.681063).  Saving model ...
Epoch: 6 cost time: 0.9885334968566895
Epoch: 6, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.679 Vali Acc: 0.762 Test Loss: 1.679 Test Acc: 0.762
Validation loss decreased (-0.681063 --> -0.762145).  Saving model ...
Epoch: 7 cost time: 0.9049515724182129
Epoch: 7, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.541 Vali Acc: 0.827 Test Loss: 1.541 Test Acc: 0.827
Validation loss decreased (-0.762145 --> -0.827012).  Saving model ...
Epoch: 8 cost time: 0.9739203453063965
Epoch: 8, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.410 Vali Acc: 0.827 Test Loss: 1.410 Test Acc: 0.827
Validation loss decreased (-0.827012 --> -0.827013).  Saving model ...
Epoch: 9 cost time: 0.9276535511016846
Epoch: 9, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.276 Vali Acc: 0.851 Test Loss: 1.276 Test Acc: 0.851
Validation loss decreased (-0.827013 --> -0.851339).  Saving model ...
Epoch: 10 cost time: 1.040548324584961
Epoch: 10, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.157 Vali Acc: 0.849 Test Loss: 1.157 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0552499294281006
Epoch: 11, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.044 Vali Acc: 0.862 Test Loss: 1.044 Test Acc: 0.862
Validation loss decreased (-0.851339 --> -0.862152).  Saving model ...
Epoch: 12 cost time: 0.9726986885070801
Epoch: 12, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.948 Vali Acc: 0.865 Test Loss: 0.948 Test Acc: 0.865
Validation loss decreased (-0.862152 --> -0.864855).  Saving model ...
Epoch: 13 cost time: 0.8088061809539795
Epoch: 13, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.862 Vali Acc: 0.876 Test Loss: 0.862 Test Acc: 0.876
Validation loss decreased (-0.864855 --> -0.875667).  Saving model ...
Epoch: 14 cost time: 1.2681372165679932
Epoch: 14, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.786 Vali Acc: 0.881 Test Loss: 0.786 Test Acc: 0.881
Validation loss decreased (-0.875667 --> -0.881073).  Saving model ...
Epoch: 15 cost time: 0.9756777286529541
Epoch: 15, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.728 Vali Acc: 0.903 Test Loss: 0.728 Test Acc: 0.903
Validation loss decreased (-0.881073 --> -0.902695).  Saving model ...
Epoch: 16 cost time: 0.7807762622833252
Epoch: 16, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.664 Vali Acc: 0.895 Test Loss: 0.664 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9894344806671143
Epoch: 17, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.624 Vali Acc: 0.911 Test Loss: 0.624 Test Acc: 0.911
Validation loss decreased (-0.902695 --> -0.910805).  Saving model ...
Epoch: 18 cost time: 1.1523139476776123
Epoch: 18, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.576 Vali Acc: 0.908 Test Loss: 0.576 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8835198879241943
Epoch: 19, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.539 Vali Acc: 0.916 Test Loss: 0.539 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 20 cost time: 0.9097774028778076
Epoch: 20, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.501 Vali Acc: 0.908 Test Loss: 0.501 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8803236484527588
Epoch: 21, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.479 Vali Acc: 0.911 Test Loss: 0.479 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0730650424957275
Epoch: 22, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.453 Vali Acc: 0.916 Test Loss: 0.453 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916212).  Saving model ...
Epoch: 23 cost time: 0.9851508140563965
Epoch: 23, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 24 cost time: 1.023580551147461
Epoch: 24, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.402 Vali Acc: 0.919 Test Loss: 0.402 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 25 cost time: 1.0890207290649414
Epoch: 25, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.393 Vali Acc: 0.914 Test Loss: 0.393 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0647082328796387
Epoch: 26, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.376 Vali Acc: 0.916 Test Loss: 0.376 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.22105073928833
Epoch: 27, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 0.9859335422515869
Epoch: 28, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 29 cost time: 1.2059190273284912
Epoch: 29, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.342 Vali Acc: 0.916 Test Loss: 0.342 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2488782405853271
Epoch: 30, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.324 Vali Acc: 0.932 Test Loss: 0.324 Test Acc: 0.932
Validation loss decreased (-0.918915 --> -0.932429).  Saving model ...
Epoch: 31 cost time: 0.9427435398101807
Epoch: 31, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9890077114105225
Epoch: 32, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.312 Vali Acc: 0.938 Test Loss: 0.312 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 33 cost time: 0.9964728355407715
Epoch: 33, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7992103099822998
Epoch: 34, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.302 Vali Acc: 0.927 Test Loss: 0.302 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7127134799957275
Epoch: 35, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.292 Vali Acc: 0.932 Test Loss: 0.292 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1663801670074463
Epoch: 36, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9330453872680664
Epoch: 37, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.286 Vali Acc: 0.927 Test Loss: 0.286 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9933347702026367
Epoch: 38, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.276 Vali Acc: 0.932 Test Loss: 0.276 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2536885738372803
Epoch: 39, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0466053485870361
Epoch: 40, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9852275848388672
Epoch: 41, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.282 Vali Acc: 0.924 Test Loss: 0.282 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0791115760803223
Epoch: 42, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.272 Vali Acc: 0.927 Test Loss: 0.272 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 33903
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.655961513519287
Epoch: 1, Steps: 17 | Train Loss: 2.224 Vali Loss: 2.237 Vali Acc: 0.124 Test Loss: 2.237 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 0.9950089454650879
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.167 Vali Acc: 0.184 Test Loss: 2.167 Test Acc: 0.184
Validation loss decreased (-0.124302 --> -0.183762).  Saving model ...
Epoch: 3 cost time: 0.89225172996521
Epoch: 3, Steps: 17 | Train Loss: 2.057 Vali Loss: 2.075 Vali Acc: 0.278 Test Loss: 2.075 Test Acc: 0.278
Validation loss decreased (-0.183762 --> -0.278358).  Saving model ...
Epoch: 4 cost time: 1.0659394264221191
Epoch: 4, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.972 Vali Acc: 0.435 Test Loss: 1.972 Test Acc: 0.435
Validation loss decreased (-0.278358 --> -0.435115).  Saving model ...
Epoch: 5 cost time: 1.0751798152923584
Epoch: 5, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.862 Vali Acc: 0.557 Test Loss: 1.862 Test Acc: 0.557
Validation loss decreased (-0.435115 --> -0.556738).  Saving model ...
Epoch: 6 cost time: 0.9490509033203125
Epoch: 6, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.739 Vali Acc: 0.657 Test Loss: 1.739 Test Acc: 0.657
Validation loss decreased (-0.556738 --> -0.656739).  Saving model ...
Epoch: 7 cost time: 1.0249953269958496
Epoch: 7, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.622 Vali Acc: 0.722 Test Loss: 1.622 Test Acc: 0.722
Validation loss decreased (-0.656739 --> -0.721605).  Saving model ...
Epoch: 8 cost time: 1.1275115013122559
Epoch: 8, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.501 Vali Acc: 0.757 Test Loss: 1.501 Test Acc: 0.757
Validation loss decreased (-0.721605 --> -0.756742).  Saving model ...
Epoch: 9 cost time: 1.0244152545928955
Epoch: 9, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.372 Vali Acc: 0.795 Test Loss: 1.372 Test Acc: 0.795
Validation loss decreased (-0.756742 --> -0.794581).  Saving model ...
Epoch: 10 cost time: 0.960582971572876
Epoch: 10, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.257 Vali Acc: 0.816 Test Loss: 1.257 Test Acc: 0.816
Validation loss decreased (-0.794581 --> -0.816204).  Saving model ...
Epoch: 11 cost time: 1.1530942916870117
Epoch: 11, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.153 Vali Acc: 0.824 Test Loss: 1.153 Test Acc: 0.824
Validation loss decreased (-0.816204 --> -0.824313).  Saving model ...
Epoch: 12 cost time: 1.2500622272491455
Epoch: 12, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.052 Vali Acc: 0.849 Test Loss: 1.052 Test Acc: 0.849
Validation loss decreased (-0.824313 --> -0.848638).  Saving model ...
Epoch: 13 cost time: 1.2425799369812012
Epoch: 13, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.967 Vali Acc: 0.846 Test Loss: 0.967 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1287646293640137
Epoch: 14, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.884 Vali Acc: 0.859 Test Loss: 0.884 Test Acc: 0.859
Validation loss decreased (-0.848638 --> -0.859451).  Saving model ...
Epoch: 15 cost time: 1.2493975162506104
Epoch: 15, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.815 Vali Acc: 0.876 Test Loss: 0.815 Test Acc: 0.876
Validation loss decreased (-0.859451 --> -0.875668).  Saving model ...
Epoch: 16 cost time: 1.1993379592895508
Epoch: 16, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.757 Vali Acc: 0.878 Test Loss: 0.757 Test Acc: 0.878
Validation loss decreased (-0.875668 --> -0.878371).  Saving model ...
Epoch: 17 cost time: 1.0322177410125732
Epoch: 17, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.712 Vali Acc: 0.878 Test Loss: 0.712 Test Acc: 0.878
Validation loss decreased (-0.878371 --> -0.878371).  Saving model ...
Epoch: 18 cost time: 1.0071847438812256
Epoch: 18, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.657 Vali Acc: 0.881 Test Loss: 0.657 Test Acc: 0.881
Validation loss decreased (-0.878371 --> -0.881075).  Saving model ...
Epoch: 19 cost time: 1.0525097846984863
Epoch: 19, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.615 Vali Acc: 0.886 Test Loss: 0.615 Test Acc: 0.886
Validation loss decreased (-0.881075 --> -0.886480).  Saving model ...
Epoch: 20 cost time: 1.1013860702514648
Epoch: 20, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.575 Vali Acc: 0.886 Test Loss: 0.575 Test Acc: 0.886
Validation loss decreased (-0.886480 --> -0.886481).  Saving model ...
Epoch: 21 cost time: 1.0658588409423828
Epoch: 21, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.536 Vali Acc: 0.905 Test Loss: 0.536 Test Acc: 0.905
Validation loss decreased (-0.886481 --> -0.905400).  Saving model ...
Epoch: 22 cost time: 0.9503686428070068
Epoch: 22, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.905400 --> -0.910806).  Saving model ...
Epoch: 23 cost time: 1.1078624725341797
Epoch: 23, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.483 Vali Acc: 0.903 Test Loss: 0.483 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0543761253356934
Epoch: 24, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.455 Vali Acc: 0.916 Test Loss: 0.455 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916212).  Saving model ...
Epoch: 25 cost time: 1.0607082843780518
Epoch: 25, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.435 Vali Acc: 0.919 Test Loss: 0.435 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 26 cost time: 1.0250627994537354
Epoch: 26, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.419 Vali Acc: 0.916 Test Loss: 0.419 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1619911193847656
Epoch: 27, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.397 Vali Acc: 0.916 Test Loss: 0.397 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3435964584350586
Epoch: 28, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.380 Vali Acc: 0.914 Test Loss: 0.380 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0992608070373535
Epoch: 29, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 30 cost time: 1.1748731136322021
Epoch: 30, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.350 Vali Acc: 0.924 Test Loss: 0.350 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924321).  Saving model ...
Epoch: 31 cost time: 0.9860386848449707
Epoch: 31, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9470198154449463
Epoch: 32, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.324 Vali Acc: 0.930 Test Loss: 0.324 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929726).  Saving model ...
Epoch: 33 cost time: 1.1491334438323975
Epoch: 33, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.318 Vali Acc: 0.932 Test Loss: 0.318 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 34 cost time: 1.0980210304260254
Epoch: 34, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.309 Vali Acc: 0.924 Test Loss: 0.309 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9135851860046387
Epoch: 35, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.297 Vali Acc: 0.935 Test Loss: 0.297 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 36 cost time: 1.1234266757965088
Epoch: 36, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0895662307739258
Epoch: 37, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0443124771118164
Epoch: 38, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0564849376678467
Epoch: 39, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 40 cost time: 1.1391608715057373
Epoch: 40, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1510429382324219
Epoch: 41, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 42 cost time: 0.9784910678863525
Epoch: 42, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.258 Vali Acc: 0.938 Test Loss: 0.258 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9902009963989258
Epoch: 43, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 44 cost time: 0.9815597534179688
Epoch: 44, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.248 Vali Acc: 0.938 Test Loss: 0.248 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3168723583221436
Epoch: 45, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 46 cost time: 1.127089262008667
Epoch: 46, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.136305332183838
Epoch: 47, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1540303230285645
Epoch: 48, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3216357231140137
Epoch: 49, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.236 Vali Acc: 0.938 Test Loss: 0.236 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0133850574493408
Epoch: 50, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.938 Test Loss: 0.226 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2508080005645752
Epoch: 51, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.224 Vali Acc: 0.938 Test Loss: 0.224 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0658564567565918
Epoch: 52, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1194777488708496
Epoch: 53, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.2607812881469727
Epoch: 54, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.1919136047363281
Epoch: 55, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 35239
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7081551551818848
Epoch: 1, Steps: 17 | Train Loss: 2.230 Vali Loss: 2.216 Vali Acc: 0.119 Test Loss: 2.216 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 1.1951556205749512
Epoch: 2, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.145 Vali Acc: 0.170 Test Loss: 2.145 Test Acc: 0.170
Validation loss decreased (-0.118897 --> -0.170249).  Saving model ...
Epoch: 3 cost time: 1.316798210144043
Epoch: 3, Steps: 17 | Train Loss: 2.071 Vali Loss: 2.051 Vali Acc: 0.286 Test Loss: 2.051 Test Acc: 0.286
Validation loss decreased (-0.170249 --> -0.286466).  Saving model ...
Epoch: 4 cost time: 1.080629587173462
Epoch: 4, Steps: 17 | Train Loss: 1.959 Vali Loss: 1.947 Vali Acc: 0.414 Test Loss: 1.947 Test Acc: 0.414
Validation loss decreased (-0.286466 --> -0.413494).  Saving model ...
Epoch: 5 cost time: 1.1713261604309082
Epoch: 5, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.837 Vali Acc: 0.562 Test Loss: 1.837 Test Acc: 0.562
Validation loss decreased (-0.413494 --> -0.562144).  Saving model ...
Epoch: 6 cost time: 1.2436752319335938
Epoch: 6, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.717 Vali Acc: 0.673 Test Loss: 1.717 Test Acc: 0.673
Validation loss decreased (-0.562144 --> -0.672956).  Saving model ...
Epoch: 7 cost time: 1.1301074028015137
Epoch: 7, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.592 Vali Acc: 0.722 Test Loss: 1.592 Test Acc: 0.722
Validation loss decreased (-0.672956 --> -0.721606).  Saving model ...
Epoch: 8 cost time: 1.123877763748169
Epoch: 8, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.459 Vali Acc: 0.770 Test Loss: 1.459 Test Acc: 0.770
Validation loss decreased (-0.721606 --> -0.770256).  Saving model ...
Epoch: 9 cost time: 0.9670042991638184
Epoch: 9, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.334 Vali Acc: 0.797 Test Loss: 1.334 Test Acc: 0.797
Validation loss decreased (-0.770256 --> -0.797284).  Saving model ...
Epoch: 10 cost time: 1.097748041152954
Epoch: 10, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.216 Vali Acc: 0.811 Test Loss: 1.216 Test Acc: 0.811
Validation loss decreased (-0.797284 --> -0.810799).  Saving model ...
Epoch: 11 cost time: 1.0288598537445068
Epoch: 11, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.109 Vali Acc: 0.830 Test Loss: 1.109 Test Acc: 0.830
Validation loss decreased (-0.810799 --> -0.829719).  Saving model ...
Epoch: 12 cost time: 1.0940124988555908
Epoch: 12, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.006 Vali Acc: 0.846 Test Loss: 1.006 Test Acc: 0.846
Validation loss decreased (-0.829719 --> -0.845936).  Saving model ...
Epoch: 13 cost time: 1.011993646621704
Epoch: 13, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.918 Vali Acc: 0.849 Test Loss: 0.918 Test Acc: 0.849
Validation loss decreased (-0.845936 --> -0.848639).  Saving model ...
Epoch: 14 cost time: 1.3678231239318848
Epoch: 14, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.837 Vali Acc: 0.862 Test Loss: 0.837 Test Acc: 0.862
Validation loss decreased (-0.848639 --> -0.862154).  Saving model ...
Epoch: 15 cost time: 1.0720994472503662
Epoch: 15, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.764 Vali Acc: 0.881 Test Loss: 0.764 Test Acc: 0.881
Validation loss decreased (-0.862154 --> -0.881073).  Saving model ...
Epoch: 16 cost time: 1.1998677253723145
Epoch: 16, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.707 Vali Acc: 0.878 Test Loss: 0.707 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9394454956054688
Epoch: 17, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.648 Vali Acc: 0.886 Test Loss: 0.648 Test Acc: 0.886
Validation loss decreased (-0.881073 --> -0.886480).  Saving model ...
Epoch: 18 cost time: 1.1705081462860107
Epoch: 18, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
Validation loss decreased (-0.886480 --> -0.889183).  Saving model ...
Epoch: 19 cost time: 0.8787789344787598
Epoch: 19, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.889183 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 1.0270655155181885
Epoch: 20, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.533 Vali Acc: 0.903 Test Loss: 0.533 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902697).  Saving model ...
Epoch: 21 cost time: 1.047250747680664
Epoch: 21, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.502 Vali Acc: 0.911 Test Loss: 0.502 Test Acc: 0.911
Validation loss decreased (-0.902697 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 0.8778364658355713
Epoch: 22, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.468 Vali Acc: 0.916 Test Loss: 0.468 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916212).  Saving model ...
Epoch: 23 cost time: 1.1108222007751465
Epoch: 23, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.441 Vali Acc: 0.919 Test Loss: 0.441 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 24 cost time: 1.293344497680664
Epoch: 24, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.428 Vali Acc: 0.911 Test Loss: 0.428 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1048052310943604
Epoch: 25, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.408 Vali Acc: 0.919 Test Loss: 0.408 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 26 cost time: 1.6803343296051025
Epoch: 26, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 27 cost time: 1.1932387351989746
Epoch: 27, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.374 Vali Acc: 0.919 Test Loss: 0.374 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.487860918045044
Epoch: 28, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.352 Vali Acc: 0.927 Test Loss: 0.352 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 29 cost time: 1.4247117042541504
Epoch: 29, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.341 Vali Acc: 0.924 Test Loss: 0.341 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3779466152191162
Epoch: 30, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.330 Vali Acc: 0.927 Test Loss: 0.330 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 31 cost time: 1.462076187133789
Epoch: 31, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.326 Vali Acc: 0.927 Test Loss: 0.326 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 32 cost time: 1.12453031539917
Epoch: 32, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.316 Vali Acc: 0.924 Test Loss: 0.316 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3645968437194824
Epoch: 33, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.299 Vali Acc: 0.932 Test Loss: 0.299 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932429).  Saving model ...
Epoch: 34 cost time: 1.4021062850952148
Epoch: 34, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.297 Vali Acc: 0.927 Test Loss: 0.297 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6152253150939941
Epoch: 35, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.297 Vali Acc: 0.927 Test Loss: 0.297 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.476132869720459
Epoch: 36, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1091041564941406
Epoch: 37, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.282 Vali Acc: 0.924 Test Loss: 0.282 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.520833969116211
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4695911407470703
Epoch: 39, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1072769165039062
Epoch: 40, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6000540256500244
Epoch: 41, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935133).  Saving model ...
Epoch: 42 cost time: 1.3100368976593018
Epoch: 42, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.260 Vali Acc: 0.932 Test Loss: 0.260 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2816975116729736
Epoch: 43, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.576084852218628
Epoch: 44, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.253 Vali Acc: 0.932 Test Loss: 0.253 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4219074249267578
Epoch: 45, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.489184856414795
Epoch: 46, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.249 Vali Acc: 0.924 Test Loss: 0.249 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.239391565322876
Epoch: 47, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 48 cost time: 1.310863733291626
Epoch: 48, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.927 Test Loss: 0.246 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.6170389652252197
Epoch: 49, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2956695556640625
Epoch: 50, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.242 Vali Acc: 0.932 Test Loss: 0.242 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1673436164855957
Epoch: 51, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.134545087814331
Epoch: 52, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2292871475219727
Epoch: 53, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.4301166534423828
Epoch: 54, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.6813042163848877
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.3866958618164062
Epoch: 56, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.232 Vali Acc: 0.927 Test Loss: 0.232 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.139854907989502
Epoch: 57, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9351351351351351
model parameter : 34727
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9132776260375977
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.180 Vali Acc: 0.159 Test Loss: 2.180 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 1.124267578125
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.111 Vali Acc: 0.241 Test Loss: 2.111 Test Acc: 0.241
Validation loss decreased (-0.159438 --> -0.240519).  Saving model ...
Epoch: 3 cost time: 1.1120426654815674
Epoch: 3, Steps: 17 | Train Loss: 2.077 Vali Loss: 2.025 Vali Acc: 0.335 Test Loss: 2.025 Test Acc: 0.335
Validation loss decreased (-0.240519 --> -0.335115).  Saving model ...
Epoch: 4 cost time: 1.184969425201416
Epoch: 4, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.925 Vali Acc: 0.470 Test Loss: 1.925 Test Acc: 0.470
Validation loss decreased (-0.335115 --> -0.470251).  Saving model ...
Epoch: 5 cost time: 1.0016827583312988
Epoch: 5, Steps: 17 | Train Loss: 1.855 Vali Loss: 1.812 Vali Acc: 0.565 Test Loss: 1.812 Test Acc: 0.565
Validation loss decreased (-0.470251 --> -0.564847).  Saving model ...
Epoch: 6 cost time: 1.0671169757843018
Epoch: 6, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.692 Vali Acc: 0.654 Test Loss: 1.692 Test Acc: 0.654
Validation loss decreased (-0.564847 --> -0.654037).  Saving model ...
Epoch: 7 cost time: 1.1489791870117188
Epoch: 7, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.563 Vali Acc: 0.732 Test Loss: 1.563 Test Acc: 0.732
Validation loss decreased (-0.654037 --> -0.732417).  Saving model ...
Epoch: 8 cost time: 1.0747969150543213
Epoch: 8, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.438 Vali Acc: 0.814 Test Loss: 1.438 Test Acc: 0.814
Validation loss decreased (-0.732417 --> -0.813499).  Saving model ...
Epoch: 9 cost time: 1.150482177734375
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.309 Vali Acc: 0.832 Test Loss: 1.309 Test Acc: 0.832
Validation loss decreased (-0.813499 --> -0.832419).  Saving model ...
Epoch: 10 cost time: 1.0033600330352783
Epoch: 10, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.183 Vali Acc: 0.849 Test Loss: 1.183 Test Acc: 0.849
Validation loss decreased (-0.832419 --> -0.848637).  Saving model ...
Epoch: 11 cost time: 1.1581861972808838
Epoch: 11, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.075 Vali Acc: 0.868 Test Loss: 1.075 Test Acc: 0.868
Validation loss decreased (-0.848637 --> -0.867557).  Saving model ...
Epoch: 12 cost time: 1.3641490936279297
Epoch: 12, Steps: 17 | Train Loss: 0.927 Vali Loss: 0.968 Vali Acc: 0.886 Test Loss: 0.968 Test Acc: 0.886
Validation loss decreased (-0.867557 --> -0.886477).  Saving model ...
Epoch: 13 cost time: 1.2637579441070557
Epoch: 13, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.886 Vali Acc: 0.881 Test Loss: 0.886 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.047961711883545
Epoch: 14, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.798 Vali Acc: 0.889 Test Loss: 0.798 Test Acc: 0.889
Validation loss decreased (-0.886477 --> -0.889181).  Saving model ...
Epoch: 15 cost time: 1.1701667308807373
Epoch: 15, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.726 Vali Acc: 0.900 Test Loss: 0.726 Test Acc: 0.900
Validation loss decreased (-0.889181 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 1.2537102699279785
Epoch: 16, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.673 Vali Acc: 0.914 Test Loss: 0.673 Test Acc: 0.914
Validation loss decreased (-0.899993 --> -0.913507).  Saving model ...
Epoch: 17 cost time: 1.4880249500274658
Epoch: 17, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.620 Vali Acc: 0.905 Test Loss: 0.620 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.094160556793213
Epoch: 18, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.563 Vali Acc: 0.916 Test Loss: 0.563 Test Acc: 0.916
Validation loss decreased (-0.913507 --> -0.916211).  Saving model ...
Epoch: 19 cost time: 1.0562925338745117
Epoch: 19, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.520 Vali Acc: 0.927 Test Loss: 0.520 Test Acc: 0.927
Validation loss decreased (-0.916211 --> -0.927022).  Saving model ...
Epoch: 20 cost time: 1.2134051322937012
Epoch: 20, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.477 Vali Acc: 0.941 Test Loss: 0.477 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940536).  Saving model ...
Epoch: 21 cost time: 1.166515827178955
Epoch: 21, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.444 Vali Acc: 0.943 Test Loss: 0.444 Test Acc: 0.943
Validation loss decreased (-0.940536 --> -0.943239).  Saving model ...
Epoch: 22 cost time: 1.5542218685150146
Epoch: 22, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.422 Vali Acc: 0.943 Test Loss: 0.422 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943239).  Saving model ...
Epoch: 23 cost time: 1.205916404724121
Epoch: 23, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.390 Vali Acc: 0.946 Test Loss: 0.390 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945942).  Saving model ...
Epoch: 24 cost time: 0.9661459922790527
Epoch: 24, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.366 Vali Acc: 0.943 Test Loss: 0.366 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.051701307296753
Epoch: 25, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.345 Vali Acc: 0.946 Test Loss: 0.345 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945942).  Saving model ...
Epoch: 26 cost time: 1.0964701175689697
Epoch: 26, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.338 Vali Acc: 0.946 Test Loss: 0.338 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
Epoch: 27 cost time: 1.0354912281036377
Epoch: 27, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.133833885192871
Epoch: 28, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.292 Vali Acc: 0.951 Test Loss: 0.292 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951348).  Saving model ...
Epoch: 29 cost time: 1.241668939590454
Epoch: 29, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2179653644561768
Epoch: 30, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.274 Vali Acc: 0.943 Test Loss: 0.274 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1749267578125
Epoch: 31, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.219879388809204
Epoch: 32, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.248 Vali Acc: 0.951 Test Loss: 0.248 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 33 cost time: 1.1607773303985596
Epoch: 33, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.247 Vali Acc: 0.954 Test Loss: 0.247 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 1.0164499282836914
Epoch: 34, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.252 Vali Acc: 0.935 Test Loss: 0.252 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1461296081542969
Epoch: 35, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.231 Vali Acc: 0.949 Test Loss: 0.231 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3403427600860596
Epoch: 36, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 37 cost time: 1.273193597793579
Epoch: 37, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.216 Vali Acc: 0.954 Test Loss: 0.216 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 1.1038269996643066
Epoch: 38, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0857369899749756
Epoch: 39, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 40 cost time: 1.1197490692138672
Epoch: 40, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 41 cost time: 1.1562504768371582
Epoch: 41, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0980823040008545
Epoch: 42, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 43 cost time: 0.9942331314086914
Epoch: 43, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 44 cost time: 1.1444413661956787
Epoch: 44, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 0.8899188041687012
Epoch: 45, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9971933364868164
Epoch: 46, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 47 cost time: 1.160332441329956
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9575886726379395
Epoch: 48, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0006401538848877
Epoch: 49, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8849751949310303
Epoch: 50, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0609171390533447
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.202 Vali Acc: 0.932 Test Loss: 0.202 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9614343643188477
Epoch: 52, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9855837821960449
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0570287704467773
Epoch: 54, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0468225479125977
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8971126079559326
Epoch: 56, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 34215
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8942503929138184
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.228 Vali Acc: 0.141 Test Loss: 2.228 Test Acc: 0.141
Validation loss decreased (inf --> -0.140518).  Saving model ...
Epoch: 2 cost time: 0.8154938220977783
Epoch: 2, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.155 Vali Acc: 0.203 Test Loss: 2.155 Test Acc: 0.203
Validation loss decreased (-0.140518 --> -0.202681).  Saving model ...
Epoch: 3 cost time: 0.791346549987793
Epoch: 3, Steps: 17 | Train Loss: 2.072 Vali Loss: 2.059 Vali Acc: 0.278 Test Loss: 2.059 Test Acc: 0.278
Validation loss decreased (-0.202681 --> -0.278358).  Saving model ...
Epoch: 4 cost time: 0.7838094234466553
Epoch: 4, Steps: 17 | Train Loss: 1.953 Vali Loss: 1.949 Vali Acc: 0.422 Test Loss: 1.949 Test Acc: 0.422
Validation loss decreased (-0.278358 --> -0.421602).  Saving model ...
Epoch: 5 cost time: 0.8371191024780273
Epoch: 5, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.835 Vali Acc: 0.497 Test Loss: 1.835 Test Acc: 0.497
Validation loss decreased (-0.421602 --> -0.497279).  Saving model ...
Epoch: 6 cost time: 0.8752090930938721
Epoch: 6, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.713 Vali Acc: 0.603 Test Loss: 1.713 Test Acc: 0.603
Validation loss decreased (-0.497279 --> -0.602686).  Saving model ...
Epoch: 7 cost time: 0.966331958770752
Epoch: 7, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.583 Vali Acc: 0.724 Test Loss: 1.583 Test Acc: 0.724
Validation loss decreased (-0.602686 --> -0.724308).  Saving model ...
Epoch: 8 cost time: 0.9192190170288086
Epoch: 8, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.455 Vali Acc: 0.773 Test Loss: 1.455 Test Acc: 0.773
Validation loss decreased (-0.724308 --> -0.772958).  Saving model ...
Epoch: 9 cost time: 0.8219823837280273
Epoch: 9, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.333 Vali Acc: 0.816 Test Loss: 1.333 Test Acc: 0.816
Validation loss decreased (-0.772958 --> -0.816203).  Saving model ...
Epoch: 10 cost time: 0.7982497215270996
Epoch: 10, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.213 Vali Acc: 0.822 Test Loss: 1.213 Test Acc: 0.822
Validation loss decreased (-0.816203 --> -0.821609).  Saving model ...
Epoch: 11 cost time: 0.8675065040588379
Epoch: 11, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.106 Vali Acc: 0.832 Test Loss: 1.106 Test Acc: 0.832
Validation loss decreased (-0.821609 --> -0.832421).  Saving model ...
Epoch: 12 cost time: 1.0607004165649414
Epoch: 12, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.009 Vali Acc: 0.859 Test Loss: 1.009 Test Acc: 0.859
Validation loss decreased (-0.832421 --> -0.859449).  Saving model ...
Epoch: 13 cost time: 1.1758270263671875
Epoch: 13, Steps: 17 | Train Loss: 0.841 Vali Loss: 0.927 Vali Acc: 0.870 Test Loss: 0.927 Test Acc: 0.870
Validation loss decreased (-0.859449 --> -0.870261).  Saving model ...
Epoch: 14 cost time: 1.0565462112426758
Epoch: 14, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.847 Vali Acc: 0.876 Test Loss: 0.847 Test Acc: 0.876
Validation loss decreased (-0.870261 --> -0.875667).  Saving model ...
Epoch: 15 cost time: 0.9131925106048584
Epoch: 15, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.784 Vali Acc: 0.884 Test Loss: 0.784 Test Acc: 0.884
Validation loss decreased (-0.875667 --> -0.883776).  Saving model ...
Epoch: 16 cost time: 0.9028291702270508
Epoch: 16, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.723 Vali Acc: 0.892 Test Loss: 0.723 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 17 cost time: 1.0056991577148438
Epoch: 17, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.674 Vali Acc: 0.897 Test Loss: 0.674 Test Acc: 0.897
Validation loss decreased (-0.891885 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 1.144162893295288
Epoch: 18, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.626 Vali Acc: 0.905 Test Loss: 0.626 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905399).  Saving model ...
Epoch: 19 cost time: 0.8746254444122314
Epoch: 19, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.584 Vali Acc: 0.905 Test Loss: 0.584 Test Acc: 0.905
Validation loss decreased (-0.905399 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 0.9148569107055664
Epoch: 20, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.546 Vali Acc: 0.914 Test Loss: 0.546 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913508).  Saving model ...
Epoch: 21 cost time: 0.9354615211486816
Epoch: 21, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.517 Vali Acc: 0.914 Test Loss: 0.517 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913508).  Saving model ...
Epoch: 22 cost time: 0.9345848560333252
Epoch: 22, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.496 Vali Acc: 0.914 Test Loss: 0.496 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913509).  Saving model ...
Epoch: 23 cost time: 0.997483491897583
Epoch: 23, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.463 Vali Acc: 0.919 Test Loss: 0.463 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918914).  Saving model ...
Epoch: 24 cost time: 1.0865561962127686
Epoch: 24, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.439 Vali Acc: 0.922 Test Loss: 0.439 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 25 cost time: 1.0054981708526611
Epoch: 25, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 1.2237296104431152
Epoch: 26, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.411 Vali Acc: 0.919 Test Loss: 0.411 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8726539611816406
Epoch: 27, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.373 Vali Acc: 0.935 Test Loss: 0.373 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935131).  Saving model ...
Epoch: 28 cost time: 1.0466153621673584
Epoch: 28, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9454355239868164
Epoch: 29, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.349 Vali Acc: 0.935 Test Loss: 0.349 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 30 cost time: 0.8357181549072266
Epoch: 30, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.340 Vali Acc: 0.938 Test Loss: 0.340 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937834).  Saving model ...
Epoch: 31 cost time: 0.9844872951507568
Epoch: 31, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.323 Vali Acc: 0.938 Test Loss: 0.323 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 32 cost time: 1.1041476726531982
Epoch: 32, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0034589767456055
Epoch: 33, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.309 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0845756530761719
Epoch: 34, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.306 Vali Acc: 0.932 Test Loss: 0.306 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.08319091796875
Epoch: 35, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.289 Vali Acc: 0.932 Test Loss: 0.289 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8852682113647461
Epoch: 36, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.283 Vali Acc: 0.938 Test Loss: 0.283 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 37 cost time: 1.180267333984375
Epoch: 37, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8922333717346191
Epoch: 38, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7954721450805664
Epoch: 39, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9496161937713623
Epoch: 40, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.927 Test Loss: 0.269 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9718313217163086
Epoch: 41, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.927 Test Loss: 0.259 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8142783641815186
Epoch: 42, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.271 Vali Acc: 0.927 Test Loss: 0.271 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9765100479125977
Epoch: 43, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8973853588104248
Epoch: 44, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0401513576507568
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.237 Vali Acc: 0.927 Test Loss: 0.237 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.9014794826507568
Epoch: 46, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.927 Test Loss: 0.265 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 33703
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.194636583328247
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.228 Vali Acc: 0.141 Test Loss: 2.228 Test Acc: 0.141
Validation loss decreased (inf --> -0.140518).  Saving model ...
Epoch: 2 cost time: 1.0888547897338867
Epoch: 2, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.155 Vali Acc: 0.203 Test Loss: 2.155 Test Acc: 0.203
Validation loss decreased (-0.140518 --> -0.202681).  Saving model ...
Epoch: 3 cost time: 1.1897485256195068
Epoch: 3, Steps: 17 | Train Loss: 2.072 Vali Loss: 2.059 Vali Acc: 0.278 Test Loss: 2.059 Test Acc: 0.278
Validation loss decreased (-0.202681 --> -0.278358).  Saving model ...
Epoch: 4 cost time: 0.9551610946655273
Epoch: 4, Steps: 17 | Train Loss: 1.953 Vali Loss: 1.949 Vali Acc: 0.422 Test Loss: 1.949 Test Acc: 0.422
Validation loss decreased (-0.278358 --> -0.421602).  Saving model ...
Epoch: 5 cost time: 0.9271407127380371
Epoch: 5, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.835 Vali Acc: 0.497 Test Loss: 1.835 Test Acc: 0.497
Validation loss decreased (-0.421602 --> -0.497279).  Saving model ...
Epoch: 6 cost time: 1.2425460815429688
Epoch: 6, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.713 Vali Acc: 0.603 Test Loss: 1.713 Test Acc: 0.603
Validation loss decreased (-0.497279 --> -0.602686).  Saving model ...
Epoch: 7 cost time: 1.0276954174041748
Epoch: 7, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.583 Vali Acc: 0.724 Test Loss: 1.583 Test Acc: 0.724
Validation loss decreased (-0.602686 --> -0.724308).  Saving model ...
Epoch: 8 cost time: 0.957711935043335
Epoch: 8, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.455 Vali Acc: 0.773 Test Loss: 1.455 Test Acc: 0.773
Validation loss decreased (-0.724308 --> -0.772958).  Saving model ...
Epoch: 9 cost time: 1.2459936141967773
Epoch: 9, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.333 Vali Acc: 0.816 Test Loss: 1.333 Test Acc: 0.816
Validation loss decreased (-0.772958 --> -0.816203).  Saving model ...
Epoch: 10 cost time: 0.8612494468688965
Epoch: 10, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.213 Vali Acc: 0.822 Test Loss: 1.213 Test Acc: 0.822
Validation loss decreased (-0.816203 --> -0.821609).  Saving model ...
Epoch: 11 cost time: 1.1443583965301514
Epoch: 11, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.106 Vali Acc: 0.832 Test Loss: 1.106 Test Acc: 0.832
Validation loss decreased (-0.821609 --> -0.832421).  Saving model ...
Epoch: 12 cost time: 1.2165274620056152
Epoch: 12, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.009 Vali Acc: 0.859 Test Loss: 1.009 Test Acc: 0.859
Validation loss decreased (-0.832421 --> -0.859449).  Saving model ...
Epoch: 13 cost time: 0.9538002014160156
Epoch: 13, Steps: 17 | Train Loss: 0.841 Vali Loss: 0.927 Vali Acc: 0.870 Test Loss: 0.927 Test Acc: 0.870
Validation loss decreased (-0.859449 --> -0.870261).  Saving model ...
Epoch: 14 cost time: 1.2508904933929443
Epoch: 14, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.847 Vali Acc: 0.876 Test Loss: 0.847 Test Acc: 0.876
Validation loss decreased (-0.870261 --> -0.875667).  Saving model ...
Epoch: 15 cost time: 1.092282772064209
Epoch: 15, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.784 Vali Acc: 0.884 Test Loss: 0.784 Test Acc: 0.884
Validation loss decreased (-0.875667 --> -0.883776).  Saving model ...
Epoch: 16 cost time: 1.0480833053588867
Epoch: 16, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.723 Vali Acc: 0.892 Test Loss: 0.723 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 17 cost time: 0.9652998447418213
Epoch: 17, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.674 Vali Acc: 0.897 Test Loss: 0.674 Test Acc: 0.897
Validation loss decreased (-0.891885 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 1.108307123184204
Epoch: 18, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.626 Vali Acc: 0.905 Test Loss: 0.626 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905399).  Saving model ...
Epoch: 19 cost time: 0.9857699871063232
Epoch: 19, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.584 Vali Acc: 0.905 Test Loss: 0.584 Test Acc: 0.905
Validation loss decreased (-0.905399 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 0.7630383968353271
Epoch: 20, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.546 Vali Acc: 0.914 Test Loss: 0.546 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913508).  Saving model ...
Epoch: 21 cost time: 1.0372188091278076
Epoch: 21, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.517 Vali Acc: 0.914 Test Loss: 0.517 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913508).  Saving model ...
Epoch: 22 cost time: 1.205883264541626
Epoch: 22, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.496 Vali Acc: 0.914 Test Loss: 0.496 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913509).  Saving model ...
Epoch: 23 cost time: 0.93276047706604
Epoch: 23, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.463 Vali Acc: 0.919 Test Loss: 0.463 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918914).  Saving model ...
Epoch: 24 cost time: 1.00943922996521
Epoch: 24, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.439 Vali Acc: 0.922 Test Loss: 0.439 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 25 cost time: 1.1033649444580078
Epoch: 25, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 0.945319414138794
Epoch: 26, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.411 Vali Acc: 0.919 Test Loss: 0.411 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.903843879699707
Epoch: 27, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.373 Vali Acc: 0.935 Test Loss: 0.373 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935131).  Saving model ...
Epoch: 28 cost time: 0.965118408203125
Epoch: 28, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1256351470947266
Epoch: 29, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.349 Vali Acc: 0.935 Test Loss: 0.349 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 30 cost time: 0.9831118583679199
Epoch: 30, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.340 Vali Acc: 0.938 Test Loss: 0.340 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937834).  Saving model ...
Epoch: 31 cost time: 1.052793264389038
Epoch: 31, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.323 Vali Acc: 0.938 Test Loss: 0.323 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 32 cost time: 1.011169195175171
Epoch: 32, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9938437938690186
Epoch: 33, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.309 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0945603847503662
Epoch: 34, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.306 Vali Acc: 0.932 Test Loss: 0.306 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0531980991363525
Epoch: 35, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.289 Vali Acc: 0.932 Test Loss: 0.289 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7621619701385498
Epoch: 36, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.283 Vali Acc: 0.938 Test Loss: 0.283 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 37 cost time: 0.8498210906982422
Epoch: 37, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.077401876449585
Epoch: 38, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.985403299331665
Epoch: 39, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1387794017791748
Epoch: 40, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.927 Test Loss: 0.269 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0286929607391357
Epoch: 41, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.927 Test Loss: 0.259 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1301651000976562
Epoch: 42, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.271 Vali Acc: 0.927 Test Loss: 0.271 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.110004186630249
Epoch: 43, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0362017154693604
Epoch: 44, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0386829376220703
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.237 Vali Acc: 0.927 Test Loss: 0.237 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.284369707107544
Epoch: 46, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.927 Test Loss: 0.265 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 33703
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7611217498779297
Epoch: 1, Steps: 17 | Train Loss: 2.206 Vali Loss: 2.194 Vali Acc: 0.114 Test Loss: 2.194 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 1.2270572185516357
Epoch: 2, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.125 Vali Acc: 0.230 Test Loss: 2.125 Test Acc: 0.230
Validation loss decreased (-0.113492 --> -0.229708).  Saving model ...
Epoch: 3 cost time: 1.1196990013122559
Epoch: 3, Steps: 17 | Train Loss: 2.056 Vali Loss: 2.034 Vali Acc: 0.392 Test Loss: 2.034 Test Acc: 0.392
Validation loss decreased (-0.229708 --> -0.391872).  Saving model ...
Epoch: 4 cost time: 0.9966216087341309
Epoch: 4, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.927 Vali Acc: 0.516 Test Loss: 1.927 Test Acc: 0.516
Validation loss decreased (-0.391872 --> -0.516197).  Saving model ...
Epoch: 5 cost time: 0.9078023433685303
Epoch: 5, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.809 Vali Acc: 0.635 Test Loss: 1.809 Test Acc: 0.635
Validation loss decreased (-0.516197 --> -0.635117).  Saving model ...
Epoch: 6 cost time: 0.8779711723327637
Epoch: 6, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.688 Vali Acc: 0.711 Test Loss: 1.688 Test Acc: 0.711
Validation loss decreased (-0.635117 --> -0.710794).  Saving model ...
Epoch: 7 cost time: 0.9208927154541016
Epoch: 7, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.568 Vali Acc: 0.749 Test Loss: 1.568 Test Acc: 0.749
Validation loss decreased (-0.710794 --> -0.748633).  Saving model ...
Epoch: 8 cost time: 1.0911028385162354
Epoch: 8, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.445 Vali Acc: 0.781 Test Loss: 1.445 Test Acc: 0.781
Validation loss decreased (-0.748633 --> -0.781067).  Saving model ...
Epoch: 9 cost time: 0.9713320732116699
Epoch: 9, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.329 Vali Acc: 0.797 Test Loss: 1.329 Test Acc: 0.797
Validation loss decreased (-0.781067 --> -0.797284).  Saving model ...
Epoch: 10 cost time: 0.9805634021759033
Epoch: 10, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.214 Vali Acc: 0.819 Test Loss: 1.214 Test Acc: 0.819
Validation loss decreased (-0.797284 --> -0.818907).  Saving model ...
Epoch: 11 cost time: 0.9695591926574707
Epoch: 11, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.115 Vali Acc: 0.832 Test Loss: 1.115 Test Acc: 0.832
Validation loss decreased (-0.818907 --> -0.832421).  Saving model ...
Epoch: 12 cost time: 0.8607854843139648
Epoch: 12, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.025 Vali Acc: 0.846 Test Loss: 1.025 Test Acc: 0.846
Validation loss decreased (-0.832421 --> -0.845936).  Saving model ...
Epoch: 13 cost time: 1.005958080291748
Epoch: 13, Steps: 17 | Train Loss: 0.849 Vali Loss: 0.936 Vali Acc: 0.851 Test Loss: 0.936 Test Acc: 0.851
Validation loss decreased (-0.845936 --> -0.851342).  Saving model ...
Epoch: 14 cost time: 0.983069896697998
Epoch: 14, Steps: 17 | Train Loss: 0.777 Vali Loss: 0.869 Vali Acc: 0.870 Test Loss: 0.869 Test Acc: 0.870
Validation loss decreased (-0.851342 --> -0.870262).  Saving model ...
Epoch: 15 cost time: 1.1295838356018066
Epoch: 15, Steps: 17 | Train Loss: 0.702 Vali Loss: 0.801 Vali Acc: 0.873 Test Loss: 0.801 Test Acc: 0.873
Validation loss decreased (-0.870262 --> -0.872965).  Saving model ...
Epoch: 16 cost time: 1.0900075435638428
Epoch: 16, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.742 Vali Acc: 0.870 Test Loss: 0.742 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9463286399841309
Epoch: 17, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.690 Vali Acc: 0.881 Test Loss: 0.690 Test Acc: 0.881
Validation loss decreased (-0.872965 --> -0.881074).  Saving model ...
Epoch: 18 cost time: 1.172987937927246
Epoch: 18, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.653 Vali Acc: 0.884 Test Loss: 0.653 Test Acc: 0.884
Validation loss decreased (-0.881074 --> -0.883777).  Saving model ...
Epoch: 19 cost time: 1.1143510341644287
Epoch: 19, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.607 Vali Acc: 0.892 Test Loss: 0.607 Test Acc: 0.892
Validation loss decreased (-0.883777 --> -0.891886).  Saving model ...
Epoch: 20 cost time: 1.095343828201294
Epoch: 20, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
Validation loss decreased (-0.891886 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 1.1270546913146973
Epoch: 21, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.535 Vali Acc: 0.905 Test Loss: 0.535 Test Acc: 0.905
Validation loss decreased (-0.899994 --> -0.905400).  Saving model ...
Epoch: 22 cost time: 1.0973377227783203
Epoch: 22, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.504 Vali Acc: 0.908 Test Loss: 0.504 Test Acc: 0.908
Validation loss decreased (-0.905400 --> -0.908103).  Saving model ...
Epoch: 23 cost time: 1.235097885131836
Epoch: 23, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.478 Vali Acc: 0.919 Test Loss: 0.478 Test Acc: 0.919
Validation loss decreased (-0.908103 --> -0.918914).  Saving model ...
Epoch: 24 cost time: 1.1137728691101074
Epoch: 24, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.457 Vali Acc: 0.916 Test Loss: 0.457 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1093287467956543
Epoch: 25, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.433 Vali Acc: 0.919 Test Loss: 0.433 Test Acc: 0.919
Validation loss decreased (-0.918914 --> -0.918915).  Saving model ...
Epoch: 26 cost time: 1.0765016078948975
Epoch: 26, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.421 Vali Acc: 0.914 Test Loss: 0.421 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0575194358825684
Epoch: 27, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.395 Vali Acc: 0.914 Test Loss: 0.395 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3159987926483154
Epoch: 28, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 29 cost time: 1.1931042671203613
Epoch: 29, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.372 Vali Acc: 0.916 Test Loss: 0.372 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.018582820892334
Epoch: 30, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.350 Vali Acc: 0.924 Test Loss: 0.350 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 31 cost time: 1.129115104675293
Epoch: 31, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.346 Vali Acc: 0.919 Test Loss: 0.346 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0829048156738281
Epoch: 32, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2932465076446533
Epoch: 33, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.330 Vali Acc: 0.916 Test Loss: 0.330 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0400960445404053
Epoch: 34, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.312 Vali Acc: 0.924 Test Loss: 0.312 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 35 cost time: 1.2060761451721191
Epoch: 35, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.306 Vali Acc: 0.919 Test Loss: 0.306 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1137926578521729
Epoch: 36, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929727).  Saving model ...
Epoch: 37 cost time: 1.120115041732788
Epoch: 37, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9612805843353271
Epoch: 38, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.135225772857666
Epoch: 39, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1002295017242432
Epoch: 40, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.264 Vali Acc: 0.927 Test Loss: 0.264 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.177640676498413
Epoch: 41, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9891459941864014
Epoch: 42, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.260 Vali Acc: 0.927 Test Loss: 0.260 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1237201690673828
Epoch: 43, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.263 Vali Acc: 0.924 Test Loss: 0.263 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2137680053710938
Epoch: 44, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9988498687744141
Epoch: 45, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0685975551605225
Epoch: 46, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.252 Vali Acc: 0.927 Test Loss: 0.252 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9297297297297298
model parameter : 35139
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5346591472625732
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.170 Vali Acc: 0.173 Test Loss: 2.170 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 1.1044483184814453
Epoch: 2, Steps: 17 | Train Loss: 2.133 Vali Loss: 2.102 Vali Acc: 0.232 Test Loss: 2.102 Test Acc: 0.232
Validation loss decreased (-0.172951 --> -0.232411).  Saving model ...
Epoch: 3 cost time: 1.2732410430908203
Epoch: 3, Steps: 17 | Train Loss: 2.051 Vali Loss: 2.018 Vali Acc: 0.365 Test Loss: 2.018 Test Acc: 0.365
Validation loss decreased (-0.232411 --> -0.364845).  Saving model ...
Epoch: 4 cost time: 1.0061683654785156
Epoch: 4, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.915 Vali Acc: 0.530 Test Loss: 1.915 Test Acc: 0.530
Validation loss decreased (-0.364845 --> -0.529711).  Saving model ...
Epoch: 5 cost time: 1.2892136573791504
Epoch: 5, Steps: 17 | Train Loss: 1.825 Vali Loss: 1.808 Vali Acc: 0.665 Test Loss: 1.808 Test Acc: 0.665
Validation loss decreased (-0.529711 --> -0.664847).  Saving model ...
Epoch: 6 cost time: 1.071044921875
Epoch: 6, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.687 Vali Acc: 0.754 Test Loss: 1.687 Test Acc: 0.754
Validation loss decreased (-0.664847 --> -0.754037).  Saving model ...
Epoch: 7 cost time: 1.0665550231933594
Epoch: 7, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.570 Vali Acc: 0.776 Test Loss: 1.570 Test Acc: 0.776
Validation loss decreased (-0.754037 --> -0.775660).  Saving model ...
Epoch: 8 cost time: 1.2120552062988281
Epoch: 8, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.448 Vali Acc: 0.805 Test Loss: 1.448 Test Acc: 0.805
Validation loss decreased (-0.775660 --> -0.805391).  Saving model ...
Epoch: 9 cost time: 1.0531909465789795
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.332 Vali Acc: 0.824 Test Loss: 1.332 Test Acc: 0.824
Validation loss decreased (-0.805391 --> -0.824311).  Saving model ...
Epoch: 10 cost time: 0.8730933666229248
Epoch: 10, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.226 Vali Acc: 0.835 Test Loss: 1.226 Test Acc: 0.835
Validation loss decreased (-0.824311 --> -0.835123).  Saving model ...
Epoch: 11 cost time: 1.0624825954437256
Epoch: 11, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.120 Vali Acc: 0.854 Test Loss: 1.120 Test Acc: 0.854
Validation loss decreased (-0.835123 --> -0.854043).  Saving model ...
Epoch: 12 cost time: 1.2454078197479248
Epoch: 12, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.023 Vali Acc: 0.862 Test Loss: 1.023 Test Acc: 0.862
Validation loss decreased (-0.854043 --> -0.862152).  Saving model ...
Epoch: 13 cost time: 1.1581993103027344
Epoch: 13, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.941 Vali Acc: 0.862 Test Loss: 0.941 Test Acc: 0.862
Validation loss decreased (-0.862152 --> -0.862153).  Saving model ...
Epoch: 14 cost time: 0.9841187000274658
Epoch: 14, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.866 Vali Acc: 0.868 Test Loss: 0.866 Test Acc: 0.868
Validation loss decreased (-0.862153 --> -0.867559).  Saving model ...
Epoch: 15 cost time: 1.2813329696655273
Epoch: 15, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.793 Vali Acc: 0.884 Test Loss: 0.793 Test Acc: 0.884
Validation loss decreased (-0.867559 --> -0.883776).  Saving model ...
Epoch: 16 cost time: 1.1285128593444824
Epoch: 16, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.738 Vali Acc: 0.881 Test Loss: 0.738 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2234206199645996
Epoch: 17, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.678 Vali Acc: 0.897 Test Loss: 0.678 Test Acc: 0.897
Validation loss decreased (-0.883776 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 0.998964786529541
Epoch: 18, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.640 Vali Acc: 0.897 Test Loss: 0.640 Test Acc: 0.897
Validation loss decreased (-0.897291 --> -0.897291).  Saving model ...
Epoch: 19 cost time: 0.9112262725830078
Epoch: 19, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
Validation loss decreased (-0.897291 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.9468660354614258
Epoch: 20, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.558 Vali Acc: 0.903 Test Loss: 0.558 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902697).  Saving model ...
Epoch: 21 cost time: 0.9807298183441162
Epoch: 21, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.524 Vali Acc: 0.905 Test Loss: 0.524 Test Acc: 0.905
Validation loss decreased (-0.902697 --> -0.905400).  Saving model ...
Epoch: 22 cost time: 1.138188362121582
Epoch: 22, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.487 Vali Acc: 0.908 Test Loss: 0.487 Test Acc: 0.908
Validation loss decreased (-0.905400 --> -0.908103).  Saving model ...
Epoch: 23 cost time: 1.135817289352417
Epoch: 23, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.466 Vali Acc: 0.914 Test Loss: 0.466 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 24 cost time: 1.2057652473449707
Epoch: 24, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.443 Vali Acc: 0.924 Test Loss: 0.443 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924320).  Saving model ...
Epoch: 25 cost time: 1.3060352802276611
Epoch: 25, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.416 Vali Acc: 0.927 Test Loss: 0.416 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 26 cost time: 1.0780444145202637
Epoch: 26, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0718190670013428
Epoch: 27, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.382 Vali Acc: 0.927 Test Loss: 0.382 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 28 cost time: 1.1111891269683838
Epoch: 28, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.364 Vali Acc: 0.927 Test Loss: 0.364 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 29 cost time: 1.22287917137146
Epoch: 29, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.359 Vali Acc: 0.932 Test Loss: 0.359 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 30 cost time: 1.2863497734069824
Epoch: 30, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.329 Vali Acc: 0.943 Test Loss: 0.329 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943240).  Saving model ...
Epoch: 31 cost time: 1.0072712898254395
Epoch: 31, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.326 Vali Acc: 0.938 Test Loss: 0.326 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0890898704528809
Epoch: 32, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2393889427185059
Epoch: 33, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2109875679016113
Epoch: 34, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.292 Vali Acc: 0.946 Test Loss: 0.292 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 35 cost time: 1.0164339542388916
Epoch: 35, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.276 Vali Acc: 0.943 Test Loss: 0.276 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.090332269668579
Epoch: 36, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.270 Vali Acc: 0.946 Test Loss: 0.270 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 37 cost time: 1.2065715789794922
Epoch: 37, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.270 Vali Acc: 0.932 Test Loss: 0.270 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2052679061889648
Epoch: 38, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.259 Vali Acc: 0.943 Test Loss: 0.259 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2621500492095947
Epoch: 39, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1758785247802734
Epoch: 40, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2978968620300293
Epoch: 41, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.244 Vali Acc: 0.951 Test Loss: 0.244 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 42 cost time: 1.170590877532959
Epoch: 42, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.246 Vali Acc: 0.943 Test Loss: 0.246 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1536915302276611
Epoch: 43, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4159924983978271
Epoch: 44, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.230 Vali Acc: 0.946 Test Loss: 0.230 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0981345176696777
Epoch: 45, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.482933759689331
Epoch: 46, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 47 cost time: 1.314950704574585
Epoch: 47, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 48 cost time: 1.1949365139007568
Epoch: 48, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1894166469573975
Epoch: 49, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.4053115844726562
Epoch: 50, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2421278953552246
Epoch: 51, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 52 cost time: 1.1130774021148682
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0971338748931885
Epoch: 53, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1093859672546387
Epoch: 54, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.223867416381836
Epoch: 55, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.0617125034332275
Epoch: 56, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1539466381072998
Epoch: 57, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2040467262268066
Epoch: 58, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9294958114624023
Epoch: 59, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.0573511123657227
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1508173942565918
Epoch: 61, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 34627
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.055117130279541
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.218 Vali Acc: 0.105 Test Loss: 2.218 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 0.9490008354187012
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.156 Vali Acc: 0.149 Test Loss: 2.156 Test Acc: 0.149
Validation loss decreased (-0.105383 --> -0.148627).  Saving model ...
Epoch: 3 cost time: 1.043670654296875
Epoch: 3, Steps: 17 | Train Loss: 2.085 Vali Loss: 2.077 Vali Acc: 0.268 Test Loss: 2.077 Test Acc: 0.268
Validation loss decreased (-0.148627 --> -0.267547).  Saving model ...
Epoch: 4 cost time: 0.8089525699615479
Epoch: 4, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.986 Vali Acc: 0.381 Test Loss: 1.986 Test Acc: 0.381
Validation loss decreased (-0.267547 --> -0.381061).  Saving model ...
Epoch: 5 cost time: 0.994544506072998
Epoch: 5, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.883 Vali Acc: 0.508 Test Loss: 1.883 Test Acc: 0.508
Validation loss decreased (-0.381061 --> -0.508089).  Saving model ...
Epoch: 6 cost time: 0.8287744522094727
Epoch: 6, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.781 Vali Acc: 0.611 Test Loss: 1.781 Test Acc: 0.611
Validation loss decreased (-0.508089 --> -0.610793).  Saving model ...
Epoch: 7 cost time: 0.8795065879821777
Epoch: 7, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.669 Vali Acc: 0.703 Test Loss: 1.669 Test Acc: 0.703
Validation loss decreased (-0.610793 --> -0.702686).  Saving model ...
Epoch: 8 cost time: 1.0195684432983398
Epoch: 8, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.553 Vali Acc: 0.754 Test Loss: 1.553 Test Acc: 0.754
Validation loss decreased (-0.702686 --> -0.754039).  Saving model ...
Epoch: 9 cost time: 0.943854570388794
Epoch: 9, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.436 Vali Acc: 0.786 Test Loss: 1.436 Test Acc: 0.786
Validation loss decreased (-0.754039 --> -0.786472).  Saving model ...
Epoch: 10 cost time: 0.8180868625640869
Epoch: 10, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.322 Vali Acc: 0.805 Test Loss: 1.322 Test Acc: 0.805
Validation loss decreased (-0.786472 --> -0.805392).  Saving model ...
Epoch: 11 cost time: 1.006765604019165
Epoch: 11, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.211 Vali Acc: 0.816 Test Loss: 1.211 Test Acc: 0.816
Validation loss decreased (-0.805392 --> -0.816204).  Saving model ...
Epoch: 12 cost time: 0.900937557220459
Epoch: 12, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.104 Vali Acc: 0.838 Test Loss: 1.104 Test Acc: 0.838
Validation loss decreased (-0.816204 --> -0.837827).  Saving model ...
Epoch: 13 cost time: 0.8318631649017334
Epoch: 13, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.010 Vali Acc: 0.835 Test Loss: 1.010 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9632878303527832
Epoch: 14, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.923 Vali Acc: 0.846 Test Loss: 0.923 Test Acc: 0.846
Validation loss decreased (-0.837827 --> -0.845937).  Saving model ...
Epoch: 15 cost time: 0.8186783790588379
Epoch: 15, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.845 Vali Acc: 0.857 Test Loss: 0.845 Test Acc: 0.857
Validation loss decreased (-0.845937 --> -0.856748).  Saving model ...
Epoch: 16 cost time: 0.8449761867523193
Epoch: 16, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.782 Vali Acc: 0.868 Test Loss: 0.782 Test Acc: 0.868
Validation loss decreased (-0.856748 --> -0.867560).  Saving model ...
Epoch: 17 cost time: 1.0116119384765625
Epoch: 17, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.719 Vali Acc: 0.876 Test Loss: 0.719 Test Acc: 0.876
Validation loss decreased (-0.867560 --> -0.875668).  Saving model ...
Epoch: 18 cost time: 0.9401412010192871
Epoch: 18, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.664 Vali Acc: 0.889 Test Loss: 0.664 Test Acc: 0.889
Validation loss decreased (-0.875668 --> -0.889183).  Saving model ...
Epoch: 19 cost time: 1.0360743999481201
Epoch: 19, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.615 Vali Acc: 0.895 Test Loss: 0.615 Test Acc: 0.895
Validation loss decreased (-0.889183 --> -0.894588).  Saving model ...
Epoch: 20 cost time: 1.0116543769836426
Epoch: 20, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.573 Vali Acc: 0.908 Test Loss: 0.573 Test Acc: 0.908
Validation loss decreased (-0.894588 --> -0.908102).  Saving model ...
Epoch: 21 cost time: 0.8691937923431396
Epoch: 21, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.534 Vali Acc: 0.911 Test Loss: 0.534 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 22 cost time: 0.9131531715393066
Epoch: 22, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.493 Vali Acc: 0.919 Test Loss: 0.493 Test Acc: 0.919
Validation loss decreased (-0.910805 --> -0.918914).  Saving model ...
Epoch: 23 cost time: 0.9131555557250977
Epoch: 23, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.472 Vali Acc: 0.919 Test Loss: 0.472 Test Acc: 0.919
Validation loss decreased (-0.918914 --> -0.918914).  Saving model ...
Epoch: 24 cost time: 1.1800804138183594
Epoch: 24, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.440 Vali Acc: 0.927 Test Loss: 0.440 Test Acc: 0.927
Validation loss decreased (-0.918914 --> -0.927023).  Saving model ...
Epoch: 25 cost time: 0.9341456890106201
Epoch: 25, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.419 Vali Acc: 0.924 Test Loss: 0.419 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9218361377716064
Epoch: 26, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.401 Vali Acc: 0.938 Test Loss: 0.401 Test Acc: 0.938
Validation loss decreased (-0.927023 --> -0.937834).  Saving model ...
Epoch: 27 cost time: 0.900158166885376
Epoch: 27, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.371 Vali Acc: 0.938 Test Loss: 0.371 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 28 cost time: 0.884833574295044
Epoch: 28, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.368 Vali Acc: 0.935 Test Loss: 0.368 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2919940948486328
Epoch: 29, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.345 Vali Acc: 0.938 Test Loss: 0.345 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 30 cost time: 1.1978580951690674
Epoch: 30, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.334 Vali Acc: 0.943 Test Loss: 0.334 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 31 cost time: 1.3287620544433594
Epoch: 31, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2018287181854248
Epoch: 32, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.317 Vali Acc: 0.935 Test Loss: 0.317 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.211341381072998
Epoch: 33, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.307 Vali Acc: 0.943 Test Loss: 0.307 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 34 cost time: 1.112015724182129
Epoch: 34, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8986055850982666
Epoch: 35, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.250014305114746
Epoch: 36, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.160707950592041
Epoch: 37, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.274 Vali Acc: 0.946 Test Loss: 0.274 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 38 cost time: 1.3457159996032715
Epoch: 38, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.271 Vali Acc: 0.946 Test Loss: 0.271 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 39 cost time: 0.853219747543335
Epoch: 39, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1178462505340576
Epoch: 40, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.976466178894043
Epoch: 41, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8996386528015137
Epoch: 42, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.255 Vali Acc: 0.938 Test Loss: 0.255 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8993861675262451
Epoch: 43, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9385232925415039
Epoch: 44, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.255 Vali Acc: 0.935 Test Loss: 0.255 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9021298885345459
Epoch: 45, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0159897804260254
Epoch: 46, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0592703819274902
Epoch: 47, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9567131996154785
Epoch: 48, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 34115
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.496342897415161
Epoch: 1, Steps: 17 | Train Loss: 2.244 Vali Loss: 2.130 Vali Acc: 0.295 Test Loss: 2.130 Test Acc: 0.295
Validation loss decreased (inf --> -0.294573).  Saving model ...
Epoch: 2 cost time: 1.0981850624084473
Epoch: 2, Steps: 17 | Train Loss: 2.202 Vali Loss: 2.070 Vali Acc: 0.332 Test Loss: 2.070 Test Acc: 0.332
Validation loss decreased (-0.294573 --> -0.332412).  Saving model ...
Epoch: 3 cost time: 0.8294968605041504
Epoch: 3, Steps: 17 | Train Loss: 2.123 Vali Loss: 1.991 Vali Acc: 0.408 Test Loss: 1.991 Test Acc: 0.408
Validation loss decreased (-0.332412 --> -0.408088).  Saving model ...
Epoch: 4 cost time: 0.8955554962158203
Epoch: 4, Steps: 17 | Train Loss: 2.007 Vali Loss: 1.900 Vali Acc: 0.541 Test Loss: 1.900 Test Acc: 0.541
Validation loss decreased (-0.408088 --> -0.540522).  Saving model ...
Epoch: 5 cost time: 1.1087579727172852
Epoch: 5, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.800 Vali Acc: 0.651 Test Loss: 1.800 Test Acc: 0.651
Validation loss decreased (-0.540522 --> -0.651333).  Saving model ...
Epoch: 6 cost time: 0.7941641807556152
Epoch: 6, Steps: 17 | Train Loss: 1.771 Vali Loss: 1.692 Vali Acc: 0.719 Test Loss: 1.692 Test Acc: 0.719
Validation loss decreased (-0.651333 --> -0.718902).  Saving model ...
Epoch: 7 cost time: 0.81485915184021
Epoch: 7, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.577 Vali Acc: 0.795 Test Loss: 1.577 Test Acc: 0.795
Validation loss decreased (-0.718902 --> -0.794579).  Saving model ...
Epoch: 8 cost time: 0.8608736991882324
Epoch: 8, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.453 Vali Acc: 0.822 Test Loss: 1.453 Test Acc: 0.822
Validation loss decreased (-0.794579 --> -0.821607).  Saving model ...
Epoch: 9 cost time: 0.9349563121795654
Epoch: 9, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.336 Vali Acc: 0.841 Test Loss: 1.336 Test Acc: 0.841
Validation loss decreased (-0.821607 --> -0.840527).  Saving model ...
Epoch: 10 cost time: 0.8793656826019287
Epoch: 10, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.216 Vali Acc: 0.849 Test Loss: 1.216 Test Acc: 0.849
Validation loss decreased (-0.840527 --> -0.848636).  Saving model ...
Epoch: 11 cost time: 0.9329195022583008
Epoch: 11, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.107 Vali Acc: 0.859 Test Loss: 1.107 Test Acc: 0.859
Validation loss decreased (-0.848636 --> -0.859448).  Saving model ...
Epoch: 12 cost time: 0.8012251853942871
Epoch: 12, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.011 Vali Acc: 0.862 Test Loss: 1.011 Test Acc: 0.862
Validation loss decreased (-0.859448 --> -0.862152).  Saving model ...
Epoch: 13 cost time: 0.9222302436828613
Epoch: 13, Steps: 17 | Train Loss: 0.872 Vali Loss: 0.921 Vali Acc: 0.870 Test Loss: 0.921 Test Acc: 0.870
Validation loss decreased (-0.862152 --> -0.870261).  Saving model ...
Epoch: 14 cost time: 0.893310546875
Epoch: 14, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.848 Vali Acc: 0.876 Test Loss: 0.848 Test Acc: 0.876
Validation loss decreased (-0.870261 --> -0.875667).  Saving model ...
Epoch: 15 cost time: 1.1274490356445312
Epoch: 15, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.785 Vali Acc: 0.884 Test Loss: 0.785 Test Acc: 0.884
Validation loss decreased (-0.875667 --> -0.883776).  Saving model ...
Epoch: 16 cost time: 0.9422872066497803
Epoch: 16, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.733 Vali Acc: 0.878 Test Loss: 0.733 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.920769214630127
Epoch: 17, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.676 Vali Acc: 0.892 Test Loss: 0.676 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 18 cost time: 0.9111313819885254
Epoch: 18, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.636 Vali Acc: 0.892 Test Loss: 0.636 Test Acc: 0.892
Validation loss decreased (-0.891885 --> -0.891886).  Saving model ...
Epoch: 19 cost time: 0.9920082092285156
Epoch: 19, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.600 Vali Acc: 0.897 Test Loss: 0.600 Test Acc: 0.897
Validation loss decreased (-0.891886 --> -0.897291).  Saving model ...
Epoch: 20 cost time: 1.0427658557891846
Epoch: 20, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.566 Vali Acc: 0.897 Test Loss: 0.566 Test Acc: 0.897
Validation loss decreased (-0.897291 --> -0.897292).  Saving model ...
Epoch: 21 cost time: 1.0354864597320557
Epoch: 21, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.542 Vali Acc: 0.897 Test Loss: 0.542 Test Acc: 0.897
Validation loss decreased (-0.897292 --> -0.897292).  Saving model ...
Epoch: 22 cost time: 0.9208841323852539
Epoch: 22, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.511 Vali Acc: 0.895 Test Loss: 0.511 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9319043159484863
Epoch: 23, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.897292 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.8304421901702881
Epoch: 24, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.473 Vali Acc: 0.895 Test Loss: 0.473 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7916815280914307
Epoch: 25, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.446 Vali Acc: 0.897 Test Loss: 0.446 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8669085502624512
Epoch: 26, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.437 Vali Acc: 0.897 Test Loss: 0.437 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8073382377624512
Epoch: 27, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.414 Vali Acc: 0.897 Test Loss: 0.414 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9741756916046143
Epoch: 28, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902699).  Saving model ...
Epoch: 29 cost time: 0.8389170169830322
Epoch: 29, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8081541061401367
Epoch: 30, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7812826633453369
Epoch: 31, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.376 Vali Acc: 0.895 Test Loss: 0.376 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9416840076446533
Epoch: 32, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.369 Vali Acc: 0.895 Test Loss: 0.369 Test Acc: 0.895
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7717392444610596
Epoch: 33, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.359 Vali Acc: 0.895 Test Loss: 0.359 Test Acc: 0.895
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8982787132263184
Epoch: 34, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9393715858459473
Epoch: 35, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902699 --> -0.902699).  Saving model ...
Epoch: 36 cost time: 0.7706313133239746
Epoch: 36, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.854682445526123
Epoch: 37, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.333 Vali Acc: 0.908 Test Loss: 0.333 Test Acc: 0.908
Validation loss decreased (-0.902699 --> -0.908105).  Saving model ...
Epoch: 38 cost time: 0.719444751739502
Epoch: 38, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9649302959442139
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.326 Vali Acc: 0.905 Test Loss: 0.326 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0137724876403809
Epoch: 40, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.333 Vali Acc: 0.905 Test Loss: 0.333 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9249653816223145
Epoch: 41, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.324 Vali Acc: 0.897 Test Loss: 0.324 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8918263912200928
Epoch: 42, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.320 Vali Acc: 0.905 Test Loss: 0.320 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0203042030334473
Epoch: 43, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9774634838104248
Epoch: 44, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.320 Vali Acc: 0.905 Test Loss: 0.320 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0024912357330322
Epoch: 45, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.326 Vali Acc: 0.908 Test Loss: 0.326 Test Acc: 0.908
Validation loss decreased (-0.908105 --> -0.908105).  Saving model ...
Epoch: 46 cost time: 0.8427157402038574
Epoch: 46, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9676754474639893
Epoch: 47, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.324 Vali Acc: 0.905 Test Loss: 0.324 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9441430568695068
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9029107093811035
Epoch: 49, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0076642036437988
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9066057205200195
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0681002140045166
Epoch: 52, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0206046104431152
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.320 Vali Acc: 0.895 Test Loss: 0.320 Test Acc: 0.895
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8256988525390625
Epoch: 54, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8214089870452881
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9081081081081082
model parameter : 33603
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.945573329925537
Epoch: 1, Steps: 17 | Train Loss: 2.244 Vali Loss: 2.130 Vali Acc: 0.295 Test Loss: 2.130 Test Acc: 0.295
Validation loss decreased (inf --> -0.294573).  Saving model ...
Epoch: 2 cost time: 0.8002729415893555
Epoch: 2, Steps: 17 | Train Loss: 2.202 Vali Loss: 2.070 Vali Acc: 0.332 Test Loss: 2.070 Test Acc: 0.332
Validation loss decreased (-0.294573 --> -0.332412).  Saving model ...
Epoch: 3 cost time: 1.1404221057891846
Epoch: 3, Steps: 17 | Train Loss: 2.123 Vali Loss: 1.991 Vali Acc: 0.408 Test Loss: 1.991 Test Acc: 0.408
Validation loss decreased (-0.332412 --> -0.408088).  Saving model ...
Epoch: 4 cost time: 0.8965487480163574
Epoch: 4, Steps: 17 | Train Loss: 2.007 Vali Loss: 1.900 Vali Acc: 0.541 Test Loss: 1.900 Test Acc: 0.541
Validation loss decreased (-0.408088 --> -0.540522).  Saving model ...
Epoch: 5 cost time: 0.9397473335266113
Epoch: 5, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.800 Vali Acc: 0.651 Test Loss: 1.800 Test Acc: 0.651
Validation loss decreased (-0.540522 --> -0.651333).  Saving model ...
Epoch: 6 cost time: 1.0337600708007812
Epoch: 6, Steps: 17 | Train Loss: 1.771 Vali Loss: 1.692 Vali Acc: 0.719 Test Loss: 1.692 Test Acc: 0.719
Validation loss decreased (-0.651333 --> -0.718902).  Saving model ...
Epoch: 7 cost time: 0.8163573741912842
Epoch: 7, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.577 Vali Acc: 0.795 Test Loss: 1.577 Test Acc: 0.795
Validation loss decreased (-0.718902 --> -0.794579).  Saving model ...
Epoch: 8 cost time: 1.0817890167236328
Epoch: 8, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.453 Vali Acc: 0.822 Test Loss: 1.453 Test Acc: 0.822
Validation loss decreased (-0.794579 --> -0.821607).  Saving model ...
Epoch: 9 cost time: 0.9486327171325684
Epoch: 9, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.336 Vali Acc: 0.841 Test Loss: 1.336 Test Acc: 0.841
Validation loss decreased (-0.821607 --> -0.840527).  Saving model ...
Epoch: 10 cost time: 0.9784793853759766
Epoch: 10, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.216 Vali Acc: 0.849 Test Loss: 1.216 Test Acc: 0.849
Validation loss decreased (-0.840527 --> -0.848636).  Saving model ...
Epoch: 11 cost time: 0.86141037940979
Epoch: 11, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.107 Vali Acc: 0.859 Test Loss: 1.107 Test Acc: 0.859
Validation loss decreased (-0.848636 --> -0.859448).  Saving model ...
Epoch: 12 cost time: 0.7774312496185303
Epoch: 12, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.011 Vali Acc: 0.862 Test Loss: 1.011 Test Acc: 0.862
Validation loss decreased (-0.859448 --> -0.862152).  Saving model ...
Epoch: 13 cost time: 0.9596741199493408
Epoch: 13, Steps: 17 | Train Loss: 0.872 Vali Loss: 0.921 Vali Acc: 0.870 Test Loss: 0.921 Test Acc: 0.870
Validation loss decreased (-0.862152 --> -0.870261).  Saving model ...
Epoch: 14 cost time: 0.9278895854949951
Epoch: 14, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.848 Vali Acc: 0.876 Test Loss: 0.848 Test Acc: 0.876
Validation loss decreased (-0.870261 --> -0.875667).  Saving model ...
Epoch: 15 cost time: 1.0728602409362793
Epoch: 15, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.785 Vali Acc: 0.884 Test Loss: 0.785 Test Acc: 0.884
Validation loss decreased (-0.875667 --> -0.883776).  Saving model ...
Epoch: 16 cost time: 1.2095556259155273
Epoch: 16, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.733 Vali Acc: 0.878 Test Loss: 0.733 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0519742965698242
Epoch: 17, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.676 Vali Acc: 0.892 Test Loss: 0.676 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 18 cost time: 0.8427982330322266
Epoch: 18, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.636 Vali Acc: 0.892 Test Loss: 0.636 Test Acc: 0.892
Validation loss decreased (-0.891885 --> -0.891886).  Saving model ...
Epoch: 19 cost time: 0.7785389423370361
Epoch: 19, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.600 Vali Acc: 0.897 Test Loss: 0.600 Test Acc: 0.897
Validation loss decreased (-0.891886 --> -0.897291).  Saving model ...
Epoch: 20 cost time: 0.8585655689239502
Epoch: 20, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.566 Vali Acc: 0.897 Test Loss: 0.566 Test Acc: 0.897
Validation loss decreased (-0.897291 --> -0.897292).  Saving model ...
Epoch: 21 cost time: 0.7108640670776367
Epoch: 21, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.542 Vali Acc: 0.897 Test Loss: 0.542 Test Acc: 0.897
Validation loss decreased (-0.897292 --> -0.897292).  Saving model ...
Epoch: 22 cost time: 0.8295340538024902
Epoch: 22, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.511 Vali Acc: 0.895 Test Loss: 0.511 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.838226318359375
Epoch: 23, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.897292 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.8161008358001709
Epoch: 24, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.473 Vali Acc: 0.895 Test Loss: 0.473 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.070394515991211
Epoch: 25, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.446 Vali Acc: 0.897 Test Loss: 0.446 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8188748359680176
Epoch: 26, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.437 Vali Acc: 0.897 Test Loss: 0.437 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8783984184265137
Epoch: 27, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.414 Vali Acc: 0.897 Test Loss: 0.414 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.856442928314209
Epoch: 28, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902699).  Saving model ...
Epoch: 29 cost time: 0.8011844158172607
Epoch: 29, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.81107497215271
Epoch: 30, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8075709342956543
Epoch: 31, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.376 Vali Acc: 0.895 Test Loss: 0.376 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8166871070861816
Epoch: 32, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.369 Vali Acc: 0.895 Test Loss: 0.369 Test Acc: 0.895
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9498236179351807
Epoch: 33, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.359 Vali Acc: 0.895 Test Loss: 0.359 Test Acc: 0.895
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3259267807006836
Epoch: 34, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2961206436157227
Epoch: 35, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902699 --> -0.902699).  Saving model ...
Epoch: 36 cost time: 1.0390567779541016
Epoch: 36, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9857261180877686
Epoch: 37, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.333 Vali Acc: 0.908 Test Loss: 0.333 Test Acc: 0.908
Validation loss decreased (-0.902699 --> -0.908105).  Saving model ...
Epoch: 38 cost time: 0.8855831623077393
Epoch: 38, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9883856773376465
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.326 Vali Acc: 0.905 Test Loss: 0.326 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0236883163452148
Epoch: 40, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.333 Vali Acc: 0.905 Test Loss: 0.333 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9766466617584229
Epoch: 41, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.324 Vali Acc: 0.897 Test Loss: 0.324 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1149799823760986
Epoch: 42, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.320 Vali Acc: 0.905 Test Loss: 0.320 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0678966045379639
Epoch: 43, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0543043613433838
Epoch: 44, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.320 Vali Acc: 0.905 Test Loss: 0.320 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0626311302185059
Epoch: 45, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.326 Vali Acc: 0.908 Test Loss: 0.326 Test Acc: 0.908
Validation loss decreased (-0.908105 --> -0.908105).  Saving model ...
Epoch: 46 cost time: 1.199690341949463
Epoch: 46, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9839181900024414
Epoch: 47, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.324 Vali Acc: 0.905 Test Loss: 0.324 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9931504726409912
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0573184490203857
Epoch: 49, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1172122955322266
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1157941818237305
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0490152835845947
Epoch: 52, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0700690746307373
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.320 Vali Acc: 0.895 Test Loss: 0.320 Test Acc: 0.895
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.3432104587554932
Epoch: 54, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.1502559185028076
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9081081081081082
model parameter : 33603
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9540555477142334
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.125 Vali Acc: 0.230 Test Loss: 2.125 Test Acc: 0.230
Validation loss decreased (inf --> -0.229708).  Saving model ...
Epoch: 2 cost time: 1.3435592651367188
Epoch: 2, Steps: 17 | Train Loss: 2.118 Vali Loss: 1.992 Vali Acc: 0.338 Test Loss: 1.992 Test Acc: 0.338
Validation loss decreased (-0.229708 --> -0.337818).  Saving model ...
Epoch: 3 cost time: 1.2039129734039307
Epoch: 3, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.850 Vali Acc: 0.508 Test Loss: 1.850 Test Acc: 0.508
Validation loss decreased (-0.337818 --> -0.508090).  Saving model ...
Epoch: 4 cost time: 0.9714529514312744
Epoch: 4, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.730 Vali Acc: 0.595 Test Loss: 1.730 Test Acc: 0.595
Validation loss decreased (-0.508090 --> -0.594577).  Saving model ...
Epoch: 5 cost time: 1.175187349319458
Epoch: 5, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.625 Vali Acc: 0.689 Test Loss: 1.625 Test Acc: 0.689
Validation loss decreased (-0.594577 --> -0.689173).  Saving model ...
Epoch: 6 cost time: 1.1610896587371826
Epoch: 6, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.526 Vali Acc: 0.757 Test Loss: 1.526 Test Acc: 0.757
Validation loss decreased (-0.689173 --> -0.756741).  Saving model ...
Epoch: 7 cost time: 1.1328535079956055
Epoch: 7, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.415 Vali Acc: 0.792 Test Loss: 1.415 Test Acc: 0.792
Validation loss decreased (-0.756741 --> -0.791878).  Saving model ...
Epoch: 8 cost time: 1.0770471096038818
Epoch: 8, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.319 Vali Acc: 0.805 Test Loss: 1.319 Test Acc: 0.805
Validation loss decreased (-0.791878 --> -0.805392).  Saving model ...
Epoch: 9 cost time: 1.1135895252227783
Epoch: 9, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.212 Vali Acc: 0.830 Test Loss: 1.212 Test Acc: 0.830
Validation loss decreased (-0.805392 --> -0.829718).  Saving model ...
Epoch: 10 cost time: 1.4786384105682373
Epoch: 10, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.123 Vali Acc: 0.851 Test Loss: 1.123 Test Acc: 0.851
Validation loss decreased (-0.829718 --> -0.851340).  Saving model ...
Epoch: 11 cost time: 1.174079179763794
Epoch: 11, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.031 Vali Acc: 0.854 Test Loss: 1.031 Test Acc: 0.854
Validation loss decreased (-0.851340 --> -0.854044).  Saving model ...
Epoch: 12 cost time: 1.518404245376587
Epoch: 12, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.948 Vali Acc: 0.868 Test Loss: 0.948 Test Acc: 0.868
Validation loss decreased (-0.854044 --> -0.867558).  Saving model ...
Epoch: 13 cost time: 1.1805198192596436
Epoch: 13, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.872 Vali Acc: 0.889 Test Loss: 0.872 Test Acc: 0.889
Validation loss decreased (-0.867558 --> -0.889180).  Saving model ...
Epoch: 14 cost time: 1.4928815364837646
Epoch: 14, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.807 Vali Acc: 0.884 Test Loss: 0.807 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0097918510437012
Epoch: 15, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.752 Vali Acc: 0.895 Test Loss: 0.752 Test Acc: 0.895
Validation loss decreased (-0.889180 --> -0.894587).  Saving model ...
Epoch: 16 cost time: 1.0792405605316162
Epoch: 16, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.694 Vali Acc: 0.895 Test Loss: 0.694 Test Acc: 0.895
Validation loss decreased (-0.894587 --> -0.894588).  Saving model ...
Epoch: 17 cost time: 1.1251001358032227
Epoch: 17, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.646 Vali Acc: 0.914 Test Loss: 0.646 Test Acc: 0.914
Validation loss decreased (-0.894588 --> -0.913507).  Saving model ...
Epoch: 18 cost time: 1.1196789741516113
Epoch: 18, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.593 Vali Acc: 0.916 Test Loss: 0.593 Test Acc: 0.916
Validation loss decreased (-0.913507 --> -0.916210).  Saving model ...
Epoch: 19 cost time: 1.245021104812622
Epoch: 19, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.572 Vali Acc: 0.919 Test Loss: 0.572 Test Acc: 0.919
Validation loss decreased (-0.916210 --> -0.918913).  Saving model ...
Epoch: 20 cost time: 1.317194938659668
Epoch: 20, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.526 Vali Acc: 0.922 Test Loss: 0.526 Test Acc: 0.922
Validation loss decreased (-0.918913 --> -0.921616).  Saving model ...
Epoch: 21 cost time: 1.2846763134002686
Epoch: 21, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.505 Vali Acc: 0.919 Test Loss: 0.505 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2245676517486572
Epoch: 22, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.465 Vali Acc: 0.932 Test Loss: 0.465 Test Acc: 0.932
Validation loss decreased (-0.921616 --> -0.932428).  Saving model ...
Epoch: 23 cost time: 1.2589046955108643
Epoch: 23, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4760611057281494
Epoch: 24, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.416 Vali Acc: 0.924 Test Loss: 0.416 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2865533828735352
Epoch: 25, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.403 Vali Acc: 0.935 Test Loss: 0.403 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935131).  Saving model ...
Epoch: 26 cost time: 1.1708996295928955
Epoch: 26, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.381 Vali Acc: 0.932 Test Loss: 0.381 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6606805324554443
Epoch: 27, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.372 Vali Acc: 0.924 Test Loss: 0.372 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2121286392211914
Epoch: 28, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.343 Vali Acc: 0.927 Test Loss: 0.343 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.277601957321167
Epoch: 29, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.333 Vali Acc: 0.932 Test Loss: 0.333 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1480348110198975
Epoch: 30, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.324 Vali Acc: 0.938 Test Loss: 0.324 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 31 cost time: 1.1847429275512695
Epoch: 31, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4920625686645508
Epoch: 32, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2061562538146973
Epoch: 33, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.292 Vali Acc: 0.935 Test Loss: 0.292 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3122878074645996
Epoch: 34, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.287 Vali Acc: 0.932 Test Loss: 0.287 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3180084228515625
Epoch: 35, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.272 Vali Acc: 0.932 Test Loss: 0.272 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1924796104431152
Epoch: 36, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.276 Vali Acc: 0.935 Test Loss: 0.276 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4747796058654785
Epoch: 37, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0142481327056885
Epoch: 38, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.260 Vali Acc: 0.932 Test Loss: 0.260 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3180606365203857
Epoch: 39, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 40 cost time: 1.1470136642456055
Epoch: 40, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1730561256408691
Epoch: 41, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2751634120941162
Epoch: 42, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.103712558746338
Epoch: 43, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.279655933380127
Epoch: 44, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9230167865753174
Epoch: 45, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.076817512512207
Epoch: 46, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.230 Vali Acc: 0.932 Test Loss: 0.230 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2740230560302734
Epoch: 47, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.120893955230713
Epoch: 48, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.228 Vali Acc: 0.932 Test Loss: 0.228 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2403557300567627
Epoch: 49, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 50 cost time: 1.1757168769836426
Epoch: 50, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.223 Vali Acc: 0.927 Test Loss: 0.223 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1906075477600098
Epoch: 51, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2417466640472412
Epoch: 52, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2436485290527344
Epoch: 53, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2847166061401367
Epoch: 54, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 55 cost time: 1.2653191089630127
Epoch: 55, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.205 Vali Acc: 0.938 Test Loss: 0.205 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.375096321105957
Epoch: 56, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.19600510597229
Epoch: 57, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.266021490097046
Epoch: 58, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2285363674163818
Epoch: 59, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.5096704959869385
Epoch: 60, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1289281845092773
Epoch: 61, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.198 Vali Acc: 0.932 Test Loss: 0.198 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.5792617797851562
Epoch: 62, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 63 cost time: 1.4242348670959473
Epoch: 63, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 64 cost time: 1.206592321395874
Epoch: 64, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.932 Test Loss: 0.194 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1505303382873535
Epoch: 65, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
Validation loss decreased (-0.937836 --> -0.937836).  Saving model ...
Epoch: 66 cost time: 1.129638433456421
Epoch: 66, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9727129936218262
Epoch: 67, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.932 Test Loss: 0.192 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1586458683013916
Epoch: 68, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.927 Test Loss: 0.189 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1562349796295166
Epoch: 69, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1372880935668945
Epoch: 70, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.1552824974060059
Epoch: 71, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.2040364742279053
Epoch: 72, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.932 Test Loss: 0.187 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.0917508602142334
Epoch: 73, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.2471811771392822
Epoch: 74, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.3795242309570312
Epoch: 75, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 35015
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6883325576782227
Epoch: 1, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.115 Vali Acc: 0.178 Test Loss: 2.115 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 0.8967702388763428
Epoch: 2, Steps: 17 | Train Loss: 2.092 Vali Loss: 2.007 Vali Acc: 0.341 Test Loss: 2.007 Test Acc: 0.341
Validation loss decreased (-0.178357 --> -0.340520).  Saving model ...
Epoch: 3 cost time: 0.9347374439239502
Epoch: 3, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.892 Vali Acc: 0.508 Test Loss: 1.892 Test Acc: 0.508
Validation loss decreased (-0.340520 --> -0.508089).  Saving model ...
Epoch: 4 cost time: 0.8971662521362305
Epoch: 4, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.780 Vali Acc: 0.592 Test Loss: 1.780 Test Acc: 0.592
Validation loss decreased (-0.508089 --> -0.591874).  Saving model ...
Epoch: 5 cost time: 0.9166903495788574
Epoch: 5, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.673 Vali Acc: 0.657 Test Loss: 1.673 Test Acc: 0.657
Validation loss decreased (-0.591874 --> -0.656740).  Saving model ...
Epoch: 6 cost time: 1.0885310173034668
Epoch: 6, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.563 Vali Acc: 0.714 Test Loss: 1.563 Test Acc: 0.714
Validation loss decreased (-0.656740 --> -0.713498).  Saving model ...
Epoch: 7 cost time: 1.1328327655792236
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.458 Vali Acc: 0.743 Test Loss: 1.458 Test Acc: 0.743
Validation loss decreased (-0.713498 --> -0.743229).  Saving model ...
Epoch: 8 cost time: 0.8589317798614502
Epoch: 8, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.343 Vali Acc: 0.784 Test Loss: 1.343 Test Acc: 0.784
Validation loss decreased (-0.743229 --> -0.783770).  Saving model ...
Epoch: 9 cost time: 1.1115624904632568
Epoch: 9, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.237 Vali Acc: 0.803 Test Loss: 1.237 Test Acc: 0.803
Validation loss decreased (-0.783770 --> -0.802690).  Saving model ...
Epoch: 10 cost time: 0.9635112285614014
Epoch: 10, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.143 Vali Acc: 0.841 Test Loss: 1.143 Test Acc: 0.841
Validation loss decreased (-0.802690 --> -0.840529).  Saving model ...
Epoch: 11 cost time: 0.8468923568725586
Epoch: 11, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.039 Vali Acc: 0.854 Test Loss: 1.039 Test Acc: 0.854
Validation loss decreased (-0.840529 --> -0.854044).  Saving model ...
Epoch: 12 cost time: 1.0977528095245361
Epoch: 12, Steps: 17 | Train Loss: 0.801 Vali Loss: 0.957 Vali Acc: 0.862 Test Loss: 0.957 Test Acc: 0.862
Validation loss decreased (-0.854044 --> -0.862153).  Saving model ...
Epoch: 13 cost time: 0.8836121559143066
Epoch: 13, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.886 Vali Acc: 0.873 Test Loss: 0.886 Test Acc: 0.873
Validation loss decreased (-0.862153 --> -0.872964).  Saving model ...
Epoch: 14 cost time: 1.0082507133483887
Epoch: 14, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.816 Vali Acc: 0.886 Test Loss: 0.816 Test Acc: 0.886
Validation loss decreased (-0.872964 --> -0.886478).  Saving model ...
Epoch: 15 cost time: 1.065410852432251
Epoch: 15, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.756 Vali Acc: 0.895 Test Loss: 0.756 Test Acc: 0.895
Validation loss decreased (-0.886478 --> -0.894587).  Saving model ...
Epoch: 16 cost time: 1.1152863502502441
Epoch: 16, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.707 Vali Acc: 0.895 Test Loss: 0.707 Test Acc: 0.895
Validation loss decreased (-0.894587 --> -0.894588).  Saving model ...
Epoch: 17 cost time: 0.9366519451141357
Epoch: 17, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.659 Vali Acc: 0.897 Test Loss: 0.659 Test Acc: 0.897
Validation loss decreased (-0.894588 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 1.0950605869293213
Epoch: 18, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.613 Vali Acc: 0.908 Test Loss: 0.613 Test Acc: 0.908
Validation loss decreased (-0.897291 --> -0.908102).  Saving model ...
Epoch: 19 cost time: 0.9497056007385254
Epoch: 19, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.575 Vali Acc: 0.908 Test Loss: 0.575 Test Acc: 0.908
Validation loss decreased (-0.908102 --> -0.908102).  Saving model ...
Epoch: 20 cost time: 0.9706501960754395
Epoch: 20, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.546 Vali Acc: 0.911 Test Loss: 0.546 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 21 cost time: 1.0445270538330078
Epoch: 21, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.515 Vali Acc: 0.911 Test Loss: 0.515 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 1.035829782485962
Epoch: 22, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.490 Vali Acc: 0.914 Test Loss: 0.490 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 23 cost time: 1.0275373458862305
Epoch: 23, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.466 Vali Acc: 0.916 Test Loss: 0.466 Test Acc: 0.916
Validation loss decreased (-0.913509 --> -0.916212).  Saving model ...
Epoch: 24 cost time: 1.0590660572052002
Epoch: 24, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.441 Vali Acc: 0.916 Test Loss: 0.441 Test Acc: 0.916
Validation loss decreased (-0.916212 --> -0.916212).  Saving model ...
Epoch: 25 cost time: 1.3032872676849365
Epoch: 25, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.432 Vali Acc: 0.924 Test Loss: 0.432 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 1.0806210041046143
Epoch: 26, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.395 Vali Acc: 0.930 Test Loss: 0.395 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 27 cost time: 1.0498111248016357
Epoch: 27, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.396 Vali Acc: 0.927 Test Loss: 0.396 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9931051731109619
Epoch: 28, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.376 Vali Acc: 0.930 Test Loss: 0.376 Test Acc: 0.930
Validation loss decreased (-0.929726 --> -0.929726).  Saving model ...
Epoch: 29 cost time: 1.1012401580810547
Epoch: 29, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9885413646697998
Epoch: 30, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.360 Vali Acc: 0.927 Test Loss: 0.360 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2383370399475098
Epoch: 31, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.339 Vali Acc: 0.919 Test Loss: 0.339 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.15622878074646
Epoch: 32, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.891272783279419
Epoch: 33, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.326 Vali Acc: 0.924 Test Loss: 0.326 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9618682861328125
Epoch: 34, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.315 Vali Acc: 0.924 Test Loss: 0.315 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.463632345199585
Epoch: 35, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1858704090118408
Epoch: 36, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.310 Vali Acc: 0.924 Test Loss: 0.310 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0758728981018066
Epoch: 37, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.929726 --> -0.929727).  Saving model ...
Epoch: 38 cost time: 1.2260832786560059
Epoch: 38, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0192506313323975
Epoch: 39, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 40 cost time: 0.9704124927520752
Epoch: 40, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 41 cost time: 1.1219704151153564
Epoch: 41, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.102912187576294
Epoch: 42, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0721116065979004
Epoch: 43, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.262 Vali Acc: 0.935 Test Loss: 0.262 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 44 cost time: 1.0129566192626953
Epoch: 44, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.265 Vali Acc: 0.935 Test Loss: 0.265 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.84708571434021
Epoch: 45, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 46 cost time: 1.0137367248535156
Epoch: 46, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.257 Vali Acc: 0.924 Test Loss: 0.257 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9594161510467529
Epoch: 47, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.258 Vali Acc: 0.938 Test Loss: 0.258 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1190571784973145
Epoch: 48, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.263 Vali Acc: 0.927 Test Loss: 0.263 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0083732604980469
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9829576015472412
Epoch: 50, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0515775680541992
Epoch: 51, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.253 Vali Acc: 0.938 Test Loss: 0.253 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1901190280914307
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 53 cost time: 1.0758724212646484
Epoch: 53, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.246 Vali Acc: 0.927 Test Loss: 0.246 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.06430983543396
Epoch: 54, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.246 Vali Acc: 0.927 Test Loss: 0.246 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2256245613098145
Epoch: 55, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2849700450897217
Epoch: 56, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.241 Vali Acc: 0.932 Test Loss: 0.241 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0359067916870117
Epoch: 57, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.247 Vali Acc: 0.938 Test Loss: 0.247 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9179513454437256
Epoch: 58, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.938 Test Loss: 0.235 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.0438945293426514
Epoch: 59, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.924 Test Loss: 0.235 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.3779933452606201
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.932 Test Loss: 0.234 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.0121355056762695
Epoch: 61, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.0364460945129395
Epoch: 62, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 34503
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4406354427337646
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.094 Vali Acc: 0.246 Test Loss: 2.094 Test Acc: 0.246
Validation loss decreased (inf --> -0.245925).  Saving model ...
Epoch: 2 cost time: 0.9073009490966797
Epoch: 2, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.961 Vali Acc: 0.427 Test Loss: 1.961 Test Acc: 0.427
Validation loss decreased (-0.245925 --> -0.427007).  Saving model ...
Epoch: 3 cost time: 0.9494411945343018
Epoch: 3, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.835 Vali Acc: 0.524 Test Loss: 1.835 Test Acc: 0.524
Validation loss decreased (-0.427007 --> -0.524306).  Saving model ...
Epoch: 4 cost time: 1.1175835132598877
Epoch: 4, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.715 Vali Acc: 0.673 Test Loss: 1.715 Test Acc: 0.673
Validation loss decreased (-0.524306 --> -0.672956).  Saving model ...
Epoch: 5 cost time: 1.188434362411499
Epoch: 5, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.593 Vali Acc: 0.738 Test Loss: 1.593 Test Acc: 0.738
Validation loss decreased (-0.672956 --> -0.737822).  Saving model ...
Epoch: 6 cost time: 0.8558962345123291
Epoch: 6, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.490 Vali Acc: 0.786 Test Loss: 1.490 Test Acc: 0.786
Validation loss decreased (-0.737822 --> -0.786472).  Saving model ...
Epoch: 7 cost time: 0.9156324863433838
Epoch: 7, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.363 Vali Acc: 0.819 Test Loss: 1.363 Test Acc: 0.819
Validation loss decreased (-0.786472 --> -0.818905).  Saving model ...
Epoch: 8 cost time: 0.8300244808197021
Epoch: 8, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.262 Vali Acc: 0.832 Test Loss: 1.262 Test Acc: 0.832
Validation loss decreased (-0.818905 --> -0.832420).  Saving model ...
Epoch: 9 cost time: 0.9529457092285156
Epoch: 9, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.157 Vali Acc: 0.843 Test Loss: 1.157 Test Acc: 0.843
Validation loss decreased (-0.832420 --> -0.843232).  Saving model ...
Epoch: 10 cost time: 0.7927978038787842
Epoch: 10, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.064 Vali Acc: 0.849 Test Loss: 1.064 Test Acc: 0.849
Validation loss decreased (-0.843232 --> -0.848638).  Saving model ...
Epoch: 11 cost time: 0.7320306301116943
Epoch: 11, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.973 Vali Acc: 0.868 Test Loss: 0.973 Test Acc: 0.868
Validation loss decreased (-0.848638 --> -0.867558).  Saving model ...
Epoch: 12 cost time: 1.0143556594848633
Epoch: 12, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.902 Vali Acc: 0.873 Test Loss: 0.902 Test Acc: 0.873
Validation loss decreased (-0.867558 --> -0.872964).  Saving model ...
Epoch: 13 cost time: 0.9222748279571533
Epoch: 13, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.843 Vali Acc: 0.873 Test Loss: 0.843 Test Acc: 0.873
Validation loss decreased (-0.872964 --> -0.872965).  Saving model ...
Epoch: 14 cost time: 0.9127545356750488
Epoch: 14, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.760 Vali Acc: 0.892 Test Loss: 0.760 Test Acc: 0.892
Validation loss decreased (-0.872965 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 0.8060438632965088
Epoch: 15, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.704 Vali Acc: 0.889 Test Loss: 0.704 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7641711235046387
Epoch: 16, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.654 Vali Acc: 0.895 Test Loss: 0.654 Test Acc: 0.895
Validation loss decreased (-0.891884 --> -0.894588).  Saving model ...
Epoch: 17 cost time: 1.0022172927856445
Epoch: 17, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.623 Vali Acc: 0.903 Test Loss: 0.623 Test Acc: 0.903
Validation loss decreased (-0.894588 --> -0.902696).  Saving model ...
Epoch: 18 cost time: 0.9890577793121338
Epoch: 18, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.569 Vali Acc: 0.903 Test Loss: 0.569 Test Acc: 0.903
Validation loss decreased (-0.902696 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 0.9400546550750732
Epoch: 19, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.533 Vali Acc: 0.908 Test Loss: 0.533 Test Acc: 0.908
Validation loss decreased (-0.902697 --> -0.908103).  Saving model ...
Epoch: 20 cost time: 0.839735746383667
Epoch: 20, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.530 Vali Acc: 0.903 Test Loss: 0.530 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.00862455368042
Epoch: 21, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.477 Vali Acc: 0.911 Test Loss: 0.477 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 1.1941823959350586
Epoch: 22, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.474 Vali Acc: 0.908 Test Loss: 0.474 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0238590240478516
Epoch: 23, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.436 Vali Acc: 0.922 Test Loss: 0.436 Test Acc: 0.922
Validation loss decreased (-0.910806 --> -0.921617).  Saving model ...
Epoch: 24 cost time: 1.2335829734802246
Epoch: 24, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0027186870574951
Epoch: 25, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.406 Vali Acc: 0.927 Test Loss: 0.406 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 26 cost time: 1.0682790279388428
Epoch: 26, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.393 Vali Acc: 0.927 Test Loss: 0.393 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 27 cost time: 1.167431354522705
Epoch: 27, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2135841846466064
Epoch: 28, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.365 Vali Acc: 0.932 Test Loss: 0.365 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 29 cost time: 0.996755838394165
Epoch: 29, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.352 Vali Acc: 0.930 Test Loss: 0.352 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2658770084381104
Epoch: 30, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.333 Vali Acc: 0.932 Test Loss: 0.333 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 31 cost time: 1.2826886177062988
Epoch: 31, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.24495530128479
Epoch: 32, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.336 Vali Acc: 0.924 Test Loss: 0.336 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2721867561340332
Epoch: 33, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.320 Vali Acc: 0.932 Test Loss: 0.320 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 34 cost time: 1.2406642436981201
Epoch: 34, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0885884761810303
Epoch: 35, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.316 Vali Acc: 0.932 Test Loss: 0.316 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 36 cost time: 0.9670586585998535
Epoch: 36, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.293 Vali Acc: 0.932 Test Loss: 0.293 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 37 cost time: 1.149470567703247
Epoch: 37, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9760730266571045
Epoch: 38, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.20625901222229
Epoch: 39, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.299 Vali Acc: 0.935 Test Loss: 0.299 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 40 cost time: 1.3648159503936768
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1317172050476074
Epoch: 41, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.278 Vali Acc: 0.935 Test Loss: 0.278 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 42 cost time: 1.1563286781311035
Epoch: 42, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.283 Vali Acc: 0.935 Test Loss: 0.283 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0318219661712646
Epoch: 43, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.269 Vali Acc: 0.932 Test Loss: 0.269 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2152862548828125
Epoch: 44, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.267 Vali Acc: 0.935 Test Loss: 0.267 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 45 cost time: 1.0028624534606934
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0156593322753906
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.932 Test Loss: 0.261 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1216230392456055
Epoch: 47, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.269 Vali Acc: 0.924 Test Loss: 0.269 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1198148727416992
Epoch: 48, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.253 Vali Acc: 0.938 Test Loss: 0.253 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 49 cost time: 0.9945578575134277
Epoch: 49, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9648082256317139
Epoch: 50, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.252 Vali Acc: 0.932 Test Loss: 0.252 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9829163551330566
Epoch: 51, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.262 Vali Acc: 0.938 Test Loss: 0.262 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8625497817993164
Epoch: 52, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8767855167388916
Epoch: 53, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1109051704406738
Epoch: 54, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.9540507793426514
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.249 Vali Acc: 0.927 Test Loss: 0.249 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.0952959060668945
Epoch: 56, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.236 Vali Acc: 0.938 Test Loss: 0.236 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 57 cost time: 0.923797607421875
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9680378437042236
Epoch: 58, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.235 Vali Acc: 0.927 Test Loss: 0.235 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7855091094970703
Epoch: 59, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.0441014766693115
Epoch: 60, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.927 Test Loss: 0.269 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9161412715911865
Epoch: 61, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.924 Test Loss: 0.243 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9083566665649414
Epoch: 62, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.914 Test Loss: 0.257 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.090846061706543
Epoch: 63, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.819652795791626
Epoch: 64, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.239 Vali Acc: 0.938 Test Loss: 0.239 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.065793752670288
Epoch: 65, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.938 Test Loss: 0.239 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.023648977279663
Epoch: 66, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.932 Test Loss: 0.244 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 33991
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8630011081695557
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.107 Vali Acc: 0.257 Test Loss: 2.107 Test Acc: 0.257
Validation loss decreased (inf --> -0.256736).  Saving model ...
Epoch: 2 cost time: 1.0640103816986084
Epoch: 2, Steps: 17 | Train Loss: 2.087 Vali Loss: 1.995 Vali Acc: 0.389 Test Loss: 1.995 Test Acc: 0.389
Validation loss decreased (-0.256736 --> -0.389169).  Saving model ...
Epoch: 3 cost time: 0.8898918628692627
Epoch: 3, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.856 Vali Acc: 0.568 Test Loss: 1.856 Test Acc: 0.568
Validation loss decreased (-0.389169 --> -0.567549).  Saving model ...
Epoch: 4 cost time: 1.116260051727295
Epoch: 4, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.724 Vali Acc: 0.668 Test Loss: 1.724 Test Acc: 0.668
Validation loss decreased (-0.567549 --> -0.667550).  Saving model ...
Epoch: 5 cost time: 0.7575726509094238
Epoch: 5, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.596 Vali Acc: 0.759 Test Loss: 1.596 Test Acc: 0.759
Validation loss decreased (-0.667550 --> -0.759444).  Saving model ...
Epoch: 6 cost time: 0.8110263347625732
Epoch: 6, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.469 Vali Acc: 0.795 Test Loss: 1.469 Test Acc: 0.795
Validation loss decreased (-0.759444 --> -0.794580).  Saving model ...
Epoch: 7 cost time: 0.8507275581359863
Epoch: 7, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.352 Vali Acc: 0.822 Test Loss: 1.352 Test Acc: 0.822
Validation loss decreased (-0.794580 --> -0.821608).  Saving model ...
Epoch: 8 cost time: 1.2083349227905273
Epoch: 8, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.241 Vali Acc: 0.832 Test Loss: 1.241 Test Acc: 0.832
Validation loss decreased (-0.821608 --> -0.832420).  Saving model ...
Epoch: 9 cost time: 0.8064141273498535
Epoch: 9, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.133 Vali Acc: 0.841 Test Loss: 1.133 Test Acc: 0.841
Validation loss decreased (-0.832420 --> -0.840529).  Saving model ...
Epoch: 10 cost time: 0.9483077526092529
Epoch: 10, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.044 Vali Acc: 0.857 Test Loss: 1.044 Test Acc: 0.857
Validation loss decreased (-0.840529 --> -0.856746).  Saving model ...
Epoch: 11 cost time: 1.32350754737854
Epoch: 11, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.954 Vali Acc: 0.865 Test Loss: 0.954 Test Acc: 0.865
Validation loss decreased (-0.856746 --> -0.864855).  Saving model ...
Epoch: 12 cost time: 1.0931122303009033
Epoch: 12, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.876 Vali Acc: 0.870 Test Loss: 0.876 Test Acc: 0.870
Validation loss decreased (-0.864855 --> -0.870262).  Saving model ...
Epoch: 13 cost time: 0.8490476608276367
Epoch: 13, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.810 Vali Acc: 0.884 Test Loss: 0.810 Test Acc: 0.884
Validation loss decreased (-0.870262 --> -0.883776).  Saving model ...
Epoch: 14 cost time: 1.0607702732086182
Epoch: 14, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.747 Vali Acc: 0.895 Test Loss: 0.747 Test Acc: 0.895
Validation loss decreased (-0.883776 --> -0.894587).  Saving model ...
Epoch: 15 cost time: 0.9771137237548828
Epoch: 15, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.691 Vali Acc: 0.903 Test Loss: 0.691 Test Acc: 0.903
Validation loss decreased (-0.894587 --> -0.902696).  Saving model ...
Epoch: 16 cost time: 1.0923211574554443
Epoch: 16, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.642 Vali Acc: 0.908 Test Loss: 0.642 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908102).  Saving model ...
Epoch: 17 cost time: 0.9375848770141602
Epoch: 17, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.605 Vali Acc: 0.903 Test Loss: 0.605 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8532729148864746
Epoch: 18, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.563 Vali Acc: 0.911 Test Loss: 0.563 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 19 cost time: 0.8931846618652344
Epoch: 19, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.523 Vali Acc: 0.911 Test Loss: 0.523 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 20 cost time: 1.0506350994110107
Epoch: 20, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.499 Vali Acc: 0.924 Test Loss: 0.499 Test Acc: 0.924
Validation loss decreased (-0.910806 --> -0.924319).  Saving model ...
Epoch: 21 cost time: 0.8120987415313721
Epoch: 21, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.471 Vali Acc: 0.922 Test Loss: 0.471 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1096467971801758
Epoch: 22, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.453 Vali Acc: 0.919 Test Loss: 0.453 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9650142192840576
Epoch: 23, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0067195892333984
Epoch: 24, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8476858139038086
Epoch: 25, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.386 Vali Acc: 0.924 Test Loss: 0.386 Test Acc: 0.924
Validation loss decreased (-0.924319 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 0.8680834770202637
Epoch: 26, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.370 Vali Acc: 0.932 Test Loss: 0.370 Test Acc: 0.932
Validation loss decreased (-0.924320 --> -0.932429).  Saving model ...
Epoch: 27 cost time: 1.0486681461334229
Epoch: 27, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1068029403686523
Epoch: 28, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.346 Vali Acc: 0.935 Test Loss: 0.346 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 29 cost time: 0.9337632656097412
Epoch: 29, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0746960639953613
Epoch: 30, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.325 Vali Acc: 0.938 Test Loss: 0.325 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 31 cost time: 0.9697096347808838
Epoch: 31, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.314 Vali Acc: 0.935 Test Loss: 0.314 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2040343284606934
Epoch: 32, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9597969055175781
Epoch: 33, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8957376480102539
Epoch: 34, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.294 Vali Acc: 0.938 Test Loss: 0.294 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 35 cost time: 1.006476640701294
Epoch: 35, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.286 Vali Acc: 0.935 Test Loss: 0.286 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2171006202697754
Epoch: 36, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.287 Vali Acc: 0.935 Test Loss: 0.287 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.740048885345459
Epoch: 37, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8873357772827148
Epoch: 38, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.267 Vali Acc: 0.938 Test Loss: 0.267 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 39 cost time: 0.959721565246582
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 40 cost time: 0.9060311317443848
Epoch: 40, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7382550239562988
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.938 Test Loss: 0.263 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8192510604858398
Epoch: 42, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8509061336517334
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 44 cost time: 0.8739402294158936
Epoch: 44, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7950503826141357
Epoch: 45, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 46 cost time: 0.7660574913024902
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8506417274475098
Epoch: 47, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9902083873748779
Epoch: 48, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9536454677581787
Epoch: 49, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.253 Vali Acc: 0.938 Test Loss: 0.253 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.885474681854248
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 51 cost time: 0.8550214767456055
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.254 Vali Acc: 0.932 Test Loss: 0.254 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9420490264892578
Epoch: 52, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9452381134033203
Epoch: 53, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9425046443939209
Epoch: 54, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.9367935657501221
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9299502372741699
Epoch: 56, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0092694759368896
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.938 Test Loss: 0.228 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.8375663757324219
Epoch: 58, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.855757474899292
Epoch: 59, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 60 cost time: 1.210284948348999
Epoch: 60, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0022742748260498
Epoch: 61, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2925896644592285
Epoch: 62, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0415105819702148
Epoch: 63, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0251269340515137
Epoch: 64, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.9288845062255859
Epoch: 65, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.932 Test Loss: 0.220 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.069164752960205
Epoch: 66, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.0190396308898926
Epoch: 67, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.1514382362365723
Epoch: 68, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.9469430446624756
Epoch: 69, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 33479
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8003101348876953
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.107 Vali Acc: 0.257 Test Loss: 2.107 Test Acc: 0.257
Validation loss decreased (inf --> -0.256736).  Saving model ...
Epoch: 2 cost time: 0.778019905090332
Epoch: 2, Steps: 17 | Train Loss: 2.087 Vali Loss: 1.995 Vali Acc: 0.389 Test Loss: 1.995 Test Acc: 0.389
Validation loss decreased (-0.256736 --> -0.389169).  Saving model ...
Epoch: 3 cost time: 0.9604063034057617
Epoch: 3, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.856 Vali Acc: 0.568 Test Loss: 1.856 Test Acc: 0.568
Validation loss decreased (-0.389169 --> -0.567549).  Saving model ...
Epoch: 4 cost time: 1.1035220623016357
Epoch: 4, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.724 Vali Acc: 0.668 Test Loss: 1.724 Test Acc: 0.668
Validation loss decreased (-0.567549 --> -0.667550).  Saving model ...
Epoch: 5 cost time: 1.035470724105835
Epoch: 5, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.596 Vali Acc: 0.759 Test Loss: 1.596 Test Acc: 0.759
Validation loss decreased (-0.667550 --> -0.759444).  Saving model ...
Epoch: 6 cost time: 0.7673704624176025
Epoch: 6, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.469 Vali Acc: 0.795 Test Loss: 1.469 Test Acc: 0.795
Validation loss decreased (-0.759444 --> -0.794580).  Saving model ...
Epoch: 7 cost time: 1.0214557647705078
Epoch: 7, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.352 Vali Acc: 0.822 Test Loss: 1.352 Test Acc: 0.822
Validation loss decreased (-0.794580 --> -0.821608).  Saving model ...
Epoch: 8 cost time: 0.9776525497436523
Epoch: 8, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.241 Vali Acc: 0.832 Test Loss: 1.241 Test Acc: 0.832
Validation loss decreased (-0.821608 --> -0.832420).  Saving model ...
Epoch: 9 cost time: 0.8909895420074463
Epoch: 9, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.133 Vali Acc: 0.841 Test Loss: 1.133 Test Acc: 0.841
Validation loss decreased (-0.832420 --> -0.840529).  Saving model ...
Epoch: 10 cost time: 0.9573855400085449
Epoch: 10, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.044 Vali Acc: 0.857 Test Loss: 1.044 Test Acc: 0.857
Validation loss decreased (-0.840529 --> -0.856746).  Saving model ...
Epoch: 11 cost time: 0.9825928211212158
Epoch: 11, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.954 Vali Acc: 0.865 Test Loss: 0.954 Test Acc: 0.865
Validation loss decreased (-0.856746 --> -0.864855).  Saving model ...
Epoch: 12 cost time: 1.0259478092193604
Epoch: 12, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.876 Vali Acc: 0.870 Test Loss: 0.876 Test Acc: 0.870
Validation loss decreased (-0.864855 --> -0.870262).  Saving model ...
Epoch: 13 cost time: 1.1553571224212646
Epoch: 13, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.810 Vali Acc: 0.884 Test Loss: 0.810 Test Acc: 0.884
Validation loss decreased (-0.870262 --> -0.883776).  Saving model ...
Epoch: 14 cost time: 0.9615938663482666
Epoch: 14, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.747 Vali Acc: 0.895 Test Loss: 0.747 Test Acc: 0.895
Validation loss decreased (-0.883776 --> -0.894587).  Saving model ...
Epoch: 15 cost time: 0.9850802421569824
Epoch: 15, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.691 Vali Acc: 0.903 Test Loss: 0.691 Test Acc: 0.903
Validation loss decreased (-0.894587 --> -0.902696).  Saving model ...
Epoch: 16 cost time: 1.0097692012786865
Epoch: 16, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.642 Vali Acc: 0.908 Test Loss: 0.642 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908102).  Saving model ...
Epoch: 17 cost time: 0.9625012874603271
Epoch: 17, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.605 Vali Acc: 0.903 Test Loss: 0.605 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.19586181640625
Epoch: 18, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.563 Vali Acc: 0.911 Test Loss: 0.563 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 19 cost time: 0.9491119384765625
Epoch: 19, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.523 Vali Acc: 0.911 Test Loss: 0.523 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 20 cost time: 0.8176569938659668
Epoch: 20, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.499 Vali Acc: 0.924 Test Loss: 0.499 Test Acc: 0.924
Validation loss decreased (-0.910806 --> -0.924319).  Saving model ...
Epoch: 21 cost time: 1.1930434703826904
Epoch: 21, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.471 Vali Acc: 0.922 Test Loss: 0.471 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0034220218658447
Epoch: 22, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.453 Vali Acc: 0.919 Test Loss: 0.453 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9187097549438477
Epoch: 23, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.066498041152954
Epoch: 24, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9666829109191895
Epoch: 25, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.386 Vali Acc: 0.924 Test Loss: 0.386 Test Acc: 0.924
Validation loss decreased (-0.924319 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 0.9943375587463379
Epoch: 26, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.370 Vali Acc: 0.932 Test Loss: 0.370 Test Acc: 0.932
Validation loss decreased (-0.924320 --> -0.932429).  Saving model ...
Epoch: 27 cost time: 1.1098499298095703
Epoch: 27, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8438849449157715
Epoch: 28, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.346 Vali Acc: 0.935 Test Loss: 0.346 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 29 cost time: 1.1274869441986084
Epoch: 29, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0375041961669922
Epoch: 30, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.325 Vali Acc: 0.938 Test Loss: 0.325 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 31 cost time: 0.7082679271697998
Epoch: 31, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.314 Vali Acc: 0.935 Test Loss: 0.314 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0696330070495605
Epoch: 32, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.906538724899292
Epoch: 33, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.763803243637085
Epoch: 34, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.294 Vali Acc: 0.938 Test Loss: 0.294 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 35 cost time: 1.0420844554901123
Epoch: 35, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.286 Vali Acc: 0.935 Test Loss: 0.286 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8387181758880615
Epoch: 36, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.287 Vali Acc: 0.935 Test Loss: 0.287 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0625298023223877
Epoch: 37, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9332189559936523
Epoch: 38, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.267 Vali Acc: 0.938 Test Loss: 0.267 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 39 cost time: 0.9329545497894287
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 40 cost time: 0.7459719181060791
Epoch: 40, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.263 Vali Acc: 0.935 Test Loss: 0.263 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8645548820495605
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.938 Test Loss: 0.263 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.828418493270874
Epoch: 42, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0781397819519043
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 44 cost time: 1.0020215511322021
Epoch: 44, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8294699192047119
Epoch: 45, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 46 cost time: 0.9641547203063965
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8841125965118408
Epoch: 47, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1220958232879639
Epoch: 48, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.938 Test Loss: 0.242 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7174372673034668
Epoch: 49, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.253 Vali Acc: 0.938 Test Loss: 0.253 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8170955181121826
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 51 cost time: 0.9077916145324707
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.254 Vali Acc: 0.932 Test Loss: 0.254 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.132021427154541
Epoch: 52, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.150120496749878
Epoch: 53, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.7838926315307617
Epoch: 54, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1458227634429932
Epoch: 55, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9475076198577881
Epoch: 56, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.8410193920135498
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.938 Test Loss: 0.228 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9365057945251465
Epoch: 58, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.8101561069488525
Epoch: 59, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 60 cost time: 1.0675969123840332
Epoch: 60, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9583466053009033
Epoch: 61, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9657924175262451
Epoch: 62, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.9956378936767578
Epoch: 63, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.8682403564453125
Epoch: 64, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.9213993549346924
Epoch: 65, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.932 Test Loss: 0.220 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8162236213684082
Epoch: 66, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.9357700347900391
Epoch: 67, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.0802528858184814
Epoch: 68, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.8633382320404053
Epoch: 69, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 33479
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0873525142669678
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.168 Vali Acc: 0.146 Test Loss: 2.168 Test Acc: 0.146
Validation loss decreased (inf --> -0.145924).  Saving model ...
Epoch: 2 cost time: 1.1859912872314453
Epoch: 2, Steps: 17 | Train Loss: 2.115 Vali Loss: 2.105 Vali Acc: 0.241 Test Loss: 2.105 Test Acc: 0.241
Validation loss decreased (-0.145924 --> -0.240519).  Saving model ...
Epoch: 3 cost time: 1.1288249492645264
Epoch: 3, Steps: 17 | Train Loss: 2.030 Vali Loss: 2.022 Vali Acc: 0.373 Test Loss: 2.022 Test Acc: 0.373
Validation loss decreased (-0.240519 --> -0.372953).  Saving model ...
Epoch: 4 cost time: 1.225144624710083
Epoch: 4, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.925 Vali Acc: 0.522 Test Loss: 1.925 Test Acc: 0.522
Validation loss decreased (-0.372953 --> -0.521602).  Saving model ...
Epoch: 5 cost time: 1.302105188369751
Epoch: 5, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.817 Vali Acc: 0.643 Test Loss: 1.817 Test Acc: 0.643
Validation loss decreased (-0.521602 --> -0.643225).  Saving model ...
Epoch: 6 cost time: 0.9807629585266113
Epoch: 6, Steps: 17 | Train Loss: 1.691 Vali Loss: 1.702 Vali Acc: 0.716 Test Loss: 1.702 Test Acc: 0.716
Validation loss decreased (-0.643225 --> -0.716199).  Saving model ...
Epoch: 7 cost time: 1.1338679790496826
Epoch: 7, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.580 Vali Acc: 0.757 Test Loss: 1.580 Test Acc: 0.757
Validation loss decreased (-0.716199 --> -0.756741).  Saving model ...
Epoch: 8 cost time: 1.261693000793457
Epoch: 8, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.456 Vali Acc: 0.800 Test Loss: 1.456 Test Acc: 0.800
Validation loss decreased (-0.756741 --> -0.799985).  Saving model ...
Epoch: 9 cost time: 1.3459835052490234
Epoch: 9, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.327 Vali Acc: 0.814 Test Loss: 1.327 Test Acc: 0.814
Validation loss decreased (-0.799985 --> -0.813500).  Saving model ...
Epoch: 10 cost time: 0.9765172004699707
Epoch: 10, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.204 Vali Acc: 0.838 Test Loss: 1.204 Test Acc: 0.838
Validation loss decreased (-0.813500 --> -0.837826).  Saving model ...
Epoch: 11 cost time: 1.2219517230987549
Epoch: 11, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.101 Vali Acc: 0.851 Test Loss: 1.101 Test Acc: 0.851
Validation loss decreased (-0.837826 --> -0.851340).  Saving model ...
Epoch: 12 cost time: 1.106022834777832
Epoch: 12, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.999 Vali Acc: 0.862 Test Loss: 0.999 Test Acc: 0.862
Validation loss decreased (-0.851340 --> -0.862152).  Saving model ...
Epoch: 13 cost time: 1.1711461544036865
Epoch: 13, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.909 Vali Acc: 0.865 Test Loss: 0.909 Test Acc: 0.865
Validation loss decreased (-0.862152 --> -0.864856).  Saving model ...
Epoch: 14 cost time: 1.365110158920288
Epoch: 14, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.825 Vali Acc: 0.878 Test Loss: 0.825 Test Acc: 0.878
Validation loss decreased (-0.864856 --> -0.878370).  Saving model ...
Epoch: 15 cost time: 1.1386260986328125
Epoch: 15, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.756 Vali Acc: 0.881 Test Loss: 0.756 Test Acc: 0.881
Validation loss decreased (-0.878370 --> -0.881074).  Saving model ...
Epoch: 16 cost time: 1.111241102218628
Epoch: 16, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.688 Vali Acc: 0.897 Test Loss: 0.688 Test Acc: 0.897
Validation loss decreased (-0.881074 --> -0.897290).  Saving model ...
Epoch: 17 cost time: 1.3582565784454346
Epoch: 17, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.636 Vali Acc: 0.897 Test Loss: 0.636 Test Acc: 0.897
Validation loss decreased (-0.897290 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 1.8099150657653809
Epoch: 18, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.589 Vali Acc: 0.903 Test Loss: 0.589 Test Acc: 0.903
Validation loss decreased (-0.897291 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 1.2956962585449219
Epoch: 19, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.543 Vali Acc: 0.911 Test Loss: 0.543 Test Acc: 0.911
Validation loss decreased (-0.902697 --> -0.910805).  Saving model ...
Epoch: 20 cost time: 1.145571231842041
Epoch: 20, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.509 Vali Acc: 0.911 Test Loss: 0.509 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 21 cost time: 1.2915310859680176
Epoch: 21, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.478 Vali Acc: 0.919 Test Loss: 0.478 Test Acc: 0.919
Validation loss decreased (-0.910806 --> -0.918914).  Saving model ...
Epoch: 22 cost time: 1.2258236408233643
Epoch: 22, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.456 Vali Acc: 0.922 Test Loss: 0.456 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 23 cost time: 1.4966092109680176
Epoch: 23, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.425 Vali Acc: 0.932 Test Loss: 0.425 Test Acc: 0.932
Validation loss decreased (-0.921617 --> -0.932428).  Saving model ...
Epoch: 24 cost time: 1.2009742259979248
Epoch: 24, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.397 Vali Acc: 0.935 Test Loss: 0.397 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935131).  Saving model ...
Epoch: 25 cost time: 1.3218908309936523
Epoch: 25, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 26 cost time: 1.4765174388885498
Epoch: 26, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.358 Vali Acc: 0.946 Test Loss: 0.358 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945942).  Saving model ...
Epoch: 27 cost time: 1.5819294452667236
Epoch: 27, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.342 Vali Acc: 0.941 Test Loss: 0.342 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9725942611694336
Epoch: 28, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.318 Vali Acc: 0.949 Test Loss: 0.318 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 29 cost time: 1.4037048816680908
Epoch: 29, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3818674087524414
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.293 Vali Acc: 0.946 Test Loss: 0.293 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2214617729187012
Epoch: 31, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.284 Vali Acc: 0.943 Test Loss: 0.284 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.202249526977539
Epoch: 32, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.272 Vali Acc: 0.951 Test Loss: 0.272 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951349).  Saving model ...
Epoch: 33 cost time: 1.1213979721069336
Epoch: 33, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.263 Vali Acc: 0.946 Test Loss: 0.263 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2736577987670898
Epoch: 34, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.262 Vali Acc: 0.935 Test Loss: 0.262 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.19222092628479
Epoch: 35, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.168848991394043
Epoch: 36, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3096768856048584
Epoch: 37, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2899980545043945
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.316861629486084
Epoch: 39, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2581636905670166
Epoch: 40, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1089186668395996
Epoch: 41, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.040696382522583
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 19567
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.434504508972168
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.216 Vali Acc: 0.149 Test Loss: 2.216 Test Acc: 0.149
Validation loss decreased (inf --> -0.148626).  Saving model ...
Epoch: 2 cost time: 1.0699265003204346
Epoch: 2, Steps: 17 | Train Loss: 2.170 Vali Loss: 2.152 Vali Acc: 0.238 Test Loss: 2.152 Test Acc: 0.238
Validation loss decreased (-0.148626 --> -0.237816).  Saving model ...
Epoch: 3 cost time: 1.0312297344207764
Epoch: 3, Steps: 17 | Train Loss: 2.085 Vali Loss: 2.068 Vali Acc: 0.338 Test Loss: 2.068 Test Acc: 0.338
Validation loss decreased (-0.237816 --> -0.337817).  Saving model ...
Epoch: 4 cost time: 1.01456880569458
Epoch: 4, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.971 Vali Acc: 0.449 Test Loss: 1.971 Test Acc: 0.449
Validation loss decreased (-0.337817 --> -0.448629).  Saving model ...
Epoch: 5 cost time: 1.0699059963226318
Epoch: 5, Steps: 17 | Train Loss: 1.880 Vali Loss: 1.868 Vali Acc: 0.549 Test Loss: 1.868 Test Acc: 0.549
Validation loss decreased (-0.448629 --> -0.548630).  Saving model ...
Epoch: 6 cost time: 1.1387040615081787
Epoch: 6, Steps: 17 | Train Loss: 1.760 Vali Loss: 1.756 Vali Acc: 0.643 Test Loss: 1.756 Test Acc: 0.643
Validation loss decreased (-0.548630 --> -0.643226).  Saving model ...
Epoch: 7 cost time: 1.1267790794372559
Epoch: 7, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.640 Vali Acc: 0.735 Test Loss: 1.640 Test Acc: 0.735
Validation loss decreased (-0.643226 --> -0.735119).  Saving model ...
Epoch: 8 cost time: 1.3187010288238525
Epoch: 8, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.525 Vali Acc: 0.773 Test Loss: 1.525 Test Acc: 0.773
Validation loss decreased (-0.735119 --> -0.772958).  Saving model ...
Epoch: 9 cost time: 1.1919167041778564
Epoch: 9, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.411 Vali Acc: 0.811 Test Loss: 1.411 Test Acc: 0.811
Validation loss decreased (-0.772958 --> -0.810797).  Saving model ...
Epoch: 10 cost time: 1.134244441986084
Epoch: 10, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.295 Vali Acc: 0.832 Test Loss: 1.295 Test Acc: 0.832
Validation loss decreased (-0.810797 --> -0.832419).  Saving model ...
Epoch: 11 cost time: 1.2844161987304688
Epoch: 11, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.181 Vali Acc: 0.859 Test Loss: 1.181 Test Acc: 0.859
Validation loss decreased (-0.832419 --> -0.859448).  Saving model ...
Epoch: 12 cost time: 1.255173921585083
Epoch: 12, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.081 Vali Acc: 0.868 Test Loss: 1.081 Test Acc: 0.868
Validation loss decreased (-0.859448 --> -0.867557).  Saving model ...
Epoch: 13 cost time: 1.0757060050964355
Epoch: 13, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.990 Vali Acc: 0.878 Test Loss: 0.990 Test Acc: 0.878
Validation loss decreased (-0.867557 --> -0.878368).  Saving model ...
Epoch: 14 cost time: 1.1779193878173828
Epoch: 14, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.907 Vali Acc: 0.884 Test Loss: 0.907 Test Acc: 0.884
Validation loss decreased (-0.878368 --> -0.883775).  Saving model ...
Epoch: 15 cost time: 1.1377811431884766
Epoch: 15, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.838 Vali Acc: 0.884 Test Loss: 0.838 Test Acc: 0.884
Validation loss decreased (-0.883775 --> -0.883775).  Saving model ...
Epoch: 16 cost time: 1.4713666439056396
Epoch: 16, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.769 Vali Acc: 0.895 Test Loss: 0.769 Test Acc: 0.895
Validation loss decreased (-0.883775 --> -0.894587).  Saving model ...
Epoch: 17 cost time: 1.2437002658843994
Epoch: 17, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.711 Vali Acc: 0.900 Test Loss: 0.711 Test Acc: 0.900
Validation loss decreased (-0.894587 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 1.2127370834350586
Epoch: 18, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 1.4365136623382568
Epoch: 19, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.617 Vali Acc: 0.908 Test Loss: 0.617 Test Acc: 0.908
Validation loss decreased (-0.899993 --> -0.908102).  Saving model ...
Epoch: 20 cost time: 1.322636604309082
Epoch: 20, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.577 Vali Acc: 0.914 Test Loss: 0.577 Test Acc: 0.914
Validation loss decreased (-0.908102 --> -0.913508).  Saving model ...
Epoch: 21 cost time: 1.3891525268554688
Epoch: 21, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.540 Vali Acc: 0.914 Test Loss: 0.540 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913508).  Saving model ...
Epoch: 22 cost time: 1.2226786613464355
Epoch: 22, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.512 Vali Acc: 0.911 Test Loss: 0.512 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4140424728393555
Epoch: 23, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.488 Vali Acc: 0.905 Test Loss: 0.488 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3656456470489502
Epoch: 24, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.460 Vali Acc: 0.911 Test Loss: 0.460 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3883826732635498
Epoch: 25, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.437 Vali Acc: 0.905 Test Loss: 0.437 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5337798595428467
Epoch: 26, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.417 Vali Acc: 0.911 Test Loss: 0.417 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.424252986907959
Epoch: 27, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.403 Vali Acc: 0.905 Test Loss: 0.403 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.26222562789917
Epoch: 28, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.385 Vali Acc: 0.916 Test Loss: 0.385 Test Acc: 0.916
Validation loss decreased (-0.913508 --> -0.916212).  Saving model ...
Epoch: 29 cost time: 1.2707769870758057
Epoch: 29, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921618).  Saving model ...
Epoch: 30 cost time: 1.50850248336792
Epoch: 30, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.362 Vali Acc: 0.916 Test Loss: 0.362 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2918479442596436
Epoch: 31, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
Epoch: 32 cost time: 1.2245559692382812
Epoch: 32, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
Epoch: 33 cost time: 1.162280797958374
Epoch: 33, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929727).  Saving model ...
Epoch: 34 cost time: 1.2144131660461426
Epoch: 34, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2264094352722168
Epoch: 35, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 36 cost time: 1.204728126525879
Epoch: 36, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.303 Vali Acc: 0.927 Test Loss: 0.303 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2341902256011963
Epoch: 37, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.295 Vali Acc: 0.927 Test Loss: 0.295 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1840543746948242
Epoch: 38, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.283 Vali Acc: 0.927 Test Loss: 0.283 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2591118812561035
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.283 Vali Acc: 0.916 Test Loss: 0.283 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.383349895477295
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3093552589416504
Epoch: 41, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1746995449066162
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.268 Vali Acc: 0.924 Test Loss: 0.268 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3818047046661377
Epoch: 43, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.274 Vali Acc: 0.916 Test Loss: 0.274 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1389217376708984
Epoch: 44, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3694543838500977
Epoch: 45, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9297297297297298
model parameter : 19311
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5574889183044434
Epoch: 1, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.140 Vali Acc: 0.230 Test Loss: 2.140 Test Acc: 0.230
Validation loss decreased (inf --> -0.229708).  Saving model ...
Epoch: 2 cost time: 0.9993150234222412
Epoch: 2, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.075 Vali Acc: 0.311 Test Loss: 2.075 Test Acc: 0.311
Validation loss decreased (-0.229708 --> -0.310790).  Saving model ...
Epoch: 3 cost time: 1.1742162704467773
Epoch: 3, Steps: 17 | Train Loss: 2.051 Vali Loss: 1.993 Vali Acc: 0.403 Test Loss: 1.993 Test Acc: 0.403
Validation loss decreased (-0.310790 --> -0.402683).  Saving model ...
Epoch: 4 cost time: 1.0240025520324707
Epoch: 4, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.895 Vali Acc: 0.565 Test Loss: 1.895 Test Acc: 0.565
Validation loss decreased (-0.402683 --> -0.564846).  Saving model ...
Epoch: 5 cost time: 0.8783824443817139
Epoch: 5, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.795 Vali Acc: 0.654 Test Loss: 1.795 Test Acc: 0.654
Validation loss decreased (-0.564846 --> -0.654036).  Saving model ...
Epoch: 6 cost time: 0.8583602905273438
Epoch: 6, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.685 Vali Acc: 0.735 Test Loss: 1.685 Test Acc: 0.735
Validation loss decreased (-0.654036 --> -0.735118).  Saving model ...
Epoch: 7 cost time: 1.0324320793151855
Epoch: 7, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.575 Vali Acc: 0.803 Test Loss: 1.575 Test Acc: 0.803
Validation loss decreased (-0.735118 --> -0.802687).  Saving model ...
Epoch: 8 cost time: 1.113563060760498
Epoch: 8, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.463 Vali Acc: 0.830 Test Loss: 1.463 Test Acc: 0.830
Validation loss decreased (-0.802687 --> -0.829715).  Saving model ...
Epoch: 9 cost time: 0.929293155670166
Epoch: 9, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.348 Vali Acc: 0.849 Test Loss: 1.348 Test Acc: 0.849
Validation loss decreased (-0.829715 --> -0.848635).  Saving model ...
Epoch: 10 cost time: 1.1154139041900635
Epoch: 10, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.235 Vali Acc: 0.870 Test Loss: 1.235 Test Acc: 0.870
Validation loss decreased (-0.848635 --> -0.870258).  Saving model ...
Epoch: 11 cost time: 1.0103118419647217
Epoch: 11, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.131 Vali Acc: 0.876 Test Loss: 1.131 Test Acc: 0.876
Validation loss decreased (-0.870258 --> -0.875664).  Saving model ...
Epoch: 12 cost time: 0.8294429779052734
Epoch: 12, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.033 Vali Acc: 0.881 Test Loss: 1.033 Test Acc: 0.881
Validation loss decreased (-0.875664 --> -0.881071).  Saving model ...
Epoch: 13 cost time: 0.9169101715087891
Epoch: 13, Steps: 17 | Train Loss: 0.885 Vali Loss: 0.947 Vali Acc: 0.886 Test Loss: 0.947 Test Acc: 0.886
Validation loss decreased (-0.881071 --> -0.886477).  Saving model ...
Epoch: 14 cost time: 1.1249842643737793
Epoch: 14, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.868 Vali Acc: 0.892 Test Loss: 0.868 Test Acc: 0.892
Validation loss decreased (-0.886477 --> -0.891883).  Saving model ...
Epoch: 15 cost time: 1.0652778148651123
Epoch: 15, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.797 Vali Acc: 0.892 Test Loss: 0.797 Test Acc: 0.892
Validation loss decreased (-0.891883 --> -0.891884).  Saving model ...
Epoch: 16 cost time: 1.031057357788086
Epoch: 16, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.732 Vali Acc: 0.897 Test Loss: 0.732 Test Acc: 0.897
Validation loss decreased (-0.891884 --> -0.897290).  Saving model ...
Epoch: 17 cost time: 1.0289137363433838
Epoch: 17, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.679 Vali Acc: 0.905 Test Loss: 0.679 Test Acc: 0.905
Validation loss decreased (-0.897290 --> -0.905399).  Saving model ...
Epoch: 18 cost time: 1.0183117389678955
Epoch: 18, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.629 Vali Acc: 0.908 Test Loss: 0.629 Test Acc: 0.908
Validation loss decreased (-0.905399 --> -0.908102).  Saving model ...
Epoch: 19 cost time: 1.106950044631958
Epoch: 19, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.587 Vali Acc: 0.905 Test Loss: 0.587 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9660615921020508
Epoch: 20, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.549 Vali Acc: 0.905 Test Loss: 0.549 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9392194747924805
Epoch: 21, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.518 Vali Acc: 0.911 Test Loss: 0.518 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 0.9636626243591309
Epoch: 22, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.483 Vali Acc: 0.914 Test Loss: 0.483 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 23 cost time: 0.8636777400970459
Epoch: 23, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.461 Vali Acc: 0.916 Test Loss: 0.461 Test Acc: 0.916
Validation loss decreased (-0.913509 --> -0.916212).  Saving model ...
Epoch: 24 cost time: 0.8922519683837891
Epoch: 24, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.432 Vali Acc: 0.922 Test Loss: 0.432 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921617).  Saving model ...
Epoch: 25 cost time: 0.8940520286560059
Epoch: 25, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.409 Vali Acc: 0.924 Test Loss: 0.409 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 0.8882405757904053
Epoch: 26, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.393 Vali Acc: 0.930 Test Loss: 0.393 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 27 cost time: 1.0813589096069336
Epoch: 27, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0474967956542969
Epoch: 28, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.357 Vali Acc: 0.924 Test Loss: 0.357 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0280609130859375
Epoch: 29, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.348 Vali Acc: 0.924 Test Loss: 0.348 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0536117553710938
Epoch: 30, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.332 Vali Acc: 0.927 Test Loss: 0.332 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2103760242462158
Epoch: 31, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.325 Vali Acc: 0.927 Test Loss: 0.325 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1255481243133545
Epoch: 32, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.317 Vali Acc: 0.927 Test Loss: 0.317 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1158506870269775
Epoch: 33, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.310 Vali Acc: 0.932 Test Loss: 0.310 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 34 cost time: 1.0124413967132568
Epoch: 34, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.295 Vali Acc: 0.935 Test Loss: 0.295 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 35 cost time: 1.1849186420440674
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.289 Vali Acc: 0.938 Test Loss: 0.289 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 36 cost time: 1.0812151432037354
Epoch: 36, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.289 Vali Acc: 0.935 Test Loss: 0.289 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9406960010528564
Epoch: 37, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.282 Vali Acc: 0.935 Test Loss: 0.282 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1732003688812256
Epoch: 38, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.273 Vali Acc: 0.932 Test Loss: 0.273 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0205104351043701
Epoch: 39, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.269 Vali Acc: 0.938 Test Loss: 0.269 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 40 cost time: 1.0323002338409424
Epoch: 40, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9408884048461914
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 42 cost time: 1.067758321762085
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.256 Vali Acc: 0.932 Test Loss: 0.256 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0132606029510498
Epoch: 43, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8593978881835938
Epoch: 44, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0396909713745117
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 46 cost time: 1.0794036388397217
Epoch: 46, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.235 Vali Acc: 0.938 Test Loss: 0.235 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0002052783966064
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 48 cost time: 0.8457052707672119
Epoch: 48, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0785675048828125
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0592858791351318
Epoch: 50, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0564439296722412
Epoch: 51, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.229 Vali Acc: 0.943 Test Loss: 0.229 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 52 cost time: 0.9211316108703613
Epoch: 52, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.938 Test Loss: 0.231 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9624395370483398
Epoch: 53, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 54 cost time: 0.8920471668243408
Epoch: 54, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9800701141357422
Epoch: 55, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.37288498878479
Epoch: 56, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.026524543762207
Epoch: 57, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 58 cost time: 1.038635015487671
Epoch: 58, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0047035217285156
Epoch: 59, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 60 cost time: 1.1191117763519287
Epoch: 60, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1100876331329346
Epoch: 61, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1454665660858154
Epoch: 62, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.121025800704956
Epoch: 63, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9802095890045166
Epoch: 64, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.206491470336914
Epoch: 65, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.215972661972046
Epoch: 66, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 67 cost time: 1.1950111389160156
Epoch: 67, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.920318603515625
Epoch: 68, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2504751682281494
Epoch: 69, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.024334192276001
Epoch: 70, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.0285239219665527
Epoch: 71, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.9620246887207031
Epoch: 72, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8720681667327881
Epoch: 73, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.0634775161743164
Epoch: 74, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.986720085144043
Epoch: 75, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.9133849143981934
Epoch: 76, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 19055
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0818982124328613
Epoch: 1, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.194 Vali Acc: 0.149 Test Loss: 2.194 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 1.0150513648986816
Epoch: 2, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.126 Vali Acc: 0.235 Test Loss: 2.126 Test Acc: 0.235
Validation loss decreased (-0.148627 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 1.0318145751953125
Epoch: 3, Steps: 17 | Train Loss: 2.072 Vali Loss: 2.038 Vali Acc: 0.335 Test Loss: 2.038 Test Acc: 0.335
Validation loss decreased (-0.235114 --> -0.335115).  Saving model ...
Epoch: 4 cost time: 1.0902915000915527
Epoch: 4, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.939 Vali Acc: 0.454 Test Loss: 1.939 Test Acc: 0.454
Validation loss decreased (-0.335115 --> -0.454035).  Saving model ...
Epoch: 5 cost time: 0.9674546718597412
Epoch: 5, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.831 Vali Acc: 0.538 Test Loss: 1.831 Test Acc: 0.538
Validation loss decreased (-0.454035 --> -0.537820).  Saving model ...
Epoch: 6 cost time: 1.2526774406433105
Epoch: 6, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.718 Vali Acc: 0.651 Test Loss: 1.718 Test Acc: 0.651
Validation loss decreased (-0.537820 --> -0.651334).  Saving model ...
Epoch: 7 cost time: 1.2529020309448242
Epoch: 7, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.597 Vali Acc: 0.711 Test Loss: 1.597 Test Acc: 0.711
Validation loss decreased (-0.651334 --> -0.710795).  Saving model ...
Epoch: 8 cost time: 1.1854546070098877
Epoch: 8, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.474 Vali Acc: 0.762 Test Loss: 1.474 Test Acc: 0.762
Validation loss decreased (-0.710795 --> -0.762147).  Saving model ...
Epoch: 9 cost time: 1.3640494346618652
Epoch: 9, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.356 Vali Acc: 0.800 Test Loss: 1.356 Test Acc: 0.800
Validation loss decreased (-0.762147 --> -0.799986).  Saving model ...
Epoch: 10 cost time: 1.0878193378448486
Epoch: 10, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.237 Vali Acc: 0.822 Test Loss: 1.237 Test Acc: 0.822
Validation loss decreased (-0.799986 --> -0.821609).  Saving model ...
Epoch: 11 cost time: 1.2695114612579346
Epoch: 11, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.126 Vali Acc: 0.841 Test Loss: 1.126 Test Acc: 0.841
Validation loss decreased (-0.821609 --> -0.840529).  Saving model ...
Epoch: 12 cost time: 1.1212549209594727
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.023 Vali Acc: 0.851 Test Loss: 1.023 Test Acc: 0.851
Validation loss decreased (-0.840529 --> -0.851341).  Saving model ...
Epoch: 13 cost time: 0.9836771488189697
Epoch: 13, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.938 Vali Acc: 0.857 Test Loss: 0.938 Test Acc: 0.857
Validation loss decreased (-0.851341 --> -0.856747).  Saving model ...
Epoch: 14 cost time: 1.152212142944336
Epoch: 14, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.859 Vali Acc: 0.873 Test Loss: 0.859 Test Acc: 0.873
Validation loss decreased (-0.856747 --> -0.872964).  Saving model ...
Epoch: 15 cost time: 1.2493469715118408
Epoch: 15, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.796 Vali Acc: 0.870 Test Loss: 0.796 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2674670219421387
Epoch: 16, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.737 Vali Acc: 0.889 Test Loss: 0.737 Test Acc: 0.889
Validation loss decreased (-0.872964 --> -0.889182).  Saving model ...
Epoch: 17 cost time: 1.2141852378845215
Epoch: 17, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.672 Vali Acc: 0.897 Test Loss: 0.672 Test Acc: 0.897
Validation loss decreased (-0.889182 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 1.2797119617462158
Epoch: 18, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.631 Vali Acc: 0.900 Test Loss: 0.631 Test Acc: 0.900
Validation loss decreased (-0.897291 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 1.2809820175170898
Epoch: 19, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.587 Vali Acc: 0.903 Test Loss: 0.587 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902697).  Saving model ...
Epoch: 20 cost time: 1.0020430088043213
Epoch: 20, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.547 Vali Acc: 0.908 Test Loss: 0.547 Test Acc: 0.908
Validation loss decreased (-0.902697 --> -0.908103).  Saving model ...
Epoch: 21 cost time: 1.1497540473937988
Epoch: 21, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.512 Vali Acc: 0.911 Test Loss: 0.512 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 1.176250696182251
Epoch: 22, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.479 Vali Acc: 0.919 Test Loss: 0.479 Test Acc: 0.919
Validation loss decreased (-0.910806 --> -0.918914).  Saving model ...
Epoch: 23 cost time: 1.17305326461792
Epoch: 23, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.459 Vali Acc: 0.922 Test Loss: 0.459 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 24 cost time: 1.2947540283203125
Epoch: 24, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.426 Vali Acc: 0.935 Test Loss: 0.426 Test Acc: 0.935
Validation loss decreased (-0.921617 --> -0.935131).  Saving model ...
Epoch: 25 cost time: 1.2850675582885742
Epoch: 25, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.411 Vali Acc: 0.927 Test Loss: 0.411 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1215319633483887
Epoch: 26, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.388 Vali Acc: 0.932 Test Loss: 0.388 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.247720718383789
Epoch: 27, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.373 Vali Acc: 0.935 Test Loss: 0.373 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 28 cost time: 1.189845323562622
Epoch: 28, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.351 Vali Acc: 0.938 Test Loss: 0.351 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 29 cost time: 1.0215935707092285
Epoch: 29, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.338 Vali Acc: 0.935 Test Loss: 0.338 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9965798854827881
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.324 Vali Acc: 0.938 Test Loss: 0.324 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 31 cost time: 0.8776390552520752
Epoch: 31, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.309 Vali Acc: 0.938 Test Loss: 0.309 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 32 cost time: 0.9137616157531738
Epoch: 32, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943240).  Saving model ...
Epoch: 33 cost time: 1.181171178817749
Epoch: 33, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.291 Vali Acc: 0.938 Test Loss: 0.291 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2297682762145996
Epoch: 34, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1136882305145264
Epoch: 35, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.946 Test Loss: 0.271 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 36 cost time: 1.0472657680511475
Epoch: 36, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.264 Vali Acc: 0.943 Test Loss: 0.264 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0892002582550049
Epoch: 37, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 38 cost time: 1.0006358623504639
Epoch: 38, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0740230083465576
Epoch: 39, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.239043951034546
Epoch: 40, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9348175525665283
Epoch: 41, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9740641117095947
Epoch: 42, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 43 cost time: 1.1611011028289795
Epoch: 43, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1578214168548584
Epoch: 44, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2397656440734863
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0233750343322754
Epoch: 46, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0010671615600586
Epoch: 47, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4047260284423828
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.081435203552246
Epoch: 49, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.322272539138794
Epoch: 50, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0405371189117432
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1118452548980713
Epoch: 52, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 18799
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               8                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0297443866729736
Epoch: 1, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.194 Vali Acc: 0.149 Test Loss: 2.194 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 1.2141947746276855
Epoch: 2, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.126 Vali Acc: 0.235 Test Loss: 2.126 Test Acc: 0.235
Validation loss decreased (-0.148627 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 0.9360480308532715
Epoch: 3, Steps: 17 | Train Loss: 2.072 Vali Loss: 2.038 Vali Acc: 0.335 Test Loss: 2.038 Test Acc: 0.335
Validation loss decreased (-0.235114 --> -0.335115).  Saving model ...
Epoch: 4 cost time: 1.081871747970581
Epoch: 4, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.939 Vali Acc: 0.454 Test Loss: 1.939 Test Acc: 0.454
Validation loss decreased (-0.335115 --> -0.454035).  Saving model ...
Epoch: 5 cost time: 1.0090060234069824
Epoch: 5, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.831 Vali Acc: 0.538 Test Loss: 1.831 Test Acc: 0.538
Validation loss decreased (-0.454035 --> -0.537820).  Saving model ...
Epoch: 6 cost time: 1.1025018692016602
Epoch: 6, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.718 Vali Acc: 0.651 Test Loss: 1.718 Test Acc: 0.651
Validation loss decreased (-0.537820 --> -0.651334).  Saving model ...
Epoch: 7 cost time: 1.3252010345458984
Epoch: 7, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.597 Vali Acc: 0.711 Test Loss: 1.597 Test Acc: 0.711
Validation loss decreased (-0.651334 --> -0.710795).  Saving model ...
Epoch: 8 cost time: 0.8867828845977783
Epoch: 8, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.474 Vali Acc: 0.762 Test Loss: 1.474 Test Acc: 0.762
Validation loss decreased (-0.710795 --> -0.762147).  Saving model ...
Epoch: 9 cost time: 0.9641358852386475
Epoch: 9, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.356 Vali Acc: 0.800 Test Loss: 1.356 Test Acc: 0.800
Validation loss decreased (-0.762147 --> -0.799986).  Saving model ...
Epoch: 10 cost time: 0.8987786769866943
Epoch: 10, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.237 Vali Acc: 0.822 Test Loss: 1.237 Test Acc: 0.822
Validation loss decreased (-0.799986 --> -0.821609).  Saving model ...
Epoch: 11 cost time: 0.930152416229248
Epoch: 11, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.126 Vali Acc: 0.841 Test Loss: 1.126 Test Acc: 0.841
Validation loss decreased (-0.821609 --> -0.840529).  Saving model ...
Epoch: 12 cost time: 1.014782428741455
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.023 Vali Acc: 0.851 Test Loss: 1.023 Test Acc: 0.851
Validation loss decreased (-0.840529 --> -0.851341).  Saving model ...
Epoch: 13 cost time: 0.8564906120300293
Epoch: 13, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.938 Vali Acc: 0.857 Test Loss: 0.938 Test Acc: 0.857
Validation loss decreased (-0.851341 --> -0.856747).  Saving model ...
Epoch: 14 cost time: 0.9138681888580322
Epoch: 14, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.859 Vali Acc: 0.873 Test Loss: 0.859 Test Acc: 0.873
Validation loss decreased (-0.856747 --> -0.872964).  Saving model ...
Epoch: 15 cost time: 0.8468492031097412
Epoch: 15, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.796 Vali Acc: 0.870 Test Loss: 0.796 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8827371597290039
Epoch: 16, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.737 Vali Acc: 0.889 Test Loss: 0.737 Test Acc: 0.889
Validation loss decreased (-0.872964 --> -0.889182).  Saving model ...
Epoch: 17 cost time: 0.9805583953857422
Epoch: 17, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.672 Vali Acc: 0.897 Test Loss: 0.672 Test Acc: 0.897
Validation loss decreased (-0.889182 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 0.9379642009735107
Epoch: 18, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.631 Vali Acc: 0.900 Test Loss: 0.631 Test Acc: 0.900
Validation loss decreased (-0.897291 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.9309320449829102
Epoch: 19, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.587 Vali Acc: 0.903 Test Loss: 0.587 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902697).  Saving model ...
Epoch: 20 cost time: 0.8517501354217529
Epoch: 20, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.547 Vali Acc: 0.908 Test Loss: 0.547 Test Acc: 0.908
Validation loss decreased (-0.902697 --> -0.908103).  Saving model ...
Epoch: 21 cost time: 0.9367997646331787
Epoch: 21, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.512 Vali Acc: 0.911 Test Loss: 0.512 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 0.9720230102539062
Epoch: 22, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.479 Vali Acc: 0.919 Test Loss: 0.479 Test Acc: 0.919
Validation loss decreased (-0.910806 --> -0.918914).  Saving model ...
Epoch: 23 cost time: 1.0039749145507812
Epoch: 23, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.459 Vali Acc: 0.922 Test Loss: 0.459 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 24 cost time: 0.8748481273651123
Epoch: 24, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.426 Vali Acc: 0.935 Test Loss: 0.426 Test Acc: 0.935
Validation loss decreased (-0.921617 --> -0.935131).  Saving model ...
Epoch: 25 cost time: 1.0021486282348633
Epoch: 25, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.411 Vali Acc: 0.927 Test Loss: 0.411 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.899071216583252
Epoch: 26, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.388 Vali Acc: 0.932 Test Loss: 0.388 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1208174228668213
Epoch: 27, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.373 Vali Acc: 0.935 Test Loss: 0.373 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 28 cost time: 0.7789731025695801
Epoch: 28, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.351 Vali Acc: 0.938 Test Loss: 0.351 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 29 cost time: 0.7957429885864258
Epoch: 29, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.338 Vali Acc: 0.935 Test Loss: 0.338 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.977130651473999
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.324 Vali Acc: 0.938 Test Loss: 0.324 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 31 cost time: 0.8669099807739258
Epoch: 31, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.309 Vali Acc: 0.938 Test Loss: 0.309 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 32 cost time: 0.9703450202941895
Epoch: 32, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943240).  Saving model ...
Epoch: 33 cost time: 1.0906109809875488
Epoch: 33, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.291 Vali Acc: 0.938 Test Loss: 0.291 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9686675071716309
Epoch: 34, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9996404647827148
Epoch: 35, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.271 Vali Acc: 0.946 Test Loss: 0.271 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 36 cost time: 1.148475170135498
Epoch: 36, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.264 Vali Acc: 0.943 Test Loss: 0.264 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1402688026428223
Epoch: 37, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 38 cost time: 0.9207298755645752
Epoch: 38, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0297136306762695
Epoch: 39, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0277466773986816
Epoch: 40, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.034548044204712
Epoch: 41, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.938230037689209
Epoch: 42, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 43 cost time: 1.008998155593872
Epoch: 43, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9886021614074707
Epoch: 44, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9831690788269043
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9444618225097656
Epoch: 46, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.100950002670288
Epoch: 47, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9836888313293457
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9497504234313965
Epoch: 49, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.003345012664795
Epoch: 50, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8519961833953857
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0589935779571533
Epoch: 52, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC1_df8_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 18799
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2173585891723633
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.183 Vali Acc: 0.103 Test Loss: 2.183 Test Acc: 0.103
Validation loss decreased (inf --> -0.102681).  Saving model ...
Epoch: 2 cost time: 1.2735896110534668
Epoch: 2, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.123 Vali Acc: 0.219 Test Loss: 2.123 Test Acc: 0.219
Validation loss decreased (-0.102681 --> -0.218898).  Saving model ...
Epoch: 3 cost time: 1.4816124439239502
Epoch: 3, Steps: 17 | Train Loss: 2.069 Vali Loss: 2.039 Vali Acc: 0.373 Test Loss: 2.039 Test Acc: 0.373
Validation loss decreased (-0.218898 --> -0.372953).  Saving model ...
Epoch: 4 cost time: 1.2191529273986816
Epoch: 4, Steps: 17 | Train Loss: 1.968 Vali Loss: 1.945 Vali Acc: 0.511 Test Loss: 1.945 Test Acc: 0.511
Validation loss decreased (-0.372953 --> -0.510791).  Saving model ...
Epoch: 5 cost time: 1.2152950763702393
Epoch: 5, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.842 Vali Acc: 0.630 Test Loss: 1.842 Test Acc: 0.630
Validation loss decreased (-0.510791 --> -0.629711).  Saving model ...
Epoch: 6 cost time: 1.5413367748260498
Epoch: 6, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.735 Vali Acc: 0.724 Test Loss: 1.735 Test Acc: 0.724
Validation loss decreased (-0.629711 --> -0.724307).  Saving model ...
Epoch: 7 cost time: 1.4075071811676025
Epoch: 7, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.620 Vali Acc: 0.789 Test Loss: 1.620 Test Acc: 0.789
Validation loss decreased (-0.724307 --> -0.789173).  Saving model ...
Epoch: 8 cost time: 1.0692920684814453
Epoch: 8, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.502 Vali Acc: 0.803 Test Loss: 1.502 Test Acc: 0.803
Validation loss decreased (-0.789173 --> -0.802688).  Saving model ...
Epoch: 9 cost time: 1.1678125858306885
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.379 Vali Acc: 0.830 Test Loss: 1.379 Test Acc: 0.830
Validation loss decreased (-0.802688 --> -0.829716).  Saving model ...
Epoch: 10 cost time: 1.186115026473999
Epoch: 10, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.263 Vali Acc: 0.822 Test Loss: 1.263 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6288783550262451
Epoch: 11, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.154 Vali Acc: 0.832 Test Loss: 1.154 Test Acc: 0.832
Validation loss decreased (-0.829716 --> -0.832421).  Saving model ...
Epoch: 12 cost time: 1.5681321620941162
Epoch: 12, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.052 Vali Acc: 0.830 Test Loss: 1.052 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4029560089111328
Epoch: 13, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.961 Vali Acc: 0.843 Test Loss: 0.961 Test Acc: 0.843
Validation loss decreased (-0.832421 --> -0.843234).  Saving model ...
Epoch: 14 cost time: 1.4608068466186523
Epoch: 14, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.880 Vali Acc: 0.857 Test Loss: 0.880 Test Acc: 0.857
Validation loss decreased (-0.843234 --> -0.856748).  Saving model ...
Epoch: 15 cost time: 1.5100431442260742
Epoch: 15, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.805 Vali Acc: 0.859 Test Loss: 0.805 Test Acc: 0.859
Validation loss decreased (-0.856748 --> -0.859451).  Saving model ...
Epoch: 16 cost time: 1.1530029773712158
Epoch: 16, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.748 Vali Acc: 0.857 Test Loss: 0.748 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.234494686126709
Epoch: 17, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.689 Vali Acc: 0.873 Test Loss: 0.689 Test Acc: 0.873
Validation loss decreased (-0.859451 --> -0.872966).  Saving model ...
Epoch: 18 cost time: 1.4945473670959473
Epoch: 18, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.643 Vali Acc: 0.868 Test Loss: 0.643 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1805896759033203
Epoch: 19, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.597 Vali Acc: 0.881 Test Loss: 0.597 Test Acc: 0.881
Validation loss decreased (-0.872966 --> -0.881075).  Saving model ...
Epoch: 20 cost time: 1.2799265384674072
Epoch: 20, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.564 Vali Acc: 0.886 Test Loss: 0.564 Test Acc: 0.886
Validation loss decreased (-0.881075 --> -0.886481).  Saving model ...
Epoch: 21 cost time: 1.2340867519378662
Epoch: 21, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.524 Vali Acc: 0.895 Test Loss: 0.524 Test Acc: 0.895
Validation loss decreased (-0.886481 --> -0.894589).  Saving model ...
Epoch: 22 cost time: 1.2361292839050293
Epoch: 22, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.491 Vali Acc: 0.908 Test Loss: 0.491 Test Acc: 0.908
Validation loss decreased (-0.894589 --> -0.908103).  Saving model ...
Epoch: 23 cost time: 1.172022819519043
Epoch: 23, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.472 Vali Acc: 0.895 Test Loss: 0.472 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.370048999786377
Epoch: 24, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910806).  Saving model ...
Epoch: 25 cost time: 1.449049472808838
Epoch: 25, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.425 Vali Acc: 0.905 Test Loss: 0.425 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4292047023773193
Epoch: 26, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.404 Vali Acc: 0.914 Test Loss: 0.404 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 27 cost time: 1.2122132778167725
Epoch: 27, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.390 Vali Acc: 0.919 Test Loss: 0.390 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 1.4987807273864746
Epoch: 28, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 29 cost time: 1.3110480308532715
Epoch: 29, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 30 cost time: 1.4229063987731934
Epoch: 30, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.348 Vali Acc: 0.919 Test Loss: 0.348 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 31 cost time: 1.2869679927825928
Epoch: 31, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918916).  Saving model ...
Epoch: 32 cost time: 1.6268041133880615
Epoch: 32, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921618).  Saving model ...
Epoch: 33 cost time: 1.235351800918579
Epoch: 33, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
Epoch: 34 cost time: 1.4475512504577637
Epoch: 34, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921619).  Saving model ...
Epoch: 35 cost time: 1.2310843467712402
Epoch: 35, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.288 Vali Acc: 0.927 Test Loss: 0.288 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927024).  Saving model ...
Epoch: 36 cost time: 1.1355667114257812
Epoch: 36, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.291 Vali Acc: 0.924 Test Loss: 0.291 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1911656856536865
Epoch: 37, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.276 Vali Acc: 0.927 Test Loss: 0.276 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 38 cost time: 1.3666815757751465
Epoch: 38, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3672523498535156
Epoch: 39, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.266 Vali Acc: 0.927 Test Loss: 0.266 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 40 cost time: 1.2434487342834473
Epoch: 40, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.263 Vali Acc: 0.927 Test Loss: 0.263 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 41 cost time: 1.490283727645874
Epoch: 41, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 42 cost time: 1.453932762145996
Epoch: 42, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 43 cost time: 1.0913193225860596
Epoch: 43, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 44 cost time: 1.2053883075714111
Epoch: 44, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.353424310684204
Epoch: 45, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9628736972808838
Epoch: 46, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1840627193450928
Epoch: 47, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 48 cost time: 1.0831246376037598
Epoch: 48, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.251 Vali Acc: 0.927 Test Loss: 0.251 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.386605978012085
Epoch: 49, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.4430317878723145
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 51 cost time: 1.1594297885894775
Epoch: 51, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 52 cost time: 1.1935276985168457
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 53 cost time: 1.2172996997833252
Epoch: 53, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.234 Vali Acc: 0.932 Test Loss: 0.234 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 54 cost time: 1.3457856178283691
Epoch: 54, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0541038513183594
Epoch: 55, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.500112533569336
Epoch: 56, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.234 Vali Acc: 0.927 Test Loss: 0.234 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.492659330368042
Epoch: 57, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 58 cost time: 1.5041871070861816
Epoch: 58, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.927 Test Loss: 0.231 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.187831163406372
Epoch: 59, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.3678600788116455
Epoch: 60, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2557923793792725
Epoch: 61, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.932 Test Loss: 0.227 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 62 cost time: 1.1966907978057861
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.234 Vali Acc: 0.924 Test Loss: 0.234 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.347579002380371
Epoch: 63, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 64 cost time: 1.083268404006958
Epoch: 64, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.924 Test Loss: 0.227 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2511396408081055
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.924 Test Loss: 0.230 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.1136491298675537
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.553466796875
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.1206467151641846
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.1660194396972656
Epoch: 69, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.2141084671020508
Epoch: 70, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.927 Test Loss: 0.217 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.1036500930786133
Epoch: 71, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 72 cost time: 1.1236929893493652
Epoch: 72, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 73 cost time: 1.0879082679748535
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.927 Test Loss: 0.227 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.075578212738037
Epoch: 74, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.1883671283721924
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.087343454360962
Epoch: 76, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.0335018634796143
Epoch: 77, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.256073236465454
Epoch: 78, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.1197090148925781
Epoch: 79, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.260728359222412
Epoch: 80, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.103909969329834
Epoch: 81, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.927 Test Loss: 0.228 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.2786064147949219
Epoch: 82, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9351351351351351
model parameter : 19367
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.024324893951416
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.200 Vali Acc: 0.076 Test Loss: 2.200 Test Acc: 0.076
Validation loss decreased (inf --> -0.075654).  Saving model ...
Epoch: 2 cost time: 1.0876140594482422
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.138 Vali Acc: 0.130 Test Loss: 2.138 Test Acc: 0.130
Validation loss decreased (-0.075654 --> -0.129708).  Saving model ...
Epoch: 3 cost time: 1.458101749420166
Epoch: 3, Steps: 17 | Train Loss: 2.096 Vali Loss: 2.057 Vali Acc: 0.278 Test Loss: 2.057 Test Acc: 0.278
Validation loss decreased (-0.129708 --> -0.278358).  Saving model ...
Epoch: 4 cost time: 1.1139063835144043
Epoch: 4, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.962 Vali Acc: 0.443 Test Loss: 1.962 Test Acc: 0.443
Validation loss decreased (-0.278358 --> -0.443224).  Saving model ...
Epoch: 5 cost time: 1.3464641571044922
Epoch: 5, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.856 Vali Acc: 0.570 Test Loss: 1.856 Test Acc: 0.570
Validation loss decreased (-0.443224 --> -0.570252).  Saving model ...
Epoch: 6 cost time: 1.2867348194122314
Epoch: 6, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.741 Vali Acc: 0.651 Test Loss: 1.741 Test Acc: 0.651
Validation loss decreased (-0.570252 --> -0.651334).  Saving model ...
Epoch: 7 cost time: 1.2499229907989502
Epoch: 7, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.618 Vali Acc: 0.724 Test Loss: 1.618 Test Acc: 0.724
Validation loss decreased (-0.651334 --> -0.724308).  Saving model ...
Epoch: 8 cost time: 1.2854423522949219
Epoch: 8, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.489 Vali Acc: 0.773 Test Loss: 1.489 Test Acc: 0.773
Validation loss decreased (-0.724308 --> -0.772958).  Saving model ...
Epoch: 9 cost time: 1.0693821907043457
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.358 Vali Acc: 0.805 Test Loss: 1.358 Test Acc: 0.805
Validation loss decreased (-0.772958 --> -0.805392).  Saving model ...
Epoch: 10 cost time: 1.1528210639953613
Epoch: 10, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.242 Vali Acc: 0.819 Test Loss: 1.242 Test Acc: 0.819
Validation loss decreased (-0.805392 --> -0.818906).  Saving model ...
Epoch: 11 cost time: 1.2480285167694092
Epoch: 11, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.132 Vali Acc: 0.832 Test Loss: 1.132 Test Acc: 0.832
Validation loss decreased (-0.818906 --> -0.832421).  Saving model ...
Epoch: 12 cost time: 1.346146583557129
Epoch: 12, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.038 Vali Acc: 0.835 Test Loss: 1.038 Test Acc: 0.835
Validation loss decreased (-0.832421 --> -0.835125).  Saving model ...
Epoch: 13 cost time: 1.1056523323059082
Epoch: 13, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.956 Vali Acc: 0.851 Test Loss: 0.956 Test Acc: 0.851
Validation loss decreased (-0.835125 --> -0.851342).  Saving model ...
Epoch: 14 cost time: 1.0392615795135498
Epoch: 14, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.882 Vali Acc: 0.859 Test Loss: 0.882 Test Acc: 0.859
Validation loss decreased (-0.851342 --> -0.859451).  Saving model ...
Epoch: 15 cost time: 1.1830759048461914
Epoch: 15, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.817 Vali Acc: 0.878 Test Loss: 0.817 Test Acc: 0.878
Validation loss decreased (-0.859451 --> -0.878370).  Saving model ...
Epoch: 16 cost time: 1.1313726902008057
Epoch: 16, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.762 Vali Acc: 0.878 Test Loss: 0.762 Test Acc: 0.878
Validation loss decreased (-0.878370 --> -0.878371).  Saving model ...
Epoch: 17 cost time: 1.3209209442138672
Epoch: 17, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.708 Vali Acc: 0.892 Test Loss: 0.708 Test Acc: 0.892
Validation loss decreased (-0.878371 --> -0.891885).  Saving model ...
Epoch: 18 cost time: 1.2772009372711182
Epoch: 18, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.661 Vali Acc: 0.892 Test Loss: 0.661 Test Acc: 0.892
Validation loss decreased (-0.891885 --> -0.891885).  Saving model ...
Epoch: 19 cost time: 1.0891480445861816
Epoch: 19, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.622 Vali Acc: 0.897 Test Loss: 0.622 Test Acc: 0.897
Validation loss decreased (-0.891885 --> -0.897291).  Saving model ...
Epoch: 20 cost time: 1.3164591789245605
Epoch: 20, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.585 Vali Acc: 0.892 Test Loss: 0.585 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0265827178955078
Epoch: 21, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.549 Vali Acc: 0.897 Test Loss: 0.549 Test Acc: 0.897
Validation loss decreased (-0.897291 --> -0.897292).  Saving model ...
Epoch: 22 cost time: 1.368882656097412
Epoch: 22, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
Validation loss decreased (-0.897292 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.2045745849609375
Epoch: 23, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.494 Vali Acc: 0.903 Test Loss: 0.494 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902698).  Saving model ...
Epoch: 24 cost time: 1.2927639484405518
Epoch: 24, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.466 Vali Acc: 0.905 Test Loss: 0.466 Test Acc: 0.905
Validation loss decreased (-0.902698 --> -0.905401).  Saving model ...
Epoch: 25 cost time: 1.464404582977295
Epoch: 25, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.445 Vali Acc: 0.905 Test Loss: 0.445 Test Acc: 0.905
Validation loss decreased (-0.905401 --> -0.905401).  Saving model ...
Epoch: 26 cost time: 1.2542774677276611
Epoch: 26, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
Validation loss decreased (-0.905401 --> -0.910807).  Saving model ...
Epoch: 27 cost time: 1.3506295680999756
Epoch: 27, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.403 Vali Acc: 0.919 Test Loss: 0.403 Test Acc: 0.919
Validation loss decreased (-0.910807 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 1.1747775077819824
Epoch: 28, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.384 Vali Acc: 0.927 Test Loss: 0.384 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927023).  Saving model ...
Epoch: 29 cost time: 1.285116195678711
Epoch: 29, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.367 Vali Acc: 0.914 Test Loss: 0.367 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3688359260559082
Epoch: 30, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.350 Vali Acc: 0.927 Test Loss: 0.350 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927024).  Saving model ...
Epoch: 31 cost time: 0.982560396194458
Epoch: 31, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.342 Vali Acc: 0.927 Test Loss: 0.342 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 32 cost time: 1.082930326461792
Epoch: 32, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.328 Vali Acc: 0.927 Test Loss: 0.328 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 33 cost time: 1.2285354137420654
Epoch: 33, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.324 Vali Acc: 0.927 Test Loss: 0.324 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 34 cost time: 1.264718770980835
Epoch: 34, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.308 Vali Acc: 0.924 Test Loss: 0.308 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3512187004089355
Epoch: 35, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.292 Vali Acc: 0.932 Test Loss: 0.292 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 36 cost time: 1.2923102378845215
Epoch: 36, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.287 Vali Acc: 0.932 Test Loss: 0.287 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 37 cost time: 1.2005655765533447
Epoch: 37, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.278 Vali Acc: 0.927 Test Loss: 0.278 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0789885520935059
Epoch: 38, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935132).  Saving model ...
Epoch: 39 cost time: 1.176959753036499
Epoch: 39, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2346553802490234
Epoch: 40, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935133).  Saving model ...
Epoch: 41 cost time: 1.034590482711792
Epoch: 41, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.932 Test Loss: 0.250 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4610512256622314
Epoch: 42, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 43 cost time: 1.115696907043457
Epoch: 43, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 44 cost time: 1.1377863883972168
Epoch: 44, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1369664669036865
Epoch: 45, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0698082447052002
Epoch: 46, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 47 cost time: 1.1055653095245361
Epoch: 47, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1650030612945557
Epoch: 48, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 49 cost time: 1.1684885025024414
Epoch: 49, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0733258724212646
Epoch: 50, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.414180040359497
Epoch: 51, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.4985992908477783
Epoch: 52, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.424633264541626
Epoch: 53, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.7365853786468506
Epoch: 54, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.4215736389160156
Epoch: 55, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.932 Test Loss: 0.213 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.562446117401123
Epoch: 56, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.9140291213989258
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 58 cost time: 0.9778854846954346
Epoch: 58, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.6372761726379395
Epoch: 59, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2585396766662598
Epoch: 60, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.5501580238342285
Epoch: 61, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.5601530075073242
Epoch: 62, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.5352602005004883
Epoch: 63, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.2873048782348633
Epoch: 64, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.5707941055297852
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.433708667755127
Epoch: 66, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.938 Test Loss: 0.198 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.4433035850524902
Epoch: 67, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 19111
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5506112575531006
Epoch: 1, Steps: 17 | Train Loss: 2.275 Vali Loss: 2.186 Vali Acc: 0.149 Test Loss: 2.186 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 1.2101256847381592
Epoch: 2, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.121 Vali Acc: 0.214 Test Loss: 2.121 Test Acc: 0.214
Validation loss decreased (-0.148627 --> -0.213492).  Saving model ...
Epoch: 3 cost time: 1.0612192153930664
Epoch: 3, Steps: 17 | Train Loss: 2.137 Vali Loss: 2.035 Vali Acc: 0.319 Test Loss: 2.035 Test Acc: 0.319
Validation loss decreased (-0.213492 --> -0.318899).  Saving model ...
Epoch: 4 cost time: 1.1919105052947998
Epoch: 4, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.936 Vali Acc: 0.503 Test Loss: 1.936 Test Acc: 0.503
Validation loss decreased (-0.318899 --> -0.502683).  Saving model ...
Epoch: 5 cost time: 1.2511160373687744
Epoch: 5, Steps: 17 | Train Loss: 1.907 Vali Loss: 1.822 Vali Acc: 0.668 Test Loss: 1.822 Test Acc: 0.668
Validation loss decreased (-0.502683 --> -0.667549).  Saving model ...
Epoch: 6 cost time: 0.9581706523895264
Epoch: 6, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.704 Vali Acc: 0.759 Test Loss: 1.704 Test Acc: 0.759
Validation loss decreased (-0.667549 --> -0.759442).  Saving model ...
Epoch: 7 cost time: 1.161478042602539
Epoch: 7, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.580 Vali Acc: 0.803 Test Loss: 1.580 Test Acc: 0.803
Validation loss decreased (-0.759442 --> -0.802687).  Saving model ...
Epoch: 8 cost time: 1.1010348796844482
Epoch: 8, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.456 Vali Acc: 0.832 Test Loss: 1.456 Test Acc: 0.832
Validation loss decreased (-0.802687 --> -0.832418).  Saving model ...
Epoch: 9 cost time: 1.049400806427002
Epoch: 9, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.336 Vali Acc: 0.846 Test Loss: 1.336 Test Acc: 0.846
Validation loss decreased (-0.832418 --> -0.845933).  Saving model ...
Epoch: 10 cost time: 1.3328070640563965
Epoch: 10, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.212 Vali Acc: 0.857 Test Loss: 1.212 Test Acc: 0.857
Validation loss decreased (-0.845933 --> -0.856745).  Saving model ...
Epoch: 11 cost time: 1.1415534019470215
Epoch: 11, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.108 Vali Acc: 0.868 Test Loss: 1.108 Test Acc: 0.868
Validation loss decreased (-0.856745 --> -0.867556).  Saving model ...
Epoch: 12 cost time: 1.4285929203033447
Epoch: 12, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.008 Vali Acc: 0.878 Test Loss: 1.008 Test Acc: 0.878
Validation loss decreased (-0.867556 --> -0.878368).  Saving model ...
Epoch: 13 cost time: 1.1564762592315674
Epoch: 13, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.920 Vali Acc: 0.881 Test Loss: 0.920 Test Acc: 0.881
Validation loss decreased (-0.878368 --> -0.881072).  Saving model ...
Epoch: 14 cost time: 1.2450599670410156
Epoch: 14, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.841 Vali Acc: 0.892 Test Loss: 0.841 Test Acc: 0.892
Validation loss decreased (-0.881072 --> -0.891883).  Saving model ...
Epoch: 15 cost time: 1.0756282806396484
Epoch: 15, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.773 Vali Acc: 0.897 Test Loss: 0.773 Test Acc: 0.897
Validation loss decreased (-0.891883 --> -0.897290).  Saving model ...
Epoch: 16 cost time: 1.3582525253295898
Epoch: 16, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.720 Vali Acc: 0.895 Test Loss: 0.720 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3645296096801758
Epoch: 17, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.665 Vali Acc: 0.905 Test Loss: 0.665 Test Acc: 0.905
Validation loss decreased (-0.897290 --> -0.905399).  Saving model ...
Epoch: 18 cost time: 1.360248327255249
Epoch: 18, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.622 Vali Acc: 0.905 Test Loss: 0.622 Test Acc: 0.905
Validation loss decreased (-0.905399 --> -0.905399).  Saving model ...
Epoch: 19 cost time: 1.5181117057800293
Epoch: 19, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.585 Vali Acc: 0.905 Test Loss: 0.585 Test Acc: 0.905
Validation loss decreased (-0.905399 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 1.3086481094360352
Epoch: 20, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.548 Vali Acc: 0.908 Test Loss: 0.548 Test Acc: 0.908
Validation loss decreased (-0.905400 --> -0.908103).  Saving model ...
Epoch: 21 cost time: 1.1647751331329346
Epoch: 21, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.514 Vali Acc: 0.919 Test Loss: 0.514 Test Acc: 0.919
Validation loss decreased (-0.908103 --> -0.918914).  Saving model ...
Epoch: 22 cost time: 1.4800755977630615
Epoch: 22, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.492 Vali Acc: 0.916 Test Loss: 0.492 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3024790287017822
Epoch: 23, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.464 Vali Acc: 0.932 Test Loss: 0.464 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932428).  Saving model ...
Epoch: 24 cost time: 1.3231391906738281
Epoch: 24, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.442 Vali Acc: 0.927 Test Loss: 0.442 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3539488315582275
Epoch: 25, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.418 Vali Acc: 0.941 Test Loss: 0.418 Test Acc: 0.941
Validation loss decreased (-0.932428 --> -0.940536).  Saving model ...
Epoch: 26 cost time: 1.0427544116973877
Epoch: 26, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.401 Vali Acc: 0.935 Test Loss: 0.401 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.134739637374878
Epoch: 27, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.383 Vali Acc: 0.946 Test Loss: 0.383 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 28 cost time: 1.2380530834197998
Epoch: 28, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.368 Vali Acc: 0.946 Test Loss: 0.368 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945942).  Saving model ...
Epoch: 29 cost time: 1.3937995433807373
Epoch: 29, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.352 Vali Acc: 0.946 Test Loss: 0.352 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945942).  Saving model ...
Epoch: 30 cost time: 1.2196943759918213
Epoch: 30, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.337 Vali Acc: 0.943 Test Loss: 0.337 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1032023429870605
Epoch: 31, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.324 Vali Acc: 0.943 Test Loss: 0.324 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3664240837097168
Epoch: 32, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.315 Vali Acc: 0.943 Test Loss: 0.315 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.224982500076294
Epoch: 33, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.304 Vali Acc: 0.943 Test Loss: 0.304 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1684105396270752
Epoch: 34, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.298 Vali Acc: 0.946 Test Loss: 0.298 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
Epoch: 35 cost time: 1.1347432136535645
Epoch: 35, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 36 cost time: 1.1455442905426025
Epoch: 36, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.275 Vali Acc: 0.946 Test Loss: 0.275 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 37 cost time: 0.9625990390777588
Epoch: 37, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.275 Vali Acc: 0.943 Test Loss: 0.275 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8568892478942871
Epoch: 38, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.269 Vali Acc: 0.946 Test Loss: 0.269 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 39 cost time: 1.0328056812286377
Epoch: 39, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 40 cost time: 0.8494760990142822
Epoch: 40, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.257 Vali Acc: 0.946 Test Loss: 0.257 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 41 cost time: 1.341409683227539
Epoch: 41, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 42 cost time: 0.9573235511779785
Epoch: 42, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.248 Vali Acc: 0.943 Test Loss: 0.248 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4450688362121582
Epoch: 43, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 44 cost time: 1.124821424484253
Epoch: 44, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1664879322052002
Epoch: 45, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 46 cost time: 0.9730656147003174
Epoch: 46, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.172720193862915
Epoch: 47, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 48 cost time: 1.1249117851257324
Epoch: 48, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 49 cost time: 1.1473791599273682
Epoch: 49, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1970837116241455
Epoch: 50, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 51 cost time: 1.414588451385498
Epoch: 51, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.406270980834961
Epoch: 52, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 53 cost time: 1.0348641872406006
Epoch: 53, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 54 cost time: 1.3285856246948242
Epoch: 54, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.348787784576416
Epoch: 55, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.3804566860198975
Epoch: 56, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.132140874862671
Epoch: 57, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 58 cost time: 1.2423863410949707
Epoch: 58, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2244486808776855
Epoch: 59, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2813313007354736
Epoch: 60, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.5287742614746094
Epoch: 61, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.3183677196502686
Epoch: 62, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.4314022064208984
Epoch: 63, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.315692663192749
Epoch: 64, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.220494031906128
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 66 cost time: 1.1589856147766113
Epoch: 66, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 67 cost time: 1.1582043170928955
Epoch: 67, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1135303974151611
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9667320251464844
Epoch: 69, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.06587815284729
Epoch: 70, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.0604827404022217
Epoch: 71, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.1043176651000977
Epoch: 72, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.2199976444244385
Epoch: 73, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.1435229778289795
Epoch: 74, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.109464406967163
Epoch: 75, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.924262285232544
Epoch: 76, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 18855
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8128252029418945
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 2.213 Vali Acc: 0.103 Test Loss: 2.213 Test Acc: 0.103
Validation loss decreased (inf --> -0.102681).  Saving model ...
Epoch: 2 cost time: 0.957303524017334
Epoch: 2, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.154 Vali Acc: 0.157 Test Loss: 2.154 Test Acc: 0.157
Validation loss decreased (-0.102681 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 1.083918809890747
Epoch: 3, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.070 Vali Acc: 0.257 Test Loss: 2.070 Test Acc: 0.257
Validation loss decreased (-0.156735 --> -0.256736).  Saving model ...
Epoch: 4 cost time: 0.9204788208007812
Epoch: 4, Steps: 17 | Train Loss: 2.032 Vali Loss: 1.977 Vali Acc: 0.403 Test Loss: 1.977 Test Acc: 0.403
Validation loss decreased (-0.256736 --> -0.402683).  Saving model ...
Epoch: 5 cost time: 0.9558286666870117
Epoch: 5, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.874 Vali Acc: 0.543 Test Loss: 1.874 Test Acc: 0.543
Validation loss decreased (-0.402683 --> -0.543225).  Saving model ...
Epoch: 6 cost time: 1.0276339054107666
Epoch: 6, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.765 Vali Acc: 0.643 Test Loss: 1.765 Test Acc: 0.643
Validation loss decreased (-0.543225 --> -0.643226).  Saving model ...
Epoch: 7 cost time: 0.9035992622375488
Epoch: 7, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.652 Vali Acc: 0.722 Test Loss: 1.652 Test Acc: 0.722
Validation loss decreased (-0.643226 --> -0.721605).  Saving model ...
Epoch: 8 cost time: 1.160581111907959
Epoch: 8, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.533 Vali Acc: 0.778 Test Loss: 1.533 Test Acc: 0.778
Validation loss decreased (-0.721605 --> -0.778363).  Saving model ...
Epoch: 9 cost time: 0.9146342277526855
Epoch: 9, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.413 Vali Acc: 0.800 Test Loss: 1.413 Test Acc: 0.800
Validation loss decreased (-0.778363 --> -0.799986).  Saving model ...
Epoch: 10 cost time: 1.033588171005249
Epoch: 10, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.288 Vali Acc: 0.811 Test Loss: 1.288 Test Acc: 0.811
Validation loss decreased (-0.799986 --> -0.810798).  Saving model ...
Epoch: 11 cost time: 1.0877671241760254
Epoch: 11, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.174 Vali Acc: 0.822 Test Loss: 1.174 Test Acc: 0.822
Validation loss decreased (-0.810798 --> -0.821610).  Saving model ...
Epoch: 12 cost time: 1.09708833694458
Epoch: 12, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.063 Vali Acc: 0.832 Test Loss: 1.063 Test Acc: 0.832
Validation loss decreased (-0.821610 --> -0.832422).  Saving model ...
Epoch: 13 cost time: 0.9725625514984131
Epoch: 13, Steps: 17 | Train Loss: 0.927 Vali Loss: 0.960 Vali Acc: 0.846 Test Loss: 0.960 Test Acc: 0.846
Validation loss decreased (-0.832422 --> -0.845936).  Saving model ...
Epoch: 14 cost time: 1.542484998703003
Epoch: 14, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.873 Vali Acc: 0.865 Test Loss: 0.873 Test Acc: 0.865
Validation loss decreased (-0.845936 --> -0.864856).  Saving model ...
Epoch: 15 cost time: 1.1721303462982178
Epoch: 15, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.796 Vali Acc: 0.881 Test Loss: 0.796 Test Acc: 0.881
Validation loss decreased (-0.864856 --> -0.881073).  Saving model ...
Epoch: 16 cost time: 1.1547634601593018
Epoch: 16, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.726 Vali Acc: 0.884 Test Loss: 0.726 Test Acc: 0.884
Validation loss decreased (-0.881073 --> -0.883777).  Saving model ...
Epoch: 17 cost time: 1.3146388530731201
Epoch: 17, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.669 Vali Acc: 0.897 Test Loss: 0.669 Test Acc: 0.897
Validation loss decreased (-0.883777 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 1.0930886268615723
Epoch: 18, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.617 Vali Acc: 0.903 Test Loss: 0.617 Test Acc: 0.903
Validation loss decreased (-0.897291 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 1.0641474723815918
Epoch: 19, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.574 Vali Acc: 0.905 Test Loss: 0.574 Test Acc: 0.905
Validation loss decreased (-0.902697 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 1.2797510623931885
Epoch: 20, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.532 Vali Acc: 0.916 Test Loss: 0.532 Test Acc: 0.916
Validation loss decreased (-0.905400 --> -0.916211).  Saving model ...
Epoch: 21 cost time: 1.270214319229126
Epoch: 21, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.495 Vali Acc: 0.916 Test Loss: 0.495 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916211).  Saving model ...
Epoch: 22 cost time: 1.1456358432769775
Epoch: 22, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.467 Vali Acc: 0.922 Test Loss: 0.467 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921617).  Saving model ...
Epoch: 23 cost time: 1.257974624633789
Epoch: 23, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.442 Vali Acc: 0.927 Test Loss: 0.442 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 24 cost time: 1.1349997520446777
Epoch: 24, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.421 Vali Acc: 0.927 Test Loss: 0.421 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 25 cost time: 1.191847324371338
Epoch: 25, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.400 Vali Acc: 0.927 Test Loss: 0.400 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 26 cost time: 1.0972926616668701
Epoch: 26, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.381 Vali Acc: 0.922 Test Loss: 0.381 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3035752773284912
Epoch: 27, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.361 Vali Acc: 0.927 Test Loss: 0.361 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 28 cost time: 1.1889607906341553
Epoch: 28, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9864022731781006
Epoch: 29, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0737061500549316
Epoch: 30, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927024).  Saving model ...
Epoch: 31 cost time: 1.0763988494873047
Epoch: 31, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.921107292175293
Epoch: 32, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 33 cost time: 1.0870842933654785
Epoch: 33, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.296 Vali Acc: 0.927 Test Loss: 0.296 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0677180290222168
Epoch: 34, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.289 Vali Acc: 0.935 Test Loss: 0.289 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935132).  Saving model ...
Epoch: 35 cost time: 1.096827745437622
Epoch: 35, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.277 Vali Acc: 0.935 Test Loss: 0.277 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 36 cost time: 0.98783278465271
Epoch: 36, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.276 Vali Acc: 0.932 Test Loss: 0.276 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9636492729187012
Epoch: 37, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.268 Vali Acc: 0.938 Test Loss: 0.268 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 38 cost time: 1.09816312789917
Epoch: 38, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 39 cost time: 0.8246698379516602
Epoch: 39, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.250 Vali Acc: 0.946 Test Loss: 0.250 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945943).  Saving model ...
Epoch: 40 cost time: 1.033607006072998
Epoch: 40, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0012359619140625
Epoch: 41, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.248 Vali Acc: 0.949 Test Loss: 0.248 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 42 cost time: 1.2585313320159912
Epoch: 42, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 43 cost time: 1.0885975360870361
Epoch: 43, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9291081428527832
Epoch: 44, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.235 Vali Acc: 0.949 Test Loss: 0.235 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 45 cost time: 1.02801513671875
Epoch: 45, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.951 Test Loss: 0.237 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 46 cost time: 1.1250088214874268
Epoch: 46, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2064101696014404
Epoch: 47, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1727831363677979
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9038286209106445
Epoch: 49, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1756794452667236
Epoch: 50, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2285878658294678
Epoch: 51, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.3195090293884277
Epoch: 52, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.3012678623199463
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.0288844108581543
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2300901412963867
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 18599
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.708177328109741
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 2.213 Vali Acc: 0.103 Test Loss: 2.213 Test Acc: 0.103
Validation loss decreased (inf --> -0.102681).  Saving model ...
Epoch: 2 cost time: 0.8200585842132568
Epoch: 2, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.154 Vali Acc: 0.157 Test Loss: 2.154 Test Acc: 0.157
Validation loss decreased (-0.102681 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 0.7356653213500977
Epoch: 3, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.070 Vali Acc: 0.257 Test Loss: 2.070 Test Acc: 0.257
Validation loss decreased (-0.156735 --> -0.256736).  Saving model ...
Epoch: 4 cost time: 0.8776645660400391
Epoch: 4, Steps: 17 | Train Loss: 2.032 Vali Loss: 1.977 Vali Acc: 0.403 Test Loss: 1.977 Test Acc: 0.403
Validation loss decreased (-0.256736 --> -0.402683).  Saving model ...
Epoch: 5 cost time: 0.7942664623260498
Epoch: 5, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.874 Vali Acc: 0.543 Test Loss: 1.874 Test Acc: 0.543
Validation loss decreased (-0.402683 --> -0.543225).  Saving model ...
Epoch: 6 cost time: 0.8218715190887451
Epoch: 6, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.765 Vali Acc: 0.643 Test Loss: 1.765 Test Acc: 0.643
Validation loss decreased (-0.543225 --> -0.643226).  Saving model ...
Epoch: 7 cost time: 0.8394906520843506
Epoch: 7, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.652 Vali Acc: 0.722 Test Loss: 1.652 Test Acc: 0.722
Validation loss decreased (-0.643226 --> -0.721605).  Saving model ...
Epoch: 8 cost time: 0.7867429256439209
Epoch: 8, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.533 Vali Acc: 0.778 Test Loss: 1.533 Test Acc: 0.778
Validation loss decreased (-0.721605 --> -0.778363).  Saving model ...
Epoch: 9 cost time: 0.8047285079956055
Epoch: 9, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.413 Vali Acc: 0.800 Test Loss: 1.413 Test Acc: 0.800
Validation loss decreased (-0.778363 --> -0.799986).  Saving model ...
Epoch: 10 cost time: 1.0260121822357178
Epoch: 10, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.288 Vali Acc: 0.811 Test Loss: 1.288 Test Acc: 0.811
Validation loss decreased (-0.799986 --> -0.810798).  Saving model ...
Epoch: 11 cost time: 0.89017653465271
Epoch: 11, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.174 Vali Acc: 0.822 Test Loss: 1.174 Test Acc: 0.822
Validation loss decreased (-0.810798 --> -0.821610).  Saving model ...
Epoch: 12 cost time: 0.860748291015625
Epoch: 12, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.063 Vali Acc: 0.832 Test Loss: 1.063 Test Acc: 0.832
Validation loss decreased (-0.821610 --> -0.832422).  Saving model ...
Epoch: 13 cost time: 0.9970617294311523
Epoch: 13, Steps: 17 | Train Loss: 0.927 Vali Loss: 0.960 Vali Acc: 0.846 Test Loss: 0.960 Test Acc: 0.846
Validation loss decreased (-0.832422 --> -0.845936).  Saving model ...
Epoch: 14 cost time: 0.8235454559326172
Epoch: 14, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.873 Vali Acc: 0.865 Test Loss: 0.873 Test Acc: 0.865
Validation loss decreased (-0.845936 --> -0.864856).  Saving model ...
Epoch: 15 cost time: 0.9624209403991699
Epoch: 15, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.796 Vali Acc: 0.881 Test Loss: 0.796 Test Acc: 0.881
Validation loss decreased (-0.864856 --> -0.881073).  Saving model ...
Epoch: 16 cost time: 1.1687469482421875
Epoch: 16, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.726 Vali Acc: 0.884 Test Loss: 0.726 Test Acc: 0.884
Validation loss decreased (-0.881073 --> -0.883777).  Saving model ...
Epoch: 17 cost time: 0.7971146106719971
Epoch: 17, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.669 Vali Acc: 0.897 Test Loss: 0.669 Test Acc: 0.897
Validation loss decreased (-0.883777 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 0.8228621482849121
Epoch: 18, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.617 Vali Acc: 0.903 Test Loss: 0.617 Test Acc: 0.903
Validation loss decreased (-0.897291 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 0.9733731746673584
Epoch: 19, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.574 Vali Acc: 0.905 Test Loss: 0.574 Test Acc: 0.905
Validation loss decreased (-0.902697 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 0.8906733989715576
Epoch: 20, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.532 Vali Acc: 0.916 Test Loss: 0.532 Test Acc: 0.916
Validation loss decreased (-0.905400 --> -0.916211).  Saving model ...
Epoch: 21 cost time: 0.7777829170227051
Epoch: 21, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.495 Vali Acc: 0.916 Test Loss: 0.495 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916211).  Saving model ...
Epoch: 22 cost time: 0.9544105529785156
Epoch: 22, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.467 Vali Acc: 0.922 Test Loss: 0.467 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921617).  Saving model ...
Epoch: 23 cost time: 0.9031438827514648
Epoch: 23, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.442 Vali Acc: 0.927 Test Loss: 0.442 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 24 cost time: 0.8207309246063232
Epoch: 24, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.421 Vali Acc: 0.927 Test Loss: 0.421 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 25 cost time: 0.8648624420166016
Epoch: 25, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.400 Vali Acc: 0.927 Test Loss: 0.400 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 26 cost time: 0.8521463871002197
Epoch: 26, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.381 Vali Acc: 0.922 Test Loss: 0.381 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.034198522567749
Epoch: 27, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.361 Vali Acc: 0.927 Test Loss: 0.361 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 28 cost time: 0.8861880302429199
Epoch: 28, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.784264087677002
Epoch: 29, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.980339527130127
Epoch: 30, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927024).  Saving model ...
Epoch: 31 cost time: 0.8334031105041504
Epoch: 31, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9439611434936523
Epoch: 32, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 33 cost time: 0.714637041091919
Epoch: 33, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.296 Vali Acc: 0.927 Test Loss: 0.296 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9318442344665527
Epoch: 34, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.289 Vali Acc: 0.935 Test Loss: 0.289 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935132).  Saving model ...
Epoch: 35 cost time: 0.7865750789642334
Epoch: 35, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.277 Vali Acc: 0.935 Test Loss: 0.277 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 36 cost time: 0.9616661071777344
Epoch: 36, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.276 Vali Acc: 0.932 Test Loss: 0.276 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0195772647857666
Epoch: 37, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.268 Vali Acc: 0.938 Test Loss: 0.268 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 38 cost time: 0.8949265480041504
Epoch: 38, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 39 cost time: 1.1088311672210693
Epoch: 39, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.250 Vali Acc: 0.946 Test Loss: 0.250 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945943).  Saving model ...
Epoch: 40 cost time: 0.7986211776733398
Epoch: 40, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8545749187469482
Epoch: 41, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.248 Vali Acc: 0.949 Test Loss: 0.248 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 42 cost time: 0.8074133396148682
Epoch: 42, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 43 cost time: 0.9785637855529785
Epoch: 43, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.028557538986206
Epoch: 44, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.235 Vali Acc: 0.949 Test Loss: 0.235 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 45 cost time: 1.01566481590271
Epoch: 45, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.951 Test Loss: 0.237 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 46 cost time: 0.7804510593414307
Epoch: 46, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6910185813903809
Epoch: 47, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.746880054473877
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9255955219268799
Epoch: 49, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.114166498184204
Epoch: 50, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7669386863708496
Epoch: 51, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8790407180786133
Epoch: 52, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8961181640625
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.977776288986206
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8759720325469971
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 18599
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3873209953308105
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.193 Vali Acc: 0.105 Test Loss: 2.193 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 0.9957382678985596
Epoch: 2, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.133 Vali Acc: 0.141 Test Loss: 2.133 Test Acc: 0.141
Validation loss decreased (-0.105383 --> -0.140519).  Saving model ...
Epoch: 3 cost time: 0.9036376476287842
Epoch: 3, Steps: 17 | Train Loss: 2.086 Vali Loss: 2.055 Vali Acc: 0.238 Test Loss: 2.055 Test Acc: 0.238
Validation loss decreased (-0.140519 --> -0.237817).  Saving model ...
Epoch: 4 cost time: 1.0691940784454346
Epoch: 4, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.966 Vali Acc: 0.376 Test Loss: 1.966 Test Acc: 0.376
Validation loss decreased (-0.237817 --> -0.375656).  Saving model ...
Epoch: 5 cost time: 1.2927556037902832
Epoch: 5, Steps: 17 | Train Loss: 1.877 Vali Loss: 1.864 Vali Acc: 0.505 Test Loss: 1.864 Test Acc: 0.505
Validation loss decreased (-0.375656 --> -0.505387).  Saving model ...
Epoch: 6 cost time: 1.0667023658752441
Epoch: 6, Steps: 17 | Train Loss: 1.775 Vali Loss: 1.754 Vali Acc: 0.624 Test Loss: 1.754 Test Acc: 0.624
Validation loss decreased (-0.505387 --> -0.624307).  Saving model ...
Epoch: 7 cost time: 0.9629080295562744
Epoch: 7, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.637 Vali Acc: 0.708 Test Loss: 1.637 Test Acc: 0.708
Validation loss decreased (-0.624307 --> -0.708092).  Saving model ...
Epoch: 8 cost time: 0.9154205322265625
Epoch: 8, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.516 Vali Acc: 0.759 Test Loss: 1.516 Test Acc: 0.759
Validation loss decreased (-0.708092 --> -0.759444).  Saving model ...
Epoch: 9 cost time: 1.059065818786621
Epoch: 9, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.390 Vali Acc: 0.789 Test Loss: 1.390 Test Acc: 0.789
Validation loss decreased (-0.759444 --> -0.789175).  Saving model ...
Epoch: 10 cost time: 0.9937505722045898
Epoch: 10, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.274 Vali Acc: 0.805 Test Loss: 1.274 Test Acc: 0.805
Validation loss decreased (-0.789175 --> -0.805393).  Saving model ...
Epoch: 11 cost time: 1.0189568996429443
Epoch: 11, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.162 Vali Acc: 0.827 Test Loss: 1.162 Test Acc: 0.827
Validation loss decreased (-0.805393 --> -0.827015).  Saving model ...
Epoch: 12 cost time: 1.191943645477295
Epoch: 12, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.064 Vali Acc: 0.841 Test Loss: 1.064 Test Acc: 0.841
Validation loss decreased (-0.827015 --> -0.840530).  Saving model ...
Epoch: 13 cost time: 0.9198307991027832
Epoch: 13, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.973 Vali Acc: 0.849 Test Loss: 0.973 Test Acc: 0.849
Validation loss decreased (-0.840530 --> -0.848639).  Saving model ...
Epoch: 14 cost time: 1.262049674987793
Epoch: 14, Steps: 17 | Train Loss: 0.851 Vali Loss: 0.893 Vali Acc: 0.859 Test Loss: 0.893 Test Acc: 0.859
Validation loss decreased (-0.848639 --> -0.859451).  Saving model ...
Epoch: 15 cost time: 1.2522337436676025
Epoch: 15, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.830 Vali Acc: 0.854 Test Loss: 0.830 Test Acc: 0.854
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0851163864135742
Epoch: 16, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.770 Vali Acc: 0.865 Test Loss: 0.770 Test Acc: 0.865
Validation loss decreased (-0.859451 --> -0.864857).  Saving model ...
Epoch: 17 cost time: 1.0328500270843506
Epoch: 17, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.716 Vali Acc: 0.870 Test Loss: 0.716 Test Acc: 0.870
Validation loss decreased (-0.864857 --> -0.870263).  Saving model ...
Epoch: 18 cost time: 1.2505207061767578
Epoch: 18, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
Validation loss decreased (-0.870263 --> -0.878372).  Saving model ...
Epoch: 19 cost time: 0.9789001941680908
Epoch: 19, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.635 Vali Acc: 0.873 Test Loss: 0.635 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3620963096618652
Epoch: 20, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.597 Vali Acc: 0.884 Test Loss: 0.597 Test Acc: 0.884
Validation loss decreased (-0.878372 --> -0.883778).  Saving model ...
Epoch: 21 cost time: 1.0687737464904785
Epoch: 21, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.564 Vali Acc: 0.886 Test Loss: 0.564 Test Acc: 0.886
Validation loss decreased (-0.883778 --> -0.886481).  Saving model ...
Epoch: 22 cost time: 0.9942362308502197
Epoch: 22, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
Validation loss decreased (-0.886481 --> -0.889184).  Saving model ...
Epoch: 23 cost time: 1.2105035781860352
Epoch: 23, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.509 Vali Acc: 0.895 Test Loss: 0.509 Test Acc: 0.895
Validation loss decreased (-0.889184 --> -0.894590).  Saving model ...
Epoch: 24 cost time: 1.0850682258605957
Epoch: 24, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.489 Vali Acc: 0.897 Test Loss: 0.489 Test Acc: 0.897
Validation loss decreased (-0.894590 --> -0.897292).  Saving model ...
Epoch: 25 cost time: 1.2106399536132812
Epoch: 25, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.897292 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.9751865863800049
Epoch: 26, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902698).  Saving model ...
Epoch: 27 cost time: 1.0808990001678467
Epoch: 27, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.423 Vali Acc: 0.908 Test Loss: 0.423 Test Acc: 0.908
Validation loss decreased (-0.902698 --> -0.908104).  Saving model ...
Epoch: 28 cost time: 1.1126248836517334
Epoch: 28, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.401 Vali Acc: 0.908 Test Loss: 0.401 Test Acc: 0.908
Validation loss decreased (-0.908104 --> -0.908104).  Saving model ...
Epoch: 29 cost time: 1.3611042499542236
Epoch: 29, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.390 Vali Acc: 0.914 Test Loss: 0.390 Test Acc: 0.914
Validation loss decreased (-0.908104 --> -0.913510).  Saving model ...
Epoch: 30 cost time: 1.0911121368408203
Epoch: 30, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.373 Vali Acc: 0.914 Test Loss: 0.373 Test Acc: 0.914
Validation loss decreased (-0.913510 --> -0.913510).  Saving model ...
Epoch: 31 cost time: 1.123025894165039
Epoch: 31, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.360 Vali Acc: 0.924 Test Loss: 0.360 Test Acc: 0.924
Validation loss decreased (-0.913510 --> -0.924321).  Saving model ...
Epoch: 32 cost time: 1.1877799034118652
Epoch: 32, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.340 Vali Acc: 0.924 Test Loss: 0.340 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 33 cost time: 1.2457330226898193
Epoch: 33, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 34 cost time: 1.3673615455627441
Epoch: 34, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 35 cost time: 1.1666648387908936
Epoch: 35, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.300 Vali Acc: 0.935 Test Loss: 0.300 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935132).  Saving model ...
Epoch: 36 cost time: 1.0440027713775635
Epoch: 36, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.294 Vali Acc: 0.943 Test Loss: 0.294 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943240).  Saving model ...
Epoch: 37 cost time: 1.0844719409942627
Epoch: 37, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.286 Vali Acc: 0.935 Test Loss: 0.286 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0678215026855469
Epoch: 38, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.280 Vali Acc: 0.938 Test Loss: 0.280 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1082961559295654
Epoch: 39, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0640318393707275
Epoch: 40, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0779356956481934
Epoch: 41, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.258 Vali Acc: 0.935 Test Loss: 0.258 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0278441905975342
Epoch: 42, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1480939388275146
Epoch: 43, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3912837505340576
Epoch: 44, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943241).  Saving model ...
Epoch: 45 cost time: 1.148993968963623
Epoch: 45, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 46 cost time: 0.9594759941101074
Epoch: 46, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1204993724822998
Epoch: 47, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 48 cost time: 1.3540263175964355
Epoch: 48, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0664238929748535
Epoch: 49, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9699344635009766
Epoch: 50, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.202690839767456
Epoch: 51, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1167731285095215
Epoch: 52, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1811833381652832
Epoch: 53, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.150794506072998
Epoch: 54, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 55 cost time: 1.1135663986206055
Epoch: 55, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0865514278411865
Epoch: 56, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.072303295135498
Epoch: 57, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.125607967376709
Epoch: 58, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.0760316848754883
Epoch: 59, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.3692638874053955
Epoch: 60, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1141107082366943
Epoch: 61, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.2632734775543213
Epoch: 62, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 63 cost time: 0.9949040412902832
Epoch: 63, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1566648483276367
Epoch: 64, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 65 cost time: 0.9511117935180664
Epoch: 65, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0527892112731934
Epoch: 66, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.2334091663360596
Epoch: 67, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.1083636283874512
Epoch: 68, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.1925420761108398
Epoch: 69, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.1421747207641602
Epoch: 70, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.2013804912567139
Epoch: 71, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.169593334197998
Epoch: 72, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.0937645435333252
Epoch: 73, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.1684973239898682
Epoch: 74, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 19267
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6631391048431396
Epoch: 1, Steps: 17 | Train Loss: 2.285 Vali Loss: 2.295 Vali Acc: 0.068 Test Loss: 2.295 Test Acc: 0.068
Validation loss decreased (inf --> -0.067545).  Saving model ...
Epoch: 2 cost time: 1.000368356704712
Epoch: 2, Steps: 17 | Train Loss: 2.230 Vali Loss: 2.228 Vali Acc: 0.089 Test Loss: 2.228 Test Acc: 0.089
Validation loss decreased (-0.067545 --> -0.089167).  Saving model ...
Epoch: 3 cost time: 1.171935796737671
Epoch: 3, Steps: 17 | Train Loss: 2.147 Vali Loss: 2.143 Vali Acc: 0.149 Test Loss: 2.143 Test Acc: 0.149
Validation loss decreased (-0.089167 --> -0.148627).  Saving model ...
Epoch: 4 cost time: 1.0079829692840576
Epoch: 4, Steps: 17 | Train Loss: 2.055 Vali Loss: 2.046 Vali Acc: 0.284 Test Loss: 2.046 Test Acc: 0.284
Validation loss decreased (-0.148627 --> -0.283763).  Saving model ...
Epoch: 5 cost time: 1.105421543121338
Epoch: 5, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.943 Vali Acc: 0.470 Test Loss: 1.943 Test Acc: 0.470
Validation loss decreased (-0.283763 --> -0.470251).  Saving model ...
Epoch: 6 cost time: 1.072744369506836
Epoch: 6, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.835 Vali Acc: 0.595 Test Loss: 1.835 Test Acc: 0.595
Validation loss decreased (-0.470251 --> -0.594576).  Saving model ...
Epoch: 7 cost time: 1.1357295513153076
Epoch: 7, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.723 Vali Acc: 0.695 Test Loss: 1.723 Test Acc: 0.695
Validation loss decreased (-0.594576 --> -0.694577).  Saving model ...
Epoch: 8 cost time: 1.0042827129364014
Epoch: 8, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.605 Vali Acc: 0.751 Test Loss: 1.605 Test Acc: 0.751
Validation loss decreased (-0.694577 --> -0.751335).  Saving model ...
Epoch: 9 cost time: 1.1043639183044434
Epoch: 9, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.495 Vali Acc: 0.778 Test Loss: 1.495 Test Acc: 0.778
Validation loss decreased (-0.751335 --> -0.778363).  Saving model ...
Epoch: 10 cost time: 0.9920389652252197
Epoch: 10, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.375 Vali Acc: 0.811 Test Loss: 1.375 Test Acc: 0.811
Validation loss decreased (-0.778363 --> -0.810797).  Saving model ...
Epoch: 11 cost time: 1.135115146636963
Epoch: 11, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.259 Vali Acc: 0.822 Test Loss: 1.259 Test Acc: 0.822
Validation loss decreased (-0.810797 --> -0.821609).  Saving model ...
Epoch: 12 cost time: 1.0867066383361816
Epoch: 12, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.152 Vali Acc: 0.832 Test Loss: 1.152 Test Acc: 0.832
Validation loss decreased (-0.821609 --> -0.832421).  Saving model ...
Epoch: 13 cost time: 1.153735637664795
Epoch: 13, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.049 Vali Acc: 0.830 Test Loss: 1.049 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0789642333984375
Epoch: 14, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.962 Vali Acc: 0.843 Test Loss: 0.962 Test Acc: 0.843
Validation loss decreased (-0.832421 --> -0.843234).  Saving model ...
Epoch: 15 cost time: 1.0873088836669922
Epoch: 15, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.878 Vali Acc: 0.859 Test Loss: 0.878 Test Acc: 0.859
Validation loss decreased (-0.843234 --> -0.859451).  Saving model ...
Epoch: 16 cost time: 0.9836461544036865
Epoch: 16, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.817 Vali Acc: 0.868 Test Loss: 0.817 Test Acc: 0.868
Validation loss decreased (-0.859451 --> -0.867559).  Saving model ...
Epoch: 17 cost time: 1.1533527374267578
Epoch: 17, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.754 Vali Acc: 0.884 Test Loss: 0.754 Test Acc: 0.884
Validation loss decreased (-0.867559 --> -0.883776).  Saving model ...
Epoch: 18 cost time: 0.9612774848937988
Epoch: 18, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.697 Vali Acc: 0.884 Test Loss: 0.697 Test Acc: 0.884
Validation loss decreased (-0.883776 --> -0.883777).  Saving model ...
Epoch: 19 cost time: 0.9947760105133057
Epoch: 19, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.648 Vali Acc: 0.892 Test Loss: 0.648 Test Acc: 0.892
Validation loss decreased (-0.883777 --> -0.891885).  Saving model ...
Epoch: 20 cost time: 1.0693442821502686
Epoch: 20, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.612 Vali Acc: 0.897 Test Loss: 0.612 Test Acc: 0.897
Validation loss decreased (-0.891885 --> -0.897291).  Saving model ...
Epoch: 21 cost time: 0.9775922298431396
Epoch: 21, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.568 Vali Acc: 0.908 Test Loss: 0.568 Test Acc: 0.908
Validation loss decreased (-0.897291 --> -0.908102).  Saving model ...
Epoch: 22 cost time: 1.0573663711547852
Epoch: 22, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.535 Vali Acc: 0.908 Test Loss: 0.535 Test Acc: 0.908
Validation loss decreased (-0.908102 --> -0.908103).  Saving model ...
Epoch: 23 cost time: 1.0787181854248047
Epoch: 23, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.503 Vali Acc: 0.911 Test Loss: 0.503 Test Acc: 0.911
Validation loss decreased (-0.908103 --> -0.910806).  Saving model ...
Epoch: 24 cost time: 1.0647296905517578
Epoch: 24, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.479 Vali Acc: 0.919 Test Loss: 0.479 Test Acc: 0.919
Validation loss decreased (-0.910806 --> -0.918914).  Saving model ...
Epoch: 25 cost time: 1.0171349048614502
Epoch: 25, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.452 Vali Acc: 0.924 Test Loss: 0.452 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 0.9895927906036377
Epoch: 26, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.432 Vali Acc: 0.916 Test Loss: 0.432 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2517743110656738
Epoch: 27, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.415 Vali Acc: 0.927 Test Loss: 0.415 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 28 cost time: 1.0880446434020996
Epoch: 28, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.396 Vali Acc: 0.927 Test Loss: 0.396 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 29 cost time: 0.935443639755249
Epoch: 29, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.384 Vali Acc: 0.932 Test Loss: 0.384 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 30 cost time: 0.9610576629638672
Epoch: 30, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.361 Vali Acc: 0.935 Test Loss: 0.361 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 31 cost time: 1.0421783924102783
Epoch: 31, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.359 Vali Acc: 0.935 Test Loss: 0.359 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 32 cost time: 0.9283442497253418
Epoch: 32, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.343 Vali Acc: 0.932 Test Loss: 0.343 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0859379768371582
Epoch: 33, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.334 Vali Acc: 0.932 Test Loss: 0.334 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0152394771575928
Epoch: 34, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.315 Vali Acc: 0.938 Test Loss: 0.315 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 35 cost time: 0.9695882797241211
Epoch: 35, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.316 Vali Acc: 0.932 Test Loss: 0.316 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1868784427642822
Epoch: 36, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1912548542022705
Epoch: 37, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.297 Vali Acc: 0.935 Test Loss: 0.297 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1117424964904785
Epoch: 38, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.291 Vali Acc: 0.932 Test Loss: 0.291 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1235153675079346
Epoch: 39, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.279 Vali Acc: 0.938 Test Loss: 0.279 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 40 cost time: 0.977975606918335
Epoch: 40, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.278 Vali Acc: 0.932 Test Loss: 0.278 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9399116039276123
Epoch: 41, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.270 Vali Acc: 0.932 Test Loss: 0.270 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1294713020324707
Epoch: 42, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.265 Vali Acc: 0.932 Test Loss: 0.265 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0208072662353516
Epoch: 43, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.261 Vali Acc: 0.938 Test Loss: 0.261 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 44 cost time: 0.8234381675720215
Epoch: 44, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 45 cost time: 1.3126366138458252
Epoch: 45, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.261 Vali Acc: 0.932 Test Loss: 0.261 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0871293544769287
Epoch: 46, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.252 Vali Acc: 0.938 Test Loss: 0.252 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 47 cost time: 1.0887353420257568
Epoch: 47, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.935 Test Loss: 0.252 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0793659687042236
Epoch: 48, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 49 cost time: 0.9289422035217285
Epoch: 49, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0650012493133545
Epoch: 50, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.932 Test Loss: 0.246 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2180118560791016
Epoch: 51, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.2119686603546143
Epoch: 52, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.0559699535369873
Epoch: 53, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 54 cost time: 0.8724086284637451
Epoch: 54, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0186231136322021
Epoch: 55, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0226221084594727
Epoch: 56, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9452731609344482
Epoch: 57, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9496843814849854
Epoch: 58, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.230 Vali Acc: 0.932 Test Loss: 0.230 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1431071758270264
Epoch: 59, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.932 Test Loss: 0.224 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.983412504196167
Epoch: 60, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.292497158050537
Epoch: 61, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.932 Test Loss: 0.228 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9100008010864258
Epoch: 62, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.1162121295928955
Epoch: 63, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 19011
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8838753700256348
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.178 Vali Acc: 0.089 Test Loss: 2.178 Test Acc: 0.089
Validation loss decreased (inf --> -0.089167).  Saving model ...
Epoch: 2 cost time: 1.0115971565246582
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.125 Vali Acc: 0.138 Test Loss: 2.125 Test Acc: 0.138
Validation loss decreased (-0.089167 --> -0.137817).  Saving model ...
Epoch: 3 cost time: 1.099292278289795
Epoch: 3, Steps: 17 | Train Loss: 2.090 Vali Loss: 2.053 Vali Acc: 0.262 Test Loss: 2.053 Test Acc: 0.262
Validation loss decreased (-0.137817 --> -0.262142).  Saving model ...
Epoch: 4 cost time: 0.7984452247619629
Epoch: 4, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.974 Vali Acc: 0.432 Test Loss: 1.974 Test Acc: 0.432
Validation loss decreased (-0.262142 --> -0.432413).  Saving model ...
Epoch: 5 cost time: 0.9257385730743408
Epoch: 5, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.883 Vali Acc: 0.608 Test Loss: 1.883 Test Acc: 0.608
Validation loss decreased (-0.432413 --> -0.608089).  Saving model ...
Epoch: 6 cost time: 1.298661470413208
Epoch: 6, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.780 Vali Acc: 0.714 Test Loss: 1.780 Test Acc: 0.714
Validation loss decreased (-0.608089 --> -0.713496).  Saving model ...
Epoch: 7 cost time: 0.8748962879180908
Epoch: 7, Steps: 17 | Train Loss: 1.681 Vali Loss: 1.672 Vali Acc: 0.759 Test Loss: 1.672 Test Acc: 0.759
Validation loss decreased (-0.713496 --> -0.759443).  Saving model ...
Epoch: 8 cost time: 1.1543400287628174
Epoch: 8, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.553 Vali Acc: 0.778 Test Loss: 1.553 Test Acc: 0.778
Validation loss decreased (-0.759443 --> -0.778363).  Saving model ...
Epoch: 9 cost time: 0.9623150825500488
Epoch: 9, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.431 Vali Acc: 0.800 Test Loss: 1.431 Test Acc: 0.800
Validation loss decreased (-0.778363 --> -0.799986).  Saving model ...
Epoch: 10 cost time: 0.9135744571685791
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.305 Vali Acc: 0.824 Test Loss: 1.305 Test Acc: 0.824
Validation loss decreased (-0.799986 --> -0.824311).  Saving model ...
Epoch: 11 cost time: 0.787632942199707
Epoch: 11, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.191 Vali Acc: 0.838 Test Loss: 1.191 Test Acc: 0.838
Validation loss decreased (-0.824311 --> -0.837826).  Saving model ...
Epoch: 12 cost time: 0.9012670516967773
Epoch: 12, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.088 Vali Acc: 0.835 Test Loss: 1.088 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9391782283782959
Epoch: 13, Steps: 17 | Train Loss: 0.918 Vali Loss: 0.990 Vali Acc: 0.838 Test Loss: 0.990 Test Acc: 0.838
Validation loss decreased (-0.837826 --> -0.837828).  Saving model ...
Epoch: 14 cost time: 1.056856393814087
Epoch: 14, Steps: 17 | Train Loss: 0.839 Vali Loss: 0.905 Vali Acc: 0.843 Test Loss: 0.905 Test Acc: 0.843
Validation loss decreased (-0.837828 --> -0.843234).  Saving model ...
Epoch: 15 cost time: 0.9152953624725342
Epoch: 15, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.833 Vali Acc: 0.843 Test Loss: 0.833 Test Acc: 0.843
Validation loss decreased (-0.843234 --> -0.843235).  Saving model ...
Epoch: 16 cost time: 0.8418145179748535
Epoch: 16, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.772 Vali Acc: 0.851 Test Loss: 0.772 Test Acc: 0.851
Validation loss decreased (-0.843235 --> -0.851344).  Saving model ...
Epoch: 17 cost time: 0.9656171798706055
Epoch: 17, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.716 Vali Acc: 0.865 Test Loss: 0.716 Test Acc: 0.865
Validation loss decreased (-0.851344 --> -0.864858).  Saving model ...
Epoch: 18 cost time: 0.9186127185821533
Epoch: 18, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.675 Vali Acc: 0.865 Test Loss: 0.675 Test Acc: 0.865
Validation loss decreased (-0.864858 --> -0.864858).  Saving model ...
Epoch: 19 cost time: 0.9453086853027344
Epoch: 19, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.630 Vali Acc: 0.873 Test Loss: 0.630 Test Acc: 0.873
Validation loss decreased (-0.864858 --> -0.872967).  Saving model ...
Epoch: 20 cost time: 0.8316011428833008
Epoch: 20, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
Validation loss decreased (-0.872967 --> -0.878372).  Saving model ...
Epoch: 21 cost time: 0.8406405448913574
Epoch: 21, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.567 Vali Acc: 0.881 Test Loss: 0.567 Test Acc: 0.881
Validation loss decreased (-0.878372 --> -0.881075).  Saving model ...
Epoch: 22 cost time: 0.8765356540679932
Epoch: 22, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
Validation loss decreased (-0.881075 --> -0.889184).  Saving model ...
Epoch: 23 cost time: 0.9184060096740723
Epoch: 23, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.510 Vali Acc: 0.895 Test Loss: 0.510 Test Acc: 0.895
Validation loss decreased (-0.889184 --> -0.894589).  Saving model ...
Epoch: 24 cost time: 0.7863790988922119
Epoch: 24, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9787859916687012
Epoch: 25, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.455 Vali Acc: 0.903 Test Loss: 0.455 Test Acc: 0.903
Validation loss decreased (-0.894589 --> -0.902698).  Saving model ...
Epoch: 26 cost time: 0.8908324241638184
Epoch: 26, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.437 Vali Acc: 0.903 Test Loss: 0.437 Test Acc: 0.903
Validation loss decreased (-0.902698 --> -0.902698).  Saving model ...
Epoch: 27 cost time: 0.9586033821105957
Epoch: 27, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.419 Vali Acc: 0.911 Test Loss: 0.419 Test Acc: 0.911
Validation loss decreased (-0.902698 --> -0.910807).  Saving model ...
Epoch: 28 cost time: 0.8294603824615479
Epoch: 28, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.398 Vali Acc: 0.919 Test Loss: 0.398 Test Acc: 0.919
Validation loss decreased (-0.910807 --> -0.918915).  Saving model ...
Epoch: 29 cost time: 1.0499498844146729
Epoch: 29, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.395 Vali Acc: 0.922 Test Loss: 0.395 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 30 cost time: 0.7830207347869873
Epoch: 30, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929726).  Saving model ...
Epoch: 31 cost time: 0.8095898628234863
Epoch: 31, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.356 Vali Acc: 0.927 Test Loss: 0.356 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9332370758056641
Epoch: 32, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.929726 --> -0.929726).  Saving model ...
Epoch: 33 cost time: 1.0995805263519287
Epoch: 33, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.345 Vali Acc: 0.927 Test Loss: 0.345 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9922699928283691
Epoch: 34, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 35 cost time: 0.9434235095977783
Epoch: 35, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.322 Vali Acc: 0.932 Test Loss: 0.322 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9935412406921387
Epoch: 36, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 37 cost time: 0.8611893653869629
Epoch: 37, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.312 Vali Acc: 0.927 Test Loss: 0.312 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1815638542175293
Epoch: 38, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.291 Vali Acc: 0.938 Test Loss: 0.291 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 39 cost time: 0.8145864009857178
Epoch: 39, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.296 Vali Acc: 0.932 Test Loss: 0.296 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.04954195022583
Epoch: 40, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1181590557098389
Epoch: 41, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 42 cost time: 0.9053463935852051
Epoch: 42, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.276 Vali Acc: 0.935 Test Loss: 0.276 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.948615312576294
Epoch: 43, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8960893154144287
Epoch: 44, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.264 Vali Acc: 0.938 Test Loss: 0.264 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 45 cost time: 0.9169390201568604
Epoch: 45, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.094343900680542
Epoch: 46, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9383916854858398
Epoch: 47, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0601160526275635
Epoch: 48, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.263 Vali Acc: 0.932 Test Loss: 0.263 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8272678852081299
Epoch: 49, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.251 Vali Acc: 0.932 Test Loss: 0.251 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9127540588378906
Epoch: 50, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.261 Vali Acc: 0.927 Test Loss: 0.261 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.8868618011474609
Epoch: 51, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9384245872497559
Epoch: 52, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.9936203956604004
Epoch: 53, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9745616912841797
Epoch: 54, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.924 Test Loss: 0.253 Test Acc: 0.924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 18755
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.421875476837158
Epoch: 1, Steps: 17 | Train Loss: 2.245 Vali Loss: 2.180 Vali Acc: 0.159 Test Loss: 2.180 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 0.8636739253997803
Epoch: 2, Steps: 17 | Train Loss: 2.195 Vali Loss: 2.114 Vali Acc: 0.246 Test Loss: 2.114 Test Acc: 0.246
Validation loss decreased (-0.159438 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 0.7577109336853027
Epoch: 3, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.026 Vali Acc: 0.381 Test Loss: 2.026 Test Acc: 0.381
Validation loss decreased (-0.245925 --> -0.381061).  Saving model ...
Epoch: 4 cost time: 0.9152233600616455
Epoch: 4, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.931 Vali Acc: 0.538 Test Loss: 1.931 Test Acc: 0.538
Validation loss decreased (-0.381061 --> -0.537819).  Saving model ...
Epoch: 5 cost time: 0.6943032741546631
Epoch: 5, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.823 Vali Acc: 0.641 Test Loss: 1.823 Test Acc: 0.641
Validation loss decreased (-0.537819 --> -0.640522).  Saving model ...
Epoch: 6 cost time: 1.0204975605010986
Epoch: 6, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.714 Vali Acc: 0.705 Test Loss: 1.714 Test Acc: 0.705
Validation loss decreased (-0.640522 --> -0.705388).  Saving model ...
Epoch: 7 cost time: 0.9962382316589355
Epoch: 7, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.594 Vali Acc: 0.762 Test Loss: 1.594 Test Acc: 0.762
Validation loss decreased (-0.705388 --> -0.762146).  Saving model ...
Epoch: 8 cost time: 0.8682827949523926
Epoch: 8, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.474 Vali Acc: 0.797 Test Loss: 1.474 Test Acc: 0.797
Validation loss decreased (-0.762146 --> -0.797283).  Saving model ...
Epoch: 9 cost time: 0.8704321384429932
Epoch: 9, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.354 Vali Acc: 0.824 Test Loss: 1.354 Test Acc: 0.824
Validation loss decreased (-0.797283 --> -0.824311).  Saving model ...
Epoch: 10 cost time: 1.0236711502075195
Epoch: 10, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.238 Vali Acc: 0.832 Test Loss: 1.238 Test Acc: 0.832
Validation loss decreased (-0.824311 --> -0.832420).  Saving model ...
Epoch: 11 cost time: 1.1758654117584229
Epoch: 11, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.129 Vali Acc: 0.827 Test Loss: 1.129 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8857505321502686
Epoch: 12, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.027 Vali Acc: 0.838 Test Loss: 1.027 Test Acc: 0.838
Validation loss decreased (-0.832420 --> -0.837828).  Saving model ...
Epoch: 13 cost time: 1.275073766708374
Epoch: 13, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.940 Vali Acc: 0.835 Test Loss: 0.940 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0196521282196045
Epoch: 14, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.861 Vali Acc: 0.849 Test Loss: 0.861 Test Acc: 0.849
Validation loss decreased (-0.837828 --> -0.848640).  Saving model ...
Epoch: 15 cost time: 1.0304210186004639
Epoch: 15, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.795 Vali Acc: 0.857 Test Loss: 0.795 Test Acc: 0.857
Validation loss decreased (-0.848640 --> -0.856749).  Saving model ...
Epoch: 16 cost time: 0.8796689510345459
Epoch: 16, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.738 Vali Acc: 0.865 Test Loss: 0.738 Test Acc: 0.865
Validation loss decreased (-0.856749 --> -0.864857).  Saving model ...
Epoch: 17 cost time: 1.0323519706726074
Epoch: 17, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.688 Vali Acc: 0.873 Test Loss: 0.688 Test Acc: 0.873
Validation loss decreased (-0.864857 --> -0.872966).  Saving model ...
Epoch: 18 cost time: 1.2523634433746338
Epoch: 18, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.647 Vali Acc: 0.868 Test Loss: 0.647 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1004140377044678
Epoch: 19, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.608 Vali Acc: 0.884 Test Loss: 0.608 Test Acc: 0.884
Validation loss decreased (-0.872966 --> -0.883778).  Saving model ...
Epoch: 20 cost time: 1.1290390491485596
Epoch: 20, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.577 Vali Acc: 0.876 Test Loss: 0.577 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0172679424285889
Epoch: 21, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.542 Vali Acc: 0.886 Test Loss: 0.542 Test Acc: 0.886
Validation loss decreased (-0.883778 --> -0.886481).  Saving model ...
Epoch: 22 cost time: 0.9194824695587158
Epoch: 22, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.514 Vali Acc: 0.905 Test Loss: 0.514 Test Acc: 0.905
Validation loss decreased (-0.886481 --> -0.905400).  Saving model ...
Epoch: 23 cost time: 0.9878666400909424
Epoch: 23, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8487956523895264
Epoch: 24, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.464 Vali Acc: 0.897 Test Loss: 0.464 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1565935611724854
Epoch: 25, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1850566864013672
Epoch: 26, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0480477809906006
Epoch: 27, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.408 Vali Acc: 0.905 Test Loss: 0.408 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905401).  Saving model ...
Epoch: 28 cost time: 1.0132663249969482
Epoch: 28, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.397 Vali Acc: 0.903 Test Loss: 0.397 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9562811851501465
Epoch: 29, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.380 Vali Acc: 0.916 Test Loss: 0.380 Test Acc: 0.916
Validation loss decreased (-0.905401 --> -0.916212).  Saving model ...
Epoch: 30 cost time: 0.9617829322814941
Epoch: 30, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.367 Vali Acc: 0.916 Test Loss: 0.367 Test Acc: 0.916
Validation loss decreased (-0.916212 --> -0.916213).  Saving model ...
Epoch: 31 cost time: 0.9914736747741699
Epoch: 31, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.355 Vali Acc: 0.919 Test Loss: 0.355 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918915).  Saving model ...
Epoch: 32 cost time: 1.0407423973083496
Epoch: 32, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 33 cost time: 0.9722738265991211
Epoch: 33, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.341 Vali Acc: 0.919 Test Loss: 0.341 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918916).  Saving model ...
Epoch: 34 cost time: 0.983741044998169
Epoch: 34, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921618).  Saving model ...
Epoch: 35 cost time: 0.9898090362548828
Epoch: 35, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.322 Vali Acc: 0.924 Test Loss: 0.322 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 36 cost time: 0.7960739135742188
Epoch: 36, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1630373001098633
Epoch: 37, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.309 Vali Acc: 0.924 Test Loss: 0.309 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 38 cost time: 0.8876256942749023
Epoch: 38, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.306 Vali Acc: 0.924 Test Loss: 0.306 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 39 cost time: 0.9195878505706787
Epoch: 39, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2541606426239014
Epoch: 40, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.294 Vali Acc: 0.924 Test Loss: 0.294 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 41 cost time: 0.8556594848632812
Epoch: 41, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.293 Vali Acc: 0.924 Test Loss: 0.293 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 42 cost time: 0.8693606853485107
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0098779201507568
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8102927207946777
Epoch: 44, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9510424137115479
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.291 Vali Acc: 0.916 Test Loss: 0.291 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9275126457214355
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9939901828765869
Epoch: 47, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9595811367034912
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8543219566345215
Epoch: 49, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8754448890686035
Epoch: 50, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.047685146331787
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.914 Test Loss: 0.281 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 18499
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3598780632019043
Epoch: 1, Steps: 17 | Train Loss: 2.245 Vali Loss: 2.180 Vali Acc: 0.159 Test Loss: 2.180 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 0.7923440933227539
Epoch: 2, Steps: 17 | Train Loss: 2.195 Vali Loss: 2.114 Vali Acc: 0.246 Test Loss: 2.114 Test Acc: 0.246
Validation loss decreased (-0.159438 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 0.7908246517181396
Epoch: 3, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.026 Vali Acc: 0.381 Test Loss: 2.026 Test Acc: 0.381
Validation loss decreased (-0.245925 --> -0.381061).  Saving model ...
Epoch: 4 cost time: 0.8985166549682617
Epoch: 4, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.931 Vali Acc: 0.538 Test Loss: 1.931 Test Acc: 0.538
Validation loss decreased (-0.381061 --> -0.537819).  Saving model ...
Epoch: 5 cost time: 0.9297819137573242
Epoch: 5, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.823 Vali Acc: 0.641 Test Loss: 1.823 Test Acc: 0.641
Validation loss decreased (-0.537819 --> -0.640522).  Saving model ...
Epoch: 6 cost time: 0.9376075267791748
Epoch: 6, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.714 Vali Acc: 0.705 Test Loss: 1.714 Test Acc: 0.705
Validation loss decreased (-0.640522 --> -0.705388).  Saving model ...
Epoch: 7 cost time: 1.150381326675415
Epoch: 7, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.594 Vali Acc: 0.762 Test Loss: 1.594 Test Acc: 0.762
Validation loss decreased (-0.705388 --> -0.762146).  Saving model ...
Epoch: 8 cost time: 1.1733975410461426
Epoch: 8, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.474 Vali Acc: 0.797 Test Loss: 1.474 Test Acc: 0.797
Validation loss decreased (-0.762146 --> -0.797283).  Saving model ...
Epoch: 9 cost time: 1.0041673183441162
Epoch: 9, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.354 Vali Acc: 0.824 Test Loss: 1.354 Test Acc: 0.824
Validation loss decreased (-0.797283 --> -0.824311).  Saving model ...
Epoch: 10 cost time: 0.7671329975128174
Epoch: 10, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.238 Vali Acc: 0.832 Test Loss: 1.238 Test Acc: 0.832
Validation loss decreased (-0.824311 --> -0.832420).  Saving model ...
Epoch: 11 cost time: 0.7613117694854736
Epoch: 11, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.129 Vali Acc: 0.827 Test Loss: 1.129 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8575625419616699
Epoch: 12, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.027 Vali Acc: 0.838 Test Loss: 1.027 Test Acc: 0.838
Validation loss decreased (-0.832420 --> -0.837828).  Saving model ...
Epoch: 13 cost time: 1.110914945602417
Epoch: 13, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.940 Vali Acc: 0.835 Test Loss: 0.940 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6950182914733887
Epoch: 14, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.861 Vali Acc: 0.849 Test Loss: 0.861 Test Acc: 0.849
Validation loss decreased (-0.837828 --> -0.848640).  Saving model ...
Epoch: 15 cost time: 0.981104850769043
Epoch: 15, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.795 Vali Acc: 0.857 Test Loss: 0.795 Test Acc: 0.857
Validation loss decreased (-0.848640 --> -0.856749).  Saving model ...
Epoch: 16 cost time: 0.7746472358703613
Epoch: 16, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.738 Vali Acc: 0.865 Test Loss: 0.738 Test Acc: 0.865
Validation loss decreased (-0.856749 --> -0.864857).  Saving model ...
Epoch: 17 cost time: 0.7998566627502441
Epoch: 17, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.688 Vali Acc: 0.873 Test Loss: 0.688 Test Acc: 0.873
Validation loss decreased (-0.864857 --> -0.872966).  Saving model ...
Epoch: 18 cost time: 0.8836407661437988
Epoch: 18, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.647 Vali Acc: 0.868 Test Loss: 0.647 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8700730800628662
Epoch: 19, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.608 Vali Acc: 0.884 Test Loss: 0.608 Test Acc: 0.884
Validation loss decreased (-0.872966 --> -0.883778).  Saving model ...
Epoch: 20 cost time: 0.8015196323394775
Epoch: 20, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.577 Vali Acc: 0.876 Test Loss: 0.577 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9125039577484131
Epoch: 21, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.542 Vali Acc: 0.886 Test Loss: 0.542 Test Acc: 0.886
Validation loss decreased (-0.883778 --> -0.886481).  Saving model ...
Epoch: 22 cost time: 0.9892282485961914
Epoch: 22, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.514 Vali Acc: 0.905 Test Loss: 0.514 Test Acc: 0.905
Validation loss decreased (-0.886481 --> -0.905400).  Saving model ...
Epoch: 23 cost time: 0.9300220012664795
Epoch: 23, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8349623680114746
Epoch: 24, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.464 Vali Acc: 0.897 Test Loss: 0.464 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9406216144561768
Epoch: 25, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8843169212341309
Epoch: 26, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8445966243743896
Epoch: 27, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.408 Vali Acc: 0.905 Test Loss: 0.408 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905401).  Saving model ...
Epoch: 28 cost time: 1.0003304481506348
Epoch: 28, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.397 Vali Acc: 0.903 Test Loss: 0.397 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8521296977996826
Epoch: 29, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.380 Vali Acc: 0.916 Test Loss: 0.380 Test Acc: 0.916
Validation loss decreased (-0.905401 --> -0.916212).  Saving model ...
Epoch: 30 cost time: 0.8644053936004639
Epoch: 30, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.367 Vali Acc: 0.916 Test Loss: 0.367 Test Acc: 0.916
Validation loss decreased (-0.916212 --> -0.916213).  Saving model ...
Epoch: 31 cost time: 0.839207649230957
Epoch: 31, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.355 Vali Acc: 0.919 Test Loss: 0.355 Test Acc: 0.919
Validation loss decreased (-0.916213 --> -0.918915).  Saving model ...
Epoch: 32 cost time: 0.8969752788543701
Epoch: 32, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 33 cost time: 1.1047818660736084
Epoch: 33, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.341 Vali Acc: 0.919 Test Loss: 0.341 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918916).  Saving model ...
Epoch: 34 cost time: 0.9381406307220459
Epoch: 34, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.918916 --> -0.921618).  Saving model ...
Epoch: 35 cost time: 0.9964385032653809
Epoch: 35, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.322 Vali Acc: 0.924 Test Loss: 0.322 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 36 cost time: 1.0235028266906738
Epoch: 36, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0245342254638672
Epoch: 37, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.309 Vali Acc: 0.924 Test Loss: 0.309 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 38 cost time: 0.9372305870056152
Epoch: 38, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.306 Vali Acc: 0.924 Test Loss: 0.306 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 39 cost time: 0.8645203113555908
Epoch: 39, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0574917793273926
Epoch: 40, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.294 Vali Acc: 0.924 Test Loss: 0.294 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 41 cost time: 0.9367198944091797
Epoch: 41, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.293 Vali Acc: 0.924 Test Loss: 0.293 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 42 cost time: 1.0520129203796387
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0903239250183105
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1736888885498047
Epoch: 44, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0048017501831055
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.291 Vali Acc: 0.916 Test Loss: 0.291 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9240922927856445
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1328883171081543
Epoch: 47, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0623493194580078
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7609524726867676
Epoch: 49, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9174699783325195
Epoch: 50, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8570535182952881
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.914 Test Loss: 0.281 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 18499
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.565816640853882
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.142 Vali Acc: 0.157 Test Loss: 2.142 Test Acc: 0.157
Validation loss decreased (inf --> -0.156735).  Saving model ...
Epoch: 2 cost time: 0.8921780586242676
Epoch: 2, Steps: 17 | Train Loss: 2.102 Vali Loss: 2.047 Vali Acc: 0.254 Test Loss: 2.047 Test Acc: 0.254
Validation loss decreased (-0.156735 --> -0.254034).  Saving model ...
Epoch: 3 cost time: 0.9657773971557617
Epoch: 3, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.935 Vali Acc: 0.427 Test Loss: 1.935 Test Acc: 0.427
Validation loss decreased (-0.254034 --> -0.427008).  Saving model ...
Epoch: 4 cost time: 0.9058592319488525
Epoch: 4, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.807 Vali Acc: 0.576 Test Loss: 1.807 Test Acc: 0.576
Validation loss decreased (-0.427008 --> -0.575658).  Saving model ...
Epoch: 5 cost time: 1.1956148147583008
Epoch: 5, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.674 Vali Acc: 0.695 Test Loss: 1.674 Test Acc: 0.695
Validation loss decreased (-0.575658 --> -0.694578).  Saving model ...
Epoch: 6 cost time: 1.0823707580566406
Epoch: 6, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.552 Vali Acc: 0.762 Test Loss: 1.552 Test Acc: 0.762
Validation loss decreased (-0.694578 --> -0.762147).  Saving model ...
Epoch: 7 cost time: 1.0908732414245605
Epoch: 7, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.432 Vali Acc: 0.811 Test Loss: 1.432 Test Acc: 0.811
Validation loss decreased (-0.762147 --> -0.810796).  Saving model ...
Epoch: 8 cost time: 0.9814901351928711
Epoch: 8, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.322 Vali Acc: 0.843 Test Loss: 1.322 Test Acc: 0.843
Validation loss decreased (-0.810796 --> -0.843230).  Saving model ...
Epoch: 9 cost time: 1.09428071975708
Epoch: 9, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.212 Vali Acc: 0.862 Test Loss: 1.212 Test Acc: 0.862
Validation loss decreased (-0.843230 --> -0.862150).  Saving model ...
Epoch: 10 cost time: 1.2215945720672607
Epoch: 10, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.108 Vali Acc: 0.876 Test Loss: 1.108 Test Acc: 0.876
Validation loss decreased (-0.862150 --> -0.875665).  Saving model ...
Epoch: 11 cost time: 1.0141081809997559
Epoch: 11, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.016 Vali Acc: 0.886 Test Loss: 1.016 Test Acc: 0.886
Validation loss decreased (-0.875665 --> -0.886476).  Saving model ...
Epoch: 12 cost time: 1.0358715057373047
Epoch: 12, Steps: 17 | Train Loss: 0.849 Vali Loss: 0.933 Vali Acc: 0.895 Test Loss: 0.933 Test Acc: 0.895
Validation loss decreased (-0.886476 --> -0.894585).  Saving model ...
Epoch: 13 cost time: 0.9976315498352051
Epoch: 13, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.851 Vali Acc: 0.900 Test Loss: 0.851 Test Acc: 0.900
Validation loss decreased (-0.894585 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.9861195087432861
Epoch: 14, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.783 Vali Acc: 0.914 Test Loss: 0.783 Test Acc: 0.914
Validation loss decreased (-0.899991 --> -0.913506).  Saving model ...
Epoch: 15 cost time: 1.0979855060577393
Epoch: 15, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.724 Vali Acc: 0.911 Test Loss: 0.724 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0759577751159668
Epoch: 16, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.667 Vali Acc: 0.914 Test Loss: 0.667 Test Acc: 0.914
Validation loss decreased (-0.913506 --> -0.913507).  Saving model ...
Epoch: 17 cost time: 1.110694408416748
Epoch: 17, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.617 Vali Acc: 0.922 Test Loss: 0.617 Test Acc: 0.922
Validation loss decreased (-0.913507 --> -0.921615).  Saving model ...
Epoch: 18 cost time: 1.0949406623840332
Epoch: 18, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.578 Vali Acc: 0.922 Test Loss: 0.578 Test Acc: 0.922
Validation loss decreased (-0.921615 --> -0.921616).  Saving model ...
Epoch: 19 cost time: 1.1448893547058105
Epoch: 19, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.541 Vali Acc: 0.924 Test Loss: 0.541 Test Acc: 0.924
Validation loss decreased (-0.921616 --> -0.924319).  Saving model ...
Epoch: 20 cost time: 0.9286108016967773
Epoch: 20, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.505 Vali Acc: 0.927 Test Loss: 0.505 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927022).  Saving model ...
Epoch: 21 cost time: 1.0463833808898926
Epoch: 21, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.476 Vali Acc: 0.927 Test Loss: 0.476 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927022).  Saving model ...
Epoch: 22 cost time: 1.142059087753296
Epoch: 22, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.453 Vali Acc: 0.927 Test Loss: 0.453 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927022).  Saving model ...
Epoch: 23 cost time: 0.9945800304412842
Epoch: 23, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.424 Vali Acc: 0.927 Test Loss: 0.424 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927023).  Saving model ...
Epoch: 24 cost time: 1.1707894802093506
Epoch: 24, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.405 Vali Acc: 0.927 Test Loss: 0.405 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 25 cost time: 1.1410815715789795
Epoch: 25, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.384 Vali Acc: 0.927 Test Loss: 0.384 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 26 cost time: 1.0000593662261963
Epoch: 26, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.372 Vali Acc: 0.924 Test Loss: 0.372 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9707355499267578
Epoch: 27, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.359 Vali Acc: 0.924 Test Loss: 0.359 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2689006328582764
Epoch: 28, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.343 Vali Acc: 0.924 Test Loss: 0.343 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2216999530792236
Epoch: 29, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.330 Vali Acc: 0.935 Test Loss: 0.330 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935132).  Saving model ...
Epoch: 30 cost time: 0.870105504989624
Epoch: 30, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.319 Vali Acc: 0.935 Test Loss: 0.319 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 31 cost time: 0.8657913208007812
Epoch: 31, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0195691585540771
Epoch: 32, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.294 Vali Acc: 0.932 Test Loss: 0.294 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9910039901733398
Epoch: 33, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0836780071258545
Epoch: 34, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0049974918365479
Epoch: 35, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.270 Vali Acc: 0.938 Test Loss: 0.270 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 36 cost time: 1.1789546012878418
Epoch: 36, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.267 Vali Acc: 0.932 Test Loss: 0.267 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2639787197113037
Epoch: 37, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1093780994415283
Epoch: 38, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.248 Vali Acc: 0.943 Test Loss: 0.248 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 39 cost time: 1.016528844833374
Epoch: 39, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.242 Vali Acc: 0.946 Test Loss: 0.242 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 40 cost time: 0.93172287940979
Epoch: 40, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.110685110092163
Epoch: 41, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0762622356414795
Epoch: 42, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.206772804260254
Epoch: 43, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.251 Vali Acc: 0.924 Test Loss: 0.251 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0733275413513184
Epoch: 44, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.227 Vali Acc: 0.932 Test Loss: 0.227 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.271061658859253
Epoch: 45, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0572421550750732
Epoch: 46, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0421686172485352
Epoch: 47, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0064001083374023
Epoch: 48, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1487689018249512
Epoch: 49, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 19143
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9376425743103027
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.251 Vali Acc: 0.114 Test Loss: 2.251 Test Acc: 0.114
Validation loss decreased (inf --> -0.113491).  Saving model ...
Epoch: 2 cost time: 1.126451015472412
Epoch: 2, Steps: 17 | Train Loss: 2.123 Vali Loss: 2.144 Vali Acc: 0.189 Test Loss: 2.144 Test Acc: 0.189
Validation loss decreased (-0.113491 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 1.10719895362854
Epoch: 3, Steps: 17 | Train Loss: 2.015 Vali Loss: 2.026 Vali Acc: 0.322 Test Loss: 2.026 Test Acc: 0.322
Validation loss decreased (-0.189168 --> -0.321601).  Saving model ...
Epoch: 4 cost time: 0.8738980293273926
Epoch: 4, Steps: 17 | Train Loss: 1.870 Vali Loss: 1.911 Vali Acc: 0.443 Test Loss: 1.911 Test Acc: 0.443
Validation loss decreased (-0.321601 --> -0.443224).  Saving model ...
Epoch: 5 cost time: 1.2583613395690918
Epoch: 5, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.791 Vali Acc: 0.584 Test Loss: 1.791 Test Acc: 0.584
Validation loss decreased (-0.443224 --> -0.583766).  Saving model ...
Epoch: 6 cost time: 1.1619648933410645
Epoch: 6, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.662 Vali Acc: 0.668 Test Loss: 1.662 Test Acc: 0.668
Validation loss decreased (-0.583766 --> -0.667551).  Saving model ...
Epoch: 7 cost time: 1.0275466442108154
Epoch: 7, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.547 Vali Acc: 0.746 Test Loss: 1.547 Test Acc: 0.746
Validation loss decreased (-0.667551 --> -0.745930).  Saving model ...
Epoch: 8 cost time: 1.1205134391784668
Epoch: 8, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.431 Vali Acc: 0.762 Test Loss: 1.431 Test Acc: 0.762
Validation loss decreased (-0.745930 --> -0.762148).  Saving model ...
Epoch: 9 cost time: 1.0056793689727783
Epoch: 9, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.322 Vali Acc: 0.792 Test Loss: 1.322 Test Acc: 0.792
Validation loss decreased (-0.762148 --> -0.791879).  Saving model ...
Epoch: 10 cost time: 1.1302707195281982
Epoch: 10, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.216 Vali Acc: 0.816 Test Loss: 1.216 Test Acc: 0.816
Validation loss decreased (-0.791879 --> -0.816204).  Saving model ...
Epoch: 11 cost time: 1.030942678451538
Epoch: 11, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.115 Vali Acc: 0.838 Test Loss: 1.115 Test Acc: 0.838
Validation loss decreased (-0.816204 --> -0.837827).  Saving model ...
Epoch: 12 cost time: 0.848320484161377
Epoch: 12, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.035 Vali Acc: 0.846 Test Loss: 1.035 Test Acc: 0.846
Validation loss decreased (-0.837827 --> -0.845936).  Saving model ...
Epoch: 13 cost time: 1.0478181838989258
Epoch: 13, Steps: 17 | Train Loss: 0.810 Vali Loss: 0.947 Vali Acc: 0.857 Test Loss: 0.947 Test Acc: 0.857
Validation loss decreased (-0.845936 --> -0.856747).  Saving model ...
Epoch: 14 cost time: 1.147306203842163
Epoch: 14, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.877 Vali Acc: 0.862 Test Loss: 0.877 Test Acc: 0.862
Validation loss decreased (-0.856747 --> -0.862153).  Saving model ...
Epoch: 15 cost time: 0.8859677314758301
Epoch: 15, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.815 Vali Acc: 0.870 Test Loss: 0.815 Test Acc: 0.870
Validation loss decreased (-0.862153 --> -0.870262).  Saving model ...
Epoch: 16 cost time: 1.151371717453003
Epoch: 16, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.764 Vali Acc: 0.884 Test Loss: 0.764 Test Acc: 0.884
Validation loss decreased (-0.870262 --> -0.883776).  Saving model ...
Epoch: 17 cost time: 0.9054732322692871
Epoch: 17, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.705 Vali Acc: 0.889 Test Loss: 0.705 Test Acc: 0.889
Validation loss decreased (-0.883776 --> -0.889182).  Saving model ...
Epoch: 18 cost time: 1.1133840084075928
Epoch: 18, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.664 Vali Acc: 0.884 Test Loss: 0.664 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0164263248443604
Epoch: 19, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.623 Vali Acc: 0.892 Test Loss: 0.623 Test Acc: 0.892
Validation loss decreased (-0.889182 --> -0.891886).  Saving model ...
Epoch: 20 cost time: 1.0693516731262207
Epoch: 20, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.594 Vali Acc: 0.892 Test Loss: 0.594 Test Acc: 0.892
Validation loss decreased (-0.891886 --> -0.891886).  Saving model ...
Epoch: 21 cost time: 1.025055170059204
Epoch: 21, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.558 Vali Acc: 0.895 Test Loss: 0.558 Test Acc: 0.895
Validation loss decreased (-0.891886 --> -0.894589).  Saving model ...
Epoch: 22 cost time: 1.2024991512298584
Epoch: 22, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.894589 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.8835713863372803
Epoch: 23, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.502 Vali Acc: 0.905 Test Loss: 0.502 Test Acc: 0.905
Validation loss decreased (-0.899995 --> -0.905400).  Saving model ...
Epoch: 24 cost time: 1.145625114440918
Epoch: 24, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.484 Vali Acc: 0.908 Test Loss: 0.484 Test Acc: 0.908
Validation loss decreased (-0.905400 --> -0.908103).  Saving model ...
Epoch: 25 cost time: 1.1734240055084229
Epoch: 25, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.458 Vali Acc: 0.914 Test Loss: 0.458 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 26 cost time: 1.0594730377197266
Epoch: 26, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.450 Vali Acc: 0.919 Test Loss: 0.450 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918914).  Saving model ...
Epoch: 27 cost time: 0.9135127067565918
Epoch: 27, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.420 Vali Acc: 0.919 Test Loss: 0.420 Test Acc: 0.919
Validation loss decreased (-0.918914 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 1.0034160614013672
Epoch: 28, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.414 Vali Acc: 0.924 Test Loss: 0.414 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924320).  Saving model ...
Epoch: 29 cost time: 0.9459314346313477
Epoch: 29, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.396 Vali Acc: 0.927 Test Loss: 0.396 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 30 cost time: 1.2213153839111328
Epoch: 30, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.389 Vali Acc: 0.932 Test Loss: 0.389 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 31 cost time: 1.1232898235321045
Epoch: 31, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.373 Vali Acc: 0.924 Test Loss: 0.373 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9971456527709961
Epoch: 32, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.367 Vali Acc: 0.938 Test Loss: 0.367 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937834).  Saving model ...
Epoch: 33 cost time: 1.2321202754974365
Epoch: 33, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.357 Vali Acc: 0.932 Test Loss: 0.357 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9860386848449707
Epoch: 34, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.357 Vali Acc: 0.927 Test Loss: 0.357 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9308435916900635
Epoch: 35, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.336 Vali Acc: 0.932 Test Loss: 0.336 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0215725898742676
Epoch: 36, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.337 Vali Acc: 0.935 Test Loss: 0.337 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9622509479522705
Epoch: 37, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.326 Vali Acc: 0.927 Test Loss: 0.326 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2778129577636719
Epoch: 38, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.133232831954956
Epoch: 39, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.324 Vali Acc: 0.930 Test Loss: 0.324 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.955024003982544
Epoch: 40, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.321 Vali Acc: 0.932 Test Loss: 0.321 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0870561599731445
Epoch: 41, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0611987113952637
Epoch: 42, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.311 Vali Acc: 0.932 Test Loss: 0.311 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 18887
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6950337886810303
Epoch: 1, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.125 Vali Acc: 0.211 Test Loss: 2.125 Test Acc: 0.211
Validation loss decreased (inf --> -0.210790).  Saving model ...
Epoch: 2 cost time: 0.9170942306518555
Epoch: 2, Steps: 17 | Train Loss: 2.089 Vali Loss: 2.022 Vali Acc: 0.343 Test Loss: 2.022 Test Acc: 0.343
Validation loss decreased (-0.210790 --> -0.343223).  Saving model ...
Epoch: 3 cost time: 1.0002715587615967
Epoch: 3, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.907 Vali Acc: 0.478 Test Loss: 1.907 Test Acc: 0.478
Validation loss decreased (-0.343223 --> -0.478359).  Saving model ...
Epoch: 4 cost time: 1.1864209175109863
Epoch: 4, Steps: 17 | Train Loss: 1.810 Vali Loss: 1.788 Vali Acc: 0.600 Test Loss: 1.788 Test Acc: 0.600
Validation loss decreased (-0.478359 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 0.9107117652893066
Epoch: 5, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.670 Vali Acc: 0.651 Test Loss: 1.670 Test Acc: 0.651
Validation loss decreased (-0.599982 --> -0.651335).  Saving model ...
Epoch: 6 cost time: 0.9681782722473145
Epoch: 6, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.543 Vali Acc: 0.732 Test Loss: 1.543 Test Acc: 0.732
Validation loss decreased (-0.651335 --> -0.732417).  Saving model ...
Epoch: 7 cost time: 1.2259275913238525
Epoch: 7, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.431 Vali Acc: 0.765 Test Loss: 1.431 Test Acc: 0.765
Validation loss decreased (-0.732417 --> -0.764851).  Saving model ...
Epoch: 8 cost time: 0.9227175712585449
Epoch: 8, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.321 Vali Acc: 0.770 Test Loss: 1.321 Test Acc: 0.770
Validation loss decreased (-0.764851 --> -0.770257).  Saving model ...
Epoch: 9 cost time: 1.0109198093414307
Epoch: 9, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.213 Vali Acc: 0.811 Test Loss: 1.213 Test Acc: 0.811
Validation loss decreased (-0.770257 --> -0.810799).  Saving model ...
Epoch: 10 cost time: 0.8606901168823242
Epoch: 10, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.114 Vali Acc: 0.822 Test Loss: 1.114 Test Acc: 0.822
Validation loss decreased (-0.810799 --> -0.821610).  Saving model ...
Epoch: 11 cost time: 1.3806512355804443
Epoch: 11, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.020 Vali Acc: 0.838 Test Loss: 1.020 Test Acc: 0.838
Validation loss decreased (-0.821610 --> -0.837828).  Saving model ...
Epoch: 12 cost time: 0.9885237216949463
Epoch: 12, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.937 Vali Acc: 0.851 Test Loss: 0.937 Test Acc: 0.851
Validation loss decreased (-0.837828 --> -0.851342).  Saving model ...
Epoch: 13 cost time: 0.931300163269043
Epoch: 13, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.861 Vali Acc: 0.854 Test Loss: 0.861 Test Acc: 0.854
Validation loss decreased (-0.851342 --> -0.854045).  Saving model ...
Epoch: 14 cost time: 1.0853474140167236
Epoch: 14, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.788 Vali Acc: 0.870 Test Loss: 0.788 Test Acc: 0.870
Validation loss decreased (-0.854045 --> -0.870262).  Saving model ...
Epoch: 15 cost time: 0.9854190349578857
Epoch: 15, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.732 Vali Acc: 0.876 Test Loss: 0.732 Test Acc: 0.876
Validation loss decreased (-0.870262 --> -0.875668).  Saving model ...
Epoch: 16 cost time: 0.890826940536499
Epoch: 16, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.675 Vali Acc: 0.892 Test Loss: 0.675 Test Acc: 0.892
Validation loss decreased (-0.875668 --> -0.891885).  Saving model ...
Epoch: 17 cost time: 0.9613916873931885
Epoch: 17, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.628 Vali Acc: 0.889 Test Loss: 0.628 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.030982255935669
Epoch: 18, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.585 Vali Acc: 0.895 Test Loss: 0.585 Test Acc: 0.895
Validation loss decreased (-0.891885 --> -0.894589).  Saving model ...
Epoch: 19 cost time: 0.9507622718811035
Epoch: 19, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.552 Vali Acc: 0.897 Test Loss: 0.552 Test Acc: 0.897
Validation loss decreased (-0.894589 --> -0.897292).  Saving model ...
Epoch: 20 cost time: 1.0178132057189941
Epoch: 20, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.516 Vali Acc: 0.903 Test Loss: 0.516 Test Acc: 0.903
Validation loss decreased (-0.897292 --> -0.902698).  Saving model ...
Epoch: 21 cost time: 0.7873055934906006
Epoch: 21, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.488 Vali Acc: 0.908 Test Loss: 0.488 Test Acc: 0.908
Validation loss decreased (-0.902698 --> -0.908103).  Saving model ...
Epoch: 22 cost time: 0.8436052799224854
Epoch: 22, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.459 Vali Acc: 0.908 Test Loss: 0.459 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908104).  Saving model ...
Epoch: 23 cost time: 0.8524048328399658
Epoch: 23, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.437 Vali Acc: 0.905 Test Loss: 0.437 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7362370491027832
Epoch: 24, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
Validation loss decreased (-0.908104 --> -0.910807).  Saving model ...
Epoch: 25 cost time: 1.0386760234832764
Epoch: 25, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
Validation loss decreased (-0.910807 --> -0.910807).  Saving model ...
Epoch: 26 cost time: 0.8984761238098145
Epoch: 26, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.381 Vali Acc: 0.916 Test Loss: 0.381 Test Acc: 0.916
Validation loss decreased (-0.910807 --> -0.916212).  Saving model ...
Epoch: 27 cost time: 0.8607425689697266
Epoch: 27, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.365 Vali Acc: 0.914 Test Loss: 0.365 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7900519371032715
Epoch: 28, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921618).  Saving model ...
Epoch: 29 cost time: 0.9534752368927002
Epoch: 29, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.335 Vali Acc: 0.927 Test Loss: 0.335 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 30 cost time: 0.8261158466339111
Epoch: 30, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.831906795501709
Epoch: 31, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8558716773986816
Epoch: 32, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7866942882537842
Epoch: 33, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.307 Vali Acc: 0.927 Test Loss: 0.307 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 34 cost time: 0.9647171497344971
Epoch: 34, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.927024 --> -0.929727).  Saving model ...
Epoch: 35 cost time: 1.1428155899047852
Epoch: 35, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929727).  Saving model ...
Epoch: 36 cost time: 1.0199353694915771
Epoch: 36, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9996769428253174
Epoch: 37, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.277 Vali Acc: 0.932 Test Loss: 0.277 Test Acc: 0.932
Validation loss decreased (-0.929727 --> -0.932430).  Saving model ...
Epoch: 38 cost time: 1.0602383613586426
Epoch: 38, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.272 Vali Acc: 0.927 Test Loss: 0.272 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.896895170211792
Epoch: 39, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.262 Vali Acc: 0.927 Test Loss: 0.262 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9625420570373535
Epoch: 40, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9466793537139893
Epoch: 41, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.255 Vali Acc: 0.932 Test Loss: 0.255 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 42 cost time: 0.8172204494476318
Epoch: 42, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 43 cost time: 0.9266624450683594
Epoch: 43, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9992883205413818
Epoch: 44, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9529867172241211
Epoch: 45, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9778537750244141
Epoch: 46, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8424172401428223
Epoch: 47, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.927 Test Loss: 0.234 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1946070194244385
Epoch: 48, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.005429983139038
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 50 cost time: 0.874793529510498
Epoch: 50, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.927 Test Loss: 0.228 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0215427875518799
Epoch: 51, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7626113891601562
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 53 cost time: 1.0533950328826904
Epoch: 53, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0589959621429443
Epoch: 54, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7218384742736816
Epoch: 55, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7871265411376953
Epoch: 56, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 57 cost time: 1.05721116065979
Epoch: 57, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9289608001708984
Epoch: 58, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
Validation loss decreased (-0.935133 --> -0.935133).  Saving model ...
Epoch: 59 cost time: 0.863837718963623
Epoch: 59, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940538).  Saving model ...
Epoch: 60 cost time: 1.0242033004760742
Epoch: 60, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.047706127166748
Epoch: 61, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.199378490447998
Epoch: 62, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0189332962036133
Epoch: 63, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.9282724857330322
Epoch: 64, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.8954544067382812
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.935 Test Loss: 0.203 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8832554817199707
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.9501132965087891
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.053196668624878
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.2342019081115723
Epoch: 69, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.932 Test Loss: 0.191 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 18631
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.340786933898926
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.180 Vali Acc: 0.143 Test Loss: 2.180 Test Acc: 0.143
Validation loss decreased (inf --> -0.143221).  Saving model ...
Epoch: 2 cost time: 0.7989273071289062
Epoch: 2, Steps: 17 | Train Loss: 2.111 Vali Loss: 2.061 Vali Acc: 0.351 Test Loss: 2.061 Test Acc: 0.351
Validation loss decreased (-0.143221 --> -0.351331).  Saving model ...
Epoch: 3 cost time: 0.9421360492706299
Epoch: 3, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.950 Vali Acc: 0.457 Test Loss: 1.950 Test Acc: 0.457
Validation loss decreased (-0.351331 --> -0.456737).  Saving model ...
Epoch: 4 cost time: 0.9025988578796387
Epoch: 4, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.842 Vali Acc: 0.522 Test Loss: 1.842 Test Acc: 0.522
Validation loss decreased (-0.456737 --> -0.521603).  Saving model ...
Epoch: 5 cost time: 0.9496762752532959
Epoch: 5, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.741 Vali Acc: 0.600 Test Loss: 1.741 Test Acc: 0.600
Validation loss decreased (-0.521603 --> -0.599983).  Saving model ...
Epoch: 6 cost time: 0.8364641666412354
Epoch: 6, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.642 Vali Acc: 0.657 Test Loss: 1.642 Test Acc: 0.657
Validation loss decreased (-0.599983 --> -0.656740).  Saving model ...
Epoch: 7 cost time: 0.9105269908905029
Epoch: 7, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.525 Vali Acc: 0.724 Test Loss: 1.525 Test Acc: 0.724
Validation loss decreased (-0.656740 --> -0.724309).  Saving model ...
Epoch: 8 cost time: 0.8687467575073242
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.411 Vali Acc: 0.754 Test Loss: 1.411 Test Acc: 0.754
Validation loss decreased (-0.724309 --> -0.754040).  Saving model ...
Epoch: 9 cost time: 0.7796158790588379
Epoch: 9, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.290 Vali Acc: 0.808 Test Loss: 1.290 Test Acc: 0.808
Validation loss decreased (-0.754040 --> -0.808095).  Saving model ...
Epoch: 10 cost time: 0.8002462387084961
Epoch: 10, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.182 Vali Acc: 0.838 Test Loss: 1.182 Test Acc: 0.838
Validation loss decreased (-0.808095 --> -0.837826).  Saving model ...
Epoch: 11 cost time: 1.0651886463165283
Epoch: 11, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.078 Vali Acc: 0.851 Test Loss: 1.078 Test Acc: 0.851
Validation loss decreased (-0.837826 --> -0.851341).  Saving model ...
Epoch: 12 cost time: 0.7975902557373047
Epoch: 12, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.986 Vali Acc: 0.870 Test Loss: 0.986 Test Acc: 0.870
Validation loss decreased (-0.851341 --> -0.870260).  Saving model ...
Epoch: 13 cost time: 0.802161455154419
Epoch: 13, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.896 Vali Acc: 0.878 Test Loss: 0.896 Test Acc: 0.878
Validation loss decreased (-0.870260 --> -0.878369).  Saving model ...
Epoch: 14 cost time: 1.1188325881958008
Epoch: 14, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.827 Vali Acc: 0.892 Test Loss: 0.827 Test Acc: 0.892
Validation loss decreased (-0.878369 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 0.8459298610687256
Epoch: 15, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.761 Vali Acc: 0.903 Test Loss: 0.761 Test Acc: 0.903
Validation loss decreased (-0.891884 --> -0.902695).  Saving model ...
Epoch: 16 cost time: 0.8285622596740723
Epoch: 16, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.703 Vali Acc: 0.908 Test Loss: 0.703 Test Acc: 0.908
Validation loss decreased (-0.902695 --> -0.908101).  Saving model ...
Epoch: 17 cost time: 0.8730566501617432
Epoch: 17, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.647 Vali Acc: 0.916 Test Loss: 0.647 Test Acc: 0.916
Validation loss decreased (-0.908101 --> -0.916210).  Saving model ...
Epoch: 18 cost time: 0.7303497791290283
Epoch: 18, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.602 Vali Acc: 0.916 Test Loss: 0.602 Test Acc: 0.916
Validation loss decreased (-0.916210 --> -0.916210).  Saving model ...
Epoch: 19 cost time: 0.7671546936035156
Epoch: 19, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.563 Vali Acc: 0.914 Test Loss: 0.563 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9156570434570312
Epoch: 20, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.530 Vali Acc: 0.927 Test Loss: 0.530 Test Acc: 0.927
Validation loss decreased (-0.916210 --> -0.927022).  Saving model ...
Epoch: 21 cost time: 0.9596579074859619
Epoch: 21, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.500 Vali Acc: 0.927 Test Loss: 0.500 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927022).  Saving model ...
Epoch: 22 cost time: 0.8632493019104004
Epoch: 22, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.478 Vali Acc: 0.932 Test Loss: 0.478 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 23 cost time: 0.9008700847625732
Epoch: 23, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.455 Vali Acc: 0.938 Test Loss: 0.455 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937833).  Saving model ...
Epoch: 24 cost time: 0.9247140884399414
Epoch: 24, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.432 Vali Acc: 0.935 Test Loss: 0.432 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0304644107818604
Epoch: 25, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.411 Vali Acc: 0.935 Test Loss: 0.411 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8713431358337402
Epoch: 26, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.396 Vali Acc: 0.938 Test Loss: 0.396 Test Acc: 0.938
Validation loss decreased (-0.937833 --> -0.937834).  Saving model ...
Epoch: 27 cost time: 0.8936388492584229
Epoch: 27, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.368 Vali Acc: 0.932 Test Loss: 0.368 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8911817073822021
Epoch: 28, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.367 Vali Acc: 0.938 Test Loss: 0.367 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 29 cost time: 0.8706600666046143
Epoch: 29, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.352 Vali Acc: 0.938 Test Loss: 0.352 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 30 cost time: 0.8262019157409668
Epoch: 30, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 31 cost time: 0.9766290187835693
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.044205904006958
Epoch: 32, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.318 Vali Acc: 0.938 Test Loss: 0.318 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0162856578826904
Epoch: 33, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0127251148223877
Epoch: 34, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 35 cost time: 0.9636590480804443
Epoch: 35, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.294 Vali Acc: 0.935 Test Loss: 0.294 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7773947715759277
Epoch: 36, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8629648685455322
Epoch: 37, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8759238719940186
Epoch: 38, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0311658382415771
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9892337322235107
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.264 Vali Acc: 0.932 Test Loss: 0.264 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.109978437423706
Epoch: 41, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 42 cost time: 0.9623684883117676
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.874847412109375
Epoch: 43, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.952979326248169
Epoch: 44, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 45 cost time: 0.8682098388671875
Epoch: 45, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8611252307891846
Epoch: 46, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8559613227844238
Epoch: 47, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.938 Test Loss: 0.238 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9604060649871826
Epoch: 48, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 49 cost time: 0.790673017501831
Epoch: 49, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9168386459350586
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.842841625213623
Epoch: 51, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 52 cost time: 0.8258302211761475
Epoch: 52, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0644421577453613
Epoch: 53, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0519516468048096
Epoch: 54, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8613643646240234
Epoch: 55, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9161269664764404
Epoch: 56, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.817908763885498
Epoch: 57, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.984877347946167
Epoch: 58, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.938 Test Loss: 0.218 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9791669845581055
Epoch: 59, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.7177069187164307
Epoch: 60, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.8122372627258301
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 62 cost time: 0.8192019462585449
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8192334175109863
Epoch: 63, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 64 cost time: 1.096830129623413
Epoch: 64, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1000597476959229
Epoch: 65, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.1035313606262207
Epoch: 66, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.9665882587432861
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9240274429321289
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.0196051597595215
Epoch: 69, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.0176408290863037
Epoch: 70, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 71 cost time: 0.8931930065155029
Epoch: 71, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9046194553375244
Epoch: 72, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.8271145820617676
Epoch: 73, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 74 cost time: 0.7757227420806885
Epoch: 74, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.868485689163208
Epoch: 75, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.7883930206298828
Epoch: 76, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.8970787525177002
Epoch: 77, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.0081524848937988
Epoch: 78, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.7513344287872314
Epoch: 79, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.8233802318572998
Epoch: 80, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.8402776718139648
Epoch: 81, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.7419695854187012
Epoch: 82, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.6872959136962891
Epoch: 83, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 18375
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.356743812561035
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.180 Vali Acc: 0.143 Test Loss: 2.180 Test Acc: 0.143
Validation loss decreased (inf --> -0.143221).  Saving model ...
Epoch: 2 cost time: 0.9495611190795898
Epoch: 2, Steps: 17 | Train Loss: 2.111 Vali Loss: 2.061 Vali Acc: 0.351 Test Loss: 2.061 Test Acc: 0.351
Validation loss decreased (-0.143221 --> -0.351331).  Saving model ...
Epoch: 3 cost time: 1.0874075889587402
Epoch: 3, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.950 Vali Acc: 0.457 Test Loss: 1.950 Test Acc: 0.457
Validation loss decreased (-0.351331 --> -0.456737).  Saving model ...
Epoch: 4 cost time: 0.9827365875244141
Epoch: 4, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.842 Vali Acc: 0.522 Test Loss: 1.842 Test Acc: 0.522
Validation loss decreased (-0.456737 --> -0.521603).  Saving model ...
Epoch: 5 cost time: 0.7243766784667969
Epoch: 5, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.741 Vali Acc: 0.600 Test Loss: 1.741 Test Acc: 0.600
Validation loss decreased (-0.521603 --> -0.599983).  Saving model ...
Epoch: 6 cost time: 1.2037341594696045
Epoch: 6, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.642 Vali Acc: 0.657 Test Loss: 1.642 Test Acc: 0.657
Validation loss decreased (-0.599983 --> -0.656740).  Saving model ...
Epoch: 7 cost time: 0.8034496307373047
Epoch: 7, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.525 Vali Acc: 0.724 Test Loss: 1.525 Test Acc: 0.724
Validation loss decreased (-0.656740 --> -0.724309).  Saving model ...
Epoch: 8 cost time: 0.6971530914306641
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.411 Vali Acc: 0.754 Test Loss: 1.411 Test Acc: 0.754
Validation loss decreased (-0.724309 --> -0.754040).  Saving model ...
Epoch: 9 cost time: 0.8328680992126465
Epoch: 9, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.290 Vali Acc: 0.808 Test Loss: 1.290 Test Acc: 0.808
Validation loss decreased (-0.754040 --> -0.808095).  Saving model ...
Epoch: 10 cost time: 0.9305198192596436
Epoch: 10, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.182 Vali Acc: 0.838 Test Loss: 1.182 Test Acc: 0.838
Validation loss decreased (-0.808095 --> -0.837826).  Saving model ...
Epoch: 11 cost time: 0.9439573287963867
Epoch: 11, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.078 Vali Acc: 0.851 Test Loss: 1.078 Test Acc: 0.851
Validation loss decreased (-0.837826 --> -0.851341).  Saving model ...
Epoch: 12 cost time: 0.8544268608093262
Epoch: 12, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.986 Vali Acc: 0.870 Test Loss: 0.986 Test Acc: 0.870
Validation loss decreased (-0.851341 --> -0.870260).  Saving model ...
Epoch: 13 cost time: 0.759702205657959
Epoch: 13, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.896 Vali Acc: 0.878 Test Loss: 0.896 Test Acc: 0.878
Validation loss decreased (-0.870260 --> -0.878369).  Saving model ...
Epoch: 14 cost time: 0.9520246982574463
Epoch: 14, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.827 Vali Acc: 0.892 Test Loss: 0.827 Test Acc: 0.892
Validation loss decreased (-0.878369 --> -0.891884).  Saving model ...
Epoch: 15 cost time: 0.7182028293609619
Epoch: 15, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.761 Vali Acc: 0.903 Test Loss: 0.761 Test Acc: 0.903
Validation loss decreased (-0.891884 --> -0.902695).  Saving model ...
Epoch: 16 cost time: 0.777106523513794
Epoch: 16, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.703 Vali Acc: 0.908 Test Loss: 0.703 Test Acc: 0.908
Validation loss decreased (-0.902695 --> -0.908101).  Saving model ...
Epoch: 17 cost time: 0.9089655876159668
Epoch: 17, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.647 Vali Acc: 0.916 Test Loss: 0.647 Test Acc: 0.916
Validation loss decreased (-0.908101 --> -0.916210).  Saving model ...
Epoch: 18 cost time: 0.8369431495666504
Epoch: 18, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.602 Vali Acc: 0.916 Test Loss: 0.602 Test Acc: 0.916
Validation loss decreased (-0.916210 --> -0.916210).  Saving model ...
Epoch: 19 cost time: 0.8796272277832031
Epoch: 19, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.563 Vali Acc: 0.914 Test Loss: 0.563 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8330187797546387
Epoch: 20, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.530 Vali Acc: 0.927 Test Loss: 0.530 Test Acc: 0.927
Validation loss decreased (-0.916210 --> -0.927022).  Saving model ...
Epoch: 21 cost time: 0.8653521537780762
Epoch: 21, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.500 Vali Acc: 0.927 Test Loss: 0.500 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927022).  Saving model ...
Epoch: 22 cost time: 1.0670890808105469
Epoch: 22, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.478 Vali Acc: 0.932 Test Loss: 0.478 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 23 cost time: 0.7641010284423828
Epoch: 23, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.455 Vali Acc: 0.938 Test Loss: 0.455 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937833).  Saving model ...
Epoch: 24 cost time: 0.7960619926452637
Epoch: 24, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.432 Vali Acc: 0.935 Test Loss: 0.432 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.842327356338501
Epoch: 25, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.411 Vali Acc: 0.935 Test Loss: 0.411 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8730673789978027
Epoch: 26, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.396 Vali Acc: 0.938 Test Loss: 0.396 Test Acc: 0.938
Validation loss decreased (-0.937833 --> -0.937834).  Saving model ...
Epoch: 27 cost time: 0.9990148544311523
Epoch: 27, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.368 Vali Acc: 0.932 Test Loss: 0.368 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8616571426391602
Epoch: 28, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.367 Vali Acc: 0.938 Test Loss: 0.367 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 29 cost time: 0.7234220504760742
Epoch: 29, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.352 Vali Acc: 0.938 Test Loss: 0.352 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 30 cost time: 0.8844263553619385
Epoch: 30, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 31 cost time: 0.818734884262085
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7617068290710449
Epoch: 32, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.318 Vali Acc: 0.938 Test Loss: 0.318 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7312660217285156
Epoch: 33, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8169641494750977
Epoch: 34, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 35 cost time: 0.9266791343688965
Epoch: 35, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.294 Vali Acc: 0.935 Test Loss: 0.294 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.729642391204834
Epoch: 36, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9473142623901367
Epoch: 37, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8227527141571045
Epoch: 38, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8570311069488525
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8917069435119629
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.264 Vali Acc: 0.932 Test Loss: 0.264 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7329561710357666
Epoch: 41, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 42 cost time: 0.8826904296875
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8096745014190674
Epoch: 43, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9722709655761719
Epoch: 44, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 45 cost time: 0.9763898849487305
Epoch: 45, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9388365745544434
Epoch: 46, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.923607349395752
Epoch: 47, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.938 Test Loss: 0.238 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.840994119644165
Epoch: 48, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 49 cost time: 0.8237075805664062
Epoch: 49, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8764829635620117
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8175818920135498
Epoch: 51, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 52 cost time: 0.9172360897064209
Epoch: 52, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6158351898193359
Epoch: 53, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8061115741729736
Epoch: 54, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7446320056915283
Epoch: 55, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.874051570892334
Epoch: 56, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.8440110683441162
Epoch: 57, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8382816314697266
Epoch: 58, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.938 Test Loss: 0.218 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8744146823883057
Epoch: 59, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.761174201965332
Epoch: 60, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.906033992767334
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 62 cost time: 0.9053144454956055
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8515100479125977
Epoch: 63, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 64 cost time: 0.7856795787811279
Epoch: 64, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8551130294799805
Epoch: 65, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.7647659778594971
Epoch: 66, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.894744873046875
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.7308297157287598
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8135685920715332
Epoch: 69, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.6670713424682617
Epoch: 70, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 71 cost time: 0.6236915588378906
Epoch: 71, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8968093395233154
Epoch: 72, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6996662616729736
Epoch: 73, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 74 cost time: 0.7747189998626709
Epoch: 74, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.889970064163208
Epoch: 75, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.0053279399871826
Epoch: 76, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9950602054595947
Epoch: 77, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.826336145401001
Epoch: 78, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.7930238246917725
Epoch: 79, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.6969590187072754
Epoch: 80, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.8279783725738525
Epoch: 81, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.7868282794952393
Epoch: 82, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.9553141593933105
Epoch: 83, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_MTSMixer_UEA_ftM_sl29_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 18375
model size : 0.08MB
