Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.1841351985931396
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.371 Vali Acc: 0.283 Test Loss: 1.371 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.118671178817749
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.330 Vali Acc: 0.362 Test Loss: 1.330 Test Acc: 0.362
Validation loss decreased (-0.282595 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 1.376577615737915
Epoch: 3, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.286 Vali Acc: 0.399 Test Loss: 1.286 Test Acc: 0.399
Validation loss decreased (-0.362306 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 1.1270065307617188
Epoch: 4, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.250 Vali Acc: 0.442 Test Loss: 1.250 Test Acc: 0.442
Validation loss decreased (-0.398538 --> -0.442016).  Saving model ...
Epoch: 5 cost time: 1.1036369800567627
Epoch: 5, Steps: 9 | Train Loss: 0.979 Vali Loss: 1.228 Vali Acc: 0.449 Test Loss: 1.228 Test Acc: 0.449
Validation loss decreased (-0.442016 --> -0.449263).  Saving model ...
Epoch: 6 cost time: 1.3416154384613037
Epoch: 6, Steps: 9 | Train Loss: 0.896 Vali Loss: 1.204 Vali Acc: 0.449 Test Loss: 1.204 Test Acc: 0.449
Validation loss decreased (-0.449263 --> -0.449263).  Saving model ...
Epoch: 7 cost time: 1.1493663787841797
Epoch: 7, Steps: 9 | Train Loss: 0.823 Vali Loss: 1.182 Vali Acc: 0.457 Test Loss: 1.182 Test Acc: 0.457
Validation loss decreased (-0.449263 --> -0.456510).  Saving model ...
Epoch: 8 cost time: 1.160649061203003
Epoch: 8, Steps: 9 | Train Loss: 0.761 Vali Loss: 1.151 Vali Acc: 0.471 Test Loss: 1.151 Test Acc: 0.471
Validation loss decreased (-0.456510 --> -0.471003).  Saving model ...
Epoch: 9 cost time: 1.1125555038452148
Epoch: 9, Steps: 9 | Train Loss: 0.680 Vali Loss: 1.122 Vali Acc: 0.486 Test Loss: 1.122 Test Acc: 0.486
Validation loss decreased (-0.471003 --> -0.485496).  Saving model ...
Epoch: 10 cost time: 1.254770040512085
Epoch: 10, Steps: 9 | Train Loss: 0.607 Vali Loss: 1.097 Vali Acc: 0.507 Test Loss: 1.097 Test Acc: 0.507
Validation loss decreased (-0.485496 --> -0.507235).  Saving model ...
Epoch: 11 cost time: 1.2272305488586426
Epoch: 11, Steps: 9 | Train Loss: 0.565 Vali Loss: 1.078 Vali Acc: 0.507 Test Loss: 1.078 Test Acc: 0.507
Validation loss decreased (-0.507235 --> -0.507236).  Saving model ...
Epoch: 12 cost time: 1.244157314300537
Epoch: 12, Steps: 9 | Train Loss: 0.510 Vali Loss: 1.065 Vali Acc: 0.529 Test Loss: 1.065 Test Acc: 0.529
Validation loss decreased (-0.507236 --> -0.528975).  Saving model ...
Epoch: 13 cost time: 1.3030509948730469
Epoch: 13, Steps: 9 | Train Loss: 0.457 Vali Loss: 1.045 Vali Acc: 0.565 Test Loss: 1.045 Test Acc: 0.565
Validation loss decreased (-0.528975 --> -0.565207).  Saving model ...
Epoch: 14 cost time: 1.2171425819396973
Epoch: 14, Steps: 9 | Train Loss: 0.411 Vali Loss: 1.032 Vali Acc: 0.580 Test Loss: 1.032 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 15 cost time: 1.2639248371124268
Epoch: 15, Steps: 9 | Train Loss: 0.366 Vali Loss: 1.026 Vali Acc: 0.565 Test Loss: 1.026 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4948019981384277
Epoch: 16, Steps: 9 | Train Loss: 0.338 Vali Loss: 1.021 Vali Acc: 0.609 Test Loss: 1.021 Test Acc: 0.609
Validation loss decreased (-0.579700 --> -0.608685).  Saving model ...
Epoch: 17 cost time: 1.3224341869354248
Epoch: 17, Steps: 9 | Train Loss: 0.305 Vali Loss: 1.012 Vali Acc: 0.609 Test Loss: 1.012 Test Acc: 0.609
Validation loss decreased (-0.608685 --> -0.608686).  Saving model ...
Epoch: 18 cost time: 1.263794183731079
Epoch: 18, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.990 Vali Acc: 0.609 Test Loss: 0.990 Test Acc: 0.609
Validation loss decreased (-0.608686 --> -0.608686).  Saving model ...
Epoch: 19 cost time: 1.3581385612487793
Epoch: 19, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.997 Vali Acc: 0.594 Test Loss: 0.997 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4812932014465332
Epoch: 20, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.998 Vali Acc: 0.580 Test Loss: 0.998 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3591415882110596
Epoch: 21, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.986 Vali Acc: 0.609 Test Loss: 0.986 Test Acc: 0.609
Validation loss decreased (-0.608686 --> -0.608686).  Saving model ...
Epoch: 22 cost time: 1.3995401859283447
Epoch: 22, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.973 Vali Acc: 0.601 Test Loss: 0.973 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4132909774780273
Epoch: 23, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.962 Vali Acc: 0.587 Test Loss: 0.962 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4472053050994873
Epoch: 24, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.958 Vali Acc: 0.587 Test Loss: 0.958 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.674546718597412
Epoch: 25, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.959 Vali Acc: 0.594 Test Loss: 0.959 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5652141571044922
Epoch: 26, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.963 Vali Acc: 0.601 Test Loss: 0.963 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3816258907318115
Epoch: 27, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.966 Vali Acc: 0.594 Test Loss: 0.966 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3996837139129639
Epoch: 28, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.962 Vali Acc: 0.601 Test Loss: 0.962 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5503108501434326
Epoch: 29, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.949 Vali Acc: 0.616 Test Loss: 0.949 Test Acc: 0.616
Validation loss decreased (-0.608686 --> -0.615933).  Saving model ...
Epoch: 30 cost time: 1.6697278022766113
Epoch: 30, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.941 Vali Acc: 0.616 Test Loss: 0.941 Test Acc: 0.616
Validation loss decreased (-0.615933 --> -0.615933).  Saving model ...
Epoch: 31 cost time: 1.4140398502349854
Epoch: 31, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.927 Vali Acc: 0.630 Test Loss: 0.927 Test Acc: 0.630
Validation loss decreased (-0.615933 --> -0.630426).  Saving model ...
Epoch: 32 cost time: 1.4656710624694824
Epoch: 32, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.940 Vali Acc: 0.630 Test Loss: 0.940 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3526887893676758
Epoch: 33, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.948 Vali Acc: 0.630 Test Loss: 0.948 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4730937480926514
Epoch: 34, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.945 Vali Acc: 0.638 Test Loss: 0.945 Test Acc: 0.638
Validation loss decreased (-0.630426 --> -0.637672).  Saving model ...
Epoch: 35 cost time: 1.5485785007476807
Epoch: 35, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.948 Vali Acc: 0.630 Test Loss: 0.948 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3549177646636963
Epoch: 36, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.948 Vali Acc: 0.630 Test Loss: 0.948 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4461662769317627
Epoch: 37, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.956 Vali Acc: 0.623 Test Loss: 0.956 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4140119552612305
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.950 Vali Acc: 0.638 Test Loss: 0.950 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5076451301574707
Epoch: 39, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.952 Vali Acc: 0.630 Test Loss: 0.952 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.6292800903320312
Epoch: 40, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.955 Vali Acc: 0.638 Test Loss: 0.955 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5312316417694092
Epoch: 41, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.967 Vali Acc: 0.623 Test Loss: 0.967 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.319978952407837
Epoch: 42, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.953 Vali Acc: 0.623 Test Loss: 0.953 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.3328897953033447
Epoch: 43, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.947 Vali Acc: 0.623 Test Loss: 0.947 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.478147268295288
Epoch: 44, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.951 Vali Acc: 0.616 Test Loss: 0.951 Test Acc: 0.616
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6376811594202898
model parameter : 899964
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2026751041412354
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.432 Vali Acc: 0.246 Test Loss: 1.432 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 1.3759205341339111
Epoch: 2, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.397 Vali Acc: 0.203 Test Loss: 1.397 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3408470153808594
Epoch: 3, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.364 Vali Acc: 0.246 Test Loss: 1.364 Test Acc: 0.246
Validation loss decreased (-0.246362 --> -0.246363).  Saving model ...
Epoch: 4 cost time: 1.1860649585723877
Epoch: 4, Steps: 9 | Train Loss: 1.125 Vali Loss: 1.336 Vali Acc: 0.275 Test Loss: 1.336 Test Acc: 0.275
Validation loss decreased (-0.246363 --> -0.275349).  Saving model ...
Epoch: 5 cost time: 1.3486390113830566
Epoch: 5, Steps: 9 | Train Loss: 1.038 Vali Loss: 1.304 Vali Acc: 0.319 Test Loss: 1.304 Test Acc: 0.319
Validation loss decreased (-0.275349 --> -0.318828).  Saving model ...
Epoch: 6 cost time: 1.2596056461334229
Epoch: 6, Steps: 9 | Train Loss: 0.971 Vali Loss: 1.273 Vali Acc: 0.377 Test Loss: 1.273 Test Acc: 0.377
Validation loss decreased (-0.318828 --> -0.376799).  Saving model ...
Epoch: 7 cost time: 1.456059217453003
Epoch: 7, Steps: 9 | Train Loss: 0.900 Vali Loss: 1.242 Vali Acc: 0.413 Test Loss: 1.242 Test Acc: 0.413
Validation loss decreased (-0.376799 --> -0.413031).  Saving model ...
Epoch: 8 cost time: 1.4017889499664307
Epoch: 8, Steps: 9 | Train Loss: 0.810 Vali Loss: 1.210 Vali Acc: 0.464 Test Loss: 1.210 Test Acc: 0.464
Validation loss decreased (-0.413031 --> -0.463756).  Saving model ...
Epoch: 9 cost time: 1.2553904056549072
Epoch: 9, Steps: 9 | Train Loss: 0.754 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.463756 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.4145698547363281
Epoch: 10, Steps: 9 | Train Loss: 0.702 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.4099392890930176
Epoch: 11, Steps: 9 | Train Loss: 0.622 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 12 cost time: 1.128652572631836
Epoch: 12, Steps: 9 | Train Loss: 0.585 Vali Loss: 1.134 Vali Acc: 0.522 Test Loss: 1.134 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521728).  Saving model ...
Epoch: 13 cost time: 1.2701365947723389
Epoch: 13, Steps: 9 | Train Loss: 0.536 Vali Loss: 1.115 Vali Acc: 0.536 Test Loss: 1.115 Test Acc: 0.536
Validation loss decreased (-0.521728 --> -0.536221).  Saving model ...
Epoch: 14 cost time: 1.2699737548828125
Epoch: 14, Steps: 9 | Train Loss: 0.495 Vali Loss: 1.115 Vali Acc: 0.543 Test Loss: 1.115 Test Acc: 0.543
Validation loss decreased (-0.536221 --> -0.543467).  Saving model ...
Epoch: 15 cost time: 1.2893836498260498
Epoch: 15, Steps: 9 | Train Loss: 0.432 Vali Loss: 1.089 Vali Acc: 0.601 Test Loss: 1.089 Test Acc: 0.601
Validation loss decreased (-0.543467 --> -0.601438).  Saving model ...
Epoch: 16 cost time: 1.2072768211364746
Epoch: 16, Steps: 9 | Train Loss: 0.405 Vali Loss: 1.074 Vali Acc: 0.572 Test Loss: 1.074 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3415930271148682
Epoch: 17, Steps: 9 | Train Loss: 0.359 Vali Loss: 1.068 Vali Acc: 0.587 Test Loss: 1.068 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3112452030181885
Epoch: 18, Steps: 9 | Train Loss: 0.330 Vali Loss: 1.067 Vali Acc: 0.572 Test Loss: 1.067 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4549009799957275
Epoch: 19, Steps: 9 | Train Loss: 0.284 Vali Loss: 1.053 Vali Acc: 0.601 Test Loss: 1.053 Test Acc: 0.601
Validation loss decreased (-0.601438 --> -0.601439).  Saving model ...
Epoch: 20 cost time: 1.4818096160888672
Epoch: 20, Steps: 9 | Train Loss: 0.258 Vali Loss: 1.038 Vali Acc: 0.594 Test Loss: 1.038 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.39727783203125
Epoch: 21, Steps: 9 | Train Loss: 0.232 Vali Loss: 1.025 Vali Acc: 0.587 Test Loss: 1.025 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5696465969085693
Epoch: 22, Steps: 9 | Train Loss: 0.205 Vali Loss: 1.021 Vali Acc: 0.572 Test Loss: 1.021 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.343740701675415
Epoch: 23, Steps: 9 | Train Loss: 0.182 Vali Loss: 1.034 Vali Acc: 0.580 Test Loss: 1.034 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2856414318084717
Epoch: 24, Steps: 9 | Train Loss: 0.161 Vali Loss: 1.025 Vali Acc: 0.601 Test Loss: 1.025 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601439).  Saving model ...
Epoch: 25 cost time: 1.4173998832702637
Epoch: 25, Steps: 9 | Train Loss: 0.140 Vali Loss: 1.003 Vali Acc: 0.594 Test Loss: 1.003 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3966641426086426
Epoch: 26, Steps: 9 | Train Loss: 0.124 Vali Loss: 1.001 Vali Acc: 0.594 Test Loss: 1.001 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6418571472167969
Epoch: 27, Steps: 9 | Train Loss: 0.108 Vali Loss: 1.005 Vali Acc: 0.601 Test Loss: 1.005 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601439).  Saving model ...
Epoch: 28 cost time: 1.5290086269378662
Epoch: 28, Steps: 9 | Train Loss: 0.092 Vali Loss: 1.003 Vali Acc: 0.623 Test Loss: 1.003 Test Acc: 0.623
Validation loss decreased (-0.601439 --> -0.623178).  Saving model ...
Epoch: 29 cost time: 1.6769545078277588
Epoch: 29, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.990 Vali Acc: 0.609 Test Loss: 0.990 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7059462070465088
Epoch: 30, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.993 Vali Acc: 0.630 Test Loss: 0.993 Test Acc: 0.630
Validation loss decreased (-0.623178 --> -0.630425).  Saving model ...
Epoch: 31 cost time: 1.4711759090423584
Epoch: 31, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.996 Vali Acc: 0.638 Test Loss: 0.996 Test Acc: 0.638
Validation loss decreased (-0.630425 --> -0.637671).  Saving model ...
Epoch: 32 cost time: 1.5332329273223877
Epoch: 32, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.005 Vali Acc: 0.616 Test Loss: 1.005 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7089056968688965
Epoch: 33, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.002 Vali Acc: 0.601 Test Loss: 1.002 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6129322052001953
Epoch: 34, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.004 Vali Acc: 0.609 Test Loss: 1.004 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5914933681488037
Epoch: 35, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.006 Vali Acc: 0.594 Test Loss: 1.006 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.584362268447876
Epoch: 36, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.996 Vali Acc: 0.623 Test Loss: 0.996 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6268625259399414
Epoch: 37, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.005 Vali Acc: 0.623 Test Loss: 1.005 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.483264446258545
Epoch: 38, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.010 Vali Acc: 0.630 Test Loss: 1.010 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8244602680206299
Epoch: 39, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.010 Vali Acc: 0.609 Test Loss: 1.010 Test Acc: 0.609
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5459449291229248
Epoch: 40, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.007 Vali Acc: 0.609 Test Loss: 1.007 Test Acc: 0.609
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.419203519821167
Epoch: 41, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.023 Vali Acc: 0.609 Test Loss: 1.023 Test Acc: 0.609
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6376811594202898
model parameter : 889724
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2827308177948
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.389 Vali Acc: 0.348 Test Loss: 1.389 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 1.2164573669433594
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.357 Vali Acc: 0.333 Test Loss: 1.357 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3319313526153564
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.329 Vali Acc: 0.341 Test Loss: 1.329 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.463287353515625
Epoch: 4, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.294 Vali Acc: 0.370 Test Loss: 1.294 Test Acc: 0.370
Validation loss decreased (-0.347812 --> -0.369552).  Saving model ...
Epoch: 5 cost time: 1.1029479503631592
Epoch: 5, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.267 Vali Acc: 0.399 Test Loss: 1.267 Test Acc: 0.399
Validation loss decreased (-0.369552 --> -0.398538).  Saving model ...
Epoch: 6 cost time: 1.533689022064209
Epoch: 6, Steps: 9 | Train Loss: 0.933 Vali Loss: 1.235 Vali Acc: 0.420 Test Loss: 1.235 Test Acc: 0.420
Validation loss decreased (-0.398538 --> -0.420278).  Saving model ...
Epoch: 7 cost time: 1.3093163967132568
Epoch: 7, Steps: 9 | Train Loss: 0.855 Vali Loss: 1.203 Vali Acc: 0.428 Test Loss: 1.203 Test Acc: 0.428
Validation loss decreased (-0.420278 --> -0.427524).  Saving model ...
Epoch: 8 cost time: 1.2673656940460205
Epoch: 8, Steps: 9 | Train Loss: 0.777 Vali Loss: 1.172 Vali Acc: 0.478 Test Loss: 1.172 Test Acc: 0.478
Validation loss decreased (-0.427524 --> -0.478249).  Saving model ...
Epoch: 9 cost time: 1.1760408878326416
Epoch: 9, Steps: 9 | Train Loss: 0.716 Vali Loss: 1.146 Vali Acc: 0.507 Test Loss: 1.146 Test Acc: 0.507
Validation loss decreased (-0.478249 --> -0.507235).  Saving model ...
Epoch: 10 cost time: 1.2615203857421875
Epoch: 10, Steps: 9 | Train Loss: 0.645 Vali Loss: 1.119 Vali Acc: 0.551 Test Loss: 1.119 Test Acc: 0.551
Validation loss decreased (-0.507235 --> -0.550713).  Saving model ...
Epoch: 11 cost time: 1.4557878971099854
Epoch: 11, Steps: 9 | Train Loss: 0.598 Vali Loss: 1.107 Vali Acc: 0.558 Test Loss: 1.107 Test Acc: 0.558
Validation loss decreased (-0.550713 --> -0.557960).  Saving model ...
Epoch: 12 cost time: 1.3706624507904053
Epoch: 12, Steps: 9 | Train Loss: 0.528 Vali Loss: 1.087 Vali Acc: 0.551 Test Loss: 1.087 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0780134201049805
Epoch: 13, Steps: 9 | Train Loss: 0.486 Vali Loss: 1.077 Vali Acc: 0.558 Test Loss: 1.077 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 14 cost time: 1.3587379455566406
Epoch: 14, Steps: 9 | Train Loss: 0.435 Vali Loss: 1.067 Vali Acc: 0.558 Test Loss: 1.067 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 15 cost time: 1.2659306526184082
Epoch: 15, Steps: 9 | Train Loss: 0.397 Vali Loss: 1.037 Vali Acc: 0.572 Test Loss: 1.037 Test Acc: 0.572
Validation loss decreased (-0.557960 --> -0.572453).  Saving model ...
Epoch: 16 cost time: 1.1028289794921875
Epoch: 16, Steps: 9 | Train Loss: 0.352 Vali Loss: 1.035 Vali Acc: 0.572 Test Loss: 1.035 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 17 cost time: 1.216317892074585
Epoch: 17, Steps: 9 | Train Loss: 0.314 Vali Loss: 1.023 Vali Acc: 0.572 Test Loss: 1.023 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572454).  Saving model ...
Epoch: 18 cost time: 1.34047269821167
Epoch: 18, Steps: 9 | Train Loss: 0.280 Vali Loss: 1.012 Vali Acc: 0.587 Test Loss: 1.012 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586946).  Saving model ...
Epoch: 19 cost time: 1.4642634391784668
Epoch: 19, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.998 Vali Acc: 0.594 Test Loss: 0.998 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 20 cost time: 1.2517821788787842
Epoch: 20, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.993 Vali Acc: 0.580 Test Loss: 0.993 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3426613807678223
Epoch: 21, Steps: 9 | Train Loss: 0.198 Vali Loss: 1.000 Vali Acc: 0.587 Test Loss: 1.000 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2902600765228271
Epoch: 22, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.983 Vali Acc: 0.594 Test Loss: 0.983 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 23 cost time: 1.249372959136963
Epoch: 23, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.989 Vali Acc: 0.587 Test Loss: 0.989 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.47365403175354
Epoch: 24, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.992 Vali Acc: 0.580 Test Loss: 0.992 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3155601024627686
Epoch: 25, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.997 Vali Acc: 0.565 Test Loss: 0.997 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3868722915649414
Epoch: 26, Steps: 9 | Train Loss: 0.104 Vali Loss: 1.005 Vali Acc: 0.565 Test Loss: 1.005 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2121493816375732
Epoch: 27, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.986 Vali Acc: 0.572 Test Loss: 0.986 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1440553665161133
Epoch: 28, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.995 Vali Acc: 0.572 Test Loss: 0.995 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3677394390106201
Epoch: 29, Steps: 9 | Train Loss: 0.069 Vali Loss: 1.003 Vali Acc: 0.580 Test Loss: 1.003 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2220063209533691
Epoch: 30, Steps: 9 | Train Loss: 0.064 Vali Loss: 1.003 Vali Acc: 0.580 Test Loss: 1.003 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3301341533660889
Epoch: 31, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.009 Vali Acc: 0.572 Test Loss: 1.009 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3050885200500488
Epoch: 32, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.004 Vali Acc: 0.565 Test Loss: 1.004 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 879484
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.799490451812744
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.389 Vali Acc: 0.290 Test Loss: 1.389 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.07072114944458
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.356 Vali Acc: 0.283 Test Loss: 1.356 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.128561019897461
Epoch: 3, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.327 Vali Acc: 0.355 Test Loss: 1.327 Test Acc: 0.355
Validation loss decreased (-0.289841 --> -0.355059).  Saving model ...
Epoch: 4 cost time: 1.0798265933990479
Epoch: 4, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.307 Vali Acc: 0.377 Test Loss: 1.307 Test Acc: 0.377
Validation loss decreased (-0.355059 --> -0.376799).  Saving model ...
Epoch: 5 cost time: 1.0487101078033447
Epoch: 5, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.270 Vali Acc: 0.420 Test Loss: 1.270 Test Acc: 0.420
Validation loss decreased (-0.376799 --> -0.420277).  Saving model ...
Epoch: 6 cost time: 1.249192237854004
Epoch: 6, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.234 Vali Acc: 0.471 Test Loss: 1.234 Test Acc: 0.471
Validation loss decreased (-0.420277 --> -0.471002).  Saving model ...
Epoch: 7 cost time: 1.1668426990509033
Epoch: 7, Steps: 9 | Train Loss: 0.939 Vali Loss: 1.213 Vali Acc: 0.471 Test Loss: 1.213 Test Acc: 0.471
Validation loss decreased (-0.471002 --> -0.471002).  Saving model ...
Epoch: 8 cost time: 1.0877182483673096
Epoch: 8, Steps: 9 | Train Loss: 0.859 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.471002 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.1252760887145996
Epoch: 9, Steps: 9 | Train Loss: 0.799 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.1844255924224854
Epoch: 10, Steps: 9 | Train Loss: 0.732 Vali Loss: 1.150 Vali Acc: 0.536 Test Loss: 1.150 Test Acc: 0.536
Validation loss decreased (-0.499988 --> -0.536220).  Saving model ...
Epoch: 11 cost time: 1.02252197265625
Epoch: 11, Steps: 9 | Train Loss: 0.642 Vali Loss: 1.126 Vali Acc: 0.558 Test Loss: 1.126 Test Acc: 0.558
Validation loss decreased (-0.536220 --> -0.557960).  Saving model ...
Epoch: 12 cost time: 1.2402689456939697
Epoch: 12, Steps: 9 | Train Loss: 0.577 Vali Loss: 1.105 Vali Acc: 0.580 Test Loss: 1.105 Test Acc: 0.580
Validation loss decreased (-0.557960 --> -0.579699).  Saving model ...
Epoch: 13 cost time: 1.1165108680725098
Epoch: 13, Steps: 9 | Train Loss: 0.531 Vali Loss: 1.093 Vali Acc: 0.572 Test Loss: 1.093 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.99501633644104
Epoch: 14, Steps: 9 | Train Loss: 0.467 Vali Loss: 1.077 Vali Acc: 0.572 Test Loss: 1.077 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1977458000183105
Epoch: 15, Steps: 9 | Train Loss: 0.416 Vali Loss: 1.070 Vali Acc: 0.580 Test Loss: 1.070 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579699).  Saving model ...
Epoch: 16 cost time: 1.2179334163665771
Epoch: 16, Steps: 9 | Train Loss: 0.368 Vali Loss: 1.058 Vali Acc: 0.601 Test Loss: 1.058 Test Acc: 0.601
Validation loss decreased (-0.579699 --> -0.601439).  Saving model ...
Epoch: 17 cost time: 1.1768391132354736
Epoch: 17, Steps: 9 | Train Loss: 0.326 Vali Loss: 1.056 Vali Acc: 0.572 Test Loss: 1.056 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.002223253250122
Epoch: 18, Steps: 9 | Train Loss: 0.292 Vali Loss: 1.050 Vali Acc: 0.572 Test Loss: 1.050 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4298217296600342
Epoch: 19, Steps: 9 | Train Loss: 0.246 Vali Loss: 1.048 Vali Acc: 0.558 Test Loss: 1.048 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3007268905639648
Epoch: 20, Steps: 9 | Train Loss: 0.222 Vali Loss: 1.057 Vali Acc: 0.543 Test Loss: 1.057 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5743813514709473
Epoch: 21, Steps: 9 | Train Loss: 0.191 Vali Loss: 1.044 Vali Acc: 0.536 Test Loss: 1.044 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.388037919998169
Epoch: 22, Steps: 9 | Train Loss: 0.166 Vali Loss: 1.027 Vali Acc: 0.580 Test Loss: 1.027 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.299241542816162
Epoch: 23, Steps: 9 | Train Loss: 0.142 Vali Loss: 1.031 Vali Acc: 0.572 Test Loss: 1.031 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1864089965820312
Epoch: 24, Steps: 9 | Train Loss: 0.118 Vali Loss: 1.032 Vali Acc: 0.558 Test Loss: 1.032 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1397087574005127
Epoch: 25, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.037 Vali Acc: 0.587 Test Loss: 1.037 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4092605113983154
Epoch: 26, Steps: 9 | Train Loss: 0.087 Vali Loss: 1.041 Vali Acc: 0.558 Test Loss: 1.041 Test Acc: 0.558
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6014492753623188
model parameter : 869244
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.74174165725708
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.380 Vali Acc: 0.333 Test Loss: 1.380 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.8289921283721924
Epoch: 2, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.310 Vali Acc: 0.384 Test Loss: 1.310 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.020094871520996
Epoch: 3, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.250 Vali Acc: 0.449 Test Loss: 1.250 Test Acc: 0.449
Validation loss decreased (-0.384045 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.9583394527435303
Epoch: 4, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.449263 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2480711936950684
Epoch: 5, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.164 Vali Acc: 0.536 Test Loss: 1.164 Test Acc: 0.536
Validation loss decreased (-0.499988 --> -0.536220).  Saving model ...
Epoch: 6 cost time: 1.0034677982330322
Epoch: 6, Steps: 9 | Train Loss: 0.917 Vali Loss: 1.142 Vali Acc: 0.529 Test Loss: 1.142 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8553483486175537
Epoch: 7, Steps: 9 | Train Loss: 0.822 Vali Loss: 1.108 Vali Acc: 0.536 Test Loss: 1.108 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536221).  Saving model ...
Epoch: 8 cost time: 0.9191915988922119
Epoch: 8, Steps: 9 | Train Loss: 0.755 Vali Loss: 1.075 Vali Acc: 0.572 Test Loss: 1.075 Test Acc: 0.572
Validation loss decreased (-0.536221 --> -0.572453).  Saving model ...
Epoch: 9 cost time: 0.8423182964324951
Epoch: 9, Steps: 9 | Train Loss: 0.680 Vali Loss: 1.057 Vali Acc: 0.580 Test Loss: 1.057 Test Acc: 0.580
Validation loss decreased (-0.572453 --> -0.579700).  Saving model ...
Epoch: 10 cost time: 1.0230495929718018
Epoch: 10, Steps: 9 | Train Loss: 0.616 Vali Loss: 1.037 Vali Acc: 0.594 Test Loss: 1.037 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594193).  Saving model ...
Epoch: 11 cost time: 0.9420559406280518
Epoch: 11, Steps: 9 | Train Loss: 0.539 Vali Loss: 1.026 Vali Acc: 0.587 Test Loss: 1.026 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9661223888397217
Epoch: 12, Steps: 9 | Train Loss: 0.479 Vali Loss: 1.006 Vali Acc: 0.572 Test Loss: 1.006 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9796187877655029
Epoch: 13, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.994 Vali Acc: 0.580 Test Loss: 0.994 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8647251129150391
Epoch: 14, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.973 Vali Acc: 0.630 Test Loss: 0.973 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630425).  Saving model ...
Epoch: 15 cost time: 0.9825704097747803
Epoch: 15, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.960 Vali Acc: 0.609 Test Loss: 0.960 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.138289213180542
Epoch: 16, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.949 Vali Acc: 0.609 Test Loss: 0.949 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0602221488952637
Epoch: 17, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.935 Vali Acc: 0.616 Test Loss: 0.935 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9417955875396729
Epoch: 18, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.927 Vali Acc: 0.623 Test Loss: 0.927 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9314281940460205
Epoch: 19, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.916 Vali Acc: 0.652 Test Loss: 0.916 Test Acc: 0.652
Validation loss decreased (-0.630425 --> -0.652165).  Saving model ...
Epoch: 20 cost time: 1.0001568794250488
Epoch: 20, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.917 Vali Acc: 0.630 Test Loss: 0.917 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1448824405670166
Epoch: 21, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.927 Vali Acc: 0.645 Test Loss: 0.927 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9883615970611572
Epoch: 22, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.907 Vali Acc: 0.659 Test Loss: 0.907 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659411).  Saving model ...
Epoch: 23 cost time: 1.2685084342956543
Epoch: 23, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.913 Vali Acc: 0.652 Test Loss: 0.913 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0356898307800293
Epoch: 24, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.916 Vali Acc: 0.659 Test Loss: 0.916 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9959871768951416
Epoch: 25, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.910 Vali Acc: 0.659 Test Loss: 0.910 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4580936431884766
Epoch: 26, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.913 Vali Acc: 0.638 Test Loss: 0.913 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.050807237625122
Epoch: 27, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.910 Vali Acc: 0.630 Test Loss: 0.910 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.19563889503479
Epoch: 28, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.914 Vali Acc: 0.638 Test Loss: 0.914 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1433358192443848
Epoch: 29, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.908 Vali Acc: 0.623 Test Loss: 0.908 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0015571117401123
Epoch: 30, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.905 Vali Acc: 0.623 Test Loss: 0.905 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.107300043106079
Epoch: 31, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.907 Vali Acc: 0.623 Test Loss: 0.907 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0164399147033691
Epoch: 32, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.906 Vali Acc: 0.623 Test Loss: 0.906 Test Acc: 0.623
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6594202898550725
model parameter : 861052
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.016664743423462
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.426 Vali Acc: 0.254 Test Loss: 1.426 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.1831908226013184
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.377 Vali Acc: 0.312 Test Loss: 1.377 Test Acc: 0.312
Validation loss decreased (-0.253609 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 1.2246685028076172
Epoch: 3, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.327 Vali Acc: 0.355 Test Loss: 1.327 Test Acc: 0.355
Validation loss decreased (-0.311580 --> -0.355059).  Saving model ...
Epoch: 4 cost time: 0.8039941787719727
Epoch: 4, Steps: 9 | Train Loss: 1.109 Vali Loss: 1.278 Vali Acc: 0.391 Test Loss: 1.278 Test Acc: 0.391
Validation loss decreased (-0.355059 --> -0.391292).  Saving model ...
Epoch: 5 cost time: 1.0284156799316406
Epoch: 5, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.229 Vali Acc: 0.428 Test Loss: 1.229 Test Acc: 0.428
Validation loss decreased (-0.391292 --> -0.427524).  Saving model ...
Epoch: 6 cost time: 0.9074928760528564
Epoch: 6, Steps: 9 | Train Loss: 0.898 Vali Loss: 1.183 Vali Acc: 0.449 Test Loss: 1.183 Test Acc: 0.449
Validation loss decreased (-0.427524 --> -0.449264).  Saving model ...
Epoch: 7 cost time: 0.8699698448181152
Epoch: 7, Steps: 9 | Train Loss: 0.814 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.449264 --> -0.514481).  Saving model ...
Epoch: 8 cost time: 1.128941535949707
Epoch: 8, Steps: 9 | Train Loss: 0.734 Vali Loss: 1.135 Vali Acc: 0.507 Test Loss: 1.135 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9773542881011963
Epoch: 9, Steps: 9 | Train Loss: 0.664 Vali Loss: 1.116 Vali Acc: 0.493 Test Loss: 1.116 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9636738300323486
Epoch: 10, Steps: 9 | Train Loss: 0.595 Vali Loss: 1.097 Vali Acc: 0.507 Test Loss: 1.097 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0454845428466797
Epoch: 11, Steps: 9 | Train Loss: 0.518 Vali Loss: 1.093 Vali Acc: 0.507 Test Loss: 1.093 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.23756742477417
Epoch: 12, Steps: 9 | Train Loss: 0.459 Vali Loss: 1.089 Vali Acc: 0.514 Test Loss: 1.089 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514482).  Saving model ...
Epoch: 13 cost time: 0.8985576629638672
Epoch: 13, Steps: 9 | Train Loss: 0.396 Vali Loss: 1.081 Vali Acc: 0.493 Test Loss: 1.081 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8204326629638672
Epoch: 14, Steps: 9 | Train Loss: 0.357 Vali Loss: 1.067 Vali Acc: 0.522 Test Loss: 1.067 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521728).  Saving model ...
Epoch: 15 cost time: 0.8512790203094482
Epoch: 15, Steps: 9 | Train Loss: 0.313 Vali Loss: 1.057 Vali Acc: 0.529 Test Loss: 1.057 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528975).  Saving model ...
Epoch: 16 cost time: 0.9162893295288086
Epoch: 16, Steps: 9 | Train Loss: 0.272 Vali Loss: 1.050 Vali Acc: 0.536 Test Loss: 1.050 Test Acc: 0.536
Validation loss decreased (-0.528975 --> -0.536221).  Saving model ...
Epoch: 17 cost time: 1.0154821872711182
Epoch: 17, Steps: 9 | Train Loss: 0.233 Vali Loss: 1.033 Vali Acc: 0.543 Test Loss: 1.033 Test Acc: 0.543
Validation loss decreased (-0.536221 --> -0.543468).  Saving model ...
Epoch: 18 cost time: 0.9889214038848877
Epoch: 18, Steps: 9 | Train Loss: 0.197 Vali Loss: 1.037 Vali Acc: 0.529 Test Loss: 1.037 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0507197380065918
Epoch: 19, Steps: 9 | Train Loss: 0.175 Vali Loss: 1.034 Vali Acc: 0.543 Test Loss: 1.034 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8813996315002441
Epoch: 20, Steps: 9 | Train Loss: 0.148 Vali Loss: 1.017 Vali Acc: 0.558 Test Loss: 1.017 Test Acc: 0.558
Validation loss decreased (-0.543468 --> -0.557961).  Saving model ...
Epoch: 21 cost time: 0.7843925952911377
Epoch: 21, Steps: 9 | Train Loss: 0.125 Vali Loss: 1.010 Vali Acc: 0.565 Test Loss: 1.010 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565207).  Saving model ...
Epoch: 22 cost time: 0.971027135848999
Epoch: 22, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.019 Vali Acc: 0.558 Test Loss: 1.019 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8481481075286865
Epoch: 23, Steps: 9 | Train Loss: 0.096 Vali Loss: 1.023 Vali Acc: 0.551 Test Loss: 1.023 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.949498176574707
Epoch: 24, Steps: 9 | Train Loss: 0.077 Vali Loss: 1.007 Vali Acc: 0.580 Test Loss: 1.007 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 25 cost time: 0.7963669300079346
Epoch: 25, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.012 Vali Acc: 0.565 Test Loss: 1.012 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9755074977874756
Epoch: 26, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.014 Vali Acc: 0.565 Test Loss: 1.014 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0587043762207031
Epoch: 27, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.009 Vali Acc: 0.565 Test Loss: 1.009 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0334134101867676
Epoch: 28, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.003 Vali Acc: 0.565 Test Loss: 1.003 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9568808078765869
Epoch: 29, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.006 Vali Acc: 0.558 Test Loss: 1.006 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8888652324676514
Epoch: 30, Steps: 9 | Train Loss: 0.036 Vali Loss: 1.004 Vali Acc: 0.565 Test Loss: 1.004 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9060184955596924
Epoch: 31, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.004 Vali Acc: 0.572 Test Loss: 1.004 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0201866626739502
Epoch: 32, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.010 Vali Acc: 0.572 Test Loss: 1.010 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9297876358032227
Epoch: 33, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.009 Vali Acc: 0.565 Test Loss: 1.009 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8056948184967041
Epoch: 34, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.006 Vali Acc: 0.572 Test Loss: 1.006 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 856956
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.78375244140625
Epoch: 1, Steps: 9 | Train Loss: 1.467 Vali Loss: 1.440 Vali Acc: 0.188 Test Loss: 1.440 Test Acc: 0.188
Validation loss decreased (inf --> -0.188391).  Saving model ...
Epoch: 2 cost time: 0.8346741199493408
Epoch: 2, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.388 Vali Acc: 0.246 Test Loss: 1.388 Test Acc: 0.246
Validation loss decreased (-0.188391 --> -0.246363).  Saving model ...
Epoch: 3 cost time: 0.7241785526275635
Epoch: 3, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.334 Vali Acc: 0.370 Test Loss: 1.334 Test Acc: 0.370
Validation loss decreased (-0.246363 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 0.8643841743469238
Epoch: 4, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.292 Vali Acc: 0.384 Test Loss: 1.292 Test Acc: 0.384
Validation loss decreased (-0.369552 --> -0.384045).  Saving model ...
Epoch: 5 cost time: 0.7156491279602051
Epoch: 5, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.259 Vali Acc: 0.413 Test Loss: 1.259 Test Acc: 0.413
Validation loss decreased (-0.384045 --> -0.413031).  Saving model ...
Epoch: 6 cost time: 0.8662378787994385
Epoch: 6, Steps: 9 | Train Loss: 0.992 Vali Loss: 1.226 Vali Acc: 0.420 Test Loss: 1.226 Test Acc: 0.420
Validation loss decreased (-0.413031 --> -0.420278).  Saving model ...
Epoch: 7 cost time: 0.9020354747772217
Epoch: 7, Steps: 9 | Train Loss: 0.888 Vali Loss: 1.188 Vali Acc: 0.478 Test Loss: 1.188 Test Acc: 0.478
Validation loss decreased (-0.420278 --> -0.478249).  Saving model ...
Epoch: 8 cost time: 0.748401403427124
Epoch: 8, Steps: 9 | Train Loss: 0.807 Vali Loss: 1.155 Vali Acc: 0.471 Test Loss: 1.155 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9627406597137451
Epoch: 9, Steps: 9 | Train Loss: 0.699 Vali Loss: 1.114 Vali Acc: 0.522 Test Loss: 1.114 Test Acc: 0.522
Validation loss decreased (-0.478249 --> -0.521728).  Saving model ...
Epoch: 10 cost time: 1.0317754745483398
Epoch: 10, Steps: 9 | Train Loss: 0.625 Vali Loss: 1.077 Vali Acc: 0.580 Test Loss: 1.077 Test Acc: 0.580
Validation loss decreased (-0.521728 --> -0.579699).  Saving model ...
Epoch: 11 cost time: 0.8072471618652344
Epoch: 11, Steps: 9 | Train Loss: 0.529 Vali Loss: 1.054 Vali Acc: 0.609 Test Loss: 1.054 Test Acc: 0.609
Validation loss decreased (-0.579699 --> -0.608685).  Saving model ...
Epoch: 12 cost time: 1.0007908344268799
Epoch: 12, Steps: 9 | Train Loss: 0.458 Vali Loss: 1.033 Vali Acc: 0.609 Test Loss: 1.033 Test Acc: 0.609
Validation loss decreased (-0.608685 --> -0.608685).  Saving model ...
Epoch: 13 cost time: 0.9349865913391113
Epoch: 13, Steps: 9 | Train Loss: 0.403 Vali Loss: 1.002 Vali Acc: 0.638 Test Loss: 1.002 Test Acc: 0.638
Validation loss decreased (-0.608685 --> -0.637671).  Saving model ...
Epoch: 14 cost time: 0.9250009059906006
Epoch: 14, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.996 Vali Acc: 0.623 Test Loss: 0.996 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8827531337738037
Epoch: 15, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.968 Vali Acc: 0.638 Test Loss: 0.968 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637671).  Saving model ...
Epoch: 16 cost time: 0.7531814575195312
Epoch: 16, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.964 Vali Acc: 0.630 Test Loss: 0.964 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9221541881561279
Epoch: 17, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.957 Vali Acc: 0.630 Test Loss: 0.957 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9645655155181885
Epoch: 18, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.947 Vali Acc: 0.645 Test Loss: 0.947 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644918).  Saving model ...
Epoch: 19 cost time: 0.7609207630157471
Epoch: 19, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.934 Vali Acc: 0.630 Test Loss: 0.934 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.879086971282959
Epoch: 20, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.938 Vali Acc: 0.645 Test Loss: 0.938 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644918).  Saving model ...
Epoch: 21 cost time: 0.8971376419067383
Epoch: 21, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.936 Vali Acc: 0.630 Test Loss: 0.936 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9479091167449951
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.929 Vali Acc: 0.638 Test Loss: 0.929 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8468303680419922
Epoch: 23, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.931 Vali Acc: 0.667 Test Loss: 0.931 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666657).  Saving model ...
Epoch: 24 cost time: 0.9356198310852051
Epoch: 24, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.927 Vali Acc: 0.667 Test Loss: 0.927 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 25 cost time: 0.823632001876831
Epoch: 25, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.931 Vali Acc: 0.659 Test Loss: 0.931 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0151970386505127
Epoch: 26, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.941 Vali Acc: 0.652 Test Loss: 0.941 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9650602340698242
Epoch: 27, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.957 Vali Acc: 0.630 Test Loss: 0.957 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.929936408996582
Epoch: 28, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.965 Vali Acc: 0.630 Test Loss: 0.965 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8213274478912354
Epoch: 29, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.968 Vali Acc: 0.630 Test Loss: 0.968 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0158262252807617
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.977 Vali Acc: 0.630 Test Loss: 0.977 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7620422840118408
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.977 Vali Acc: 0.638 Test Loss: 0.977 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8782808780670166
Epoch: 32, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.977 Vali Acc: 0.638 Test Loss: 0.977 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.919635534286499
Epoch: 33, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.973 Vali Acc: 0.645 Test Loss: 0.973 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8562731742858887
Epoch: 34, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.973 Vali Acc: 0.652 Test Loss: 0.973 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6666666666666666
model parameter : 852860
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6173348426818848
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.401 Vali Acc: 0.304 Test Loss: 1.401 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.78464674949646
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.334 Vali Acc: 0.406 Test Loss: 1.334 Test Acc: 0.406
Validation loss decreased (-0.304334 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.0244948863983154
Epoch: 3, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.272 Vali Acc: 0.493 Test Loss: 1.272 Test Acc: 0.493
Validation loss decreased (-0.405784 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 1.0665092468261719
Epoch: 4, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.222 Vali Acc: 0.493 Test Loss: 1.222 Test Acc: 0.493
Validation loss decreased (-0.492741 --> -0.492741).  Saving model ...
Epoch: 5 cost time: 0.869579553604126
Epoch: 5, Steps: 9 | Train Loss: 0.924 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.492741 --> -0.514481).  Saving model ...
Epoch: 6 cost time: 1.0227413177490234
Epoch: 6, Steps: 9 | Train Loss: 0.809 Vali Loss: 1.137 Vali Acc: 0.536 Test Loss: 1.137 Test Acc: 0.536
Validation loss decreased (-0.514481 --> -0.536221).  Saving model ...
Epoch: 7 cost time: 0.8594748973846436
Epoch: 7, Steps: 9 | Train Loss: 0.685 Vali Loss: 1.104 Vali Acc: 0.565 Test Loss: 1.104 Test Acc: 0.565
Validation loss decreased (-0.536221 --> -0.565206).  Saving model ...
Epoch: 8 cost time: 0.7133631706237793
Epoch: 8, Steps: 9 | Train Loss: 0.607 Vali Loss: 1.066 Vali Acc: 0.594 Test Loss: 1.066 Test Acc: 0.594
Validation loss decreased (-0.565206 --> -0.594192).  Saving model ...
Epoch: 9 cost time: 0.9176738262176514
Epoch: 9, Steps: 9 | Train Loss: 0.520 Vali Loss: 1.044 Vali Acc: 0.616 Test Loss: 1.044 Test Acc: 0.616
Validation loss decreased (-0.594192 --> -0.615932).  Saving model ...
Epoch: 10 cost time: 0.8835208415985107
Epoch: 10, Steps: 9 | Train Loss: 0.449 Vali Loss: 1.020 Vali Acc: 0.609 Test Loss: 1.020 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8153491020202637
Epoch: 11, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.992 Vali Acc: 0.623 Test Loss: 0.992 Test Acc: 0.623
Validation loss decreased (-0.615932 --> -0.623178).  Saving model ...
Epoch: 12 cost time: 0.7959003448486328
Epoch: 12, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.971 Vali Acc: 0.638 Test Loss: 0.971 Test Acc: 0.638
Validation loss decreased (-0.623178 --> -0.637671).  Saving model ...
Epoch: 13 cost time: 0.7912027835845947
Epoch: 13, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.954 Vali Acc: 0.638 Test Loss: 0.954 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637672).  Saving model ...
Epoch: 14 cost time: 0.9586081504821777
Epoch: 14, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.932 Vali Acc: 0.645 Test Loss: 0.932 Test Acc: 0.645
Validation loss decreased (-0.637672 --> -0.644918).  Saving model ...
Epoch: 15 cost time: 1.0993261337280273
Epoch: 15, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.918 Vali Acc: 0.623 Test Loss: 0.918 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8987565040588379
Epoch: 16, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.909 Vali Acc: 0.638 Test Loss: 0.909 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.861046314239502
Epoch: 17, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.891 Vali Acc: 0.645 Test Loss: 0.891 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644919).  Saving model ...
Epoch: 18 cost time: 0.6536960601806641
Epoch: 18, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.891 Vali Acc: 0.623 Test Loss: 0.891 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9781105518341064
Epoch: 19, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.892 Vali Acc: 0.630 Test Loss: 0.892 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8112201690673828
Epoch: 20, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.884 Vali Acc: 0.638 Test Loss: 0.884 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9304826259613037
Epoch: 21, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.879 Vali Acc: 0.630 Test Loss: 0.879 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9612207412719727
Epoch: 22, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.884 Vali Acc: 0.630 Test Loss: 0.884 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0203979015350342
Epoch: 23, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.880 Vali Acc: 0.630 Test Loss: 0.880 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9030671119689941
Epoch: 24, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.879 Vali Acc: 0.630 Test Loss: 0.879 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.732276201248169
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.881 Vali Acc: 0.630 Test Loss: 0.881 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8425028324127197
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.884 Vali Acc: 0.630 Test Loss: 0.884 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7647371292114258
Epoch: 27, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.886 Vali Acc: 0.630 Test Loss: 0.886 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.644927536231884
model parameter : 848764
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4358251094818115
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.334 Vali Acc: 0.333 Test Loss: 1.334 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.6508500576019287
Epoch: 2, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.222 Vali Acc: 0.428 Test Loss: 1.222 Test Acc: 0.428
Validation loss decreased (-0.333320 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 1.7397589683532715
Epoch: 3, Steps: 9 | Train Loss: 0.966 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.427524 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.5160572528839111
Epoch: 4, Steps: 9 | Train Loss: 0.823 Vali Loss: 1.149 Vali Acc: 0.522 Test Loss: 1.149 Test Acc: 0.522
Validation loss decreased (-0.499988 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 1.6030867099761963
Epoch: 5, Steps: 9 | Train Loss: 0.742 Vali Loss: 1.099 Vali Acc: 0.601 Test Loss: 1.099 Test Acc: 0.601
Validation loss decreased (-0.521728 --> -0.601438).  Saving model ...
Epoch: 6 cost time: 1.586254358291626
Epoch: 6, Steps: 9 | Train Loss: 0.668 Vali Loss: 1.067 Vali Acc: 0.616 Test Loss: 1.067 Test Acc: 0.616
Validation loss decreased (-0.601438 --> -0.615931).  Saving model ...
Epoch: 7 cost time: 1.6324703693389893
Epoch: 7, Steps: 9 | Train Loss: 0.577 Vali Loss: 1.093 Vali Acc: 0.587 Test Loss: 1.093 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8496036529541016
Epoch: 8, Steps: 9 | Train Loss: 0.524 Vali Loss: 1.049 Vali Acc: 0.594 Test Loss: 1.049 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.727034568786621
Epoch: 9, Steps: 9 | Train Loss: 0.474 Vali Loss: 1.032 Vali Acc: 0.587 Test Loss: 1.032 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.560532808303833
Epoch: 10, Steps: 9 | Train Loss: 0.429 Vali Loss: 1.011 Vali Acc: 0.609 Test Loss: 1.011 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.115212917327881
Epoch: 11, Steps: 9 | Train Loss: 0.381 Vali Loss: 1.011 Vali Acc: 0.601 Test Loss: 1.011 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.773468017578125
Epoch: 12, Steps: 9 | Train Loss: 0.359 Vali Loss: 1.023 Vali Acc: 0.594 Test Loss: 1.023 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4367873668670654
Epoch: 13, Steps: 9 | Train Loss: 0.328 Vali Loss: 1.003 Vali Acc: 0.572 Test Loss: 1.003 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.783984899520874
Epoch: 14, Steps: 9 | Train Loss: 0.299 Vali Loss: 1.008 Vali Acc: 0.572 Test Loss: 1.008 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.085178852081299
Epoch: 15, Steps: 9 | Train Loss: 0.275 Vali Loss: 1.055 Vali Acc: 0.536 Test Loss: 1.055 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6385157108306885
Epoch: 16, Steps: 9 | Train Loss: 0.235 Vali Loss: 1.058 Vali Acc: 0.565 Test Loss: 1.058 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6159420289855072
model parameter : 899930
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.613508462905884
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.394 Vali Acc: 0.304 Test Loss: 1.394 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.4418120384216309
Epoch: 2, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.242 Vali Acc: 0.413 Test Loss: 1.242 Test Acc: 0.413
Validation loss decreased (-0.304334 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.658909559249878
Epoch: 3, Steps: 9 | Train Loss: 1.021 Vali Loss: 1.154 Vali Acc: 0.507 Test Loss: 1.154 Test Acc: 0.507
Validation loss decreased (-0.413031 --> -0.507235).  Saving model ...
Epoch: 4 cost time: 1.6520211696624756
Epoch: 4, Steps: 9 | Train Loss: 0.857 Vali Loss: 1.144 Vali Acc: 0.522 Test Loss: 1.144 Test Acc: 0.522
Validation loss decreased (-0.507235 --> -0.521728).  Saving model ...
Epoch: 5 cost time: 1.5141658782958984
Epoch: 5, Steps: 9 | Train Loss: 0.758 Vali Loss: 1.133 Vali Acc: 0.514 Test Loss: 1.133 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7039682865142822
Epoch: 6, Steps: 9 | Train Loss: 0.639 Vali Loss: 1.098 Vali Acc: 0.529 Test Loss: 1.098 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528975).  Saving model ...
Epoch: 7 cost time: 1.7549054622650146
Epoch: 7, Steps: 9 | Train Loss: 0.581 Vali Loss: 1.065 Vali Acc: 0.551 Test Loss: 1.065 Test Acc: 0.551
Validation loss decreased (-0.528975 --> -0.550714).  Saving model ...
Epoch: 8 cost time: 1.8097434043884277
Epoch: 8, Steps: 9 | Train Loss: 0.526 Vali Loss: 1.084 Vali Acc: 0.536 Test Loss: 1.084 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5129754543304443
Epoch: 9, Steps: 9 | Train Loss: 0.460 Vali Loss: 1.068 Vali Acc: 0.529 Test Loss: 1.068 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7833034992218018
Epoch: 10, Steps: 9 | Train Loss: 0.396 Vali Loss: 1.062 Vali Acc: 0.522 Test Loss: 1.062 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.602142572402954
Epoch: 11, Steps: 9 | Train Loss: 0.362 Vali Loss: 1.044 Vali Acc: 0.572 Test Loss: 1.044 Test Acc: 0.572
Validation loss decreased (-0.550714 --> -0.572453).  Saving model ...
Epoch: 12 cost time: 1.6137349605560303
Epoch: 12, Steps: 9 | Train Loss: 0.310 Vali Loss: 1.045 Vali Acc: 0.558 Test Loss: 1.045 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9203667640686035
Epoch: 13, Steps: 9 | Train Loss: 0.282 Vali Loss: 1.047 Vali Acc: 0.565 Test Loss: 1.047 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5273523330688477
Epoch: 14, Steps: 9 | Train Loss: 0.242 Vali Loss: 1.044 Vali Acc: 0.572 Test Loss: 1.044 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 15 cost time: 2.039658308029175
Epoch: 15, Steps: 9 | Train Loss: 0.218 Vali Loss: 1.101 Vali Acc: 0.529 Test Loss: 1.101 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6895372867584229
Epoch: 16, Steps: 9 | Train Loss: 0.182 Vali Loss: 1.037 Vali Acc: 0.551 Test Loss: 1.037 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6654443740844727
Epoch: 17, Steps: 9 | Train Loss: 0.164 Vali Loss: 1.056 Vali Acc: 0.572 Test Loss: 1.056 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5376982688903809
Epoch: 18, Steps: 9 | Train Loss: 0.125 Vali Loss: 1.065 Vali Acc: 0.580 Test Loss: 1.065 Test Acc: 0.580
Validation loss decreased (-0.572453 --> -0.579699).  Saving model ...
Epoch: 19 cost time: 1.7978777885437012
Epoch: 19, Steps: 9 | Train Loss: 0.111 Vali Loss: 1.093 Vali Acc: 0.565 Test Loss: 1.093 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4917323589324951
Epoch: 20, Steps: 9 | Train Loss: 0.091 Vali Loss: 1.092 Vali Acc: 0.543 Test Loss: 1.092 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9169368743896484
Epoch: 21, Steps: 9 | Train Loss: 0.071 Vali Loss: 1.097 Vali Acc: 0.580 Test Loss: 1.097 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8539791107177734
Epoch: 22, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.096 Vali Acc: 0.558 Test Loss: 1.096 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.60404634475708
Epoch: 23, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.109 Vali Acc: 0.558 Test Loss: 1.109 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4158873558044434
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 1.129 Vali Acc: 0.580 Test Loss: 1.129 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5653600692749023
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.125 Vali Acc: 0.580 Test Loss: 1.125 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2562010288238525
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.120 Vali Acc: 0.587 Test Loss: 1.120 Test Acc: 0.587
Validation loss decreased (-0.579699 --> -0.586945).  Saving model ...
Epoch: 27 cost time: 1.5577943325042725
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.121 Vali Acc: 0.587 Test Loss: 1.121 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3472421169281006
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.167 Vali Acc: 0.580 Test Loss: 1.167 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8518192768096924
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.157 Vali Acc: 0.587 Test Loss: 1.157 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8136403560638428
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.155 Vali Acc: 0.601 Test Loss: 1.155 Test Acc: 0.601
Validation loss decreased (-0.586945 --> -0.601438).  Saving model ...
Epoch: 31 cost time: 1.5982348918914795
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.163 Vali Acc: 0.609 Test Loss: 1.163 Test Acc: 0.609
Validation loss decreased (-0.601438 --> -0.608684).  Saving model ...
Epoch: 32 cost time: 1.5135364532470703
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.167 Vali Acc: 0.594 Test Loss: 1.167 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7011511325836182
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.162 Vali Acc: 0.594 Test Loss: 1.162 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9080801010131836
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.163 Vali Acc: 0.601 Test Loss: 1.163 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.641035795211792
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.172 Vali Acc: 0.594 Test Loss: 1.172 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9169342517852783
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.187 Vali Acc: 0.587 Test Loss: 1.187 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9609918594360352
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.175 Vali Acc: 0.587 Test Loss: 1.175 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7721951007843018
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.174 Vali Acc: 0.572 Test Loss: 1.174 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7021045684814453
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.181 Vali Acc: 0.565 Test Loss: 1.181 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.7460885047912598
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.178 Vali Acc: 0.565 Test Loss: 1.178 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7599000930786133
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.167 Vali Acc: 0.572 Test Loss: 1.167 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6086956521739131
model parameter : 889690
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.148810625076294
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.398 Vali Acc: 0.239 Test Loss: 1.398 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.4649722576141357
Epoch: 2, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.301 Vali Acc: 0.377 Test Loss: 1.301 Test Acc: 0.377
Validation loss decreased (-0.239116 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 1.5096516609191895
Epoch: 3, Steps: 9 | Train Loss: 1.001 Vali Loss: 1.226 Vali Acc: 0.464 Test Loss: 1.226 Test Acc: 0.464
Validation loss decreased (-0.376799 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 1.4536247253417969
Epoch: 4, Steps: 9 | Train Loss: 0.849 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
Validation loss decreased (-0.463756 --> -0.514481).  Saving model ...
Epoch: 5 cost time: 1.3281757831573486
Epoch: 5, Steps: 9 | Train Loss: 0.700 Vali Loss: 1.139 Vali Acc: 0.536 Test Loss: 1.139 Test Acc: 0.536
Validation loss decreased (-0.514481 --> -0.536220).  Saving model ...
Epoch: 6 cost time: 1.4199767112731934
Epoch: 6, Steps: 9 | Train Loss: 0.618 Vali Loss: 1.114 Vali Acc: 0.522 Test Loss: 1.114 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5125999450683594
Epoch: 7, Steps: 9 | Train Loss: 0.550 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1304404735565186
Epoch: 8, Steps: 9 | Train Loss: 0.461 Vali Loss: 1.163 Vali Acc: 0.493 Test Loss: 1.163 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2825756072998047
Epoch: 9, Steps: 9 | Train Loss: 0.416 Vali Loss: 1.123 Vali Acc: 0.536 Test Loss: 1.123 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536221).  Saving model ...
Epoch: 10 cost time: 1.1719224452972412
Epoch: 10, Steps: 9 | Train Loss: 0.367 Vali Loss: 1.093 Vali Acc: 0.558 Test Loss: 1.093 Test Acc: 0.558
Validation loss decreased (-0.536221 --> -0.557960).  Saving model ...
Epoch: 11 cost time: 1.2817246913909912
Epoch: 11, Steps: 9 | Train Loss: 0.322 Vali Loss: 1.102 Vali Acc: 0.551 Test Loss: 1.102 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5652899742126465
Epoch: 12, Steps: 9 | Train Loss: 0.265 Vali Loss: 1.089 Vali Acc: 0.536 Test Loss: 1.089 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4784126281738281
Epoch: 13, Steps: 9 | Train Loss: 0.223 Vali Loss: 1.083 Vali Acc: 0.529 Test Loss: 1.083 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2858426570892334
Epoch: 14, Steps: 9 | Train Loss: 0.176 Vali Loss: 1.055 Vali Acc: 0.543 Test Loss: 1.055 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2897062301635742
Epoch: 15, Steps: 9 | Train Loss: 0.158 Vali Loss: 1.072 Vali Acc: 0.551 Test Loss: 1.072 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.252171277999878
Epoch: 16, Steps: 9 | Train Loss: 0.136 Vali Loss: 1.088 Vali Acc: 0.543 Test Loss: 1.088 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.183150053024292
Epoch: 17, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.064 Vali Acc: 0.558 Test Loss: 1.064 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 18 cost time: 1.1090328693389893
Epoch: 18, Steps: 9 | Train Loss: 0.099 Vali Loss: 1.116 Vali Acc: 0.507 Test Loss: 1.116 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2688283920288086
Epoch: 19, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.048 Vali Acc: 0.558 Test Loss: 1.048 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557961).  Saving model ...
Epoch: 20 cost time: 1.1716389656066895
Epoch: 20, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.102 Vali Acc: 0.551 Test Loss: 1.102 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1845715045928955
Epoch: 21, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.120 Vali Acc: 0.551 Test Loss: 1.120 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2998464107513428
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.112 Vali Acc: 0.536 Test Loss: 1.112 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2617082595825195
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2342183589935303
Epoch: 24, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.148 Vali Acc: 0.522 Test Loss: 1.148 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4637947082519531
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.163 Vali Acc: 0.529 Test Loss: 1.163 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5463814735412598
Epoch: 26, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.180 Vali Acc: 0.536 Test Loss: 1.180 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.193540096282959
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.160 Vali Acc: 0.536 Test Loss: 1.160 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.268770456314087
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.134 Vali Acc: 0.543 Test Loss: 1.134 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3410968780517578
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.154 Vali Acc: 0.529 Test Loss: 1.154 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5579710144927537
model parameter : 879450
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.854519844055176
Epoch: 1, Steps: 9 | Train Loss: 1.480 Vali Loss: 1.415 Vali Acc: 0.246 Test Loss: 1.415 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.3799307346343994
Epoch: 2, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.309 Vali Acc: 0.370 Test Loss: 1.309 Test Acc: 0.370
Validation loss decreased (-0.246363 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 1.1257498264312744
Epoch: 3, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.232 Vali Acc: 0.428 Test Loss: 1.232 Test Acc: 0.428
Validation loss decreased (-0.369552 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 1.2132673263549805
Epoch: 4, Steps: 9 | Train Loss: 0.829 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
Validation loss decreased (-0.427524 --> -0.492742).  Saving model ...
Epoch: 5 cost time: 1.357682704925537
Epoch: 5, Steps: 9 | Train Loss: 0.705 Vali Loss: 1.138 Vali Acc: 0.543 Test Loss: 1.138 Test Acc: 0.543
Validation loss decreased (-0.492742 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 1.3284752368927002
Epoch: 6, Steps: 9 | Train Loss: 0.570 Vali Loss: 1.145 Vali Acc: 0.536 Test Loss: 1.145 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.587311029434204
Epoch: 7, Steps: 9 | Train Loss: 0.484 Vali Loss: 1.128 Vali Acc: 0.551 Test Loss: 1.128 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550713).  Saving model ...
Epoch: 8 cost time: 1.5530633926391602
Epoch: 8, Steps: 9 | Train Loss: 0.421 Vali Loss: 1.083 Vali Acc: 0.558 Test Loss: 1.083 Test Acc: 0.558
Validation loss decreased (-0.550713 --> -0.557960).  Saving model ...
Epoch: 9 cost time: 1.2144839763641357
Epoch: 9, Steps: 9 | Train Loss: 0.363 Vali Loss: 1.108 Vali Acc: 0.558 Test Loss: 1.108 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2114722728729248
Epoch: 10, Steps: 9 | Train Loss: 0.323 Vali Loss: 1.091 Vali Acc: 0.543 Test Loss: 1.091 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5037744045257568
Epoch: 11, Steps: 9 | Train Loss: 0.267 Vali Loss: 1.106 Vali Acc: 0.543 Test Loss: 1.106 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4831993579864502
Epoch: 12, Steps: 9 | Train Loss: 0.217 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.557960 --> -0.572453).  Saving model ...
Epoch: 13 cost time: 1.4087445735931396
Epoch: 13, Steps: 9 | Train Loss: 0.180 Vali Loss: 1.122 Vali Acc: 0.522 Test Loss: 1.122 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4615061283111572
Epoch: 14, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.104 Vali Acc: 0.558 Test Loss: 1.104 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.60160231590271
Epoch: 15, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.114 Vali Acc: 0.529 Test Loss: 1.114 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4749963283538818
Epoch: 16, Steps: 9 | Train Loss: 0.087 Vali Loss: 1.077 Vali Acc: 0.572 Test Loss: 1.077 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 17 cost time: 0.9061222076416016
Epoch: 17, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.054 Vali Acc: 0.572 Test Loss: 1.054 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 18 cost time: 1.2332322597503662
Epoch: 18, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.044 Vali Acc: 0.594 Test Loss: 1.044 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594192).  Saving model ...
Epoch: 19 cost time: 1.016615629196167
Epoch: 19, Steps: 9 | Train Loss: 0.041 Vali Loss: 1.114 Vali Acc: 0.543 Test Loss: 1.114 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2907850742340088
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.089 Vali Acc: 0.558 Test Loss: 1.089 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0811359882354736
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.084 Vali Acc: 0.565 Test Loss: 1.084 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9259514808654785
Epoch: 22, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.109 Vali Acc: 0.551 Test Loss: 1.109 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4585304260253906
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.087 Vali Acc: 0.551 Test Loss: 1.087 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6332335472106934
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.088 Vali Acc: 0.543 Test Loss: 1.088 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3967702388763428
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.109 Vali Acc: 0.543 Test Loss: 1.109 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1569247245788574
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.116 Vali Acc: 0.543 Test Loss: 1.116 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.295375108718872
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.101 Vali Acc: 0.551 Test Loss: 1.101 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3248517513275146
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.118 Vali Acc: 0.536 Test Loss: 1.118 Test Acc: 0.536
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 869210
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.905358076095581
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.339 Vali Acc: 0.326 Test Loss: 1.339 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 0.9174380302429199
Epoch: 2, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.273 Vali Acc: 0.391 Test Loss: 1.273 Test Acc: 0.391
Validation loss decreased (-0.326074 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 0.9739155769348145
Epoch: 3, Steps: 9 | Train Loss: 0.953 Vali Loss: 1.209 Vali Acc: 0.399 Test Loss: 1.209 Test Acc: 0.399
Validation loss decreased (-0.391292 --> -0.398539).  Saving model ...
Epoch: 4 cost time: 1.0036664009094238
Epoch: 4, Steps: 9 | Train Loss: 0.785 Vali Loss: 1.179 Vali Acc: 0.464 Test Loss: 1.179 Test Acc: 0.464
Validation loss decreased (-0.398539 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 1.5164506435394287
Epoch: 5, Steps: 9 | Train Loss: 0.636 Vali Loss: 1.120 Vali Acc: 0.493 Test Loss: 1.120 Test Acc: 0.493
Validation loss decreased (-0.463756 --> -0.492742).  Saving model ...
Epoch: 6 cost time: 1.0488340854644775
Epoch: 6, Steps: 9 | Train Loss: 0.520 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
Validation loss decreased (-0.492742 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.1055974960327148
Epoch: 7, Steps: 9 | Train Loss: 0.441 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.2063755989074707
Epoch: 8, Steps: 9 | Train Loss: 0.353 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.514482).  Saving model ...
Epoch: 9 cost time: 1.040097951889038
Epoch: 9, Steps: 9 | Train Loss: 0.303 Vali Loss: 1.072 Vali Acc: 0.543 Test Loss: 1.072 Test Acc: 0.543
Validation loss decreased (-0.514482 --> -0.543468).  Saving model ...
Epoch: 10 cost time: 1.4715704917907715
Epoch: 10, Steps: 9 | Train Loss: 0.238 Vali Loss: 1.127 Vali Acc: 0.493 Test Loss: 1.127 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3004179000854492
Epoch: 11, Steps: 9 | Train Loss: 0.194 Vali Loss: 1.112 Vali Acc: 0.551 Test Loss: 1.112 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550714).  Saving model ...
Epoch: 12 cost time: 1.1410019397735596
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 1.133 Vali Acc: 0.522 Test Loss: 1.133 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1392509937286377
Epoch: 13, Steps: 9 | Train Loss: 0.121 Vali Loss: 1.100 Vali Acc: 0.558 Test Loss: 1.100 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557960).  Saving model ...
Epoch: 14 cost time: 1.1050193309783936
Epoch: 14, Steps: 9 | Train Loss: 0.089 Vali Loss: 1.110 Vali Acc: 0.529 Test Loss: 1.110 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9787554740905762
Epoch: 15, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.084 Vali Acc: 0.536 Test Loss: 1.084 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.136878252029419
Epoch: 16, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.085 Vali Acc: 0.551 Test Loss: 1.085 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1994678974151611
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.135 Vali Acc: 0.543 Test Loss: 1.135 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1439898014068604
Epoch: 18, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.150 Vali Acc: 0.543 Test Loss: 1.150 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1149694919586182
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.134 Vali Acc: 0.572 Test Loss: 1.134 Test Acc: 0.572
Validation loss decreased (-0.557960 --> -0.572452).  Saving model ...
Epoch: 20 cost time: 0.928084135055542
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.150 Vali Acc: 0.551 Test Loss: 1.150 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.293041467666626
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.185 Vali Acc: 0.536 Test Loss: 1.185 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9668540954589844
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.211 Vali Acc: 0.529 Test Loss: 1.211 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2422168254852295
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.203 Vali Acc: 0.543 Test Loss: 1.203 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0626542568206787
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.213 Vali Acc: 0.536 Test Loss: 1.213 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1216447353363037
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.212 Vali Acc: 0.543 Test Loss: 1.212 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2410545349121094
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.210 Vali Acc: 0.522 Test Loss: 1.210 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0751497745513916
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.224 Vali Acc: 0.522 Test Loss: 1.224 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9681484699249268
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.217 Vali Acc: 0.536 Test Loss: 1.217 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0226683616638184
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.218 Vali Acc: 0.536 Test Loss: 1.218 Test Acc: 0.536
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 861018
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6671302318573
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.336 Vali Acc: 0.333 Test Loss: 1.336 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.8726673126220703
Epoch: 2, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.239 Vali Acc: 0.413 Test Loss: 1.239 Test Acc: 0.413
Validation loss decreased (-0.333320 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 0.9043076038360596
Epoch: 3, Steps: 9 | Train Loss: 0.915 Vali Loss: 1.175 Vali Acc: 0.457 Test Loss: 1.175 Test Acc: 0.457
Validation loss decreased (-0.413031 --> -0.456510).  Saving model ...
Epoch: 4 cost time: 0.9077053070068359
Epoch: 4, Steps: 9 | Train Loss: 0.729 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
Validation loss decreased (-0.456510 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 0.9068446159362793
Epoch: 5, Steps: 9 | Train Loss: 0.593 Vali Loss: 1.116 Vali Acc: 0.522 Test Loss: 1.116 Test Acc: 0.522
Validation loss decreased (-0.499989 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 0.8818655014038086
Epoch: 6, Steps: 9 | Train Loss: 0.505 Vali Loss: 1.101 Vali Acc: 0.529 Test Loss: 1.101 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528974).  Saving model ...
Epoch: 7 cost time: 0.9058780670166016
Epoch: 7, Steps: 9 | Train Loss: 0.433 Vali Loss: 1.074 Vali Acc: 0.536 Test Loss: 1.074 Test Acc: 0.536
Validation loss decreased (-0.528974 --> -0.536221).  Saving model ...
Epoch: 8 cost time: 0.8902163505554199
Epoch: 8, Steps: 9 | Train Loss: 0.347 Vali Loss: 1.037 Vali Acc: 0.565 Test Loss: 1.037 Test Acc: 0.565
Validation loss decreased (-0.536221 --> -0.565207).  Saving model ...
Epoch: 9 cost time: 0.888674259185791
Epoch: 9, Steps: 9 | Train Loss: 0.278 Vali Loss: 1.037 Vali Acc: 0.565 Test Loss: 1.037 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565207).  Saving model ...
Epoch: 10 cost time: 1.0021049976348877
Epoch: 10, Steps: 9 | Train Loss: 0.216 Vali Loss: 1.038 Vali Acc: 0.543 Test Loss: 1.038 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7058465480804443
Epoch: 11, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.049 Vali Acc: 0.551 Test Loss: 1.049 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8185329437255859
Epoch: 12, Steps: 9 | Train Loss: 0.130 Vali Loss: 1.021 Vali Acc: 0.587 Test Loss: 1.021 Test Acc: 0.587
Validation loss decreased (-0.565207 --> -0.586946).  Saving model ...
Epoch: 13 cost time: 0.7463572025299072
Epoch: 13, Steps: 9 | Train Loss: 0.099 Vali Loss: 1.063 Vali Acc: 0.558 Test Loss: 1.063 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9504406452178955
Epoch: 14, Steps: 9 | Train Loss: 0.078 Vali Loss: 1.084 Vali Acc: 0.558 Test Loss: 1.084 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9037628173828125
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.058 Vali Acc: 0.536 Test Loss: 1.058 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.090360403060913
Epoch: 16, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.126 Vali Acc: 0.536 Test Loss: 1.126 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8639581203460693
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.142 Vali Acc: 0.529 Test Loss: 1.142 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8541514873504639
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.136 Vali Acc: 0.529 Test Loss: 1.136 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.830310583114624
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.134 Vali Acc: 0.543 Test Loss: 1.134 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7891290187835693
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.129 Vali Acc: 0.536 Test Loss: 1.129 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8498506546020508
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.133 Vali Acc: 0.536 Test Loss: 1.133 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8199455738067627
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.136 Vali Acc: 0.543 Test Loss: 1.136 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5869565217391305
model parameter : 856922
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.589932918548584
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.374 Vali Acc: 0.261 Test Loss: 1.374 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.7484250068664551
Epoch: 2, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.280 Vali Acc: 0.326 Test Loss: 1.280 Test Acc: 0.326
Validation loss decreased (-0.260856 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 0.8031673431396484
Epoch: 3, Steps: 9 | Train Loss: 0.941 Vali Loss: 1.183 Vali Acc: 0.420 Test Loss: 1.183 Test Acc: 0.420
Validation loss decreased (-0.326074 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 0.7498652935028076
Epoch: 4, Steps: 9 | Train Loss: 0.782 Vali Loss: 1.128 Vali Acc: 0.529 Test Loss: 1.128 Test Acc: 0.529
Validation loss decreased (-0.420278 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 0.7305493354797363
Epoch: 5, Steps: 9 | Train Loss: 0.630 Vali Loss: 1.068 Vali Acc: 0.580 Test Loss: 1.068 Test Acc: 0.580
Validation loss decreased (-0.528974 --> -0.579699).  Saving model ...
Epoch: 6 cost time: 0.7456798553466797
Epoch: 6, Steps: 9 | Train Loss: 0.526 Vali Loss: 1.056 Vali Acc: 0.594 Test Loss: 1.056 Test Acc: 0.594
Validation loss decreased (-0.579699 --> -0.594192).  Saving model ...
Epoch: 7 cost time: 0.689138650894165
Epoch: 7, Steps: 9 | Train Loss: 0.416 Vali Loss: 1.037 Vali Acc: 0.594 Test Loss: 1.037 Test Acc: 0.594
Validation loss decreased (-0.594192 --> -0.594193).  Saving model ...
Epoch: 8 cost time: 0.6735177040100098
Epoch: 8, Steps: 9 | Train Loss: 0.329 Vali Loss: 1.011 Vali Acc: 0.601 Test Loss: 1.011 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601439).  Saving model ...
Epoch: 9 cost time: 0.7121825218200684
Epoch: 9, Steps: 9 | Train Loss: 0.253 Vali Loss: 1.007 Vali Acc: 0.594 Test Loss: 1.007 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.019927740097046
Epoch: 10, Steps: 9 | Train Loss: 0.197 Vali Loss: 1.018 Vali Acc: 0.565 Test Loss: 1.018 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.114198923110962
Epoch: 11, Steps: 9 | Train Loss: 0.143 Vali Loss: 1.010 Vali Acc: 0.551 Test Loss: 1.010 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8060030937194824
Epoch: 12, Steps: 9 | Train Loss: 0.103 Vali Loss: 1.037 Vali Acc: 0.558 Test Loss: 1.037 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8023529052734375
Epoch: 13, Steps: 9 | Train Loss: 0.075 Vali Loss: 1.032 Vali Acc: 0.580 Test Loss: 1.032 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7774503231048584
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.023 Vali Acc: 0.587 Test Loss: 1.023 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9526503086090088
Epoch: 15, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.079 Vali Acc: 0.572 Test Loss: 1.079 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8632569313049316
Epoch: 16, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.028 Vali Acc: 0.587 Test Loss: 1.028 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7314271926879883
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.042 Vali Acc: 0.594 Test Loss: 1.042 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8127789497375488
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.047 Vali Acc: 0.601 Test Loss: 1.047 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6014492753623188
model parameter : 852826
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.717418909072876
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.416 Vali Acc: 0.246 Test Loss: 1.416 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.6780369281768799
Epoch: 2, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.291 Vali Acc: 0.391 Test Loss: 1.291 Test Acc: 0.391
Validation loss decreased (-0.246363 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 0.7377190589904785
Epoch: 3, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.211 Vali Acc: 0.449 Test Loss: 1.211 Test Acc: 0.449
Validation loss decreased (-0.391291 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.7870185375213623
Epoch: 4, Steps: 9 | Train Loss: 0.736 Vali Loss: 1.185 Vali Acc: 0.471 Test Loss: 1.185 Test Acc: 0.471
Validation loss decreased (-0.449263 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 0.7259500026702881
Epoch: 5, Steps: 9 | Train Loss: 0.585 Vali Loss: 1.134 Vali Acc: 0.536 Test Loss: 1.134 Test Acc: 0.536
Validation loss decreased (-0.471003 --> -0.536221).  Saving model ...
Epoch: 6 cost time: 0.7301914691925049
Epoch: 6, Steps: 9 | Train Loss: 0.444 Vali Loss: 1.084 Vali Acc: 0.558 Test Loss: 1.084 Test Acc: 0.558
Validation loss decreased (-0.536221 --> -0.557960).  Saving model ...
Epoch: 7 cost time: 0.7951490879058838
Epoch: 7, Steps: 9 | Train Loss: 0.333 Vali Loss: 1.071 Vali Acc: 0.551 Test Loss: 1.071 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.712738037109375
Epoch: 8, Steps: 9 | Train Loss: 0.251 Vali Loss: 1.059 Vali Acc: 0.572 Test Loss: 1.059 Test Acc: 0.572
Validation loss decreased (-0.557960 --> -0.572453).  Saving model ...
Epoch: 9 cost time: 0.8674740791320801
Epoch: 9, Steps: 9 | Train Loss: 0.194 Vali Loss: 1.071 Vali Acc: 0.580 Test Loss: 1.071 Test Acc: 0.580
Validation loss decreased (-0.572453 --> -0.579699).  Saving model ...
Epoch: 10 cost time: 0.7482316493988037
Epoch: 10, Steps: 9 | Train Loss: 0.140 Vali Loss: 1.122 Vali Acc: 0.529 Test Loss: 1.122 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6948282718658447
Epoch: 11, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.138 Vali Acc: 0.551 Test Loss: 1.138 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.731696605682373
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 1.114 Vali Acc: 0.572 Test Loss: 1.114 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9312441349029541
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.123 Vali Acc: 0.558 Test Loss: 1.123 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8356525897979736
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.179 Vali Acc: 0.551 Test Loss: 1.179 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8247132301330566
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.170 Vali Acc: 0.543 Test Loss: 1.170 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6528031826019287
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.185 Vali Acc: 0.536 Test Loss: 1.185 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7558526992797852
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.179 Vali Acc: 0.551 Test Loss: 1.179 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7279157638549805
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.213 Vali Acc: 0.529 Test Loss: 1.213 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.681361198425293
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.231 Vali Acc: 0.507 Test Loss: 1.231 Test Acc: 0.507
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 848730
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.100200414657593
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.386 Vali Acc: 0.355 Test Loss: 1.386 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.930551528930664
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.349 Vali Acc: 0.355 Test Loss: 1.349 Test Acc: 0.355
Validation loss decreased (-0.355059 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 2.0229766368865967
Epoch: 3, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.304 Vali Acc: 0.391 Test Loss: 1.304 Test Acc: 0.391
Validation loss decreased (-0.355059 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 2.292907953262329
Epoch: 4, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.262 Vali Acc: 0.406 Test Loss: 1.262 Test Acc: 0.406
Validation loss decreased (-0.391291 --> -0.405784).  Saving model ...
Epoch: 5 cost time: 2.2035648822784424
Epoch: 5, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.223 Vali Acc: 0.435 Test Loss: 1.223 Test Acc: 0.435
Validation loss decreased (-0.405784 --> -0.434770).  Saving model ...
Epoch: 6 cost time: 1.9489538669586182
Epoch: 6, Steps: 9 | Train Loss: 0.973 Vali Loss: 1.193 Vali Acc: 0.478 Test Loss: 1.193 Test Acc: 0.478
Validation loss decreased (-0.434770 --> -0.478249).  Saving model ...
Epoch: 7 cost time: 1.902543544769287
Epoch: 7, Steps: 9 | Train Loss: 0.879 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
Validation loss decreased (-0.478249 --> -0.514481).  Saving model ...
Epoch: 8 cost time: 1.896106243133545
Epoch: 8, Steps: 9 | Train Loss: 0.811 Vali Loss: 1.130 Vali Acc: 0.551 Test Loss: 1.130 Test Acc: 0.551
Validation loss decreased (-0.514481 --> -0.550713).  Saving model ...
Epoch: 9 cost time: 1.5913076400756836
Epoch: 9, Steps: 9 | Train Loss: 0.748 Vali Loss: 1.106 Vali Acc: 0.558 Test Loss: 1.106 Test Acc: 0.558
Validation loss decreased (-0.550713 --> -0.557960).  Saving model ...
Epoch: 10 cost time: 2.08541202545166
Epoch: 10, Steps: 9 | Train Loss: 0.699 Vali Loss: 1.090 Vali Acc: 0.558 Test Loss: 1.090 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 11 cost time: 1.9777555465698242
Epoch: 11, Steps: 9 | Train Loss: 0.640 Vali Loss: 1.076 Vali Acc: 0.529 Test Loss: 1.076 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1384851932525635
Epoch: 12, Steps: 9 | Train Loss: 0.582 Vali Loss: 1.063 Vali Acc: 0.522 Test Loss: 1.063 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6243243217468262
Epoch: 13, Steps: 9 | Train Loss: 0.527 Vali Loss: 1.048 Vali Acc: 0.536 Test Loss: 1.048 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.82611083984375
Epoch: 14, Steps: 9 | Train Loss: 0.487 Vali Loss: 1.028 Vali Acc: 0.536 Test Loss: 1.028 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.100581169128418
Epoch: 15, Steps: 9 | Train Loss: 0.440 Vali Loss: 1.025 Vali Acc: 0.529 Test Loss: 1.025 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6974470615386963
Epoch: 16, Steps: 9 | Train Loss: 0.407 Vali Loss: 1.008 Vali Acc: 0.551 Test Loss: 1.008 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.239560604095459
Epoch: 17, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.999 Vali Acc: 0.543 Test Loss: 0.999 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0807135105133057
Epoch: 18, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.988 Vali Acc: 0.558 Test Loss: 0.988 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557961).  Saving model ...
Epoch: 19 cost time: 1.9472332000732422
Epoch: 19, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.980 Vali Acc: 0.565 Test Loss: 0.980 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565208).  Saving model ...
Epoch: 20 cost time: 2.307400941848755
Epoch: 20, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.968 Vali Acc: 0.572 Test Loss: 0.968 Test Acc: 0.572
Validation loss decreased (-0.565208 --> -0.572454).  Saving model ...
Epoch: 21 cost time: 2.919736623764038
Epoch: 21, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.967 Vali Acc: 0.572 Test Loss: 0.967 Test Acc: 0.572
Validation loss decreased (-0.572454 --> -0.572454).  Saving model ...
Epoch: 22 cost time: 2.108079195022583
Epoch: 22, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.963 Vali Acc: 0.558 Test Loss: 0.963 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.175204277038574
Epoch: 23, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.953 Vali Acc: 0.558 Test Loss: 0.953 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9715826511383057
Epoch: 24, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.947 Vali Acc: 0.558 Test Loss: 0.947 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1914255619049072
Epoch: 25, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.943 Vali Acc: 0.594 Test Loss: 0.943 Test Acc: 0.594
Validation loss decreased (-0.572454 --> -0.594193).  Saving model ...
Epoch: 26 cost time: 2.5208606719970703
Epoch: 26, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.952 Vali Acc: 0.587 Test Loss: 0.952 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.126430034637451
Epoch: 27, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.944 Vali Acc: 0.594 Test Loss: 0.944 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.215341806411743
Epoch: 28, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.935 Vali Acc: 0.609 Test Loss: 0.935 Test Acc: 0.609
Validation loss decreased (-0.594193 --> -0.608686).  Saving model ...
Epoch: 29 cost time: 2.0461442470550537
Epoch: 29, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.939 Vali Acc: 0.601 Test Loss: 0.939 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.077495813369751
Epoch: 30, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.942 Vali Acc: 0.601 Test Loss: 0.942 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.926880121231079
Epoch: 31, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.944 Vali Acc: 0.587 Test Loss: 0.944 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9877560138702393
Epoch: 32, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.950 Vali Acc: 0.565 Test Loss: 0.950 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.4460129737854004
Epoch: 33, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.950 Vali Acc: 0.587 Test Loss: 0.950 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.400759220123291
Epoch: 34, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.955 Vali Acc: 0.587 Test Loss: 0.955 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.409442186355591
Epoch: 35, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.965 Vali Acc: 0.572 Test Loss: 0.965 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.464574098587036
Epoch: 36, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.963 Vali Acc: 0.587 Test Loss: 0.963 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.0372579097747803
Epoch: 37, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.962 Vali Acc: 0.587 Test Loss: 0.962 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.210601806640625
Epoch: 38, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.959 Vali Acc: 0.580 Test Loss: 0.959 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6086956521739131
model parameter : 451452
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.089959383010864
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.435 Vali Acc: 0.246 Test Loss: 1.435 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 2.3385207653045654
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.401 Vali Acc: 0.246 Test Loss: 1.401 Test Acc: 0.246
Validation loss decreased (-0.246362 --> -0.246363).  Saving model ...
Epoch: 3 cost time: 2.1225955486297607
Epoch: 3, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.363 Vali Acc: 0.283 Test Loss: 1.363 Test Acc: 0.283
Validation loss decreased (-0.246363 --> -0.282595).  Saving model ...
Epoch: 4 cost time: 1.7199337482452393
Epoch: 4, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.327 Vali Acc: 0.283 Test Loss: 1.327 Test Acc: 0.283
Validation loss decreased (-0.282595 --> -0.282595).  Saving model ...
Epoch: 5 cost time: 2.052402973175049
Epoch: 5, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
Validation loss decreased (-0.282595 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 2.2476608753204346
Epoch: 6, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.286 Vali Acc: 0.384 Test Loss: 1.286 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384045).  Saving model ...
Epoch: 7 cost time: 1.7918758392333984
Epoch: 7, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.272 Vali Acc: 0.413 Test Loss: 1.272 Test Acc: 0.413
Validation loss decreased (-0.384045 --> -0.413031).  Saving model ...
Epoch: 8 cost time: 2.014299154281616
Epoch: 8, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.264 Vali Acc: 0.428 Test Loss: 1.264 Test Acc: 0.428
Validation loss decreased (-0.413031 --> -0.427524).  Saving model ...
Epoch: 9 cost time: 1.9875924587249756
Epoch: 9, Steps: 9 | Train Loss: 0.907 Vali Loss: 1.256 Vali Acc: 0.428 Test Loss: 1.256 Test Acc: 0.428
Validation loss decreased (-0.427524 --> -0.427524).  Saving model ...
Epoch: 10 cost time: 1.9746756553649902
Epoch: 10, Steps: 9 | Train Loss: 0.863 Vali Loss: 1.246 Vali Acc: 0.442 Test Loss: 1.246 Test Acc: 0.442
Validation loss decreased (-0.427524 --> -0.442017).  Saving model ...
Epoch: 11 cost time: 1.933241844177246
Epoch: 11, Steps: 9 | Train Loss: 0.802 Vali Loss: 1.236 Vali Acc: 0.435 Test Loss: 1.236 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6480398178100586
Epoch: 12, Steps: 9 | Train Loss: 0.753 Vali Loss: 1.224 Vali Acc: 0.471 Test Loss: 1.224 Test Acc: 0.471
Validation loss decreased (-0.442017 --> -0.471002).  Saving model ...
Epoch: 13 cost time: 1.8560354709625244
Epoch: 13, Steps: 9 | Train Loss: 0.714 Vali Loss: 1.216 Vali Acc: 0.464 Test Loss: 1.216 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8112409114837646
Epoch: 14, Steps: 9 | Train Loss: 0.664 Vali Loss: 1.215 Vali Acc: 0.435 Test Loss: 1.215 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7858684062957764
Epoch: 15, Steps: 9 | Train Loss: 0.640 Vali Loss: 1.205 Vali Acc: 0.449 Test Loss: 1.205 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5495452880859375
Epoch: 16, Steps: 9 | Train Loss: 0.578 Vali Loss: 1.201 Vali Acc: 0.435 Test Loss: 1.201 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9347784519195557
Epoch: 17, Steps: 9 | Train Loss: 0.532 Vali Loss: 1.195 Vali Acc: 0.420 Test Loss: 1.195 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6821491718292236
Epoch: 18, Steps: 9 | Train Loss: 0.496 Vali Loss: 1.182 Vali Acc: 0.428 Test Loss: 1.182 Test Acc: 0.428
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5386285781860352
Epoch: 19, Steps: 9 | Train Loss: 0.466 Vali Loss: 1.173 Vali Acc: 0.435 Test Loss: 1.173 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.942086935043335
Epoch: 20, Steps: 9 | Train Loss: 0.414 Vali Loss: 1.168 Vali Acc: 0.413 Test Loss: 1.168 Test Acc: 0.413
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7677719593048096
Epoch: 21, Steps: 9 | Train Loss: 0.391 Vali Loss: 1.168 Vali Acc: 0.442 Test Loss: 1.168 Test Acc: 0.442
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.021225929260254
Epoch: 22, Steps: 9 | Train Loss: 0.365 Vali Loss: 1.158 Vali Acc: 0.471 Test Loss: 1.158 Test Acc: 0.471
Validation loss decreased (-0.471002 --> -0.471003).  Saving model ...
Epoch: 23 cost time: 1.5936682224273682
Epoch: 23, Steps: 9 | Train Loss: 0.331 Vali Loss: 1.167 Vali Acc: 0.449 Test Loss: 1.167 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8982465267181396
Epoch: 24, Steps: 9 | Train Loss: 0.294 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.471003 --> -0.499989).  Saving model ...
Epoch: 25 cost time: 1.7166290283203125
Epoch: 25, Steps: 9 | Train Loss: 0.266 Vali Loss: 1.142 Vali Acc: 0.522 Test Loss: 1.142 Test Acc: 0.522
Validation loss decreased (-0.499989 --> -0.521728).  Saving model ...
Epoch: 26 cost time: 1.7477221488952637
Epoch: 26, Steps: 9 | Train Loss: 0.236 Vali Loss: 1.130 Vali Acc: 0.522 Test Loss: 1.130 Test Acc: 0.522
Validation loss decreased (-0.521728 --> -0.521728).  Saving model ...
Epoch: 27 cost time: 1.9293160438537598
Epoch: 27, Steps: 9 | Train Loss: 0.217 Vali Loss: 1.138 Vali Acc: 0.529 Test Loss: 1.138 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528974).  Saving model ...
Epoch: 28 cost time: 1.638303279876709
Epoch: 28, Steps: 9 | Train Loss: 0.189 Vali Loss: 1.138 Vali Acc: 0.529 Test Loss: 1.138 Test Acc: 0.529
Validation loss decreased (-0.528974 --> -0.528974).  Saving model ...
Epoch: 29 cost time: 2.559905529022217
Epoch: 29, Steps: 9 | Train Loss: 0.165 Vali Loss: 1.137 Vali Acc: 0.507 Test Loss: 1.137 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1497039794921875
Epoch: 30, Steps: 9 | Train Loss: 0.151 Vali Loss: 1.125 Vali Acc: 0.536 Test Loss: 1.125 Test Acc: 0.536
Validation loss decreased (-0.528974 --> -0.536221).  Saving model ...
Epoch: 31 cost time: 1.8139097690582275
Epoch: 31, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.128 Vali Acc: 0.529 Test Loss: 1.128 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.865180253982544
Epoch: 32, Steps: 9 | Train Loss: 0.125 Vali Loss: 1.122 Vali Acc: 0.536 Test Loss: 1.122 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536221).  Saving model ...
Epoch: 33 cost time: 2.0253305435180664
Epoch: 33, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.129 Vali Acc: 0.529 Test Loss: 1.129 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.077946901321411
Epoch: 34, Steps: 9 | Train Loss: 0.097 Vali Loss: 1.125 Vali Acc: 0.522 Test Loss: 1.125 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.078911542892456
Epoch: 35, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.120 Vali Acc: 0.551 Test Loss: 1.120 Test Acc: 0.551
Validation loss decreased (-0.536221 --> -0.550713).  Saving model ...
Epoch: 36 cost time: 2.1103403568267822
Epoch: 36, Steps: 9 | Train Loss: 0.071 Vali Loss: 1.114 Vali Acc: 0.551 Test Loss: 1.114 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550714).  Saving model ...
Epoch: 37 cost time: 1.9332959651947021
Epoch: 37, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.115 Vali Acc: 0.565 Test Loss: 1.115 Test Acc: 0.565
Validation loss decreased (-0.550714 --> -0.565206).  Saving model ...
Epoch: 38 cost time: 2.0651960372924805
Epoch: 38, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.114 Vali Acc: 0.558 Test Loss: 1.114 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2870194911956787
Epoch: 39, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.109 Vali Acc: 0.558 Test Loss: 1.109 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.876286268234253
Epoch: 40, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.114 Vali Acc: 0.565 Test Loss: 1.114 Test Acc: 0.565
Validation loss decreased (-0.565206 --> -0.565206).  Saving model ...
Epoch: 41 cost time: 1.908801555633545
Epoch: 41, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.123 Vali Acc: 0.565 Test Loss: 1.123 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.2146661281585693
Epoch: 42, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.126 Vali Acc: 0.565 Test Loss: 1.126 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.924232006072998
Epoch: 43, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.126 Vali Acc: 0.558 Test Loss: 1.126 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.8840558528900146
Epoch: 44, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.126 Vali Acc: 0.551 Test Loss: 1.126 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.137296199798584
Epoch: 45, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.119 Vali Acc: 0.558 Test Loss: 1.119 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.8825080394744873
Epoch: 46, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.115 Vali Acc: 0.572 Test Loss: 1.115 Test Acc: 0.572
Validation loss decreased (-0.565206 --> -0.572453).  Saving model ...
Epoch: 47 cost time: 1.6390516757965088
Epoch: 47, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.119 Vali Acc: 0.565 Test Loss: 1.119 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9462716579437256
Epoch: 48, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.120 Vali Acc: 0.580 Test Loss: 1.120 Test Acc: 0.580
Validation loss decreased (-0.572453 --> -0.579699).  Saving model ...
Epoch: 49 cost time: 1.6421899795532227
Epoch: 49, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.113 Vali Acc: 0.580 Test Loss: 1.113 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579699).  Saving model ...
Epoch: 50 cost time: 1.6816365718841553
Epoch: 50, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.110 Vali Acc: 0.580 Test Loss: 1.110 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579699).  Saving model ...
Epoch: 51 cost time: 1.5603017807006836
Epoch: 51, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.117 Vali Acc: 0.572 Test Loss: 1.117 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.9886932373046875
Epoch: 52, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.120 Vali Acc: 0.572 Test Loss: 1.120 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.5348529815673828
Epoch: 53, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.123 Vali Acc: 0.580 Test Loss: 1.123 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.268655776977539
Epoch: 54, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.123 Vali Acc: 0.572 Test Loss: 1.123 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.0543019771575928
Epoch: 55, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.124 Vali Acc: 0.572 Test Loss: 1.124 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.4146196842193604
Epoch: 56, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.124 Vali Acc: 0.572 Test Loss: 1.124 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.3878178596496582
Epoch: 57, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.120 Vali Acc: 0.580 Test Loss: 1.120 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.309920072555542
Epoch: 58, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.122 Vali Acc: 0.565 Test Loss: 1.122 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.7188646793365479
Epoch: 59, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.121 Vali Acc: 0.580 Test Loss: 1.121 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.128110647201538
Epoch: 60, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.128 Vali Acc: 0.572 Test Loss: 1.128 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 446332
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.157310962677002
Epoch: 1, Steps: 9 | Train Loss: 1.464 Vali Loss: 1.387 Vali Acc: 0.290 Test Loss: 1.387 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.6834754943847656
Epoch: 2, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.347 Vali Acc: 0.341 Test Loss: 1.347 Test Acc: 0.341
Validation loss decreased (-0.289841 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 1.5639684200286865
Epoch: 3, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.299 Vali Acc: 0.377 Test Loss: 1.299 Test Acc: 0.377
Validation loss decreased (-0.340566 --> -0.376799).  Saving model ...
Epoch: 4 cost time: 1.8176968097686768
Epoch: 4, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.262 Vali Acc: 0.413 Test Loss: 1.262 Test Acc: 0.413
Validation loss decreased (-0.376799 --> -0.413031).  Saving model ...
Epoch: 5 cost time: 2.0340352058410645
Epoch: 5, Steps: 9 | Train Loss: 1.133 Vali Loss: 1.235 Vali Acc: 0.420 Test Loss: 1.235 Test Acc: 0.420
Validation loss decreased (-0.413031 --> -0.420278).  Saving model ...
Epoch: 6 cost time: 1.67582368850708
Epoch: 6, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.210 Vali Acc: 0.413 Test Loss: 1.210 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.726175308227539
Epoch: 7, Steps: 9 | Train Loss: 1.008 Vali Loss: 1.202 Vali Acc: 0.399 Test Loss: 1.202 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.70924973487854
Epoch: 8, Steps: 9 | Train Loss: 0.939 Vali Loss: 1.172 Vali Acc: 0.478 Test Loss: 1.172 Test Acc: 0.478
Validation loss decreased (-0.420278 --> -0.478249).  Saving model ...
Epoch: 9 cost time: 1.6448662281036377
Epoch: 9, Steps: 9 | Train Loss: 0.864 Vali Loss: 1.159 Vali Acc: 0.442 Test Loss: 1.159 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.509359359741211
Epoch: 10, Steps: 9 | Train Loss: 0.819 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
Validation loss decreased (-0.478249 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 1.8100740909576416
Epoch: 11, Steps: 9 | Train Loss: 0.759 Vali Loss: 1.112 Vali Acc: 0.486 Test Loss: 1.112 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5506691932678223
Epoch: 12, Steps: 9 | Train Loss: 0.703 Vali Loss: 1.110 Vali Acc: 0.457 Test Loss: 1.110 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6046831607818604
Epoch: 13, Steps: 9 | Train Loss: 0.626 Vali Loss: 1.100 Vali Acc: 0.464 Test Loss: 1.100 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6507506370544434
Epoch: 14, Steps: 9 | Train Loss: 0.569 Vali Loss: 1.096 Vali Acc: 0.464 Test Loss: 1.096 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7738165855407715
Epoch: 15, Steps: 9 | Train Loss: 0.521 Vali Loss: 1.069 Vali Acc: 0.507 Test Loss: 1.069 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.507236).  Saving model ...
Epoch: 16 cost time: 1.4121029376983643
Epoch: 16, Steps: 9 | Train Loss: 0.477 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8841755390167236
Epoch: 17, Steps: 9 | Train Loss: 0.429 Vali Loss: 1.062 Vali Acc: 0.493 Test Loss: 1.062 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4788646697998047
Epoch: 18, Steps: 9 | Train Loss: 0.382 Vali Loss: 1.038 Vali Acc: 0.500 Test Loss: 1.038 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4891910552978516
Epoch: 19, Steps: 9 | Train Loss: 0.360 Vali Loss: 1.036 Vali Acc: 0.522 Test Loss: 1.036 Test Acc: 0.522
Validation loss decreased (-0.507236 --> -0.521729).  Saving model ...
Epoch: 20 cost time: 1.738443374633789
Epoch: 20, Steps: 9 | Train Loss: 0.307 Vali Loss: 1.041 Vali Acc: 0.536 Test Loss: 1.041 Test Acc: 0.536
Validation loss decreased (-0.521729 --> -0.536221).  Saving model ...
Epoch: 21 cost time: 1.8085696697235107
Epoch: 21, Steps: 9 | Train Loss: 0.294 Vali Loss: 1.026 Vali Acc: 0.522 Test Loss: 1.026 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8230042457580566
Epoch: 22, Steps: 9 | Train Loss: 0.256 Vali Loss: 1.024 Vali Acc: 0.536 Test Loss: 1.024 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536222).  Saving model ...
Epoch: 23 cost time: 1.7995131015777588
Epoch: 23, Steps: 9 | Train Loss: 0.239 Vali Loss: 1.025 Vali Acc: 0.536 Test Loss: 1.025 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9820730686187744
Epoch: 24, Steps: 9 | Train Loss: 0.211 Vali Loss: 1.043 Vali Acc: 0.529 Test Loss: 1.043 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9856059551239014
Epoch: 25, Steps: 9 | Train Loss: 0.188 Vali Loss: 1.024 Vali Acc: 0.529 Test Loss: 1.024 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7271533012390137
Epoch: 26, Steps: 9 | Train Loss: 0.167 Vali Loss: 1.012 Vali Acc: 0.551 Test Loss: 1.012 Test Acc: 0.551
Validation loss decreased (-0.536222 --> -0.550715).  Saving model ...
Epoch: 27 cost time: 1.7814891338348389
Epoch: 27, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.985 Vali Acc: 0.558 Test Loss: 0.985 Test Acc: 0.558
Validation loss decreased (-0.550715 --> -0.557961).  Saving model ...
Epoch: 28 cost time: 1.7633767127990723
Epoch: 28, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.991 Vali Acc: 0.565 Test Loss: 0.991 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565207).  Saving model ...
Epoch: 29 cost time: 2.083986282348633
Epoch: 29, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.004 Vali Acc: 0.572 Test Loss: 1.004 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572454).  Saving model ...
Epoch: 30 cost time: 1.5553486347198486
Epoch: 30, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.995 Vali Acc: 0.580 Test Loss: 0.995 Test Acc: 0.580
Validation loss decreased (-0.572454 --> -0.579700).  Saving model ...
Epoch: 31 cost time: 1.5791590213775635
Epoch: 31, Steps: 9 | Train Loss: 0.095 Vali Loss: 1.001 Vali Acc: 0.572 Test Loss: 1.001 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5653798580169678
Epoch: 32, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.011 Vali Acc: 0.558 Test Loss: 1.011 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6633009910583496
Epoch: 33, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.002 Vali Acc: 0.551 Test Loss: 1.002 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0746397972106934
Epoch: 34, Steps: 9 | Train Loss: 0.073 Vali Loss: 1.012 Vali Acc: 0.551 Test Loss: 1.012 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3674519062042236
Epoch: 35, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.007 Vali Acc: 0.565 Test Loss: 1.007 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5263094902038574
Epoch: 36, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.017 Vali Acc: 0.580 Test Loss: 1.017 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6409428119659424
Epoch: 37, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.016 Vali Acc: 0.580 Test Loss: 1.016 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4637691974639893
Epoch: 38, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.015 Vali Acc: 0.580 Test Loss: 1.015 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9723773002624512
Epoch: 39, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.028 Vali Acc: 0.572 Test Loss: 1.028 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.77244234085083
Epoch: 40, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.047 Vali Acc: 0.572 Test Loss: 1.047 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 441212
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6955912113189697
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.465 Vali Acc: 0.239 Test Loss: 1.465 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.5636136531829834
Epoch: 2, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.432 Vali Acc: 0.232 Test Loss: 1.432 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4093337059020996
Epoch: 3, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.395 Vali Acc: 0.268 Test Loss: 1.395 Test Acc: 0.268
Validation loss decreased (-0.239116 --> -0.268102).  Saving model ...
Epoch: 4 cost time: 1.3109800815582275
Epoch: 4, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.358 Vali Acc: 0.275 Test Loss: 1.358 Test Acc: 0.275
Validation loss decreased (-0.268102 --> -0.275349).  Saving model ...
Epoch: 5 cost time: 1.6046223640441895
Epoch: 5, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.325 Vali Acc: 0.290 Test Loss: 1.325 Test Acc: 0.290
Validation loss decreased (-0.275349 --> -0.289842).  Saving model ...
Epoch: 6 cost time: 1.7145895957946777
Epoch: 6, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.288 Vali Acc: 0.326 Test Loss: 1.288 Test Acc: 0.326
Validation loss decreased (-0.289842 --> -0.326074).  Saving model ...
Epoch: 7 cost time: 1.3389043807983398
Epoch: 7, Steps: 9 | Train Loss: 0.924 Vali Loss: 1.253 Vali Acc: 0.391 Test Loss: 1.253 Test Acc: 0.391
Validation loss decreased (-0.326074 --> -0.391292).  Saving model ...
Epoch: 8 cost time: 1.4259347915649414
Epoch: 8, Steps: 9 | Train Loss: 0.852 Vali Loss: 1.232 Vali Acc: 0.384 Test Loss: 1.232 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3770439624786377
Epoch: 9, Steps: 9 | Train Loss: 0.795 Vali Loss: 1.212 Vali Acc: 0.420 Test Loss: 1.212 Test Acc: 0.420
Validation loss decreased (-0.391292 --> -0.420278).  Saving model ...
Epoch: 10 cost time: 1.450629472732544
Epoch: 10, Steps: 9 | Train Loss: 0.741 Vali Loss: 1.191 Vali Acc: 0.457 Test Loss: 1.191 Test Acc: 0.457
Validation loss decreased (-0.420278 --> -0.456510).  Saving model ...
Epoch: 11 cost time: 1.2924509048461914
Epoch: 11, Steps: 9 | Train Loss: 0.674 Vali Loss: 1.170 Vali Acc: 0.493 Test Loss: 1.170 Test Acc: 0.493
Validation loss decreased (-0.456510 --> -0.492742).  Saving model ...
Epoch: 12 cost time: 1.4176020622253418
Epoch: 12, Steps: 9 | Train Loss: 0.617 Vali Loss: 1.152 Vali Acc: 0.493 Test Loss: 1.152 Test Acc: 0.493
Validation loss decreased (-0.492742 --> -0.492742).  Saving model ...
Epoch: 13 cost time: 1.6586410999298096
Epoch: 13, Steps: 9 | Train Loss: 0.558 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5358097553253174
Epoch: 14, Steps: 9 | Train Loss: 0.499 Vali Loss: 1.129 Vali Acc: 0.536 Test Loss: 1.129 Test Acc: 0.536
Validation loss decreased (-0.492742 --> -0.536221).  Saving model ...
Epoch: 15 cost time: 1.1424264907836914
Epoch: 15, Steps: 9 | Train Loss: 0.462 Vali Loss: 1.113 Vali Acc: 0.565 Test Loss: 1.113 Test Acc: 0.565
Validation loss decreased (-0.536221 --> -0.565206).  Saving model ...
Epoch: 16 cost time: 1.4477181434631348
Epoch: 16, Steps: 9 | Train Loss: 0.427 Vali Loss: 1.104 Vali Acc: 0.558 Test Loss: 1.104 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.346836805343628
Epoch: 17, Steps: 9 | Train Loss: 0.370 Vali Loss: 1.101 Vali Acc: 0.580 Test Loss: 1.101 Test Acc: 0.580
Validation loss decreased (-0.565206 --> -0.579699).  Saving model ...
Epoch: 18 cost time: 1.1818795204162598
Epoch: 18, Steps: 9 | Train Loss: 0.335 Vali Loss: 1.083 Vali Acc: 0.572 Test Loss: 1.083 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2269556522369385
Epoch: 19, Steps: 9 | Train Loss: 0.303 Vali Loss: 1.076 Vali Acc: 0.587 Test Loss: 1.076 Test Acc: 0.587
Validation loss decreased (-0.579699 --> -0.586946).  Saving model ...
Epoch: 20 cost time: 1.3751916885375977
Epoch: 20, Steps: 9 | Train Loss: 0.272 Vali Loss: 1.067 Vali Acc: 0.580 Test Loss: 1.067 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3367969989776611
Epoch: 21, Steps: 9 | Train Loss: 0.244 Vali Loss: 1.069 Vali Acc: 0.572 Test Loss: 1.069 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5690641403198242
Epoch: 22, Steps: 9 | Train Loss: 0.219 Vali Loss: 1.066 Vali Acc: 0.594 Test Loss: 1.066 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594192).  Saving model ...
Epoch: 23 cost time: 1.5144917964935303
Epoch: 23, Steps: 9 | Train Loss: 0.191 Vali Loss: 1.047 Vali Acc: 0.594 Test Loss: 1.047 Test Acc: 0.594
Validation loss decreased (-0.594192 --> -0.594192).  Saving model ...
Epoch: 24 cost time: 1.395777940750122
Epoch: 24, Steps: 9 | Train Loss: 0.174 Vali Loss: 1.052 Vali Acc: 0.594 Test Loss: 1.052 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8717520236968994
Epoch: 25, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.057 Vali Acc: 0.587 Test Loss: 1.057 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.577885389328003
Epoch: 26, Steps: 9 | Train Loss: 0.141 Vali Loss: 1.038 Vali Acc: 0.609 Test Loss: 1.038 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608685).  Saving model ...
Epoch: 27 cost time: 1.5900390148162842
Epoch: 27, Steps: 9 | Train Loss: 0.125 Vali Loss: 1.030 Vali Acc: 0.609 Test Loss: 1.030 Test Acc: 0.609
Validation loss decreased (-0.608685 --> -0.608685).  Saving model ...
Epoch: 28 cost time: 1.433035135269165
Epoch: 28, Steps: 9 | Train Loss: 0.115 Vali Loss: 1.034 Vali Acc: 0.616 Test Loss: 1.034 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 29 cost time: 2.3528146743774414
Epoch: 29, Steps: 9 | Train Loss: 0.102 Vali Loss: 1.043 Vali Acc: 0.609 Test Loss: 1.043 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7280950546264648
Epoch: 30, Steps: 9 | Train Loss: 0.091 Vali Loss: 1.042 Vali Acc: 0.609 Test Loss: 1.042 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5799322128295898
Epoch: 31, Steps: 9 | Train Loss: 0.085 Vali Loss: 1.043 Vali Acc: 0.601 Test Loss: 1.043 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7584455013275146
Epoch: 32, Steps: 9 | Train Loss: 0.076 Vali Loss: 1.042 Vali Acc: 0.587 Test Loss: 1.042 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7082531452178955
Epoch: 33, Steps: 9 | Train Loss: 0.076 Vali Loss: 1.041 Vali Acc: 0.601 Test Loss: 1.041 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.538609504699707
Epoch: 34, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.043 Vali Acc: 0.594 Test Loss: 1.043 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7056117057800293
Epoch: 35, Steps: 9 | Train Loss: 0.059 Vali Loss: 1.033 Vali Acc: 0.601 Test Loss: 1.033 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6053342819213867
Epoch: 36, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.036 Vali Acc: 0.594 Test Loss: 1.036 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.9916319847106934
Epoch: 37, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.036 Vali Acc: 0.594 Test Loss: 1.036 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.9258902072906494
Epoch: 38, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.036 Vali Acc: 0.587 Test Loss: 1.036 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6159420289855072
model parameter : 436092
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.415451288223267
Epoch: 1, Steps: 9 | Train Loss: 1.472 Vali Loss: 1.426 Vali Acc: 0.246 Test Loss: 1.426 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.3320448398590088
Epoch: 2, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.394 Vali Acc: 0.268 Test Loss: 1.394 Test Acc: 0.268
Validation loss decreased (-0.246363 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 1.5080413818359375
Epoch: 3, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (-0.268102 --> -0.297088).  Saving model ...
Epoch: 4 cost time: 1.2368731498718262
Epoch: 4, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.332 Vali Acc: 0.333 Test Loss: 1.332 Test Acc: 0.333
Validation loss decreased (-0.297088 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 1.2194721698760986
Epoch: 5, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.308 Vali Acc: 0.348 Test Loss: 1.308 Test Acc: 0.348
Validation loss decreased (-0.333320 --> -0.347813).  Saving model ...
Epoch: 6 cost time: 1.20756196975708
Epoch: 6, Steps: 9 | Train Loss: 1.024 Vali Loss: 1.289 Vali Acc: 0.406 Test Loss: 1.289 Test Acc: 0.406
Validation loss decreased (-0.347813 --> -0.405784).  Saving model ...
Epoch: 7 cost time: 1.5957303047180176
Epoch: 7, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.274 Vali Acc: 0.420 Test Loss: 1.274 Test Acc: 0.420
Validation loss decreased (-0.405784 --> -0.420277).  Saving model ...
Epoch: 8 cost time: 1.1844573020935059
Epoch: 8, Steps: 9 | Train Loss: 0.897 Vali Loss: 1.253 Vali Acc: 0.413 Test Loss: 1.253 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1829924583435059
Epoch: 9, Steps: 9 | Train Loss: 0.802 Vali Loss: 1.229 Vali Acc: 0.435 Test Loss: 1.229 Test Acc: 0.435
Validation loss decreased (-0.420277 --> -0.434770).  Saving model ...
Epoch: 10 cost time: 1.0632240772247314
Epoch: 10, Steps: 9 | Train Loss: 0.775 Vali Loss: 1.214 Vali Acc: 0.420 Test Loss: 1.214 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1700408458709717
Epoch: 11, Steps: 9 | Train Loss: 0.708 Vali Loss: 1.196 Vali Acc: 0.420 Test Loss: 1.196 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.027113676071167
Epoch: 12, Steps: 9 | Train Loss: 0.648 Vali Loss: 1.170 Vali Acc: 0.428 Test Loss: 1.170 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.136242389678955
Epoch: 13, Steps: 9 | Train Loss: 0.588 Vali Loss: 1.151 Vali Acc: 0.442 Test Loss: 1.151 Test Acc: 0.442
Validation loss decreased (-0.434770 --> -0.442017).  Saving model ...
Epoch: 14 cost time: 1.0419700145721436
Epoch: 14, Steps: 9 | Train Loss: 0.550 Vali Loss: 1.135 Vali Acc: 0.464 Test Loss: 1.135 Test Acc: 0.464
Validation loss decreased (-0.442017 --> -0.463757).  Saving model ...
Epoch: 15 cost time: 1.4873199462890625
Epoch: 15, Steps: 9 | Train Loss: 0.493 Vali Loss: 1.113 Vali Acc: 0.471 Test Loss: 1.113 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471003).  Saving model ...
Epoch: 16 cost time: 1.1843020915985107
Epoch: 16, Steps: 9 | Train Loss: 0.442 Vali Loss: 1.111 Vali Acc: 0.449 Test Loss: 1.111 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.27286696434021
Epoch: 17, Steps: 9 | Train Loss: 0.394 Vali Loss: 1.091 Vali Acc: 0.457 Test Loss: 1.091 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2489652633666992
Epoch: 18, Steps: 9 | Train Loss: 0.355 Vali Loss: 1.084 Vali Acc: 0.464 Test Loss: 1.084 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.285876750946045
Epoch: 19, Steps: 9 | Train Loss: 0.325 Vali Loss: 1.064 Vali Acc: 0.486 Test Loss: 1.064 Test Acc: 0.486
Validation loss decreased (-0.471003 --> -0.485497).  Saving model ...
Epoch: 20 cost time: 1.3544337749481201
Epoch: 20, Steps: 9 | Train Loss: 0.280 Vali Loss: 1.062 Vali Acc: 0.500 Test Loss: 1.062 Test Acc: 0.500
Validation loss decreased (-0.485497 --> -0.499989).  Saving model ...
Epoch: 21 cost time: 1.0216526985168457
Epoch: 21, Steps: 9 | Train Loss: 0.248 Vali Loss: 1.054 Vali Acc: 0.514 Test Loss: 1.054 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.514482).  Saving model ...
Epoch: 22 cost time: 1.186657428741455
Epoch: 22, Steps: 9 | Train Loss: 0.225 Vali Loss: 1.043 Vali Acc: 0.522 Test Loss: 1.043 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521729).  Saving model ...
Epoch: 23 cost time: 1.3120732307434082
Epoch: 23, Steps: 9 | Train Loss: 0.189 Vali Loss: 1.013 Vali Acc: 0.536 Test Loss: 1.013 Test Acc: 0.536
Validation loss decreased (-0.521729 --> -0.536222).  Saving model ...
Epoch: 24 cost time: 1.4557440280914307
Epoch: 24, Steps: 9 | Train Loss: 0.171 Vali Loss: 1.016 Vali Acc: 0.529 Test Loss: 1.016 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.059469223022461
Epoch: 25, Steps: 9 | Train Loss: 0.150 Vali Loss: 1.027 Vali Acc: 0.543 Test Loss: 1.027 Test Acc: 0.543
Validation loss decreased (-0.536222 --> -0.543468).  Saving model ...
Epoch: 26 cost time: 1.1774885654449463
Epoch: 26, Steps: 9 | Train Loss: 0.142 Vali Loss: 1.012 Vali Acc: 0.543 Test Loss: 1.012 Test Acc: 0.543
Validation loss decreased (-0.543468 --> -0.543468).  Saving model ...
Epoch: 27 cost time: 1.3408045768737793
Epoch: 27, Steps: 9 | Train Loss: 0.117 Vali Loss: 1.001 Vali Acc: 0.536 Test Loss: 1.001 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2902677059173584
Epoch: 28, Steps: 9 | Train Loss: 0.102 Vali Loss: 1.012 Vali Acc: 0.543 Test Loss: 1.012 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2315845489501953
Epoch: 29, Steps: 9 | Train Loss: 0.093 Vali Loss: 1.003 Vali Acc: 0.558 Test Loss: 1.003 Test Acc: 0.558
Validation loss decreased (-0.543468 --> -0.557961).  Saving model ...
Epoch: 30 cost time: 1.105024814605713
Epoch: 30, Steps: 9 | Train Loss: 0.084 Vali Loss: 1.004 Vali Acc: 0.558 Test Loss: 1.004 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.222855567932129
Epoch: 31, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.998 Vali Acc: 0.558 Test Loss: 0.998 Test Acc: 0.558
Validation loss decreased (-0.557961 --> -0.557961).  Saving model ...
Epoch: 32 cost time: 1.5201988220214844
Epoch: 32, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.007 Vali Acc: 0.551 Test Loss: 1.007 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1064362525939941
Epoch: 33, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.995 Vali Acc: 0.558 Test Loss: 0.995 Test Acc: 0.558
Validation loss decreased (-0.557961 --> -0.557961).  Saving model ...
Epoch: 34 cost time: 1.4448182582855225
Epoch: 34, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.000 Vali Acc: 0.551 Test Loss: 1.000 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1738426685333252
Epoch: 35, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.994 Vali Acc: 0.543 Test Loss: 0.994 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4718303680419922
Epoch: 36, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.000 Vali Acc: 0.551 Test Loss: 1.000 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5254795551300049
Epoch: 37, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.002 Vali Acc: 0.558 Test Loss: 1.002 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3055691719055176
Epoch: 38, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.005 Vali Acc: 0.558 Test Loss: 1.005 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2649104595184326
Epoch: 39, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.005 Vali Acc: 0.558 Test Loss: 1.005 Test Acc: 0.558
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3567326068878174
Epoch: 40, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.004 Vali Acc: 0.558 Test Loss: 1.004 Test Acc: 0.558
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.366598129272461
Epoch: 41, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.004 Vali Acc: 0.572 Test Loss: 1.004 Test Acc: 0.572
Validation loss decreased (-0.557961 --> -0.572454).  Saving model ...
Epoch: 42 cost time: 1.1294586658477783
Epoch: 42, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.008 Vali Acc: 0.565 Test Loss: 1.008 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1503937244415283
Epoch: 43, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.011 Vali Acc: 0.565 Test Loss: 1.011 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0914952754974365
Epoch: 44, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.012 Vali Acc: 0.565 Test Loss: 1.012 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3768630027770996
Epoch: 45, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.011 Vali Acc: 0.565 Test Loss: 1.011 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.31955885887146
Epoch: 46, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.014 Vali Acc: 0.558 Test Loss: 1.014 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.571723461151123
Epoch: 47, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.019 Vali Acc: 0.558 Test Loss: 1.019 Test Acc: 0.558
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.4043371677398682
Epoch: 48, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.020 Vali Acc: 0.558 Test Loss: 1.020 Test Acc: 0.558
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.252913475036621
Epoch: 49, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.016 Vali Acc: 0.565 Test Loss: 1.016 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2218008041381836
Epoch: 50, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.014 Vali Acc: 0.565 Test Loss: 1.014 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.033461570739746
Epoch: 51, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.011 Vali Acc: 0.565 Test Loss: 1.011 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 431996
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.046297788619995
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.477 Vali Acc: 0.290 Test Loss: 1.477 Test Acc: 0.290
Validation loss decreased (inf --> -0.289840).  Saving model ...
Epoch: 2 cost time: 1.4086549282073975
Epoch: 2, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.443 Vali Acc: 0.290 Test Loss: 1.443 Test Acc: 0.290
Validation loss decreased (-0.289840 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 1.329010248184204
Epoch: 3, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.395 Vali Acc: 0.304 Test Loss: 1.395 Test Acc: 0.304
Validation loss decreased (-0.289841 --> -0.304334).  Saving model ...
Epoch: 4 cost time: 1.1725075244903564
Epoch: 4, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.342 Vali Acc: 0.348 Test Loss: 1.342 Test Acc: 0.348
Validation loss decreased (-0.304334 --> -0.347813).  Saving model ...
Epoch: 5 cost time: 1.0841586589813232
Epoch: 5, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.304 Vali Acc: 0.348 Test Loss: 1.304 Test Acc: 0.348
Validation loss decreased (-0.347813 --> -0.347813).  Saving model ...
Epoch: 6 cost time: 1.1695952415466309
Epoch: 6, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.261 Vali Acc: 0.391 Test Loss: 1.261 Test Acc: 0.391
Validation loss decreased (-0.347813 --> -0.391292).  Saving model ...
Epoch: 7 cost time: 1.2190399169921875
Epoch: 7, Steps: 9 | Train Loss: 0.942 Vali Loss: 1.230 Vali Acc: 0.449 Test Loss: 1.230 Test Acc: 0.449
Validation loss decreased (-0.391292 --> -0.449263).  Saving model ...
Epoch: 8 cost time: 1.033193826675415
Epoch: 8, Steps: 9 | Train Loss: 0.866 Vali Loss: 1.200 Vali Acc: 0.464 Test Loss: 1.200 Test Acc: 0.464
Validation loss decreased (-0.449263 --> -0.463756).  Saving model ...
Epoch: 9 cost time: 1.2177727222442627
Epoch: 9, Steps: 9 | Train Loss: 0.801 Vali Loss: 1.175 Vali Acc: 0.478 Test Loss: 1.175 Test Acc: 0.478
Validation loss decreased (-0.463756 --> -0.478249).  Saving model ...
Epoch: 10 cost time: 0.9955008029937744
Epoch: 10, Steps: 9 | Train Loss: 0.739 Vali Loss: 1.156 Vali Acc: 0.493 Test Loss: 1.156 Test Acc: 0.493
Validation loss decreased (-0.478249 --> -0.492742).  Saving model ...
Epoch: 11 cost time: 1.0787341594696045
Epoch: 11, Steps: 9 | Train Loss: 0.656 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.492742 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.120223045349121
Epoch: 12, Steps: 9 | Train Loss: 0.591 Vali Loss: 1.121 Vali Acc: 0.514 Test Loss: 1.121 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.514482).  Saving model ...
Epoch: 13 cost time: 1.3196418285369873
Epoch: 13, Steps: 9 | Train Loss: 0.541 Vali Loss: 1.098 Vali Acc: 0.543 Test Loss: 1.098 Test Acc: 0.543
Validation loss decreased (-0.514482 --> -0.543467).  Saving model ...
Epoch: 14 cost time: 1.2565879821777344
Epoch: 14, Steps: 9 | Train Loss: 0.488 Vali Loss: 1.085 Vali Acc: 0.572 Test Loss: 1.085 Test Acc: 0.572
Validation loss decreased (-0.543467 --> -0.572453).  Saving model ...
Epoch: 15 cost time: 1.2419962882995605
Epoch: 15, Steps: 9 | Train Loss: 0.421 Vali Loss: 1.076 Vali Acc: 0.543 Test Loss: 1.076 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.386641025543213
Epoch: 16, Steps: 9 | Train Loss: 0.390 Vali Loss: 1.059 Vali Acc: 0.594 Test Loss: 1.059 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594192).  Saving model ...
Epoch: 17 cost time: 1.2929108142852783
Epoch: 17, Steps: 9 | Train Loss: 0.331 Vali Loss: 1.042 Vali Acc: 0.609 Test Loss: 1.042 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608685).  Saving model ...
Epoch: 18 cost time: 1.262354850769043
Epoch: 18, Steps: 9 | Train Loss: 0.284 Vali Loss: 1.027 Vali Acc: 0.594 Test Loss: 1.027 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.333695888519287
Epoch: 19, Steps: 9 | Train Loss: 0.266 Vali Loss: 1.034 Vali Acc: 0.587 Test Loss: 1.034 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2344818115234375
Epoch: 20, Steps: 9 | Train Loss: 0.219 Vali Loss: 1.030 Vali Acc: 0.580 Test Loss: 1.030 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4517760276794434
Epoch: 21, Steps: 9 | Train Loss: 0.203 Vali Loss: 1.030 Vali Acc: 0.594 Test Loss: 1.030 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0860939025878906
Epoch: 22, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.024 Vali Acc: 0.594 Test Loss: 1.024 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0352249145507812
Epoch: 23, Steps: 9 | Train Loss: 0.154 Vali Loss: 1.031 Vali Acc: 0.587 Test Loss: 1.031 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2205429077148438
Epoch: 24, Steps: 9 | Train Loss: 0.135 Vali Loss: 1.023 Vali Acc: 0.587 Test Loss: 1.023 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2522222995758057
Epoch: 25, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.016 Vali Acc: 0.572 Test Loss: 1.016 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.374220848083496
Epoch: 26, Steps: 9 | Train Loss: 0.110 Vali Loss: 1.011 Vali Acc: 0.580 Test Loss: 1.011 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2747457027435303
Epoch: 27, Steps: 9 | Train Loss: 0.094 Vali Loss: 1.016 Vali Acc: 0.587 Test Loss: 1.016 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6086956521739131
model parameter : 429948
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8193602561950684
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.419 Vali Acc: 0.261 Test Loss: 1.419 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 1.0511817932128906
Epoch: 2, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
Validation loss decreased (-0.260855 --> -0.275348).  Saving model ...
Epoch: 3 cost time: 1.0650849342346191
Epoch: 3, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.368 Vali Acc: 0.312 Test Loss: 1.368 Test Acc: 0.312
Validation loss decreased (-0.275348 --> -0.311581).  Saving model ...
Epoch: 4 cost time: 1.0988795757293701
Epoch: 4, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.337 Vali Acc: 0.355 Test Loss: 1.337 Test Acc: 0.355
Validation loss decreased (-0.311581 --> -0.355059).  Saving model ...
Epoch: 5 cost time: 0.8254599571228027
Epoch: 5, Steps: 9 | Train Loss: 1.147 Vali Loss: 1.299 Vali Acc: 0.413 Test Loss: 1.299 Test Acc: 0.413
Validation loss decreased (-0.355059 --> -0.413030).  Saving model ...
Epoch: 6 cost time: 0.8776950836181641
Epoch: 6, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.275 Vali Acc: 0.457 Test Loss: 1.275 Test Acc: 0.457
Validation loss decreased (-0.413030 --> -0.456509).  Saving model ...
Epoch: 7 cost time: 0.9436132907867432
Epoch: 7, Steps: 9 | Train Loss: 0.979 Vali Loss: 1.252 Vali Acc: 0.413 Test Loss: 1.252 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8656113147735596
Epoch: 8, Steps: 9 | Train Loss: 0.885 Vali Loss: 1.222 Vali Acc: 0.464 Test Loss: 1.222 Test Acc: 0.464
Validation loss decreased (-0.456509 --> -0.463756).  Saving model ...
Epoch: 9 cost time: 0.8287088871002197
Epoch: 9, Steps: 9 | Train Loss: 0.797 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.463756 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9151456356048584
Epoch: 10, Steps: 9 | Train Loss: 0.757 Vali Loss: 1.170 Vali Acc: 0.493 Test Loss: 1.170 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9619758129119873
Epoch: 11, Steps: 9 | Train Loss: 0.657 Vali Loss: 1.146 Vali Acc: 0.486 Test Loss: 1.146 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1622490882873535
Epoch: 12, Steps: 9 | Train Loss: 0.602 Vali Loss: 1.127 Vali Acc: 0.522 Test Loss: 1.127 Test Acc: 0.522
Validation loss decreased (-0.499988 --> -0.521728).  Saving model ...
Epoch: 13 cost time: 0.8619680404663086
Epoch: 13, Steps: 9 | Train Loss: 0.541 Vali Loss: 1.090 Vali Acc: 0.601 Test Loss: 1.090 Test Acc: 0.601
Validation loss decreased (-0.521728 --> -0.601438).  Saving model ...
Epoch: 14 cost time: 0.9853546619415283
Epoch: 14, Steps: 9 | Train Loss: 0.477 Vali Loss: 1.090 Vali Acc: 0.572 Test Loss: 1.090 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0991060733795166
Epoch: 15, Steps: 9 | Train Loss: 0.432 Vali Loss: 1.066 Vali Acc: 0.594 Test Loss: 1.066 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1241202354431152
Epoch: 16, Steps: 9 | Train Loss: 0.365 Vali Loss: 1.056 Vali Acc: 0.609 Test Loss: 1.056 Test Acc: 0.609
Validation loss decreased (-0.601438 --> -0.608685).  Saving model ...
Epoch: 17 cost time: 0.962691068649292
Epoch: 17, Steps: 9 | Train Loss: 0.318 Vali Loss: 1.042 Vali Acc: 0.623 Test Loss: 1.042 Test Acc: 0.623
Validation loss decreased (-0.608685 --> -0.623178).  Saving model ...
Epoch: 18 cost time: 1.0363528728485107
Epoch: 18, Steps: 9 | Train Loss: 0.275 Vali Loss: 1.033 Vali Acc: 0.616 Test Loss: 1.033 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2085955142974854
Epoch: 19, Steps: 9 | Train Loss: 0.250 Vali Loss: 1.027 Vali Acc: 0.623 Test Loss: 1.027 Test Acc: 0.623
Validation loss decreased (-0.623178 --> -0.623178).  Saving model ...
Epoch: 20 cost time: 1.0015411376953125
Epoch: 20, Steps: 9 | Train Loss: 0.218 Vali Loss: 1.019 Vali Acc: 0.638 Test Loss: 1.019 Test Acc: 0.638
Validation loss decreased (-0.623178 --> -0.637671).  Saving model ...
Epoch: 21 cost time: 1.040029525756836
Epoch: 21, Steps: 9 | Train Loss: 0.192 Vali Loss: 1.007 Vali Acc: 0.616 Test Loss: 1.007 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8552811145782471
Epoch: 22, Steps: 9 | Train Loss: 0.161 Vali Loss: 1.001 Vali Acc: 0.616 Test Loss: 1.001 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0950486660003662
Epoch: 23, Steps: 9 | Train Loss: 0.150 Vali Loss: 1.002 Vali Acc: 0.601 Test Loss: 1.002 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3106472492218018
Epoch: 24, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.998 Vali Acc: 0.616 Test Loss: 0.998 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4327855110168457
Epoch: 25, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.996 Vali Acc: 0.616 Test Loss: 0.996 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1251564025878906
Epoch: 26, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.995 Vali Acc: 0.616 Test Loss: 0.995 Test Acc: 0.616
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2399444580078125
Epoch: 27, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.982 Vali Acc: 0.623 Test Loss: 0.982 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1164672374725342
Epoch: 28, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.970 Vali Acc: 0.623 Test Loss: 0.970 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2109451293945312
Epoch: 29, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.969 Vali Acc: 0.630 Test Loss: 0.969 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0908257961273193
Epoch: 30, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.978 Vali Acc: 0.609 Test Loss: 0.978 Test Acc: 0.609
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6376811594202898
model parameter : 427900
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.842768907546997
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.391 Vali Acc: 0.297 Test Loss: 1.391 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.0757315158843994
Epoch: 2, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.369 Vali Acc: 0.297 Test Loss: 1.369 Test Acc: 0.297
Validation loss decreased (-0.297088 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 1.0801548957824707
Epoch: 3, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.344 Vali Acc: 0.326 Test Loss: 1.344 Test Acc: 0.326
Validation loss decreased (-0.297088 --> -0.326074).  Saving model ...
Epoch: 4 cost time: 0.9744343757629395
Epoch: 4, Steps: 9 | Train Loss: 1.218 Vali Loss: 1.320 Vali Acc: 0.391 Test Loss: 1.320 Test Acc: 0.391
Validation loss decreased (-0.326074 --> -0.391291).  Saving model ...
Epoch: 5 cost time: 1.1275324821472168
Epoch: 5, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.301 Vali Acc: 0.377 Test Loss: 1.301 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0791137218475342
Epoch: 6, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.282 Vali Acc: 0.406 Test Loss: 1.282 Test Acc: 0.406
Validation loss decreased (-0.391291 --> -0.405784).  Saving model ...
Epoch: 7 cost time: 0.9704585075378418
Epoch: 7, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.257 Vali Acc: 0.442 Test Loss: 1.257 Test Acc: 0.442
Validation loss decreased (-0.405784 --> -0.442016).  Saving model ...
Epoch: 8 cost time: 1.0474717617034912
Epoch: 8, Steps: 9 | Train Loss: 0.924 Vali Loss: 1.244 Vali Acc: 0.428 Test Loss: 1.244 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9314026832580566
Epoch: 9, Steps: 9 | Train Loss: 0.864 Vali Loss: 1.230 Vali Acc: 0.435 Test Loss: 1.230 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0561237335205078
Epoch: 10, Steps: 9 | Train Loss: 0.787 Vali Loss: 1.222 Vali Acc: 0.428 Test Loss: 1.222 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9823801517486572
Epoch: 11, Steps: 9 | Train Loss: 0.758 Vali Loss: 1.210 Vali Acc: 0.442 Test Loss: 1.210 Test Acc: 0.442
Validation loss decreased (-0.442016 --> -0.442017).  Saving model ...
Epoch: 12 cost time: 0.8601851463317871
Epoch: 12, Steps: 9 | Train Loss: 0.674 Vali Loss: 1.189 Vali Acc: 0.471 Test Loss: 1.189 Test Acc: 0.471
Validation loss decreased (-0.442017 --> -0.471003).  Saving model ...
Epoch: 13 cost time: 0.9394392967224121
Epoch: 13, Steps: 9 | Train Loss: 0.622 Vali Loss: 1.173 Vali Acc: 0.471 Test Loss: 1.173 Test Acc: 0.471
Validation loss decreased (-0.471003 --> -0.471003).  Saving model ...
Epoch: 14 cost time: 0.8834781646728516
Epoch: 14, Steps: 9 | Train Loss: 0.592 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
Validation loss decreased (-0.471003 --> -0.485496).  Saving model ...
Epoch: 15 cost time: 0.9630348682403564
Epoch: 15, Steps: 9 | Train Loss: 0.530 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
Validation loss decreased (-0.485496 --> -0.485496).  Saving model ...
Epoch: 16 cost time: 0.8709852695465088
Epoch: 16, Steps: 9 | Train Loss: 0.475 Vali Loss: 1.132 Vali Acc: 0.543 Test Loss: 1.132 Test Acc: 0.543
Validation loss decreased (-0.485496 --> -0.543467).  Saving model ...
Epoch: 17 cost time: 0.9047286510467529
Epoch: 17, Steps: 9 | Train Loss: 0.434 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8568441867828369
Epoch: 18, Steps: 9 | Train Loss: 0.380 Vali Loss: 1.128 Vali Acc: 0.486 Test Loss: 1.128 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9060876369476318
Epoch: 19, Steps: 9 | Train Loss: 0.338 Vali Loss: 1.107 Vali Acc: 0.507 Test Loss: 1.107 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7901856899261475
Epoch: 20, Steps: 9 | Train Loss: 0.307 Vali Loss: 1.083 Vali Acc: 0.529 Test Loss: 1.083 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0336370468139648
Epoch: 21, Steps: 9 | Train Loss: 0.269 Vali Loss: 1.075 Vali Acc: 0.551 Test Loss: 1.075 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550714).  Saving model ...
Epoch: 22 cost time: 0.917374849319458
Epoch: 22, Steps: 9 | Train Loss: 0.234 Vali Loss: 1.082 Vali Acc: 0.529 Test Loss: 1.082 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8786220550537109
Epoch: 23, Steps: 9 | Train Loss: 0.202 Vali Loss: 1.072 Vali Acc: 0.558 Test Loss: 1.072 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557960).  Saving model ...
Epoch: 24 cost time: 0.7763833999633789
Epoch: 24, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.047 Vali Acc: 0.543 Test Loss: 1.047 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8782274723052979
Epoch: 25, Steps: 9 | Train Loss: 0.146 Vali Loss: 1.046 Vali Acc: 0.558 Test Loss: 1.046 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557961).  Saving model ...
Epoch: 26 cost time: 0.9717597961425781
Epoch: 26, Steps: 9 | Train Loss: 0.124 Vali Loss: 1.045 Vali Acc: 0.565 Test Loss: 1.045 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565207).  Saving model ...
Epoch: 27 cost time: 0.878690242767334
Epoch: 27, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.053 Vali Acc: 0.565 Test Loss: 1.053 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0656423568725586
Epoch: 28, Steps: 9 | Train Loss: 0.088 Vali Loss: 1.060 Vali Acc: 0.558 Test Loss: 1.060 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8335051536560059
Epoch: 29, Steps: 9 | Train Loss: 0.072 Vali Loss: 1.066 Vali Acc: 0.558 Test Loss: 1.066 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9361279010772705
Epoch: 30, Steps: 9 | Train Loss: 0.066 Vali Loss: 1.077 Vali Acc: 0.572 Test Loss: 1.077 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572453).  Saving model ...
Epoch: 31 cost time: 0.8064794540405273
Epoch: 31, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.075 Vali Acc: 0.558 Test Loss: 1.075 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8333477973937988
Epoch: 32, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.084 Vali Acc: 0.565 Test Loss: 1.084 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8812205791473389
Epoch: 33, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.103 Vali Acc: 0.565 Test Loss: 1.103 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.875067949295044
Epoch: 34, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.105 Vali Acc: 0.565 Test Loss: 1.105 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8391785621643066
Epoch: 35, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.105 Vali Acc: 0.565 Test Loss: 1.105 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9172961711883545
Epoch: 36, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.118 Vali Acc: 0.565 Test Loss: 1.118 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8561139106750488
Epoch: 37, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.110 Vali Acc: 0.565 Test Loss: 1.110 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9123692512512207
Epoch: 38, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.107 Vali Acc: 0.543 Test Loss: 1.107 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8080873489379883
Epoch: 39, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.098 Vali Acc: 0.551 Test Loss: 1.098 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7414810657501221
Epoch: 40, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.105 Vali Acc: 0.543 Test Loss: 1.105 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 425852
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.816837787628174
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.433 Vali Acc: 0.188 Test Loss: 1.433 Test Acc: 0.188
Validation loss decreased (inf --> -0.188391).  Saving model ...
Epoch: 2 cost time: 2.4701087474823
Epoch: 2, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.334 Vali Acc: 0.297 Test Loss: 1.334 Test Acc: 0.297
Validation loss decreased (-0.188391 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 2.165487766265869
Epoch: 3, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.256 Vali Acc: 0.428 Test Loss: 1.256 Test Acc: 0.428
Validation loss decreased (-0.297088 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 2.1282076835632324
Epoch: 4, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.198 Vali Acc: 0.471 Test Loss: 1.198 Test Acc: 0.471
Validation loss decreased (-0.427524 --> -0.471003).  Saving model ...
Epoch: 5 cost time: 2.5664844512939453
Epoch: 5, Steps: 9 | Train Loss: 0.854 Vali Loss: 1.154 Vali Acc: 0.507 Test Loss: 1.154 Test Acc: 0.507
Validation loss decreased (-0.471003 --> -0.507235).  Saving model ...
Epoch: 6 cost time: 2.3731484413146973
Epoch: 6, Steps: 9 | Train Loss: 0.729 Vali Loss: 1.111 Vali Acc: 0.543 Test Loss: 1.111 Test Acc: 0.543
Validation loss decreased (-0.507235 --> -0.543467).  Saving model ...
Epoch: 7 cost time: 2.1359689235687256
Epoch: 7, Steps: 9 | Train Loss: 0.674 Vali Loss: 1.096 Vali Acc: 0.543 Test Loss: 1.096 Test Acc: 0.543
Validation loss decreased (-0.543467 --> -0.543467).  Saving model ...
Epoch: 8 cost time: 2.5670127868652344
Epoch: 8, Steps: 9 | Train Loss: 0.577 Vali Loss: 1.101 Vali Acc: 0.543 Test Loss: 1.101 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8324198722839355
Epoch: 9, Steps: 9 | Train Loss: 0.518 Vali Loss: 1.077 Vali Acc: 0.543 Test Loss: 1.077 Test Acc: 0.543
Validation loss decreased (-0.543467 --> -0.543467).  Saving model ...
Epoch: 10 cost time: 1.661562204360962
Epoch: 10, Steps: 9 | Train Loss: 0.450 Vali Loss: 1.059 Vali Acc: 0.565 Test Loss: 1.059 Test Acc: 0.565
Validation loss decreased (-0.543467 --> -0.565207).  Saving model ...
Epoch: 11 cost time: 2.6295523643493652
Epoch: 11, Steps: 9 | Train Loss: 0.399 Vali Loss: 1.059 Vali Acc: 0.529 Test Loss: 1.059 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.279723882675171
Epoch: 12, Steps: 9 | Train Loss: 0.366 Vali Loss: 1.066 Vali Acc: 0.536 Test Loss: 1.066 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2432799339294434
Epoch: 13, Steps: 9 | Train Loss: 0.319 Vali Loss: 1.061 Vali Acc: 0.551 Test Loss: 1.061 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1799869537353516
Epoch: 14, Steps: 9 | Train Loss: 0.267 Vali Loss: 1.055 Vali Acc: 0.536 Test Loss: 1.055 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7920687198638916
Epoch: 15, Steps: 9 | Train Loss: 0.242 Vali Loss: 1.012 Vali Acc: 0.558 Test Loss: 1.012 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.940422534942627
Epoch: 16, Steps: 9 | Train Loss: 0.201 Vali Loss: 1.017 Vali Acc: 0.551 Test Loss: 1.017 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.765913486480713
Epoch: 17, Steps: 9 | Train Loss: 0.167 Vali Loss: 1.003 Vali Acc: 0.580 Test Loss: 1.003 Test Acc: 0.580
Validation loss decreased (-0.565207 --> -0.579700).  Saving model ...
Epoch: 18 cost time: 2.2366127967834473
Epoch: 18, Steps: 9 | Train Loss: 0.140 Vali Loss: 1.020 Vali Acc: 0.594 Test Loss: 1.020 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594193).  Saving model ...
Epoch: 19 cost time: 1.9133284091949463
Epoch: 19, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.035 Vali Acc: 0.587 Test Loss: 1.035 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6625072956085205
Epoch: 20, Steps: 9 | Train Loss: 0.108 Vali Loss: 1.004 Vali Acc: 0.580 Test Loss: 1.004 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.701918601989746
Epoch: 21, Steps: 9 | Train Loss: 0.096 Vali Loss: 1.023 Vali Acc: 0.565 Test Loss: 1.023 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.148395299911499
Epoch: 22, Steps: 9 | Train Loss: 0.077 Vali Loss: 1.051 Vali Acc: 0.572 Test Loss: 1.051 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0791220664978027
Epoch: 23, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.030 Vali Acc: 0.580 Test Loss: 1.030 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8192336559295654
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.057 Vali Acc: 0.572 Test Loss: 1.057 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.698699712753296
Epoch: 25, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.079 Vali Acc: 0.565 Test Loss: 1.079 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2561702728271484
Epoch: 26, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.045 Vali Acc: 0.565 Test Loss: 1.045 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.0390195846557617
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.044 Vali Acc: 0.594 Test Loss: 1.044 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.2451908588409424
Epoch: 28, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.053 Vali Acc: 0.558 Test Loss: 1.053 Test Acc: 0.558
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 451418
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.533257484436035
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.413 Vali Acc: 0.232 Test Loss: 1.413 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 2.003669023513794
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.358 Vali Acc: 0.268 Test Loss: 1.358 Test Acc: 0.268
Validation loss decreased (-0.231870 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 2.1939074993133545
Epoch: 3, Steps: 9 | Train Loss: 1.100 Vali Loss: 1.295 Vali Acc: 0.362 Test Loss: 1.295 Test Acc: 0.362
Validation loss decreased (-0.268102 --> -0.362306).  Saving model ...
Epoch: 4 cost time: 1.8193187713623047
Epoch: 4, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.248 Vali Acc: 0.420 Test Loss: 1.248 Test Acc: 0.420
Validation loss decreased (-0.362306 --> -0.420277).  Saving model ...
Epoch: 5 cost time: 1.9637994766235352
Epoch: 5, Steps: 9 | Train Loss: 0.812 Vali Loss: 1.209 Vali Acc: 0.442 Test Loss: 1.209 Test Acc: 0.442
Validation loss decreased (-0.420277 --> -0.442017).  Saving model ...
Epoch: 6 cost time: 1.9956386089324951
Epoch: 6, Steps: 9 | Train Loss: 0.723 Vali Loss: 1.173 Vali Acc: 0.493 Test Loss: 1.173 Test Acc: 0.493
Validation loss decreased (-0.442017 --> -0.492742).  Saving model ...
Epoch: 7 cost time: 1.8131968975067139
Epoch: 7, Steps: 9 | Train Loss: 0.642 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7000670433044434
Epoch: 8, Steps: 9 | Train Loss: 0.570 Vali Loss: 1.131 Vali Acc: 0.543 Test Loss: 1.131 Test Acc: 0.543
Validation loss decreased (-0.492742 --> -0.543467).  Saving model ...
Epoch: 9 cost time: 2.0063843727111816
Epoch: 9, Steps: 9 | Train Loss: 0.500 Vali Loss: 1.106 Vali Acc: 0.522 Test Loss: 1.106 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8764798641204834
Epoch: 10, Steps: 9 | Train Loss: 0.445 Vali Loss: 1.087 Vali Acc: 0.551 Test Loss: 1.087 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550714).  Saving model ...
Epoch: 11 cost time: 1.6282849311828613
Epoch: 11, Steps: 9 | Train Loss: 0.395 Vali Loss: 1.069 Vali Acc: 0.543 Test Loss: 1.069 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.048967123031616
Epoch: 12, Steps: 9 | Train Loss: 0.335 Vali Loss: 1.083 Vali Acc: 0.551 Test Loss: 1.083 Test Acc: 0.551
Validation loss decreased (-0.550714 --> -0.550714).  Saving model ...
Epoch: 13 cost time: 2.1092371940612793
Epoch: 13, Steps: 9 | Train Loss: 0.294 Vali Loss: 1.048 Vali Acc: 0.558 Test Loss: 1.048 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557961).  Saving model ...
Epoch: 14 cost time: 1.796203374862671
Epoch: 14, Steps: 9 | Train Loss: 0.262 Vali Loss: 1.050 Vali Acc: 0.551 Test Loss: 1.050 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5921430587768555
Epoch: 15, Steps: 9 | Train Loss: 0.224 Vali Loss: 1.057 Vali Acc: 0.580 Test Loss: 1.057 Test Acc: 0.580
Validation loss decreased (-0.557961 --> -0.579700).  Saving model ...
Epoch: 16 cost time: 1.6966612339019775
Epoch: 16, Steps: 9 | Train Loss: 0.192 Vali Loss: 1.048 Vali Acc: 0.558 Test Loss: 1.048 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9965028762817383
Epoch: 17, Steps: 9 | Train Loss: 0.169 Vali Loss: 1.047 Vali Acc: 0.514 Test Loss: 1.047 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0853049755096436
Epoch: 18, Steps: 9 | Train Loss: 0.137 Vali Loss: 1.073 Vali Acc: 0.536 Test Loss: 1.073 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3167953491210938
Epoch: 19, Steps: 9 | Train Loss: 0.103 Vali Loss: 1.085 Vali Acc: 0.558 Test Loss: 1.085 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2299840450286865
Epoch: 20, Steps: 9 | Train Loss: 0.099 Vali Loss: 1.092 Vali Acc: 0.536 Test Loss: 1.092 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0674402713775635
Epoch: 21, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.098 Vali Acc: 0.536 Test Loss: 1.098 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.080204725265503
Epoch: 22, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.097 Vali Acc: 0.529 Test Loss: 1.097 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8057265281677246
Epoch: 23, Steps: 9 | Train Loss: 0.059 Vali Loss: 1.079 Vali Acc: 0.536 Test Loss: 1.079 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.741220235824585
Epoch: 24, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.091 Vali Acc: 0.551 Test Loss: 1.091 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8578295707702637
Epoch: 25, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.065 Vali Acc: 0.565 Test Loss: 1.065 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 446298
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8117899894714355
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.326 Vali Acc: 0.399 Test Loss: 1.326 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 1.382155418395996
Epoch: 2, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.271 Vali Acc: 0.464 Test Loss: 1.271 Test Acc: 0.464
Validation loss decreased (-0.398537 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 1.3839309215545654
Epoch: 3, Steps: 9 | Train Loss: 1.053 Vali Loss: 1.228 Vali Acc: 0.478 Test Loss: 1.228 Test Acc: 0.478
Validation loss decreased (-0.463755 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 1.6149392127990723
Epoch: 4, Steps: 9 | Train Loss: 0.909 Vali Loss: 1.200 Vali Acc: 0.471 Test Loss: 1.200 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9519190788269043
Epoch: 5, Steps: 9 | Train Loss: 0.785 Vali Loss: 1.171 Vali Acc: 0.478 Test Loss: 1.171 Test Acc: 0.478
Validation loss decreased (-0.478249 --> -0.478249).  Saving model ...
Epoch: 6 cost time: 1.5056555271148682
Epoch: 6, Steps: 9 | Train Loss: 0.695 Vali Loss: 1.124 Vali Acc: 0.522 Test Loss: 1.124 Test Acc: 0.522
Validation loss decreased (-0.478249 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 1.377326250076294
Epoch: 7, Steps: 9 | Train Loss: 0.601 Vali Loss: 1.111 Vali Acc: 0.507 Test Loss: 1.111 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3657708168029785
Epoch: 8, Steps: 9 | Train Loss: 0.515 Vali Loss: 1.113 Vali Acc: 0.536 Test Loss: 1.113 Test Acc: 0.536
Validation loss decreased (-0.521728 --> -0.536221).  Saving model ...
Epoch: 9 cost time: 1.4132080078125
Epoch: 9, Steps: 9 | Train Loss: 0.439 Vali Loss: 1.110 Vali Acc: 0.529 Test Loss: 1.110 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3557510375976562
Epoch: 10, Steps: 9 | Train Loss: 0.405 Vali Loss: 1.110 Vali Acc: 0.536 Test Loss: 1.110 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536221).  Saving model ...
Epoch: 11 cost time: 1.5286316871643066
Epoch: 11, Steps: 9 | Train Loss: 0.339 Vali Loss: 1.097 Vali Acc: 0.529 Test Loss: 1.097 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3352611064910889
Epoch: 12, Steps: 9 | Train Loss: 0.285 Vali Loss: 1.090 Vali Acc: 0.529 Test Loss: 1.090 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4975669384002686
Epoch: 13, Steps: 9 | Train Loss: 0.232 Vali Loss: 1.106 Vali Acc: 0.507 Test Loss: 1.106 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7525172233581543
Epoch: 14, Steps: 9 | Train Loss: 0.193 Vali Loss: 1.112 Vali Acc: 0.529 Test Loss: 1.112 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0206542015075684
Epoch: 15, Steps: 9 | Train Loss: 0.158 Vali Loss: 1.100 Vali Acc: 0.543 Test Loss: 1.100 Test Acc: 0.543
Validation loss decreased (-0.536221 --> -0.543467).  Saving model ...
Epoch: 16 cost time: 1.6330487728118896
Epoch: 16, Steps: 9 | Train Loss: 0.132 Vali Loss: 1.098 Vali Acc: 0.529 Test Loss: 1.098 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.472456693649292
Epoch: 17, Steps: 9 | Train Loss: 0.104 Vali Loss: 1.064 Vali Acc: 0.536 Test Loss: 1.064 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4617118835449219
Epoch: 18, Steps: 9 | Train Loss: 0.094 Vali Loss: 1.082 Vali Acc: 0.580 Test Loss: 1.082 Test Acc: 0.580
Validation loss decreased (-0.543467 --> -0.579699).  Saving model ...
Epoch: 19 cost time: 1.258939266204834
Epoch: 19, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.095 Vali Acc: 0.558 Test Loss: 1.095 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3683545589447021
Epoch: 20, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.106 Vali Acc: 0.594 Test Loss: 1.106 Test Acc: 0.594
Validation loss decreased (-0.579699 --> -0.594192).  Saving model ...
Epoch: 21 cost time: 1.1977183818817139
Epoch: 21, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.095 Vali Acc: 0.580 Test Loss: 1.095 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.333528757095337
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.115 Vali Acc: 0.551 Test Loss: 1.115 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0159003734588623
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.102 Vali Acc: 0.551 Test Loss: 1.102 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6679749488830566
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.110 Vali Acc: 0.551 Test Loss: 1.110 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7743868827819824
Epoch: 25, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.109 Vali Acc: 0.565 Test Loss: 1.109 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4467802047729492
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.124 Vali Acc: 0.543 Test Loss: 1.124 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8163084983825684
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.125 Vali Acc: 0.565 Test Loss: 1.125 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.539228916168213
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.125 Vali Acc: 0.558 Test Loss: 1.125 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5237979888916016
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.135 Vali Acc: 0.536 Test Loss: 1.135 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5942976474761963
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.132 Vali Acc: 0.536 Test Loss: 1.132 Test Acc: 0.536
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 441178
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9680919647216797
Epoch: 1, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.337 Vali Acc: 0.348 Test Loss: 1.337 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 1.2410426139831543
Epoch: 2, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.285 Vali Acc: 0.362 Test Loss: 1.285 Test Acc: 0.362
Validation loss decreased (-0.347813 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 1.2040691375732422
Epoch: 3, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.235 Vali Acc: 0.406 Test Loss: 1.235 Test Acc: 0.406
Validation loss decreased (-0.362306 --> -0.405785).  Saving model ...
Epoch: 4 cost time: 1.065751314163208
Epoch: 4, Steps: 9 | Train Loss: 0.924 Vali Loss: 1.203 Vali Acc: 0.464 Test Loss: 1.203 Test Acc: 0.464
Validation loss decreased (-0.405785 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 0.9052488803863525
Epoch: 5, Steps: 9 | Train Loss: 0.807 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.463756 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.3579607009887695
Epoch: 6, Steps: 9 | Train Loss: 0.689 Vali Loss: 1.155 Vali Acc: 0.471 Test Loss: 1.155 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2125320434570312
Epoch: 7, Steps: 9 | Train Loss: 0.609 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.324171543121338
Epoch: 8, Steps: 9 | Train Loss: 0.527 Vali Loss: 1.120 Vali Acc: 0.493 Test Loss: 1.120 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.219677448272705
Epoch: 9, Steps: 9 | Train Loss: 0.460 Vali Loss: 1.118 Vali Acc: 0.493 Test Loss: 1.118 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5010321140289307
Epoch: 10, Steps: 9 | Train Loss: 0.388 Vali Loss: 1.111 Vali Acc: 0.514 Test Loss: 1.111 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514482).  Saving model ...
Epoch: 11 cost time: 1.047307014465332
Epoch: 11, Steps: 9 | Train Loss: 0.334 Vali Loss: 1.104 Vali Acc: 0.522 Test Loss: 1.104 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521728).  Saving model ...
Epoch: 12 cost time: 1.6056246757507324
Epoch: 12, Steps: 9 | Train Loss: 0.281 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4284131526947021
Epoch: 13, Steps: 9 | Train Loss: 0.234 Vali Loss: 1.104 Vali Acc: 0.514 Test Loss: 1.104 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3676795959472656
Epoch: 14, Steps: 9 | Train Loss: 0.195 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3564825057983398
Epoch: 15, Steps: 9 | Train Loss: 0.156 Vali Loss: 1.103 Vali Acc: 0.478 Test Loss: 1.103 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5013353824615479
Epoch: 16, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.113 Vali Acc: 0.507 Test Loss: 1.113 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2184417247772217
Epoch: 17, Steps: 9 | Train Loss: 0.113 Vali Loss: 1.097 Vali Acc: 0.529 Test Loss: 1.097 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528975).  Saving model ...
Epoch: 18 cost time: 1.1910879611968994
Epoch: 18, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.081 Vali Acc: 0.514 Test Loss: 1.081 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1121039390563965
Epoch: 19, Steps: 9 | Train Loss: 0.078 Vali Loss: 1.118 Vali Acc: 0.507 Test Loss: 1.118 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5133967399597168
Epoch: 20, Steps: 9 | Train Loss: 0.061 Vali Loss: 1.109 Vali Acc: 0.543 Test Loss: 1.109 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543467).  Saving model ...
Epoch: 21 cost time: 1.3505973815917969
Epoch: 21, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.106 Vali Acc: 0.529 Test Loss: 1.106 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.390894889831543
Epoch: 22, Steps: 9 | Train Loss: 0.042 Vali Loss: 1.109 Vali Acc: 0.543 Test Loss: 1.109 Test Acc: 0.543
Validation loss decreased (-0.543467 --> -0.543467).  Saving model ...
Epoch: 23 cost time: 1.3988945484161377
Epoch: 23, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.096 Vali Acc: 0.543 Test Loss: 1.096 Test Acc: 0.543
Validation loss decreased (-0.543467 --> -0.543467).  Saving model ...
Epoch: 24 cost time: 1.2631499767303467
Epoch: 24, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.113 Vali Acc: 0.536 Test Loss: 1.113 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5588269233703613
Epoch: 25, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.133 Vali Acc: 0.514 Test Loss: 1.133 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3026971817016602
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.106 Vali Acc: 0.529 Test Loss: 1.106 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5123209953308105
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4352421760559082
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.115 Vali Acc: 0.529 Test Loss: 1.115 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2982025146484375
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.125 Vali Acc: 0.529 Test Loss: 1.125 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.197486162185669
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2347280979156494
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.119 Vali Acc: 0.522 Test Loss: 1.119 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1558935642242432
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.126 Vali Acc: 0.522 Test Loss: 1.126 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6374518871307373
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.131 Vali Acc: 0.529 Test Loss: 1.131 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5434782608695652
model parameter : 436058
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1299407482147217
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.403 Vali Acc: 0.319 Test Loss: 1.403 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.9888966083526611
Epoch: 2, Steps: 9 | Train Loss: 1.264 Vali Loss: 1.294 Vali Acc: 0.384 Test Loss: 1.294 Test Acc: 0.384
Validation loss decreased (-0.318827 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.097501516342163
Epoch: 3, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.214 Vali Acc: 0.464 Test Loss: 1.214 Test Acc: 0.464
Validation loss decreased (-0.384045 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 1.2286629676818848
Epoch: 4, Steps: 9 | Train Loss: 0.904 Vali Loss: 1.145 Vali Acc: 0.514 Test Loss: 1.145 Test Acc: 0.514
Validation loss decreased (-0.463756 --> -0.514481).  Saving model ...
Epoch: 5 cost time: 1.003126621246338
Epoch: 5, Steps: 9 | Train Loss: 0.752 Vali Loss: 1.106 Vali Acc: 0.543 Test Loss: 1.106 Test Acc: 0.543
Validation loss decreased (-0.514481 --> -0.543467).  Saving model ...
Epoch: 6 cost time: 1.031933069229126
Epoch: 6, Steps: 9 | Train Loss: 0.643 Vali Loss: 1.087 Vali Acc: 0.543 Test Loss: 1.087 Test Acc: 0.543
Validation loss decreased (-0.543467 --> -0.543467).  Saving model ...
Epoch: 7 cost time: 0.7797832489013672
Epoch: 7, Steps: 9 | Train Loss: 0.534 Vali Loss: 1.074 Vali Acc: 0.558 Test Loss: 1.074 Test Acc: 0.558
Validation loss decreased (-0.543467 --> -0.557960).  Saving model ...
Epoch: 8 cost time: 0.9317584037780762
Epoch: 8, Steps: 9 | Train Loss: 0.433 Vali Loss: 1.067 Vali Acc: 0.558 Test Loss: 1.067 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 9 cost time: 0.9465045928955078
Epoch: 9, Steps: 9 | Train Loss: 0.350 Vali Loss: 1.067 Vali Acc: 0.565 Test Loss: 1.067 Test Acc: 0.565
Validation loss decreased (-0.557960 --> -0.565207).  Saving model ...
Epoch: 10 cost time: 1.2540910243988037
Epoch: 10, Steps: 9 | Train Loss: 0.280 Vali Loss: 1.041 Vali Acc: 0.594 Test Loss: 1.041 Test Acc: 0.594
Validation loss decreased (-0.565207 --> -0.594192).  Saving model ...
Epoch: 11 cost time: 1.112455129623413
Epoch: 11, Steps: 9 | Train Loss: 0.223 Vali Loss: 1.042 Vali Acc: 0.565 Test Loss: 1.042 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9971096515655518
Epoch: 12, Steps: 9 | Train Loss: 0.179 Vali Loss: 1.036 Vali Acc: 0.580 Test Loss: 1.036 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4692919254302979
Epoch: 13, Steps: 9 | Train Loss: 0.133 Vali Loss: 1.045 Vali Acc: 0.587 Test Loss: 1.045 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8561937808990479
Epoch: 14, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.064 Vali Acc: 0.543 Test Loss: 1.064 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1456139087677002
Epoch: 15, Steps: 9 | Train Loss: 0.087 Vali Loss: 1.041 Vali Acc: 0.572 Test Loss: 1.041 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0302233695983887
Epoch: 16, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.034 Vali Acc: 0.565 Test Loss: 1.034 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2821803092956543
Epoch: 17, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.048 Vali Acc: 0.594 Test Loss: 1.048 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2377214431762695
Epoch: 18, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.040 Vali Acc: 0.594 Test Loss: 1.040 Test Acc: 0.594
Validation loss decreased (-0.594192 --> -0.594192).  Saving model ...
Epoch: 19 cost time: 1.2962403297424316
Epoch: 19, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0015969276428223
Epoch: 20, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.065 Vali Acc: 0.565 Test Loss: 1.065 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2189264297485352
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.047 Vali Acc: 0.601 Test Loss: 1.047 Test Acc: 0.601
Validation loss decreased (-0.594192 --> -0.601439).  Saving model ...
Epoch: 22 cost time: 0.9082441329956055
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.049 Vali Acc: 0.580 Test Loss: 1.049 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0988645553588867
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.050 Vali Acc: 0.580 Test Loss: 1.050 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9565904140472412
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.062 Vali Acc: 0.580 Test Loss: 1.062 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1452207565307617
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2979929447174072
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.064 Vali Acc: 0.580 Test Loss: 1.064 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4070725440979004
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.060 Vali Acc: 0.594 Test Loss: 1.060 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3875956535339355
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.060 Vali Acc: 0.601 Test Loss: 1.060 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1721282005310059
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.063 Vali Acc: 0.594 Test Loss: 1.063 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1631996631622314
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.065 Vali Acc: 0.601 Test Loss: 1.065 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0446431636810303
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.069 Vali Acc: 0.572 Test Loss: 1.069 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6014492753623188
model parameter : 431962
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3153250217437744
Epoch: 1, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.353 Vali Acc: 0.333 Test Loss: 1.353 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.1000425815582275
Epoch: 2, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.298 Vali Acc: 0.377 Test Loss: 1.298 Test Acc: 0.377
Validation loss decreased (-0.333320 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 1.1441524028778076
Epoch: 3, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.226 Vali Acc: 0.478 Test Loss: 1.226 Test Acc: 0.478
Validation loss decreased (-0.376799 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 1.0594673156738281
Epoch: 4, Steps: 9 | Train Loss: 0.843 Vali Loss: 1.187 Vali Acc: 0.471 Test Loss: 1.187 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1628689765930176
Epoch: 5, Steps: 9 | Train Loss: 0.700 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.478249 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.0136799812316895
Epoch: 6, Steps: 9 | Train Loss: 0.603 Vali Loss: 1.147 Vali Acc: 0.493 Test Loss: 1.147 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1364686489105225
Epoch: 7, Steps: 9 | Train Loss: 0.495 Vali Loss: 1.100 Vali Acc: 0.558 Test Loss: 1.100 Test Acc: 0.558
Validation loss decreased (-0.499988 --> -0.557960).  Saving model ...
Epoch: 8 cost time: 0.7847657203674316
Epoch: 8, Steps: 9 | Train Loss: 0.403 Vali Loss: 1.084 Vali Acc: 0.551 Test Loss: 1.084 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0964007377624512
Epoch: 9, Steps: 9 | Train Loss: 0.327 Vali Loss: 1.081 Vali Acc: 0.536 Test Loss: 1.081 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0916171073913574
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 1.071 Vali Acc: 0.551 Test Loss: 1.071 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1508307456970215
Epoch: 11, Steps: 9 | Train Loss: 0.207 Vali Loss: 1.053 Vali Acc: 0.565 Test Loss: 1.053 Test Acc: 0.565
Validation loss decreased (-0.557960 --> -0.565207).  Saving model ...
Epoch: 12 cost time: 1.1138417720794678
Epoch: 12, Steps: 9 | Train Loss: 0.154 Vali Loss: 1.039 Vali Acc: 0.565 Test Loss: 1.039 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565207).  Saving model ...
Epoch: 13 cost time: 0.9522721767425537
Epoch: 13, Steps: 9 | Train Loss: 0.123 Vali Loss: 1.030 Vali Acc: 0.565 Test Loss: 1.030 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565207).  Saving model ...
Epoch: 14 cost time: 1.0678884983062744
Epoch: 14, Steps: 9 | Train Loss: 0.095 Vali Loss: 1.061 Vali Acc: 0.543 Test Loss: 1.061 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0465419292449951
Epoch: 15, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.035 Vali Acc: 0.558 Test Loss: 1.035 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0483295917510986
Epoch: 16, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.039 Vali Acc: 0.529 Test Loss: 1.039 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1832201480865479
Epoch: 17, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.036 Vali Acc: 0.529 Test Loss: 1.036 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2150225639343262
Epoch: 18, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.042 Vali Acc: 0.529 Test Loss: 1.042 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8574962615966797
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.039 Vali Acc: 0.551 Test Loss: 1.039 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.245190143585205
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.033 Vali Acc: 0.551 Test Loss: 1.033 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.911780834197998
Epoch: 21, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.045 Vali Acc: 0.551 Test Loss: 1.045 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0592055320739746
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.061 Vali Acc: 0.543 Test Loss: 1.061 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.185173749923706
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.049 Vali Acc: 0.558 Test Loss: 1.049 Test Acc: 0.558
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 429914
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.875765800476074
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.377 Vali Acc: 0.290 Test Loss: 1.377 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.3494107723236084
Epoch: 2, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.299 Vali Acc: 0.326 Test Loss: 1.299 Test Acc: 0.326
Validation loss decreased (-0.289841 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 1.0677142143249512
Epoch: 3, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.227 Vali Acc: 0.442 Test Loss: 1.227 Test Acc: 0.442
Validation loss decreased (-0.326074 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 1.1535272598266602
Epoch: 4, Steps: 9 | Train Loss: 0.856 Vali Loss: 1.168 Vali Acc: 0.449 Test Loss: 1.168 Test Acc: 0.449
Validation loss decreased (-0.442017 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 0.8859267234802246
Epoch: 5, Steps: 9 | Train Loss: 0.710 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.449264 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.8095238208770752
Epoch: 6, Steps: 9 | Train Loss: 0.564 Vali Loss: 1.116 Vali Acc: 0.522 Test Loss: 1.116 Test Acc: 0.522
Validation loss decreased (-0.499989 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 0.9098618030548096
Epoch: 7, Steps: 9 | Train Loss: 0.449 Vali Loss: 1.086 Vali Acc: 0.522 Test Loss: 1.086 Test Acc: 0.522
Validation loss decreased (-0.521728 --> -0.521728).  Saving model ...
Epoch: 8 cost time: 0.9354407787322998
Epoch: 8, Steps: 9 | Train Loss: 0.359 Vali Loss: 1.082 Vali Acc: 0.558 Test Loss: 1.082 Test Acc: 0.558
Validation loss decreased (-0.521728 --> -0.557960).  Saving model ...
Epoch: 9 cost time: 0.8247952461242676
Epoch: 9, Steps: 9 | Train Loss: 0.286 Vali Loss: 1.069 Vali Acc: 0.536 Test Loss: 1.069 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.021162748336792
Epoch: 10, Steps: 9 | Train Loss: 0.215 Vali Loss: 1.056 Vali Acc: 0.558 Test Loss: 1.056 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 11 cost time: 0.8158648014068604
Epoch: 11, Steps: 9 | Train Loss: 0.171 Vali Loss: 1.057 Vali Acc: 0.565 Test Loss: 1.057 Test Acc: 0.565
Validation loss decreased (-0.557960 --> -0.565207).  Saving model ...
Epoch: 12 cost time: 1.049112319946289
Epoch: 12, Steps: 9 | Train Loss: 0.136 Vali Loss: 1.056 Vali Acc: 0.587 Test Loss: 1.056 Test Acc: 0.587
Validation loss decreased (-0.565207 --> -0.586946).  Saving model ...
Epoch: 13 cost time: 1.229623556137085
Epoch: 13, Steps: 9 | Train Loss: 0.099 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9824469089508057
Epoch: 14, Steps: 9 | Train Loss: 0.078 Vali Loss: 1.071 Vali Acc: 0.587 Test Loss: 1.071 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2968976497650146
Epoch: 15, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.083 Vali Acc: 0.572 Test Loss: 1.083 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9317295551300049
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.067 Vali Acc: 0.565 Test Loss: 1.067 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8915657997131348
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.089 Vali Acc: 0.565 Test Loss: 1.089 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9139394760131836
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.077 Vali Acc: 0.565 Test Loss: 1.077 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3047130107879639
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.091 Vali Acc: 0.551 Test Loss: 1.091 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1361873149871826
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.083 Vali Acc: 0.558 Test Loss: 1.083 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2049810886383057
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.091 Vali Acc: 0.565 Test Loss: 1.091 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8819069862365723
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.107 Vali Acc: 0.551 Test Loss: 1.107 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5869565217391305
model parameter : 427866
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.977412700653076
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.422 Vali Acc: 0.239 Test Loss: 1.422 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 0.8301787376403809
Epoch: 2, Steps: 9 | Train Loss: 1.260 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
Validation loss decreased (-0.239116 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.7798378467559814
Epoch: 3, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.253 Vali Acc: 0.413 Test Loss: 1.253 Test Acc: 0.413
Validation loss decreased (-0.333320 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 0.7833020687103271
Epoch: 4, Steps: 9 | Train Loss: 0.876 Vali Loss: 1.222 Vali Acc: 0.435 Test Loss: 1.222 Test Acc: 0.435
Validation loss decreased (-0.413031 --> -0.434770).  Saving model ...
Epoch: 5 cost time: 0.8730268478393555
Epoch: 5, Steps: 9 | Train Loss: 0.721 Vali Loss: 1.154 Vali Acc: 0.529 Test Loss: 1.154 Test Acc: 0.529
Validation loss decreased (-0.434770 --> -0.528974).  Saving model ...
Epoch: 6 cost time: 0.8069519996643066
Epoch: 6, Steps: 9 | Train Loss: 0.589 Vali Loss: 1.138 Vali Acc: 0.493 Test Loss: 1.138 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0328235626220703
Epoch: 7, Steps: 9 | Train Loss: 0.469 Vali Loss: 1.119 Vali Acc: 0.565 Test Loss: 1.119 Test Acc: 0.565
Validation loss decreased (-0.528974 --> -0.565206).  Saving model ...
Epoch: 8 cost time: 0.9749269485473633
Epoch: 8, Steps: 9 | Train Loss: 0.384 Vali Loss: 1.115 Vali Acc: 0.536 Test Loss: 1.115 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.917144775390625
Epoch: 9, Steps: 9 | Train Loss: 0.282 Vali Loss: 1.100 Vali Acc: 0.536 Test Loss: 1.100 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0265557765960693
Epoch: 10, Steps: 9 | Train Loss: 0.221 Vali Loss: 1.104 Vali Acc: 0.558 Test Loss: 1.104 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8048503398895264
Epoch: 11, Steps: 9 | Train Loss: 0.164 Vali Loss: 1.127 Vali Acc: 0.558 Test Loss: 1.127 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9553804397583008
Epoch: 12, Steps: 9 | Train Loss: 0.120 Vali Loss: 1.110 Vali Acc: 0.572 Test Loss: 1.110 Test Acc: 0.572
Validation loss decreased (-0.565206 --> -0.572453).  Saving model ...
Epoch: 13 cost time: 0.8212485313415527
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.126 Vali Acc: 0.580 Test Loss: 1.126 Test Acc: 0.580
Validation loss decreased (-0.572453 --> -0.579699).  Saving model ...
Epoch: 14 cost time: 0.9858262538909912
Epoch: 14, Steps: 9 | Train Loss: 0.059 Vali Loss: 1.122 Vali Acc: 0.558 Test Loss: 1.122 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.919957160949707
Epoch: 15, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.163 Vali Acc: 0.565 Test Loss: 1.163 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0199193954467773
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.123 Vali Acc: 0.543 Test Loss: 1.123 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.942131519317627
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.163 Vali Acc: 0.543 Test Loss: 1.163 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0215258598327637
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.173 Vali Acc: 0.551 Test Loss: 1.173 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0106010437011719
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.154 Vali Acc: 0.565 Test Loss: 1.154 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8419477939605713
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.185 Vali Acc: 0.565 Test Loss: 1.185 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8246872425079346
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.186 Vali Acc: 0.551 Test Loss: 1.186 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9222986698150635
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.190 Vali Acc: 0.558 Test Loss: 1.190 Test Acc: 0.558
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8208823204040527
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.197 Vali Acc: 0.551 Test Loss: 1.197 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 425818
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7754600048065186
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.427 Vali Acc: 0.239 Test Loss: 1.427 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.6081757545471191
Epoch: 2, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.397 Vali Acc: 0.261 Test Loss: 1.397 Test Acc: 0.261
Validation loss decreased (-0.239116 --> -0.260856).  Saving model ...
Epoch: 3 cost time: 1.8958804607391357
Epoch: 3, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.363 Vali Acc: 0.290 Test Loss: 1.363 Test Acc: 0.290
Validation loss decreased (-0.260856 --> -0.289841).  Saving model ...
Epoch: 4 cost time: 1.5762569904327393
Epoch: 4, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.329 Vali Acc: 0.384 Test Loss: 1.329 Test Acc: 0.384
Validation loss decreased (-0.289841 --> -0.384045).  Saving model ...
Epoch: 5 cost time: 1.6503727436065674
Epoch: 5, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.300 Vali Acc: 0.442 Test Loss: 1.300 Test Acc: 0.442
Validation loss decreased (-0.384045 --> -0.442016).  Saving model ...
Epoch: 6 cost time: 1.573193073272705
Epoch: 6, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.276 Vali Acc: 0.457 Test Loss: 1.276 Test Acc: 0.457
Validation loss decreased (-0.442016 --> -0.456509).  Saving model ...
Epoch: 7 cost time: 2.001270055770874
Epoch: 7, Steps: 9 | Train Loss: 1.114 Vali Loss: 1.253 Vali Acc: 0.507 Test Loss: 1.253 Test Acc: 0.507
Validation loss decreased (-0.456509 --> -0.507234).  Saving model ...
Epoch: 8 cost time: 2.205544948577881
Epoch: 8, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.233 Vali Acc: 0.529 Test Loss: 1.233 Test Acc: 0.529
Validation loss decreased (-0.507234 --> -0.528973).  Saving model ...
Epoch: 9 cost time: 2.3135313987731934
Epoch: 9, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.216 Vali Acc: 0.522 Test Loss: 1.216 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3138809204101562
Epoch: 10, Steps: 9 | Train Loss: 0.967 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9228131771087646
Epoch: 11, Steps: 9 | Train Loss: 0.915 Vali Loss: 1.179 Vali Acc: 0.507 Test Loss: 1.179 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.093698024749756
Epoch: 12, Steps: 9 | Train Loss: 0.858 Vali Loss: 1.164 Vali Acc: 0.507 Test Loss: 1.164 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9322569370269775
Epoch: 13, Steps: 9 | Train Loss: 0.814 Vali Loss: 1.156 Vali Acc: 0.529 Test Loss: 1.156 Test Acc: 0.529
Validation loss decreased (-0.528973 --> -0.528974).  Saving model ...
Epoch: 14 cost time: 1.7011163234710693
Epoch: 14, Steps: 9 | Train Loss: 0.764 Vali Loss: 1.144 Vali Acc: 0.529 Test Loss: 1.144 Test Acc: 0.529
Validation loss decreased (-0.528974 --> -0.528974).  Saving model ...
Epoch: 15 cost time: 2.0831034183502197
Epoch: 15, Steps: 9 | Train Loss: 0.745 Vali Loss: 1.136 Vali Acc: 0.522 Test Loss: 1.136 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8890235424041748
Epoch: 16, Steps: 9 | Train Loss: 0.699 Vali Loss: 1.121 Vali Acc: 0.522 Test Loss: 1.121 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.220507860183716
Epoch: 17, Steps: 9 | Train Loss: 0.659 Vali Loss: 1.109 Vali Acc: 0.543 Test Loss: 1.109 Test Acc: 0.543
Validation loss decreased (-0.528974 --> -0.543467).  Saving model ...
Epoch: 18 cost time: 1.975776195526123
Epoch: 18, Steps: 9 | Train Loss: 0.610 Vali Loss: 1.098 Vali Acc: 0.529 Test Loss: 1.098 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0262036323547363
Epoch: 19, Steps: 9 | Train Loss: 0.561 Vali Loss: 1.089 Vali Acc: 0.536 Test Loss: 1.089 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3048903942108154
Epoch: 20, Steps: 9 | Train Loss: 0.529 Vali Loss: 1.087 Vali Acc: 0.486 Test Loss: 1.087 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.11055850982666
Epoch: 21, Steps: 9 | Train Loss: 0.491 Vali Loss: 1.086 Vali Acc: 0.514 Test Loss: 1.086 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1533570289611816
Epoch: 22, Steps: 9 | Train Loss: 0.450 Vali Loss: 1.085 Vali Acc: 0.486 Test Loss: 1.085 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8666889667510986
Epoch: 23, Steps: 9 | Train Loss: 0.407 Vali Loss: 1.066 Vali Acc: 0.500 Test Loss: 1.066 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.196448564529419
Epoch: 24, Steps: 9 | Train Loss: 0.377 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.083026647567749
Epoch: 25, Steps: 9 | Train Loss: 0.352 Vali Loss: 1.059 Vali Acc: 0.478 Test Loss: 1.059 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0399720668792725
Epoch: 26, Steps: 9 | Train Loss: 0.319 Vali Loss: 1.059 Vali Acc: 0.522 Test Loss: 1.059 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.927187204360962
Epoch: 27, Steps: 9 | Train Loss: 0.289 Vali Loss: 1.050 Vali Acc: 0.507 Test Loss: 1.050 Test Acc: 0.507
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5434782608695652
model parameter : 227196
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6466805934906006
Epoch: 1, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.440 Vali Acc: 0.239 Test Loss: 1.440 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 1.73447847366333
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.417 Vali Acc: 0.254 Test Loss: 1.417 Test Acc: 0.254
Validation loss decreased (-0.239116 --> -0.253609).  Saving model ...
Epoch: 3 cost time: 1.4990389347076416
Epoch: 3, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.388 Vali Acc: 0.297 Test Loss: 1.388 Test Acc: 0.297
Validation loss decreased (-0.253609 --> -0.297088).  Saving model ...
Epoch: 4 cost time: 1.8565387725830078
Epoch: 4, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.360 Vali Acc: 0.319 Test Loss: 1.360 Test Acc: 0.319
Validation loss decreased (-0.297088 --> -0.318827).  Saving model ...
Epoch: 5 cost time: 2.067471981048584
Epoch: 5, Steps: 9 | Train Loss: 1.148 Vali Loss: 1.331 Vali Acc: 0.326 Test Loss: 1.331 Test Acc: 0.326
Validation loss decreased (-0.318827 --> -0.326074).  Saving model ...
Epoch: 6 cost time: 2.044471025466919
Epoch: 6, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.309 Vali Acc: 0.326 Test Loss: 1.309 Test Acc: 0.326
Validation loss decreased (-0.326074 --> -0.326074).  Saving model ...
Epoch: 7 cost time: 2.0241096019744873
Epoch: 7, Steps: 9 | Train Loss: 1.021 Vali Loss: 1.289 Vali Acc: 0.341 Test Loss: 1.289 Test Acc: 0.341
Validation loss decreased (-0.326074 --> -0.340567).  Saving model ...
Epoch: 8 cost time: 1.4670209884643555
Epoch: 8, Steps: 9 | Train Loss: 0.966 Vali Loss: 1.271 Vali Acc: 0.312 Test Loss: 1.271 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.495298147201538
Epoch: 9, Steps: 9 | Train Loss: 0.909 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4987549781799316
Epoch: 10, Steps: 9 | Train Loss: 0.843 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8216729164123535
Epoch: 11, Steps: 9 | Train Loss: 0.787 Vali Loss: 1.216 Vali Acc: 0.348 Test Loss: 1.216 Test Acc: 0.348
Validation loss decreased (-0.340567 --> -0.347814).  Saving model ...
Epoch: 12 cost time: 1.8327996730804443
Epoch: 12, Steps: 9 | Train Loss: 0.759 Vali Loss: 1.207 Vali Acc: 0.348 Test Loss: 1.207 Test Acc: 0.348
Validation loss decreased (-0.347814 --> -0.347814).  Saving model ...
Epoch: 13 cost time: 1.6624794006347656
Epoch: 13, Steps: 9 | Train Loss: 0.687 Vali Loss: 1.189 Vali Acc: 0.377 Test Loss: 1.189 Test Acc: 0.377
Validation loss decreased (-0.347814 --> -0.376800).  Saving model ...
Epoch: 14 cost time: 1.7840654850006104
Epoch: 14, Steps: 9 | Train Loss: 0.625 Vali Loss: 1.174 Vali Acc: 0.391 Test Loss: 1.174 Test Acc: 0.391
Validation loss decreased (-0.376800 --> -0.391293).  Saving model ...
Epoch: 15 cost time: 1.7571303844451904
Epoch: 15, Steps: 9 | Train Loss: 0.601 Vali Loss: 1.159 Vali Acc: 0.391 Test Loss: 1.159 Test Acc: 0.391
Validation loss decreased (-0.391293 --> -0.391293).  Saving model ...
Epoch: 16 cost time: 1.7073025703430176
Epoch: 16, Steps: 9 | Train Loss: 0.543 Vali Loss: 1.162 Vali Acc: 0.391 Test Loss: 1.162 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3563344478607178
Epoch: 17, Steps: 9 | Train Loss: 0.498 Vali Loss: 1.148 Vali Acc: 0.399 Test Loss: 1.148 Test Acc: 0.399
Validation loss decreased (-0.391293 --> -0.398539).  Saving model ...
Epoch: 18 cost time: 1.8359222412109375
Epoch: 18, Steps: 9 | Train Loss: 0.458 Vali Loss: 1.135 Vali Acc: 0.420 Test Loss: 1.135 Test Acc: 0.420
Validation loss decreased (-0.398539 --> -0.420279).  Saving model ...
Epoch: 19 cost time: 2.3760855197906494
Epoch: 19, Steps: 9 | Train Loss: 0.429 Vali Loss: 1.125 Vali Acc: 0.435 Test Loss: 1.125 Test Acc: 0.435
Validation loss decreased (-0.420279 --> -0.434771).  Saving model ...
Epoch: 20 cost time: 2.1340291500091553
Epoch: 20, Steps: 9 | Train Loss: 0.382 Vali Loss: 1.110 Vali Acc: 0.457 Test Loss: 1.110 Test Acc: 0.457
Validation loss decreased (-0.434771 --> -0.456511).  Saving model ...
Epoch: 21 cost time: 2.0239615440368652
Epoch: 21, Steps: 9 | Train Loss: 0.349 Vali Loss: 1.099 Vali Acc: 0.442 Test Loss: 1.099 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2946693897247314
Epoch: 22, Steps: 9 | Train Loss: 0.328 Vali Loss: 1.101 Vali Acc: 0.449 Test Loss: 1.101 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2851433753967285
Epoch: 23, Steps: 9 | Train Loss: 0.289 Vali Loss: 1.090 Vali Acc: 0.493 Test Loss: 1.090 Test Acc: 0.493
Validation loss decreased (-0.456511 --> -0.492743).  Saving model ...
Epoch: 24 cost time: 1.9288265705108643
Epoch: 24, Steps: 9 | Train Loss: 0.263 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
Validation loss decreased (-0.492743 --> -0.499989).  Saving model ...
Epoch: 25 cost time: 2.475248336791992
Epoch: 25, Steps: 9 | Train Loss: 0.234 Vali Loss: 1.080 Vali Acc: 0.507 Test Loss: 1.080 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.507236).  Saving model ...
Epoch: 26 cost time: 1.9827048778533936
Epoch: 26, Steps: 9 | Train Loss: 0.215 Vali Loss: 1.082 Vali Acc: 0.500 Test Loss: 1.082 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8534677028656006
Epoch: 27, Steps: 9 | Train Loss: 0.187 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1174821853637695
Epoch: 28, Steps: 9 | Train Loss: 0.177 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9376845359802246
Epoch: 29, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.085 Vali Acc: 0.522 Test Loss: 1.085 Test Acc: 0.522
Validation loss decreased (-0.507236 --> -0.521728).  Saving model ...
Epoch: 30 cost time: 1.874314785003662
Epoch: 30, Steps: 9 | Train Loss: 0.147 Vali Loss: 1.082 Vali Acc: 0.500 Test Loss: 1.082 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1267831325531006
Epoch: 31, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3294668197631836
Epoch: 32, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.087 Vali Acc: 0.493 Test Loss: 1.087 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.1517932415008545
Epoch: 33, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.883812665939331
Epoch: 34, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.086 Vali Acc: 0.486 Test Loss: 1.086 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2542166709899902
Epoch: 35, Steps: 9 | Train Loss: 0.089 Vali Loss: 1.083 Vali Acc: 0.507 Test Loss: 1.083 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0136072635650635
Epoch: 36, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.086 Vali Acc: 0.507 Test Loss: 1.086 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.2509896755218506
Epoch: 37, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.097 Vali Acc: 0.514 Test Loss: 1.097 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.2472054958343506
Epoch: 38, Steps: 9 | Train Loss: 0.071 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.941713571548462
Epoch: 39, Steps: 9 | Train Loss: 0.066 Vali Loss: 1.104 Vali Acc: 0.522 Test Loss: 1.104 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5217391304347826
model parameter : 224636
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.539401054382324
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.401 Vali Acc: 0.261 Test Loss: 1.401 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.5228660106658936
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.363 Vali Acc: 0.326 Test Loss: 1.363 Test Acc: 0.326
Validation loss decreased (-0.260856 --> -0.326073).  Saving model ...
Epoch: 3 cost time: 1.6597707271575928
Epoch: 3, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.321 Vali Acc: 0.391 Test Loss: 1.321 Test Acc: 0.391
Validation loss decreased (-0.326073 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 1.8368322849273682
Epoch: 4, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
Validation loss decreased (-0.391291 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.4651741981506348
Epoch: 5, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.241 Vali Acc: 0.507 Test Loss: 1.241 Test Acc: 0.507
Validation loss decreased (-0.499987 --> -0.507234).  Saving model ...
Epoch: 6 cost time: 1.8322811126708984
Epoch: 6, Steps: 9 | Train Loss: 1.074 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
Validation loss decreased (-0.507234 --> -0.514481).  Saving model ...
Epoch: 7 cost time: 1.8018810749053955
Epoch: 7, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.183 Vali Acc: 0.529 Test Loss: 1.183 Test Acc: 0.529
Validation loss decreased (-0.514481 --> -0.528974).  Saving model ...
Epoch: 8 cost time: 1.6905834674835205
Epoch: 8, Steps: 9 | Train Loss: 0.941 Vali Loss: 1.158 Vali Acc: 0.551 Test Loss: 1.158 Test Acc: 0.551
Validation loss decreased (-0.528974 --> -0.550713).  Saving model ...
Epoch: 9 cost time: 1.7185728549957275
Epoch: 9, Steps: 9 | Train Loss: 0.890 Vali Loss: 1.140 Vali Acc: 0.536 Test Loss: 1.140 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5373945236206055
Epoch: 10, Steps: 9 | Train Loss: 0.829 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.688291072845459
Epoch: 11, Steps: 9 | Train Loss: 0.781 Vali Loss: 1.117 Vali Acc: 0.529 Test Loss: 1.117 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4184000492095947
Epoch: 12, Steps: 9 | Train Loss: 0.745 Vali Loss: 1.101 Vali Acc: 0.565 Test Loss: 1.101 Test Acc: 0.565
Validation loss decreased (-0.550713 --> -0.565206).  Saving model ...
Epoch: 13 cost time: 1.6388020515441895
Epoch: 13, Steps: 9 | Train Loss: 0.667 Vali Loss: 1.084 Vali Acc: 0.572 Test Loss: 1.084 Test Acc: 0.572
Validation loss decreased (-0.565206 --> -0.572453).  Saving model ...
Epoch: 14 cost time: 1.5409159660339355
Epoch: 14, Steps: 9 | Train Loss: 0.629 Vali Loss: 1.075 Vali Acc: 0.572 Test Loss: 1.075 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 15 cost time: 1.6551165580749512
Epoch: 15, Steps: 9 | Train Loss: 0.585 Vali Loss: 1.065 Vali Acc: 0.580 Test Loss: 1.065 Test Acc: 0.580
Validation loss decreased (-0.572453 --> -0.579699).  Saving model ...
Epoch: 16 cost time: 1.7605633735656738
Epoch: 16, Steps: 9 | Train Loss: 0.547 Vali Loss: 1.052 Vali Acc: 0.580 Test Loss: 1.052 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579700).  Saving model ...
Epoch: 17 cost time: 1.7800650596618652
Epoch: 17, Steps: 9 | Train Loss: 0.518 Vali Loss: 1.045 Vali Acc: 0.572 Test Loss: 1.045 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4119701385498047
Epoch: 18, Steps: 9 | Train Loss: 0.457 Vali Loss: 1.034 Vali Acc: 0.594 Test Loss: 1.034 Test Acc: 0.594
Validation loss decreased (-0.579700 --> -0.594193).  Saving model ...
Epoch: 19 cost time: 1.514502763748169
Epoch: 19, Steps: 9 | Train Loss: 0.436 Vali Loss: 1.025 Vali Acc: 0.601 Test Loss: 1.025 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601439).  Saving model ...
Epoch: 20 cost time: 1.8610155582427979
Epoch: 20, Steps: 9 | Train Loss: 0.397 Vali Loss: 1.015 Vali Acc: 0.616 Test Loss: 1.015 Test Acc: 0.616
Validation loss decreased (-0.601439 --> -0.615932).  Saving model ...
Epoch: 21 cost time: 1.7722957134246826
Epoch: 21, Steps: 9 | Train Loss: 0.362 Vali Loss: 1.008 Vali Acc: 0.609 Test Loss: 1.008 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6103506088256836
Epoch: 22, Steps: 9 | Train Loss: 0.325 Vali Loss: 1.005 Vali Acc: 0.609 Test Loss: 1.005 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.676612377166748
Epoch: 23, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.997 Vali Acc: 0.609 Test Loss: 0.997 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7872905731201172
Epoch: 24, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.989 Vali Acc: 0.609 Test Loss: 0.989 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6507062911987305
Epoch: 25, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.979 Vali Acc: 0.630 Test Loss: 0.979 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 26 cost time: 1.6363537311553955
Epoch: 26, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.977 Vali Acc: 0.623 Test Loss: 0.977 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8311316967010498
Epoch: 27, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.977 Vali Acc: 0.616 Test Loss: 0.977 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7350032329559326
Epoch: 28, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.968 Vali Acc: 0.616 Test Loss: 0.968 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5247936248779297
Epoch: 29, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.970 Vali Acc: 0.609 Test Loss: 0.970 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4997684955596924
Epoch: 30, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.959 Vali Acc: 0.616 Test Loss: 0.959 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.681063175201416
Epoch: 31, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.969 Vali Acc: 0.601 Test Loss: 0.969 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5271754264831543
Epoch: 32, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.971 Vali Acc: 0.623 Test Loss: 0.971 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4950518608093262
Epoch: 33, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.965 Vali Acc: 0.616 Test Loss: 0.965 Test Acc: 0.616
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3398246765136719
Epoch: 34, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.962 Vali Acc: 0.616 Test Loss: 0.962 Test Acc: 0.616
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6499390602111816
Epoch: 35, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.973 Vali Acc: 0.594 Test Loss: 0.973 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6304347826086957
model parameter : 222076
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.344503402709961
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.427 Vali Acc: 0.246 Test Loss: 1.427 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.3472929000854492
Epoch: 2, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.402 Vali Acc: 0.290 Test Loss: 1.402 Test Acc: 0.290
Validation loss decreased (-0.246363 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 1.2917425632476807
Epoch: 3, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.370 Vali Acc: 0.333 Test Loss: 1.370 Test Acc: 0.333
Validation loss decreased (-0.289841 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 1.4838612079620361
Epoch: 4, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.340 Vali Acc: 0.370 Test Loss: 1.340 Test Acc: 0.370
Validation loss decreased (-0.333320 --> -0.369552).  Saving model ...
Epoch: 5 cost time: 1.1607961654663086
Epoch: 5, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.314 Vali Acc: 0.370 Test Loss: 1.314 Test Acc: 0.370
Validation loss decreased (-0.369552 --> -0.369552).  Saving model ...
Epoch: 6 cost time: 1.5286378860473633
Epoch: 6, Steps: 9 | Train Loss: 1.168 Vali Loss: 1.288 Vali Acc: 0.399 Test Loss: 1.288 Test Acc: 0.399
Validation loss decreased (-0.369552 --> -0.398538).  Saving model ...
Epoch: 7 cost time: 1.3865318298339844
Epoch: 7, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.265 Vali Acc: 0.377 Test Loss: 1.265 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6094589233398438
Epoch: 8, Steps: 9 | Train Loss: 1.076 Vali Loss: 1.238 Vali Acc: 0.428 Test Loss: 1.238 Test Acc: 0.428
Validation loss decreased (-0.398538 --> -0.427524).  Saving model ...
Epoch: 9 cost time: 1.5258378982543945
Epoch: 9, Steps: 9 | Train Loss: 1.009 Vali Loss: 1.219 Vali Acc: 0.428 Test Loss: 1.219 Test Acc: 0.428
Validation loss decreased (-0.427524 --> -0.427524).  Saving model ...
Epoch: 10 cost time: 1.549053430557251
Epoch: 10, Steps: 9 | Train Loss: 0.950 Vali Loss: 1.197 Vali Acc: 0.442 Test Loss: 1.197 Test Acc: 0.442
Validation loss decreased (-0.427524 --> -0.442017).  Saving model ...
Epoch: 11 cost time: 1.9179213047027588
Epoch: 11, Steps: 9 | Train Loss: 0.895 Vali Loss: 1.172 Vali Acc: 0.471 Test Loss: 1.172 Test Acc: 0.471
Validation loss decreased (-0.442017 --> -0.471003).  Saving model ...
Epoch: 12 cost time: 1.7516233921051025
Epoch: 12, Steps: 9 | Train Loss: 0.834 Vali Loss: 1.151 Vali Acc: 0.486 Test Loss: 1.151 Test Acc: 0.486
Validation loss decreased (-0.471003 --> -0.485496).  Saving model ...
Epoch: 13 cost time: 1.4874718189239502
Epoch: 13, Steps: 9 | Train Loss: 0.774 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
Validation loss decreased (-0.485496 --> -0.485496).  Saving model ...
Epoch: 14 cost time: 1.56852388381958
Epoch: 14, Steps: 9 | Train Loss: 0.736 Vali Loss: 1.110 Vali Acc: 0.493 Test Loss: 1.110 Test Acc: 0.493
Validation loss decreased (-0.485496 --> -0.492743).  Saving model ...
Epoch: 15 cost time: 1.735840082168579
Epoch: 15, Steps: 9 | Train Loss: 0.689 Vali Loss: 1.085 Vali Acc: 0.543 Test Loss: 1.085 Test Acc: 0.543
Validation loss decreased (-0.492743 --> -0.543467).  Saving model ...
Epoch: 16 cost time: 1.9753344058990479
Epoch: 16, Steps: 9 | Train Loss: 0.631 Vali Loss: 1.063 Vali Acc: 0.558 Test Loss: 1.063 Test Acc: 0.558
Validation loss decreased (-0.543467 --> -0.557960).  Saving model ...
Epoch: 17 cost time: 1.4955530166625977
Epoch: 17, Steps: 9 | Train Loss: 0.583 Vali Loss: 1.046 Vali Acc: 0.587 Test Loss: 1.046 Test Acc: 0.587
Validation loss decreased (-0.557960 --> -0.586946).  Saving model ...
Epoch: 18 cost time: 1.6203117370605469
Epoch: 18, Steps: 9 | Train Loss: 0.545 Vali Loss: 1.030 Vali Acc: 0.580 Test Loss: 1.030 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4495127201080322
Epoch: 19, Steps: 9 | Train Loss: 0.504 Vali Loss: 1.017 Vali Acc: 0.587 Test Loss: 1.017 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586946).  Saving model ...
Epoch: 20 cost time: 1.636829137802124
Epoch: 20, Steps: 9 | Train Loss: 0.469 Vali Loss: 1.010 Vali Acc: 0.594 Test Loss: 1.010 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 21 cost time: 1.602496862411499
Epoch: 21, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.998 Vali Acc: 0.580 Test Loss: 0.998 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.423546314239502
Epoch: 22, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.982 Vali Acc: 0.594 Test Loss: 0.982 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 23 cost time: 1.1671490669250488
Epoch: 23, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.969 Vali Acc: 0.601 Test Loss: 0.969 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601440).  Saving model ...
Epoch: 24 cost time: 1.735037088394165
Epoch: 24, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.959 Vali Acc: 0.594 Test Loss: 0.959 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5103998184204102
Epoch: 25, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.949 Vali Acc: 0.594 Test Loss: 0.949 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8217296600341797
Epoch: 26, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.945 Vali Acc: 0.594 Test Loss: 0.945 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5486423969268799
Epoch: 27, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.926 Vali Acc: 0.601 Test Loss: 0.926 Test Acc: 0.601
Validation loss decreased (-0.601440 --> -0.601440).  Saving model ...
Epoch: 28 cost time: 1.6342527866363525
Epoch: 28, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.913 Vali Acc: 0.609 Test Loss: 0.913 Test Acc: 0.609
Validation loss decreased (-0.601440 --> -0.608687).  Saving model ...
Epoch: 29 cost time: 1.3675241470336914
Epoch: 29, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.909 Vali Acc: 0.616 Test Loss: 0.909 Test Acc: 0.616
Validation loss decreased (-0.608687 --> -0.615933).  Saving model ...
Epoch: 30 cost time: 1.6365363597869873
Epoch: 30, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.916 Vali Acc: 0.623 Test Loss: 0.916 Test Acc: 0.623
Validation loss decreased (-0.615933 --> -0.623179).  Saving model ...
Epoch: 31 cost time: 1.7669179439544678
Epoch: 31, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.920 Vali Acc: 0.609 Test Loss: 0.920 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1852819919586182
Epoch: 32, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.915 Vali Acc: 0.630 Test Loss: 0.915 Test Acc: 0.630
Validation loss decreased (-0.623179 --> -0.630426).  Saving model ...
Epoch: 33 cost time: 1.168945074081421
Epoch: 33, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.913 Vali Acc: 0.623 Test Loss: 0.913 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.633772373199463
Epoch: 34, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.918 Vali Acc: 0.630 Test Loss: 0.918 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0043766498565674
Epoch: 35, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.923 Vali Acc: 0.609 Test Loss: 0.923 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3147225379943848
Epoch: 36, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.928 Vali Acc: 0.638 Test Loss: 0.928 Test Acc: 0.638
Validation loss decreased (-0.630426 --> -0.637672).  Saving model ...
Epoch: 37 cost time: 1.4321115016937256
Epoch: 37, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.930 Vali Acc: 0.630 Test Loss: 0.930 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3334925174713135
Epoch: 38, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.936 Vali Acc: 0.630 Test Loss: 0.936 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6299259662628174
Epoch: 39, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.938 Vali Acc: 0.630 Test Loss: 0.938 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.445122480392456
Epoch: 40, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.946 Vali Acc: 0.638 Test Loss: 0.946 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7431252002716064
Epoch: 41, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.945 Vali Acc: 0.630 Test Loss: 0.945 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4488511085510254
Epoch: 42, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.951 Vali Acc: 0.623 Test Loss: 0.951 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.320030689239502
Epoch: 43, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.946 Vali Acc: 0.623 Test Loss: 0.946 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.256669282913208
Epoch: 44, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.948 Vali Acc: 0.623 Test Loss: 0.948 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.365250587463379
Epoch: 45, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.947 Vali Acc: 0.609 Test Loss: 0.947 Test Acc: 0.609
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.711263656616211
Epoch: 46, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.947 Vali Acc: 0.623 Test Loss: 0.947 Test Acc: 0.623
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6376811594202898
model parameter : 219516
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9261934757232666
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.388 Vali Acc: 0.319 Test Loss: 1.388 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.1898589134216309
Epoch: 2, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.365 Vali Acc: 0.341 Test Loss: 1.365 Test Acc: 0.341
Validation loss decreased (-0.318827 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 1.346297025680542
Epoch: 3, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.340 Vali Acc: 0.362 Test Loss: 1.340 Test Acc: 0.362
Validation loss decreased (-0.340566 --> -0.362305).  Saving model ...
Epoch: 4 cost time: 1.2201013565063477
Epoch: 4, Steps: 9 | Train Loss: 1.257 Vali Loss: 1.316 Vali Acc: 0.391 Test Loss: 1.316 Test Acc: 0.391
Validation loss decreased (-0.362305 --> -0.391291).  Saving model ...
Epoch: 5 cost time: 1.3671092987060547
Epoch: 5, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.291 Vali Acc: 0.420 Test Loss: 1.291 Test Acc: 0.420
Validation loss decreased (-0.391291 --> -0.420277).  Saving model ...
Epoch: 6 cost time: 1.2419605255126953
Epoch: 6, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.267 Vali Acc: 0.435 Test Loss: 1.267 Test Acc: 0.435
Validation loss decreased (-0.420277 --> -0.434770).  Saving model ...
Epoch: 7 cost time: 1.391871452331543
Epoch: 7, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.246 Vali Acc: 0.471 Test Loss: 1.246 Test Acc: 0.471
Validation loss decreased (-0.434770 --> -0.471002).  Saving model ...
Epoch: 8 cost time: 1.1677453517913818
Epoch: 8, Steps: 9 | Train Loss: 1.032 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.471002 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.3350119590759277
Epoch: 9, Steps: 9 | Train Loss: 0.985 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 10 cost time: 1.6269609928131104
Epoch: 10, Steps: 9 | Train Loss: 0.909 Vali Loss: 1.179 Vali Acc: 0.543 Test Loss: 1.179 Test Acc: 0.543
Validation loss decreased (-0.514481 --> -0.543466).  Saving model ...
Epoch: 11 cost time: 1.3439674377441406
Epoch: 11, Steps: 9 | Train Loss: 0.884 Vali Loss: 1.157 Vali Acc: 0.558 Test Loss: 1.157 Test Acc: 0.558
Validation loss decreased (-0.543466 --> -0.557959).  Saving model ...
Epoch: 12 cost time: 1.5094351768493652
Epoch: 12, Steps: 9 | Train Loss: 0.824 Vali Loss: 1.139 Vali Acc: 0.558 Test Loss: 1.139 Test Acc: 0.558
Validation loss decreased (-0.557959 --> -0.557960).  Saving model ...
Epoch: 13 cost time: 1.224353551864624
Epoch: 13, Steps: 9 | Train Loss: 0.774 Vali Loss: 1.118 Vali Acc: 0.565 Test Loss: 1.118 Test Acc: 0.565
Validation loss decreased (-0.557960 --> -0.565206).  Saving model ...
Epoch: 14 cost time: 1.2556126117706299
Epoch: 14, Steps: 9 | Train Loss: 0.715 Vali Loss: 1.093 Vali Acc: 0.565 Test Loss: 1.093 Test Acc: 0.565
Validation loss decreased (-0.565206 --> -0.565206).  Saving model ...
Epoch: 15 cost time: 0.9012773036956787
Epoch: 15, Steps: 9 | Train Loss: 0.670 Vali Loss: 1.075 Vali Acc: 0.587 Test Loss: 1.075 Test Acc: 0.587
Validation loss decreased (-0.565206 --> -0.586946).  Saving model ...
Epoch: 16 cost time: 1.2866456508636475
Epoch: 16, Steps: 9 | Train Loss: 0.622 Vali Loss: 1.066 Vali Acc: 0.587 Test Loss: 1.066 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586946).  Saving model ...
Epoch: 17 cost time: 1.0828437805175781
Epoch: 17, Steps: 9 | Train Loss: 0.580 Vali Loss: 1.051 Vali Acc: 0.587 Test Loss: 1.051 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586946).  Saving model ...
Epoch: 18 cost time: 1.3805859088897705
Epoch: 18, Steps: 9 | Train Loss: 0.533 Vali Loss: 1.038 Vali Acc: 0.609 Test Loss: 1.038 Test Acc: 0.609
Validation loss decreased (-0.586946 --> -0.608685).  Saving model ...
Epoch: 19 cost time: 1.174682378768921
Epoch: 19, Steps: 9 | Train Loss: 0.491 Vali Loss: 1.019 Vali Acc: 0.623 Test Loss: 1.019 Test Acc: 0.623
Validation loss decreased (-0.608685 --> -0.623178).  Saving model ...
Epoch: 20 cost time: 1.3258702754974365
Epoch: 20, Steps: 9 | Train Loss: 0.429 Vali Loss: 1.000 Vali Acc: 0.616 Test Loss: 1.000 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2856159210205078
Epoch: 21, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.991 Vali Acc: 0.594 Test Loss: 0.991 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2857298851013184
Epoch: 22, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.982 Vali Acc: 0.594 Test Loss: 0.982 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1836364269256592
Epoch: 23, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.970 Vali Acc: 0.587 Test Loss: 0.970 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4042513370513916
Epoch: 24, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.969 Vali Acc: 0.587 Test Loss: 0.969 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.260361909866333
Epoch: 25, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.962 Vali Acc: 0.587 Test Loss: 0.962 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.237377643585205
Epoch: 26, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.949 Vali Acc: 0.580 Test Loss: 0.949 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.215623140335083
Epoch: 27, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.939 Vali Acc: 0.587 Test Loss: 0.939 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4853153228759766
Epoch: 28, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.937 Vali Acc: 0.601 Test Loss: 0.937 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1981709003448486
Epoch: 29, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.936 Vali Acc: 0.594 Test Loss: 0.936 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6231884057971014
model parameter : 217468
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8392155170440674
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.373 Vali Acc: 0.283 Test Loss: 1.373 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.166987419128418
Epoch: 2, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.357 Vali Acc: 0.312 Test Loss: 1.357 Test Acc: 0.312
Validation loss decreased (-0.282595 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 1.0402610301971436
Epoch: 3, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.335 Vali Acc: 0.326 Test Loss: 1.335 Test Acc: 0.326
Validation loss decreased (-0.311581 --> -0.326074).  Saving model ...
Epoch: 4 cost time: 1.1835496425628662
Epoch: 4, Steps: 9 | Train Loss: 1.291 Vali Loss: 1.313 Vali Acc: 0.304 Test Loss: 1.313 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.363508939743042
Epoch: 5, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.289 Vali Acc: 0.348 Test Loss: 1.289 Test Acc: 0.348
Validation loss decreased (-0.326074 --> -0.347813).  Saving model ...
Epoch: 6 cost time: 1.1789028644561768
Epoch: 6, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.265 Vali Acc: 0.399 Test Loss: 1.265 Test Acc: 0.399
Validation loss decreased (-0.347813 --> -0.398538).  Saving model ...
Epoch: 7 cost time: 1.513770341873169
Epoch: 7, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.246 Vali Acc: 0.420 Test Loss: 1.246 Test Acc: 0.420
Validation loss decreased (-0.398538 --> -0.420277).  Saving model ...
Epoch: 8 cost time: 1.0037195682525635
Epoch: 8, Steps: 9 | Train Loss: 1.021 Vali Loss: 1.227 Vali Acc: 0.457 Test Loss: 1.227 Test Acc: 0.457
Validation loss decreased (-0.420277 --> -0.456509).  Saving model ...
Epoch: 9 cost time: 1.0848982334136963
Epoch: 9, Steps: 9 | Train Loss: 0.946 Vali Loss: 1.214 Vali Acc: 0.457 Test Loss: 1.214 Test Acc: 0.457
Validation loss decreased (-0.456509 --> -0.456510).  Saving model ...
Epoch: 10 cost time: 1.1452767848968506
Epoch: 10, Steps: 9 | Train Loss: 0.888 Vali Loss: 1.199 Vali Acc: 0.471 Test Loss: 1.199 Test Acc: 0.471
Validation loss decreased (-0.456510 --> -0.471003).  Saving model ...
Epoch: 11 cost time: 0.8983490467071533
Epoch: 11, Steps: 9 | Train Loss: 0.848 Vali Loss: 1.182 Vali Acc: 0.478 Test Loss: 1.182 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478249).  Saving model ...
Epoch: 12 cost time: 1.1044256687164307
Epoch: 12, Steps: 9 | Train Loss: 0.789 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.478249 --> -0.485496).  Saving model ...
Epoch: 13 cost time: 1.1820170879364014
Epoch: 13, Steps: 9 | Train Loss: 0.737 Vali Loss: 1.149 Vali Acc: 0.486 Test Loss: 1.149 Test Acc: 0.486
Validation loss decreased (-0.485496 --> -0.485496).  Saving model ...
Epoch: 14 cost time: 1.3040950298309326
Epoch: 14, Steps: 9 | Train Loss: 0.698 Vali Loss: 1.136 Vali Acc: 0.507 Test Loss: 1.136 Test Acc: 0.507
Validation loss decreased (-0.485496 --> -0.507235).  Saving model ...
Epoch: 15 cost time: 0.9797642230987549
Epoch: 15, Steps: 9 | Train Loss: 0.656 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
Validation loss decreased (-0.507235 --> -0.514482).  Saving model ...
Epoch: 16 cost time: 1.2299346923828125
Epoch: 16, Steps: 9 | Train Loss: 0.606 Vali Loss: 1.110 Vali Acc: 0.514 Test Loss: 1.110 Test Acc: 0.514
Validation loss decreased (-0.514482 --> -0.514482).  Saving model ...
Epoch: 17 cost time: 1.111823558807373
Epoch: 17, Steps: 9 | Train Loss: 0.551 Vali Loss: 1.096 Vali Acc: 0.522 Test Loss: 1.096 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521728).  Saving model ...
Epoch: 18 cost time: 1.2471728324890137
Epoch: 18, Steps: 9 | Train Loss: 0.518 Vali Loss: 1.081 Vali Acc: 0.536 Test Loss: 1.081 Test Acc: 0.536
Validation loss decreased (-0.521728 --> -0.536221).  Saving model ...
Epoch: 19 cost time: 1.1173758506774902
Epoch: 19, Steps: 9 | Train Loss: 0.476 Vali Loss: 1.065 Vali Acc: 0.551 Test Loss: 1.065 Test Acc: 0.551
Validation loss decreased (-0.536221 --> -0.550714).  Saving model ...
Epoch: 20 cost time: 0.9549243450164795
Epoch: 20, Steps: 9 | Train Loss: 0.449 Vali Loss: 1.051 Vali Acc: 0.565 Test Loss: 1.051 Test Acc: 0.565
Validation loss decreased (-0.550714 --> -0.565207).  Saving model ...
Epoch: 21 cost time: 1.0317513942718506
Epoch: 21, Steps: 9 | Train Loss: 0.411 Vali Loss: 1.035 Vali Acc: 0.565 Test Loss: 1.035 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565207).  Saving model ...
Epoch: 22 cost time: 0.9396016597747803
Epoch: 22, Steps: 9 | Train Loss: 0.381 Vali Loss: 1.025 Vali Acc: 0.558 Test Loss: 1.025 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3704164028167725
Epoch: 23, Steps: 9 | Train Loss: 0.359 Vali Loss: 1.017 Vali Acc: 0.543 Test Loss: 1.017 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0706849098205566
Epoch: 24, Steps: 9 | Train Loss: 0.308 Vali Loss: 1.008 Vali Acc: 0.543 Test Loss: 1.008 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0441150665283203
Epoch: 25, Steps: 9 | Train Loss: 0.283 Vali Loss: 1.003 Vali Acc: 0.536 Test Loss: 1.003 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0444972515106201
Epoch: 26, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.999 Vali Acc: 0.558 Test Loss: 0.999 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3392024040222168
Epoch: 27, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.990 Vali Acc: 0.565 Test Loss: 0.990 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565207).  Saving model ...
Epoch: 28 cost time: 1.1310861110687256
Epoch: 28, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.983 Vali Acc: 0.587 Test Loss: 0.983 Test Acc: 0.587
Validation loss decreased (-0.565207 --> -0.586947).  Saving model ...
Epoch: 29 cost time: 1.1262311935424805
Epoch: 29, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.980 Vali Acc: 0.594 Test Loss: 0.980 Test Acc: 0.594
Validation loss decreased (-0.586947 --> -0.594193).  Saving model ...
Epoch: 30 cost time: 0.8468146324157715
Epoch: 30, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.980 Vali Acc: 0.580 Test Loss: 0.980 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0123827457427979
Epoch: 31, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.979 Vali Acc: 0.565 Test Loss: 0.979 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9183611869812012
Epoch: 32, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.976 Vali Acc: 0.587 Test Loss: 0.976 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0502641201019287
Epoch: 33, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.979 Vali Acc: 0.609 Test Loss: 0.979 Test Acc: 0.609
Validation loss decreased (-0.594193 --> -0.608686).  Saving model ...
Epoch: 34 cost time: 1.1647377014160156
Epoch: 34, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.979 Vali Acc: 0.601 Test Loss: 0.979 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1892681121826172
Epoch: 35, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.987 Vali Acc: 0.609 Test Loss: 0.987 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9524784088134766
Epoch: 36, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.986 Vali Acc: 0.601 Test Loss: 0.986 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0833072662353516
Epoch: 37, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.986 Vali Acc: 0.594 Test Loss: 0.986 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.153414011001587
Epoch: 38, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.993 Vali Acc: 0.609 Test Loss: 0.993 Test Acc: 0.609
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1021263599395752
Epoch: 39, Steps: 9 | Train Loss: 0.073 Vali Loss: 1.001 Vali Acc: 0.601 Test Loss: 1.001 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.035715103149414
Epoch: 40, Steps: 9 | Train Loss: 0.069 Vali Loss: 1.005 Vali Acc: 0.601 Test Loss: 1.005 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0494134426116943
Epoch: 41, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.006 Vali Acc: 0.580 Test Loss: 1.006 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9615368843078613
Epoch: 42, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.005 Vali Acc: 0.587 Test Loss: 1.005 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.949852466583252
Epoch: 43, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.002 Vali Acc: 0.587 Test Loss: 1.002 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6086956521739131
model parameter : 216444
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0329043865203857
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.417 Vali Acc: 0.210 Test Loss: 1.417 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 0.7405052185058594
Epoch: 2, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.378 Vali Acc: 0.268 Test Loss: 1.378 Test Acc: 0.268
Validation loss decreased (-0.210131 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 0.9330613613128662
Epoch: 3, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.328 Vali Acc: 0.312 Test Loss: 1.328 Test Acc: 0.312
Validation loss decreased (-0.268102 --> -0.311581).  Saving model ...
Epoch: 4 cost time: 0.8516700267791748
Epoch: 4, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.281 Vali Acc: 0.391 Test Loss: 1.281 Test Acc: 0.391
Validation loss decreased (-0.311581 --> -0.391292).  Saving model ...
Epoch: 5 cost time: 0.8669161796569824
Epoch: 5, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.244 Vali Acc: 0.435 Test Loss: 1.244 Test Acc: 0.435
Validation loss decreased (-0.391292 --> -0.434770).  Saving model ...
Epoch: 6 cost time: 0.7760751247406006
Epoch: 6, Steps: 9 | Train Loss: 1.098 Vali Loss: 1.222 Vali Acc: 0.449 Test Loss: 1.222 Test Acc: 0.449
Validation loss decreased (-0.434770 --> -0.449263).  Saving model ...
Epoch: 7 cost time: 0.8448593616485596
Epoch: 7, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.204 Vali Acc: 0.428 Test Loss: 1.204 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7861521244049072
Epoch: 8, Steps: 9 | Train Loss: 0.970 Vali Loss: 1.187 Vali Acc: 0.442 Test Loss: 1.187 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9027907848358154
Epoch: 9, Steps: 9 | Train Loss: 0.923 Vali Loss: 1.176 Vali Acc: 0.435 Test Loss: 1.176 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7740044593811035
Epoch: 10, Steps: 9 | Train Loss: 0.868 Vali Loss: 1.164 Vali Acc: 0.442 Test Loss: 1.164 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.868506669998169
Epoch: 11, Steps: 9 | Train Loss: 0.812 Vali Loss: 1.143 Vali Acc: 0.464 Test Loss: 1.143 Test Acc: 0.464
Validation loss decreased (-0.449263 --> -0.463757).  Saving model ...
Epoch: 12 cost time: 0.7409572601318359
Epoch: 12, Steps: 9 | Train Loss: 0.755 Vali Loss: 1.143 Vali Acc: 0.428 Test Loss: 1.143 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9327685832977295
Epoch: 13, Steps: 9 | Train Loss: 0.710 Vali Loss: 1.118 Vali Acc: 0.478 Test Loss: 1.118 Test Acc: 0.478
Validation loss decreased (-0.463757 --> -0.478250).  Saving model ...
Epoch: 14 cost time: 0.864757776260376
Epoch: 14, Steps: 9 | Train Loss: 0.665 Vali Loss: 1.108 Vali Acc: 0.486 Test Loss: 1.108 Test Acc: 0.486
Validation loss decreased (-0.478250 --> -0.485496).  Saving model ...
Epoch: 15 cost time: 0.9813945293426514
Epoch: 15, Steps: 9 | Train Loss: 0.603 Vali Loss: 1.087 Vali Acc: 0.493 Test Loss: 1.087 Test Acc: 0.493
Validation loss decreased (-0.485496 --> -0.492743).  Saving model ...
Epoch: 16 cost time: 0.8179154396057129
Epoch: 16, Steps: 9 | Train Loss: 0.555 Vali Loss: 1.089 Vali Acc: 0.486 Test Loss: 1.089 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8237595558166504
Epoch: 17, Steps: 9 | Train Loss: 0.529 Vali Loss: 1.091 Vali Acc: 0.464 Test Loss: 1.091 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9400389194488525
Epoch: 18, Steps: 9 | Train Loss: 0.474 Vali Loss: 1.063 Vali Acc: 0.514 Test Loss: 1.063 Test Acc: 0.514
Validation loss decreased (-0.492743 --> -0.514482).  Saving model ...
Epoch: 19 cost time: 0.9485745429992676
Epoch: 19, Steps: 9 | Train Loss: 0.433 Vali Loss: 1.048 Vali Acc: 0.522 Test Loss: 1.048 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521729).  Saving model ...
Epoch: 20 cost time: 0.8815879821777344
Epoch: 20, Steps: 9 | Train Loss: 0.375 Vali Loss: 1.047 Vali Acc: 0.522 Test Loss: 1.047 Test Acc: 0.522
Validation loss decreased (-0.521729 --> -0.521729).  Saving model ...
Epoch: 21 cost time: 0.8633108139038086
Epoch: 21, Steps: 9 | Train Loss: 0.352 Vali Loss: 1.047 Vali Acc: 0.514 Test Loss: 1.047 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0678737163543701
Epoch: 22, Steps: 9 | Train Loss: 0.311 Vali Loss: 1.054 Vali Acc: 0.507 Test Loss: 1.054 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8394501209259033
Epoch: 23, Steps: 9 | Train Loss: 0.279 Vali Loss: 1.039 Vali Acc: 0.536 Test Loss: 1.039 Test Acc: 0.536
Validation loss decreased (-0.521729 --> -0.536221).  Saving model ...
Epoch: 24 cost time: 0.8100795745849609
Epoch: 24, Steps: 9 | Train Loss: 0.244 Vali Loss: 1.053 Vali Acc: 0.529 Test Loss: 1.053 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1383028030395508
Epoch: 25, Steps: 9 | Train Loss: 0.220 Vali Loss: 1.030 Vali Acc: 0.543 Test Loss: 1.030 Test Acc: 0.543
Validation loss decreased (-0.536221 --> -0.543468).  Saving model ...
Epoch: 26 cost time: 1.2384910583496094
Epoch: 26, Steps: 9 | Train Loss: 0.195 Vali Loss: 1.034 Vali Acc: 0.522 Test Loss: 1.034 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9007296562194824
Epoch: 27, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.046 Vali Acc: 0.536 Test Loss: 1.046 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9511959552764893
Epoch: 28, Steps: 9 | Train Loss: 0.147 Vali Loss: 1.039 Vali Acc: 0.551 Test Loss: 1.039 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550714).  Saving model ...
Epoch: 29 cost time: 0.9864091873168945
Epoch: 29, Steps: 9 | Train Loss: 0.132 Vali Loss: 1.037 Vali Acc: 0.558 Test Loss: 1.037 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557961).  Saving model ...
Epoch: 30 cost time: 1.0804078578948975
Epoch: 30, Steps: 9 | Train Loss: 0.112 Vali Loss: 1.040 Vali Acc: 0.565 Test Loss: 1.040 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565207).  Saving model ...
Epoch: 31 cost time: 0.924468994140625
Epoch: 31, Steps: 9 | Train Loss: 0.101 Vali Loss: 1.050 Vali Acc: 0.565 Test Loss: 1.050 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9947149753570557
Epoch: 32, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.036 Vali Acc: 0.565 Test Loss: 1.036 Test Acc: 0.565
Validation loss decreased (-0.565207 --> -0.565207).  Saving model ...
Epoch: 33 cost time: 1.030303716659546
Epoch: 33, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.046 Vali Acc: 0.572 Test Loss: 1.046 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572453).  Saving model ...
Epoch: 34 cost time: 1.0627696514129639
Epoch: 34, Steps: 9 | Train Loss: 0.072 Vali Loss: 1.049 Vali Acc: 0.565 Test Loss: 1.049 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7176673412322998
Epoch: 35, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.067 Vali Acc: 0.551 Test Loss: 1.067 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8666906356811523
Epoch: 36, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.056 Vali Acc: 0.565 Test Loss: 1.056 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0451691150665283
Epoch: 37, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.060 Vali Acc: 0.572 Test Loss: 1.060 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8583378791809082
Epoch: 38, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.065 Vali Acc: 0.572 Test Loss: 1.065 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0771865844726562
Epoch: 39, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.070 Vali Acc: 0.572 Test Loss: 1.070 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9972195625305176
Epoch: 40, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.063 Vali Acc: 0.572 Test Loss: 1.063 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8919932842254639
Epoch: 41, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.065 Vali Acc: 0.572 Test Loss: 1.065 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9127447605133057
Epoch: 42, Steps: 9 | Train Loss: 0.036 Vali Loss: 1.074 Vali Acc: 0.565 Test Loss: 1.074 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8577537536621094
Epoch: 43, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.079 Vali Acc: 0.565 Test Loss: 1.079 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 215420
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.330430507659912
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.479 Vali Acc: 0.159 Test Loss: 1.479 Test Acc: 0.159
Validation loss decreased (inf --> -0.159405).  Saving model ...
Epoch: 2 cost time: 1.2346646785736084
Epoch: 2, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.455 Vali Acc: 0.167 Test Loss: 1.455 Test Acc: 0.167
Validation loss decreased (-0.159405 --> -0.166652).  Saving model ...
Epoch: 3 cost time: 1.0438039302825928
Epoch: 3, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.427 Vali Acc: 0.167 Test Loss: 1.427 Test Acc: 0.167
Validation loss decreased (-0.166652 --> -0.166652).  Saving model ...
Epoch: 4 cost time: 0.7347099781036377
Epoch: 4, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.396 Vali Acc: 0.225 Test Loss: 1.396 Test Acc: 0.225
Validation loss decreased (-0.166652 --> -0.224624).  Saving model ...
Epoch: 5 cost time: 0.7071926593780518
Epoch: 5, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.367 Vali Acc: 0.275 Test Loss: 1.367 Test Acc: 0.275
Validation loss decreased (-0.224624 --> -0.275349).  Saving model ...
Epoch: 6 cost time: 0.8135464191436768
Epoch: 6, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.334 Vali Acc: 0.297 Test Loss: 1.334 Test Acc: 0.297
Validation loss decreased (-0.275349 --> -0.297088).  Saving model ...
Epoch: 7 cost time: 1.2519514560699463
Epoch: 7, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.320 Vali Acc: 0.326 Test Loss: 1.320 Test Acc: 0.326
Validation loss decreased (-0.297088 --> -0.326074).  Saving model ...
Epoch: 8 cost time: 0.8767824172973633
Epoch: 8, Steps: 9 | Train Loss: 0.908 Vali Loss: 1.292 Vali Acc: 0.362 Test Loss: 1.292 Test Acc: 0.362
Validation loss decreased (-0.326074 --> -0.362306).  Saving model ...
Epoch: 9 cost time: 0.9917178153991699
Epoch: 9, Steps: 9 | Train Loss: 0.859 Vali Loss: 1.283 Vali Acc: 0.370 Test Loss: 1.283 Test Acc: 0.370
Validation loss decreased (-0.362306 --> -0.369552).  Saving model ...
Epoch: 10 cost time: 0.9914917945861816
Epoch: 10, Steps: 9 | Train Loss: 0.793 Vali Loss: 1.266 Vali Acc: 0.391 Test Loss: 1.266 Test Acc: 0.391
Validation loss decreased (-0.369552 --> -0.391292).  Saving model ...
Epoch: 11 cost time: 1.0974881649017334
Epoch: 11, Steps: 9 | Train Loss: 0.721 Vali Loss: 1.227 Vali Acc: 0.406 Test Loss: 1.227 Test Acc: 0.406
Validation loss decreased (-0.391292 --> -0.405785).  Saving model ...
Epoch: 12 cost time: 0.892974853515625
Epoch: 12, Steps: 9 | Train Loss: 0.664 Vali Loss: 1.210 Vali Acc: 0.457 Test Loss: 1.210 Test Acc: 0.457
Validation loss decreased (-0.405785 --> -0.456510).  Saving model ...
Epoch: 13 cost time: 0.9995403289794922
Epoch: 13, Steps: 9 | Train Loss: 0.593 Vali Loss: 1.192 Vali Acc: 0.449 Test Loss: 1.192 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0301744937896729
Epoch: 14, Steps: 9 | Train Loss: 0.540 Vali Loss: 1.181 Vali Acc: 0.457 Test Loss: 1.181 Test Acc: 0.457
Validation loss decreased (-0.456510 --> -0.456510).  Saving model ...
Epoch: 15 cost time: 0.8139283657073975
Epoch: 15, Steps: 9 | Train Loss: 0.486 Vali Loss: 1.166 Vali Acc: 0.449 Test Loss: 1.166 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9004137516021729
Epoch: 16, Steps: 9 | Train Loss: 0.443 Vali Loss: 1.150 Vali Acc: 0.457 Test Loss: 1.150 Test Acc: 0.457
Validation loss decreased (-0.456510 --> -0.456510).  Saving model ...
Epoch: 17 cost time: 1.1081323623657227
Epoch: 17, Steps: 9 | Train Loss: 0.395 Vali Loss: 1.128 Vali Acc: 0.478 Test Loss: 1.128 Test Acc: 0.478
Validation loss decreased (-0.456510 --> -0.478250).  Saving model ...
Epoch: 18 cost time: 0.9066762924194336
Epoch: 18, Steps: 9 | Train Loss: 0.353 Vali Loss: 1.106 Vali Acc: 0.543 Test Loss: 1.106 Test Acc: 0.543
Validation loss decreased (-0.478250 --> -0.543467).  Saving model ...
Epoch: 19 cost time: 0.7514140605926514
Epoch: 19, Steps: 9 | Train Loss: 0.306 Vali Loss: 1.104 Vali Acc: 0.522 Test Loss: 1.104 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9818804264068604
Epoch: 20, Steps: 9 | Train Loss: 0.275 Vali Loss: 1.091 Vali Acc: 0.522 Test Loss: 1.091 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9287259578704834
Epoch: 21, Steps: 9 | Train Loss: 0.246 Vali Loss: 1.078 Vali Acc: 0.514 Test Loss: 1.078 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8469095230102539
Epoch: 22, Steps: 9 | Train Loss: 0.206 Vali Loss: 1.076 Vali Acc: 0.514 Test Loss: 1.076 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7268774509429932
Epoch: 23, Steps: 9 | Train Loss: 0.197 Vali Loss: 1.066 Vali Acc: 0.507 Test Loss: 1.066 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9882078170776367
Epoch: 24, Steps: 9 | Train Loss: 0.155 Vali Loss: 1.062 Vali Acc: 0.522 Test Loss: 1.062 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9534564018249512
Epoch: 25, Steps: 9 | Train Loss: 0.133 Vali Loss: 1.056 Vali Acc: 0.543 Test Loss: 1.056 Test Acc: 0.543
Validation loss decreased (-0.543467 --> -0.543468).  Saving model ...
Epoch: 26 cost time: 0.9636688232421875
Epoch: 26, Steps: 9 | Train Loss: 0.120 Vali Loss: 1.061 Vali Acc: 0.522 Test Loss: 1.061 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8708558082580566
Epoch: 27, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.041 Vali Acc: 0.543 Test Loss: 1.041 Test Acc: 0.543
Validation loss decreased (-0.543468 --> -0.543468).  Saving model ...
Epoch: 28 cost time: 0.9208126068115234
Epoch: 28, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.043 Vali Acc: 0.565 Test Loss: 1.043 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565207).  Saving model ...
Epoch: 29 cost time: 0.8875572681427002
Epoch: 29, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.035 Vali Acc: 0.572 Test Loss: 1.035 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572453).  Saving model ...
Epoch: 30 cost time: 1.0702075958251953
Epoch: 30, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.030 Vali Acc: 0.558 Test Loss: 1.030 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9615230560302734
Epoch: 31, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.034 Vali Acc: 0.558 Test Loss: 1.034 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8539886474609375
Epoch: 32, Steps: 9 | Train Loss: 0.059 Vali Loss: 1.038 Vali Acc: 0.558 Test Loss: 1.038 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9673891067504883
Epoch: 33, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.042 Vali Acc: 0.551 Test Loss: 1.042 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2927320003509521
Epoch: 34, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.036 Vali Acc: 0.572 Test Loss: 1.036 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0406146049499512
Epoch: 35, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.036 Vali Acc: 0.594 Test Loss: 1.036 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594193).  Saving model ...
Epoch: 36 cost time: 0.9766097068786621
Epoch: 36, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.045 Vali Acc: 0.594 Test Loss: 1.045 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8932161331176758
Epoch: 37, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.047 Vali Acc: 0.587 Test Loss: 1.047 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.74764084815979
Epoch: 38, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.050 Vali Acc: 0.587 Test Loss: 1.050 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7559006214141846
Epoch: 39, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.047 Vali Acc: 0.587 Test Loss: 1.047 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7396483421325684
Epoch: 40, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.048 Vali Acc: 0.580 Test Loss: 1.048 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.228710651397705
Epoch: 41, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.052 Vali Acc: 0.572 Test Loss: 1.052 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2856147289276123
Epoch: 42, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.054 Vali Acc: 0.572 Test Loss: 1.054 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0362882614135742
Epoch: 43, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.054 Vali Acc: 0.572 Test Loss: 1.054 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.812218189239502
Epoch: 44, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.056 Vali Acc: 0.580 Test Loss: 1.056 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9386770725250244
Epoch: 45, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.057 Vali Acc: 0.580 Test Loss: 1.057 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 214396
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6488897800445557
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.402 Vali Acc: 0.210 Test Loss: 1.402 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 1.810044527053833
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.350 Vali Acc: 0.290 Test Loss: 1.350 Test Acc: 0.290
Validation loss decreased (-0.210131 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 1.5444281101226807
Epoch: 3, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.299 Vali Acc: 0.399 Test Loss: 1.299 Test Acc: 0.399
Validation loss decreased (-0.289842 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 1.8749730587005615
Epoch: 4, Steps: 9 | Train Loss: 1.058 Vali Loss: 1.251 Vali Acc: 0.428 Test Loss: 1.251 Test Acc: 0.428
Validation loss decreased (-0.398538 --> -0.427524).  Saving model ...
Epoch: 5 cost time: 1.6843864917755127
Epoch: 5, Steps: 9 | Train Loss: 0.932 Vali Loss: 1.218 Vali Acc: 0.471 Test Loss: 1.218 Test Acc: 0.471
Validation loss decreased (-0.427524 --> -0.471002).  Saving model ...
Epoch: 6 cost time: 1.8394906520843506
Epoch: 6, Steps: 9 | Train Loss: 0.842 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.471002 --> -0.485495).  Saving model ...
Epoch: 7 cost time: 1.82643723487854
Epoch: 7, Steps: 9 | Train Loss: 0.753 Vali Loss: 1.167 Vali Acc: 0.478 Test Loss: 1.167 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1934707164764404
Epoch: 8, Steps: 9 | Train Loss: 0.687 Vali Loss: 1.146 Vali Acc: 0.522 Test Loss: 1.146 Test Acc: 0.522
Validation loss decreased (-0.485495 --> -0.521728).  Saving model ...
Epoch: 9 cost time: 1.8063006401062012
Epoch: 9, Steps: 9 | Train Loss: 0.621 Vali Loss: 1.134 Vali Acc: 0.471 Test Loss: 1.134 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8669612407684326
Epoch: 10, Steps: 9 | Train Loss: 0.559 Vali Loss: 1.110 Vali Acc: 0.551 Test Loss: 1.110 Test Acc: 0.551
Validation loss decreased (-0.521728 --> -0.550714).  Saving model ...
Epoch: 11 cost time: 1.7658371925354004
Epoch: 11, Steps: 9 | Train Loss: 0.514 Vali Loss: 1.107 Vali Acc: 0.529 Test Loss: 1.107 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1615450382232666
Epoch: 12, Steps: 9 | Train Loss: 0.436 Vali Loss: 1.085 Vali Acc: 0.558 Test Loss: 1.085 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557960).  Saving model ...
Epoch: 13 cost time: 2.0435054302215576
Epoch: 13, Steps: 9 | Train Loss: 0.392 Vali Loss: 1.080 Vali Acc: 0.536 Test Loss: 1.080 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9204316139221191
Epoch: 14, Steps: 9 | Train Loss: 0.341 Vali Loss: 1.070 Vali Acc: 0.529 Test Loss: 1.070 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8564791679382324
Epoch: 15, Steps: 9 | Train Loss: 0.304 Vali Loss: 1.070 Vali Acc: 0.558 Test Loss: 1.070 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 16 cost time: 1.6041550636291504
Epoch: 16, Steps: 9 | Train Loss: 0.258 Vali Loss: 1.058 Vali Acc: 0.558 Test Loss: 1.058 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 17 cost time: 1.9011471271514893
Epoch: 17, Steps: 9 | Train Loss: 0.215 Vali Loss: 1.059 Vali Acc: 0.587 Test Loss: 1.059 Test Acc: 0.587
Validation loss decreased (-0.557960 --> -0.586946).  Saving model ...
Epoch: 18 cost time: 1.8632242679595947
Epoch: 18, Steps: 9 | Train Loss: 0.183 Vali Loss: 1.057 Vali Acc: 0.565 Test Loss: 1.057 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.169612169265747
Epoch: 19, Steps: 9 | Train Loss: 0.153 Vali Loss: 1.045 Vali Acc: 0.565 Test Loss: 1.045 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2897579669952393
Epoch: 20, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.053 Vali Acc: 0.551 Test Loss: 1.053 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1197896003723145
Epoch: 21, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.059 Vali Acc: 0.536 Test Loss: 1.059 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9484951496124268
Epoch: 22, Steps: 9 | Train Loss: 0.101 Vali Loss: 1.057 Vali Acc: 0.522 Test Loss: 1.057 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.579286813735962
Epoch: 23, Steps: 9 | Train Loss: 0.088 Vali Loss: 1.067 Vali Acc: 0.522 Test Loss: 1.067 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.450697660446167
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 1.072 Vali Acc: 0.536 Test Loss: 1.072 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6441576480865479
Epoch: 25, Steps: 9 | Train Loss: 0.066 Vali Loss: 1.055 Vali Acc: 0.536 Test Loss: 1.055 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5753276348114014
Epoch: 26, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.049 Vali Acc: 0.529 Test Loss: 1.049 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6017165184020996
Epoch: 27, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.053 Vali Acc: 0.551 Test Loss: 1.053 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5869565217391305
model parameter : 227162
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.319434642791748
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.366 Vali Acc: 0.326 Test Loss: 1.366 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.6724891662597656
Epoch: 2, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.322 Vali Acc: 0.355 Test Loss: 1.322 Test Acc: 0.355
Validation loss decreased (-0.326073 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 1.6155726909637451
Epoch: 3, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.286 Vali Acc: 0.391 Test Loss: 1.286 Test Acc: 0.391
Validation loss decreased (-0.355059 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 1.7180042266845703
Epoch: 4, Steps: 9 | Train Loss: 1.056 Vali Loss: 1.248 Vali Acc: 0.449 Test Loss: 1.248 Test Acc: 0.449
Validation loss decreased (-0.391291 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 1.7206604480743408
Epoch: 5, Steps: 9 | Train Loss: 0.936 Vali Loss: 1.216 Vali Acc: 0.514 Test Loss: 1.216 Test Acc: 0.514
Validation loss decreased (-0.449263 --> -0.514481).  Saving model ...
Epoch: 6 cost time: 1.456282377243042
Epoch: 6, Steps: 9 | Train Loss: 0.832 Vali Loss: 1.195 Vali Acc: 0.507 Test Loss: 1.195 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3089661598205566
Epoch: 7, Steps: 9 | Train Loss: 0.748 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514481).  Saving model ...
Epoch: 8 cost time: 1.5745697021484375
Epoch: 8, Steps: 9 | Train Loss: 0.657 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514481).  Saving model ...
Epoch: 9 cost time: 1.3472137451171875
Epoch: 9, Steps: 9 | Train Loss: 0.586 Vali Loss: 1.139 Vali Acc: 0.486 Test Loss: 1.139 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3873233795166016
Epoch: 10, Steps: 9 | Train Loss: 0.517 Vali Loss: 1.113 Vali Acc: 0.486 Test Loss: 1.113 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4879703521728516
Epoch: 11, Steps: 9 | Train Loss: 0.448 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.767371416091919
Epoch: 12, Steps: 9 | Train Loss: 0.410 Vali Loss: 1.082 Vali Acc: 0.493 Test Loss: 1.082 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6320698261260986
Epoch: 13, Steps: 9 | Train Loss: 0.341 Vali Loss: 1.064 Vali Acc: 0.486 Test Loss: 1.064 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.695443868637085
Epoch: 14, Steps: 9 | Train Loss: 0.295 Vali Loss: 1.052 Vali Acc: 0.507 Test Loss: 1.052 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.796257495880127
Epoch: 15, Steps: 9 | Train Loss: 0.259 Vali Loss: 1.048 Vali Acc: 0.529 Test Loss: 1.048 Test Acc: 0.529
Validation loss decreased (-0.514481 --> -0.528975).  Saving model ...
Epoch: 16 cost time: 1.4346213340759277
Epoch: 16, Steps: 9 | Train Loss: 0.212 Vali Loss: 1.038 Vali Acc: 0.529 Test Loss: 1.038 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528975).  Saving model ...
Epoch: 17 cost time: 1.378187656402588
Epoch: 17, Steps: 9 | Train Loss: 0.187 Vali Loss: 1.045 Vali Acc: 0.543 Test Loss: 1.045 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 18 cost time: 1.496105670928955
Epoch: 18, Steps: 9 | Train Loss: 0.153 Vali Loss: 1.044 Vali Acc: 0.529 Test Loss: 1.044 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4248363971710205
Epoch: 19, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.045 Vali Acc: 0.507 Test Loss: 1.045 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6031925678253174
Epoch: 20, Steps: 9 | Train Loss: 0.115 Vali Loss: 1.028 Vali Acc: 0.522 Test Loss: 1.028 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6926870346069336
Epoch: 21, Steps: 9 | Train Loss: 0.097 Vali Loss: 1.022 Vali Acc: 0.514 Test Loss: 1.022 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6911861896514893
Epoch: 22, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.033 Vali Acc: 0.536 Test Loss: 1.033 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6049611568450928
Epoch: 23, Steps: 9 | Train Loss: 0.068 Vali Loss: 1.040 Vali Acc: 0.536 Test Loss: 1.040 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6559576988220215
Epoch: 24, Steps: 9 | Train Loss: 0.059 Vali Loss: 1.030 Vali Acc: 0.536 Test Loss: 1.030 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6975247859954834
Epoch: 25, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.025 Vali Acc: 0.536 Test Loss: 1.025 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4266018867492676
Epoch: 26, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.017 Vali Acc: 0.565 Test Loss: 1.017 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565207).  Saving model ...
Epoch: 27 cost time: 1.427689552307129
Epoch: 27, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.028 Vali Acc: 0.551 Test Loss: 1.028 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.53076171875
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.044 Vali Acc: 0.529 Test Loss: 1.044 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8932015895843506
Epoch: 29, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.052 Vali Acc: 0.543 Test Loss: 1.052 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8226258754730225
Epoch: 30, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.058 Vali Acc: 0.529 Test Loss: 1.058 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6647145748138428
Epoch: 31, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.052 Vali Acc: 0.543 Test Loss: 1.052 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5588951110839844
Epoch: 32, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.060 Vali Acc: 0.536 Test Loss: 1.060 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.674363374710083
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.045 Vali Acc: 0.543 Test Loss: 1.045 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4966785907745361
Epoch: 34, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.048 Vali Acc: 0.529 Test Loss: 1.048 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4218475818634033
Epoch: 35, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.057 Vali Acc: 0.529 Test Loss: 1.057 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.376096248626709
Epoch: 36, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.062 Vali Acc: 0.522 Test Loss: 1.062 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 224602
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8041508197784424
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.445 Vali Acc: 0.275 Test Loss: 1.445 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.1588788032531738
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.382 Vali Acc: 0.297 Test Loss: 1.382 Test Acc: 0.297
Validation loss decreased (-0.275348 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 1.2240746021270752
Epoch: 3, Steps: 9 | Train Loss: 1.096 Vali Loss: 1.317 Vali Acc: 0.341 Test Loss: 1.317 Test Acc: 0.341
Validation loss decreased (-0.297088 --> -0.340567).  Saving model ...
Epoch: 4 cost time: 1.2221424579620361
Epoch: 4, Steps: 9 | Train Loss: 0.992 Vali Loss: 1.268 Vali Acc: 0.399 Test Loss: 1.268 Test Acc: 0.399
Validation loss decreased (-0.340567 --> -0.398538).  Saving model ...
Epoch: 5 cost time: 1.2813279628753662
Epoch: 5, Steps: 9 | Train Loss: 0.871 Vali Loss: 1.232 Vali Acc: 0.493 Test Loss: 1.232 Test Acc: 0.493
Validation loss decreased (-0.398538 --> -0.492741).  Saving model ...
Epoch: 6 cost time: 1.1954460144042969
Epoch: 6, Steps: 9 | Train Loss: 0.776 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3756017684936523
Epoch: 7, Steps: 9 | Train Loss: 0.703 Vali Loss: 1.175 Vali Acc: 0.522 Test Loss: 1.175 Test Acc: 0.522
Validation loss decreased (-0.492741 --> -0.521727).  Saving model ...
Epoch: 8 cost time: 1.3067479133605957
Epoch: 8, Steps: 9 | Train Loss: 0.612 Vali Loss: 1.167 Vali Acc: 0.536 Test Loss: 1.167 Test Acc: 0.536
Validation loss decreased (-0.521727 --> -0.536220).  Saving model ...
Epoch: 9 cost time: 1.3749020099639893
Epoch: 9, Steps: 9 | Train Loss: 0.543 Vali Loss: 1.163 Vali Acc: 0.536 Test Loss: 1.163 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536220).  Saving model ...
Epoch: 10 cost time: 1.5582695007324219
Epoch: 10, Steps: 9 | Train Loss: 0.468 Vali Loss: 1.125 Vali Acc: 0.558 Test Loss: 1.125 Test Acc: 0.558
Validation loss decreased (-0.536220 --> -0.557960).  Saving model ...
Epoch: 11 cost time: 1.3334064483642578
Epoch: 11, Steps: 9 | Train Loss: 0.397 Vali Loss: 1.126 Vali Acc: 0.543 Test Loss: 1.126 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2746500968933105
Epoch: 12, Steps: 9 | Train Loss: 0.347 Vali Loss: 1.125 Vali Acc: 0.529 Test Loss: 1.125 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.453568458557129
Epoch: 13, Steps: 9 | Train Loss: 0.294 Vali Loss: 1.088 Vali Acc: 0.580 Test Loss: 1.088 Test Acc: 0.580
Validation loss decreased (-0.557960 --> -0.579699).  Saving model ...
Epoch: 14 cost time: 1.1533517837524414
Epoch: 14, Steps: 9 | Train Loss: 0.251 Vali Loss: 1.087 Vali Acc: 0.543 Test Loss: 1.087 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1899588108062744
Epoch: 15, Steps: 9 | Train Loss: 0.199 Vali Loss: 1.077 Vali Acc: 0.572 Test Loss: 1.077 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1087493896484375
Epoch: 16, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.076 Vali Acc: 0.594 Test Loss: 1.076 Test Acc: 0.594
Validation loss decreased (-0.579699 --> -0.594192).  Saving model ...
Epoch: 17 cost time: 1.7966904640197754
Epoch: 17, Steps: 9 | Train Loss: 0.152 Vali Loss: 1.077 Vali Acc: 0.580 Test Loss: 1.077 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9230058193206787
Epoch: 18, Steps: 9 | Train Loss: 0.129 Vali Loss: 1.072 Vali Acc: 0.572 Test Loss: 1.072 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2566571235656738
Epoch: 19, Steps: 9 | Train Loss: 0.104 Vali Loss: 1.072 Vali Acc: 0.558 Test Loss: 1.072 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1285715103149414
Epoch: 20, Steps: 9 | Train Loss: 0.089 Vali Loss: 1.075 Vali Acc: 0.565 Test Loss: 1.075 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9084179401397705
Epoch: 21, Steps: 9 | Train Loss: 0.072 Vali Loss: 1.070 Vali Acc: 0.565 Test Loss: 1.070 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.180342435836792
Epoch: 22, Steps: 9 | Train Loss: 0.061 Vali Loss: 1.080 Vali Acc: 0.565 Test Loss: 1.080 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5195252895355225
Epoch: 23, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.047 Vali Acc: 0.572 Test Loss: 1.047 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1494793891906738
Epoch: 24, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.087 Vali Acc: 0.551 Test Loss: 1.087 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4224183559417725
Epoch: 25, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.065 Vali Acc: 0.543 Test Loss: 1.065 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5836360454559326
Epoch: 26, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.062 Vali Acc: 0.551 Test Loss: 1.062 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 222042
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.527730941772461
Epoch: 1, Steps: 9 | Train Loss: 1.487 Vali Loss: 1.433 Vali Acc: 0.290 Test Loss: 1.433 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.1724896430969238
Epoch: 2, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.376 Vali Acc: 0.370 Test Loss: 1.376 Test Acc: 0.370
Validation loss decreased (-0.289841 --> -0.369551).  Saving model ...
Epoch: 3 cost time: 1.1006200313568115
Epoch: 3, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.311 Vali Acc: 0.406 Test Loss: 1.311 Test Acc: 0.406
Validation loss decreased (-0.369551 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 1.1000714302062988
Epoch: 4, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.261 Vali Acc: 0.449 Test Loss: 1.261 Test Acc: 0.449
Validation loss decreased (-0.405784 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 1.0647835731506348
Epoch: 5, Steps: 9 | Train Loss: 0.944 Vali Loss: 1.225 Vali Acc: 0.529 Test Loss: 1.225 Test Acc: 0.529
Validation loss decreased (-0.449263 --> -0.528973).  Saving model ...
Epoch: 6 cost time: 1.205627679824829
Epoch: 6, Steps: 9 | Train Loss: 0.826 Vali Loss: 1.188 Vali Acc: 0.471 Test Loss: 1.188 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2706544399261475
Epoch: 7, Steps: 9 | Train Loss: 0.738 Vali Loss: 1.155 Vali Acc: 0.543 Test Loss: 1.155 Test Acc: 0.543
Validation loss decreased (-0.528973 --> -0.543467).  Saving model ...
Epoch: 8 cost time: 1.2259118556976318
Epoch: 8, Steps: 9 | Train Loss: 0.625 Vali Loss: 1.143 Vali Acc: 0.558 Test Loss: 1.143 Test Acc: 0.558
Validation loss decreased (-0.543467 --> -0.557960).  Saving model ...
Epoch: 9 cost time: 0.9192516803741455
Epoch: 9, Steps: 9 | Train Loss: 0.551 Vali Loss: 1.134 Vali Acc: 0.536 Test Loss: 1.134 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1660401821136475
Epoch: 10, Steps: 9 | Train Loss: 0.495 Vali Loss: 1.124 Vali Acc: 0.543 Test Loss: 1.124 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2323565483093262
Epoch: 11, Steps: 9 | Train Loss: 0.424 Vali Loss: 1.140 Vali Acc: 0.507 Test Loss: 1.140 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9921824932098389
Epoch: 12, Steps: 9 | Train Loss: 0.357 Vali Loss: 1.130 Vali Acc: 0.507 Test Loss: 1.130 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0673983097076416
Epoch: 13, Steps: 9 | Train Loss: 0.308 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3836445808410645
Epoch: 14, Steps: 9 | Train Loss: 0.250 Vali Loss: 1.113 Vali Acc: 0.507 Test Loss: 1.113 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3298516273498535
Epoch: 15, Steps: 9 | Train Loss: 0.213 Vali Loss: 1.108 Vali Acc: 0.507 Test Loss: 1.108 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2255566120147705
Epoch: 16, Steps: 9 | Train Loss: 0.182 Vali Loss: 1.106 Vali Acc: 0.522 Test Loss: 1.106 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2103054523468018
Epoch: 17, Steps: 9 | Train Loss: 0.153 Vali Loss: 1.134 Vali Acc: 0.543 Test Loss: 1.134 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2519466876983643
Epoch: 18, Steps: 9 | Train Loss: 0.128 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5579710144927537
model parameter : 219482
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2639267444610596
Epoch: 1, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.382 Vali Acc: 0.312 Test Loss: 1.382 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.1750197410583496
Epoch: 2, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.343 Vali Acc: 0.355 Test Loss: 1.343 Test Acc: 0.355
Validation loss decreased (-0.311580 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 1.1070318222045898
Epoch: 3, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.300 Vali Acc: 0.406 Test Loss: 1.300 Test Acc: 0.406
Validation loss decreased (-0.355059 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 1.301384449005127
Epoch: 4, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.262 Vali Acc: 0.442 Test Loss: 1.262 Test Acc: 0.442
Validation loss decreased (-0.405784 --> -0.442016).  Saving model ...
Epoch: 5 cost time: 1.0460426807403564
Epoch: 5, Steps: 9 | Train Loss: 0.890 Vali Loss: 1.235 Vali Acc: 0.457 Test Loss: 1.235 Test Acc: 0.457
Validation loss decreased (-0.442016 --> -0.456509).  Saving model ...
Epoch: 6 cost time: 1.1957576274871826
Epoch: 6, Steps: 9 | Train Loss: 0.789 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.456509 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.3306152820587158
Epoch: 7, Steps: 9 | Train Loss: 0.707 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 8 cost time: 1.0483462810516357
Epoch: 8, Steps: 9 | Train Loss: 0.606 Vali Loss: 1.163 Vali Acc: 0.478 Test Loss: 1.163 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4118249416351318
Epoch: 9, Steps: 9 | Train Loss: 0.519 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3554630279541016
Epoch: 10, Steps: 9 | Train Loss: 0.444 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2805354595184326
Epoch: 11, Steps: 9 | Train Loss: 0.372 Vali Loss: 1.127 Vali Acc: 0.486 Test Loss: 1.127 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1236684322357178
Epoch: 12, Steps: 9 | Train Loss: 0.307 Vali Loss: 1.126 Vali Acc: 0.507 Test Loss: 1.126 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2558331489562988
Epoch: 13, Steps: 9 | Train Loss: 0.252 Vali Loss: 1.112 Vali Acc: 0.507 Test Loss: 1.112 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4155738353729248
Epoch: 14, Steps: 9 | Train Loss: 0.204 Vali Loss: 1.111 Vali Acc: 0.507 Test Loss: 1.111 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4584712982177734
Epoch: 15, Steps: 9 | Train Loss: 0.158 Vali Loss: 1.115 Vali Acc: 0.493 Test Loss: 1.115 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1937079429626465
Epoch: 16, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.258713960647583
Epoch: 17, Steps: 9 | Train Loss: 0.108 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5144927536231884
model parameter : 217434
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6751933097839355
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.379 Vali Acc: 0.261 Test Loss: 1.379 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.8612303733825684
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.341 Vali Acc: 0.312 Test Loss: 1.341 Test Acc: 0.312
Validation loss decreased (-0.260856 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 0.9784772396087646
Epoch: 3, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.279 Vali Acc: 0.348 Test Loss: 1.279 Test Acc: 0.348
Validation loss decreased (-0.311581 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 0.8023245334625244
Epoch: 4, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.242 Vali Acc: 0.413 Test Loss: 1.242 Test Acc: 0.413
Validation loss decreased (-0.347813 --> -0.413031).  Saving model ...
Epoch: 5 cost time: 0.73287034034729
Epoch: 5, Steps: 9 | Train Loss: 0.851 Vali Loss: 1.212 Vali Acc: 0.442 Test Loss: 1.212 Test Acc: 0.442
Validation loss decreased (-0.413031 --> -0.442017).  Saving model ...
Epoch: 6 cost time: 0.6936001777648926
Epoch: 6, Steps: 9 | Train Loss: 0.739 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.442017 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.019540548324585
Epoch: 7, Steps: 9 | Train Loss: 0.631 Vali Loss: 1.151 Vali Acc: 0.464 Test Loss: 1.151 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8245441913604736
Epoch: 8, Steps: 9 | Train Loss: 0.560 Vali Loss: 1.117 Vali Acc: 0.478 Test Loss: 1.117 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.934438943862915
Epoch: 9, Steps: 9 | Train Loss: 0.469 Vali Loss: 1.112 Vali Acc: 0.507 Test Loss: 1.112 Test Acc: 0.507
Validation loss decreased (-0.499988 --> -0.507235).  Saving model ...
Epoch: 10 cost time: 0.7918095588684082
Epoch: 10, Steps: 9 | Train Loss: 0.396 Vali Loss: 1.101 Vali Acc: 0.572 Test Loss: 1.101 Test Acc: 0.572
Validation loss decreased (-0.507235 --> -0.572453).  Saving model ...
Epoch: 11 cost time: 0.8040742874145508
Epoch: 11, Steps: 9 | Train Loss: 0.329 Vali Loss: 1.073 Vali Acc: 0.507 Test Loss: 1.073 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.018812894821167
Epoch: 12, Steps: 9 | Train Loss: 0.280 Vali Loss: 1.077 Vali Acc: 0.507 Test Loss: 1.077 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8366882801055908
Epoch: 13, Steps: 9 | Train Loss: 0.230 Vali Loss: 1.095 Vali Acc: 0.522 Test Loss: 1.095 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1651787757873535
Epoch: 14, Steps: 9 | Train Loss: 0.183 Vali Loss: 1.066 Vali Acc: 0.522 Test Loss: 1.066 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6771197319030762
Epoch: 15, Steps: 9 | Train Loss: 0.149 Vali Loss: 1.093 Vali Acc: 0.522 Test Loss: 1.093 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9205915927886963
Epoch: 16, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.083 Vali Acc: 0.536 Test Loss: 1.083 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8829727172851562
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 1.082 Vali Acc: 0.543 Test Loss: 1.082 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.916245698928833
Epoch: 18, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.092 Vali Acc: 0.543 Test Loss: 1.092 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8452906608581543
Epoch: 19, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.087 Vali Acc: 0.543 Test Loss: 1.087 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8557069301605225
Epoch: 20, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.104 Vali Acc: 0.522 Test Loss: 1.104 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 216410
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9765024185180664
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.402 Vali Acc: 0.254 Test Loss: 1.402 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.8989465236663818
Epoch: 2, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.343 Vali Acc: 0.304 Test Loss: 1.343 Test Acc: 0.304
Validation loss decreased (-0.253609 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 0.966073751449585
Epoch: 3, Steps: 9 | Train Loss: 1.139 Vali Loss: 1.277 Vali Acc: 0.384 Test Loss: 1.277 Test Acc: 0.384
Validation loss decreased (-0.304334 --> -0.384045).  Saving model ...
Epoch: 4 cost time: 1.1940457820892334
Epoch: 4, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.238 Vali Acc: 0.406 Test Loss: 1.238 Test Acc: 0.406
Validation loss decreased (-0.384045 --> -0.405785).  Saving model ...
Epoch: 5 cost time: 1.0316567420959473
Epoch: 5, Steps: 9 | Train Loss: 0.847 Vali Loss: 1.205 Vali Acc: 0.449 Test Loss: 1.205 Test Acc: 0.449
Validation loss decreased (-0.405785 --> -0.449263).  Saving model ...
Epoch: 6 cost time: 0.8894977569580078
Epoch: 6, Steps: 9 | Train Loss: 0.746 Vali Loss: 1.188 Vali Acc: 0.471 Test Loss: 1.188 Test Acc: 0.471
Validation loss decreased (-0.449263 --> -0.471003).  Saving model ...
Epoch: 7 cost time: 0.8165197372436523
Epoch: 7, Steps: 9 | Train Loss: 0.634 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.471003 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.8232147693634033
Epoch: 8, Steps: 9 | Train Loss: 0.543 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 9 cost time: 0.747591495513916
Epoch: 9, Steps: 9 | Train Loss: 0.468 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514481).  Saving model ...
Epoch: 10 cost time: 0.7886199951171875
Epoch: 10, Steps: 9 | Train Loss: 0.383 Vali Loss: 1.112 Vali Acc: 0.565 Test Loss: 1.112 Test Acc: 0.565
Validation loss decreased (-0.514481 --> -0.565206).  Saving model ...
Epoch: 11 cost time: 0.9209067821502686
Epoch: 11, Steps: 9 | Train Loss: 0.311 Vali Loss: 1.115 Vali Acc: 0.529 Test Loss: 1.115 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9516041278839111
Epoch: 12, Steps: 9 | Train Loss: 0.247 Vali Loss: 1.094 Vali Acc: 0.529 Test Loss: 1.094 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0427391529083252
Epoch: 13, Steps: 9 | Train Loss: 0.208 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.08766770362854
Epoch: 14, Steps: 9 | Train Loss: 0.169 Vali Loss: 1.082 Vali Acc: 0.543 Test Loss: 1.082 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8689167499542236
Epoch: 15, Steps: 9 | Train Loss: 0.126 Vali Loss: 1.089 Vali Acc: 0.522 Test Loss: 1.089 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.921917200088501
Epoch: 16, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.087 Vali Acc: 0.536 Test Loss: 1.087 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9564225673675537
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.079 Vali Acc: 0.522 Test Loss: 1.079 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8296656608581543
Epoch: 18, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.081 Vali Acc: 0.529 Test Loss: 1.081 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1176369190216064
Epoch: 19, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.107 Vali Acc: 0.507 Test Loss: 1.107 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0056085586547852
Epoch: 20, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.091 Vali Acc: 0.529 Test Loss: 1.091 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 215386
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.674628734588623
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.434 Vali Acc: 0.217 Test Loss: 1.434 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 0.7826085090637207
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.357 Vali Acc: 0.319 Test Loss: 1.357 Test Acc: 0.319
Validation loss decreased (-0.217377 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.6366100311279297
Epoch: 3, Steps: 9 | Train Loss: 1.127 Vali Loss: 1.288 Vali Acc: 0.399 Test Loss: 1.288 Test Acc: 0.399
Validation loss decreased (-0.318827 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.8236806392669678
Epoch: 4, Steps: 9 | Train Loss: 0.956 Vali Loss: 1.250 Vali Acc: 0.449 Test Loss: 1.250 Test Acc: 0.449
Validation loss decreased (-0.398538 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 0.6248157024383545
Epoch: 5, Steps: 9 | Train Loss: 0.826 Vali Loss: 1.198 Vali Acc: 0.471 Test Loss: 1.198 Test Acc: 0.471
Validation loss decreased (-0.449263 --> -0.471003).  Saving model ...
Epoch: 6 cost time: 0.9118931293487549
Epoch: 6, Steps: 9 | Train Loss: 0.705 Vali Loss: 1.175 Vali Acc: 0.522 Test Loss: 1.175 Test Acc: 0.522
Validation loss decreased (-0.471003 --> -0.521727).  Saving model ...
Epoch: 7 cost time: 0.690345048904419
Epoch: 7, Steps: 9 | Train Loss: 0.586 Vali Loss: 1.149 Vali Acc: 0.529 Test Loss: 1.149 Test Acc: 0.529
Validation loss decreased (-0.521727 --> -0.528974).  Saving model ...
Epoch: 8 cost time: 0.7870090007781982
Epoch: 8, Steps: 9 | Train Loss: 0.486 Vali Loss: 1.131 Vali Acc: 0.536 Test Loss: 1.131 Test Acc: 0.536
Validation loss decreased (-0.528974 --> -0.536221).  Saving model ...
Epoch: 9 cost time: 0.8625264167785645
Epoch: 9, Steps: 9 | Train Loss: 0.397 Vali Loss: 1.105 Vali Acc: 0.558 Test Loss: 1.105 Test Acc: 0.558
Validation loss decreased (-0.536221 --> -0.557960).  Saving model ...
Epoch: 10 cost time: 0.8604986667633057
Epoch: 10, Steps: 9 | Train Loss: 0.319 Vali Loss: 1.128 Vali Acc: 0.529 Test Loss: 1.128 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9692511558532715
Epoch: 11, Steps: 9 | Train Loss: 0.248 Vali Loss: 1.113 Vali Acc: 0.543 Test Loss: 1.113 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8888983726501465
Epoch: 12, Steps: 9 | Train Loss: 0.196 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7158718109130859
Epoch: 13, Steps: 9 | Train Loss: 0.145 Vali Loss: 1.130 Vali Acc: 0.572 Test Loss: 1.130 Test Acc: 0.572
Validation loss decreased (-0.557960 --> -0.572452).  Saving model ...
Epoch: 14 cost time: 0.820967435836792
Epoch: 14, Steps: 9 | Train Loss: 0.112 Vali Loss: 1.108 Vali Acc: 0.543 Test Loss: 1.108 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8055562973022461
Epoch: 15, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.120 Vali Acc: 0.529 Test Loss: 1.120 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8870646953582764
Epoch: 16, Steps: 9 | Train Loss: 0.066 Vali Loss: 1.122 Vali Acc: 0.529 Test Loss: 1.122 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7696521282196045
Epoch: 17, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.136 Vali Acc: 0.536 Test Loss: 1.136 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9496991634368896
Epoch: 18, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.126 Vali Acc: 0.543 Test Loss: 1.126 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8669724464416504
Epoch: 19, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.156 Vali Acc: 0.536 Test Loss: 1.156 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.68845534324646
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.132 Vali Acc: 0.522 Test Loss: 1.132 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.852992057800293
Epoch: 21, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.116 Vali Acc: 0.536 Test Loss: 1.116 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9229316711425781
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.140 Vali Acc: 0.522 Test Loss: 1.140 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.827664852142334
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.145 Vali Acc: 0.522 Test Loss: 1.145 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 214362
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.551117181777954
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.430 Vali Acc: 0.254 Test Loss: 1.430 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.665740728378296
Epoch: 2, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.400 Vali Acc: 0.261 Test Loss: 1.400 Test Acc: 0.261
Validation loss decreased (-0.253609 --> -0.260856).  Saving model ...
Epoch: 3 cost time: 1.7125608921051025
Epoch: 3, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.368 Vali Acc: 0.275 Test Loss: 1.368 Test Acc: 0.275
Validation loss decreased (-0.260856 --> -0.275349).  Saving model ...
Epoch: 4 cost time: 2.233583688735962
Epoch: 4, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.338 Vali Acc: 0.254 Test Loss: 1.338 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.065119981765747
Epoch: 5, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.312 Vali Acc: 0.283 Test Loss: 1.312 Test Acc: 0.283
Validation loss decreased (-0.275349 --> -0.282596).  Saving model ...
Epoch: 6 cost time: 1.8431034088134766
Epoch: 6, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.295 Vali Acc: 0.283 Test Loss: 1.295 Test Acc: 0.283
Validation loss decreased (-0.282596 --> -0.282596).  Saving model ...
Epoch: 7 cost time: 1.8942599296569824
Epoch: 7, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.281 Vali Acc: 0.268 Test Loss: 1.281 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9310734272003174
Epoch: 8, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.270 Vali Acc: 0.261 Test Loss: 1.270 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6659789085388184
Epoch: 9, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.263 Vali Acc: 0.268 Test Loss: 1.263 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9135935306549072
Epoch: 10, Steps: 9 | Train Loss: 0.982 Vali Loss: 1.251 Vali Acc: 0.268 Test Loss: 1.251 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2037956714630127
Epoch: 11, Steps: 9 | Train Loss: 0.969 Vali Loss: 1.242 Vali Acc: 0.283 Test Loss: 1.242 Test Acc: 0.283
Validation loss decreased (-0.282596 --> -0.282596).  Saving model ...
Epoch: 12 cost time: 2.01310396194458
Epoch: 12, Steps: 9 | Train Loss: 0.911 Vali Loss: 1.235 Vali Acc: 0.275 Test Loss: 1.235 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6593923568725586
Epoch: 13, Steps: 9 | Train Loss: 0.877 Vali Loss: 1.234 Vali Acc: 0.261 Test Loss: 1.234 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7987251281738281
Epoch: 14, Steps: 9 | Train Loss: 0.852 Vali Loss: 1.231 Vali Acc: 0.275 Test Loss: 1.231 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6708767414093018
Epoch: 15, Steps: 9 | Train Loss: 0.818 Vali Loss: 1.229 Vali Acc: 0.290 Test Loss: 1.229 Test Acc: 0.290
Validation loss decreased (-0.282596 --> -0.289843).  Saving model ...
Epoch: 16 cost time: 2.171311378479004
Epoch: 16, Steps: 9 | Train Loss: 0.792 Vali Loss: 1.230 Vali Acc: 0.297 Test Loss: 1.230 Test Acc: 0.297
Validation loss decreased (-0.289843 --> -0.297089).  Saving model ...
Epoch: 17 cost time: 2.016211748123169
Epoch: 17, Steps: 9 | Train Loss: 0.759 Vali Loss: 1.226 Vali Acc: 0.297 Test Loss: 1.226 Test Acc: 0.297
Validation loss decreased (-0.297089 --> -0.297089).  Saving model ...
Epoch: 18 cost time: 1.819018840789795
Epoch: 18, Steps: 9 | Train Loss: 0.713 Vali Loss: 1.222 Vali Acc: 0.319 Test Loss: 1.222 Test Acc: 0.319
Validation loss decreased (-0.297089 --> -0.318828).  Saving model ...
Epoch: 19 cost time: 1.9005544185638428
Epoch: 19, Steps: 9 | Train Loss: 0.691 Vali Loss: 1.221 Vali Acc: 0.326 Test Loss: 1.221 Test Acc: 0.326
Validation loss decreased (-0.318828 --> -0.326075).  Saving model ...
Epoch: 20 cost time: 1.8948843479156494
Epoch: 20, Steps: 9 | Train Loss: 0.663 Vali Loss: 1.216 Vali Acc: 0.348 Test Loss: 1.216 Test Acc: 0.348
Validation loss decreased (-0.326075 --> -0.347814).  Saving model ...
Epoch: 21 cost time: 2.005716562271118
Epoch: 21, Steps: 9 | Train Loss: 0.626 Vali Loss: 1.212 Vali Acc: 0.370 Test Loss: 1.212 Test Acc: 0.370
Validation loss decreased (-0.347814 --> -0.369553).  Saving model ...
Epoch: 22 cost time: 1.6672613620758057
Epoch: 22, Steps: 9 | Train Loss: 0.596 Vali Loss: 1.211 Vali Acc: 0.377 Test Loss: 1.211 Test Acc: 0.377
Validation loss decreased (-0.369553 --> -0.376799).  Saving model ...
Epoch: 23 cost time: 1.5717952251434326
Epoch: 23, Steps: 9 | Train Loss: 0.565 Vali Loss: 1.205 Vali Acc: 0.413 Test Loss: 1.205 Test Acc: 0.413
Validation loss decreased (-0.376799 --> -0.413031).  Saving model ...
Epoch: 24 cost time: 2.015496015548706
Epoch: 24, Steps: 9 | Train Loss: 0.539 Vali Loss: 1.202 Vali Acc: 0.362 Test Loss: 1.202 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.941971778869629
Epoch: 25, Steps: 9 | Train Loss: 0.517 Vali Loss: 1.210 Vali Acc: 0.355 Test Loss: 1.210 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.562610149383545
Epoch: 26, Steps: 9 | Train Loss: 0.493 Vali Loss: 1.212 Vali Acc: 0.377 Test Loss: 1.212 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.205272674560547
Epoch: 27, Steps: 9 | Train Loss: 0.458 Vali Loss: 1.216 Vali Acc: 0.406 Test Loss: 1.216 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.060349464416504
Epoch: 28, Steps: 9 | Train Loss: 0.429 Vali Loss: 1.222 Vali Acc: 0.413 Test Loss: 1.222 Test Acc: 0.413
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9948029518127441
Epoch: 29, Steps: 9 | Train Loss: 0.413 Vali Loss: 1.224 Vali Acc: 0.391 Test Loss: 1.224 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7895033359527588
Epoch: 30, Steps: 9 | Train Loss: 0.375 Vali Loss: 1.215 Vali Acc: 0.406 Test Loss: 1.215 Test Acc: 0.406
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8983359336853027
Epoch: 31, Steps: 9 | Train Loss: 0.377 Vali Loss: 1.208 Vali Acc: 0.449 Test Loss: 1.208 Test Acc: 0.449
Validation loss decreased (-0.413031 --> -0.449263).  Saving model ...
Epoch: 32 cost time: 2.289634943008423
Epoch: 32, Steps: 9 | Train Loss: 0.344 Vali Loss: 1.216 Vali Acc: 0.442 Test Loss: 1.216 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.528501272201538
Epoch: 33, Steps: 9 | Train Loss: 0.319 Vali Loss: 1.217 Vali Acc: 0.442 Test Loss: 1.217 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.057469367980957
Epoch: 34, Steps: 9 | Train Loss: 0.303 Vali Loss: 1.214 Vali Acc: 0.449 Test Loss: 1.214 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6049978733062744
Epoch: 35, Steps: 9 | Train Loss: 0.284 Vali Loss: 1.217 Vali Acc: 0.449 Test Loss: 1.217 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8392963409423828
Epoch: 36, Steps: 9 | Train Loss: 0.272 Vali Loss: 1.221 Vali Acc: 0.420 Test Loss: 1.221 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7336435317993164
Epoch: 37, Steps: 9 | Train Loss: 0.239 Vali Loss: 1.225 Vali Acc: 0.442 Test Loss: 1.225 Test Acc: 0.442
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.0438530445098877
Epoch: 38, Steps: 9 | Train Loss: 0.233 Vali Loss: 1.229 Vali Acc: 0.457 Test Loss: 1.229 Test Acc: 0.457
Validation loss decreased (-0.449263 --> -0.456509).  Saving model ...
Epoch: 39 cost time: 2.0579159259796143
Epoch: 39, Steps: 9 | Train Loss: 0.219 Vali Loss: 1.241 Vali Acc: 0.457 Test Loss: 1.241 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2463104724884033
Epoch: 40, Steps: 9 | Train Loss: 0.203 Vali Loss: 1.243 Vali Acc: 0.457 Test Loss: 1.243 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.073793411254883
Epoch: 41, Steps: 9 | Train Loss: 0.196 Vali Loss: 1.241 Vali Acc: 0.464 Test Loss: 1.241 Test Acc: 0.464
Validation loss decreased (-0.456509 --> -0.463756).  Saving model ...
Epoch: 42 cost time: 1.896026611328125
Epoch: 42, Steps: 9 | Train Loss: 0.177 Vali Loss: 1.233 Vali Acc: 0.478 Test Loss: 1.233 Test Acc: 0.478
Validation loss decreased (-0.463756 --> -0.478249).  Saving model ...
Epoch: 43 cost time: 1.7184240818023682
Epoch: 43, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.240 Vali Acc: 0.471 Test Loss: 1.240 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9563188552856445
Epoch: 44, Steps: 9 | Train Loss: 0.152 Vali Loss: 1.249 Vali Acc: 0.478 Test Loss: 1.249 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.9585540294647217
Epoch: 45, Steps: 9 | Train Loss: 0.146 Vali Loss: 1.242 Vali Acc: 0.478 Test Loss: 1.242 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.7190051078796387
Epoch: 46, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.235 Vali Acc: 0.478 Test Loss: 1.235 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6533126831054688
Epoch: 47, Steps: 9 | Train Loss: 0.118 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
Validation loss decreased (-0.478249 --> -0.485495).  Saving model ...
Epoch: 48 cost time: 1.5105023384094238
Epoch: 48, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.243 Vali Acc: 0.493 Test Loss: 1.243 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492741).  Saving model ...
Epoch: 49 cost time: 1.7129340171813965
Epoch: 49, Steps: 9 | Train Loss: 0.103 Vali Loss: 1.241 Vali Acc: 0.493 Test Loss: 1.241 Test Acc: 0.493
Validation loss decreased (-0.492741 --> -0.492741).  Saving model ...
Epoch: 50 cost time: 1.872023105621338
Epoch: 50, Steps: 9 | Train Loss: 0.102 Vali Loss: 1.246 Vali Acc: 0.478 Test Loss: 1.246 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.0026700496673584
Epoch: 51, Steps: 9 | Train Loss: 0.089 Vali Loss: 1.237 Vali Acc: 0.486 Test Loss: 1.237 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.8817474842071533
Epoch: 52, Steps: 9 | Train Loss: 0.086 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.7177081108093262
Epoch: 53, Steps: 9 | Train Loss: 0.085 Vali Loss: 1.231 Vali Acc: 0.493 Test Loss: 1.231 Test Acc: 0.493
Validation loss decreased (-0.492741 --> -0.492741).  Saving model ...
Epoch: 54 cost time: 1.7509729862213135
Epoch: 54, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.239 Vali Acc: 0.493 Test Loss: 1.239 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.8577775955200195
Epoch: 55, Steps: 9 | Train Loss: 0.071 Vali Loss: 1.247 Vali Acc: 0.507 Test Loss: 1.247 Test Acc: 0.507
Validation loss decreased (-0.492741 --> -0.507234).  Saving model ...
Epoch: 56 cost time: 1.8926944732666016
Epoch: 56, Steps: 9 | Train Loss: 0.064 Vali Loss: 1.245 Vali Acc: 0.522 Test Loss: 1.245 Test Acc: 0.522
Validation loss decreased (-0.507234 --> -0.521727).  Saving model ...
Epoch: 57 cost time: 2.143137216567993
Epoch: 57, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.250 Vali Acc: 0.529 Test Loss: 1.250 Test Acc: 0.529
Validation loss decreased (-0.521727 --> -0.528973).  Saving model ...
Epoch: 58 cost time: 2.2408530712127686
Epoch: 58, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.253 Vali Acc: 0.507 Test Loss: 1.253 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.189758777618408
Epoch: 59, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.253 Vali Acc: 0.522 Test Loss: 1.253 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.1698901653289795
Epoch: 60, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.262 Vali Acc: 0.507 Test Loss: 1.262 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.1521003246307373
Epoch: 61, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.394258499145508
Epoch: 62, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.270 Vali Acc: 0.493 Test Loss: 1.270 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.204575777053833
Epoch: 63, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.1302638053894043
Epoch: 64, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.277 Vali Acc: 0.514 Test Loss: 1.277 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.3104312419891357
Epoch: 65, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.273 Vali Acc: 0.522 Test Loss: 1.273 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.9595963954925537
Epoch: 66, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 2.3225138187408447
Epoch: 67, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w26_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5289855072463768
model parameter : 115068
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4685399532318115
Epoch: 1, Steps: 9 | Train Loss: 1.498 Vali Loss: 1.492 Vali Acc: 0.167 Test Loss: 1.492 Test Acc: 0.167
Validation loss decreased (inf --> -0.166652).  Saving model ...
Epoch: 2 cost time: 1.6952366828918457
Epoch: 2, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.466 Vali Acc: 0.188 Test Loss: 1.466 Test Acc: 0.188
Validation loss decreased (-0.166652 --> -0.188391).  Saving model ...
Epoch: 3 cost time: 1.6850614547729492
Epoch: 3, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.436 Vali Acc: 0.225 Test Loss: 1.436 Test Acc: 0.225
Validation loss decreased (-0.188391 --> -0.224623).  Saving model ...
Epoch: 4 cost time: 1.5481655597686768
Epoch: 4, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.407 Vali Acc: 0.319 Test Loss: 1.407 Test Acc: 0.319
Validation loss decreased (-0.224623 --> -0.318827).  Saving model ...
Epoch: 5 cost time: 1.5126011371612549
Epoch: 5, Steps: 9 | Train Loss: 1.309 Vali Loss: 1.381 Vali Acc: 0.355 Test Loss: 1.381 Test Acc: 0.355
Validation loss decreased (-0.318827 --> -0.355059).  Saving model ...
Epoch: 6 cost time: 1.6304645538330078
Epoch: 6, Steps: 9 | Train Loss: 1.218 Vali Loss: 1.359 Vali Acc: 0.384 Test Loss: 1.359 Test Acc: 0.384
Validation loss decreased (-0.355059 --> -0.384044).  Saving model ...
Epoch: 7 cost time: 1.3680589199066162
Epoch: 7, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.339 Vali Acc: 0.370 Test Loss: 1.339 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4499073028564453
Epoch: 8, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.319 Vali Acc: 0.435 Test Loss: 1.319 Test Acc: 0.435
Validation loss decreased (-0.384044 --> -0.434769).  Saving model ...
Epoch: 9 cost time: 1.829397439956665
Epoch: 9, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.300 Vali Acc: 0.442 Test Loss: 1.300 Test Acc: 0.442
Validation loss decreased (-0.434769 --> -0.442016).  Saving model ...
Epoch: 10 cost time: 1.4774582386016846
Epoch: 10, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.279 Vali Acc: 0.457 Test Loss: 1.279 Test Acc: 0.457
Validation loss decreased (-0.442016 --> -0.456509).  Saving model ...
Epoch: 11 cost time: 1.642707347869873
Epoch: 11, Steps: 9 | Train Loss: 0.991 Vali Loss: 1.260 Vali Acc: 0.478 Test Loss: 1.260 Test Acc: 0.478
Validation loss decreased (-0.456509 --> -0.478248).  Saving model ...
Epoch: 12 cost time: 1.2793612480163574
Epoch: 12, Steps: 9 | Train Loss: 0.933 Vali Loss: 1.244 Vali Acc: 0.486 Test Loss: 1.244 Test Acc: 0.486
Validation loss decreased (-0.478248 --> -0.485495).  Saving model ...
Epoch: 13 cost time: 1.260606288909912
Epoch: 13, Steps: 9 | Train Loss: 0.893 Vali Loss: 1.229 Vali Acc: 0.486 Test Loss: 1.229 Test Acc: 0.486
Validation loss decreased (-0.485495 --> -0.485495).  Saving model ...
Epoch: 14 cost time: 1.4750494956970215
Epoch: 14, Steps: 9 | Train Loss: 0.839 Vali Loss: 1.219 Vali Acc: 0.493 Test Loss: 1.219 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492741).  Saving model ...
Epoch: 15 cost time: 1.2527360916137695
Epoch: 15, Steps: 9 | Train Loss: 0.806 Vali Loss: 1.204 Vali Acc: 0.493 Test Loss: 1.204 Test Acc: 0.493
Validation loss decreased (-0.492741 --> -0.492742).  Saving model ...
Epoch: 16 cost time: 1.218116283416748
Epoch: 16, Steps: 9 | Train Loss: 0.770 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.492742 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.4434311389923096
Epoch: 17, Steps: 9 | Train Loss: 0.716 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.251971960067749
Epoch: 18, Steps: 9 | Train Loss: 0.681 Vali Loss: 1.167 Vali Acc: 0.507 Test Loss: 1.167 Test Acc: 0.507
Validation loss decreased (-0.499988 --> -0.507235).  Saving model ...
Epoch: 19 cost time: 1.3488123416900635
Epoch: 19, Steps: 9 | Train Loss: 0.637 Vali Loss: 1.164 Vali Acc: 0.493 Test Loss: 1.164 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.697021484375
Epoch: 20, Steps: 9 | Train Loss: 0.615 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
Validation loss decreased (-0.507235 --> -0.514481).  Saving model ...
Epoch: 21 cost time: 1.7668838500976562
Epoch: 21, Steps: 9 | Train Loss: 0.577 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514481).  Saving model ...
Epoch: 22 cost time: 1.419966697692871
Epoch: 22, Steps: 9 | Train Loss: 0.539 Vali Loss: 1.142 Vali Acc: 0.522 Test Loss: 1.142 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521728).  Saving model ...
Epoch: 23 cost time: 1.8893847465515137
Epoch: 23, Steps: 9 | Train Loss: 0.516 Vali Loss: 1.137 Vali Acc: 0.529 Test Loss: 1.137 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528974).  Saving model ...
Epoch: 24 cost time: 1.723461389541626
Epoch: 24, Steps: 9 | Train Loss: 0.485 Vali Loss: 1.128 Vali Acc: 0.536 Test Loss: 1.128 Test Acc: 0.536
Validation loss decreased (-0.528974 --> -0.536221).  Saving model ...
Epoch: 25 cost time: 1.815894365310669
Epoch: 25, Steps: 9 | Train Loss: 0.448 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.336930513381958
Epoch: 26, Steps: 9 | Train Loss: 0.409 Vali Loss: 1.113 Vali Acc: 0.536 Test Loss: 1.113 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536221).  Saving model ...
Epoch: 27 cost time: 1.4750328063964844
Epoch: 27, Steps: 9 | Train Loss: 0.391 Vali Loss: 1.113 Vali Acc: 0.536 Test Loss: 1.113 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536221).  Saving model ...
Epoch: 28 cost time: 1.5448503494262695
Epoch: 28, Steps: 9 | Train Loss: 0.378 Vali Loss: 1.110 Vali Acc: 0.522 Test Loss: 1.110 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3559930324554443
Epoch: 29, Steps: 9 | Train Loss: 0.353 Vali Loss: 1.100 Vali Acc: 0.529 Test Loss: 1.100 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6801722049713135
Epoch: 30, Steps: 9 | Train Loss: 0.317 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3965673446655273
Epoch: 31, Steps: 9 | Train Loss: 0.303 Vali Loss: 1.090 Vali Acc: 0.543 Test Loss: 1.090 Test Acc: 0.543
Validation loss decreased (-0.536221 --> -0.543467).  Saving model ...
Epoch: 32 cost time: 1.5833282470703125
Epoch: 32, Steps: 9 | Train Loss: 0.285 Vali Loss: 1.091 Vali Acc: 0.536 Test Loss: 1.091 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.652951955795288
Epoch: 33, Steps: 9 | Train Loss: 0.266 Vali Loss: 1.086 Vali Acc: 0.522 Test Loss: 1.086 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8549995422363281
Epoch: 34, Steps: 9 | Train Loss: 0.243 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.77534818649292
Epoch: 35, Steps: 9 | Train Loss: 0.230 Vali Loss: 1.092 Vali Acc: 0.514 Test Loss: 1.092 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7809295654296875
Epoch: 36, Steps: 9 | Train Loss: 0.213 Vali Loss: 1.086 Vali Acc: 0.522 Test Loss: 1.086 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.640836477279663
Epoch: 37, Steps: 9 | Train Loss: 0.189 Vali Loss: 1.088 Vali Acc: 0.507 Test Loss: 1.088 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5071115493774414
Epoch: 38, Steps: 9 | Train Loss: 0.178 Vali Loss: 1.091 Vali Acc: 0.551 Test Loss: 1.091 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550714).  Saving model ...
Epoch: 39 cost time: 1.858644962310791
Epoch: 39, Steps: 9 | Train Loss: 0.166 Vali Loss: 1.093 Vali Acc: 0.543 Test Loss: 1.093 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9022979736328125
Epoch: 40, Steps: 9 | Train Loss: 0.157 Vali Loss: 1.090 Vali Acc: 0.543 Test Loss: 1.090 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.628352165222168
Epoch: 41, Steps: 9 | Train Loss: 0.152 Vali Loss: 1.099 Vali Acc: 0.551 Test Loss: 1.099 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.411595106124878
Epoch: 42, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.097 Vali Acc: 0.543 Test Loss: 1.097 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4004478454589844
Epoch: 43, Steps: 9 | Train Loss: 0.131 Vali Loss: 1.093 Vali Acc: 0.543 Test Loss: 1.093 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6288936138153076
Epoch: 44, Steps: 9 | Train Loss: 0.118 Vali Loss: 1.098 Vali Acc: 0.543 Test Loss: 1.098 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5059599876403809
Epoch: 45, Steps: 9 | Train Loss: 0.116 Vali Loss: 1.099 Vali Acc: 0.551 Test Loss: 1.099 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.6674096584320068
Epoch: 46, Steps: 9 | Train Loss: 0.110 Vali Loss: 1.098 Vali Acc: 0.543 Test Loss: 1.098 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.5166668891906738
Epoch: 47, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.105 Vali Acc: 0.543 Test Loss: 1.105 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2416942119598389
Epoch: 48, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.100 Vali Acc: 0.543 Test Loss: 1.100 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w21_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5507246376811594
model parameter : 113788
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9748952388763428
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.441 Vali Acc: 0.203 Test Loss: 1.441 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 1.2459750175476074
Epoch: 2, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.422 Vali Acc: 0.210 Test Loss: 1.422 Test Acc: 0.210
Validation loss decreased (-0.202884 --> -0.210131).  Saving model ...
Epoch: 3 cost time: 1.6124868392944336
Epoch: 3, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.400 Vali Acc: 0.217 Test Loss: 1.400 Test Acc: 0.217
Validation loss decreased (-0.210131 --> -0.217377).  Saving model ...
Epoch: 4 cost time: 1.6383883953094482
Epoch: 4, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.369 Vali Acc: 0.239 Test Loss: 1.369 Test Acc: 0.239
Validation loss decreased (-0.217377 --> -0.239117).  Saving model ...
Epoch: 5 cost time: 1.5486946105957031
Epoch: 5, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.339 Vali Acc: 0.268 Test Loss: 1.339 Test Acc: 0.268
Validation loss decreased (-0.239117 --> -0.268103).  Saving model ...
Epoch: 6 cost time: 1.3109807968139648
Epoch: 6, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.310 Vali Acc: 0.304 Test Loss: 1.310 Test Acc: 0.304
Validation loss decreased (-0.268103 --> -0.304335).  Saving model ...
Epoch: 7 cost time: 1.452803611755371
Epoch: 7, Steps: 9 | Train Loss: 1.113 Vali Loss: 1.287 Vali Acc: 0.326 Test Loss: 1.287 Test Acc: 0.326
Validation loss decreased (-0.304335 --> -0.326074).  Saving model ...
Epoch: 8 cost time: 1.4838957786560059
Epoch: 8, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.266 Vali Acc: 0.312 Test Loss: 1.266 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4523212909698486
Epoch: 9, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.250 Vali Acc: 0.355 Test Loss: 1.250 Test Acc: 0.355
Validation loss decreased (-0.326074 --> -0.355060).  Saving model ...
Epoch: 10 cost time: 1.3618817329406738
Epoch: 10, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.234 Vali Acc: 0.348 Test Loss: 1.234 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2814059257507324
Epoch: 11, Steps: 9 | Train Loss: 0.910 Vali Loss: 1.218 Vali Acc: 0.377 Test Loss: 1.218 Test Acc: 0.377
Validation loss decreased (-0.355060 --> -0.376799).  Saving model ...
Epoch: 12 cost time: 1.7129223346710205
Epoch: 12, Steps: 9 | Train Loss: 0.853 Vali Loss: 1.203 Vali Acc: 0.399 Test Loss: 1.203 Test Acc: 0.399
Validation loss decreased (-0.376799 --> -0.398539).  Saving model ...
Epoch: 13 cost time: 1.458575963973999
Epoch: 13, Steps: 9 | Train Loss: 0.806 Vali Loss: 1.186 Vali Acc: 0.413 Test Loss: 1.186 Test Acc: 0.413
Validation loss decreased (-0.398539 --> -0.413032).  Saving model ...
Epoch: 14 cost time: 1.398874044418335
Epoch: 14, Steps: 9 | Train Loss: 0.775 Vali Loss: 1.175 Vali Acc: 0.435 Test Loss: 1.175 Test Acc: 0.435
Validation loss decreased (-0.413032 --> -0.434771).  Saving model ...
Epoch: 15 cost time: 1.3241126537322998
Epoch: 15, Steps: 9 | Train Loss: 0.742 Vali Loss: 1.167 Vali Acc: 0.442 Test Loss: 1.167 Test Acc: 0.442
Validation loss decreased (-0.434771 --> -0.442017).  Saving model ...
Epoch: 16 cost time: 1.3501789569854736
Epoch: 16, Steps: 9 | Train Loss: 0.711 Vali Loss: 1.156 Vali Acc: 0.457 Test Loss: 1.156 Test Acc: 0.457
Validation loss decreased (-0.442017 --> -0.456510).  Saving model ...
Epoch: 17 cost time: 1.5508606433868408
Epoch: 17, Steps: 9 | Train Loss: 0.660 Vali Loss: 1.147 Vali Acc: 0.457 Test Loss: 1.147 Test Acc: 0.457
Validation loss decreased (-0.456510 --> -0.456510).  Saving model ...
Epoch: 18 cost time: 1.5513484477996826
Epoch: 18, Steps: 9 | Train Loss: 0.613 Vali Loss: 1.130 Vali Acc: 0.464 Test Loss: 1.130 Test Acc: 0.464
Validation loss decreased (-0.456510 --> -0.463757).  Saving model ...
Epoch: 19 cost time: 1.3979597091674805
Epoch: 19, Steps: 9 | Train Loss: 0.576 Vali Loss: 1.119 Vali Acc: 0.471 Test Loss: 1.119 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471003).  Saving model ...
Epoch: 20 cost time: 1.3917036056518555
Epoch: 20, Steps: 9 | Train Loss: 0.546 Vali Loss: 1.106 Vali Acc: 0.493 Test Loss: 1.106 Test Acc: 0.493
Validation loss decreased (-0.471003 --> -0.492743).  Saving model ...
Epoch: 21 cost time: 1.3770968914031982
Epoch: 21, Steps: 9 | Train Loss: 0.504 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
Validation loss decreased (-0.492743 --> -0.499989).  Saving model ...
Epoch: 22 cost time: 1.5025935173034668
Epoch: 22, Steps: 9 | Train Loss: 0.465 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 23 cost time: 1.3425846099853516
Epoch: 23, Steps: 9 | Train Loss: 0.437 Vali Loss: 1.081 Vali Acc: 0.507 Test Loss: 1.081 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.507236).  Saving model ...
Epoch: 24 cost time: 1.4830586910247803
Epoch: 24, Steps: 9 | Train Loss: 0.419 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
Validation loss decreased (-0.507236 --> -0.514482).  Saving model ...
Epoch: 25 cost time: 1.5277655124664307
Epoch: 25, Steps: 9 | Train Loss: 0.387 Vali Loss: 1.071 Vali Acc: 0.522 Test Loss: 1.071 Test Acc: 0.522
Validation loss decreased (-0.514482 --> -0.521728).  Saving model ...
Epoch: 26 cost time: 1.4975218772888184
Epoch: 26, Steps: 9 | Train Loss: 0.355 Vali Loss: 1.065 Vali Acc: 0.522 Test Loss: 1.065 Test Acc: 0.522
Validation loss decreased (-0.521728 --> -0.521728).  Saving model ...
Epoch: 27 cost time: 1.3959813117980957
Epoch: 27, Steps: 9 | Train Loss: 0.319 Vali Loss: 1.060 Vali Acc: 0.543 Test Loss: 1.060 Test Acc: 0.543
Validation loss decreased (-0.521728 --> -0.543468).  Saving model ...
Epoch: 28 cost time: 1.3811531066894531
Epoch: 28, Steps: 9 | Train Loss: 0.305 Vali Loss: 1.054 Vali Acc: 0.543 Test Loss: 1.054 Test Acc: 0.543
Validation loss decreased (-0.543468 --> -0.543468).  Saving model ...
Epoch: 29 cost time: 1.6277377605438232
Epoch: 29, Steps: 9 | Train Loss: 0.271 Vali Loss: 1.052 Vali Acc: 0.551 Test Loss: 1.052 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550714).  Saving model ...
Epoch: 30 cost time: 1.5251350402832031
Epoch: 30, Steps: 9 | Train Loss: 0.254 Vali Loss: 1.055 Vali Acc: 0.536 Test Loss: 1.055 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4092931747436523
Epoch: 31, Steps: 9 | Train Loss: 0.229 Vali Loss: 1.055 Vali Acc: 0.543 Test Loss: 1.055 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3391718864440918
Epoch: 32, Steps: 9 | Train Loss: 0.202 Vali Loss: 1.056 Vali Acc: 0.522 Test Loss: 1.056 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5905892848968506
Epoch: 33, Steps: 9 | Train Loss: 0.193 Vali Loss: 1.054 Vali Acc: 0.529 Test Loss: 1.054 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3247761726379395
Epoch: 34, Steps: 9 | Train Loss: 0.177 Vali Loss: 1.049 Vali Acc: 0.551 Test Loss: 1.049 Test Acc: 0.551
Validation loss decreased (-0.550714 --> -0.550714).  Saving model ...
Epoch: 35 cost time: 1.3833045959472656
Epoch: 35, Steps: 9 | Train Loss: 0.171 Vali Loss: 1.053 Vali Acc: 0.551 Test Loss: 1.053 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3325798511505127
Epoch: 36, Steps: 9 | Train Loss: 0.147 Vali Loss: 1.054 Vali Acc: 0.558 Test Loss: 1.054 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557960).  Saving model ...
Epoch: 37 cost time: 1.485107660293579
Epoch: 37, Steps: 9 | Train Loss: 0.136 Vali Loss: 1.055 Vali Acc: 0.536 Test Loss: 1.055 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3689141273498535
Epoch: 38, Steps: 9 | Train Loss: 0.128 Vali Loss: 1.052 Vali Acc: 0.543 Test Loss: 1.052 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.536283016204834
Epoch: 39, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.050 Vali Acc: 0.558 Test Loss: 1.050 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557961).  Saving model ...
Epoch: 40 cost time: 1.6388967037200928
Epoch: 40, Steps: 9 | Train Loss: 0.110 Vali Loss: 1.051 Vali Acc: 0.558 Test Loss: 1.051 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2204163074493408
Epoch: 41, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.052 Vali Acc: 0.551 Test Loss: 1.052 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4756736755371094
Epoch: 42, Steps: 9 | Train Loss: 0.092 Vali Loss: 1.057 Vali Acc: 0.558 Test Loss: 1.057 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.8337533473968506
Epoch: 43, Steps: 9 | Train Loss: 0.087 Vali Loss: 1.058 Vali Acc: 0.565 Test Loss: 1.058 Test Acc: 0.565
Validation loss decreased (-0.557961 --> -0.565207).  Saving model ...
Epoch: 44 cost time: 1.5063471794128418
Epoch: 44, Steps: 9 | Train Loss: 0.080 Vali Loss: 1.060 Vali Acc: 0.558 Test Loss: 1.060 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.41153883934021
Epoch: 45, Steps: 9 | Train Loss: 0.077 Vali Loss: 1.061 Vali Acc: 0.565 Test Loss: 1.061 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.5971717834472656
Epoch: 46, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.064 Vali Acc: 0.551 Test Loss: 1.064 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.9021832942962646
Epoch: 47, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.070 Vali Acc: 0.558 Test Loss: 1.070 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.8557641506195068
Epoch: 48, Steps: 9 | Train Loss: 0.060 Vali Loss: 1.075 Vali Acc: 0.551 Test Loss: 1.075 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.5769693851470947
Epoch: 49, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.077 Vali Acc: 0.558 Test Loss: 1.077 Test Acc: 0.558
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.957402229309082
Epoch: 50, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.075 Vali Acc: 0.558 Test Loss: 1.075 Test Acc: 0.558
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.6218860149383545
Epoch: 51, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.072 Vali Acc: 0.558 Test Loss: 1.072 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.5563304424285889
Epoch: 52, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.080 Vali Acc: 0.565 Test Loss: 1.080 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.7800142765045166
Epoch: 53, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.087 Vali Acc: 0.565 Test Loss: 1.087 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w16_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 112508
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2810683250427246
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.394 Vali Acc: 0.246 Test Loss: 1.394 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.129831314086914
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.376 Vali Acc: 0.246 Test Loss: 1.376 Test Acc: 0.246
Validation loss decreased (-0.246363 --> -0.246363).  Saving model ...
Epoch: 3 cost time: 0.9990909099578857
Epoch: 3, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.353 Vali Acc: 0.333 Test Loss: 1.353 Test Acc: 0.333
Validation loss decreased (-0.246363 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 1.1756155490875244
Epoch: 4, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.332 Vali Acc: 0.377 Test Loss: 1.332 Test Acc: 0.377
Validation loss decreased (-0.333320 --> -0.376798).  Saving model ...
Epoch: 5 cost time: 1.1544175148010254
Epoch: 5, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.310 Vali Acc: 0.377 Test Loss: 1.310 Test Acc: 0.377
Validation loss decreased (-0.376798 --> -0.376798).  Saving model ...
Epoch: 6 cost time: 1.2023506164550781
Epoch: 6, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.290 Vali Acc: 0.370 Test Loss: 1.290 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.121793270111084
Epoch: 7, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.271 Vali Acc: 0.399 Test Loss: 1.271 Test Acc: 0.399
Validation loss decreased (-0.376798 --> -0.398538).  Saving model ...
Epoch: 8 cost time: 1.006734848022461
Epoch: 8, Steps: 9 | Train Loss: 1.183 Vali Loss: 1.254 Vali Acc: 0.384 Test Loss: 1.254 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9333286285400391
Epoch: 9, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.237 Vali Acc: 0.413 Test Loss: 1.237 Test Acc: 0.413
Validation loss decreased (-0.398538 --> -0.413031).  Saving model ...
Epoch: 10 cost time: 1.0995244979858398
Epoch: 10, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.219 Vali Acc: 0.413 Test Loss: 1.219 Test Acc: 0.413
Validation loss decreased (-0.413031 --> -0.413031).  Saving model ...
Epoch: 11 cost time: 1.319495439529419
Epoch: 11, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.199 Vali Acc: 0.471 Test Loss: 1.199 Test Acc: 0.471
Validation loss decreased (-0.413031 --> -0.471003).  Saving model ...
Epoch: 12 cost time: 1.1850039958953857
Epoch: 12, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
Validation loss decreased (-0.471003 --> -0.514481).  Saving model ...
Epoch: 13 cost time: 1.0236835479736328
Epoch: 13, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514481).  Saving model ...
Epoch: 14 cost time: 1.1520278453826904
Epoch: 14, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.154 Vali Acc: 0.551 Test Loss: 1.154 Test Acc: 0.551
Validation loss decreased (-0.514481 --> -0.550713).  Saving model ...
Epoch: 15 cost time: 1.0926671028137207
Epoch: 15, Steps: 9 | Train Loss: 0.926 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.282193899154663
Epoch: 16, Steps: 9 | Train Loss: 0.886 Vali Loss: 1.120 Vali Acc: 0.493 Test Loss: 1.120 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2372112274169922
Epoch: 17, Steps: 9 | Train Loss: 0.842 Vali Loss: 1.112 Vali Acc: 0.543 Test Loss: 1.112 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.205348253250122
Epoch: 18, Steps: 9 | Train Loss: 0.788 Vali Loss: 1.100 Vali Acc: 0.565 Test Loss: 1.100 Test Acc: 0.565
Validation loss decreased (-0.550713 --> -0.565206).  Saving model ...
Epoch: 19 cost time: 1.1179242134094238
Epoch: 19, Steps: 9 | Train Loss: 0.720 Vali Loss: 1.085 Vali Acc: 0.558 Test Loss: 1.085 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1661787033081055
Epoch: 20, Steps: 9 | Train Loss: 0.681 Vali Loss: 1.081 Vali Acc: 0.558 Test Loss: 1.081 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1575469970703125
Epoch: 21, Steps: 9 | Train Loss: 0.631 Vali Loss: 1.080 Vali Acc: 0.543 Test Loss: 1.080 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1525838375091553
Epoch: 22, Steps: 9 | Train Loss: 0.596 Vali Loss: 1.069 Vali Acc: 0.558 Test Loss: 1.069 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0209357738494873
Epoch: 23, Steps: 9 | Train Loss: 0.547 Vali Loss: 1.070 Vali Acc: 0.565 Test Loss: 1.070 Test Acc: 0.565
Validation loss decreased (-0.565206 --> -0.565207).  Saving model ...
Epoch: 24 cost time: 1.398268461227417
Epoch: 24, Steps: 9 | Train Loss: 0.503 Vali Loss: 1.057 Vali Acc: 0.572 Test Loss: 1.057 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572453).  Saving model ...
Epoch: 25 cost time: 1.7301714420318604
Epoch: 25, Steps: 9 | Train Loss: 0.478 Vali Loss: 1.052 Vali Acc: 0.572 Test Loss: 1.052 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 26 cost time: 1.1335530281066895
Epoch: 26, Steps: 9 | Train Loss: 0.436 Vali Loss: 1.045 Vali Acc: 0.558 Test Loss: 1.045 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4626829624176025
Epoch: 27, Steps: 9 | Train Loss: 0.393 Vali Loss: 1.044 Vali Acc: 0.572 Test Loss: 1.044 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 28 cost time: 1.2634410858154297
Epoch: 28, Steps: 9 | Train Loss: 0.350 Vali Loss: 1.032 Vali Acc: 0.565 Test Loss: 1.032 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3353345394134521
Epoch: 29, Steps: 9 | Train Loss: 0.329 Vali Loss: 1.030 Vali Acc: 0.587 Test Loss: 1.030 Test Acc: 0.587
Validation loss decreased (-0.572453 --> -0.586946).  Saving model ...
Epoch: 30 cost time: 1.2379515171051025
Epoch: 30, Steps: 9 | Train Loss: 0.285 Vali Loss: 1.035 Vali Acc: 0.572 Test Loss: 1.035 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4908227920532227
Epoch: 31, Steps: 9 | Train Loss: 0.275 Vali Loss: 1.035 Vali Acc: 0.558 Test Loss: 1.035 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.658376932144165
Epoch: 32, Steps: 9 | Train Loss: 0.245 Vali Loss: 1.054 Vali Acc: 0.543 Test Loss: 1.054 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5043997764587402
Epoch: 33, Steps: 9 | Train Loss: 0.240 Vali Loss: 1.056 Vali Acc: 0.572 Test Loss: 1.056 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7891349792480469
Epoch: 34, Steps: 9 | Train Loss: 0.212 Vali Loss: 1.055 Vali Acc: 0.551 Test Loss: 1.055 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3736605644226074
Epoch: 35, Steps: 9 | Train Loss: 0.181 Vali Loss: 1.047 Vali Acc: 0.580 Test Loss: 1.047 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.118422508239746
Epoch: 36, Steps: 9 | Train Loss: 0.171 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.631753921508789
Epoch: 37, Steps: 9 | Train Loss: 0.148 Vali Loss: 1.073 Vali Acc: 0.580 Test Loss: 1.073 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.355661153793335
Epoch: 38, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.078 Vali Acc: 0.565 Test Loss: 1.078 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4211511611938477
Epoch: 39, Steps: 9 | Train Loss: 0.126 Vali Loss: 1.080 Vali Acc: 0.551 Test Loss: 1.080 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w11_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5869565217391305
model parameter : 111228
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0356345176696777
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.457 Vali Acc: 0.188 Test Loss: 1.457 Test Acc: 0.188
Validation loss decreased (inf --> -0.188391).  Saving model ...
Epoch: 2 cost time: 1.4694809913635254
Epoch: 2, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.440 Vali Acc: 0.210 Test Loss: 1.440 Test Acc: 0.210
Validation loss decreased (-0.188391 --> -0.210131).  Saving model ...
Epoch: 3 cost time: 1.2546839714050293
Epoch: 3, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.416 Vali Acc: 0.232 Test Loss: 1.416 Test Acc: 0.232
Validation loss decreased (-0.210131 --> -0.231870).  Saving model ...
Epoch: 4 cost time: 1.0079195499420166
Epoch: 4, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.390 Vali Acc: 0.268 Test Loss: 1.390 Test Acc: 0.268
Validation loss decreased (-0.231870 --> -0.268102).  Saving model ...
Epoch: 5 cost time: 1.3818151950836182
Epoch: 5, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.365 Vali Acc: 0.275 Test Loss: 1.365 Test Acc: 0.275
Validation loss decreased (-0.268102 --> -0.275349).  Saving model ...
Epoch: 6 cost time: 1.146712303161621
Epoch: 6, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.343 Vali Acc: 0.290 Test Loss: 1.343 Test Acc: 0.290
Validation loss decreased (-0.275349 --> -0.289842).  Saving model ...
Epoch: 7 cost time: 0.9716432094573975
Epoch: 7, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.326 Vali Acc: 0.290 Test Loss: 1.326 Test Acc: 0.290
Validation loss decreased (-0.289842 --> -0.289842).  Saving model ...
Epoch: 8 cost time: 1.1819145679473877
Epoch: 8, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.311 Vali Acc: 0.297 Test Loss: 1.311 Test Acc: 0.297
Validation loss decreased (-0.289842 --> -0.297088).  Saving model ...
Epoch: 9 cost time: 1.0014307498931885
Epoch: 9, Steps: 9 | Train Loss: 1.035 Vali Loss: 1.298 Vali Acc: 0.326 Test Loss: 1.298 Test Acc: 0.326
Validation loss decreased (-0.297088 --> -0.326074).  Saving model ...
Epoch: 10 cost time: 1.2284646034240723
Epoch: 10, Steps: 9 | Train Loss: 1.004 Vali Loss: 1.289 Vali Acc: 0.348 Test Loss: 1.289 Test Acc: 0.348
Validation loss decreased (-0.326074 --> -0.347813).  Saving model ...
Epoch: 11 cost time: 0.9670290946960449
Epoch: 11, Steps: 9 | Train Loss: 0.944 Vali Loss: 1.280 Vali Acc: 0.362 Test Loss: 1.280 Test Acc: 0.362
Validation loss decreased (-0.347813 --> -0.362306).  Saving model ...
Epoch: 12 cost time: 1.3860726356506348
Epoch: 12, Steps: 9 | Train Loss: 0.907 Vali Loss: 1.274 Vali Acc: 0.384 Test Loss: 1.274 Test Acc: 0.384
Validation loss decreased (-0.362306 --> -0.384045).  Saving model ...
Epoch: 13 cost time: 1.145848274230957
Epoch: 13, Steps: 9 | Train Loss: 0.882 Vali Loss: 1.266 Vali Acc: 0.391 Test Loss: 1.266 Test Acc: 0.391
Validation loss decreased (-0.384045 --> -0.391292).  Saving model ...
Epoch: 14 cost time: 1.4159808158874512
Epoch: 14, Steps: 9 | Train Loss: 0.832 Vali Loss: 1.259 Vali Acc: 0.399 Test Loss: 1.259 Test Acc: 0.399
Validation loss decreased (-0.391292 --> -0.398538).  Saving model ...
Epoch: 15 cost time: 0.985600471496582
Epoch: 15, Steps: 9 | Train Loss: 0.791 Vali Loss: 1.248 Vali Acc: 0.406 Test Loss: 1.248 Test Acc: 0.406
Validation loss decreased (-0.398538 --> -0.405785).  Saving model ...
Epoch: 16 cost time: 1.0878539085388184
Epoch: 16, Steps: 9 | Train Loss: 0.743 Vali Loss: 1.236 Vali Acc: 0.399 Test Loss: 1.236 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1907057762145996
Epoch: 17, Steps: 9 | Train Loss: 0.712 Vali Loss: 1.234 Vali Acc: 0.406 Test Loss: 1.234 Test Acc: 0.406
Validation loss decreased (-0.405785 --> -0.405785).  Saving model ...
Epoch: 18 cost time: 1.0190398693084717
Epoch: 18, Steps: 9 | Train Loss: 0.675 Vali Loss: 1.224 Vali Acc: 0.406 Test Loss: 1.224 Test Acc: 0.406
Validation loss decreased (-0.405785 --> -0.405785).  Saving model ...
Epoch: 19 cost time: 1.179473638534546
Epoch: 19, Steps: 9 | Train Loss: 0.634 Vali Loss: 1.209 Vali Acc: 0.428 Test Loss: 1.209 Test Acc: 0.428
Validation loss decreased (-0.405785 --> -0.427524).  Saving model ...
Epoch: 20 cost time: 1.1963372230529785
Epoch: 20, Steps: 9 | Train Loss: 0.601 Vali Loss: 1.195 Vali Acc: 0.435 Test Loss: 1.195 Test Acc: 0.435
Validation loss decreased (-0.427524 --> -0.434771).  Saving model ...
Epoch: 21 cost time: 1.1504077911376953
Epoch: 21, Steps: 9 | Train Loss: 0.556 Vali Loss: 1.191 Vali Acc: 0.449 Test Loss: 1.191 Test Acc: 0.449
Validation loss decreased (-0.434771 --> -0.449263).  Saving model ...
Epoch: 22 cost time: 1.3936445713043213
Epoch: 22, Steps: 9 | Train Loss: 0.512 Vali Loss: 1.181 Vali Acc: 0.420 Test Loss: 1.181 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0961668491363525
Epoch: 23, Steps: 9 | Train Loss: 0.497 Vali Loss: 1.177 Vali Acc: 0.428 Test Loss: 1.177 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3694956302642822
Epoch: 24, Steps: 9 | Train Loss: 0.452 Vali Loss: 1.174 Vali Acc: 0.442 Test Loss: 1.174 Test Acc: 0.442
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.204197883605957
Epoch: 25, Steps: 9 | Train Loss: 0.438 Vali Loss: 1.165 Vali Acc: 0.442 Test Loss: 1.165 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0263798236846924
Epoch: 26, Steps: 9 | Train Loss: 0.409 Vali Loss: 1.155 Vali Acc: 0.457 Test Loss: 1.155 Test Acc: 0.457
Validation loss decreased (-0.449263 --> -0.456510).  Saving model ...
Epoch: 27 cost time: 1.3592724800109863
Epoch: 27, Steps: 9 | Train Loss: 0.370 Vali Loss: 1.151 Vali Acc: 0.464 Test Loss: 1.151 Test Acc: 0.464
Validation loss decreased (-0.456510 --> -0.463757).  Saving model ...
Epoch: 28 cost time: 1.2325551509857178
Epoch: 28, Steps: 9 | Train Loss: 0.338 Vali Loss: 1.151 Vali Acc: 0.471 Test Loss: 1.151 Test Acc: 0.471
Validation loss decreased (-0.463757 --> -0.471003).  Saving model ...
Epoch: 29 cost time: 1.3769018650054932
Epoch: 29, Steps: 9 | Train Loss: 0.329 Vali Loss: 1.150 Vali Acc: 0.457 Test Loss: 1.150 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.046278715133667
Epoch: 30, Steps: 9 | Train Loss: 0.297 Vali Loss: 1.147 Vali Acc: 0.471 Test Loss: 1.147 Test Acc: 0.471
Validation loss decreased (-0.471003 --> -0.471003).  Saving model ...
Epoch: 31 cost time: 0.9616789817810059
Epoch: 31, Steps: 9 | Train Loss: 0.272 Vali Loss: 1.147 Vali Acc: 0.478 Test Loss: 1.147 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478249).  Saving model ...
Epoch: 32 cost time: 1.0100395679473877
Epoch: 32, Steps: 9 | Train Loss: 0.248 Vali Loss: 1.148 Vali Acc: 0.486 Test Loss: 1.148 Test Acc: 0.486
Validation loss decreased (-0.478249 --> -0.485496).  Saving model ...
Epoch: 33 cost time: 1.3455004692077637
Epoch: 33, Steps: 9 | Train Loss: 0.236 Vali Loss: 1.143 Vali Acc: 0.493 Test Loss: 1.143 Test Acc: 0.493
Validation loss decreased (-0.485496 --> -0.492742).  Saving model ...
Epoch: 34 cost time: 0.939110517501831
Epoch: 34, Steps: 9 | Train Loss: 0.198 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.492742 --> -0.499989).  Saving model ...
Epoch: 35 cost time: 1.2596251964569092
Epoch: 35, Steps: 9 | Train Loss: 0.192 Vali Loss: 1.132 Vali Acc: 0.493 Test Loss: 1.132 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0855484008789062
Epoch: 36, Steps: 9 | Train Loss: 0.177 Vali Loss: 1.133 Vali Acc: 0.493 Test Loss: 1.133 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2236416339874268
Epoch: 37, Steps: 9 | Train Loss: 0.161 Vali Loss: 1.129 Vali Acc: 0.486 Test Loss: 1.129 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2419602870941162
Epoch: 38, Steps: 9 | Train Loss: 0.144 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.514481).  Saving model ...
Epoch: 39 cost time: 1.4158215522766113
Epoch: 39, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2964982986450195
Epoch: 40, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9523100852966309
Epoch: 41, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.136 Vali Acc: 0.493 Test Loss: 1.136 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.139977216720581
Epoch: 42, Steps: 9 | Train Loss: 0.101 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.3989143371582031
Epoch: 43, Steps: 9 | Train Loss: 0.095 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.230013132095337
Epoch: 44, Steps: 9 | Train Loss: 0.087 Vali Loss: 1.155 Vali Acc: 0.522 Test Loss: 1.155 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521728).  Saving model ...
Epoch: 45 cost time: 1.076754093170166
Epoch: 45, Steps: 9 | Train Loss: 0.094 Vali Loss: 1.148 Vali Acc: 0.529 Test Loss: 1.148 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528974).  Saving model ...
Epoch: 46 cost time: 0.9975292682647705
Epoch: 46, Steps: 9 | Train Loss: 0.075 Vali Loss: 1.146 Vali Acc: 0.529 Test Loss: 1.146 Test Acc: 0.529
Validation loss decreased (-0.528974 --> -0.528974).  Saving model ...
Epoch: 47 cost time: 1.0182790756225586
Epoch: 47, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.149 Vali Acc: 0.529 Test Loss: 1.149 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0971686840057373
Epoch: 48, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.151 Vali Acc: 0.529 Test Loss: 1.151 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2245666980743408
Epoch: 49, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.159 Vali Acc: 0.536 Test Loss: 1.159 Test Acc: 0.536
Validation loss decreased (-0.528974 --> -0.536220).  Saving model ...
Epoch: 50 cost time: 1.2113010883331299
Epoch: 50, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.158 Vali Acc: 0.536 Test Loss: 1.158 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536220).  Saving model ...
Epoch: 51 cost time: 1.1310577392578125
Epoch: 51, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.156 Vali Acc: 0.536 Test Loss: 1.156 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536220).  Saving model ...
Epoch: 52 cost time: 0.9913091659545898
Epoch: 52, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.161 Vali Acc: 0.536 Test Loss: 1.161 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9612524509429932
Epoch: 53, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.160 Vali Acc: 0.543 Test Loss: 1.160 Test Acc: 0.543
Validation loss decreased (-0.536220 --> -0.543467).  Saving model ...
Epoch: 54 cost time: 1.0275092124938965
Epoch: 54, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.158 Vali Acc: 0.543 Test Loss: 1.158 Test Acc: 0.543
Validation loss decreased (-0.543467 --> -0.543467).  Saving model ...
Epoch: 55 cost time: 1.271646499633789
Epoch: 55, Steps: 9 | Train Loss: 0.036 Vali Loss: 1.168 Vali Acc: 0.543 Test Loss: 1.168 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1181950569152832
Epoch: 56, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.173 Vali Acc: 0.551 Test Loss: 1.173 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550713).  Saving model ...
Epoch: 57 cost time: 1.3154034614562988
Epoch: 57, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.169 Vali Acc: 0.543 Test Loss: 1.169 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.405989170074463
Epoch: 58, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.158 Vali Acc: 0.543 Test Loss: 1.158 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0921220779418945
Epoch: 59, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.162 Vali Acc: 0.536 Test Loss: 1.162 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1575126647949219
Epoch: 60, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.162 Vali Acc: 0.536 Test Loss: 1.162 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.1093149185180664
Epoch: 61, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.163 Vali Acc: 0.543 Test Loss: 1.163 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.1722455024719238
Epoch: 62, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.164 Vali Acc: 0.543 Test Loss: 1.164 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.2740705013275146
Epoch: 63, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.169 Vali Acc: 0.551 Test Loss: 1.169 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550713).  Saving model ...
Epoch: 64 cost time: 1.016291618347168
Epoch: 64, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.175 Vali Acc: 0.551 Test Loss: 1.175 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.022782802581787
Epoch: 65, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.170 Vali Acc: 0.558 Test Loss: 1.170 Test Acc: 0.558
Validation loss decreased (-0.550713 --> -0.557959).  Saving model ...
Epoch: 66 cost time: 1.2255830764770508
Epoch: 66, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.173 Vali Acc: 0.558 Test Loss: 1.173 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1545045375823975
Epoch: 67, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.178 Vali Acc: 0.558 Test Loss: 1.178 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.4125347137451172
Epoch: 68, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.179 Vali Acc: 0.558 Test Loss: 1.179 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9410247802734375
Epoch: 69, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.183 Vali Acc: 0.551 Test Loss: 1.183 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.0835142135620117
Epoch: 70, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.184 Vali Acc: 0.558 Test Loss: 1.184 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.4482593536376953
Epoch: 71, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.188 Vali Acc: 0.551 Test Loss: 1.188 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.196593999862671
Epoch: 72, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.191 Vali Acc: 0.558 Test Loss: 1.191 Test Acc: 0.558
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.1191120147705078
Epoch: 73, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.198 Vali Acc: 0.558 Test Loss: 1.198 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.111602783203125
Epoch: 74, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.202 Vali Acc: 0.558 Test Loss: 1.202 Test Acc: 0.558
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.2079768180847168
Epoch: 75, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.198 Vali Acc: 0.558 Test Loss: 1.198 Test Acc: 0.558
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w7_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5579710144927537
model parameter : 110204
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.258807420730591
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.414 Vali Acc: 0.341 Test Loss: 1.414 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.3404431343078613
Epoch: 2, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.392 Vali Acc: 0.362 Test Loss: 1.392 Test Acc: 0.362
Validation loss decreased (-0.340566 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 1.0632083415985107
Epoch: 3, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.365 Vali Acc: 0.377 Test Loss: 1.365 Test Acc: 0.377
Validation loss decreased (-0.362305 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 0.9682631492614746
Epoch: 4, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.340 Vali Acc: 0.399 Test Loss: 1.340 Test Acc: 0.399
Validation loss decreased (-0.376798 --> -0.398537).  Saving model ...
Epoch: 5 cost time: 0.9668452739715576
Epoch: 5, Steps: 9 | Train Loss: 1.157 Vali Loss: 1.312 Vali Acc: 0.420 Test Loss: 1.312 Test Acc: 0.420
Validation loss decreased (-0.398537 --> -0.420277).  Saving model ...
Epoch: 6 cost time: 0.946458101272583
Epoch: 6, Steps: 9 | Train Loss: 1.094 Vali Loss: 1.286 Vali Acc: 0.428 Test Loss: 1.286 Test Acc: 0.428
Validation loss decreased (-0.420277 --> -0.427523).  Saving model ...
Epoch: 7 cost time: 1.2278525829315186
Epoch: 7, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.269 Vali Acc: 0.442 Test Loss: 1.269 Test Acc: 0.442
Validation loss decreased (-0.427523 --> -0.442016).  Saving model ...
Epoch: 8 cost time: 1.2625741958618164
Epoch: 8, Steps: 9 | Train Loss: 0.973 Vali Loss: 1.251 Vali Acc: 0.471 Test Loss: 1.251 Test Acc: 0.471
Validation loss decreased (-0.442016 --> -0.471002).  Saving model ...
Epoch: 9 cost time: 1.6421210765838623
Epoch: 9, Steps: 9 | Train Loss: 0.929 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
Validation loss decreased (-0.471002 --> -0.485495).  Saving model ...
Epoch: 10 cost time: 1.1489903926849365
Epoch: 10, Steps: 9 | Train Loss: 0.888 Vali Loss: 1.216 Vali Acc: 0.493 Test Loss: 1.216 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492741).  Saving model ...
Epoch: 11 cost time: 0.9835395812988281
Epoch: 11, Steps: 9 | Train Loss: 0.850 Vali Loss: 1.203 Vali Acc: 0.507 Test Loss: 1.203 Test Acc: 0.507
Validation loss decreased (-0.492741 --> -0.507234).  Saving model ...
Epoch: 12 cost time: 0.8757646083831787
Epoch: 12, Steps: 9 | Train Loss: 0.805 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8969845771789551
Epoch: 13, Steps: 9 | Train Loss: 0.728 Vali Loss: 1.175 Vali Acc: 0.529 Test Loss: 1.175 Test Acc: 0.529
Validation loss decreased (-0.507234 --> -0.528974).  Saving model ...
Epoch: 14 cost time: 1.1700994968414307
Epoch: 14, Steps: 9 | Train Loss: 0.679 Vali Loss: 1.161 Vali Acc: 0.551 Test Loss: 1.161 Test Acc: 0.551
Validation loss decreased (-0.528974 --> -0.550713).  Saving model ...
Epoch: 15 cost time: 0.9507875442504883
Epoch: 15, Steps: 9 | Train Loss: 0.629 Vali Loss: 1.151 Vali Acc: 0.543 Test Loss: 1.151 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2873880863189697
Epoch: 16, Steps: 9 | Train Loss: 0.598 Vali Loss: 1.137 Vali Acc: 0.543 Test Loss: 1.137 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9859392642974854
Epoch: 17, Steps: 9 | Train Loss: 0.553 Vali Loss: 1.123 Vali Acc: 0.551 Test Loss: 1.123 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550713).  Saving model ...
Epoch: 18 cost time: 1.3331353664398193
Epoch: 18, Steps: 9 | Train Loss: 0.503 Vali Loss: 1.112 Vali Acc: 0.543 Test Loss: 1.112 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0287344455718994
Epoch: 19, Steps: 9 | Train Loss: 0.495 Vali Loss: 1.101 Vali Acc: 0.565 Test Loss: 1.101 Test Acc: 0.565
Validation loss decreased (-0.550713 --> -0.565206).  Saving model ...
Epoch: 20 cost time: 0.942579984664917
Epoch: 20, Steps: 9 | Train Loss: 0.444 Vali Loss: 1.090 Vali Acc: 0.565 Test Loss: 1.090 Test Acc: 0.565
Validation loss decreased (-0.565206 --> -0.565206).  Saving model ...
Epoch: 21 cost time: 0.9589166641235352
Epoch: 21, Steps: 9 | Train Loss: 0.404 Vali Loss: 1.086 Vali Acc: 0.551 Test Loss: 1.086 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0162677764892578
Epoch: 22, Steps: 9 | Train Loss: 0.371 Vali Loss: 1.079 Vali Acc: 0.536 Test Loss: 1.079 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.20652437210083
Epoch: 23, Steps: 9 | Train Loss: 0.350 Vali Loss: 1.074 Vali Acc: 0.543 Test Loss: 1.074 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9793925285339355
Epoch: 24, Steps: 9 | Train Loss: 0.323 Vali Loss: 1.069 Vali Acc: 0.572 Test Loss: 1.069 Test Acc: 0.572
Validation loss decreased (-0.565206 --> -0.572453).  Saving model ...
Epoch: 25 cost time: 0.9690296649932861
Epoch: 25, Steps: 9 | Train Loss: 0.284 Vali Loss: 1.068 Vali Acc: 0.558 Test Loss: 1.068 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1706016063690186
Epoch: 26, Steps: 9 | Train Loss: 0.268 Vali Loss: 1.064 Vali Acc: 0.565 Test Loss: 1.064 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0340673923492432
Epoch: 27, Steps: 9 | Train Loss: 0.235 Vali Loss: 1.055 Vali Acc: 0.543 Test Loss: 1.055 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1198091506958008
Epoch: 28, Steps: 9 | Train Loss: 0.223 Vali Loss: 1.058 Vali Acc: 0.551 Test Loss: 1.058 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9791862964630127
Epoch: 29, Steps: 9 | Train Loss: 0.209 Vali Loss: 1.056 Vali Acc: 0.551 Test Loss: 1.056 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0231471061706543
Epoch: 30, Steps: 9 | Train Loss: 0.192 Vali Loss: 1.051 Vali Acc: 0.572 Test Loss: 1.051 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 31 cost time: 1.3169660568237305
Epoch: 31, Steps: 9 | Train Loss: 0.163 Vali Loss: 1.051 Vali Acc: 0.587 Test Loss: 1.051 Test Acc: 0.587
Validation loss decreased (-0.572453 --> -0.586946).  Saving model ...
Epoch: 32 cost time: 1.1656439304351807
Epoch: 32, Steps: 9 | Train Loss: 0.151 Vali Loss: 1.053 Vali Acc: 0.572 Test Loss: 1.053 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9293613433837891
Epoch: 33, Steps: 9 | Train Loss: 0.145 Vali Loss: 1.045 Vali Acc: 0.594 Test Loss: 1.045 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594192).  Saving model ...
Epoch: 34 cost time: 1.179901123046875
Epoch: 34, Steps: 9 | Train Loss: 0.130 Vali Loss: 1.043 Vali Acc: 0.580 Test Loss: 1.043 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1398353576660156
Epoch: 35, Steps: 9 | Train Loss: 0.115 Vali Loss: 1.042 Vali Acc: 0.594 Test Loss: 1.042 Test Acc: 0.594
Validation loss decreased (-0.594192 --> -0.594192).  Saving model ...
Epoch: 36 cost time: 0.9932296276092529
Epoch: 36, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.044 Vali Acc: 0.609 Test Loss: 1.044 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608685).  Saving model ...
Epoch: 37 cost time: 1.2607152462005615
Epoch: 37, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.049 Vali Acc: 0.601 Test Loss: 1.049 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1112117767333984
Epoch: 38, Steps: 9 | Train Loss: 0.094 Vali Loss: 1.043 Vali Acc: 0.601 Test Loss: 1.043 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.218501091003418
Epoch: 39, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.043 Vali Acc: 0.601 Test Loss: 1.043 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9571371078491211
Epoch: 40, Steps: 9 | Train Loss: 0.075 Vali Loss: 1.043 Vali Acc: 0.594 Test Loss: 1.043 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.149423360824585
Epoch: 41, Steps: 9 | Train Loss: 0.071 Vali Loss: 1.047 Vali Acc: 0.594 Test Loss: 1.047 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6086642742156982
Epoch: 42, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.050 Vali Acc: 0.587 Test Loss: 1.050 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1488304138183594
Epoch: 43, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.057 Vali Acc: 0.580 Test Loss: 1.057 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8614802360534668
Epoch: 44, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.062 Vali Acc: 0.580 Test Loss: 1.062 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.032829999923706
Epoch: 45, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.060 Vali Acc: 0.587 Test Loss: 1.060 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.1189844608306885
Epoch: 46, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.060 Vali Acc: 0.594 Test Loss: 1.060 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w5_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6086956521739131
model parameter : 109692
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.402158737182617
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.434 Vali Acc: 0.254 Test Loss: 1.434 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.7779502868652344
Epoch: 2, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.413 Vali Acc: 0.261 Test Loss: 1.413 Test Acc: 0.261
Validation loss decreased (-0.253609 --> -0.260855).  Saving model ...
Epoch: 3 cost time: 0.9241108894348145
Epoch: 3, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.384 Vali Acc: 0.268 Test Loss: 1.384 Test Acc: 0.268
Validation loss decreased (-0.260855 --> -0.268102).  Saving model ...
Epoch: 4 cost time: 0.805128812789917
Epoch: 4, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.359 Vali Acc: 0.312 Test Loss: 1.359 Test Acc: 0.312
Validation loss decreased (-0.268102 --> -0.311581).  Saving model ...
Epoch: 5 cost time: 0.8714990615844727
Epoch: 5, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.332 Vali Acc: 0.355 Test Loss: 1.332 Test Acc: 0.355
Validation loss decreased (-0.311581 --> -0.355059).  Saving model ...
Epoch: 6 cost time: 0.9285168647766113
Epoch: 6, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.306 Vali Acc: 0.391 Test Loss: 1.306 Test Acc: 0.391
Validation loss decreased (-0.355059 --> -0.391291).  Saving model ...
Epoch: 7 cost time: 0.8950901031494141
Epoch: 7, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.283 Vali Acc: 0.413 Test Loss: 1.283 Test Acc: 0.413
Validation loss decreased (-0.391291 --> -0.413031).  Saving model ...
Epoch: 8 cost time: 0.8654987812042236
Epoch: 8, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.264 Vali Acc: 0.428 Test Loss: 1.264 Test Acc: 0.428
Validation loss decreased (-0.413031 --> -0.427524).  Saving model ...
Epoch: 9 cost time: 1.010735034942627
Epoch: 9, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.242 Vali Acc: 0.449 Test Loss: 1.242 Test Acc: 0.449
Validation loss decreased (-0.427524 --> -0.449263).  Saving model ...
Epoch: 10 cost time: 1.0554850101470947
Epoch: 10, Steps: 9 | Train Loss: 0.937 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.449263 --> -0.485495).  Saving model ...
Epoch: 11 cost time: 0.9324700832366943
Epoch: 11, Steps: 9 | Train Loss: 0.876 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.485495 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.906597375869751
Epoch: 12, Steps: 9 | Train Loss: 0.839 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.0929734706878662
Epoch: 13, Steps: 9 | Train Loss: 0.786 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.8492531776428223
Epoch: 14, Steps: 9 | Train Loss: 0.733 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 15 cost time: 0.990577220916748
Epoch: 15, Steps: 9 | Train Loss: 0.693 Vali Loss: 1.147 Vali Acc: 0.522 Test Loss: 1.147 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521728).  Saving model ...
Epoch: 16 cost time: 0.7887845039367676
Epoch: 16, Steps: 9 | Train Loss: 0.654 Vali Loss: 1.133 Vali Acc: 0.536 Test Loss: 1.133 Test Acc: 0.536
Validation loss decreased (-0.521728 --> -0.536221).  Saving model ...
Epoch: 17 cost time: 0.7570688724517822
Epoch: 17, Steps: 9 | Train Loss: 0.613 Vali Loss: 1.118 Vali Acc: 0.543 Test Loss: 1.118 Test Acc: 0.543
Validation loss decreased (-0.536221 --> -0.543467).  Saving model ...
Epoch: 18 cost time: 0.7943141460418701
Epoch: 18, Steps: 9 | Train Loss: 0.573 Vali Loss: 1.103 Vali Acc: 0.551 Test Loss: 1.103 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550714).  Saving model ...
Epoch: 19 cost time: 0.7535021305084229
Epoch: 19, Steps: 9 | Train Loss: 0.535 Vali Loss: 1.092 Vali Acc: 0.572 Test Loss: 1.092 Test Acc: 0.572
Validation loss decreased (-0.550714 --> -0.572453).  Saving model ...
Epoch: 20 cost time: 0.7050168514251709
Epoch: 20, Steps: 9 | Train Loss: 0.495 Vali Loss: 1.076 Vali Acc: 0.572 Test Loss: 1.076 Test Acc: 0.572
Validation loss decreased (-0.572453 --> -0.572453).  Saving model ...
Epoch: 21 cost time: 0.7493247985839844
Epoch: 21, Steps: 9 | Train Loss: 0.446 Vali Loss: 1.065 Vali Acc: 0.594 Test Loss: 1.065 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594192).  Saving model ...
Epoch: 22 cost time: 0.8293375968933105
Epoch: 22, Steps: 9 | Train Loss: 0.409 Vali Loss: 1.055 Vali Acc: 0.609 Test Loss: 1.055 Test Acc: 0.609
Validation loss decreased (-0.594192 --> -0.608685).  Saving model ...
Epoch: 23 cost time: 0.9864239692687988
Epoch: 23, Steps: 9 | Train Loss: 0.386 Vali Loss: 1.041 Vali Acc: 0.616 Test Loss: 1.041 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 24 cost time: 0.8331634998321533
Epoch: 24, Steps: 9 | Train Loss: 0.337 Vali Loss: 1.025 Vali Acc: 0.630 Test Loss: 1.025 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 25 cost time: 0.7481842041015625
Epoch: 25, Steps: 9 | Train Loss: 0.309 Vali Loss: 1.021 Vali Acc: 0.616 Test Loss: 1.021 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9825372695922852
Epoch: 26, Steps: 9 | Train Loss: 0.277 Vali Loss: 1.013 Vali Acc: 0.623 Test Loss: 1.013 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0696210861206055
Epoch: 27, Steps: 9 | Train Loss: 0.266 Vali Loss: 1.004 Vali Acc: 0.630 Test Loss: 1.004 Test Acc: 0.630
Validation loss decreased (-0.630425 --> -0.630425).  Saving model ...
Epoch: 28 cost time: 0.9545214176177979
Epoch: 28, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.999 Vali Acc: 0.623 Test Loss: 0.999 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9451460838317871
Epoch: 29, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.995 Vali Acc: 0.645 Test Loss: 0.995 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644918).  Saving model ...
Epoch: 30 cost time: 1.025130271911621
Epoch: 30, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.990 Vali Acc: 0.645 Test Loss: 0.990 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644918).  Saving model ...
Epoch: 31 cost time: 1.0544333457946777
Epoch: 31, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.984 Vali Acc: 0.652 Test Loss: 0.984 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652164).  Saving model ...
Epoch: 32 cost time: 0.8880183696746826
Epoch: 32, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.978 Vali Acc: 0.659 Test Loss: 0.978 Test Acc: 0.659
Validation loss decreased (-0.652164 --> -0.659411).  Saving model ...
Epoch: 33 cost time: 0.9937479496002197
Epoch: 33, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.972 Vali Acc: 0.638 Test Loss: 0.972 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0162692070007324
Epoch: 34, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.969 Vali Acc: 0.645 Test Loss: 0.969 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.231499433517456
Epoch: 35, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.968 Vali Acc: 0.652 Test Loss: 0.968 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8900361061096191
Epoch: 36, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.965 Vali Acc: 0.652 Test Loss: 0.965 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9073119163513184
Epoch: 37, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.959 Vali Acc: 0.645 Test Loss: 0.959 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.836111307144165
Epoch: 38, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.960 Vali Acc: 0.645 Test Loss: 0.960 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8377563953399658
Epoch: 39, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.965 Vali Acc: 0.652 Test Loss: 0.965 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8583621978759766
Epoch: 40, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.967 Vali Acc: 0.638 Test Loss: 0.967 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5648689270019531
Epoch: 41, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.969 Vali Acc: 0.638 Test Loss: 0.969 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9591033458709717
Epoch: 42, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.970 Vali Acc: 0.630 Test Loss: 0.970 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6594202898550725
model parameter : 109180
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.697756052017212
Epoch: 1, Steps: 9 | Train Loss: 1.431 Vali Loss: 1.407 Vali Acc: 0.326 Test Loss: 1.407 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 0.9060378074645996
Epoch: 2, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.368 Vali Acc: 0.312 Test Loss: 1.368 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.000800609588623
Epoch: 3, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.317 Vali Acc: 0.326 Test Loss: 1.317 Test Acc: 0.326
Validation loss decreased (-0.326073 --> -0.326074).  Saving model ...
Epoch: 4 cost time: 0.831981897354126
Epoch: 4, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.274 Vali Acc: 0.370 Test Loss: 1.274 Test Acc: 0.370
Validation loss decreased (-0.326074 --> -0.369552).  Saving model ...
Epoch: 5 cost time: 0.7748146057128906
Epoch: 5, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.235 Vali Acc: 0.399 Test Loss: 1.235 Test Acc: 0.399
Validation loss decreased (-0.369552 --> -0.398538).  Saving model ...
Epoch: 6 cost time: 0.6992425918579102
Epoch: 6, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.201 Vali Acc: 0.457 Test Loss: 1.201 Test Acc: 0.457
Validation loss decreased (-0.398538 --> -0.456510).  Saving model ...
Epoch: 7 cost time: 0.9351723194122314
Epoch: 7, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
Validation loss decreased (-0.456510 --> -0.485496).  Saving model ...
Epoch: 8 cost time: 0.8362383842468262
Epoch: 8, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.160 Vali Acc: 0.449 Test Loss: 1.160 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8859002590179443
Epoch: 9, Steps: 9 | Train Loss: 1.001 Vali Loss: 1.147 Vali Acc: 0.478 Test Loss: 1.147 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8268997669219971
Epoch: 10, Steps: 9 | Train Loss: 0.948 Vali Loss: 1.134 Vali Acc: 0.493 Test Loss: 1.134 Test Acc: 0.493
Validation loss decreased (-0.485496 --> -0.492742).  Saving model ...
Epoch: 11 cost time: 0.921562910079956
Epoch: 11, Steps: 9 | Train Loss: 0.901 Vali Loss: 1.120 Vali Acc: 0.457 Test Loss: 1.120 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9074900150299072
Epoch: 12, Steps: 9 | Train Loss: 0.842 Vali Loss: 1.108 Vali Acc: 0.457 Test Loss: 1.108 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8954825401306152
Epoch: 13, Steps: 9 | Train Loss: 0.804 Vali Loss: 1.103 Vali Acc: 0.464 Test Loss: 1.103 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9490921497344971
Epoch: 14, Steps: 9 | Train Loss: 0.757 Vali Loss: 1.084 Vali Acc: 0.478 Test Loss: 1.084 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8598356246948242
Epoch: 15, Steps: 9 | Train Loss: 0.692 Vali Loss: 1.073 Vali Acc: 0.543 Test Loss: 1.073 Test Acc: 0.543
Validation loss decreased (-0.492742 --> -0.543468).  Saving model ...
Epoch: 16 cost time: 0.8817408084869385
Epoch: 16, Steps: 9 | Train Loss: 0.645 Vali Loss: 1.072 Vali Acc: 0.478 Test Loss: 1.072 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8389010429382324
Epoch: 17, Steps: 9 | Train Loss: 0.587 Vali Loss: 1.039 Vali Acc: 0.529 Test Loss: 1.039 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8721976280212402
Epoch: 18, Steps: 9 | Train Loss: 0.555 Vali Loss: 1.064 Vali Acc: 0.507 Test Loss: 1.064 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8521809577941895
Epoch: 19, Steps: 9 | Train Loss: 0.510 Vali Loss: 1.027 Vali Acc: 0.536 Test Loss: 1.027 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8927161693572998
Epoch: 20, Steps: 9 | Train Loss: 0.460 Vali Loss: 1.038 Vali Acc: 0.514 Test Loss: 1.038 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7163591384887695
Epoch: 21, Steps: 9 | Train Loss: 0.420 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7851879596710205
Epoch: 22, Steps: 9 | Train Loss: 0.365 Vali Loss: 1.004 Vali Acc: 0.536 Test Loss: 1.004 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8868892192840576
Epoch: 23, Steps: 9 | Train Loss: 0.337 Vali Loss: 1.029 Vali Acc: 0.529 Test Loss: 1.029 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0760104656219482
Epoch: 24, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.984 Vali Acc: 0.565 Test Loss: 0.984 Test Acc: 0.565
Validation loss decreased (-0.543468 --> -0.565208).  Saving model ...
Epoch: 25 cost time: 0.7603967189788818
Epoch: 25, Steps: 9 | Train Loss: 0.263 Vali Loss: 1.017 Vali Acc: 0.543 Test Loss: 1.017 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8279180526733398
Epoch: 26, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.986 Vali Acc: 0.551 Test Loss: 0.986 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9823484420776367
Epoch: 27, Steps: 9 | Train Loss: 0.204 Vali Loss: 1.001 Vali Acc: 0.536 Test Loss: 1.001 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8806169033050537
Epoch: 28, Steps: 9 | Train Loss: 0.166 Vali Loss: 1.008 Vali Acc: 0.522 Test Loss: 1.008 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9444890022277832
Epoch: 29, Steps: 9 | Train Loss: 0.142 Vali Loss: 1.011 Vali Acc: 0.536 Test Loss: 1.011 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9133992195129395
Epoch: 30, Steps: 9 | Train Loss: 0.125 Vali Loss: 1.016 Vali Acc: 0.536 Test Loss: 1.016 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8286838531494141
Epoch: 31, Steps: 9 | Train Loss: 0.102 Vali Loss: 1.006 Vali Acc: 0.536 Test Loss: 1.006 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9462387561798096
Epoch: 32, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.011 Vali Acc: 0.565 Test Loss: 1.011 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7978982925415039
Epoch: 33, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.025 Vali Acc: 0.558 Test Loss: 1.025 Test Acc: 0.558
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.862938642501831
Epoch: 34, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.035 Vali Acc: 0.565 Test Loss: 1.035 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 108668
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9859426021575928
Epoch: 1, Steps: 9 | Train Loss: 1.513 Vali Loss: 1.494 Vali Acc: 0.167 Test Loss: 1.494 Test Acc: 0.167
Validation loss decreased (inf --> -0.166652).  Saving model ...
Epoch: 2 cost time: 1.760385513305664
Epoch: 2, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.453 Vali Acc: 0.210 Test Loss: 1.453 Test Acc: 0.210
Validation loss decreased (-0.166652 --> -0.210130).  Saving model ...
Epoch: 3 cost time: 1.6916277408599854
Epoch: 3, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.404 Vali Acc: 0.275 Test Loss: 1.404 Test Acc: 0.275
Validation loss decreased (-0.210130 --> -0.275348).  Saving model ...
Epoch: 4 cost time: 1.9957771301269531
Epoch: 4, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.359 Vali Acc: 0.304 Test Loss: 1.359 Test Acc: 0.304
Validation loss decreased (-0.275348 --> -0.304334).  Saving model ...
Epoch: 5 cost time: 2.1228742599487305
Epoch: 5, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.317 Vali Acc: 0.341 Test Loss: 1.317 Test Acc: 0.341
Validation loss decreased (-0.304334 --> -0.340567).  Saving model ...
Epoch: 6 cost time: 1.8312652111053467
Epoch: 6, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.288 Vali Acc: 0.370 Test Loss: 1.288 Test Acc: 0.370
Validation loss decreased (-0.340567 --> -0.369552).  Saving model ...
Epoch: 7 cost time: 2.0691215991973877
Epoch: 7, Steps: 9 | Train Loss: 0.902 Vali Loss: 1.262 Vali Acc: 0.377 Test Loss: 1.262 Test Acc: 0.377
Validation loss decreased (-0.369552 --> -0.376799).  Saving model ...
Epoch: 8 cost time: 1.7050728797912598
Epoch: 8, Steps: 9 | Train Loss: 0.848 Vali Loss: 1.230 Vali Acc: 0.406 Test Loss: 1.230 Test Acc: 0.406
Validation loss decreased (-0.376799 --> -0.405785).  Saving model ...
Epoch: 9 cost time: 1.723168134689331
Epoch: 9, Steps: 9 | Train Loss: 0.761 Vali Loss: 1.214 Vali Acc: 0.420 Test Loss: 1.214 Test Acc: 0.420
Validation loss decreased (-0.405785 --> -0.420278).  Saving model ...
Epoch: 10 cost time: 2.2040047645568848
Epoch: 10, Steps: 9 | Train Loss: 0.681 Vali Loss: 1.198 Vali Acc: 0.449 Test Loss: 1.198 Test Acc: 0.449
Validation loss decreased (-0.420278 --> -0.449263).  Saving model ...
Epoch: 11 cost time: 2.0556108951568604
Epoch: 11, Steps: 9 | Train Loss: 0.630 Vali Loss: 1.189 Vali Acc: 0.478 Test Loss: 1.189 Test Acc: 0.478
Validation loss decreased (-0.449263 --> -0.478249).  Saving model ...
Epoch: 12 cost time: 1.5879456996917725
Epoch: 12, Steps: 9 | Train Loss: 0.552 Vali Loss: 1.186 Vali Acc: 0.507 Test Loss: 1.186 Test Acc: 0.507
Validation loss decreased (-0.478249 --> -0.507235).  Saving model ...
Epoch: 13 cost time: 1.9605331420898438
Epoch: 13, Steps: 9 | Train Loss: 0.509 Vali Loss: 1.183 Vali Acc: 0.493 Test Loss: 1.183 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0774495601654053
Epoch: 14, Steps: 9 | Train Loss: 0.454 Vali Loss: 1.168 Vali Acc: 0.536 Test Loss: 1.168 Test Acc: 0.536
Validation loss decreased (-0.507235 --> -0.536220).  Saving model ...
Epoch: 15 cost time: 2.059004545211792
Epoch: 15, Steps: 9 | Train Loss: 0.409 Vali Loss: 1.167 Vali Acc: 0.536 Test Loss: 1.167 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536220).  Saving model ...
Epoch: 16 cost time: 1.7819817066192627
Epoch: 16, Steps: 9 | Train Loss: 0.351 Vali Loss: 1.172 Vali Acc: 0.507 Test Loss: 1.172 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.937263011932373
Epoch: 17, Steps: 9 | Train Loss: 0.324 Vali Loss: 1.156 Vali Acc: 0.529 Test Loss: 1.156 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8790416717529297
Epoch: 18, Steps: 9 | Train Loss: 0.277 Vali Loss: 1.156 Vali Acc: 0.536 Test Loss: 1.156 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536220).  Saving model ...
Epoch: 19 cost time: 2.246920585632324
Epoch: 19, Steps: 9 | Train Loss: 0.248 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.075748920440674
Epoch: 20, Steps: 9 | Train Loss: 0.207 Vali Loss: 1.152 Vali Acc: 0.522 Test Loss: 1.152 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3151192665100098
Epoch: 21, Steps: 9 | Train Loss: 0.179 Vali Loss: 1.152 Vali Acc: 0.507 Test Loss: 1.152 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9099841117858887
Epoch: 22, Steps: 9 | Train Loss: 0.163 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2501866817474365
Epoch: 23, Steps: 9 | Train Loss: 0.146 Vali Loss: 1.145 Vali Acc: 0.536 Test Loss: 1.145 Test Acc: 0.536
Validation loss decreased (-0.536220 --> -0.536220).  Saving model ...
Epoch: 24 cost time: 1.8496384620666504
Epoch: 24, Steps: 9 | Train Loss: 0.124 Vali Loss: 1.146 Vali Acc: 0.529 Test Loss: 1.146 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.195439100265503
Epoch: 25, Steps: 9 | Train Loss: 0.112 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0581765174865723
Epoch: 26, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.163 Vali Acc: 0.529 Test Loss: 1.163 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.921152114868164
Epoch: 27, Steps: 9 | Train Loss: 0.086 Vali Loss: 1.166 Vali Acc: 0.522 Test Loss: 1.166 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4893734455108643
Epoch: 28, Steps: 9 | Train Loss: 0.077 Vali Loss: 1.169 Vali Acc: 0.529 Test Loss: 1.169 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6101179122924805
Epoch: 29, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.0185546875
Epoch: 30, Steps: 9 | Train Loss: 0.061 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6047933101654053
Epoch: 31, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.171 Vali Acc: 0.529 Test Loss: 1.171 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9787957668304443
Epoch: 32, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.181 Vali Acc: 0.536 Test Loss: 1.181 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8694260120391846
Epoch: 33, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.177 Vali Acc: 0.536 Test Loss: 1.177 Test Acc: 0.536
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w26_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5362318840579711
model parameter : 115034
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.762418031692505
Epoch: 1, Steps: 9 | Train Loss: 1.495 Vali Loss: 1.426 Vali Acc: 0.275 Test Loss: 1.426 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.6772291660308838
Epoch: 2, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.380 Vali Acc: 0.319 Test Loss: 1.380 Test Acc: 0.319
Validation loss decreased (-0.275348 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 1.4472124576568604
Epoch: 3, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.339 Vali Acc: 0.348 Test Loss: 1.339 Test Acc: 0.348
Validation loss decreased (-0.318827 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 1.4796457290649414
Epoch: 4, Steps: 9 | Train Loss: 1.200 Vali Loss: 1.311 Vali Acc: 0.391 Test Loss: 1.311 Test Acc: 0.391
Validation loss decreased (-0.347813 --> -0.391291).  Saving model ...
Epoch: 5 cost time: 1.5774829387664795
Epoch: 5, Steps: 9 | Train Loss: 1.125 Vali Loss: 1.281 Vali Acc: 0.428 Test Loss: 1.281 Test Acc: 0.428
Validation loss decreased (-0.391291 --> -0.427523).  Saving model ...
Epoch: 6 cost time: 1.3635611534118652
Epoch: 6, Steps: 9 | Train Loss: 1.007 Vali Loss: 1.265 Vali Acc: 0.413 Test Loss: 1.265 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7570555210113525
Epoch: 7, Steps: 9 | Train Loss: 0.915 Vali Loss: 1.243 Vali Acc: 0.420 Test Loss: 1.243 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5338263511657715
Epoch: 8, Steps: 9 | Train Loss: 0.827 Vali Loss: 1.224 Vali Acc: 0.413 Test Loss: 1.224 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5963454246520996
Epoch: 9, Steps: 9 | Train Loss: 0.760 Vali Loss: 1.204 Vali Acc: 0.428 Test Loss: 1.204 Test Acc: 0.428
Validation loss decreased (-0.427523 --> -0.427524).  Saving model ...
Epoch: 10 cost time: 1.6540265083312988
Epoch: 10, Steps: 9 | Train Loss: 0.694 Vali Loss: 1.191 Vali Acc: 0.464 Test Loss: 1.191 Test Acc: 0.464
Validation loss decreased (-0.427524 --> -0.463756).  Saving model ...
Epoch: 11 cost time: 1.800633430480957
Epoch: 11, Steps: 9 | Train Loss: 0.621 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.463756 --> -0.514481).  Saving model ...
Epoch: 12 cost time: 2.063288688659668
Epoch: 12, Steps: 9 | Train Loss: 0.590 Vali Loss: 1.168 Vali Acc: 0.507 Test Loss: 1.168 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.803452730178833
Epoch: 13, Steps: 9 | Train Loss: 0.512 Vali Loss: 1.162 Vali Acc: 0.478 Test Loss: 1.162 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.427919626235962
Epoch: 14, Steps: 9 | Train Loss: 0.450 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3882935047149658
Epoch: 15, Steps: 9 | Train Loss: 0.404 Vali Loss: 1.146 Vali Acc: 0.522 Test Loss: 1.146 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521728).  Saving model ...
Epoch: 16 cost time: 1.8616416454315186
Epoch: 16, Steps: 9 | Train Loss: 0.350 Vali Loss: 1.142 Vali Acc: 0.522 Test Loss: 1.142 Test Acc: 0.522
Validation loss decreased (-0.521728 --> -0.521728).  Saving model ...
Epoch: 17 cost time: 1.6692731380462646
Epoch: 17, Steps: 9 | Train Loss: 0.323 Vali Loss: 1.148 Vali Acc: 0.486 Test Loss: 1.148 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6972904205322266
Epoch: 18, Steps: 9 | Train Loss: 0.268 Vali Loss: 1.165 Vali Acc: 0.493 Test Loss: 1.165 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.294424295425415
Epoch: 19, Steps: 9 | Train Loss: 0.242 Vali Loss: 1.141 Vali Acc: 0.507 Test Loss: 1.141 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3857290744781494
Epoch: 20, Steps: 9 | Train Loss: 0.211 Vali Loss: 1.162 Vali Acc: 0.522 Test Loss: 1.162 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.811464548110962
Epoch: 21, Steps: 9 | Train Loss: 0.193 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7323822975158691
Epoch: 22, Steps: 9 | Train Loss: 0.157 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5489845275878906
Epoch: 23, Steps: 9 | Train Loss: 0.137 Vali Loss: 1.175 Vali Acc: 0.522 Test Loss: 1.175 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7973566055297852
Epoch: 24, Steps: 9 | Train Loss: 0.124 Vali Loss: 1.159 Vali Acc: 0.543 Test Loss: 1.159 Test Acc: 0.543
Validation loss decreased (-0.521728 --> -0.543467).  Saving model ...
Epoch: 25 cost time: 1.4609217643737793
Epoch: 25, Steps: 9 | Train Loss: 0.106 Vali Loss: 1.184 Vali Acc: 0.522 Test Loss: 1.184 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.834587812423706
Epoch: 26, Steps: 9 | Train Loss: 0.095 Vali Loss: 1.199 Vali Acc: 0.507 Test Loss: 1.199 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9389927387237549
Epoch: 27, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.198 Vali Acc: 0.493 Test Loss: 1.198 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7784340381622314
Epoch: 28, Steps: 9 | Train Loss: 0.073 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5846621990203857
Epoch: 29, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.667426347732544
Epoch: 30, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5082323551177979
Epoch: 31, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.209 Vali Acc: 0.507 Test Loss: 1.209 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4934608936309814
Epoch: 32, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.461503028869629
Epoch: 33, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6079230308532715
Epoch: 34, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.207 Vali Acc: 0.514 Test Loss: 1.207 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w21_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5434782608695652
model parameter : 113754
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.916393756866455
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.382 Vali Acc: 0.297 Test Loss: 1.382 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.4391613006591797
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.340 Vali Acc: 0.341 Test Loss: 1.340 Test Acc: 0.341
Validation loss decreased (-0.297088 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 0.9974982738494873
Epoch: 3, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.302 Vali Acc: 0.341 Test Loss: 1.302 Test Acc: 0.341
Validation loss decreased (-0.340566 --> -0.340567).  Saving model ...
Epoch: 4 cost time: 1.2088367938995361
Epoch: 4, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.262 Vali Acc: 0.406 Test Loss: 1.262 Test Acc: 0.406
Validation loss decreased (-0.340567 --> -0.405784).  Saving model ...
Epoch: 5 cost time: 1.2969064712524414
Epoch: 5, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.233 Vali Acc: 0.478 Test Loss: 1.233 Test Acc: 0.478
Validation loss decreased (-0.405784 --> -0.478249).  Saving model ...
Epoch: 6 cost time: 1.2290513515472412
Epoch: 6, Steps: 9 | Train Loss: 0.978 Vali Loss: 1.214 Vali Acc: 0.471 Test Loss: 1.214 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4631528854370117
Epoch: 7, Steps: 9 | Train Loss: 0.900 Vali Loss: 1.186 Vali Acc: 0.507 Test Loss: 1.186 Test Acc: 0.507
Validation loss decreased (-0.478249 --> -0.507235).  Saving model ...
Epoch: 8 cost time: 1.2724189758300781
Epoch: 8, Steps: 9 | Train Loss: 0.816 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.507235 --> -0.514481).  Saving model ...
Epoch: 9 cost time: 1.5608220100402832
Epoch: 9, Steps: 9 | Train Loss: 0.723 Vali Loss: 1.156 Vali Acc: 0.551 Test Loss: 1.156 Test Acc: 0.551
Validation loss decreased (-0.514481 --> -0.550713).  Saving model ...
Epoch: 10 cost time: 1.2112815380096436
Epoch: 10, Steps: 9 | Train Loss: 0.664 Vali Loss: 1.145 Vali Acc: 0.551 Test Loss: 1.145 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550713).  Saving model ...
Epoch: 11 cost time: 1.161787986755371
Epoch: 11, Steps: 9 | Train Loss: 0.593 Vali Loss: 1.133 Vali Acc: 0.551 Test Loss: 1.133 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550713).  Saving model ...
Epoch: 12 cost time: 1.3773460388183594
Epoch: 12, Steps: 9 | Train Loss: 0.532 Vali Loss: 1.133 Vali Acc: 0.536 Test Loss: 1.133 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2019069194793701
Epoch: 13, Steps: 9 | Train Loss: 0.472 Vali Loss: 1.118 Vali Acc: 0.543 Test Loss: 1.118 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.396949052810669
Epoch: 14, Steps: 9 | Train Loss: 0.409 Vali Loss: 1.106 Vali Acc: 0.529 Test Loss: 1.106 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6513481140136719
Epoch: 15, Steps: 9 | Train Loss: 0.358 Vali Loss: 1.105 Vali Acc: 0.551 Test Loss: 1.105 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550714).  Saving model ...
Epoch: 16 cost time: 1.5316922664642334
Epoch: 16, Steps: 9 | Train Loss: 0.325 Vali Loss: 1.100 Vali Acc: 0.551 Test Loss: 1.100 Test Acc: 0.551
Validation loss decreased (-0.550714 --> -0.550714).  Saving model ...
Epoch: 17 cost time: 1.5387709140777588
Epoch: 17, Steps: 9 | Train Loss: 0.275 Vali Loss: 1.102 Vali Acc: 0.529 Test Loss: 1.102 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5612642765045166
Epoch: 18, Steps: 9 | Train Loss: 0.228 Vali Loss: 1.104 Vali Acc: 0.507 Test Loss: 1.104 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3893468379974365
Epoch: 19, Steps: 9 | Train Loss: 0.201 Vali Loss: 1.107 Vali Acc: 0.522 Test Loss: 1.107 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6215662956237793
Epoch: 20, Steps: 9 | Train Loss: 0.176 Vali Loss: 1.111 Vali Acc: 0.543 Test Loss: 1.111 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.499936819076538
Epoch: 21, Steps: 9 | Train Loss: 0.153 Vali Loss: 1.105 Vali Acc: 0.572 Test Loss: 1.105 Test Acc: 0.572
Validation loss decreased (-0.550714 --> -0.572453).  Saving model ...
Epoch: 22 cost time: 1.5496973991394043
Epoch: 22, Steps: 9 | Train Loss: 0.133 Vali Loss: 1.109 Vali Acc: 0.558 Test Loss: 1.109 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7286198139190674
Epoch: 23, Steps: 9 | Train Loss: 0.110 Vali Loss: 1.106 Vali Acc: 0.551 Test Loss: 1.106 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5357425212860107
Epoch: 24, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.119 Vali Acc: 0.536 Test Loss: 1.119 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.679638385772705
Epoch: 25, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.127 Vali Acc: 0.536 Test Loss: 1.127 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2159407138824463
Epoch: 26, Steps: 9 | Train Loss: 0.078 Vali Loss: 1.113 Vali Acc: 0.529 Test Loss: 1.113 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6471128463745117
Epoch: 27, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.130 Vali Acc: 0.543 Test Loss: 1.130 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6047611236572266
Epoch: 28, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.128 Vali Acc: 0.551 Test Loss: 1.128 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.730994462966919
Epoch: 29, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.119 Vali Acc: 0.551 Test Loss: 1.119 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3488242626190186
Epoch: 30, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.121 Vali Acc: 0.565 Test Loss: 1.121 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5424103736877441
Epoch: 31, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.138 Vali Acc: 0.543 Test Loss: 1.138 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w16_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 112474
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4618375301361084
Epoch: 1, Steps: 9 | Train Loss: 1.454 Vali Loss: 1.461 Vali Acc: 0.254 Test Loss: 1.461 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.329613447189331
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.425 Vali Acc: 0.268 Test Loss: 1.425 Test Acc: 0.268
Validation loss decreased (-0.253609 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 1.1694319248199463
Epoch: 3, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.385 Vali Acc: 0.290 Test Loss: 1.385 Test Acc: 0.290
Validation loss decreased (-0.268102 --> -0.289841).  Saving model ...
Epoch: 4 cost time: 1.0497534275054932
Epoch: 4, Steps: 9 | Train Loss: 1.147 Vali Loss: 1.338 Vali Acc: 0.362 Test Loss: 1.338 Test Acc: 0.362
Validation loss decreased (-0.289841 --> -0.362305).  Saving model ...
Epoch: 5 cost time: 1.1819736957550049
Epoch: 5, Steps: 9 | Train Loss: 1.044 Vali Loss: 1.304 Vali Acc: 0.384 Test Loss: 1.304 Test Acc: 0.384
Validation loss decreased (-0.362305 --> -0.384045).  Saving model ...
Epoch: 6 cost time: 0.9400742053985596
Epoch: 6, Steps: 9 | Train Loss: 0.946 Vali Loss: 1.274 Vali Acc: 0.406 Test Loss: 1.274 Test Acc: 0.406
Validation loss decreased (-0.384045 --> -0.405784).  Saving model ...
Epoch: 7 cost time: 0.988257884979248
Epoch: 7, Steps: 9 | Train Loss: 0.863 Vali Loss: 1.249 Vali Acc: 0.449 Test Loss: 1.249 Test Acc: 0.449
Validation loss decreased (-0.405784 --> -0.449263).  Saving model ...
Epoch: 8 cost time: 0.8588643074035645
Epoch: 8, Steps: 9 | Train Loss: 0.773 Vali Loss: 1.223 Vali Acc: 0.435 Test Loss: 1.223 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0474998950958252
Epoch: 9, Steps: 9 | Train Loss: 0.708 Vali Loss: 1.204 Vali Acc: 0.442 Test Loss: 1.204 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.274637222290039
Epoch: 10, Steps: 9 | Train Loss: 0.650 Vali Loss: 1.185 Vali Acc: 0.464 Test Loss: 1.185 Test Acc: 0.464
Validation loss decreased (-0.449263 --> -0.463756).  Saving model ...
Epoch: 11 cost time: 1.176210880279541
Epoch: 11, Steps: 9 | Train Loss: 0.572 Vali Loss: 1.174 Vali Acc: 0.471 Test Loss: 1.174 Test Acc: 0.471
Validation loss decreased (-0.463756 --> -0.471003).  Saving model ...
Epoch: 12 cost time: 1.249589204788208
Epoch: 12, Steps: 9 | Train Loss: 0.511 Vali Loss: 1.162 Vali Acc: 0.478 Test Loss: 1.162 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478249).  Saving model ...
Epoch: 13 cost time: 1.0324628353118896
Epoch: 13, Steps: 9 | Train Loss: 0.478 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.478249 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.1698930263519287
Epoch: 14, Steps: 9 | Train Loss: 0.418 Vali Loss: 1.148 Vali Acc: 0.478 Test Loss: 1.148 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2300057411193848
Epoch: 15, Steps: 9 | Train Loss: 0.370 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.514481).  Saving model ...
Epoch: 16 cost time: 1.0432252883911133
Epoch: 16, Steps: 9 | Train Loss: 0.321 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514481).  Saving model ...
Epoch: 17 cost time: 1.1597468852996826
Epoch: 17, Steps: 9 | Train Loss: 0.272 Vali Loss: 1.121 Vali Acc: 0.522 Test Loss: 1.121 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521728).  Saving model ...
Epoch: 18 cost time: 1.0753304958343506
Epoch: 18, Steps: 9 | Train Loss: 0.233 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9825382232666016
Epoch: 19, Steps: 9 | Train Loss: 0.210 Vali Loss: 1.113 Vali Acc: 0.529 Test Loss: 1.113 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528974).  Saving model ...
Epoch: 20 cost time: 1.0163426399230957
Epoch: 20, Steps: 9 | Train Loss: 0.188 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2597486972808838
Epoch: 21, Steps: 9 | Train Loss: 0.158 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9813833236694336
Epoch: 22, Steps: 9 | Train Loss: 0.136 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4593994617462158
Epoch: 23, Steps: 9 | Train Loss: 0.117 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2081429958343506
Epoch: 24, Steps: 9 | Train Loss: 0.101 Vali Loss: 1.118 Vali Acc: 0.522 Test Loss: 1.118 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1822869777679443
Epoch: 25, Steps: 9 | Train Loss: 0.087 Vali Loss: 1.117 Vali Acc: 0.522 Test Loss: 1.117 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6646792888641357
Epoch: 26, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.112 Vali Acc: 0.529 Test Loss: 1.112 Test Acc: 0.529
Validation loss decreased (-0.528974 --> -0.528974).  Saving model ...
Epoch: 27 cost time: 1.427093505859375
Epoch: 27, Steps: 9 | Train Loss: 0.068 Vali Loss: 1.128 Vali Acc: 0.507 Test Loss: 1.128 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4019241333007812
Epoch: 28, Steps: 9 | Train Loss: 0.059 Vali Loss: 1.123 Vali Acc: 0.522 Test Loss: 1.123 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1544201374053955
Epoch: 29, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1152327060699463
Epoch: 30, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.123 Vali Acc: 0.536 Test Loss: 1.123 Test Acc: 0.536
Validation loss decreased (-0.528974 --> -0.536221).  Saving model ...
Epoch: 31 cost time: 1.3153388500213623
Epoch: 31, Steps: 9 | Train Loss: 0.042 Vali Loss: 1.130 Vali Acc: 0.522 Test Loss: 1.130 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3369033336639404
Epoch: 32, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.295670986175537
Epoch: 33, Steps: 9 | Train Loss: 0.036 Vali Loss: 1.127 Vali Acc: 0.493 Test Loss: 1.127 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.452425479888916
Epoch: 34, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.471585988998413
Epoch: 35, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0707263946533203
Epoch: 36, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4997265338897705
Epoch: 37, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2956855297088623
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.138 Vali Acc: 0.507 Test Loss: 1.138 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1350972652435303
Epoch: 39, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1546239852905273
Epoch: 40, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.142 Vali Acc: 0.507 Test Loss: 1.142 Test Acc: 0.507
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w11_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5362318840579711
model parameter : 111194
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6363883018493652
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.420 Vali Acc: 0.304 Test Loss: 1.420 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.0675146579742432
Epoch: 2, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.382 Vali Acc: 0.341 Test Loss: 1.382 Test Acc: 0.341
Validation loss decreased (-0.304334 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 0.8858425617218018
Epoch: 3, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.334 Vali Acc: 0.355 Test Loss: 1.334 Test Acc: 0.355
Validation loss decreased (-0.340566 --> -0.355059).  Saving model ...
Epoch: 4 cost time: 0.965660572052002
Epoch: 4, Steps: 9 | Train Loss: 1.147 Vali Loss: 1.292 Vali Acc: 0.384 Test Loss: 1.292 Test Acc: 0.384
Validation loss decreased (-0.355059 --> -0.384045).  Saving model ...
Epoch: 5 cost time: 1.0452816486358643
Epoch: 5, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.260 Vali Acc: 0.406 Test Loss: 1.260 Test Acc: 0.406
Validation loss decreased (-0.384045 --> -0.405785).  Saving model ...
Epoch: 6 cost time: 0.7940864562988281
Epoch: 6, Steps: 9 | Train Loss: 0.918 Vali Loss: 1.238 Vali Acc: 0.471 Test Loss: 1.238 Test Acc: 0.471
Validation loss decreased (-0.405785 --> -0.471002).  Saving model ...
Epoch: 7 cost time: 0.8509953022003174
Epoch: 7, Steps: 9 | Train Loss: 0.818 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.471002 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.8419246673583984
Epoch: 8, Steps: 9 | Train Loss: 0.744 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 9 cost time: 0.7874910831451416
Epoch: 9, Steps: 9 | Train Loss: 0.665 Vali Loss: 1.182 Vali Acc: 0.522 Test Loss: 1.182 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521727).  Saving model ...
Epoch: 10 cost time: 0.801469087600708
Epoch: 10, Steps: 9 | Train Loss: 0.582 Vali Loss: 1.171 Vali Acc: 0.522 Test Loss: 1.171 Test Acc: 0.522
Validation loss decreased (-0.521727 --> -0.521727).  Saving model ...
Epoch: 11 cost time: 0.9244730472564697
Epoch: 11, Steps: 9 | Train Loss: 0.524 Vali Loss: 1.140 Vali Acc: 0.543 Test Loss: 1.140 Test Acc: 0.543
Validation loss decreased (-0.521727 --> -0.543467).  Saving model ...
Epoch: 12 cost time: 0.812492847442627
Epoch: 12, Steps: 9 | Train Loss: 0.444 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8004786968231201
Epoch: 13, Steps: 9 | Train Loss: 0.389 Vali Loss: 1.118 Vali Acc: 0.529 Test Loss: 1.118 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9782626628875732
Epoch: 14, Steps: 9 | Train Loss: 0.348 Vali Loss: 1.114 Vali Acc: 0.558 Test Loss: 1.114 Test Acc: 0.558
Validation loss decreased (-0.543467 --> -0.557960).  Saving model ...
Epoch: 15 cost time: 0.8641486167907715
Epoch: 15, Steps: 9 | Train Loss: 0.290 Vali Loss: 1.118 Vali Acc: 0.551 Test Loss: 1.118 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9537515640258789
Epoch: 16, Steps: 9 | Train Loss: 0.247 Vali Loss: 1.131 Vali Acc: 0.558 Test Loss: 1.131 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8187651634216309
Epoch: 17, Steps: 9 | Train Loss: 0.213 Vali Loss: 1.123 Vali Acc: 0.543 Test Loss: 1.123 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8380482196807861
Epoch: 18, Steps: 9 | Train Loss: 0.171 Vali Loss: 1.108 Vali Acc: 0.558 Test Loss: 1.108 Test Acc: 0.558
Validation loss decreased (-0.557960 --> -0.557960).  Saving model ...
Epoch: 19 cost time: 0.8703951835632324
Epoch: 19, Steps: 9 | Train Loss: 0.155 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
Validation loss decreased (-0.557960 --> -0.579699).  Saving model ...
Epoch: 20 cost time: 0.7669286727905273
Epoch: 20, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.106 Vali Acc: 0.580 Test Loss: 1.106 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.924189567565918
Epoch: 21, Steps: 9 | Train Loss: 0.116 Vali Loss: 1.106 Vali Acc: 0.572 Test Loss: 1.106 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9244182109832764
Epoch: 22, Steps: 9 | Train Loss: 0.098 Vali Loss: 1.108 Vali Acc: 0.580 Test Loss: 1.108 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7768986225128174
Epoch: 23, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.110 Vali Acc: 0.572 Test Loss: 1.110 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0760974884033203
Epoch: 24, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.122 Vali Acc: 0.580 Test Loss: 1.122 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9075531959533691
Epoch: 25, Steps: 9 | Train Loss: 0.064 Vali Loss: 1.103 Vali Acc: 0.587 Test Loss: 1.103 Test Acc: 0.587
Validation loss decreased (-0.579699 --> -0.586945).  Saving model ...
Epoch: 26 cost time: 0.8369371891021729
Epoch: 26, Steps: 9 | Train Loss: 0.061 Vali Loss: 1.102 Vali Acc: 0.572 Test Loss: 1.102 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9027454853057861
Epoch: 27, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.113 Vali Acc: 0.580 Test Loss: 1.113 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8934268951416016
Epoch: 28, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.113 Vali Acc: 0.572 Test Loss: 1.113 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.362138032913208
Epoch: 29, Steps: 9 | Train Loss: 0.041 Vali Loss: 1.122 Vali Acc: 0.558 Test Loss: 1.122 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1047074794769287
Epoch: 30, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.122 Vali Acc: 0.565 Test Loss: 1.122 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9429566860198975
Epoch: 31, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.127 Vali Acc: 0.565 Test Loss: 1.127 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0126652717590332
Epoch: 32, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.133 Vali Acc: 0.558 Test Loss: 1.133 Test Acc: 0.558
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8864092826843262
Epoch: 33, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.129 Vali Acc: 0.565 Test Loss: 1.129 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8971333503723145
Epoch: 34, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.131 Vali Acc: 0.565 Test Loss: 1.131 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0329790115356445
Epoch: 35, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.137 Vali Acc: 0.565 Test Loss: 1.137 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w7_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5869565217391305
model parameter : 110170
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.874652624130249
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.507 Vali Acc: 0.196 Test Loss: 1.507 Test Acc: 0.196
Validation loss decreased (inf --> -0.195637).  Saving model ...
Epoch: 2 cost time: 0.8513431549072266
Epoch: 2, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.461 Vali Acc: 0.232 Test Loss: 1.461 Test Acc: 0.232
Validation loss decreased (-0.195637 --> -0.231869).  Saving model ...
Epoch: 3 cost time: 0.9368250370025635
Epoch: 3, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.410 Vali Acc: 0.275 Test Loss: 1.410 Test Acc: 0.275
Validation loss decreased (-0.231869 --> -0.275348).  Saving model ...
Epoch: 4 cost time: 1.0217382907867432
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.365 Vali Acc: 0.355 Test Loss: 1.365 Test Acc: 0.355
Validation loss decreased (-0.275348 --> -0.355059).  Saving model ...
Epoch: 5 cost time: 0.9810397624969482
Epoch: 5, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.316 Vali Acc: 0.370 Test Loss: 1.316 Test Acc: 0.370
Validation loss decreased (-0.355059 --> -0.369552).  Saving model ...
Epoch: 6 cost time: 1.024501085281372
Epoch: 6, Steps: 9 | Train Loss: 0.903 Vali Loss: 1.272 Vali Acc: 0.384 Test Loss: 1.272 Test Acc: 0.384
Validation loss decreased (-0.369552 --> -0.384045).  Saving model ...
Epoch: 7 cost time: 0.8382322788238525
Epoch: 7, Steps: 9 | Train Loss: 0.804 Vali Loss: 1.242 Vali Acc: 0.377 Test Loss: 1.242 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7561850547790527
Epoch: 8, Steps: 9 | Train Loss: 0.718 Vali Loss: 1.212 Vali Acc: 0.413 Test Loss: 1.212 Test Acc: 0.413
Validation loss decreased (-0.384045 --> -0.413031).  Saving model ...
Epoch: 9 cost time: 0.9011998176574707
Epoch: 9, Steps: 9 | Train Loss: 0.634 Vali Loss: 1.199 Vali Acc: 0.399 Test Loss: 1.199 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8832399845123291
Epoch: 10, Steps: 9 | Train Loss: 0.560 Vali Loss: 1.179 Vali Acc: 0.428 Test Loss: 1.179 Test Acc: 0.428
Validation loss decreased (-0.413031 --> -0.427524).  Saving model ...
Epoch: 11 cost time: 1.0219435691833496
Epoch: 11, Steps: 9 | Train Loss: 0.478 Vali Loss: 1.157 Vali Acc: 0.435 Test Loss: 1.157 Test Acc: 0.435
Validation loss decreased (-0.427524 --> -0.434771).  Saving model ...
Epoch: 12 cost time: 0.9126389026641846
Epoch: 12, Steps: 9 | Train Loss: 0.423 Vali Loss: 1.163 Vali Acc: 0.442 Test Loss: 1.163 Test Acc: 0.442
Validation loss decreased (-0.434771 --> -0.442017).  Saving model ...
Epoch: 13 cost time: 0.9041597843170166
Epoch: 13, Steps: 9 | Train Loss: 0.362 Vali Loss: 1.140 Vali Acc: 0.435 Test Loss: 1.140 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9919462203979492
Epoch: 14, Steps: 9 | Train Loss: 0.300 Vali Loss: 1.120 Vali Acc: 0.457 Test Loss: 1.120 Test Acc: 0.457
Validation loss decreased (-0.442017 --> -0.456511).  Saving model ...
Epoch: 15 cost time: 1.0257682800292969
Epoch: 15, Steps: 9 | Train Loss: 0.255 Vali Loss: 1.125 Vali Acc: 0.457 Test Loss: 1.125 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.133044719696045
Epoch: 16, Steps: 9 | Train Loss: 0.225 Vali Loss: 1.127 Vali Acc: 0.478 Test Loss: 1.127 Test Acc: 0.478
Validation loss decreased (-0.456511 --> -0.478250).  Saving model ...
Epoch: 17 cost time: 0.9333012104034424
Epoch: 17, Steps: 9 | Train Loss: 0.187 Vali Loss: 1.107 Vali Acc: 0.464 Test Loss: 1.107 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9445385932922363
Epoch: 18, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.104 Vali Acc: 0.493 Test Loss: 1.104 Test Acc: 0.493
Validation loss decreased (-0.478250 --> -0.492743).  Saving model ...
Epoch: 19 cost time: 0.8958961963653564
Epoch: 19, Steps: 9 | Train Loss: 0.140 Vali Loss: 1.106 Vali Acc: 0.507 Test Loss: 1.106 Test Acc: 0.507
Validation loss decreased (-0.492743 --> -0.507235).  Saving model ...
Epoch: 20 cost time: 0.9208273887634277
Epoch: 20, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.096 Vali Acc: 0.471 Test Loss: 1.096 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8145487308502197
Epoch: 21, Steps: 9 | Train Loss: 0.105 Vali Loss: 1.104 Vali Acc: 0.471 Test Loss: 1.104 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7389893531799316
Epoch: 22, Steps: 9 | Train Loss: 0.086 Vali Loss: 1.118 Vali Acc: 0.493 Test Loss: 1.118 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8533689975738525
Epoch: 23, Steps: 9 | Train Loss: 0.075 Vali Loss: 1.114 Vali Acc: 0.486 Test Loss: 1.114 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7976572513580322
Epoch: 24, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7383601665496826
Epoch: 25, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9782195091247559
Epoch: 26, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8413238525390625
Epoch: 27, Steps: 9 | Train Loss: 0.042 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8035542964935303
Epoch: 28, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.129 Vali Acc: 0.486 Test Loss: 1.129 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1201927661895752
Epoch: 29, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.127 Vali Acc: 0.486 Test Loss: 1.127 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w5_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5072463768115942
model parameter : 109658
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7890729904174805
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.381 Vali Acc: 0.268 Test Loss: 1.381 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.8144848346710205
Epoch: 2, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.333 Vali Acc: 0.341 Test Loss: 1.333 Test Acc: 0.341
Validation loss decreased (-0.268102 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 1.0280680656433105
Epoch: 3, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.288 Vali Acc: 0.355 Test Loss: 1.288 Test Acc: 0.355
Validation loss decreased (-0.340566 --> -0.355060).  Saving model ...
Epoch: 4 cost time: 0.7561917304992676
Epoch: 4, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.249 Vali Acc: 0.406 Test Loss: 1.249 Test Acc: 0.406
Validation loss decreased (-0.355060 --> -0.405785).  Saving model ...
Epoch: 5 cost time: 0.9701478481292725
Epoch: 5, Steps: 9 | Train Loss: 0.957 Vali Loss: 1.205 Vali Acc: 0.442 Test Loss: 1.205 Test Acc: 0.442
Validation loss decreased (-0.405785 --> -0.442017).  Saving model ...
Epoch: 6 cost time: 1.055452585220337
Epoch: 6, Steps: 9 | Train Loss: 0.851 Vali Loss: 1.180 Vali Acc: 0.457 Test Loss: 1.180 Test Acc: 0.457
Validation loss decreased (-0.442017 --> -0.456510).  Saving model ...
Epoch: 7 cost time: 0.906348466873169
Epoch: 7, Steps: 9 | Train Loss: 0.764 Vali Loss: 1.150 Vali Acc: 0.493 Test Loss: 1.150 Test Acc: 0.493
Validation loss decreased (-0.456510 --> -0.492742).  Saving model ...
Epoch: 8 cost time: 0.951446533203125
Epoch: 8, Steps: 9 | Train Loss: 0.673 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
Validation loss decreased (-0.492742 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.9523956775665283
Epoch: 9, Steps: 9 | Train Loss: 0.593 Vali Loss: 1.110 Vali Acc: 0.507 Test Loss: 1.110 Test Acc: 0.507
Validation loss decreased (-0.499989 --> -0.507235).  Saving model ...
Epoch: 10 cost time: 0.7340126037597656
Epoch: 10, Steps: 9 | Train Loss: 0.486 Vali Loss: 1.099 Vali Acc: 0.536 Test Loss: 1.099 Test Acc: 0.536
Validation loss decreased (-0.507235 --> -0.536221).  Saving model ...
Epoch: 11 cost time: 0.9272646903991699
Epoch: 11, Steps: 9 | Train Loss: 0.421 Vali Loss: 1.095 Vali Acc: 0.522 Test Loss: 1.095 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.724055290222168
Epoch: 12, Steps: 9 | Train Loss: 0.360 Vali Loss: 1.081 Vali Acc: 0.514 Test Loss: 1.081 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.15926194190979
Epoch: 13, Steps: 9 | Train Loss: 0.296 Vali Loss: 1.078 Vali Acc: 0.536 Test Loss: 1.078 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536221).  Saving model ...
Epoch: 14 cost time: 0.9456300735473633
Epoch: 14, Steps: 9 | Train Loss: 0.247 Vali Loss: 1.069 Vali Acc: 0.522 Test Loss: 1.069 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9185943603515625
Epoch: 15, Steps: 9 | Train Loss: 0.204 Vali Loss: 1.070 Vali Acc: 0.514 Test Loss: 1.070 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.961418628692627
Epoch: 16, Steps: 9 | Train Loss: 0.162 Vali Loss: 1.052 Vali Acc: 0.514 Test Loss: 1.052 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8782212734222412
Epoch: 17, Steps: 9 | Train Loss: 0.136 Vali Loss: 1.046 Vali Acc: 0.514 Test Loss: 1.046 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1754300594329834
Epoch: 18, Steps: 9 | Train Loss: 0.114 Vali Loss: 1.049 Vali Acc: 0.514 Test Loss: 1.049 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9878480434417725
Epoch: 19, Steps: 9 | Train Loss: 0.098 Vali Loss: 1.036 Vali Acc: 0.536 Test Loss: 1.036 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536222).  Saving model ...
Epoch: 20 cost time: 0.9082629680633545
Epoch: 20, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.054 Vali Acc: 0.529 Test Loss: 1.054 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0563461780548096
Epoch: 21, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.045 Vali Acc: 0.522 Test Loss: 1.045 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.061823844909668
Epoch: 22, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.034 Vali Acc: 0.536 Test Loss: 1.034 Test Acc: 0.536
Validation loss decreased (-0.536222 --> -0.536222).  Saving model ...
Epoch: 23 cost time: 0.9665746688842773
Epoch: 23, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.045 Vali Acc: 0.529 Test Loss: 1.045 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.141282558441162
Epoch: 24, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.054 Vali Acc: 0.522 Test Loss: 1.054 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9027230739593506
Epoch: 25, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.044 Vali Acc: 0.536 Test Loss: 1.044 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8311009407043457
Epoch: 26, Steps: 9 | Train Loss: 0.036 Vali Loss: 1.052 Vali Acc: 0.543 Test Loss: 1.052 Test Acc: 0.543
Validation loss decreased (-0.536222 --> -0.543468).  Saving model ...
Epoch: 27 cost time: 0.9693830013275146
Epoch: 27, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.057 Vali Acc: 0.536 Test Loss: 1.057 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.966942310333252
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.044 Vali Acc: 0.551 Test Loss: 1.044 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550714).  Saving model ...
Epoch: 29 cost time: 1.2445685863494873
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.054 Vali Acc: 0.543 Test Loss: 1.054 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8273212909698486
Epoch: 30, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.054 Vali Acc: 0.551 Test Loss: 1.054 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.036700963973999
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.058 Vali Acc: 0.543 Test Loss: 1.058 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9366114139556885
Epoch: 32, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.045 Vali Acc: 0.551 Test Loss: 1.045 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0411643981933594
Epoch: 33, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.056 Vali Acc: 0.551 Test Loss: 1.056 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8085658550262451
Epoch: 34, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.058 Vali Acc: 0.551 Test Loss: 1.058 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7672603130340576
Epoch: 35, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.052 Vali Acc: 0.565 Test Loss: 1.052 Test Acc: 0.565
Validation loss decreased (-0.550714 --> -0.565207).  Saving model ...
Epoch: 36 cost time: 1.006859302520752
Epoch: 36, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.054 Vali Acc: 0.565 Test Loss: 1.054 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9423770904541016
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.061 Vali Acc: 0.565 Test Loss: 1.061 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9681532382965088
Epoch: 38, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.061 Vali Acc: 0.565 Test Loss: 1.061 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8859028816223145
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.061 Vali Acc: 0.558 Test Loss: 1.061 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9365415573120117
Epoch: 40, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.068 Vali Acc: 0.551 Test Loss: 1.068 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9574301242828369
Epoch: 41, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.060 Vali Acc: 0.558 Test Loss: 1.060 Test Acc: 0.558
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8648803234100342
Epoch: 42, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.067 Vali Acc: 0.558 Test Loss: 1.067 Test Acc: 0.558
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7745401859283447
Epoch: 43, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.068 Vali Acc: 0.558 Test Loss: 1.068 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9786524772644043
Epoch: 44, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.071 Vali Acc: 0.558 Test Loss: 1.071 Test Acc: 0.558
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0225121974945068
Epoch: 45, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.071 Vali Acc: 0.558 Test Loss: 1.071 Test Acc: 0.558
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 109146
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.95402455329895
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.408 Vali Acc: 0.261 Test Loss: 1.408 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 0.7818610668182373
Epoch: 2, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.369 Vali Acc: 0.254 Test Loss: 1.369 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7510831356048584
Epoch: 3, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.327 Vali Acc: 0.290 Test Loss: 1.327 Test Acc: 0.290
Validation loss decreased (-0.260855 --> -0.289842).  Saving model ...
Epoch: 4 cost time: 0.8328680992126465
Epoch: 4, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.291 Vali Acc: 0.319 Test Loss: 1.291 Test Acc: 0.319
Validation loss decreased (-0.289842 --> -0.318828).  Saving model ...
Epoch: 5 cost time: 0.6845862865447998
Epoch: 5, Steps: 9 | Train Loss: 0.928 Vali Loss: 1.250 Vali Acc: 0.355 Test Loss: 1.250 Test Acc: 0.355
Validation loss decreased (-0.318828 --> -0.355060).  Saving model ...
Epoch: 6 cost time: 0.776540994644165
Epoch: 6, Steps: 9 | Train Loss: 0.846 Vali Loss: 1.210 Vali Acc: 0.420 Test Loss: 1.210 Test Acc: 0.420
Validation loss decreased (-0.355060 --> -0.420278).  Saving model ...
Epoch: 7 cost time: 0.7282347679138184
Epoch: 7, Steps: 9 | Train Loss: 0.745 Vali Loss: 1.194 Vali Acc: 0.471 Test Loss: 1.194 Test Acc: 0.471
Validation loss decreased (-0.420278 --> -0.471003).  Saving model ...
Epoch: 8 cost time: 0.8877520561218262
Epoch: 8, Steps: 9 | Train Loss: 0.664 Vali Loss: 1.182 Vali Acc: 0.457 Test Loss: 1.182 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.843970775604248
Epoch: 9, Steps: 9 | Train Loss: 0.572 Vali Loss: 1.176 Vali Acc: 0.478 Test Loss: 1.176 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478249).  Saving model ...
Epoch: 10 cost time: 0.7648630142211914
Epoch: 10, Steps: 9 | Train Loss: 0.493 Vali Loss: 1.164 Vali Acc: 0.478 Test Loss: 1.164 Test Acc: 0.478
Validation loss decreased (-0.478249 --> -0.478249).  Saving model ...
Epoch: 11 cost time: 0.7733590602874756
Epoch: 11, Steps: 9 | Train Loss: 0.403 Vali Loss: 1.153 Vali Acc: 0.529 Test Loss: 1.153 Test Acc: 0.529
Validation loss decreased (-0.478249 --> -0.528974).  Saving model ...
Epoch: 12 cost time: 0.8550105094909668
Epoch: 12, Steps: 9 | Train Loss: 0.345 Vali Loss: 1.171 Vali Acc: 0.507 Test Loss: 1.171 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0386927127838135
Epoch: 13, Steps: 9 | Train Loss: 0.277 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8465738296508789
Epoch: 14, Steps: 9 | Train Loss: 0.232 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8879127502441406
Epoch: 15, Steps: 9 | Train Loss: 0.178 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8364236354827881
Epoch: 16, Steps: 9 | Train Loss: 0.148 Vali Loss: 1.200 Vali Acc: 0.493 Test Loss: 1.200 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7440862655639648
Epoch: 17, Steps: 9 | Train Loss: 0.120 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7915918827056885
Epoch: 18, Steps: 9 | Train Loss: 0.097 Vali Loss: 1.177 Vali Acc: 0.522 Test Loss: 1.177 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8828475475311279
Epoch: 19, Steps: 9 | Train Loss: 0.080 Vali Loss: 1.203 Vali Acc: 0.507 Test Loss: 1.203 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8383967876434326
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7242062091827393
Epoch: 21, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.220 Vali Acc: 0.522 Test Loss: 1.220 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_MTSMixer_UEA_ftM_sl206_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5289855072463768
model parameter : 108634
model size : 0.42MB
