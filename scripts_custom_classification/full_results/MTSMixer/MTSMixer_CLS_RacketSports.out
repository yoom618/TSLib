Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9777698516845703
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.428 Vali Acc: 0.224 Test Loss: 1.428 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 0.9142704010009766
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.368 Vali Acc: 0.296 Test Loss: 1.368 Test Acc: 0.296
Validation loss decreased (-0.223670 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.095977544784546
Epoch: 3, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.299 Vali Acc: 0.414 Test Loss: 1.299 Test Acc: 0.414
Validation loss decreased (-0.296039 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.1374659538269043
Epoch: 4, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
Validation loss decreased (-0.414461 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 1.0669636726379395
Epoch: 5, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.172 Vali Acc: 0.572 Test Loss: 1.172 Test Acc: 0.572
Validation loss decreased (-0.467093 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.1622188091278076
Epoch: 6, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.124 Vali Acc: 0.605 Test Loss: 1.124 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605252).  Saving model ...
Epoch: 7 cost time: 1.043086051940918
Epoch: 7, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.087 Vali Acc: 0.651 Test Loss: 1.087 Test Acc: 0.651
Validation loss decreased (-0.605252 --> -0.651305).  Saving model ...
Epoch: 8 cost time: 1.029662847518921
Epoch: 8, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.050 Vali Acc: 0.638 Test Loss: 1.050 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0933842658996582
Epoch: 9, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.021 Vali Acc: 0.651 Test Loss: 1.021 Test Acc: 0.651
Validation loss decreased (-0.651305 --> -0.651306).  Saving model ...
Epoch: 10 cost time: 0.9696030616760254
Epoch: 10, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.984 Vali Acc: 0.658 Test Loss: 0.984 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657885).  Saving model ...
Epoch: 11 cost time: 1.1668615341186523
Epoch: 11, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.958 Vali Acc: 0.671 Test Loss: 0.958 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671043).  Saving model ...
Epoch: 12 cost time: 1.2303352355957031
Epoch: 12, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.927 Vali Acc: 0.678 Test Loss: 0.927 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677622).  Saving model ...
Epoch: 13 cost time: 0.9606683254241943
Epoch: 13, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.907 Vali Acc: 0.678 Test Loss: 0.907 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677623).  Saving model ...
Epoch: 14 cost time: 0.915393590927124
Epoch: 14, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.879 Vali Acc: 0.724 Test Loss: 0.879 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723675).  Saving model ...
Epoch: 15 cost time: 0.9541325569152832
Epoch: 15, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.851 Vali Acc: 0.717 Test Loss: 0.851 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9552388191223145
Epoch: 16, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.826 Vali Acc: 0.724 Test Loss: 0.826 Test Acc: 0.724
Validation loss decreased (-0.723675 --> -0.723676).  Saving model ...
Epoch: 17 cost time: 0.9783031940460205
Epoch: 17, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.804 Vali Acc: 0.717 Test Loss: 0.804 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4071943759918213
Epoch: 18, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.777 Vali Acc: 0.743 Test Loss: 0.777 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743413).  Saving model ...
Epoch: 19 cost time: 1.117095947265625
Epoch: 19, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.760 Vali Acc: 0.750 Test Loss: 0.760 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.9875838756561279
Epoch: 20, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.736 Vali Acc: 0.763 Test Loss: 0.736 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 0.9293394088745117
Epoch: 21, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.721 Vali Acc: 0.776 Test Loss: 0.721 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 22 cost time: 1.040727138519287
Epoch: 22, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802625).  Saving model ...
Epoch: 23 cost time: 1.5158579349517822
Epoch: 23, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.233727216720581
Epoch: 24, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9248950481414795
Epoch: 25, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.644 Vali Acc: 0.816 Test Loss: 0.644 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 26 cost time: 1.2510032653808594
Epoch: 26, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 1.3180172443389893
Epoch: 27, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.337825059890747
Epoch: 28, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2693023681640625
Epoch: 29, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0573112964630127
Epoch: 30, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2659695148468018
Epoch: 31, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822363).  Saving model ...
Epoch: 32 cost time: 0.9077434539794922
Epoch: 32, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 33 cost time: 0.9145276546478271
Epoch: 33, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 34 cost time: 1.2502996921539307
Epoch: 34, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2084333896636963
Epoch: 35, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4327268600463867
Epoch: 36, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 37 cost time: 1.025580644607544
Epoch: 37, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.087843656539917
Epoch: 38, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3247125148773193
Epoch: 39, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0630080699920654
Epoch: 40, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 41 cost time: 0.9432187080383301
Epoch: 41, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 42 cost time: 1.055680274963379
Epoch: 42, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.507 Vali Acc: 0.836 Test Loss: 0.507 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 43 cost time: 1.2460212707519531
Epoch: 43, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.510 Vali Acc: 0.822 Test Loss: 0.510 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.132526159286499
Epoch: 44, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.6939325332641602
Epoch: 45, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2565057277679443
Epoch: 46, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.494 Vali Acc: 0.842 Test Loss: 0.494 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 47 cost time: 1.4696180820465088
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3366661071777344
Epoch: 48, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.296138048171997
Epoch: 49, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.4295070171356201
Epoch: 50, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0565171241760254
Epoch: 51, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.237013816833496
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1874241828918457
Epoch: 53, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.1926310062408447
Epoch: 54, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.207625389099121
Epoch: 55, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.495 Vali Acc: 0.842 Test Loss: 0.495 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.170719861984253
Epoch: 56, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 132008
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.957798480987549
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.423 Vali Acc: 0.211 Test Loss: 1.423 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 0.81439208984375
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.360 Vali Acc: 0.322 Test Loss: 1.360 Test Acc: 0.322
Validation loss decreased (-0.210512 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.0596404075622559
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.282 Vali Acc: 0.434 Test Loss: 1.282 Test Acc: 0.434
Validation loss decreased (-0.322355 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 1.3441312313079834
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.201 Vali Acc: 0.579 Test Loss: 1.201 Test Acc: 0.579
Validation loss decreased (-0.434198 --> -0.578935).  Saving model ...
Epoch: 5 cost time: 1.0638062953948975
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.578935 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.9195098876953125
Epoch: 6, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.057 Vali Acc: 0.651 Test Loss: 1.057 Test Acc: 0.651
Validation loss decreased (-0.624989 --> -0.651305).  Saving model ...
Epoch: 7 cost time: 0.8100695610046387
Epoch: 7, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.011 Vali Acc: 0.664 Test Loss: 1.011 Test Acc: 0.664
Validation loss decreased (-0.651305 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 0.9750680923461914
Epoch: 8, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.971 Vali Acc: 0.684 Test Loss: 0.971 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 9 cost time: 0.9919631481170654
Epoch: 9, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
Validation loss decreased (-0.684201 --> -0.717096).  Saving model ...
Epoch: 10 cost time: 1.0411899089813232
Epoch: 10, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.901 Vali Acc: 0.743 Test Loss: 0.901 Test Acc: 0.743
Validation loss decreased (-0.717096 --> -0.743412).  Saving model ...
Epoch: 11 cost time: 1.0879037380218506
Epoch: 11, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.872 Vali Acc: 0.743 Test Loss: 0.872 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743412).  Saving model ...
Epoch: 12 cost time: 0.9386475086212158
Epoch: 12, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.836 Vali Acc: 0.770 Test Loss: 0.836 Test Acc: 0.770
Validation loss decreased (-0.743412 --> -0.769728).  Saving model ...
Epoch: 13 cost time: 1.0386958122253418
Epoch: 13, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
Validation loss decreased (-0.769728 --> -0.782887).  Saving model ...
Epoch: 14 cost time: 1.0070319175720215
Epoch: 14, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.779 Vali Acc: 0.789 Test Loss: 0.779 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 15 cost time: 1.0197556018829346
Epoch: 15, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.745 Vali Acc: 0.783 Test Loss: 0.745 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9019801616668701
Epoch: 16, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 17 cost time: 0.9328062534332275
Epoch: 17, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802625).  Saving model ...
Epoch: 18 cost time: 0.9286139011383057
Epoch: 18, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 19 cost time: 0.9685056209564209
Epoch: 19, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9560296535491943
Epoch: 20, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 21 cost time: 1.2853496074676514
Epoch: 21, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 1.1546742916107178
Epoch: 22, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0679879188537598
Epoch: 23, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 24 cost time: 1.0248754024505615
Epoch: 24, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9655804634094238
Epoch: 25, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 26 cost time: 1.0396308898925781
Epoch: 26, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.008272647857666
Epoch: 27, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9587130546569824
Epoch: 28, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 29 cost time: 0.8428523540496826
Epoch: 29, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.504 Vali Acc: 0.836 Test Loss: 0.504 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835521).  Saving model ...
Epoch: 30 cost time: 1.0950648784637451
Epoch: 30, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8589739799499512
Epoch: 31, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2460696697235107
Epoch: 32, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0687463283538818
Epoch: 33, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0988154411315918
Epoch: 34, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2111613750457764
Epoch: 35, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.474 Vali Acc: 0.836 Test Loss: 0.474 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 36 cost time: 1.2023169994354248
Epoch: 36, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.98612380027771
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8252511024475098
Epoch: 38, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9148051738739014
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2039361000061035
Epoch: 40, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1877906322479248
Epoch: 41, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.471 Vali Acc: 0.822 Test Loss: 0.471 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1592819690704346
Epoch: 42, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9660689830780029
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.803494930267334
Epoch: 44, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0781629085540771
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 129960
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.836412191390991
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.362 Vali Acc: 0.296 Test Loss: 1.362 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.9888894557952881
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.313 Vali Acc: 0.355 Test Loss: 1.313 Test Acc: 0.355
Validation loss decreased (-0.296039 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 0.9998080730438232
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.247 Vali Acc: 0.474 Test Loss: 1.247 Test Acc: 0.474
Validation loss decreased (-0.355250 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 0.8617146015167236
Epoch: 4, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.183 Vali Acc: 0.520 Test Loss: 1.183 Test Acc: 0.520
Validation loss decreased (-0.473672 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 0.9867074489593506
Epoch: 5, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.519725 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.838916540145874
Epoch: 6, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.073 Vali Acc: 0.671 Test Loss: 1.073 Test Acc: 0.671
Validation loss decreased (-0.624989 --> -0.671042).  Saving model ...
Epoch: 7 cost time: 0.8861565589904785
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.027 Vali Acc: 0.678 Test Loss: 1.027 Test Acc: 0.678
Validation loss decreased (-0.671042 --> -0.677621).  Saving model ...
Epoch: 8 cost time: 0.744067907333374
Epoch: 8, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.982 Vali Acc: 0.684 Test Loss: 0.982 Test Acc: 0.684
Validation loss decreased (-0.677621 --> -0.684201).  Saving model ...
Epoch: 9 cost time: 0.8674237728118896
Epoch: 9, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.945 Vali Acc: 0.711 Test Loss: 0.945 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710517).  Saving model ...
Epoch: 10 cost time: 0.8957870006561279
Epoch: 10, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.903 Vali Acc: 0.704 Test Loss: 0.903 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9470720291137695
Epoch: 11, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.864 Vali Acc: 0.737 Test Loss: 0.864 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736833).  Saving model ...
Epoch: 12 cost time: 0.9319884777069092
Epoch: 12, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.830 Vali Acc: 0.757 Test Loss: 0.830 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756571).  Saving model ...
Epoch: 13 cost time: 0.8681087493896484
Epoch: 13, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.796 Vali Acc: 0.770 Test Loss: 0.796 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 14 cost time: 0.845264196395874
Epoch: 14, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 15 cost time: 1.3254129886627197
Epoch: 15, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.711 Vali Acc: 0.796 Test Loss: 0.711 Test Acc: 0.796
Validation loss decreased (-0.782887 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 0.9472808837890625
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
Validation loss decreased (-0.796046 --> -0.822362).  Saving model ...
Epoch: 17 cost time: 0.8887951374053955
Epoch: 17, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.668 Vali Acc: 0.822 Test Loss: 0.668 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822362).  Saving model ...
Epoch: 18 cost time: 1.1480047702789307
Epoch: 18, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.638 Vali Acc: 0.836 Test Loss: 0.638 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 19 cost time: 0.9712677001953125
Epoch: 19, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.617 Vali Acc: 0.842 Test Loss: 0.617 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 20 cost time: 0.9403340816497803
Epoch: 20, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.602 Vali Acc: 0.829 Test Loss: 0.602 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2143969535827637
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9949491024017334
Epoch: 22, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.566 Vali Acc: 0.829 Test Loss: 0.566 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.963970422744751
Epoch: 23, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.557 Vali Acc: 0.836 Test Loss: 0.557 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1460299491882324
Epoch: 24, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.546 Vali Acc: 0.842 Test Loss: 0.546 Test Acc: 0.842
Validation loss decreased (-0.842099 --> -0.842100).  Saving model ...
Epoch: 25 cost time: 1.1778478622436523
Epoch: 25, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.539 Vali Acc: 0.829 Test Loss: 0.539 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.118729591369629
Epoch: 26, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.534 Vali Acc: 0.836 Test Loss: 0.534 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1863892078399658
Epoch: 27, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.520 Vali Acc: 0.842 Test Loss: 0.520 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 28 cost time: 0.9716739654541016
Epoch: 28, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855258).  Saving model ...
Epoch: 29 cost time: 1.226855754852295
Epoch: 29, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 30 cost time: 1.4571285247802734
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.506 Vali Acc: 0.836 Test Loss: 0.506 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5173366069793701
Epoch: 31, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.499 Vali Acc: 0.849 Test Loss: 0.499 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2704920768737793
Epoch: 32, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 33 cost time: 1.0838868618011475
Epoch: 33, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.487 Vali Acc: 0.849 Test Loss: 0.487 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9593355655670166
Epoch: 34, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 35 cost time: 1.1503610610961914
Epoch: 35, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 36 cost time: 1.0010199546813965
Epoch: 36, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 37 cost time: 1.1144254207611084
Epoch: 37, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.486 Vali Acc: 0.849 Test Loss: 0.486 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1385784149169922
Epoch: 38, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861837).  Saving model ...
Epoch: 39 cost time: 1.0186951160430908
Epoch: 39, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1823382377624512
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 41 cost time: 1.4044520854949951
Epoch: 41, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9726738929748535
Epoch: 42, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.480 Vali Acc: 0.849 Test Loss: 0.480 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8912153244018555
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.479 Vali Acc: 0.849 Test Loss: 0.479 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8396999835968018
Epoch: 44, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9301357269287109
Epoch: 45, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0620014667510986
Epoch: 46, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 47 cost time: 0.9493923187255859
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9340193271636963
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.168198823928833
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1080093383789062
Epoch: 50, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1896862983703613
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9850137233734131
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1544761657714844
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2475972175598145
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.9640138149261475
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9414036273956299
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 127912
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9884355068206787
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.417 Vali Acc: 0.263 Test Loss: 1.417 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 0.9021737575531006
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.356 Vali Acc: 0.336 Test Loss: 1.356 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.9641737937927246
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.275 Vali Acc: 0.487 Test Loss: 1.275 Test Acc: 0.487
Validation loss decreased (-0.335513 --> -0.486829).  Saving model ...
Epoch: 4 cost time: 0.9840645790100098
Epoch: 4, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.191 Vali Acc: 0.586 Test Loss: 1.191 Test Acc: 0.586
Validation loss decreased (-0.486829 --> -0.585514).  Saving model ...
Epoch: 5 cost time: 1.0022335052490234
Epoch: 5, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.115 Vali Acc: 0.697 Test Loss: 1.115 Test Acc: 0.697
Validation loss decreased (-0.585514 --> -0.697357).  Saving model ...
Epoch: 6 cost time: 0.8228881359100342
Epoch: 6, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.045 Vali Acc: 0.717 Test Loss: 1.045 Test Acc: 0.717
Validation loss decreased (-0.697357 --> -0.717095).  Saving model ...
Epoch: 7 cost time: 0.9163484573364258
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.988 Vali Acc: 0.743 Test Loss: 0.988 Test Acc: 0.743
Validation loss decreased (-0.717095 --> -0.743411).  Saving model ...
Epoch: 8 cost time: 0.9717295169830322
Epoch: 8, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.938 Vali Acc: 0.763 Test Loss: 0.938 Test Acc: 0.763
Validation loss decreased (-0.743411 --> -0.763149).  Saving model ...
Epoch: 9 cost time: 0.8719093799591064
Epoch: 9, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.893 Vali Acc: 0.770 Test Loss: 0.893 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769728).  Saving model ...
Epoch: 10 cost time: 0.8763270378112793
Epoch: 10, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.852 Vali Acc: 0.783 Test Loss: 0.852 Test Acc: 0.783
Validation loss decreased (-0.769728 --> -0.782886).  Saving model ...
Epoch: 11 cost time: 1.0408811569213867
Epoch: 11, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.817 Vali Acc: 0.803 Test Loss: 0.817 Test Acc: 0.803
Validation loss decreased (-0.782886 --> -0.802623).  Saving model ...
Epoch: 12 cost time: 0.9179985523223877
Epoch: 12, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.785 Vali Acc: 0.796 Test Loss: 0.785 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9749722480773926
Epoch: 13, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.754 Vali Acc: 0.809 Test Loss: 0.754 Test Acc: 0.809
Validation loss decreased (-0.802623 --> -0.809203).  Saving model ...
Epoch: 14 cost time: 0.9830265045166016
Epoch: 14, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.716 Vali Acc: 0.809 Test Loss: 0.716 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809203).  Saving model ...
Epoch: 15 cost time: 0.8919286727905273
Epoch: 15, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809204).  Saving model ...
Epoch: 16 cost time: 0.8801946640014648
Epoch: 16, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 17 cost time: 0.830315113067627
Epoch: 17, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 18 cost time: 1.0286777019500732
Epoch: 18, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 19 cost time: 0.9094960689544678
Epoch: 19, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 20 cost time: 0.850966215133667
Epoch: 20, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.602 Vali Acc: 0.829 Test Loss: 0.602 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 21 cost time: 0.8447115421295166
Epoch: 21, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.599 Vali Acc: 0.829 Test Loss: 0.599 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828941).  Saving model ...
Epoch: 22 cost time: 0.8701958656311035
Epoch: 22, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8199574947357178
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7545425891876221
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.02207612991333
Epoch: 25, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7140252590179443
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8806440830230713
Epoch: 27, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0139312744140625
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7058980464935303
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6724786758422852
Epoch: 30, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7179532051086426
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 125864
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9644954204559326
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.417 Vali Acc: 0.263 Test Loss: 1.417 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 0.8163862228393555
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.356 Vali Acc: 0.336 Test Loss: 1.356 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.8127553462982178
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.275 Vali Acc: 0.487 Test Loss: 1.275 Test Acc: 0.487
Validation loss decreased (-0.335513 --> -0.486829).  Saving model ...
Epoch: 4 cost time: 0.9512143135070801
Epoch: 4, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.191 Vali Acc: 0.586 Test Loss: 1.191 Test Acc: 0.586
Validation loss decreased (-0.486829 --> -0.585514).  Saving model ...
Epoch: 5 cost time: 1.0059657096862793
Epoch: 5, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.115 Vali Acc: 0.697 Test Loss: 1.115 Test Acc: 0.697
Validation loss decreased (-0.585514 --> -0.697357).  Saving model ...
Epoch: 6 cost time: 1.0899627208709717
Epoch: 6, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.045 Vali Acc: 0.717 Test Loss: 1.045 Test Acc: 0.717
Validation loss decreased (-0.697357 --> -0.717095).  Saving model ...
Epoch: 7 cost time: 1.1519262790679932
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.988 Vali Acc: 0.743 Test Loss: 0.988 Test Acc: 0.743
Validation loss decreased (-0.717095 --> -0.743411).  Saving model ...
Epoch: 8 cost time: 0.9640247821807861
Epoch: 8, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.938 Vali Acc: 0.763 Test Loss: 0.938 Test Acc: 0.763
Validation loss decreased (-0.743411 --> -0.763149).  Saving model ...
Epoch: 9 cost time: 1.060361385345459
Epoch: 9, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.893 Vali Acc: 0.770 Test Loss: 0.893 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769728).  Saving model ...
Epoch: 10 cost time: 0.910789966583252
Epoch: 10, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.852 Vali Acc: 0.783 Test Loss: 0.852 Test Acc: 0.783
Validation loss decreased (-0.769728 --> -0.782886).  Saving model ...
Epoch: 11 cost time: 0.8216536045074463
Epoch: 11, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.817 Vali Acc: 0.803 Test Loss: 0.817 Test Acc: 0.803
Validation loss decreased (-0.782886 --> -0.802623).  Saving model ...
Epoch: 12 cost time: 0.8942620754241943
Epoch: 12, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.785 Vali Acc: 0.796 Test Loss: 0.785 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8747730255126953
Epoch: 13, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.754 Vali Acc: 0.809 Test Loss: 0.754 Test Acc: 0.809
Validation loss decreased (-0.802623 --> -0.809203).  Saving model ...
Epoch: 14 cost time: 0.9358005523681641
Epoch: 14, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.716 Vali Acc: 0.809 Test Loss: 0.716 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809203).  Saving model ...
Epoch: 15 cost time: 0.8769028186798096
Epoch: 15, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809204).  Saving model ...
Epoch: 16 cost time: 0.9308013916015625
Epoch: 16, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 17 cost time: 1.125063419342041
Epoch: 17, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 18 cost time: 0.8233909606933594
Epoch: 18, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 19 cost time: 0.9164743423461914
Epoch: 19, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 20 cost time: 0.9930229187011719
Epoch: 20, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.602 Vali Acc: 0.829 Test Loss: 0.602 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 21 cost time: 0.8475608825683594
Epoch: 21, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.599 Vali Acc: 0.829 Test Loss: 0.599 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828941).  Saving model ...
Epoch: 22 cost time: 0.8835551738739014
Epoch: 22, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8296587467193604
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9072396755218506
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9607751369476318
Epoch: 25, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8786072731018066
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9923238754272461
Epoch: 27, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8477535247802734
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.02970552444458
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1724989414215088
Epoch: 30, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8758082389831543
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 125864
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.903841018676758
Epoch: 1, Steps: 10 | Train Loss: 1.546 Vali Loss: 1.490 Vali Acc: 0.204 Test Loss: 1.490 Test Acc: 0.204
Validation loss decreased (inf --> -0.203932).  Saving model ...
Epoch: 2 cost time: 1.0561432838439941
Epoch: 2, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
Validation loss decreased (-0.203932 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 1.3719065189361572
Epoch: 3, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.350 Vali Acc: 0.309 Test Loss: 1.350 Test Acc: 0.309
Validation loss decreased (-0.243407 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 0.9666163921356201
Epoch: 4, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.291 Vali Acc: 0.414 Test Loss: 1.291 Test Acc: 0.414
Validation loss decreased (-0.309197 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.0318355560302734
Epoch: 5, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
Validation loss decreased (-0.414461 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.3813767433166504
Epoch: 6, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.186 Vali Acc: 0.553 Test Loss: 1.186 Test Acc: 0.553
Validation loss decreased (-0.499988 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 0.8868939876556396
Epoch: 7, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.140 Vali Acc: 0.599 Test Loss: 1.140 Test Acc: 0.599
Validation loss decreased (-0.552620 --> -0.598673).  Saving model ...
Epoch: 8 cost time: 0.9890422821044922
Epoch: 8, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
Validation loss decreased (-0.598673 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.0560510158538818
Epoch: 9, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.059 Vali Acc: 0.645 Test Loss: 1.059 Test Acc: 0.645
Validation loss decreased (-0.624989 --> -0.644726).  Saving model ...
Epoch: 10 cost time: 1.0621013641357422
Epoch: 10, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.026 Vali Acc: 0.671 Test Loss: 1.026 Test Acc: 0.671
Validation loss decreased (-0.644726 --> -0.671042).  Saving model ...
Epoch: 11 cost time: 0.9050664901733398
Epoch: 11, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.989 Vali Acc: 0.691 Test Loss: 0.989 Test Acc: 0.691
Validation loss decreased (-0.671042 --> -0.690780).  Saving model ...
Epoch: 12 cost time: 0.8737637996673584
Epoch: 12, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.952 Vali Acc: 0.711 Test Loss: 0.952 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710517).  Saving model ...
Epoch: 13 cost time: 1.0263171195983887
Epoch: 13, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.914 Vali Acc: 0.711 Test Loss: 0.914 Test Acc: 0.711
Validation loss decreased (-0.710517 --> -0.710517).  Saving model ...
Epoch: 14 cost time: 0.9758238792419434
Epoch: 14, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.880 Vali Acc: 0.730 Test Loss: 0.880 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730254).  Saving model ...
Epoch: 15 cost time: 0.9091916084289551
Epoch: 15, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.846 Vali Acc: 0.743 Test Loss: 0.846 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 1.1038119792938232
Epoch: 16, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.823 Vali Acc: 0.743 Test Loss: 0.823 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743413).  Saving model ...
Epoch: 17 cost time: 1.3773491382598877
Epoch: 17, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 1.2640578746795654
Epoch: 18, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.771 Vali Acc: 0.757 Test Loss: 0.771 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756571).  Saving model ...
Epoch: 19 cost time: 0.9419667720794678
Epoch: 19, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.745 Vali Acc: 0.783 Test Loss: 0.745 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782887).  Saving model ...
Epoch: 20 cost time: 1.000060796737671
Epoch: 20, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8276164531707764
Epoch: 21, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.708 Vali Acc: 0.776 Test Loss: 0.708 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3059241771697998
Epoch: 22, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.698 Vali Acc: 0.770 Test Loss: 0.698 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2336204051971436
Epoch: 23, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.683 Vali Acc: 0.776 Test Loss: 0.683 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0708096027374268
Epoch: 24, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.662 Vali Acc: 0.770 Test Loss: 0.662 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.231210470199585
Epoch: 25, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.087756633758545
Epoch: 26, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
Validation loss decreased (-0.782887 --> -0.796046).  Saving model ...
Epoch: 27 cost time: 1.579603672027588
Epoch: 27, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1585185527801514
Epoch: 28, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
Epoch: 29 cost time: 1.3116774559020996
Epoch: 29, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
Epoch: 30 cost time: 1.2563135623931885
Epoch: 30, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.22513747215271
Epoch: 31, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 1.3993160724639893
Epoch: 32, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7470967769622803
Epoch: 33, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 34 cost time: 1.4630458354949951
Epoch: 34, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.278852939605713
Epoch: 35, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 36 cost time: 1.3508200645446777
Epoch: 36, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1916389465332031
Epoch: 37, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2583203315734863
Epoch: 38, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2795171737670898
Epoch: 39, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5641093254089355
Epoch: 40, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.294403076171875
Epoch: 41, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.245330572128296
Epoch: 42, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 43 cost time: 1.139692783355713
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 44 cost time: 1.0619142055511475
Epoch: 44, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2987432479858398
Epoch: 45, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.547 Vali Acc: 0.836 Test Loss: 0.547 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835521).  Saving model ...
Epoch: 46 cost time: 1.5214178562164307
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.539 Vali Acc: 0.836 Test Loss: 0.539 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 47 cost time: 1.2202367782592773
Epoch: 47, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2733933925628662
Epoch: 48, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.202263355255127
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1690220832824707
Epoch: 50, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.533 Vali Acc: 0.829 Test Loss: 0.533 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1686363220214844
Epoch: 51, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1036415100097656
Epoch: 52, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.0853991508483887
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0363059043884277
Epoch: 54, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.220564842224121
Epoch: 55, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.533 Vali Acc: 0.829 Test Loss: 0.533 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1176202297210693
Epoch: 56, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 131956
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9169788360595703
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.412 Vali Acc: 0.283 Test Loss: 1.412 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.0827984809875488
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.361 Vali Acc: 0.368 Test Loss: 1.361 Test Acc: 0.368
Validation loss decreased (-0.282881 --> -0.368407).  Saving model ...
Epoch: 3 cost time: 0.7947590351104736
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.296 Vali Acc: 0.454 Test Loss: 1.296 Test Acc: 0.454
Validation loss decreased (-0.368407 --> -0.453934).  Saving model ...
Epoch: 4 cost time: 1.0162568092346191
Epoch: 4, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.228 Vali Acc: 0.526 Test Loss: 1.228 Test Acc: 0.526
Validation loss decreased (-0.453934 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 0.9435374736785889
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.168 Vali Acc: 0.599 Test Loss: 1.168 Test Acc: 0.599
Validation loss decreased (-0.526304 --> -0.598673).  Saving model ...
Epoch: 6 cost time: 0.8503837585449219
Epoch: 6, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.118 Vali Acc: 0.632 Test Loss: 1.118 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631568).  Saving model ...
Epoch: 7 cost time: 1.0884547233581543
Epoch: 7, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.075 Vali Acc: 0.638 Test Loss: 1.075 Test Acc: 0.638
Validation loss decreased (-0.631568 --> -0.638147).  Saving model ...
Epoch: 8 cost time: 0.9044771194458008
Epoch: 8, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.038 Vali Acc: 0.671 Test Loss: 1.038 Test Acc: 0.671
Validation loss decreased (-0.638147 --> -0.671042).  Saving model ...
Epoch: 9 cost time: 0.936180591583252
Epoch: 9, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.000 Vali Acc: 0.691 Test Loss: 1.000 Test Acc: 0.691
Validation loss decreased (-0.671042 --> -0.690779).  Saving model ...
Epoch: 10 cost time: 0.8180751800537109
Epoch: 10, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.963 Vali Acc: 0.711 Test Loss: 0.963 Test Acc: 0.711
Validation loss decreased (-0.690779 --> -0.710517).  Saving model ...
Epoch: 11 cost time: 0.8937010765075684
Epoch: 11, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.931 Vali Acc: 0.704 Test Loss: 0.931 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8919110298156738
Epoch: 12, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.898 Vali Acc: 0.730 Test Loss: 0.898 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730254).  Saving model ...
Epoch: 13 cost time: 1.0009546279907227
Epoch: 13, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
Validation loss decreased (-0.730254 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.7370131015777588
Epoch: 14, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.825 Vali Acc: 0.776 Test Loss: 0.825 Test Acc: 0.776
Validation loss decreased (-0.749991 --> -0.776308).  Saving model ...
Epoch: 15 cost time: 0.9248068332672119
Epoch: 15, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.794 Vali Acc: 0.789 Test Loss: 0.794 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789466).  Saving model ...
Epoch: 16 cost time: 0.9372732639312744
Epoch: 16, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9144647121429443
Epoch: 17, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.745 Vali Acc: 0.789 Test Loss: 0.745 Test Acc: 0.789
Validation loss decreased (-0.789466 --> -0.789466).  Saving model ...
Epoch: 18 cost time: 0.884796142578125
Epoch: 18, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.724 Vali Acc: 0.803 Test Loss: 0.724 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802624).  Saving model ...
Epoch: 19 cost time: 0.7643907070159912
Epoch: 19, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.701 Vali Acc: 0.796 Test Loss: 0.701 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8764674663543701
Epoch: 20, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809204).  Saving model ...
Epoch: 21 cost time: 0.7774081230163574
Epoch: 21, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 22 cost time: 0.8872263431549072
Epoch: 22, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8657984733581543
Epoch: 23, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.632 Vali Acc: 0.809 Test Loss: 0.632 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 24 cost time: 0.9129989147186279
Epoch: 24, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.615 Vali Acc: 0.816 Test Loss: 0.615 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 25 cost time: 0.8098552227020264
Epoch: 25, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9145786762237549
Epoch: 26, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0357487201690674
Epoch: 27, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8354043960571289
Epoch: 28, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0403931140899658
Epoch: 29, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0961358547210693
Epoch: 30, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0015666484832764
Epoch: 31, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9835658073425293
Epoch: 32, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0846505165100098
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9792218208312988
Epoch: 34, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 129908
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9714815616607666
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.435 Vali Acc: 0.164 Test Loss: 1.435 Test Acc: 0.164
Validation loss decreased (inf --> -0.164459).  Saving model ...
Epoch: 2 cost time: 0.9065656661987305
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.376 Vali Acc: 0.204 Test Loss: 1.376 Test Acc: 0.204
Validation loss decreased (-0.164459 --> -0.203934).  Saving model ...
Epoch: 3 cost time: 0.8080592155456543
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.311 Vali Acc: 0.342 Test Loss: 1.311 Test Acc: 0.342
Validation loss decreased (-0.203934 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 0.919471263885498
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (-0.342092 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.829195499420166
Epoch: 5, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.168 Vali Acc: 0.572 Test Loss: 1.168 Test Acc: 0.572
Validation loss decreased (-0.499988 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.0149331092834473
Epoch: 6, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.103 Vali Acc: 0.586 Test Loss: 1.103 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 1.0295050144195557
Epoch: 7, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.045 Vali Acc: 0.638 Test Loss: 1.045 Test Acc: 0.638
Validation loss decreased (-0.585515 --> -0.638147).  Saving model ...
Epoch: 8 cost time: 0.8149533271789551
Epoch: 8, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.996 Vali Acc: 0.664 Test Loss: 0.996 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664464).  Saving model ...
Epoch: 9 cost time: 0.8558127880096436
Epoch: 9, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.949 Vali Acc: 0.658 Test Loss: 0.949 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9666380882263184
Epoch: 10, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.912 Vali Acc: 0.678 Test Loss: 0.912 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677622).  Saving model ...
Epoch: 11 cost time: 0.9062817096710205
Epoch: 11, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.873 Vali Acc: 0.711 Test Loss: 0.873 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710518).  Saving model ...
Epoch: 12 cost time: 1.11210298538208
Epoch: 12, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717097).  Saving model ...
Epoch: 13 cost time: 0.8743336200714111
Epoch: 13, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.808 Vali Acc: 0.730 Test Loss: 0.808 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 14 cost time: 1.0142292976379395
Epoch: 14, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.778 Vali Acc: 0.724 Test Loss: 0.778 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2512195110321045
Epoch: 15, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.750 Vali Acc: 0.743 Test Loss: 0.750 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 0.8198709487915039
Epoch: 16, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.720 Vali Acc: 0.757 Test Loss: 0.720 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 17 cost time: 1.0602459907531738
Epoch: 17, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.700 Vali Acc: 0.750 Test Loss: 0.700 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7848374843597412
Epoch: 18, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.678 Vali Acc: 0.757 Test Loss: 0.678 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 19 cost time: 0.9134602546691895
Epoch: 19, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 0.9194056987762451
Epoch: 20, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.93062424659729
Epoch: 21, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.630 Vali Acc: 0.763 Test Loss: 0.630 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0878300666809082
Epoch: 22, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9085848331451416
Epoch: 23, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 24 cost time: 1.303483486175537
Epoch: 24, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 0.923168420791626
Epoch: 25, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.583 Vali Acc: 0.776 Test Loss: 0.583 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9750392436981201
Epoch: 26, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 27 cost time: 0.784278392791748
Epoch: 27, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.178032636642456
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 0.9270668029785156
Epoch: 29, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 0.976893424987793
Epoch: 30, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 0.8849608898162842
Epoch: 31, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 32 cost time: 0.9483473300933838
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9992170333862305
Epoch: 33, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0909385681152344
Epoch: 34, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 35 cost time: 0.7825634479522705
Epoch: 35, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.060258388519287
Epoch: 36, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 37 cost time: 0.8406679630279541
Epoch: 37, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2790451049804688
Epoch: 38, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9458866119384766
Epoch: 39, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.265293836593628
Epoch: 40, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 41 cost time: 0.9546360969543457
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1844606399536133
Epoch: 42, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1942288875579834
Epoch: 43, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.192807674407959
Epoch: 44, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8452327251434326
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 46 cost time: 1.0019981861114502
Epoch: 46, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 47 cost time: 1.1600229740142822
Epoch: 47, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0409541130065918
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1922409534454346
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1664843559265137
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0222151279449463
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0697522163391113
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9473793506622314
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9132232666015625
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.1001641750335693
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9214766025543213
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 127860
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9307501316070557
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.022881031036377
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.348 Vali Acc: 0.336 Test Loss: 1.348 Test Acc: 0.336
Validation loss decreased (-0.243407 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.0529556274414062
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.279 Vali Acc: 0.421 Test Loss: 1.279 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.061748743057251
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.209 Vali Acc: 0.559 Test Loss: 1.209 Test Acc: 0.559
Validation loss decreased (-0.421040 --> -0.559198).  Saving model ...
Epoch: 5 cost time: 0.7607550621032715
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.140 Vali Acc: 0.651 Test Loss: 1.140 Test Acc: 0.651
Validation loss decreased (-0.559198 --> -0.651304).  Saving model ...
Epoch: 6 cost time: 0.8343691825866699
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.072 Vali Acc: 0.678 Test Loss: 1.072 Test Acc: 0.678
Validation loss decreased (-0.651304 --> -0.677621).  Saving model ...
Epoch: 7 cost time: 0.8927383422851562
Epoch: 7, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.002 Vali Acc: 0.684 Test Loss: 1.002 Test Acc: 0.684
Validation loss decreased (-0.677621 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 1.05979323387146
Epoch: 8, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.935 Vali Acc: 0.737 Test Loss: 0.935 Test Acc: 0.737
Validation loss decreased (-0.684201 --> -0.736833).  Saving model ...
Epoch: 9 cost time: 0.788724422454834
Epoch: 9, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.878 Vali Acc: 0.757 Test Loss: 0.878 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756570).  Saving model ...
Epoch: 10 cost time: 0.8500144481658936
Epoch: 10, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.831 Vali Acc: 0.757 Test Loss: 0.831 Test Acc: 0.757
Validation loss decreased (-0.756570 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 0.8014283180236816
Epoch: 11, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.790 Vali Acc: 0.770 Test Loss: 0.790 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 12 cost time: 0.8951544761657715
Epoch: 12, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 13 cost time: 0.9225461483001709
Epoch: 13, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
Validation loss decreased (-0.782887 --> -0.796045).  Saving model ...
Epoch: 14 cost time: 1.00044584274292
Epoch: 14, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.685 Vali Acc: 0.816 Test Loss: 0.685 Test Acc: 0.816
Validation loss decreased (-0.796045 --> -0.815783).  Saving model ...
Epoch: 15 cost time: 1.110337734222412
Epoch: 15, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 16 cost time: 1.0230391025543213
Epoch: 16, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.630 Vali Acc: 0.836 Test Loss: 0.630 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 17 cost time: 0.8424458503723145
Epoch: 17, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.605 Vali Acc: 0.836 Test Loss: 0.605 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835520).  Saving model ...
Epoch: 18 cost time: 0.7917876243591309
Epoch: 18, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.584 Vali Acc: 0.842 Test Loss: 0.584 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 19 cost time: 1.089322805404663
Epoch: 19, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.563 Vali Acc: 0.842 Test Loss: 0.563 Test Acc: 0.842
Validation loss decreased (-0.842099 --> -0.842100).  Saving model ...
Epoch: 20 cost time: 1.073632001876831
Epoch: 20, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.543 Vali Acc: 0.842 Test Loss: 0.543 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 21 cost time: 1.0212388038635254
Epoch: 21, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.528 Vali Acc: 0.842 Test Loss: 0.528 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 22 cost time: 0.8739752769470215
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.514 Vali Acc: 0.836 Test Loss: 0.514 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9404258728027344
Epoch: 23, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.503 Vali Acc: 0.842 Test Loss: 0.503 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 24 cost time: 0.889721155166626
Epoch: 24, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.495 Vali Acc: 0.836 Test Loss: 0.495 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8581743240356445
Epoch: 25, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.488 Vali Acc: 0.842 Test Loss: 0.488 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 26 cost time: 0.7891583442687988
Epoch: 26, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.480 Vali Acc: 0.836 Test Loss: 0.480 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1140916347503662
Epoch: 27, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.477 Vali Acc: 0.829 Test Loss: 0.477 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0706393718719482
Epoch: 28, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.470 Vali Acc: 0.836 Test Loss: 0.470 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9402222633361816
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.470 Vali Acc: 0.836 Test Loss: 0.470 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0400097370147705
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.842 Test Loss: 0.463 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 31 cost time: 0.8800411224365234
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8640565872192383
Epoch: 32, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9316525459289551
Epoch: 33, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.457 Vali Acc: 0.836 Test Loss: 0.457 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0909385681152344
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9366083145141602
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0921785831451416
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.454 Vali Acc: 0.836 Test Loss: 0.454 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.772364616394043
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.455 Vali Acc: 0.842 Test Loss: 0.455 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 38 cost time: 0.9031994342803955
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.457 Vali Acc: 0.842 Test Loss: 0.457 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.017397165298462
Epoch: 39, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.454 Vali Acc: 0.836 Test Loss: 0.454 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1164708137512207
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.457 Vali Acc: 0.836 Test Loss: 0.457 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0188190937042236
Epoch: 41, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0332696437835693
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9499301910400391
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.854846715927124
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.460 Vali Acc: 0.829 Test Loss: 0.460 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8751699924468994
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.836 Test Loss: 0.465 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7839963436126709
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.467 Vali Acc: 0.836 Test Loss: 0.467 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8162105083465576
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 125812
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6027486324310303
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.7427911758422852
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.348 Vali Acc: 0.336 Test Loss: 1.348 Test Acc: 0.336
Validation loss decreased (-0.243407 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.7539222240447998
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.279 Vali Acc: 0.421 Test Loss: 1.279 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 0.7534990310668945
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.209 Vali Acc: 0.559 Test Loss: 1.209 Test Acc: 0.559
Validation loss decreased (-0.421040 --> -0.559198).  Saving model ...
Epoch: 5 cost time: 0.8074064254760742
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.140 Vali Acc: 0.651 Test Loss: 1.140 Test Acc: 0.651
Validation loss decreased (-0.559198 --> -0.651304).  Saving model ...
Epoch: 6 cost time: 0.9160223007202148
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.072 Vali Acc: 0.678 Test Loss: 1.072 Test Acc: 0.678
Validation loss decreased (-0.651304 --> -0.677621).  Saving model ...
Epoch: 7 cost time: 0.6914675235748291
Epoch: 7, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.002 Vali Acc: 0.684 Test Loss: 1.002 Test Acc: 0.684
Validation loss decreased (-0.677621 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 1.1935596466064453
Epoch: 8, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.935 Vali Acc: 0.737 Test Loss: 0.935 Test Acc: 0.737
Validation loss decreased (-0.684201 --> -0.736833).  Saving model ...
Epoch: 9 cost time: 0.7321796417236328
Epoch: 9, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.878 Vali Acc: 0.757 Test Loss: 0.878 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756570).  Saving model ...
Epoch: 10 cost time: 0.9587421417236328
Epoch: 10, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.831 Vali Acc: 0.757 Test Loss: 0.831 Test Acc: 0.757
Validation loss decreased (-0.756570 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 0.9510729312896729
Epoch: 11, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.790 Vali Acc: 0.770 Test Loss: 0.790 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 12 cost time: 0.9695353507995605
Epoch: 12, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 13 cost time: 1.0448951721191406
Epoch: 13, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
Validation loss decreased (-0.782887 --> -0.796045).  Saving model ...
Epoch: 14 cost time: 0.8230841159820557
Epoch: 14, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.685 Vali Acc: 0.816 Test Loss: 0.685 Test Acc: 0.816
Validation loss decreased (-0.796045 --> -0.815783).  Saving model ...
Epoch: 15 cost time: 0.8301582336425781
Epoch: 15, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 16 cost time: 0.9982991218566895
Epoch: 16, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.630 Vali Acc: 0.836 Test Loss: 0.630 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 17 cost time: 0.8008174896240234
Epoch: 17, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.605 Vali Acc: 0.836 Test Loss: 0.605 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835520).  Saving model ...
Epoch: 18 cost time: 0.9337308406829834
Epoch: 18, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.584 Vali Acc: 0.842 Test Loss: 0.584 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 19 cost time: 0.9729444980621338
Epoch: 19, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.563 Vali Acc: 0.842 Test Loss: 0.563 Test Acc: 0.842
Validation loss decreased (-0.842099 --> -0.842100).  Saving model ...
Epoch: 20 cost time: 0.8731863498687744
Epoch: 20, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.543 Vali Acc: 0.842 Test Loss: 0.543 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 21 cost time: 0.872525691986084
Epoch: 21, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.528 Vali Acc: 0.842 Test Loss: 0.528 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 22 cost time: 0.7476882934570312
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.514 Vali Acc: 0.836 Test Loss: 0.514 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8785982131958008
Epoch: 23, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.503 Vali Acc: 0.842 Test Loss: 0.503 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 24 cost time: 0.9870965480804443
Epoch: 24, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.495 Vali Acc: 0.836 Test Loss: 0.495 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0290369987487793
Epoch: 25, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.488 Vali Acc: 0.842 Test Loss: 0.488 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 26 cost time: 0.9022312164306641
Epoch: 26, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.480 Vali Acc: 0.836 Test Loss: 0.480 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1703529357910156
Epoch: 27, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.477 Vali Acc: 0.829 Test Loss: 0.477 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0764045715332031
Epoch: 28, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.470 Vali Acc: 0.836 Test Loss: 0.470 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9719154834747314
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.470 Vali Acc: 0.836 Test Loss: 0.470 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.014636754989624
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.842 Test Loss: 0.463 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 31 cost time: 0.8993299007415771
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8275220394134521
Epoch: 32, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9298865795135498
Epoch: 33, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.457 Vali Acc: 0.836 Test Loss: 0.457 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8765604496002197
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9548323154449463
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8447475433349609
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.454 Vali Acc: 0.836 Test Loss: 0.454 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7895450592041016
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.455 Vali Acc: 0.842 Test Loss: 0.455 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 38 cost time: 0.8724040985107422
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.457 Vali Acc: 0.842 Test Loss: 0.457 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9296178817749023
Epoch: 39, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.454 Vali Acc: 0.836 Test Loss: 0.454 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8817348480224609
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.457 Vali Acc: 0.836 Test Loss: 0.457 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7674181461334229
Epoch: 41, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.836057186126709
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0249335765838623
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9398233890533447
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.460 Vali Acc: 0.829 Test Loss: 0.460 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8721470832824707
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.836 Test Loss: 0.465 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0665597915649414
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.467 Vali Acc: 0.836 Test Loss: 0.467 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.856069803237915
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 125812
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8721065521240234
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.381 Vali Acc: 0.316 Test Loss: 1.381 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.9462375640869141
Epoch: 2, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.240 Vali Acc: 0.487 Test Loss: 1.240 Test Acc: 0.487
Validation loss decreased (-0.315776 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 0.9657180309295654
Epoch: 3, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.486830 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 0.8376035690307617
Epoch: 4, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.046 Vali Acc: 0.638 Test Loss: 1.046 Test Acc: 0.638
Validation loss decreased (-0.572357 --> -0.638147).  Saving model ...
Epoch: 5 cost time: 1.116882085800171
Epoch: 5, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.008 Vali Acc: 0.651 Test Loss: 1.008 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 0.8242442607879639
Epoch: 6, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.964 Vali Acc: 0.678 Test Loss: 0.964 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 1.0186595916748047
Epoch: 7, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.940 Vali Acc: 0.691 Test Loss: 0.940 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 0.6868813037872314
Epoch: 8, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.911 Vali Acc: 0.678 Test Loss: 0.911 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9724898338317871
Epoch: 9, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.883 Vali Acc: 0.691 Test Loss: 0.883 Test Acc: 0.691
Validation loss decreased (-0.690780 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 0.7951107025146484
Epoch: 10, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.856 Vali Acc: 0.724 Test Loss: 0.856 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723676).  Saving model ...
Epoch: 11 cost time: 0.8440401554107666
Epoch: 11, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.831 Vali Acc: 0.711 Test Loss: 0.831 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9968211650848389
Epoch: 12, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.812 Vali Acc: 0.737 Test Loss: 0.812 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736834).  Saving model ...
Epoch: 13 cost time: 0.9666969776153564
Epoch: 13, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.792 Vali Acc: 0.737 Test Loss: 0.792 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736834).  Saving model ...
Epoch: 14 cost time: 0.9553287029266357
Epoch: 14, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.765 Vali Acc: 0.750 Test Loss: 0.765 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.817213773727417
Epoch: 15, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.746 Vali Acc: 0.770 Test Loss: 0.746 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769729).  Saving model ...
Epoch: 16 cost time: 1.1004431247711182
Epoch: 16, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.727 Vali Acc: 0.770 Test Loss: 0.727 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769730).  Saving model ...
Epoch: 17 cost time: 0.7898092269897461
Epoch: 17, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.732 Vali Acc: 0.730 Test Loss: 0.732 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9101948738098145
Epoch: 18, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8751349449157715
Epoch: 19, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.698 Vali Acc: 0.737 Test Loss: 0.698 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9363498687744141
Epoch: 20, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 21 cost time: 0.9701311588287354
Epoch: 21, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.663 Vali Acc: 0.770 Test Loss: 0.663 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9586787223815918
Epoch: 22, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9770839214324951
Epoch: 23, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.663 Vali Acc: 0.737 Test Loss: 0.663 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9561953544616699
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.657 Vali Acc: 0.711 Test Loss: 0.657 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7921946048736572
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8584706783294678
Epoch: 26, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8724219799041748
Epoch: 27, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.643 Vali Acc: 0.743 Test Loss: 0.643 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7874915599822998
Epoch: 28, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.636 Vali Acc: 0.743 Test Loss: 0.636 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8338088989257812
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.636 Vali Acc: 0.711 Test Loss: 0.636 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0491809844970703
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 131892
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6454315185546875
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.378 Vali Acc: 0.270 Test Loss: 1.378 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.8920528888702393
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.252 Vali Acc: 0.447 Test Loss: 1.252 Test Acc: 0.447
Validation loss decreased (-0.269723 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 0.71529221534729
Epoch: 3, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.142 Vali Acc: 0.579 Test Loss: 1.142 Test Acc: 0.579
Validation loss decreased (-0.447356 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 0.8576366901397705
Epoch: 4, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.062 Vali Acc: 0.658 Test Loss: 1.062 Test Acc: 0.658
Validation loss decreased (-0.578936 --> -0.657884).  Saving model ...
Epoch: 5 cost time: 0.8488156795501709
Epoch: 5, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.000 Vali Acc: 0.678 Test Loss: 1.000 Test Acc: 0.678
Validation loss decreased (-0.657884 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 0.8097379207611084
Epoch: 6, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.966 Vali Acc: 0.691 Test Loss: 0.966 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 7 cost time: 0.8538434505462646
Epoch: 7, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.934 Vali Acc: 0.691 Test Loss: 0.934 Test Acc: 0.691
Validation loss decreased (-0.690780 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 0.8289813995361328
Epoch: 8, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.907 Vali Acc: 0.711 Test Loss: 0.907 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710517).  Saving model ...
Epoch: 9 cost time: 0.9963619709014893
Epoch: 9, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.871 Vali Acc: 0.743 Test Loss: 0.871 Test Acc: 0.743
Validation loss decreased (-0.710517 --> -0.743412).  Saving model ...
Epoch: 10 cost time: 0.7736318111419678
Epoch: 10, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.854 Vali Acc: 0.743 Test Loss: 0.854 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743413).  Saving model ...
Epoch: 11 cost time: 0.8988566398620605
Epoch: 11, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.9990758895874023
Epoch: 12, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.792 Vali Acc: 0.743 Test Loss: 0.792 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9408764839172363
Epoch: 13, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.782887).  Saving model ...
Epoch: 14 cost time: 0.7623324394226074
Epoch: 14, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.751 Vali Acc: 0.763 Test Loss: 0.751 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8194315433502197
Epoch: 15, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.747 Vali Acc: 0.770 Test Loss: 0.747 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7933294773101807
Epoch: 16, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.741 Vali Acc: 0.757 Test Loss: 0.741 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9297404289245605
Epoch: 17, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.710 Vali Acc: 0.763 Test Loss: 0.710 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7208049297332764
Epoch: 18, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.704 Vali Acc: 0.770 Test Loss: 0.704 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8649592399597168
Epoch: 19, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.721 Vali Acc: 0.763 Test Loss: 0.721 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8212740421295166
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.670 Vali Acc: 0.770 Test Loss: 0.670 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8313953876495361
Epoch: 21, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.686 Vali Acc: 0.743 Test Loss: 0.686 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8381650447845459
Epoch: 22, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 23 cost time: 0.771153450012207
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.672 Vali Acc: 0.776 Test Loss: 0.672 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7820868492126465
Epoch: 24, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809204).  Saving model ...
Epoch: 25 cost time: 0.7159345149993896
Epoch: 25, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.849027156829834
Epoch: 26, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8191030025482178
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7160117626190186
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8680720329284668
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7695825099945068
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8236651420593262
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.853461503982544
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8011400699615479
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7934479713439941
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 129844
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7304768562316895
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.501 Vali Acc: 0.211 Test Loss: 1.501 Test Acc: 0.211
Validation loss decreased (inf --> -0.210511).  Saving model ...
Epoch: 2 cost time: 0.7164862155914307
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.374 Vali Acc: 0.336 Test Loss: 1.374 Test Acc: 0.336
Validation loss decreased (-0.210511 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.8049986362457275
Epoch: 3, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.246 Vali Acc: 0.474 Test Loss: 1.246 Test Acc: 0.474
Validation loss decreased (-0.335513 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 0.900029182434082
Epoch: 4, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.154 Vali Acc: 0.553 Test Loss: 1.154 Test Acc: 0.553
Validation loss decreased (-0.473672 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 0.9490146636962891
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.081 Vali Acc: 0.638 Test Loss: 1.081 Test Acc: 0.638
Validation loss decreased (-0.552620 --> -0.638147).  Saving model ...
Epoch: 6 cost time: 1.092649221420288
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.027 Vali Acc: 0.671 Test Loss: 1.027 Test Acc: 0.671
Validation loss decreased (-0.638147 --> -0.671042).  Saving model ...
Epoch: 7 cost time: 0.9471609592437744
Epoch: 7, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.971 Vali Acc: 0.697 Test Loss: 0.971 Test Acc: 0.697
Validation loss decreased (-0.671042 --> -0.697359).  Saving model ...
Epoch: 8 cost time: 1.3199141025543213
Epoch: 8, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.929 Vali Acc: 0.730 Test Loss: 0.929 Test Acc: 0.730
Validation loss decreased (-0.697359 --> -0.730254).  Saving model ...
Epoch: 9 cost time: 0.8099193572998047
Epoch: 9, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.891 Vali Acc: 0.763 Test Loss: 0.891 Test Acc: 0.763
Validation loss decreased (-0.730254 --> -0.763149).  Saving model ...
Epoch: 10 cost time: 0.985663652420044
Epoch: 10, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.868 Vali Acc: 0.770 Test Loss: 0.868 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769728).  Saving model ...
Epoch: 11 cost time: 0.9394726753234863
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.836 Vali Acc: 0.783 Test Loss: 0.836 Test Acc: 0.783
Validation loss decreased (-0.769728 --> -0.782886).  Saving model ...
Epoch: 12 cost time: 1.0097572803497314
Epoch: 12, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.806 Vali Acc: 0.776 Test Loss: 0.806 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7768378257751465
Epoch: 13, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.773 Vali Acc: 0.770 Test Loss: 0.773 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7534279823303223
Epoch: 14, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.746 Vali Acc: 0.776 Test Loss: 0.746 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8890361785888672
Epoch: 15, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.722 Vali Acc: 0.770 Test Loss: 0.722 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8067200183868408
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.711 Vali Acc: 0.770 Test Loss: 0.711 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9413444995880127
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9323809146881104
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9403307437896729
Epoch: 19, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0394773483276367
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0365824699401855
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 127796
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4799153804779053
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.400 Vali Acc: 0.283 Test Loss: 1.400 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.083160400390625
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.265 Vali Acc: 0.461 Test Loss: 1.265 Test Acc: 0.461
Validation loss decreased (-0.282881 --> -0.460514).  Saving model ...
Epoch: 3 cost time: 0.7011551856994629
Epoch: 3, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.133 Vali Acc: 0.605 Test Loss: 1.133 Test Acc: 0.605
Validation loss decreased (-0.460514 --> -0.605252).  Saving model ...
Epoch: 4 cost time: 0.7581079006195068
Epoch: 4, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.044 Vali Acc: 0.671 Test Loss: 1.044 Test Acc: 0.671
Validation loss decreased (-0.605252 --> -0.671042).  Saving model ...
Epoch: 5 cost time: 0.735931396484375
Epoch: 5, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.974 Vali Acc: 0.724 Test Loss: 0.974 Test Acc: 0.724
Validation loss decreased (-0.671042 --> -0.723674).  Saving model ...
Epoch: 6 cost time: 0.7539975643157959
Epoch: 6, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.911 Vali Acc: 0.743 Test Loss: 0.911 Test Acc: 0.743
Validation loss decreased (-0.723674 --> -0.743412).  Saving model ...
Epoch: 7 cost time: 0.6534371376037598
Epoch: 7, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.863 Vali Acc: 0.757 Test Loss: 0.863 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756570).  Saving model ...
Epoch: 8 cost time: 0.7619960308074951
Epoch: 8, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.812 Vali Acc: 0.776 Test Loss: 0.812 Test Acc: 0.776
Validation loss decreased (-0.756570 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 0.8009042739868164
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.779 Vali Acc: 0.789 Test Loss: 0.779 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789466).  Saving model ...
Epoch: 10 cost time: 0.7957849502563477
Epoch: 10, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.750 Vali Acc: 0.796 Test Loss: 0.750 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 11 cost time: 0.8926258087158203
Epoch: 11, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5971028804779053
Epoch: 12, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.87872314453125
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6239404678344727
Epoch: 14, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 0.6001224517822266
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 0.7722573280334473
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.647 Vali Acc: 0.770 Test Loss: 0.647 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6487667560577393
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.65110182762146
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6452302932739258
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7468628883361816
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8165171146392822
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7666363716125488
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8604764938354492
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8559970855712891
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.605 Vali Acc: 0.776 Test Loss: 0.605 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8731894493103027
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 125748
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.597874879837036
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.400 Vali Acc: 0.283 Test Loss: 1.400 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.7582101821899414
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.265 Vali Acc: 0.461 Test Loss: 1.265 Test Acc: 0.461
Validation loss decreased (-0.282881 --> -0.460514).  Saving model ...
Epoch: 3 cost time: 0.8665146827697754
Epoch: 3, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.133 Vali Acc: 0.605 Test Loss: 1.133 Test Acc: 0.605
Validation loss decreased (-0.460514 --> -0.605252).  Saving model ...
Epoch: 4 cost time: 0.7267611026763916
Epoch: 4, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.044 Vali Acc: 0.671 Test Loss: 1.044 Test Acc: 0.671
Validation loss decreased (-0.605252 --> -0.671042).  Saving model ...
Epoch: 5 cost time: 0.886305570602417
Epoch: 5, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.974 Vali Acc: 0.724 Test Loss: 0.974 Test Acc: 0.724
Validation loss decreased (-0.671042 --> -0.723674).  Saving model ...
Epoch: 6 cost time: 0.7278387546539307
Epoch: 6, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.911 Vali Acc: 0.743 Test Loss: 0.911 Test Acc: 0.743
Validation loss decreased (-0.723674 --> -0.743412).  Saving model ...
Epoch: 7 cost time: 0.8124942779541016
Epoch: 7, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.863 Vali Acc: 0.757 Test Loss: 0.863 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756570).  Saving model ...
Epoch: 8 cost time: 0.6462209224700928
Epoch: 8, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.812 Vali Acc: 0.776 Test Loss: 0.812 Test Acc: 0.776
Validation loss decreased (-0.756570 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 0.8005671501159668
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.779 Vali Acc: 0.789 Test Loss: 0.779 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789466).  Saving model ...
Epoch: 10 cost time: 0.6522057056427002
Epoch: 10, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.750 Vali Acc: 0.796 Test Loss: 0.750 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 11 cost time: 0.7027275562286377
Epoch: 11, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6893103122711182
Epoch: 12, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9331150054931641
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8441708087921143
Epoch: 14, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 0.9261071681976318
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 0.7496607303619385
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.647 Vali Acc: 0.770 Test Loss: 0.647 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6544315814971924
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8119466304779053
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8055336475372314
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8856797218322754
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9275991916656494
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9251160621643066
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6988956928253174
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7743210792541504
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.605 Vali Acc: 0.776 Test Loss: 0.605 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0836503505706787
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 125748
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.841465473175049
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.388 Vali Acc: 0.303 Test Loss: 1.388 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.0569076538085938
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.357 Vali Acc: 0.329 Test Loss: 1.357 Test Acc: 0.329
Validation loss decreased (-0.302618 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.043811321258545
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.316 Vali Acc: 0.355 Test Loss: 1.316 Test Acc: 0.355
Validation loss decreased (-0.328934 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.1783347129821777
Epoch: 4, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.272 Vali Acc: 0.428 Test Loss: 1.272 Test Acc: 0.428
Validation loss decreased (-0.355250 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 0.9933052062988281
Epoch: 5, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.227 Vali Acc: 0.507 Test Loss: 1.227 Test Acc: 0.507
Validation loss decreased (-0.427619 --> -0.506567).  Saving model ...
Epoch: 6 cost time: 0.8983907699584961
Epoch: 6, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.182 Vali Acc: 0.599 Test Loss: 1.182 Test Acc: 0.599
Validation loss decreased (-0.506567 --> -0.598672).  Saving model ...
Epoch: 7 cost time: 1.081681728363037
Epoch: 7, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.139 Vali Acc: 0.632 Test Loss: 1.139 Test Acc: 0.632
Validation loss decreased (-0.598672 --> -0.631568).  Saving model ...
Epoch: 8 cost time: 1.1698248386383057
Epoch: 8, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.097 Vali Acc: 0.645 Test Loss: 1.097 Test Acc: 0.645
Validation loss decreased (-0.631568 --> -0.644726).  Saving model ...
Epoch: 9 cost time: 1.2108561992645264
Epoch: 9, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.056 Vali Acc: 0.664 Test Loss: 1.056 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 1.0666356086730957
Epoch: 10, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.016 Vali Acc: 0.704 Test Loss: 1.016 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703937).  Saving model ...
Epoch: 11 cost time: 1.0353443622589111
Epoch: 11, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.986 Vali Acc: 0.691 Test Loss: 0.986 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9805698394775391
Epoch: 12, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.952 Vali Acc: 0.717 Test Loss: 0.952 Test Acc: 0.717
Validation loss decreased (-0.703937 --> -0.717096).  Saving model ...
Epoch: 13 cost time: 1.1070523262023926
Epoch: 13, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.919 Vali Acc: 0.724 Test Loss: 0.919 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 14 cost time: 0.9675698280334473
Epoch: 14, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.893 Vali Acc: 0.730 Test Loss: 0.893 Test Acc: 0.730
Validation loss decreased (-0.723675 --> -0.730254).  Saving model ...
Epoch: 15 cost time: 0.8687694072723389
Epoch: 15, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.866 Vali Acc: 0.724 Test Loss: 0.866 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9980149269104004
Epoch: 16, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.730254 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 1.1526713371276855
Epoch: 17, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.816 Vali Acc: 0.743 Test Loss: 0.816 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0010535717010498
Epoch: 18, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.788 Vali Acc: 0.757 Test Loss: 0.788 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756571).  Saving model ...
Epoch: 19 cost time: 0.979769229888916
Epoch: 19, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.761 Vali Acc: 0.770 Test Loss: 0.761 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 20 cost time: 0.9245452880859375
Epoch: 20, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.745 Vali Acc: 0.770 Test Loss: 0.745 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769729).  Saving model ...
Epoch: 21 cost time: 1.0948729515075684
Epoch: 21, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
Validation loss decreased (-0.769729 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 0.98471999168396
Epoch: 22, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.711 Vali Acc: 0.816 Test Loss: 0.711 Test Acc: 0.816
Validation loss decreased (-0.789467 --> -0.815782).  Saving model ...
Epoch: 23 cost time: 0.8988075256347656
Epoch: 23, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.696 Vali Acc: 0.809 Test Loss: 0.696 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9589300155639648
Epoch: 24, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7452638149261475
Epoch: 25, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
Validation loss decreased (-0.815782 --> -0.815783).  Saving model ...
Epoch: 26 cost time: 0.8973410129547119
Epoch: 26, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0163915157318115
Epoch: 27, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0523607730865479
Epoch: 28, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1580097675323486
Epoch: 29, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1516008377075195
Epoch: 30, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.015653371810913
Epoch: 31, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.892359733581543
Epoch: 32, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.197906494140625
Epoch: 33, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9742767810821533
Epoch: 34, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1419329643249512
Epoch: 35, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 1.2119901180267334
Epoch: 36, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.114861011505127
Epoch: 37, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.007753849029541
Epoch: 38, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9208376407623291
Epoch: 39, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0104212760925293
Epoch: 40, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2988002300262451
Epoch: 41, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3545103073120117
Epoch: 42, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1122090816497803
Epoch: 43, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0100562572479248
Epoch: 44, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.430260181427002
Epoch: 45, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 66472
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5688095092773438
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.420 Vali Acc: 0.224 Test Loss: 1.420 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.140366792678833
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.389 Vali Acc: 0.250 Test Loss: 1.389 Test Acc: 0.250
Validation loss decreased (-0.223670 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.9048995971679688
Epoch: 3, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.348 Vali Acc: 0.355 Test Loss: 1.348 Test Acc: 0.355
Validation loss decreased (-0.249986 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 0.776125431060791
Epoch: 4, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.305 Vali Acc: 0.408 Test Loss: 1.305 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 0.8421807289123535
Epoch: 5, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.259 Vali Acc: 0.487 Test Loss: 1.259 Test Acc: 0.487
Validation loss decreased (-0.407882 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 1.0114026069641113
Epoch: 6, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.211 Vali Acc: 0.559 Test Loss: 1.211 Test Acc: 0.559
Validation loss decreased (-0.486830 --> -0.559198).  Saving model ...
Epoch: 7 cost time: 0.937248706817627
Epoch: 7, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.166 Vali Acc: 0.592 Test Loss: 1.166 Test Acc: 0.592
Validation loss decreased (-0.559198 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 0.832667350769043
Epoch: 8, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.129 Vali Acc: 0.632 Test Loss: 1.129 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631568).  Saving model ...
Epoch: 9 cost time: 0.7167918682098389
Epoch: 9, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.093 Vali Acc: 0.638 Test Loss: 1.093 Test Acc: 0.638
Validation loss decreased (-0.631568 --> -0.638147).  Saving model ...
Epoch: 10 cost time: 1.0358946323394775
Epoch: 10, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.059 Vali Acc: 0.664 Test Loss: 1.059 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664463).  Saving model ...
Epoch: 11 cost time: 0.9346740245819092
Epoch: 11, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.022 Vali Acc: 0.704 Test Loss: 1.022 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703937).  Saving model ...
Epoch: 12 cost time: 0.9519693851470947
Epoch: 12, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.985 Vali Acc: 0.704 Test Loss: 0.985 Test Acc: 0.704
Validation loss decreased (-0.703937 --> -0.703938).  Saving model ...
Epoch: 13 cost time: 0.894798755645752
Epoch: 13, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.953 Vali Acc: 0.717 Test Loss: 0.953 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717096).  Saving model ...
Epoch: 14 cost time: 0.8341388702392578
Epoch: 14, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.924 Vali Acc: 0.730 Test Loss: 0.924 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730254).  Saving model ...
Epoch: 15 cost time: 0.9351117610931396
Epoch: 15, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.893 Vali Acc: 0.724 Test Loss: 0.893 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9283595085144043
Epoch: 16, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.864 Vali Acc: 0.737 Test Loss: 0.864 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736833).  Saving model ...
Epoch: 17 cost time: 0.8437001705169678
Epoch: 17, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.837 Vali Acc: 0.743 Test Loss: 0.837 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743413).  Saving model ...
Epoch: 18 cost time: 0.8908092975616455
Epoch: 18, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.7740316390991211
Epoch: 19, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.9562339782714844
Epoch: 20, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 1.150787353515625
Epoch: 21, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.754 Vali Acc: 0.743 Test Loss: 0.754 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1538071632385254
Epoch: 22, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 0.8669967651367188
Epoch: 23, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.711 Vali Acc: 0.757 Test Loss: 0.711 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 0.9023268222808838
Epoch: 24, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 25 cost time: 0.966846227645874
Epoch: 25, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.673 Vali Acc: 0.757 Test Loss: 0.673 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 26 cost time: 0.9355082511901855
Epoch: 26, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.665 Vali Acc: 0.763 Test Loss: 0.665 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 27 cost time: 0.9192872047424316
Epoch: 27, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 28 cost time: 0.8920111656188965
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 29 cost time: 0.8375790119171143
Epoch: 29, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 30 cost time: 1.0013427734375
Epoch: 30, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 31 cost time: 0.9876587390899658
Epoch: 31, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.027777910232544
Epoch: 32, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 1.3742406368255615
Epoch: 33, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 0.9796106815338135
Epoch: 34, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9253232479095459
Epoch: 35, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.579 Vali Acc: 0.789 Test Loss: 0.579 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 36 cost time: 1.0089521408081055
Epoch: 36, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9417574405670166
Epoch: 37, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9749910831451416
Epoch: 38, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9612329006195068
Epoch: 39, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9258649349212646
Epoch: 40, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0077149868011475
Epoch: 41, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.883845329284668
Epoch: 42, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9174048900604248
Epoch: 43, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.866978645324707
Epoch: 44, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7503437995910645
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 65448
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.817596673965454
Epoch: 1, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.374 Vali Acc: 0.388 Test Loss: 1.374 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 0.9138858318328857
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.347 Vali Acc: 0.414 Test Loss: 1.347 Test Acc: 0.414
Validation loss decreased (-0.388144 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 0.7882046699523926
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
Validation loss decreased (-0.414460 --> -0.480250).  Saving model ...
Epoch: 4 cost time: 0.8001172542572021
Epoch: 4, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.279 Vali Acc: 0.520 Test Loss: 1.279 Test Acc: 0.520
Validation loss decreased (-0.480250 --> -0.519724).  Saving model ...
Epoch: 5 cost time: 0.785973310470581
Epoch: 5, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.240 Vali Acc: 0.546 Test Loss: 1.240 Test Acc: 0.546
Validation loss decreased (-0.519724 --> -0.546040).  Saving model ...
Epoch: 6 cost time: 0.9351541996002197
Epoch: 6, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.202 Vali Acc: 0.559 Test Loss: 1.202 Test Acc: 0.559
Validation loss decreased (-0.546040 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 0.8351211547851562
Epoch: 7, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.162 Vali Acc: 0.592 Test Loss: 1.162 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 0.9257235527038574
Epoch: 8, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.116 Vali Acc: 0.618 Test Loss: 1.116 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618410).  Saving model ...
Epoch: 9 cost time: 0.8339114189147949
Epoch: 9, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.070 Vali Acc: 0.664 Test Loss: 1.070 Test Acc: 0.664
Validation loss decreased (-0.618410 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 0.7809765338897705
Epoch: 10, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.032 Vali Acc: 0.684 Test Loss: 1.032 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684200).  Saving model ...
Epoch: 11 cost time: 0.8129844665527344
Epoch: 11, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.995 Vali Acc: 0.697 Test Loss: 0.995 Test Acc: 0.697
Validation loss decreased (-0.684200 --> -0.697358).  Saving model ...
Epoch: 12 cost time: 0.8772225379943848
Epoch: 12, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.955 Vali Acc: 0.697 Test Loss: 0.955 Test Acc: 0.697
Validation loss decreased (-0.697358 --> -0.697359).  Saving model ...
Epoch: 13 cost time: 0.7953929901123047
Epoch: 13, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.921 Vali Acc: 0.697 Test Loss: 0.921 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697359).  Saving model ...
Epoch: 14 cost time: 0.8288388252258301
Epoch: 14, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.889 Vali Acc: 0.704 Test Loss: 0.889 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 15 cost time: 0.8464009761810303
Epoch: 15, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717097).  Saving model ...
Epoch: 16 cost time: 0.6969642639160156
Epoch: 16, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.829 Vali Acc: 0.724 Test Loss: 0.829 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723676).  Saving model ...
Epoch: 17 cost time: 0.8169584274291992
Epoch: 17, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.795 Vali Acc: 0.737 Test Loss: 0.795 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736834).  Saving model ...
Epoch: 18 cost time: 0.9879071712493896
Epoch: 18, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.772 Vali Acc: 0.743 Test Loss: 0.772 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 19 cost time: 0.6775891780853271
Epoch: 19, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.743 Vali Acc: 0.757 Test Loss: 0.743 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 0.9388508796691895
Epoch: 20, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782888).  Saving model ...
Epoch: 21 cost time: 0.9379105567932129
Epoch: 21, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 0.8370647430419922
Epoch: 22, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.674 Vali Acc: 0.816 Test Loss: 0.674 Test Acc: 0.816
Validation loss decreased (-0.782888 --> -0.815783).  Saving model ...
Epoch: 23 cost time: 0.6683478355407715
Epoch: 23, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 24 cost time: 0.6922168731689453
Epoch: 24, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8630268573760986
Epoch: 25, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 26 cost time: 0.9329507350921631
Epoch: 26, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7498657703399658
Epoch: 27, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.595 Vali Acc: 0.816 Test Loss: 0.595 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7326011657714844
Epoch: 28, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.591 Vali Acc: 0.836 Test Loss: 0.591 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 29 cost time: 0.7755253314971924
Epoch: 29, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.581 Vali Acc: 0.842 Test Loss: 0.581 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 30 cost time: 0.8087167739868164
Epoch: 30, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.565 Vali Acc: 0.836 Test Loss: 0.565 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7896547317504883
Epoch: 31, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.557 Vali Acc: 0.842 Test Loss: 0.557 Test Acc: 0.842
Validation loss decreased (-0.842099 --> -0.842100).  Saving model ...
Epoch: 32 cost time: 0.8873920440673828
Epoch: 32, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.553 Vali Acc: 0.836 Test Loss: 0.553 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.773993968963623
Epoch: 33, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.545 Vali Acc: 0.829 Test Loss: 0.545 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7854442596435547
Epoch: 34, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.537 Vali Acc: 0.829 Test Loss: 0.537 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8979055881500244
Epoch: 35, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.531 Vali Acc: 0.842 Test Loss: 0.531 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 36 cost time: 0.9226899147033691
Epoch: 36, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.521 Vali Acc: 0.842 Test Loss: 0.521 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 37 cost time: 0.9149439334869385
Epoch: 37, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.521 Vali Acc: 0.842 Test Loss: 0.521 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9101192951202393
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.515 Vali Acc: 0.836 Test Loss: 0.515 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8814897537231445
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.509 Vali Acc: 0.836 Test Loss: 0.509 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8297812938690186
Epoch: 40, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.502 Vali Acc: 0.836 Test Loss: 0.502 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7342031002044678
Epoch: 41, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.502 Vali Acc: 0.836 Test Loss: 0.502 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.929286003112793
Epoch: 42, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7401063442230225
Epoch: 43, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.493 Vali Acc: 0.836 Test Loss: 0.493 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7088069915771484
Epoch: 44, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.492 Vali Acc: 0.842 Test Loss: 0.492 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 45 cost time: 0.824852705001831
Epoch: 45, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.489 Vali Acc: 0.842 Test Loss: 0.489 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 46 cost time: 1.0555286407470703
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.490 Vali Acc: 0.842 Test Loss: 0.490 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6997783184051514
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.488 Vali Acc: 0.842 Test Loss: 0.488 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 48 cost time: 0.7507960796356201
Epoch: 48, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.485 Vali Acc: 0.842 Test Loss: 0.485 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 49 cost time: 0.7711806297302246
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.480 Vali Acc: 0.842 Test Loss: 0.480 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 50 cost time: 0.9397189617156982
Epoch: 50, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.480 Vali Acc: 0.849 Test Loss: 0.480 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848679).  Saving model ...
Epoch: 51 cost time: 0.7532777786254883
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.483 Vali Acc: 0.849 Test Loss: 0.483 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9894547462463379
Epoch: 52, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.482 Vali Acc: 0.842 Test Loss: 0.482 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8787946701049805
Epoch: 53, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.480 Vali Acc: 0.842 Test Loss: 0.480 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8354439735412598
Epoch: 54, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.480 Vali Acc: 0.849 Test Loss: 0.480 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7241952419281006
Epoch: 55, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.479 Vali Acc: 0.849 Test Loss: 0.479 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 56 cost time: 0.7165572643280029
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8692457675933838
Epoch: 57, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.478 Vali Acc: 0.842 Test Loss: 0.478 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9374384880065918
Epoch: 58, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.476 Vali Acc: 0.849 Test Loss: 0.476 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 59 cost time: 0.80548095703125
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8181860446929932
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.477 Vali Acc: 0.849 Test Loss: 0.477 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8310043811798096
Epoch: 61, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.476 Vali Acc: 0.849 Test Loss: 0.476 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 62 cost time: 0.885472297668457
Epoch: 62, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.476 Vali Acc: 0.849 Test Loss: 0.476 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 63 cost time: 0.9936859607696533
Epoch: 63, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.476 Vali Acc: 0.849 Test Loss: 0.476 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8209729194641113
Epoch: 64, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.478 Vali Acc: 0.849 Test Loss: 0.478 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7591938972473145
Epoch: 65, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.476 Vali Acc: 0.849 Test Loss: 0.476 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8745496273040771
Epoch: 66, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 67 cost time: 0.7974400520324707
Epoch: 67, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.849 Test Loss: 0.473 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 68 cost time: 0.655346155166626
Epoch: 68, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.473 Vali Acc: 0.849 Test Loss: 0.473 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 69 cost time: 0.7249050140380859
Epoch: 69, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9064834117889404
Epoch: 70, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.474 Vali Acc: 0.849 Test Loss: 0.474 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.774324893951416
Epoch: 71, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 72 cost time: 0.8145749568939209
Epoch: 72, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 73 cost time: 0.9673416614532471
Epoch: 73, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.474 Vali Acc: 0.849 Test Loss: 0.474 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7960896492004395
Epoch: 74, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8488032817840576
Epoch: 75, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.471 Vali Acc: 0.849 Test Loss: 0.471 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 76 cost time: 0.8928234577178955
Epoch: 76, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8122847080230713
Epoch: 77, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.473 Vali Acc: 0.849 Test Loss: 0.473 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8233587741851807
Epoch: 78, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.0326790809631348
Epoch: 79, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.6938443183898926
Epoch: 80, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.8408467769622803
Epoch: 81, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.476 Vali Acc: 0.849 Test Loss: 0.476 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.7310268878936768
Epoch: 82, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.477 Vali Acc: 0.849 Test Loss: 0.477 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.9804964065551758
Epoch: 83, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.474 Vali Acc: 0.849 Test Loss: 0.474 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.8012652397155762
Epoch: 84, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.9821624755859375
Epoch: 85, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.474 Vali Acc: 0.849 Test Loss: 0.474 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 64424
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2935025691986084
Epoch: 1, Steps: 10 | Train Loss: 1.544 Vali Loss: 1.455 Vali Acc: 0.303 Test Loss: 1.455 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 0.9796233177185059
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.404 Vali Acc: 0.349 Test Loss: 1.404 Test Acc: 0.349
Validation loss decreased (-0.302617 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 0.9521112442016602
Epoch: 3, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.345 Vali Acc: 0.447 Test Loss: 1.345 Test Acc: 0.447
Validation loss decreased (-0.348670 --> -0.447355).  Saving model ...
Epoch: 4 cost time: 0.9984307289123535
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.281 Vali Acc: 0.507 Test Loss: 1.281 Test Acc: 0.507
Validation loss decreased (-0.447355 --> -0.506566).  Saving model ...
Epoch: 5 cost time: 0.8803431987762451
Epoch: 5, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.221 Vali Acc: 0.533 Test Loss: 1.221 Test Acc: 0.533
Validation loss decreased (-0.506566 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 0.8899796009063721
Epoch: 6, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.159 Vali Acc: 0.553 Test Loss: 1.159 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 0.8513953685760498
Epoch: 7, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.105 Vali Acc: 0.592 Test Loss: 1.105 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 1.0774576663970947
Epoch: 8, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.052 Vali Acc: 0.618 Test Loss: 1.052 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618411).  Saving model ...
Epoch: 9 cost time: 0.7391364574432373
Epoch: 9, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.004 Vali Acc: 0.678 Test Loss: 1.004 Test Acc: 0.678
Validation loss decreased (-0.618411 --> -0.677622).  Saving model ...
Epoch: 10 cost time: 0.7756631374359131
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.962 Vali Acc: 0.678 Test Loss: 0.962 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677622).  Saving model ...
Epoch: 11 cost time: 0.820026159286499
Epoch: 11, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.923 Vali Acc: 0.691 Test Loss: 0.923 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 12 cost time: 0.8094508647918701
Epoch: 12, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.885 Vali Acc: 0.704 Test Loss: 0.885 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 13 cost time: 0.771759033203125
Epoch: 13, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.852 Vali Acc: 0.704 Test Loss: 0.852 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 14 cost time: 1.1582882404327393
Epoch: 14, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.822 Vali Acc: 0.730 Test Loss: 0.822 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 0.8481240272521973
Epoch: 15, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.796 Vali Acc: 0.743 Test Loss: 0.796 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 0.8836853504180908
Epoch: 16, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.773 Vali Acc: 0.770 Test Loss: 0.773 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769729).  Saving model ...
Epoch: 17 cost time: 0.8335511684417725
Epoch: 17, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.751 Vali Acc: 0.763 Test Loss: 0.751 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9978902339935303
Epoch: 18, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.729 Vali Acc: 0.770 Test Loss: 0.729 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769730).  Saving model ...
Epoch: 19 cost time: 1.187126636505127
Epoch: 19, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.711 Vali Acc: 0.770 Test Loss: 0.711 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 20 cost time: 0.9317624568939209
Epoch: 20, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0480644702911377
Epoch: 21, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.681 Vali Acc: 0.770 Test Loss: 0.681 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 22 cost time: 0.9354760646820068
Epoch: 22, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2247753143310547
Epoch: 23, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 24 cost time: 1.022789716720581
Epoch: 24, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 0.9362728595733643
Epoch: 25, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.211789846420288
Epoch: 26, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 0.8108096122741699
Epoch: 27, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 0.8883054256439209
Epoch: 28, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 29 cost time: 1.083564281463623
Epoch: 29, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 1.0242509841918945
Epoch: 30, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9591689109802246
Epoch: 31, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 0.7245631217956543
Epoch: 32, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 0.7756960391998291
Epoch: 33, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 0.8141791820526123
Epoch: 34, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 0.8170051574707031
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 1.1787002086639404
Epoch: 36, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 37 cost time: 0.8043034076690674
Epoch: 37, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0555574893951416
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.228919267654419
Epoch: 39, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8879404067993164
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8871152400970459
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 42 cost time: 0.8908874988555908
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8737995624542236
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8879895210266113
Epoch: 44, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.89750075340271
Epoch: 45, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9510693550109863
Epoch: 46, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0705673694610596
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8552439212799072
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7543282508850098
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.702650785446167
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8758189678192139
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 63400
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7174642086029053
Epoch: 1, Steps: 10 | Train Loss: 1.544 Vali Loss: 1.455 Vali Acc: 0.303 Test Loss: 1.455 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.165832757949829
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.404 Vali Acc: 0.349 Test Loss: 1.404 Test Acc: 0.349
Validation loss decreased (-0.302617 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 0.7238368988037109
Epoch: 3, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.345 Vali Acc: 0.447 Test Loss: 1.345 Test Acc: 0.447
Validation loss decreased (-0.348670 --> -0.447355).  Saving model ...
Epoch: 4 cost time: 0.7368769645690918
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.281 Vali Acc: 0.507 Test Loss: 1.281 Test Acc: 0.507
Validation loss decreased (-0.447355 --> -0.506566).  Saving model ...
Epoch: 5 cost time: 0.8346233367919922
Epoch: 5, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.221 Vali Acc: 0.533 Test Loss: 1.221 Test Acc: 0.533
Validation loss decreased (-0.506566 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 0.8233861923217773
Epoch: 6, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.159 Vali Acc: 0.553 Test Loss: 1.159 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 0.904716968536377
Epoch: 7, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.105 Vali Acc: 0.592 Test Loss: 1.105 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 0.9062309265136719
Epoch: 8, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.052 Vali Acc: 0.618 Test Loss: 1.052 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618411).  Saving model ...
Epoch: 9 cost time: 0.8688771724700928
Epoch: 9, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.004 Vali Acc: 0.678 Test Loss: 1.004 Test Acc: 0.678
Validation loss decreased (-0.618411 --> -0.677622).  Saving model ...
Epoch: 10 cost time: 0.9380326271057129
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.962 Vali Acc: 0.678 Test Loss: 0.962 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677622).  Saving model ...
Epoch: 11 cost time: 0.8123140335083008
Epoch: 11, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.923 Vali Acc: 0.691 Test Loss: 0.923 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 12 cost time: 0.7337081432342529
Epoch: 12, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.885 Vali Acc: 0.704 Test Loss: 0.885 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 13 cost time: 0.8870866298675537
Epoch: 13, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.852 Vali Acc: 0.704 Test Loss: 0.852 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 14 cost time: 0.9332337379455566
Epoch: 14, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.822 Vali Acc: 0.730 Test Loss: 0.822 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 1.0948429107666016
Epoch: 15, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.796 Vali Acc: 0.743 Test Loss: 0.796 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 0.9997546672821045
Epoch: 16, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.773 Vali Acc: 0.770 Test Loss: 0.773 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769729).  Saving model ...
Epoch: 17 cost time: 0.9710617065429688
Epoch: 17, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.751 Vali Acc: 0.763 Test Loss: 0.751 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8691596984863281
Epoch: 18, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.729 Vali Acc: 0.770 Test Loss: 0.729 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769730).  Saving model ...
Epoch: 19 cost time: 1.0689098834991455
Epoch: 19, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.711 Vali Acc: 0.770 Test Loss: 0.711 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 20 cost time: 0.8784534931182861
Epoch: 20, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8371121883392334
Epoch: 21, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.681 Vali Acc: 0.770 Test Loss: 0.681 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 22 cost time: 0.9286613464355469
Epoch: 22, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.772996187210083
Epoch: 23, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 24 cost time: 0.9540512561798096
Epoch: 24, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 0.8679325580596924
Epoch: 25, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.003161907196045
Epoch: 26, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 0.8929452896118164
Epoch: 27, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.0645074844360352
Epoch: 28, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 29 cost time: 0.8280720710754395
Epoch: 29, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 0.8498859405517578
Epoch: 30, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.905886173248291
Epoch: 31, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 0.7997875213623047
Epoch: 32, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 33 cost time: 0.9255959987640381
Epoch: 33, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 0.9286439418792725
Epoch: 34, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 1.0386452674865723
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 36 cost time: 1.1403191089630127
Epoch: 36, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 37 cost time: 0.8333258628845215
Epoch: 37, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.929318904876709
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0264875888824463
Epoch: 39, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1313059329986572
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1232869625091553
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 42 cost time: 0.9615511894226074
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1421992778778076
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7956957817077637
Epoch: 44, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8370566368103027
Epoch: 45, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8954758644104004
Epoch: 46, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.012455701828003
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0048980712890625
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9384438991546631
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0124776363372803
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8747973442077637
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 63400
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8816447257995605
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.361 Vali Acc: 0.289 Test Loss: 1.361 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.9310266971588135
Epoch: 2, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.315 Vali Acc: 0.329 Test Loss: 1.315 Test Acc: 0.329
Validation loss decreased (-0.289460 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.0514647960662842
Epoch: 3, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.261 Vali Acc: 0.441 Test Loss: 1.261 Test Acc: 0.441
Validation loss decreased (-0.328934 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 1.0748176574707031
Epoch: 4, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.208 Vali Acc: 0.487 Test Loss: 1.208 Test Acc: 0.487
Validation loss decreased (-0.440777 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 0.8650293350219727
Epoch: 5, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.156 Vali Acc: 0.572 Test Loss: 1.156 Test Acc: 0.572
Validation loss decreased (-0.486830 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.2887156009674072
Epoch: 6, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.112 Vali Acc: 0.599 Test Loss: 1.112 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.1298999786376953
Epoch: 7, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.070 Vali Acc: 0.632 Test Loss: 1.070 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631568).  Saving model ...
Epoch: 8 cost time: 0.9784595966339111
Epoch: 8, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.030 Vali Acc: 0.671 Test Loss: 1.030 Test Acc: 0.671
Validation loss decreased (-0.631568 --> -0.671042).  Saving model ...
Epoch: 9 cost time: 1.0217788219451904
Epoch: 9, Steps: 10 | Train Loss: 0.933 Vali Loss: 0.994 Vali Acc: 0.678 Test Loss: 0.994 Test Acc: 0.678
Validation loss decreased (-0.671042 --> -0.677622).  Saving model ...
Epoch: 10 cost time: 1.1479377746582031
Epoch: 10, Steps: 10 | Train Loss: 0.888 Vali Loss: 0.960 Vali Acc: 0.697 Test Loss: 0.960 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 0.863666296005249
Epoch: 11, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.929 Vali Acc: 0.724 Test Loss: 0.929 Test Acc: 0.724
Validation loss decreased (-0.697359 --> -0.723675).  Saving model ...
Epoch: 12 cost time: 0.8685605525970459
Epoch: 12, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.896 Vali Acc: 0.743 Test Loss: 0.896 Test Acc: 0.743
Validation loss decreased (-0.723675 --> -0.743412).  Saving model ...
Epoch: 13 cost time: 1.116913080215454
Epoch: 13, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.863 Vali Acc: 0.757 Test Loss: 0.863 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756570).  Saving model ...
Epoch: 14 cost time: 1.061448335647583
Epoch: 14, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.832 Vali Acc: 0.770 Test Loss: 0.832 Test Acc: 0.770
Validation loss decreased (-0.756570 --> -0.769729).  Saving model ...
Epoch: 15 cost time: 0.9745845794677734
Epoch: 15, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.799 Vali Acc: 0.796 Test Loss: 0.799 Test Acc: 0.796
Validation loss decreased (-0.769729 --> -0.796045).  Saving model ...
Epoch: 16 cost time: 1.0905859470367432
Epoch: 16, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.772 Vali Acc: 0.783 Test Loss: 0.772 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9504525661468506
Epoch: 17, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9942774772644043
Epoch: 18, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796045).  Saving model ...
Epoch: 19 cost time: 0.8389661312103271
Epoch: 19, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.697 Vali Acc: 0.796 Test Loss: 0.697 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796046).  Saving model ...
Epoch: 20 cost time: 1.0816266536712646
Epoch: 20, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 1.2108964920043945
Epoch: 21, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.650 Vali Acc: 0.816 Test Loss: 0.650 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 22 cost time: 0.9072976112365723
Epoch: 22, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 23 cost time: 0.9464340209960938
Epoch: 23, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822362).  Saving model ...
Epoch: 24 cost time: 1.3111567497253418
Epoch: 24, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.606 Vali Acc: 0.836 Test Loss: 0.606 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 25 cost time: 0.9574673175811768
Epoch: 25, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.582 Vali Acc: 0.842 Test Loss: 0.582 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 26 cost time: 0.8876187801361084
Epoch: 26, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.561 Vali Acc: 0.842 Test Loss: 0.561 Test Acc: 0.842
Validation loss decreased (-0.842099 --> -0.842100).  Saving model ...
Epoch: 27 cost time: 1.102036952972412
Epoch: 27, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.550 Vali Acc: 0.842 Test Loss: 0.550 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 28 cost time: 0.9425842761993408
Epoch: 28, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.547 Vali Acc: 0.842 Test Loss: 0.547 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 29 cost time: 1.0173225402832031
Epoch: 29, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855258).  Saving model ...
Epoch: 30 cost time: 1.1110928058624268
Epoch: 30, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.520 Vali Acc: 0.849 Test Loss: 0.520 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1839427947998047
Epoch: 31, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.513 Vali Acc: 0.849 Test Loss: 0.513 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1830430030822754
Epoch: 32, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861837).  Saving model ...
Epoch: 33 cost time: 1.2477734088897705
Epoch: 33, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1433556079864502
Epoch: 34, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.496 Vali Acc: 0.842 Test Loss: 0.496 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9846994876861572
Epoch: 35, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 36 cost time: 1.1360783576965332
Epoch: 36, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 37 cost time: 1.1645188331604004
Epoch: 37, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.480 Vali Acc: 0.868 Test Loss: 0.480 Test Acc: 0.868
Validation loss decreased (-0.861837 --> -0.868416).  Saving model ...
Epoch: 38 cost time: 1.2147226333618164
Epoch: 38, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7771694660186768
Epoch: 39, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.473 Vali Acc: 0.842 Test Loss: 0.473 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0263891220092773
Epoch: 40, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1377696990966797
Epoch: 41, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.468 Vali Acc: 0.842 Test Loss: 0.468 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0434041023254395
Epoch: 42, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.469 Vali Acc: 0.849 Test Loss: 0.469 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2883110046386719
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.467 Vali Acc: 0.842 Test Loss: 0.467 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1055843830108643
Epoch: 44, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.469 Vali Acc: 0.849 Test Loss: 0.469 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0104038715362549
Epoch: 45, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.472 Vali Acc: 0.842 Test Loss: 0.472 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1191210746765137
Epoch: 46, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.470 Vali Acc: 0.842 Test Loss: 0.470 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.087655782699585
Epoch: 47, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.460 Vali Acc: 0.836 Test Loss: 0.460 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 66420
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.880115032196045
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.387 Vali Acc: 0.322 Test Loss: 1.387 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 0.9682056903839111
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.349 Vali Acc: 0.355 Test Loss: 1.349 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 0.7722821235656738
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.301 Vali Acc: 0.414 Test Loss: 1.301 Test Acc: 0.414
Validation loss decreased (-0.355250 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 0.9300305843353271
Epoch: 4, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.248 Vali Acc: 0.487 Test Loss: 1.248 Test Acc: 0.487
Validation loss decreased (-0.414461 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.0691492557525635
Epoch: 5, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.197 Vali Acc: 0.526 Test Loss: 1.197 Test Acc: 0.526
Validation loss decreased (-0.486830 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 0.813744068145752
Epoch: 6, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.149 Vali Acc: 0.579 Test Loss: 1.149 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.1070852279663086
Epoch: 7, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.109 Vali Acc: 0.579 Test Loss: 1.109 Test Acc: 0.579
Validation loss decreased (-0.578936 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 0.8880050182342529
Epoch: 8, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
Validation loss decreased (-0.578936 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.9668598175048828
Epoch: 9, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.036 Vali Acc: 0.664 Test Loss: 1.036 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 0.9401829242706299
Epoch: 10, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.003 Vali Acc: 0.704 Test Loss: 1.003 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703937).  Saving model ...
Epoch: 11 cost time: 1.0833537578582764
Epoch: 11, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.971 Vali Acc: 0.697 Test Loss: 0.971 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1034796237945557
Epoch: 12, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.940 Vali Acc: 0.717 Test Loss: 0.940 Test Acc: 0.717
Validation loss decreased (-0.703937 --> -0.717096).  Saving model ...
Epoch: 13 cost time: 0.9378483295440674
Epoch: 13, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.912 Vali Acc: 0.724 Test Loss: 0.912 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 14 cost time: 1.011091709136963
Epoch: 14, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.883 Vali Acc: 0.737 Test Loss: 0.883 Test Acc: 0.737
Validation loss decreased (-0.723675 --> -0.736833).  Saving model ...
Epoch: 15 cost time: 1.194319486618042
Epoch: 15, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.858 Vali Acc: 0.743 Test Loss: 0.858 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743412).  Saving model ...
Epoch: 16 cost time: 0.8318080902099609
Epoch: 16, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.743412 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 0.9898395538330078
Epoch: 17, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.805 Vali Acc: 0.743 Test Loss: 0.805 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0787012577056885
Epoch: 18, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.060356616973877
Epoch: 19, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 20 cost time: 0.8490078449249268
Epoch: 20, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.732 Vali Acc: 0.763 Test Loss: 0.732 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 1.0766661167144775
Epoch: 21, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.710 Vali Acc: 0.750 Test Loss: 0.710 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9781756401062012
Epoch: 22, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.692 Vali Acc: 0.757 Test Loss: 0.692 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1032214164733887
Epoch: 23, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 0.9936227798461914
Epoch: 24, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.647 Vali Acc: 0.770 Test Loss: 0.647 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 0.9876577854156494
Epoch: 25, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 26 cost time: 0.9980661869049072
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 27 cost time: 1.1035172939300537
Epoch: 27, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
Validation loss decreased (-0.802625 --> -0.822362).  Saving model ...
Epoch: 28 cost time: 1.2182948589324951
Epoch: 28, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.596 Vali Acc: 0.829 Test Loss: 0.596 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 29 cost time: 1.2559850215911865
Epoch: 29, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0823414325714111
Epoch: 30, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.573 Vali Acc: 0.842 Test Loss: 0.573 Test Acc: 0.842
Validation loss decreased (-0.828941 --> -0.842100).  Saving model ...
Epoch: 31 cost time: 1.0620336532592773
Epoch: 31, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.561 Vali Acc: 0.842 Test Loss: 0.561 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 32 cost time: 0.9186174869537354
Epoch: 32, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.555 Vali Acc: 0.836 Test Loss: 0.555 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1870300769805908
Epoch: 33, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1520252227783203
Epoch: 34, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.552 Vali Acc: 0.829 Test Loss: 0.552 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8829586505889893
Epoch: 35, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.162696361541748
Epoch: 36, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1598036289215088
Epoch: 37, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.532 Vali Acc: 0.829 Test Loss: 0.532 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0707008838653564
Epoch: 38, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9744441509246826
Epoch: 39, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9949591159820557
Epoch: 40, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0736732482910156
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 65396
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4062936305999756
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.370 Vali Acc: 0.316 Test Loss: 1.370 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.9118189811706543
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.340 Vali Acc: 0.349 Test Loss: 1.340 Test Acc: 0.349
Validation loss decreased (-0.315776 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.8221075534820557
Epoch: 3, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.302 Vali Acc: 0.395 Test Loss: 1.302 Test Acc: 0.395
Validation loss decreased (-0.348671 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 0.7351248264312744
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.261 Vali Acc: 0.480 Test Loss: 1.261 Test Acc: 0.480
Validation loss decreased (-0.394724 --> -0.480251).  Saving model ...
Epoch: 5 cost time: 0.899033784866333
Epoch: 5, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.215 Vali Acc: 0.520 Test Loss: 1.215 Test Acc: 0.520
Validation loss decreased (-0.480251 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 0.7839779853820801
Epoch: 6, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.173 Vali Acc: 0.605 Test Loss: 1.173 Test Acc: 0.605
Validation loss decreased (-0.519725 --> -0.605251).  Saving model ...
Epoch: 7 cost time: 0.8302412033081055
Epoch: 7, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.126 Vali Acc: 0.651 Test Loss: 1.126 Test Acc: 0.651
Validation loss decreased (-0.605251 --> -0.651305).  Saving model ...
Epoch: 8 cost time: 1.2399754524230957
Epoch: 8, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.081 Vali Acc: 0.697 Test Loss: 1.081 Test Acc: 0.697
Validation loss decreased (-0.651305 --> -0.697358).  Saving model ...
Epoch: 9 cost time: 0.9541780948638916
Epoch: 9, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.038 Vali Acc: 0.711 Test Loss: 1.038 Test Acc: 0.711
Validation loss decreased (-0.697358 --> -0.710516).  Saving model ...
Epoch: 10 cost time: 1.311326026916504
Epoch: 10, Steps: 10 | Train Loss: 0.881 Vali Loss: 0.998 Vali Acc: 0.711 Test Loss: 0.998 Test Acc: 0.711
Validation loss decreased (-0.710516 --> -0.710516).  Saving model ...
Epoch: 11 cost time: 1.0221590995788574
Epoch: 11, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.958 Vali Acc: 0.724 Test Loss: 0.958 Test Acc: 0.724
Validation loss decreased (-0.710516 --> -0.723675).  Saving model ...
Epoch: 12 cost time: 0.8880114555358887
Epoch: 12, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.920 Vali Acc: 0.743 Test Loss: 0.920 Test Acc: 0.743
Validation loss decreased (-0.723675 --> -0.743412).  Saving model ...
Epoch: 13 cost time: 1.107957363128662
Epoch: 13, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.886 Vali Acc: 0.737 Test Loss: 0.886 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.129328727722168
Epoch: 14, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.858 Vali Acc: 0.730 Test Loss: 0.858 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8994576930999756
Epoch: 15, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.828 Vali Acc: 0.757 Test Loss: 0.828 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756571).  Saving model ...
Epoch: 16 cost time: 0.9735574722290039
Epoch: 16, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.794 Vali Acc: 0.770 Test Loss: 0.794 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 17 cost time: 0.9518845081329346
Epoch: 17, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.767 Vali Acc: 0.789 Test Loss: 0.767 Test Acc: 0.789
Validation loss decreased (-0.769729 --> -0.789466).  Saving model ...
Epoch: 18 cost time: 1.3214218616485596
Epoch: 18, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9997272491455078
Epoch: 19, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802624).  Saving model ...
Epoch: 20 cost time: 0.9792752265930176
Epoch: 20, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.692 Vali Acc: 0.796 Test Loss: 0.692 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8820984363555908
Epoch: 21, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.678 Vali Acc: 0.796 Test Loss: 0.678 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3406438827514648
Epoch: 22, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.654 Vali Acc: 0.796 Test Loss: 0.654 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.974435567855835
Epoch: 23, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.630 Vali Acc: 0.829 Test Loss: 0.630 Test Acc: 0.829
Validation loss decreased (-0.802624 --> -0.828941).  Saving model ...
Epoch: 24 cost time: 0.8453404903411865
Epoch: 24, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2208218574523926
Epoch: 25, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7979121208190918
Epoch: 26, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9266283512115479
Epoch: 27, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2376420497894287
Epoch: 28, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1262969970703125
Epoch: 29, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9530906677246094
Epoch: 30, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.153426170349121
Epoch: 31, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2186260223388672
Epoch: 32, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1316540241241455
Epoch: 33, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 64372
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.813232898712158
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.386 Vali Acc: 0.296 Test Loss: 1.386 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.9555978775024414
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.348 Vali Acc: 0.309 Test Loss: 1.348 Test Acc: 0.309
Validation loss decreased (-0.296039 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.6713471412658691
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.298 Vali Acc: 0.388 Test Loss: 1.298 Test Acc: 0.388
Validation loss decreased (-0.309197 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 0.6777961254119873
Epoch: 4, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.245 Vali Acc: 0.421 Test Loss: 1.245 Test Acc: 0.421
Validation loss decreased (-0.388145 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 0.7902653217315674
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.190 Vali Acc: 0.507 Test Loss: 1.190 Test Acc: 0.507
Validation loss decreased (-0.421040 --> -0.506567).  Saving model ...
Epoch: 6 cost time: 0.7096037864685059
Epoch: 6, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.136 Vali Acc: 0.539 Test Loss: 1.136 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 0.9260222911834717
Epoch: 7, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.086 Vali Acc: 0.579 Test Loss: 1.086 Test Acc: 0.579
Validation loss decreased (-0.539462 --> -0.578937).  Saving model ...
Epoch: 8 cost time: 0.8373074531555176
Epoch: 8, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.039 Vali Acc: 0.645 Test Loss: 1.039 Test Acc: 0.645
Validation loss decreased (-0.578937 --> -0.644726).  Saving model ...
Epoch: 9 cost time: 0.7378880977630615
Epoch: 9, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.996 Vali Acc: 0.664 Test Loss: 0.996 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 1.0332386493682861
Epoch: 10, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.956 Vali Acc: 0.697 Test Loss: 0.956 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 0.7180688381195068
Epoch: 11, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.917 Vali Acc: 0.704 Test Loss: 0.917 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 12 cost time: 0.7213547229766846
Epoch: 12, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.882 Vali Acc: 0.724 Test Loss: 0.882 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723675).  Saving model ...
Epoch: 13 cost time: 0.890516996383667
Epoch: 13, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.846 Vali Acc: 0.743 Test Loss: 0.846 Test Acc: 0.743
Validation loss decreased (-0.723675 --> -0.743413).  Saving model ...
Epoch: 14 cost time: 0.8191282749176025
Epoch: 14, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.813 Vali Acc: 0.743 Test Loss: 0.813 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743413).  Saving model ...
Epoch: 15 cost time: 0.7877137660980225
Epoch: 15, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.783 Vali Acc: 0.757 Test Loss: 0.783 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756571).  Saving model ...
Epoch: 16 cost time: 0.6874814033508301
Epoch: 16, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.750 Vali Acc: 0.763 Test Loss: 0.750 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 17 cost time: 0.7164449691772461
Epoch: 17, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782887).  Saving model ...
Epoch: 18 cost time: 0.826019287109375
Epoch: 18, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 19 cost time: 0.8508033752441406
Epoch: 19, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.081820011138916
Epoch: 20, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7019968032836914
Epoch: 21, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 0.6514852046966553
Epoch: 22, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809204).  Saving model ...
Epoch: 23 cost time: 0.7454259395599365
Epoch: 23, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809205).  Saving model ...
Epoch: 24 cost time: 0.7977697849273682
Epoch: 24, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8316738605499268
Epoch: 25, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7203123569488525
Epoch: 26, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7897775173187256
Epoch: 27, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7269241809844971
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 0.8482003211975098
Epoch: 29, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9300239086151123
Epoch: 30, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 0.7984342575073242
Epoch: 31, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 32 cost time: 0.8081166744232178
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.682119607925415
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8494124412536621
Epoch: 34, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 35 cost time: 0.8849160671234131
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 0.7234857082366943
Epoch: 36, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8632955551147461
Epoch: 37, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8901281356811523
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 39 cost time: 0.8438365459442139
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.488 Vali Acc: 0.836 Test Loss: 0.488 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 40 cost time: 0.965609073638916
Epoch: 40, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7132217884063721
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0743515491485596
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7737457752227783
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.881126880645752
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9373323917388916
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8260018825531006
Epoch: 46, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7581753730773926
Epoch: 47, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7221317291259766
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.715174674987793
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 63348
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1461448669433594
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.386 Vali Acc: 0.296 Test Loss: 1.386 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.7795815467834473
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.348 Vali Acc: 0.309 Test Loss: 1.348 Test Acc: 0.309
Validation loss decreased (-0.296039 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.9430263042449951
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.298 Vali Acc: 0.388 Test Loss: 1.298 Test Acc: 0.388
Validation loss decreased (-0.309197 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 0.9191913604736328
Epoch: 4, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.245 Vali Acc: 0.421 Test Loss: 1.245 Test Acc: 0.421
Validation loss decreased (-0.388145 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 0.833174467086792
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.190 Vali Acc: 0.507 Test Loss: 1.190 Test Acc: 0.507
Validation loss decreased (-0.421040 --> -0.506567).  Saving model ...
Epoch: 6 cost time: 0.8568921089172363
Epoch: 6, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.136 Vali Acc: 0.539 Test Loss: 1.136 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 0.8708927631378174
Epoch: 7, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.086 Vali Acc: 0.579 Test Loss: 1.086 Test Acc: 0.579
Validation loss decreased (-0.539462 --> -0.578937).  Saving model ...
Epoch: 8 cost time: 1.1505968570709229
Epoch: 8, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.039 Vali Acc: 0.645 Test Loss: 1.039 Test Acc: 0.645
Validation loss decreased (-0.578937 --> -0.644726).  Saving model ...
Epoch: 9 cost time: 0.834240198135376
Epoch: 9, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.996 Vali Acc: 0.664 Test Loss: 0.996 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 0.7802298069000244
Epoch: 10, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.956 Vali Acc: 0.697 Test Loss: 0.956 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 1.1440308094024658
Epoch: 11, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.917 Vali Acc: 0.704 Test Loss: 0.917 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 12 cost time: 0.7625861167907715
Epoch: 12, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.882 Vali Acc: 0.724 Test Loss: 0.882 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723675).  Saving model ...
Epoch: 13 cost time: 0.9470746517181396
Epoch: 13, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.846 Vali Acc: 0.743 Test Loss: 0.846 Test Acc: 0.743
Validation loss decreased (-0.723675 --> -0.743413).  Saving model ...
Epoch: 14 cost time: 0.8380250930786133
Epoch: 14, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.813 Vali Acc: 0.743 Test Loss: 0.813 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743413).  Saving model ...
Epoch: 15 cost time: 0.8405332565307617
Epoch: 15, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.783 Vali Acc: 0.757 Test Loss: 0.783 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756571).  Saving model ...
Epoch: 16 cost time: 0.906928539276123
Epoch: 16, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.750 Vali Acc: 0.763 Test Loss: 0.750 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 17 cost time: 1.0242328643798828
Epoch: 17, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782887).  Saving model ...
Epoch: 18 cost time: 1.0661630630493164
Epoch: 18, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 19 cost time: 0.8759605884552002
Epoch: 19, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.901024580001831
Epoch: 20, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9878125190734863
Epoch: 21, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 0.9669089317321777
Epoch: 22, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809204).  Saving model ...
Epoch: 23 cost time: 0.9186625480651855
Epoch: 23, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809205).  Saving model ...
Epoch: 24 cost time: 1.0009613037109375
Epoch: 24, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0459973812103271
Epoch: 25, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.00248122215271
Epoch: 26, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8438236713409424
Epoch: 27, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9409849643707275
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 29 cost time: 0.8353643417358398
Epoch: 29, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9302077293395996
Epoch: 30, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 0.7957541942596436
Epoch: 31, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 32 cost time: 0.6578593254089355
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8835806846618652
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9083600044250488
Epoch: 34, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 35 cost time: 0.7944073677062988
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 0.9614720344543457
Epoch: 36, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8122541904449463
Epoch: 37, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8219425678253174
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 39 cost time: 0.7932660579681396
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.488 Vali Acc: 0.836 Test Loss: 0.488 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 40 cost time: 0.7037191390991211
Epoch: 40, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7472386360168457
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7067265510559082
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.767486572265625
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.480 Vali Acc: 0.816 Test Loss: 0.480 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7342462539672852
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8634388446807861
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8322219848632812
Epoch: 46, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.148634672164917
Epoch: 47, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8149359226226807
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7650601863861084
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 63348
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.610255479812622
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.389 Vali Acc: 0.289 Test Loss: 1.389 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.9348030090332031
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.327 Vali Acc: 0.336 Test Loss: 1.327 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.9266133308410645
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.255 Vali Acc: 0.414 Test Loss: 1.255 Test Acc: 0.414
Validation loss decreased (-0.335513 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.166020154953003
Epoch: 4, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.198 Vali Acc: 0.513 Test Loss: 1.198 Test Acc: 0.513
Validation loss decreased (-0.414461 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 0.7985994815826416
Epoch: 5, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.155 Vali Acc: 0.559 Test Loss: 1.155 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 0.9611778259277344
Epoch: 6, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.114 Vali Acc: 0.599 Test Loss: 1.114 Test Acc: 0.599
Validation loss decreased (-0.559199 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.0320396423339844
Epoch: 7, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.075 Vali Acc: 0.658 Test Loss: 1.075 Test Acc: 0.658
Validation loss decreased (-0.598673 --> -0.657884).  Saving model ...
Epoch: 8 cost time: 1.0666096210479736
Epoch: 8, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.029 Vali Acc: 0.671 Test Loss: 1.029 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671042).  Saving model ...
Epoch: 9 cost time: 1.1181206703186035
Epoch: 9, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.988 Vali Acc: 0.724 Test Loss: 0.988 Test Acc: 0.724
Validation loss decreased (-0.671042 --> -0.723674).  Saving model ...
Epoch: 10 cost time: 0.8048000335693359
Epoch: 10, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.969 Vali Acc: 0.724 Test Loss: 0.969 Test Acc: 0.724
Validation loss decreased (-0.723674 --> -0.723675).  Saving model ...
Epoch: 11 cost time: 0.880786657333374
Epoch: 11, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.937 Vali Acc: 0.763 Test Loss: 0.937 Test Acc: 0.763
Validation loss decreased (-0.723675 --> -0.763149).  Saving model ...
Epoch: 12 cost time: 0.982978343963623
Epoch: 12, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.908 Vali Acc: 0.770 Test Loss: 0.908 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769728).  Saving model ...
Epoch: 13 cost time: 0.8672935962677002
Epoch: 13, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.904 Vali Acc: 0.737 Test Loss: 0.904 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9135158061981201
Epoch: 14, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.856 Vali Acc: 0.776 Test Loss: 0.856 Test Acc: 0.776
Validation loss decreased (-0.769728 --> -0.776307).  Saving model ...
Epoch: 15 cost time: 0.9620361328125
Epoch: 15, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.852 Vali Acc: 0.763 Test Loss: 0.852 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9789838790893555
Epoch: 16, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.827 Vali Acc: 0.757 Test Loss: 0.827 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9321777820587158
Epoch: 17, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.806 Vali Acc: 0.757 Test Loss: 0.806 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.034040927886963
Epoch: 18, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0669238567352295
Epoch: 19, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.767 Vali Acc: 0.743 Test Loss: 0.767 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.023421287536621
Epoch: 20, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.767 Vali Acc: 0.743 Test Loss: 0.767 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.853562593460083
Epoch: 21, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.736 Vali Acc: 0.763 Test Loss: 0.736 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9230194091796875
Epoch: 22, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.936474084854126
Epoch: 23, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.714 Vali Acc: 0.757 Test Loss: 0.714 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8951225280761719
Epoch: 24, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
Validation loss decreased (-0.776307 --> -0.789467).  Saving model ...
Epoch: 25 cost time: 1.141254186630249
Epoch: 25, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.706 Vali Acc: 0.697 Test Loss: 0.706 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9256806373596191
Epoch: 26, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 27 cost time: 0.8727343082427979
Epoch: 27, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7871139049530029
Epoch: 28, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.670 Vali Acc: 0.763 Test Loss: 0.670 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1249573230743408
Epoch: 29, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.94289231300354
Epoch: 30, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.651 Vali Acc: 0.743 Test Loss: 0.651 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1758403778076172
Epoch: 31, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.640 Vali Acc: 0.776 Test Loss: 0.640 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0918898582458496
Epoch: 32, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.098679542541504
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0833673477172852
Epoch: 34, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0552630424499512
Epoch: 35, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2288544178009033
Epoch: 36, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 66356
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0641772747039795
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.355 Vali Acc: 0.283 Test Loss: 1.355 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.0771708488464355
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.282 Vali Acc: 0.362 Test Loss: 1.282 Test Acc: 0.362
Validation loss decreased (-0.282881 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.0217978954315186
Epoch: 3, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
Validation loss decreased (-0.361829 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.0097129344940186
Epoch: 4, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.097 Vali Acc: 0.586 Test Loss: 1.097 Test Acc: 0.586
Validation loss decreased (-0.467093 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 0.8192598819732666
Epoch: 5, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.025 Vali Acc: 0.684 Test Loss: 1.025 Test Acc: 0.684
Validation loss decreased (-0.585515 --> -0.684200).  Saving model ...
Epoch: 6 cost time: 0.9908113479614258
Epoch: 6, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.965 Vali Acc: 0.724 Test Loss: 0.965 Test Acc: 0.724
Validation loss decreased (-0.684200 --> -0.723675).  Saving model ...
Epoch: 7 cost time: 1.0503456592559814
Epoch: 7, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.983729362487793
Epoch: 8, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.723675 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.0445489883422852
Epoch: 9, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.843 Vali Acc: 0.763 Test Loss: 0.843 Test Acc: 0.763
Validation loss decreased (-0.749991 --> -0.763149).  Saving model ...
Epoch: 10 cost time: 1.2673566341400146
Epoch: 10, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.815 Vali Acc: 0.743 Test Loss: 0.815 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8439862728118896
Epoch: 11, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.788 Vali Acc: 0.757 Test Loss: 0.788 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0132026672363281
Epoch: 12, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.768 Vali Acc: 0.757 Test Loss: 0.768 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0592706203460693
Epoch: 13, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.740 Vali Acc: 0.757 Test Loss: 0.740 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0631439685821533
Epoch: 14, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8755700588226318
Epoch: 15, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.697 Vali Acc: 0.776 Test Loss: 0.697 Test Acc: 0.776
Validation loss decreased (-0.763149 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 1.1115531921386719
Epoch: 16, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.683 Vali Acc: 0.757 Test Loss: 0.683 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8471503257751465
Epoch: 17, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.678 Vali Acc: 0.763 Test Loss: 0.678 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.026221752166748
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1825191974639893
Epoch: 19, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 0.9059545993804932
Epoch: 20, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 21 cost time: 0.903688907623291
Epoch: 21, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0182991027832031
Epoch: 22, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8969459533691406
Epoch: 23, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 24 cost time: 0.9559764862060547
Epoch: 24, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 1.081561803817749
Epoch: 25, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 0.7890048027038574
Epoch: 26, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.602 Vali Acc: 0.776 Test Loss: 0.602 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7875101566314697
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 0.8957319259643555
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.595 Vali Acc: 0.776 Test Loss: 0.595 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8274812698364258
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8804628849029541
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1399874687194824
Epoch: 31, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8349096775054932
Epoch: 32, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 33 cost time: 1.0273239612579346
Epoch: 33, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9284839630126953
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 35 cost time: 0.8053510189056396
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.010688066482544
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9505679607391357
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9158263206481934
Epoch: 38, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9128303527832031
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7597427368164062
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8608946800231934
Epoch: 41, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9186463356018066
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.849684476852417
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0161778926849365
Epoch: 44, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 65332
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.95640230178833
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.375 Vali Acc: 0.322 Test Loss: 1.375 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 0.8448905944824219
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.299 Vali Acc: 0.388 Test Loss: 1.299 Test Acc: 0.388
Validation loss decreased (-0.322355 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 0.7674310207366943
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
Validation loss decreased (-0.388145 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 0.963158130645752
Epoch: 4, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.124 Vali Acc: 0.526 Test Loss: 1.124 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526305).  Saving model ...
Epoch: 5 cost time: 0.6791517734527588
Epoch: 5, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.040 Vali Acc: 0.572 Test Loss: 1.040 Test Acc: 0.572
Validation loss decreased (-0.526305 --> -0.572358).  Saving model ...
Epoch: 6 cost time: 0.6872358322143555
Epoch: 6, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.979 Vali Acc: 0.632 Test Loss: 0.979 Test Acc: 0.632
Validation loss decreased (-0.572358 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 0.6718378067016602
Epoch: 7, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.923 Vali Acc: 0.664 Test Loss: 0.923 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 0.805595874786377
Epoch: 8, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.876 Vali Acc: 0.724 Test Loss: 0.876 Test Acc: 0.724
Validation loss decreased (-0.664464 --> -0.723675).  Saving model ...
Epoch: 9 cost time: 0.8709254264831543
Epoch: 9, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.839 Vali Acc: 0.737 Test Loss: 0.839 Test Acc: 0.737
Validation loss decreased (-0.723675 --> -0.736834).  Saving model ...
Epoch: 10 cost time: 0.8144292831420898
Epoch: 10, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.801 Vali Acc: 0.757 Test Loss: 0.801 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 0.7102653980255127
Epoch: 11, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.770 Vali Acc: 0.757 Test Loss: 0.770 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756571).  Saving model ...
Epoch: 12 cost time: 0.9986345767974854
Epoch: 12, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.737 Vali Acc: 0.763 Test Loss: 0.737 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763151).  Saving model ...
Epoch: 13 cost time: 0.8522200584411621
Epoch: 13, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.717 Vali Acc: 0.809 Test Loss: 0.717 Test Acc: 0.809
Validation loss decreased (-0.763151 --> -0.809203).  Saving model ...
Epoch: 14 cost time: 0.8735942840576172
Epoch: 14, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6644597053527832
Epoch: 15, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.684 Vali Acc: 0.796 Test Loss: 0.684 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8109517097473145
Epoch: 16, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6738946437835693
Epoch: 17, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7729911804199219
Epoch: 18, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6231026649475098
Epoch: 19, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.629 Vali Acc: 0.763 Test Loss: 0.629 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7712507247924805
Epoch: 20, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7428672313690186
Epoch: 21, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.611 Vali Acc: 0.743 Test Loss: 0.611 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8201947212219238
Epoch: 22, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8811891078948975
Epoch: 23, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.598 Vali Acc: 0.763 Test Loss: 0.598 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 64308
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.228719711303711
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.400 Vali Acc: 0.309 Test Loss: 1.400 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 0.8267719745635986
Epoch: 2, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.9093601703643799
Epoch: 3, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.226 Vali Acc: 0.461 Test Loss: 1.226 Test Acc: 0.461
Validation loss decreased (-0.374987 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 0.8380608558654785
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.135 Vali Acc: 0.539 Test Loss: 1.135 Test Acc: 0.539
Validation loss decreased (-0.460514 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 0.7388811111450195
Epoch: 5, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.060 Vali Acc: 0.586 Test Loss: 1.060 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585516).  Saving model ...
Epoch: 6 cost time: 0.7679424285888672
Epoch: 6, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
Validation loss decreased (-0.585516 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.9067285060882568
Epoch: 7, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.933 Vali Acc: 0.678 Test Loss: 0.933 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 0.8936977386474609
Epoch: 8, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710517).  Saving model ...
Epoch: 9 cost time: 0.9670896530151367
Epoch: 9, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.710517 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 0.6064975261688232
Epoch: 10, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 11 cost time: 0.8249435424804688
Epoch: 11, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.8156123161315918
Epoch: 12, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.758 Vali Acc: 0.763 Test Loss: 0.758 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 13 cost time: 0.8406665325164795
Epoch: 13, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.726 Vali Acc: 0.770 Test Loss: 0.726 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 14 cost time: 0.768416166305542
Epoch: 14, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 15 cost time: 0.7444894313812256
Epoch: 15, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.685 Vali Acc: 0.763 Test Loss: 0.685 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1061668395996094
Epoch: 16, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.903792142868042
Epoch: 17, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7641346454620361
Epoch: 18, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8611183166503906
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.809025764465332
Epoch: 20, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7434420585632324
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.635 Vali Acc: 0.743 Test Loss: 0.635 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7305119037628174
Epoch: 22, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.629 Vali Acc: 0.743 Test Loss: 0.629 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7777717113494873
Epoch: 23, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7438516616821289
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 63284
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4326488971710205
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.400 Vali Acc: 0.309 Test Loss: 1.400 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 0.8579897880554199
Epoch: 2, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.0193426609039307
Epoch: 3, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.226 Vali Acc: 0.461 Test Loss: 1.226 Test Acc: 0.461
Validation loss decreased (-0.374987 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.1600778102874756
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.135 Vali Acc: 0.539 Test Loss: 1.135 Test Acc: 0.539
Validation loss decreased (-0.460514 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 0.8357977867126465
Epoch: 5, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.060 Vali Acc: 0.586 Test Loss: 1.060 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585516).  Saving model ...
Epoch: 6 cost time: 0.8687107563018799
Epoch: 6, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
Validation loss decreased (-0.585516 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.8102967739105225
Epoch: 7, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.933 Vali Acc: 0.678 Test Loss: 0.933 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 0.9916155338287354
Epoch: 8, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710517).  Saving model ...
Epoch: 9 cost time: 0.709003210067749
Epoch: 9, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.710517 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 1.0801522731781006
Epoch: 10, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 11 cost time: 1.0417370796203613
Epoch: 11, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.9024603366851807
Epoch: 12, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.758 Vali Acc: 0.763 Test Loss: 0.758 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 13 cost time: 0.9453401565551758
Epoch: 13, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.726 Vali Acc: 0.770 Test Loss: 0.726 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 14 cost time: 0.9536471366882324
Epoch: 14, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 15 cost time: 1.0362648963928223
Epoch: 15, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.685 Vali Acc: 0.763 Test Loss: 0.685 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8981969356536865
Epoch: 16, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8694829940795898
Epoch: 17, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8116941452026367
Epoch: 18, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8424158096313477
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8316915035247803
Epoch: 20, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8334636688232422
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.635 Vali Acc: 0.743 Test Loss: 0.635 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2437245845794678
Epoch: 22, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.629 Vali Acc: 0.743 Test Loss: 0.629 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8455955982208252
Epoch: 23, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9480009078979492
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 63284
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8627822399139404
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.434 Vali Acc: 0.151 Test Loss: 1.434 Test Acc: 0.151
Validation loss decreased (inf --> -0.151301).  Saving model ...
Epoch: 2 cost time: 0.876227617263794
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.413 Vali Acc: 0.171 Test Loss: 1.413 Test Acc: 0.171
Validation loss decreased (-0.151301 --> -0.171038).  Saving model ...
Epoch: 3 cost time: 0.9308943748474121
Epoch: 3, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.386 Vali Acc: 0.204 Test Loss: 1.386 Test Acc: 0.204
Validation loss decreased (-0.171038 --> -0.203934).  Saving model ...
Epoch: 4 cost time: 0.7876043319702148
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.354 Vali Acc: 0.237 Test Loss: 1.354 Test Acc: 0.237
Validation loss decreased (-0.203934 --> -0.236829).  Saving model ...
Epoch: 5 cost time: 0.9614677429199219
Epoch: 5, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.321 Vali Acc: 0.322 Test Loss: 1.321 Test Acc: 0.322
Validation loss decreased (-0.236829 --> -0.322355).  Saving model ...
Epoch: 6 cost time: 0.9489219188690186
Epoch: 6, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.289 Vali Acc: 0.382 Test Loss: 1.289 Test Acc: 0.382
Validation loss decreased (-0.322355 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 0.8906352519989014
Epoch: 7, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.259 Vali Acc: 0.454 Test Loss: 1.259 Test Acc: 0.454
Validation loss decreased (-0.381566 --> -0.453935).  Saving model ...
Epoch: 8 cost time: 0.9862790107727051
Epoch: 8, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.228 Vali Acc: 0.526 Test Loss: 1.228 Test Acc: 0.526
Validation loss decreased (-0.453935 --> -0.526304).  Saving model ...
Epoch: 9 cost time: 0.8225488662719727
Epoch: 9, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.198 Vali Acc: 0.566 Test Loss: 1.198 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565777).  Saving model ...
Epoch: 10 cost time: 0.9282686710357666
Epoch: 10, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.165 Vali Acc: 0.572 Test Loss: 1.165 Test Acc: 0.572
Validation loss decreased (-0.565777 --> -0.572357).  Saving model ...
Epoch: 11 cost time: 0.9417293071746826
Epoch: 11, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.131 Vali Acc: 0.592 Test Loss: 1.131 Test Acc: 0.592
Validation loss decreased (-0.572357 --> -0.592094).  Saving model ...
Epoch: 12 cost time: 0.8950586318969727
Epoch: 12, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.096 Vali Acc: 0.612 Test Loss: 1.096 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611831).  Saving model ...
Epoch: 13 cost time: 0.9285669326782227
Epoch: 13, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.058 Vali Acc: 0.638 Test Loss: 1.058 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638147).  Saving model ...
Epoch: 14 cost time: 0.9890851974487305
Epoch: 14, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.020 Vali Acc: 0.651 Test Loss: 1.020 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 15 cost time: 0.8587050437927246
Epoch: 15, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.984 Vali Acc: 0.697 Test Loss: 0.984 Test Acc: 0.697
Validation loss decreased (-0.651306 --> -0.697359).  Saving model ...
Epoch: 16 cost time: 0.731562614440918
Epoch: 16, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.950 Vali Acc: 0.704 Test Loss: 0.950 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 17 cost time: 0.905242919921875
Epoch: 17, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.917 Vali Acc: 0.724 Test Loss: 0.917 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723675).  Saving model ...
Epoch: 18 cost time: 1.0688247680664062
Epoch: 18, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.890 Vali Acc: 0.743 Test Loss: 0.890 Test Acc: 0.743
Validation loss decreased (-0.723675 --> -0.743412).  Saving model ...
Epoch: 19 cost time: 1.0537784099578857
Epoch: 19, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.865 Vali Acc: 0.770 Test Loss: 0.865 Test Acc: 0.770
Validation loss decreased (-0.743412 --> -0.769728).  Saving model ...
Epoch: 20 cost time: 1.0586647987365723
Epoch: 20, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.840 Vali Acc: 0.783 Test Loss: 0.840 Test Acc: 0.783
Validation loss decreased (-0.769728 --> -0.782886).  Saving model ...
Epoch: 21 cost time: 0.9595091342926025
Epoch: 21, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
Validation loss decreased (-0.782886 --> -0.782887).  Saving model ...
Epoch: 22 cost time: 0.9942772388458252
Epoch: 22, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.794 Vali Acc: 0.783 Test Loss: 0.794 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782887).  Saving model ...
Epoch: 23 cost time: 1.0062379837036133
Epoch: 23, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.775 Vali Acc: 0.789 Test Loss: 0.775 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 24 cost time: 1.078885555267334
Epoch: 24, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.751 Vali Acc: 0.776 Test Loss: 0.751 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1225037574768066
Epoch: 25, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802624).  Saving model ...
Epoch: 26 cost time: 1.132793664932251
Epoch: 26, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.708 Vali Acc: 0.796 Test Loss: 0.708 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1792066097259521
Epoch: 27, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809204).  Saving model ...
Epoch: 28 cost time: 1.0380308628082275
Epoch: 28, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
Validation loss decreased (-0.809204 --> -0.822362).  Saving model ...
Epoch: 29 cost time: 1.3083539009094238
Epoch: 29, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.658 Vali Acc: 0.836 Test Loss: 0.658 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 30 cost time: 0.9235198497772217
Epoch: 30, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.641 Vali Acc: 0.829 Test Loss: 0.641 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.130474328994751
Epoch: 31, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.626 Vali Acc: 0.829 Test Loss: 0.626 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.061715841293335
Epoch: 32, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.610 Vali Acc: 0.829 Test Loss: 0.610 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0706005096435547
Epoch: 33, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.596 Vali Acc: 0.842 Test Loss: 0.596 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 34 cost time: 1.053330898284912
Epoch: 34, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.582 Vali Acc: 0.849 Test Loss: 0.582 Test Acc: 0.849
Validation loss decreased (-0.842099 --> -0.848678).  Saving model ...
Epoch: 35 cost time: 1.1738643646240234
Epoch: 35, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.570 Vali Acc: 0.849 Test Loss: 0.570 Test Acc: 0.849
Validation loss decreased (-0.848678 --> -0.848679).  Saving model ...
Epoch: 36 cost time: 1.044661521911621
Epoch: 36, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855258).  Saving model ...
Epoch: 37 cost time: 1.1236374378204346
Epoch: 37, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.551 Vali Acc: 0.849 Test Loss: 0.551 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3317067623138428
Epoch: 38, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.543 Vali Acc: 0.849 Test Loss: 0.543 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.982144832611084
Epoch: 39, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.540 Vali Acc: 0.836 Test Loss: 0.540 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0965704917907715
Epoch: 40, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.535 Vali Acc: 0.842 Test Loss: 0.535 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8505890369415283
Epoch: 41, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.529 Vali Acc: 0.849 Test Loss: 0.529 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9370782375335693
Epoch: 42, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.517 Vali Acc: 0.849 Test Loss: 0.517 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1524755954742432
Epoch: 43, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.507 Vali Acc: 0.849 Test Loss: 0.507 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1895115375518799
Epoch: 44, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 45 cost time: 0.9354240894317627
Epoch: 45, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.504 Vali Acc: 0.849 Test Loss: 0.504 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2806446552276611
Epoch: 46, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.496 Vali Acc: 0.849 Test Loss: 0.496 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9348101615905762
Epoch: 47, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.497 Vali Acc: 0.842 Test Loss: 0.497 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9981241226196289
Epoch: 48, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.492 Vali Acc: 0.842 Test Loss: 0.492 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9880461692810059
Epoch: 49, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0594501495361328
Epoch: 50, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.484 Vali Acc: 0.836 Test Loss: 0.484 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1740715503692627
Epoch: 51, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9697110652923584
Epoch: 52, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.9564845561981201
Epoch: 53, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.0115888118743896
Epoch: 54, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.465 Vali Acc: 0.836 Test Loss: 0.465 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 33704
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.515979290008545
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.359 Vali Acc: 0.336 Test Loss: 1.359 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.012702465057373
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.336 Vali Acc: 0.368 Test Loss: 1.336 Test Acc: 0.368
Validation loss decreased (-0.335513 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 0.7859084606170654
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.304 Vali Acc: 0.414 Test Loss: 1.304 Test Acc: 0.414
Validation loss decreased (-0.368408 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 0.8584249019622803
Epoch: 4, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.267 Vali Acc: 0.441 Test Loss: 1.267 Test Acc: 0.441
Validation loss decreased (-0.414461 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 1.075817346572876
Epoch: 5, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.230 Vali Acc: 0.461 Test Loss: 1.230 Test Acc: 0.461
Validation loss decreased (-0.440777 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 0.8773562908172607
Epoch: 6, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.190 Vali Acc: 0.507 Test Loss: 1.190 Test Acc: 0.507
Validation loss decreased (-0.460514 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 0.928508996963501
Epoch: 7, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.151 Vali Acc: 0.539 Test Loss: 1.151 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 0.8788738250732422
Epoch: 8, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.112 Vali Acc: 0.605 Test Loss: 1.112 Test Acc: 0.605
Validation loss decreased (-0.539462 --> -0.605252).  Saving model ...
Epoch: 9 cost time: 1.0513770580291748
Epoch: 9, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.076 Vali Acc: 0.632 Test Loss: 1.076 Test Acc: 0.632
Validation loss decreased (-0.605252 --> -0.631568).  Saving model ...
Epoch: 10 cost time: 1.113032341003418
Epoch: 10, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.043 Vali Acc: 0.664 Test Loss: 1.043 Test Acc: 0.664
Validation loss decreased (-0.631568 --> -0.664463).  Saving model ...
Epoch: 11 cost time: 1.0576844215393066
Epoch: 11, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.010 Vali Acc: 0.678 Test Loss: 1.010 Test Acc: 0.678
Validation loss decreased (-0.664463 --> -0.677621).  Saving model ...
Epoch: 12 cost time: 1.2048542499542236
Epoch: 12, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.976 Vali Acc: 0.697 Test Loss: 0.976 Test Acc: 0.697
Validation loss decreased (-0.677621 --> -0.697359).  Saving model ...
Epoch: 13 cost time: 0.8855679035186768
Epoch: 13, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.946 Vali Acc: 0.717 Test Loss: 0.946 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717096).  Saving model ...
Epoch: 14 cost time: 1.1507208347320557
Epoch: 14, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
Validation loss decreased (-0.717096 --> -0.717096).  Saving model ...
Epoch: 15 cost time: 1.231907844543457
Epoch: 15, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.883 Vali Acc: 0.730 Test Loss: 0.883 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730254).  Saving model ...
Epoch: 16 cost time: 0.9738764762878418
Epoch: 16, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.856 Vali Acc: 0.737 Test Loss: 0.856 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 17 cost time: 1.2485079765319824
Epoch: 17, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 1.495131015777588
Epoch: 18, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.800 Vali Acc: 0.770 Test Loss: 0.800 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769729).  Saving model ...
Epoch: 19 cost time: 1.1065607070922852
Epoch: 19, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.773 Vali Acc: 0.757 Test Loss: 0.773 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1246132850646973
Epoch: 20, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 21 cost time: 0.8194975852966309
Epoch: 21, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 22 cost time: 1.0282280445098877
Epoch: 22, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802625).  Saving model ...
Epoch: 23 cost time: 1.1870520114898682
Epoch: 23, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 24 cost time: 1.0255756378173828
Epoch: 24, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 25 cost time: 1.4477014541625977
Epoch: 25, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.642 Vali Acc: 0.816 Test Loss: 0.642 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 26 cost time: 0.939096212387085
Epoch: 26, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 1.0653855800628662
Epoch: 27, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 28 cost time: 1.001089096069336
Epoch: 28, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.595 Vali Acc: 0.836 Test Loss: 0.595 Test Acc: 0.836
Validation loss decreased (-0.815783 --> -0.835520).  Saving model ...
Epoch: 29 cost time: 0.8576586246490479
Epoch: 29, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.579 Vali Acc: 0.836 Test Loss: 0.579 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835521).  Saving model ...
Epoch: 30 cost time: 0.9009582996368408
Epoch: 30, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.566 Vali Acc: 0.836 Test Loss: 0.566 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 31 cost time: 1.0564205646514893
Epoch: 31, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9926247596740723
Epoch: 32, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8295164108276367
Epoch: 33, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.537 Vali Acc: 0.836 Test Loss: 0.537 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 34 cost time: 1.0894787311553955
Epoch: 34, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.527 Vali Acc: 0.849 Test Loss: 0.527 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848679).  Saving model ...
Epoch: 35 cost time: 1.0952956676483154
Epoch: 35, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.516 Vali Acc: 0.842 Test Loss: 0.516 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0159435272216797
Epoch: 36, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.511 Vali Acc: 0.849 Test Loss: 0.511 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 37 cost time: 0.8674099445343018
Epoch: 37, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.506 Vali Acc: 0.849 Test Loss: 0.506 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 38 cost time: 0.9312362670898438
Epoch: 38, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
Validation loss decreased (-0.848679 --> -0.861837).  Saving model ...
Epoch: 39 cost time: 1.0644395351409912
Epoch: 39, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.503 Vali Acc: 0.849 Test Loss: 0.503 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.093414068222046
Epoch: 40, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.498 Vali Acc: 0.836 Test Loss: 0.498 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0045146942138672
Epoch: 41, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0551354885101318
Epoch: 42, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.492 Vali Acc: 0.842 Test Loss: 0.492 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8680791854858398
Epoch: 43, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8598642349243164
Epoch: 44, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8677206039428711
Epoch: 45, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.479 Vali Acc: 0.849 Test Loss: 0.479 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8704752922058105
Epoch: 46, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9392428398132324
Epoch: 47, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 48 cost time: 1.1283924579620361
Epoch: 48, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 49 cost time: 0.9113671779632568
Epoch: 49, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8179371356964111
Epoch: 50, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.461 Vali Acc: 0.842 Test Loss: 0.461 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8823046684265137
Epoch: 51, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.464 Vali Acc: 0.849 Test Loss: 0.464 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8654401302337646
Epoch: 52, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9628350734710693
Epoch: 53, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9035003185272217
Epoch: 54, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 55 cost time: 0.7384548187255859
Epoch: 55, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9735774993896484
Epoch: 56, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9574456214904785
Epoch: 57, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861838).  Saving model ...
Epoch: 58 cost time: 0.9871706962585449
Epoch: 58, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9633440971374512
Epoch: 59, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.463 Vali Acc: 0.842 Test Loss: 0.463 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0986974239349365
Epoch: 60, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.466 Vali Acc: 0.849 Test Loss: 0.466 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7872953414916992
Epoch: 61, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.464 Vali Acc: 0.849 Test Loss: 0.464 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.90407395362854
Epoch: 62, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.459 Vali Acc: 0.842 Test Loss: 0.459 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.221111536026001
Epoch: 63, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.458 Vali Acc: 0.849 Test Loss: 0.458 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.2999987602233887
Epoch: 64, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9939653873443604
Epoch: 65, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8646924495697021
Epoch: 66, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.458 Vali Acc: 0.842 Test Loss: 0.458 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.9113965034484863
Epoch: 67, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.459 Vali Acc: 0.842 Test Loss: 0.459 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 33192
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9298593997955322
Epoch: 1, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.307 Vali Acc: 0.408 Test Loss: 1.307 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 0.7202038764953613
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.289 Vali Acc: 0.414 Test Loss: 1.289 Test Acc: 0.414
Validation loss decreased (-0.407882 --> -0.414461).  Saving model ...
Epoch: 3 cost time: 1.065100908279419
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.265 Vali Acc: 0.474 Test Loss: 1.265 Test Acc: 0.474
Validation loss decreased (-0.414461 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 0.8815648555755615
Epoch: 4, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.236 Vali Acc: 0.513 Test Loss: 1.236 Test Acc: 0.513
Validation loss decreased (-0.473672 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.0763204097747803
Epoch: 5, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.206 Vali Acc: 0.533 Test Loss: 1.206 Test Acc: 0.533
Validation loss decreased (-0.513146 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 0.6903963088989258
Epoch: 6, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.175 Vali Acc: 0.533 Test Loss: 1.175 Test Acc: 0.533
Validation loss decreased (-0.532883 --> -0.532883).  Saving model ...
Epoch: 7 cost time: 0.6891751289367676
Epoch: 7, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.144 Vali Acc: 0.579 Test Loss: 1.144 Test Acc: 0.579
Validation loss decreased (-0.532883 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 0.728034496307373
Epoch: 8, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.578936 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.9348933696746826
Epoch: 9, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.083 Vali Acc: 0.612 Test Loss: 1.083 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7795488834381104
Epoch: 10, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.052 Vali Acc: 0.618 Test Loss: 1.052 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.823814868927002
Epoch: 11, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.023 Vali Acc: 0.638 Test Loss: 1.023 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 0.7235944271087646
Epoch: 12, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.992 Vali Acc: 0.651 Test Loss: 0.992 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 13 cost time: 0.7873265743255615
Epoch: 13, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.961 Vali Acc: 0.671 Test Loss: 0.961 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 14 cost time: 0.8539254665374756
Epoch: 14, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.931 Vali Acc: 0.691 Test Loss: 0.931 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690780).  Saving model ...
Epoch: 15 cost time: 0.8017981052398682
Epoch: 15, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.900 Vali Acc: 0.697 Test Loss: 0.900 Test Acc: 0.697
Validation loss decreased (-0.690780 --> -0.697359).  Saving model ...
Epoch: 16 cost time: 0.8047599792480469
Epoch: 16, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.871 Vali Acc: 0.704 Test Loss: 0.871 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703939).  Saving model ...
Epoch: 17 cost time: 0.8955309391021729
Epoch: 17, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.845 Vali Acc: 0.697 Test Loss: 0.845 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7981011867523193
Epoch: 18, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.819 Vali Acc: 0.704 Test Loss: 0.819 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 19 cost time: 0.8024435043334961
Epoch: 19, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.790 Vali Acc: 0.724 Test Loss: 0.790 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723676).  Saving model ...
Epoch: 20 cost time: 0.786207914352417
Epoch: 20, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736834).  Saving model ...
Epoch: 21 cost time: 0.7981188297271729
Epoch: 21, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.744 Vali Acc: 0.743 Test Loss: 0.744 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 22 cost time: 0.7130923271179199
Epoch: 22, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 0.685784101486206
Epoch: 23, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.699 Vali Acc: 0.757 Test Loss: 0.699 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 0.9978487491607666
Epoch: 24, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.685 Vali Acc: 0.763 Test Loss: 0.685 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 25 cost time: 0.7979052066802979
Epoch: 25, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8618319034576416
Epoch: 26, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.656 Vali Acc: 0.763 Test Loss: 0.656 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 27 cost time: 0.9261846542358398
Epoch: 27, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.642 Vali Acc: 0.757 Test Loss: 0.642 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8318789005279541
Epoch: 28, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9387035369873047
Epoch: 29, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 0.8118801116943359
Epoch: 30, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 31 cost time: 0.9143152236938477
Epoch: 31, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.602 Vali Acc: 0.776 Test Loss: 0.602 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8006787300109863
Epoch: 32, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8186554908752441
Epoch: 33, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8255760669708252
Epoch: 34, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8886382579803467
Epoch: 35, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9648604393005371
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8781185150146484
Epoch: 37, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9141607284545898
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8585560321807861
Epoch: 39, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9019827842712402
Epoch: 40, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 32680
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.519773244857788
Epoch: 1, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.357 Vali Acc: 0.309 Test Loss: 1.357 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.0276570320129395
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.339 Vali Acc: 0.329 Test Loss: 1.339 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.28507399559021
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.313 Vali Acc: 0.368 Test Loss: 1.313 Test Acc: 0.368
Validation loss decreased (-0.328934 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.1512691974639893
Epoch: 4, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.285 Vali Acc: 0.447 Test Loss: 1.285 Test Acc: 0.447
Validation loss decreased (-0.368408 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 0.9379110336303711
Epoch: 5, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.254 Vali Acc: 0.454 Test Loss: 1.254 Test Acc: 0.454
Validation loss decreased (-0.447356 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 0.8426856994628906
Epoch: 6, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.222 Vali Acc: 0.526 Test Loss: 1.222 Test Acc: 0.526
Validation loss decreased (-0.453935 --> -0.526304).  Saving model ...
Epoch: 7 cost time: 1.1901543140411377
Epoch: 7, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.185 Vali Acc: 0.539 Test Loss: 1.185 Test Acc: 0.539
Validation loss decreased (-0.526304 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 1.0737464427947998
Epoch: 8, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.150 Vali Acc: 0.566 Test Loss: 1.150 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565778).  Saving model ...
Epoch: 9 cost time: 1.103821039199829
Epoch: 9, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.115 Vali Acc: 0.592 Test Loss: 1.115 Test Acc: 0.592
Validation loss decreased (-0.565778 --> -0.592094).  Saving model ...
Epoch: 10 cost time: 1.0581979751586914
Epoch: 10, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.076 Vali Acc: 0.618 Test Loss: 1.076 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618410).  Saving model ...
Epoch: 11 cost time: 1.0150854587554932
Epoch: 11, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.044 Vali Acc: 0.638 Test Loss: 1.044 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638147).  Saving model ...
Epoch: 12 cost time: 0.8875277042388916
Epoch: 12, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.010 Vali Acc: 0.658 Test Loss: 1.010 Test Acc: 0.658
Validation loss decreased (-0.638147 --> -0.657885).  Saving model ...
Epoch: 13 cost time: 0.7998950481414795
Epoch: 13, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.975 Vali Acc: 0.651 Test Loss: 0.975 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.825615406036377
Epoch: 14, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.941 Vali Acc: 0.664 Test Loss: 0.941 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664464).  Saving model ...
Epoch: 15 cost time: 0.8706204891204834
Epoch: 15, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.908 Vali Acc: 0.684 Test Loss: 0.908 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 16 cost time: 0.9046711921691895
Epoch: 16, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.876 Vali Acc: 0.704 Test Loss: 0.876 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703939).  Saving model ...
Epoch: 17 cost time: 0.9167406558990479
Epoch: 17, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 18 cost time: 1.0745582580566406
Epoch: 18, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.817 Vali Acc: 0.757 Test Loss: 0.817 Test Acc: 0.757
Validation loss decreased (-0.717097 --> -0.756571).  Saving model ...
Epoch: 19 cost time: 1.0312285423278809
Epoch: 19, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.789 Vali Acc: 0.763 Test Loss: 0.789 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 20 cost time: 1.0871210098266602
Epoch: 20, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.765 Vali Acc: 0.770 Test Loss: 0.765 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 21 cost time: 0.8664538860321045
Epoch: 21, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.742 Vali Acc: 0.757 Test Loss: 0.742 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8983311653137207
Epoch: 22, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.717 Vali Acc: 0.763 Test Loss: 0.717 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.854844331741333
Epoch: 23, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.692 Vali Acc: 0.776 Test Loss: 0.692 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776309).  Saving model ...
Epoch: 24 cost time: 1.0697786808013916
Epoch: 24, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 1.4022595882415771
Epoch: 25, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 26 cost time: 1.058764934539795
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.638 Vali Acc: 0.816 Test Loss: 0.638 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 1.1026546955108643
Epoch: 27, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 28 cost time: 1.0181968212127686
Epoch: 28, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 29 cost time: 1.0486044883728027
Epoch: 29, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9826340675354004
Epoch: 30, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 0.8754150867462158
Epoch: 31, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 32 cost time: 0.8404297828674316
Epoch: 32, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8613479137420654
Epoch: 33, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0775294303894043
Epoch: 34, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1460788249969482
Epoch: 35, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.861138105392456
Epoch: 36, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0660138130187988
Epoch: 37, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8184337615966797
Epoch: 38, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 39 cost time: 0.7055158615112305
Epoch: 39, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8488039970397949
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 41 cost time: 0.963118314743042
Epoch: 41, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0738840103149414
Epoch: 42, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1564407348632812
Epoch: 43, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.497 Vali Acc: 0.829 Test Loss: 0.497 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 44 cost time: 0.9955663681030273
Epoch: 44, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.493 Vali Acc: 0.842 Test Loss: 0.493 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842100).  Saving model ...
Epoch: 45 cost time: 1.0820279121398926
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.490 Vali Acc: 0.842 Test Loss: 0.490 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 46 cost time: 0.7480521202087402
Epoch: 46, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8562078475952148
Epoch: 47, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0773205757141113
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.844459056854248
Epoch: 49, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9642198085784912
Epoch: 50, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9393703937530518
Epoch: 51, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.1731393337249756
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.2103395462036133
Epoch: 53, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1189796924591064
Epoch: 54, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.0879333019256592
Epoch: 55, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 32168
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7443673610687256
Epoch: 1, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.357 Vali Acc: 0.309 Test Loss: 1.357 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 0.885200023651123
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.339 Vali Acc: 0.329 Test Loss: 1.339 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 0.96156907081604
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.313 Vali Acc: 0.368 Test Loss: 1.313 Test Acc: 0.368
Validation loss decreased (-0.328934 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.0156102180480957
Epoch: 4, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.285 Vali Acc: 0.447 Test Loss: 1.285 Test Acc: 0.447
Validation loss decreased (-0.368408 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 0.6948118209838867
Epoch: 5, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.254 Vali Acc: 0.454 Test Loss: 1.254 Test Acc: 0.454
Validation loss decreased (-0.447356 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.0125267505645752
Epoch: 6, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.222 Vali Acc: 0.526 Test Loss: 1.222 Test Acc: 0.526
Validation loss decreased (-0.453935 --> -0.526304).  Saving model ...
Epoch: 7 cost time: 0.8876297473907471
Epoch: 7, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.185 Vali Acc: 0.539 Test Loss: 1.185 Test Acc: 0.539
Validation loss decreased (-0.526304 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 0.752511739730835
Epoch: 8, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.150 Vali Acc: 0.566 Test Loss: 1.150 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565778).  Saving model ...
Epoch: 9 cost time: 0.9036402702331543
Epoch: 9, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.115 Vali Acc: 0.592 Test Loss: 1.115 Test Acc: 0.592
Validation loss decreased (-0.565778 --> -0.592094).  Saving model ...
Epoch: 10 cost time: 0.9225540161132812
Epoch: 10, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.076 Vali Acc: 0.618 Test Loss: 1.076 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618410).  Saving model ...
Epoch: 11 cost time: 0.8074178695678711
Epoch: 11, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.044 Vali Acc: 0.638 Test Loss: 1.044 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638147).  Saving model ...
Epoch: 12 cost time: 0.8234579563140869
Epoch: 12, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.010 Vali Acc: 0.658 Test Loss: 1.010 Test Acc: 0.658
Validation loss decreased (-0.638147 --> -0.657885).  Saving model ...
Epoch: 13 cost time: 0.8780601024627686
Epoch: 13, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.975 Vali Acc: 0.651 Test Loss: 0.975 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9789907932281494
Epoch: 14, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.941 Vali Acc: 0.664 Test Loss: 0.941 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664464).  Saving model ...
Epoch: 15 cost time: 0.8057105541229248
Epoch: 15, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.908 Vali Acc: 0.684 Test Loss: 0.908 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 16 cost time: 0.7315573692321777
Epoch: 16, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.876 Vali Acc: 0.704 Test Loss: 0.876 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703939).  Saving model ...
Epoch: 17 cost time: 0.7783920764923096
Epoch: 17, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 18 cost time: 0.9182708263397217
Epoch: 18, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.817 Vali Acc: 0.757 Test Loss: 0.817 Test Acc: 0.757
Validation loss decreased (-0.717097 --> -0.756571).  Saving model ...
Epoch: 19 cost time: 0.7191884517669678
Epoch: 19, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.789 Vali Acc: 0.763 Test Loss: 0.789 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 20 cost time: 0.8169538974761963
Epoch: 20, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.765 Vali Acc: 0.770 Test Loss: 0.765 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 21 cost time: 0.9013411998748779
Epoch: 21, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.742 Vali Acc: 0.757 Test Loss: 0.742 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9176247119903564
Epoch: 22, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.717 Vali Acc: 0.763 Test Loss: 0.717 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7918648719787598
Epoch: 23, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.692 Vali Acc: 0.776 Test Loss: 0.692 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776309).  Saving model ...
Epoch: 24 cost time: 0.7090744972229004
Epoch: 24, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 0.7505800724029541
Epoch: 25, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 26 cost time: 0.6648194789886475
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.638 Vali Acc: 0.816 Test Loss: 0.638 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 0.7154264450073242
Epoch: 27, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 28 cost time: 0.7379508018493652
Epoch: 28, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 29 cost time: 0.6747658252716064
Epoch: 29, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.600 Vali Acc: 0.809 Test Loss: 0.600 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7305121421813965
Epoch: 30, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 0.761418342590332
Epoch: 31, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 32 cost time: 1.0126228332519531
Epoch: 32, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7391862869262695
Epoch: 33, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5907938480377197
Epoch: 34, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7287611961364746
Epoch: 35, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8120167255401611
Epoch: 36, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9661872386932373
Epoch: 37, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.624464750289917
Epoch: 38, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 39 cost time: 0.6692638397216797
Epoch: 39, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6931965351104736
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 41 cost time: 0.6928226947784424
Epoch: 41, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.852522611618042
Epoch: 42, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.504 Vali Acc: 0.816 Test Loss: 0.504 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7377424240112305
Epoch: 43, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.497 Vali Acc: 0.829 Test Loss: 0.497 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 44 cost time: 1.0362186431884766
Epoch: 44, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.493 Vali Acc: 0.842 Test Loss: 0.493 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842100).  Saving model ...
Epoch: 45 cost time: 0.819725751876831
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.490 Vali Acc: 0.842 Test Loss: 0.490 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 46 cost time: 1.0174751281738281
Epoch: 46, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.920947790145874
Epoch: 47, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.857459306716919
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.484 Vali Acc: 0.822 Test Loss: 0.484 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9579975605010986
Epoch: 49, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8795485496520996
Epoch: 50, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8879852294921875
Epoch: 51, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.7746469974517822
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.8705358505249023
Epoch: 53, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.7476551532745361
Epoch: 54, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9175815582275391
Epoch: 55, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 32168
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.903388738632202
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.436 Vali Acc: 0.263 Test Loss: 1.436 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.0361874103546143
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.415 Vali Acc: 0.283 Test Loss: 1.415 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.0349743366241455
Epoch: 3, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.387 Vali Acc: 0.303 Test Loss: 1.387 Test Acc: 0.303
Validation loss decreased (-0.282881 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 1.0707755088806152
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (-0.302618 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.998945951461792
Epoch: 5, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.320 Vali Acc: 0.414 Test Loss: 1.320 Test Acc: 0.414
Validation loss decreased (-0.374986 --> -0.414460).  Saving model ...
Epoch: 6 cost time: 0.8892776966094971
Epoch: 6, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.282 Vali Acc: 0.474 Test Loss: 1.282 Test Acc: 0.474
Validation loss decreased (-0.414460 --> -0.473671).  Saving model ...
Epoch: 7 cost time: 1.0654633045196533
Epoch: 7, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.245 Vali Acc: 0.507 Test Loss: 1.245 Test Acc: 0.507
Validation loss decreased (-0.473671 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 0.9905626773834229
Epoch: 8, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.206 Vali Acc: 0.546 Test Loss: 1.206 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 1.0172429084777832
Epoch: 9, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.166 Vali Acc: 0.572 Test Loss: 1.166 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 0.9266059398651123
Epoch: 10, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.123 Vali Acc: 0.592 Test Loss: 1.123 Test Acc: 0.592
Validation loss decreased (-0.572357 --> -0.592094).  Saving model ...
Epoch: 11 cost time: 1.0449767112731934
Epoch: 11, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.082 Vali Acc: 0.625 Test Loss: 1.082 Test Acc: 0.625
Validation loss decreased (-0.592094 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 1.0227649211883545
Epoch: 12, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.040 Vali Acc: 0.638 Test Loss: 1.040 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638147).  Saving model ...
Epoch: 13 cost time: 0.8401625156402588
Epoch: 13, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.002 Vali Acc: 0.651 Test Loss: 1.002 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 14 cost time: 0.853229284286499
Epoch: 14, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.967 Vali Acc: 0.678 Test Loss: 0.967 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677622).  Saving model ...
Epoch: 15 cost time: 0.7864243984222412
Epoch: 15, Steps: 10 | Train Loss: 0.767 Vali Loss: 0.933 Vali Acc: 0.704 Test Loss: 0.933 Test Acc: 0.704
Validation loss decreased (-0.677622 --> -0.703938).  Saving model ...
Epoch: 16 cost time: 1.0411698818206787
Epoch: 16, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.899 Vali Acc: 0.711 Test Loss: 0.899 Test Acc: 0.711
Validation loss decreased (-0.703938 --> -0.710517).  Saving model ...
Epoch: 17 cost time: 0.8064298629760742
Epoch: 17, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.867 Vali Acc: 0.724 Test Loss: 0.867 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723676).  Saving model ...
Epoch: 18 cost time: 1.0117714405059814
Epoch: 18, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
Validation loss decreased (-0.723676 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.0104939937591553
Epoch: 19, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.807 Vali Acc: 0.776 Test Loss: 0.807 Test Acc: 0.776
Validation loss decreased (-0.749992 --> -0.776308).  Saving model ...
Epoch: 20 cost time: 0.8261661529541016
Epoch: 20, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.782 Vali Acc: 0.743 Test Loss: 0.782 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.071176290512085
Epoch: 21, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.755 Vali Acc: 0.757 Test Loss: 0.755 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1002147197723389
Epoch: 22, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782887).  Saving model ...
Epoch: 23 cost time: 1.0627107620239258
Epoch: 23, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.719 Vali Acc: 0.776 Test Loss: 0.719 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1536669731140137
Epoch: 24, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9790599346160889
Epoch: 25, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 26 cost time: 1.310791015625
Epoch: 26, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 27 cost time: 1.1832339763641357
Epoch: 27, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.657 Vali Acc: 0.776 Test Loss: 0.657 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4302423000335693
Epoch: 28, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0860612392425537
Epoch: 29, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.638 Vali Acc: 0.776 Test Loss: 0.638 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.071922779083252
Epoch: 30, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.332942008972168
Epoch: 31, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.960963249206543
Epoch: 32, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.039679765701294
Epoch: 33, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1219112873077393
Epoch: 34, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9299681186676025
Epoch: 35, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1177244186401367
Epoch: 36, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.586 Vali Acc: 0.776 Test Loss: 0.586 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 33652
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.532097101211548
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.425 Vali Acc: 0.211 Test Loss: 1.425 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 0.9582834243774414
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.404 Vali Acc: 0.250 Test Loss: 1.404 Test Acc: 0.250
Validation loss decreased (-0.210512 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.8642151355743408
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.377 Vali Acc: 0.303 Test Loss: 1.377 Test Acc: 0.303
Validation loss decreased (-0.249986 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.9002673625946045
Epoch: 4, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.345 Vali Acc: 0.342 Test Loss: 1.345 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 0.9044744968414307
Epoch: 5, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.310 Vali Acc: 0.421 Test Loss: 1.310 Test Acc: 0.421
Validation loss decreased (-0.342092 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 0.947904109954834
Epoch: 6, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.277 Vali Acc: 0.487 Test Loss: 1.277 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486829).  Saving model ...
Epoch: 7 cost time: 0.8083460330963135
Epoch: 7, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.241 Vali Acc: 0.572 Test Loss: 1.241 Test Acc: 0.572
Validation loss decreased (-0.486829 --> -0.572356).  Saving model ...
Epoch: 8 cost time: 0.8541772365570068
Epoch: 8, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.206 Vali Acc: 0.599 Test Loss: 1.206 Test Acc: 0.599
Validation loss decreased (-0.572356 --> -0.598672).  Saving model ...
Epoch: 9 cost time: 0.7473928928375244
Epoch: 9, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.171 Vali Acc: 0.625 Test Loss: 1.171 Test Acc: 0.625
Validation loss decreased (-0.598672 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 0.7193987369537354
Epoch: 10, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.137 Vali Acc: 0.618 Test Loss: 1.137 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8883726596832275
Epoch: 11, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.103 Vali Acc: 0.638 Test Loss: 1.103 Test Acc: 0.638
Validation loss decreased (-0.624988 --> -0.638147).  Saving model ...
Epoch: 12 cost time: 0.7861537933349609
Epoch: 12, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.072 Vali Acc: 0.645 Test Loss: 1.072 Test Acc: 0.645
Validation loss decreased (-0.638147 --> -0.644726).  Saving model ...
Epoch: 13 cost time: 0.7659909725189209
Epoch: 13, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.040 Vali Acc: 0.651 Test Loss: 1.040 Test Acc: 0.651
Validation loss decreased (-0.644726 --> -0.651305).  Saving model ...
Epoch: 14 cost time: 0.7434489727020264
Epoch: 14, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.008 Vali Acc: 0.664 Test Loss: 1.008 Test Acc: 0.664
Validation loss decreased (-0.651305 --> -0.664464).  Saving model ...
Epoch: 15 cost time: 0.9012653827667236
Epoch: 15, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.979 Vali Acc: 0.678 Test Loss: 0.979 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677622).  Saving model ...
Epoch: 16 cost time: 0.8862857818603516
Epoch: 16, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.950 Vali Acc: 0.704 Test Loss: 0.950 Test Acc: 0.704
Validation loss decreased (-0.677622 --> -0.703938).  Saving model ...
Epoch: 17 cost time: 0.70326828956604
Epoch: 17, Steps: 10 | Train Loss: 0.704 Vali Loss: 0.924 Vali Acc: 0.704 Test Loss: 0.924 Test Acc: 0.704
Validation loss decreased (-0.703938 --> -0.703938).  Saving model ...
Epoch: 18 cost time: 0.8798069953918457
Epoch: 18, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.895 Vali Acc: 0.704 Test Loss: 0.895 Test Acc: 0.704
Validation loss decreased (-0.703938 --> -0.703938).  Saving model ...
Epoch: 19 cost time: 0.7906179428100586
Epoch: 19, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.866 Vali Acc: 0.717 Test Loss: 0.866 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717097).  Saving model ...
Epoch: 20 cost time: 0.7623260021209717
Epoch: 20, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717097).  Saving model ...
Epoch: 21 cost time: 0.869265079498291
Epoch: 21, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.818 Vali Acc: 0.717 Test Loss: 0.818 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717097).  Saving model ...
Epoch: 22 cost time: 0.7619280815124512
Epoch: 22, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.795 Vali Acc: 0.757 Test Loss: 0.795 Test Acc: 0.757
Validation loss decreased (-0.717097 --> -0.756571).  Saving model ...
Epoch: 23 cost time: 0.8468081951141357
Epoch: 23, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.773 Vali Acc: 0.757 Test Loss: 0.773 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756571).  Saving model ...
Epoch: 24 cost time: 0.9808580875396729
Epoch: 24, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.751 Vali Acc: 0.770 Test Loss: 0.751 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 25 cost time: 0.7923321723937988
Epoch: 25, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.729 Vali Acc: 0.776 Test Loss: 0.729 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776308).  Saving model ...
Epoch: 26 cost time: 0.7717115879058838
Epoch: 26, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782888).  Saving model ...
Epoch: 27 cost time: 0.760671854019165
Epoch: 27, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 28 cost time: 0.9087979793548584
Epoch: 28, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 29 cost time: 0.8637213706970215
Epoch: 29, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9599275588989258
Epoch: 30, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 31 cost time: 0.9775419235229492
Epoch: 31, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8514301776885986
Epoch: 32, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 33 cost time: 0.8703413009643555
Epoch: 33, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 34 cost time: 0.831965446472168
Epoch: 34, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 35 cost time: 0.7936558723449707
Epoch: 35, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9841749668121338
Epoch: 36, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8586101531982422
Epoch: 37, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 38 cost time: 0.7510638236999512
Epoch: 38, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 39 cost time: 0.8848960399627686
Epoch: 39, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.820866584777832
Epoch: 40, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9813613891601562
Epoch: 41, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8530004024505615
Epoch: 42, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8164315223693848
Epoch: 43, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8969056606292725
Epoch: 44, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7685918807983398
Epoch: 45, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.92047119140625
Epoch: 46, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 47 cost time: 1.0088515281677246
Epoch: 47, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8755073547363281
Epoch: 48, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0020546913146973
Epoch: 49, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8470666408538818
Epoch: 50, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8151299953460693
Epoch: 51, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6941273212432861
Epoch: 52, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7647316455841064
Epoch: 53, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8373937606811523
Epoch: 54, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8193356990814209
Epoch: 55, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.7406759262084961
Epoch: 56, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 33140
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1095337867736816
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.425 Vali Acc: 0.184 Test Loss: 1.425 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 0.7751462459564209
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.407 Vali Acc: 0.197 Test Loss: 1.407 Test Acc: 0.197
Validation loss decreased (-0.184196 --> -0.197354).  Saving model ...
Epoch: 3 cost time: 0.7954699993133545
Epoch: 3, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (-0.197354 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.648942232131958
Epoch: 4, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.355 Vali Acc: 0.289 Test Loss: 1.355 Test Acc: 0.289
Validation loss decreased (-0.249986 --> -0.289460).  Saving model ...
Epoch: 5 cost time: 0.8024868965148926
Epoch: 5, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.325 Vali Acc: 0.349 Test Loss: 1.325 Test Acc: 0.349
Validation loss decreased (-0.289460 --> -0.348671).  Saving model ...
Epoch: 6 cost time: 0.6523325443267822
Epoch: 6, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.295 Vali Acc: 0.454 Test Loss: 1.295 Test Acc: 0.454
Validation loss decreased (-0.348671 --> -0.453934).  Saving model ...
Epoch: 7 cost time: 0.7697088718414307
Epoch: 7, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.453934 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.6982250213623047
Epoch: 8, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.234 Vali Acc: 0.572 Test Loss: 1.234 Test Acc: 0.572
Validation loss decreased (-0.499987 --> -0.572356).  Saving model ...
Epoch: 9 cost time: 0.714806079864502
Epoch: 9, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.202 Vali Acc: 0.625 Test Loss: 1.202 Test Acc: 0.625
Validation loss decreased (-0.572356 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 0.6698553562164307
Epoch: 10, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.168 Vali Acc: 0.651 Test Loss: 1.168 Test Acc: 0.651
Validation loss decreased (-0.624988 --> -0.651304).  Saving model ...
Epoch: 11 cost time: 0.6851942539215088
Epoch: 11, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.136 Vali Acc: 0.678 Test Loss: 1.136 Test Acc: 0.678
Validation loss decreased (-0.651304 --> -0.677620).  Saving model ...
Epoch: 12 cost time: 0.6513514518737793
Epoch: 12, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.101 Vali Acc: 0.691 Test Loss: 1.101 Test Acc: 0.691
Validation loss decreased (-0.677620 --> -0.690778).  Saving model ...
Epoch: 13 cost time: 0.7009727954864502
Epoch: 13, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.065 Vali Acc: 0.691 Test Loss: 1.065 Test Acc: 0.691
Validation loss decreased (-0.690778 --> -0.690779).  Saving model ...
Epoch: 14 cost time: 0.6669590473175049
Epoch: 14, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.029 Vali Acc: 0.697 Test Loss: 1.029 Test Acc: 0.697
Validation loss decreased (-0.690779 --> -0.697358).  Saving model ...
Epoch: 15 cost time: 0.7174582481384277
Epoch: 15, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.997 Vali Acc: 0.697 Test Loss: 0.997 Test Acc: 0.697
Validation loss decreased (-0.697358 --> -0.697358).  Saving model ...
Epoch: 16 cost time: 0.7986593246459961
Epoch: 16, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.961 Vali Acc: 0.717 Test Loss: 0.961 Test Acc: 0.717
Validation loss decreased (-0.697358 --> -0.717096).  Saving model ...
Epoch: 17 cost time: 0.7068114280700684
Epoch: 17, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.923 Vali Acc: 0.730 Test Loss: 0.923 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730254).  Saving model ...
Epoch: 18 cost time: 0.6802732944488525
Epoch: 18, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.892 Vali Acc: 0.743 Test Loss: 0.892 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743412).  Saving model ...
Epoch: 19 cost time: 0.6618950366973877
Epoch: 19, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.861 Vali Acc: 0.743 Test Loss: 0.861 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743412).  Saving model ...
Epoch: 20 cost time: 0.6666440963745117
Epoch: 20, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.829 Vali Acc: 0.770 Test Loss: 0.829 Test Acc: 0.770
Validation loss decreased (-0.743412 --> -0.769729).  Saving model ...
Epoch: 21 cost time: 0.6763734817504883
Epoch: 21, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 22 cost time: 0.6617107391357422
Epoch: 22, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.766 Vali Acc: 0.803 Test Loss: 0.766 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802624).  Saving model ...
Epoch: 23 cost time: 0.8165855407714844
Epoch: 23, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.741 Vali Acc: 0.809 Test Loss: 0.741 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 24 cost time: 0.7296013832092285
Epoch: 24, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.809203 --> -0.822361).  Saving model ...
Epoch: 25 cost time: 0.6731548309326172
Epoch: 25, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5952959060668945
Epoch: 26, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6623568534851074
Epoch: 27, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6993775367736816
Epoch: 28, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
Validation loss decreased (-0.822361 --> -0.822362).  Saving model ...
Epoch: 29 cost time: 0.7316675186157227
Epoch: 29, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822362).  Saving model ...
Epoch: 30 cost time: 0.7446517944335938
Epoch: 30, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.598 Vali Acc: 0.836 Test Loss: 0.598 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 31 cost time: 0.7082920074462891
Epoch: 31, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.582 Vali Acc: 0.836 Test Loss: 0.582 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835520).  Saving model ...
Epoch: 32 cost time: 0.743272066116333
Epoch: 32, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.576 Vali Acc: 0.836 Test Loss: 0.576 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835521).  Saving model ...
Epoch: 33 cost time: 0.7722277641296387
Epoch: 33, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.573 Vali Acc: 0.829 Test Loss: 0.573 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7910325527191162
Epoch: 34, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.564 Vali Acc: 0.829 Test Loss: 0.564 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.787020206451416
Epoch: 35, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.555 Vali Acc: 0.829 Test Loss: 0.555 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7025554180145264
Epoch: 36, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.545 Vali Acc: 0.829 Test Loss: 0.545 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5617167949676514
Epoch: 37, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.542 Vali Acc: 0.829 Test Loss: 0.542 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6692817211151123
Epoch: 38, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.536 Vali Acc: 0.836 Test Loss: 0.536 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 39 cost time: 0.5914907455444336
Epoch: 39, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.530 Vali Acc: 0.836 Test Loss: 0.530 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 40 cost time: 0.6989507675170898
Epoch: 40, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.528 Vali Acc: 0.836 Test Loss: 0.528 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 41 cost time: 0.6349260807037354
Epoch: 41, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.525 Vali Acc: 0.842 Test Loss: 0.525 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 42 cost time: 0.8521904945373535
Epoch: 42, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.520 Vali Acc: 0.842 Test Loss: 0.520 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 43 cost time: 0.6232869625091553
Epoch: 43, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.521 Vali Acc: 0.829 Test Loss: 0.521 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.756887674331665
Epoch: 44, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6574182510375977
Epoch: 45, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.512 Vali Acc: 0.829 Test Loss: 0.512 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.699455976486206
Epoch: 46, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.512 Vali Acc: 0.836 Test Loss: 0.512 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6633682250976562
Epoch: 47, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7409906387329102
Epoch: 48, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7733969688415527
Epoch: 49, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.512 Vali Acc: 0.829 Test Loss: 0.512 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7264049053192139
Epoch: 50, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.743401050567627
Epoch: 51, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.836 Test Loss: 0.507 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7235643863677979
Epoch: 52, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 32628
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.9757375717163086
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.419 Vali Acc: 0.316 Test Loss: 1.419 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 0.7116575241088867
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.397 Vali Acc: 0.336 Test Loss: 1.397 Test Acc: 0.336
Validation loss decreased (-0.315775 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 0.6376991271972656
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.369 Vali Acc: 0.355 Test Loss: 1.369 Test Acc: 0.355
Validation loss decreased (-0.335512 --> -0.355249).  Saving model ...
Epoch: 4 cost time: 0.5877225399017334
Epoch: 4, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.336 Vali Acc: 0.382 Test Loss: 1.336 Test Acc: 0.382
Validation loss decreased (-0.355249 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 0.5707962512969971
Epoch: 5, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.302 Vali Acc: 0.428 Test Loss: 1.302 Test Acc: 0.428
Validation loss decreased (-0.381566 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 0.5907402038574219
Epoch: 6, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.268 Vali Acc: 0.447 Test Loss: 1.268 Test Acc: 0.447
Validation loss decreased (-0.427619 --> -0.447356).  Saving model ...
Epoch: 7 cost time: 0.6421983242034912
Epoch: 7, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.229 Vali Acc: 0.461 Test Loss: 1.229 Test Acc: 0.461
Validation loss decreased (-0.447356 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 0.9590096473693848
Epoch: 8, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.189 Vali Acc: 0.546 Test Loss: 1.189 Test Acc: 0.546
Validation loss decreased (-0.460514 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 0.6532230377197266
Epoch: 9, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.148 Vali Acc: 0.566 Test Loss: 1.148 Test Acc: 0.566
Validation loss decreased (-0.546041 --> -0.565778).  Saving model ...
Epoch: 10 cost time: 0.5595901012420654
Epoch: 10, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.109 Vali Acc: 0.586 Test Loss: 1.109 Test Acc: 0.586
Validation loss decreased (-0.565778 --> -0.585515).  Saving model ...
Epoch: 11 cost time: 0.7154088020324707
Epoch: 11, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.070 Vali Acc: 0.618 Test Loss: 1.070 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618410).  Saving model ...
Epoch: 12 cost time: 0.7475769519805908
Epoch: 12, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.618410 --> -0.677621).  Saving model ...
Epoch: 13 cost time: 0.7478950023651123
Epoch: 13, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.993 Vali Acc: 0.697 Test Loss: 0.993 Test Acc: 0.697
Validation loss decreased (-0.677621 --> -0.697358).  Saving model ...
Epoch: 14 cost time: 0.6763699054718018
Epoch: 14, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
Validation loss decreased (-0.697358 --> -0.717096).  Saving model ...
Epoch: 15 cost time: 0.6349523067474365
Epoch: 15, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.916 Vali Acc: 0.724 Test Loss: 0.916 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 16 cost time: 0.5972304344177246
Epoch: 16, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.877 Vali Acc: 0.730 Test Loss: 0.877 Test Acc: 0.730
Validation loss decreased (-0.723675 --> -0.730254).  Saving model ...
Epoch: 17 cost time: 0.6498005390167236
Epoch: 17, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.840 Vali Acc: 0.730 Test Loss: 0.840 Test Acc: 0.730
Validation loss decreased (-0.730254 --> -0.730255).  Saving model ...
Epoch: 18 cost time: 0.7025759220123291
Epoch: 18, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.805 Vali Acc: 0.743 Test Loss: 0.805 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 19 cost time: 0.698103666305542
Epoch: 19, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.773 Vali Acc: 0.763 Test Loss: 0.773 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 20 cost time: 0.6174254417419434
Epoch: 20, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.743 Vali Acc: 0.770 Test Loss: 0.743 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 21 cost time: 0.7748315334320068
Epoch: 21, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 0.7043087482452393
Epoch: 22, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 23 cost time: 0.6916956901550293
Epoch: 23, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 0.7224328517913818
Epoch: 24, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 0.8254177570343018
Epoch: 25, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.636 Vali Acc: 0.776 Test Loss: 0.636 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7697882652282715
Epoch: 26, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 0.6769437789916992
Epoch: 27, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7223539352416992
Epoch: 28, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7042977809906006
Epoch: 29, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 0.6876218318939209
Epoch: 30, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 31 cost time: 0.6117186546325684
Epoch: 31, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 32 cost time: 0.620858907699585
Epoch: 32, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 33 cost time: 0.6371493339538574
Epoch: 33, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 34 cost time: 0.6953997611999512
Epoch: 34, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6990292072296143
Epoch: 35, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 0.7019529342651367
Epoch: 36, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7573821544647217
Epoch: 37, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.697922945022583
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.592545747756958
Epoch: 39, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7047102451324463
Epoch: 40, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5781464576721191
Epoch: 41, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7098760604858398
Epoch: 42, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 43 cost time: 0.6828289031982422
Epoch: 43, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 44 cost time: 0.6207408905029297
Epoch: 44, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6703121662139893
Epoch: 45, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5896844863891602
Epoch: 46, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6656208038330078
Epoch: 47, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6313521862030029
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.606320858001709
Epoch: 49, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6372196674346924
Epoch: 50, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6125657558441162
Epoch: 51, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6770820617675781
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5875449180603027
Epoch: 53, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 32116
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1732189655303955
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.419 Vali Acc: 0.316 Test Loss: 1.419 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 0.81184983253479
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.397 Vali Acc: 0.336 Test Loss: 1.397 Test Acc: 0.336
Validation loss decreased (-0.315775 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 0.6199166774749756
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.369 Vali Acc: 0.355 Test Loss: 1.369 Test Acc: 0.355
Validation loss decreased (-0.335512 --> -0.355249).  Saving model ...
Epoch: 4 cost time: 0.6358945369720459
Epoch: 4, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.336 Vali Acc: 0.382 Test Loss: 1.336 Test Acc: 0.382
Validation loss decreased (-0.355249 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 0.5863473415374756
Epoch: 5, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.302 Vali Acc: 0.428 Test Loss: 1.302 Test Acc: 0.428
Validation loss decreased (-0.381566 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 0.5405867099761963
Epoch: 6, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.268 Vali Acc: 0.447 Test Loss: 1.268 Test Acc: 0.447
Validation loss decreased (-0.427619 --> -0.447356).  Saving model ...
Epoch: 7 cost time: 0.7109053134918213
Epoch: 7, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.229 Vali Acc: 0.461 Test Loss: 1.229 Test Acc: 0.461
Validation loss decreased (-0.447356 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 0.6446075439453125
Epoch: 8, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.189 Vali Acc: 0.546 Test Loss: 1.189 Test Acc: 0.546
Validation loss decreased (-0.460514 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 0.6474535465240479
Epoch: 9, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.148 Vali Acc: 0.566 Test Loss: 1.148 Test Acc: 0.566
Validation loss decreased (-0.546041 --> -0.565778).  Saving model ...
Epoch: 10 cost time: 0.6570112705230713
Epoch: 10, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.109 Vali Acc: 0.586 Test Loss: 1.109 Test Acc: 0.586
Validation loss decreased (-0.565778 --> -0.585515).  Saving model ...
Epoch: 11 cost time: 0.7442872524261475
Epoch: 11, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.070 Vali Acc: 0.618 Test Loss: 1.070 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618410).  Saving model ...
Epoch: 12 cost time: 0.6774466037750244
Epoch: 12, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.618410 --> -0.677621).  Saving model ...
Epoch: 13 cost time: 0.6221370697021484
Epoch: 13, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.993 Vali Acc: 0.697 Test Loss: 0.993 Test Acc: 0.697
Validation loss decreased (-0.677621 --> -0.697358).  Saving model ...
Epoch: 14 cost time: 0.7580852508544922
Epoch: 14, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
Validation loss decreased (-0.697358 --> -0.717096).  Saving model ...
Epoch: 15 cost time: 0.5823125839233398
Epoch: 15, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.916 Vali Acc: 0.724 Test Loss: 0.916 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 16 cost time: 0.6688649654388428
Epoch: 16, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.877 Vali Acc: 0.730 Test Loss: 0.877 Test Acc: 0.730
Validation loss decreased (-0.723675 --> -0.730254).  Saving model ...
Epoch: 17 cost time: 0.5768561363220215
Epoch: 17, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.840 Vali Acc: 0.730 Test Loss: 0.840 Test Acc: 0.730
Validation loss decreased (-0.730254 --> -0.730255).  Saving model ...
Epoch: 18 cost time: 0.7978646755218506
Epoch: 18, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.805 Vali Acc: 0.743 Test Loss: 0.805 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 19 cost time: 0.6260714530944824
Epoch: 19, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.773 Vali Acc: 0.763 Test Loss: 0.773 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 20 cost time: 0.668297290802002
Epoch: 20, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.743 Vali Acc: 0.770 Test Loss: 0.743 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 21 cost time: 0.7044751644134521
Epoch: 21, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 0.6828179359436035
Epoch: 22, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 23 cost time: 0.6653642654418945
Epoch: 23, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 0.6945927143096924
Epoch: 24, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 0.7476189136505127
Epoch: 25, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.636 Vali Acc: 0.776 Test Loss: 0.636 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5986151695251465
Epoch: 26, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 0.7256813049316406
Epoch: 27, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6279385089874268
Epoch: 28, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7536270618438721
Epoch: 29, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 0.6130445003509521
Epoch: 30, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 31 cost time: 0.7751035690307617
Epoch: 31, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 32 cost time: 0.6634910106658936
Epoch: 32, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 33 cost time: 0.6028380393981934
Epoch: 33, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 34 cost time: 0.619281530380249
Epoch: 34, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.651648998260498
Epoch: 35, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 0.5481352806091309
Epoch: 36, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7284197807312012
Epoch: 37, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6497435569763184
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.619196891784668
Epoch: 39, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6685717105865479
Epoch: 40, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6607306003570557
Epoch: 41, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6185848712921143
Epoch: 42, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 43 cost time: 0.585986852645874
Epoch: 43, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 44 cost time: 0.582625150680542
Epoch: 44, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5567927360534668
Epoch: 45, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6249873638153076
Epoch: 46, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6192560195922852
Epoch: 47, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6041855812072754
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6090912818908691
Epoch: 49, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5685837268829346
Epoch: 50, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7700624465942383
Epoch: 51, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6621198654174805
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.7782254219055176
Epoch: 53, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 32116
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.045839309692383
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.447 Vali Acc: 0.263 Test Loss: 1.447 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 0.7028865814208984
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.403 Vali Acc: 0.289 Test Loss: 1.403 Test Acc: 0.289
Validation loss decreased (-0.263143 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.7693841457366943
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.345 Vali Acc: 0.322 Test Loss: 1.345 Test Acc: 0.322
Validation loss decreased (-0.289460 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 0.6484987735748291
Epoch: 4, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.287 Vali Acc: 0.401 Test Loss: 1.287 Test Acc: 0.401
Validation loss decreased (-0.322355 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 0.8033676147460938
Epoch: 5, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.228 Vali Acc: 0.434 Test Loss: 1.228 Test Acc: 0.434
Validation loss decreased (-0.401303 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 0.9113245010375977
Epoch: 6, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.178 Vali Acc: 0.487 Test Loss: 1.178 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 7 cost time: 0.6678028106689453
Epoch: 7, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.122 Vali Acc: 0.553 Test Loss: 1.122 Test Acc: 0.553
Validation loss decreased (-0.486830 --> -0.552620).  Saving model ...
Epoch: 8 cost time: 0.8389122486114502
Epoch: 8, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.069 Vali Acc: 0.612 Test Loss: 1.069 Test Acc: 0.612
Validation loss decreased (-0.552620 --> -0.611831).  Saving model ...
Epoch: 9 cost time: 0.7165396213531494
Epoch: 9, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.026 Vali Acc: 0.625 Test Loss: 1.026 Test Acc: 0.625
Validation loss decreased (-0.611831 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.7631175518035889
Epoch: 10, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.989 Vali Acc: 0.671 Test Loss: 0.989 Test Acc: 0.671
Validation loss decreased (-0.624990 --> -0.671043).  Saving model ...
Epoch: 11 cost time: 0.7002253532409668
Epoch: 11, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.955 Vali Acc: 0.664 Test Loss: 0.955 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7439327239990234
Epoch: 12, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.923 Vali Acc: 0.678 Test Loss: 0.923 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677622).  Saving model ...
Epoch: 13 cost time: 0.6870312690734863
Epoch: 13, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.891 Vali Acc: 0.711 Test Loss: 0.891 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710517).  Saving model ...
Epoch: 14 cost time: 0.6255702972412109
Epoch: 14, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.866 Vali Acc: 0.711 Test Loss: 0.866 Test Acc: 0.711
Validation loss decreased (-0.710517 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 0.7646291255950928
Epoch: 15, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717097).  Saving model ...
Epoch: 16 cost time: 0.6252443790435791
Epoch: 16, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.825 Vali Acc: 0.724 Test Loss: 0.825 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723676).  Saving model ...
Epoch: 17 cost time: 0.756505012512207
Epoch: 17, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.792 Vali Acc: 0.730 Test Loss: 0.792 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 18 cost time: 0.8569381237030029
Epoch: 18, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.776 Vali Acc: 0.717 Test Loss: 0.776 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7888851165771484
Epoch: 19, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.753 Vali Acc: 0.757 Test Loss: 0.753 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756571).  Saving model ...
Epoch: 20 cost time: 0.838341236114502
Epoch: 20, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782887).  Saving model ...
Epoch: 21 cost time: 0.7549607753753662
Epoch: 21, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.708 Vali Acc: 0.789 Test Loss: 0.708 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 0.7368106842041016
Epoch: 22, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.702 Vali Acc: 0.770 Test Loss: 0.702 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6391983032226562
Epoch: 23, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 24 cost time: 0.7416200637817383
Epoch: 24, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.792917013168335
Epoch: 25, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8764927387237549
Epoch: 26, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8122992515563965
Epoch: 27, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7818381786346436
Epoch: 28, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7036879062652588
Epoch: 29, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 0.6555147171020508
Epoch: 30, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 31 cost time: 0.7445368766784668
Epoch: 31, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8093092441558838
Epoch: 32, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.726515531539917
Epoch: 33, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7973272800445557
Epoch: 34, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7721176147460938
Epoch: 35, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8964951038360596
Epoch: 36, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6623296737670898
Epoch: 37, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9814069271087646
Epoch: 38, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8093538284301758
Epoch: 39, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7145872116088867
Epoch: 40, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 33588
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5960991382598877
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.383 Vali Acc: 0.316 Test Loss: 1.383 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.8679933547973633
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.333 Vali Acc: 0.368 Test Loss: 1.333 Test Acc: 0.368
Validation loss decreased (-0.315776 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 0.8908798694610596
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.270 Vali Acc: 0.447 Test Loss: 1.270 Test Acc: 0.447
Validation loss decreased (-0.368408 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 0.6520977020263672
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.205 Vali Acc: 0.520 Test Loss: 1.205 Test Acc: 0.520
Validation loss decreased (-0.447356 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 0.7211840152740479
Epoch: 5, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.140 Vali Acc: 0.605 Test Loss: 1.140 Test Acc: 0.605
Validation loss decreased (-0.519725 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 0.8016018867492676
Epoch: 6, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.081 Vali Acc: 0.671 Test Loss: 1.081 Test Acc: 0.671
Validation loss decreased (-0.605252 --> -0.671042).  Saving model ...
Epoch: 7 cost time: 0.8618223667144775
Epoch: 7, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.028 Vali Acc: 0.717 Test Loss: 1.028 Test Acc: 0.717
Validation loss decreased (-0.671042 --> -0.717095).  Saving model ...
Epoch: 8 cost time: 0.8531322479248047
Epoch: 8, Steps: 10 | Train Loss: 0.797 Vali Loss: 0.981 Vali Acc: 0.737 Test Loss: 0.981 Test Acc: 0.737
Validation loss decreased (-0.717095 --> -0.736832).  Saving model ...
Epoch: 9 cost time: 0.9733679294586182
Epoch: 9, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.939 Vali Acc: 0.737 Test Loss: 0.939 Test Acc: 0.737
Validation loss decreased (-0.736832 --> -0.736833).  Saving model ...
Epoch: 10 cost time: 0.8587546348571777
Epoch: 10, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.911 Vali Acc: 0.737 Test Loss: 0.911 Test Acc: 0.737
Validation loss decreased (-0.736833 --> -0.736833).  Saving model ...
Epoch: 11 cost time: 0.7047421932220459
Epoch: 11, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.879 Vali Acc: 0.743 Test Loss: 0.879 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743412).  Saving model ...
Epoch: 12 cost time: 0.8529260158538818
Epoch: 12, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
Validation loss decreased (-0.743412 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.701723575592041
Epoch: 13, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.825 Vali Acc: 0.770 Test Loss: 0.825 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769729).  Saving model ...
Epoch: 14 cost time: 0.7864630222320557
Epoch: 14, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.802 Vali Acc: 0.783 Test Loss: 0.802 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782887).  Saving model ...
Epoch: 15 cost time: 0.9362938404083252
Epoch: 15, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782887).  Saving model ...
Epoch: 16 cost time: 0.8006737232208252
Epoch: 16, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.758 Vali Acc: 0.776 Test Loss: 0.758 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8281497955322266
Epoch: 17, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.740 Vali Acc: 0.770 Test Loss: 0.740 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5893104076385498
Epoch: 18, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.720 Vali Acc: 0.776 Test Loss: 0.720 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.718170166015625
Epoch: 19, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 0.6777737140655518
Epoch: 20, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.681 Vali Acc: 0.776 Test Loss: 0.681 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7664358615875244
Epoch: 21, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.671 Vali Acc: 0.776 Test Loss: 0.671 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9821438789367676
Epoch: 22, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7295007705688477
Epoch: 23, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.657 Vali Acc: 0.770 Test Loss: 0.657 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7448458671569824
Epoch: 24, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.660 Vali Acc: 0.763 Test Loss: 0.660 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7319738864898682
Epoch: 25, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.644 Vali Acc: 0.770 Test Loss: 0.644 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.766796350479126
Epoch: 26, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7598962783813477
Epoch: 27, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6766679286956787
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.608 Vali Acc: 0.776 Test Loss: 0.608 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.724992036819458
Epoch: 29, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 33076
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0767035484313965
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.469 Vali Acc: 0.243 Test Loss: 1.469 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 0.6297283172607422
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (-0.243406 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 0.6024389266967773
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.350 Vali Acc: 0.309 Test Loss: 1.350 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 0.6270301342010498
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.279 Vali Acc: 0.382 Test Loss: 1.279 Test Acc: 0.382
Validation loss decreased (-0.309197 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 0.7374775409698486
Epoch: 5, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.206 Vali Acc: 0.493 Test Loss: 1.206 Test Acc: 0.493
Validation loss decreased (-0.381566 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 0.8963627815246582
Epoch: 6, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.135 Vali Acc: 0.553 Test Loss: 1.135 Test Acc: 0.553
Validation loss decreased (-0.493409 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 0.6379091739654541
Epoch: 7, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.071 Vali Acc: 0.605 Test Loss: 1.071 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605252).  Saving model ...
Epoch: 8 cost time: 0.6934819221496582
Epoch: 8, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.020 Vali Acc: 0.645 Test Loss: 1.020 Test Acc: 0.645
Validation loss decreased (-0.605252 --> -0.644727).  Saving model ...
Epoch: 9 cost time: 0.614032506942749
Epoch: 9, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.976 Vali Acc: 0.658 Test Loss: 0.976 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657885).  Saving model ...
Epoch: 10 cost time: 0.6894145011901855
Epoch: 10, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.938 Vali Acc: 0.664 Test Loss: 0.938 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664464).  Saving model ...
Epoch: 11 cost time: 0.673630952835083
Epoch: 11, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.901 Vali Acc: 0.664 Test Loss: 0.901 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664465).  Saving model ...
Epoch: 12 cost time: 0.6597750186920166
Epoch: 12, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.866 Vali Acc: 0.697 Test Loss: 0.866 Test Acc: 0.697
Validation loss decreased (-0.664465 --> -0.697360).  Saving model ...
Epoch: 13 cost time: 0.6761021614074707
Epoch: 13, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.837 Vali Acc: 0.724 Test Loss: 0.837 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723676).  Saving model ...
Epoch: 14 cost time: 0.7636532783508301
Epoch: 14, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.812 Vali Acc: 0.717 Test Loss: 0.812 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5891232490539551
Epoch: 15, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.577481746673584
Epoch: 16, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.756 Vali Acc: 0.730 Test Loss: 0.756 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 17 cost time: 0.6546900272369385
Epoch: 17, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.739 Vali Acc: 0.757 Test Loss: 0.739 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 18 cost time: 0.5956666469573975
Epoch: 18, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7561841011047363
Epoch: 19, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.702 Vali Acc: 0.743 Test Loss: 0.702 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6873197555541992
Epoch: 20, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7283329963684082
Epoch: 21, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.664 Vali Acc: 0.770 Test Loss: 0.664 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 22 cost time: 0.7592573165893555
Epoch: 22, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 23 cost time: 0.7934520244598389
Epoch: 23, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 0.7723839282989502
Epoch: 24, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.620 Vali Acc: 0.770 Test Loss: 0.620 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7009141445159912
Epoch: 25, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7600841522216797
Epoch: 26, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8344762325286865
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6956052780151367
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6823732852935791
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 0.6821372509002686
Epoch: 30, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6752414703369141
Epoch: 31, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6456665992736816
Epoch: 32, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 33 cost time: 0.7012372016906738
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 34 cost time: 0.6842374801635742
Epoch: 34, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 35 cost time: 0.6556797027587891
Epoch: 35, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6253619194030762
Epoch: 36, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6486587524414062
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 38 cost time: 0.6323049068450928
Epoch: 38, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 39 cost time: 0.5620887279510498
Epoch: 39, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6609699726104736
Epoch: 40, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5670621395111084
Epoch: 41, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 42 cost time: 0.6969723701477051
Epoch: 42, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6428711414337158
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7052416801452637
Epoch: 44, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 45 cost time: 0.6628358364105225
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 46 cost time: 0.705951452255249
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7424015998840332
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6907284259796143
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5977621078491211
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6164672374725342
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6677062511444092
Epoch: 51, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6627681255340576
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.7535302639007568
Epoch: 53, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6515960693359375
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.6780128479003906
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 32564
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.359647274017334
Epoch: 1, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.511 Vali Acc: 0.224 Test Loss: 1.511 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 0.8810946941375732
Epoch: 2, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.460 Vali Acc: 0.257 Test Loss: 1.460 Test Acc: 0.257
Validation loss decreased (-0.223669 --> -0.256564).  Saving model ...
Epoch: 3 cost time: 0.6137933731079102
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.385 Vali Acc: 0.316 Test Loss: 1.385 Test Acc: 0.316
Validation loss decreased (-0.256564 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 0.7124745845794678
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.309 Vali Acc: 0.414 Test Loss: 1.309 Test Acc: 0.414
Validation loss decreased (-0.315776 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 0.6304876804351807
Epoch: 5, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.233 Vali Acc: 0.467 Test Loss: 1.233 Test Acc: 0.467
Validation loss decreased (-0.414461 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 0.7123994827270508
Epoch: 6, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.158 Vali Acc: 0.566 Test Loss: 1.158 Test Acc: 0.566
Validation loss decreased (-0.467093 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 0.7559807300567627
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.097 Vali Acc: 0.618 Test Loss: 1.097 Test Acc: 0.618
Validation loss decreased (-0.565778 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 0.7684206962585449
Epoch: 8, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.045 Vali Acc: 0.664 Test Loss: 1.045 Test Acc: 0.664
Validation loss decreased (-0.618410 --> -0.664463).  Saving model ...
Epoch: 9 cost time: 0.6969246864318848
Epoch: 9, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.998 Vali Acc: 0.664 Test Loss: 0.998 Test Acc: 0.664
Validation loss decreased (-0.664463 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 0.7081372737884521
Epoch: 10, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.957 Vali Acc: 0.711 Test Loss: 0.957 Test Acc: 0.711
Validation loss decreased (-0.664464 --> -0.710517).  Saving model ...
Epoch: 11 cost time: 0.8764252662658691
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.913 Vali Acc: 0.717 Test Loss: 0.913 Test Acc: 0.717
Validation loss decreased (-0.710517 --> -0.717096).  Saving model ...
Epoch: 12 cost time: 0.738933801651001
Epoch: 12, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.881 Vali Acc: 0.730 Test Loss: 0.881 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730254).  Saving model ...
Epoch: 13 cost time: 0.7998349666595459
Epoch: 13, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.856 Vali Acc: 0.737 Test Loss: 0.856 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 14 cost time: 0.617473840713501
Epoch: 14, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.829 Vali Acc: 0.743 Test Loss: 0.829 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 15 cost time: 0.7050623893737793
Epoch: 15, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.799 Vali Acc: 0.763 Test Loss: 0.799 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 16 cost time: 0.7755467891693115
Epoch: 16, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8258476257324219
Epoch: 17, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 18 cost time: 0.6188464164733887
Epoch: 18, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.736 Vali Acc: 0.763 Test Loss: 0.736 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 19 cost time: 0.6392552852630615
Epoch: 19, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.721 Vali Acc: 0.763 Test Loss: 0.721 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 20 cost time: 0.598867654800415
Epoch: 20, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 0.7555227279663086
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 22 cost time: 0.6750223636627197
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.679 Vali Acc: 0.757 Test Loss: 0.679 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6598641872406006
Epoch: 23, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.667 Vali Acc: 0.763 Test Loss: 0.667 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 0.6631834506988525
Epoch: 24, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 25 cost time: 0.7216000556945801
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.657 Vali Acc: 0.770 Test Loss: 0.657 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 0.6881434917449951
Epoch: 26, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 27 cost time: 0.7533385753631592
Epoch: 27, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 28 cost time: 0.7368359565734863
Epoch: 28, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.639 Vali Acc: 0.757 Test Loss: 0.639 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7096116542816162
Epoch: 29, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 30 cost time: 0.6849048137664795
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.633 Vali Acc: 0.783 Test Loss: 0.633 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7454004287719727
Epoch: 31, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 32 cost time: 0.6438372135162354
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.629 Vali Acc: 0.776 Test Loss: 0.629 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.708432674407959
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5761702060699463
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6189572811126709
Epoch: 35, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6485755443572998
Epoch: 36, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6069633960723877
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.660369873046875
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5988173484802246
Epoch: 39, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7282462120056152
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7605612277984619
Epoch: 41, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 32052
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3404853343963623
Epoch: 1, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.511 Vali Acc: 0.224 Test Loss: 1.511 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 0.6711914539337158
Epoch: 2, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.460 Vali Acc: 0.257 Test Loss: 1.460 Test Acc: 0.257
Validation loss decreased (-0.223669 --> -0.256564).  Saving model ...
Epoch: 3 cost time: 0.7161664962768555
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.385 Vali Acc: 0.316 Test Loss: 1.385 Test Acc: 0.316
Validation loss decreased (-0.256564 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 0.6513473987579346
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.309 Vali Acc: 0.414 Test Loss: 1.309 Test Acc: 0.414
Validation loss decreased (-0.315776 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 0.5583276748657227
Epoch: 5, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.233 Vali Acc: 0.467 Test Loss: 1.233 Test Acc: 0.467
Validation loss decreased (-0.414461 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 0.5720729827880859
Epoch: 6, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.158 Vali Acc: 0.566 Test Loss: 1.158 Test Acc: 0.566
Validation loss decreased (-0.467093 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 0.6572394371032715
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.097 Vali Acc: 0.618 Test Loss: 1.097 Test Acc: 0.618
Validation loss decreased (-0.565778 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 0.7204759120941162
Epoch: 8, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.045 Vali Acc: 0.664 Test Loss: 1.045 Test Acc: 0.664
Validation loss decreased (-0.618410 --> -0.664463).  Saving model ...
Epoch: 9 cost time: 0.6452250480651855
Epoch: 9, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.998 Vali Acc: 0.664 Test Loss: 0.998 Test Acc: 0.664
Validation loss decreased (-0.664463 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 0.8655009269714355
Epoch: 10, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.957 Vali Acc: 0.711 Test Loss: 0.957 Test Acc: 0.711
Validation loss decreased (-0.664464 --> -0.710517).  Saving model ...
Epoch: 11 cost time: 0.7561008930206299
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.913 Vali Acc: 0.717 Test Loss: 0.913 Test Acc: 0.717
Validation loss decreased (-0.710517 --> -0.717096).  Saving model ...
Epoch: 12 cost time: 0.7490744590759277
Epoch: 12, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.881 Vali Acc: 0.730 Test Loss: 0.881 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730254).  Saving model ...
Epoch: 13 cost time: 0.5918381214141846
Epoch: 13, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.856 Vali Acc: 0.737 Test Loss: 0.856 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 14 cost time: 0.5906989574432373
Epoch: 14, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.829 Vali Acc: 0.743 Test Loss: 0.829 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 15 cost time: 0.6177101135253906
Epoch: 15, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.799 Vali Acc: 0.763 Test Loss: 0.799 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 16 cost time: 0.7109918594360352
Epoch: 16, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6552209854125977
Epoch: 17, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 18 cost time: 0.7863743305206299
Epoch: 18, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.736 Vali Acc: 0.763 Test Loss: 0.736 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 19 cost time: 0.6355671882629395
Epoch: 19, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.721 Vali Acc: 0.763 Test Loss: 0.721 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 20 cost time: 0.5926694869995117
Epoch: 20, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 21 cost time: 0.5658974647521973
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 22 cost time: 0.6186971664428711
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.679 Vali Acc: 0.757 Test Loss: 0.679 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5263161659240723
Epoch: 23, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.667 Vali Acc: 0.763 Test Loss: 0.667 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 0.6879560947418213
Epoch: 24, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 25 cost time: 0.6842992305755615
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.657 Vali Acc: 0.770 Test Loss: 0.657 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 0.6168537139892578
Epoch: 26, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 27 cost time: 0.5661063194274902
Epoch: 27, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 28 cost time: 0.6668298244476318
Epoch: 28, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.639 Vali Acc: 0.757 Test Loss: 0.639 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6372318267822266
Epoch: 29, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 30 cost time: 0.6283318996429443
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.633 Vali Acc: 0.783 Test Loss: 0.633 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5687587261199951
Epoch: 31, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 32 cost time: 0.6998336315155029
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.629 Vali Acc: 0.776 Test Loss: 0.629 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5679008960723877
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6682472229003906
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5692763328552246
Epoch: 35, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6923666000366211
Epoch: 36, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.695249080657959
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7197296619415283
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6656038761138916
Epoch: 39, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8305315971374512
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7840163707733154
Epoch: 41, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 32052
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.646148204803467
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.434 Vali Acc: 0.322 Test Loss: 1.434 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 0.8389523029327393
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.419 Vali Acc: 0.322 Test Loss: 1.419 Test Acc: 0.322
Validation loss decreased (-0.322354 --> -0.322354).  Saving model ...
Epoch: 3 cost time: 0.9761490821838379
Epoch: 3, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.399 Vali Acc: 0.349 Test Loss: 1.399 Test Acc: 0.349
Validation loss decreased (-0.322354 --> -0.348670).  Saving model ...
Epoch: 4 cost time: 0.9427993297576904
Epoch: 4, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.375 Vali Acc: 0.375 Test Loss: 1.375 Test Acc: 0.375
Validation loss decreased (-0.348670 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.8034267425537109
Epoch: 5, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.348 Vali Acc: 0.414 Test Loss: 1.348 Test Acc: 0.414
Validation loss decreased (-0.374986 --> -0.414460).  Saving model ...
Epoch: 6 cost time: 0.7179484367370605
Epoch: 6, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.319 Vali Acc: 0.461 Test Loss: 1.319 Test Acc: 0.461
Validation loss decreased (-0.414460 --> -0.460513).  Saving model ...
Epoch: 7 cost time: 0.9200911521911621
Epoch: 7, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.289 Vali Acc: 0.507 Test Loss: 1.289 Test Acc: 0.507
Validation loss decreased (-0.460513 --> -0.506566).  Saving model ...
Epoch: 8 cost time: 0.827368974685669
Epoch: 8, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.259 Vali Acc: 0.546 Test Loss: 1.259 Test Acc: 0.546
Validation loss decreased (-0.506566 --> -0.546040).  Saving model ...
Epoch: 9 cost time: 0.7563331127166748
Epoch: 9, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.229 Vali Acc: 0.572 Test Loss: 1.229 Test Acc: 0.572
Validation loss decreased (-0.546040 --> -0.572356).  Saving model ...
Epoch: 10 cost time: 0.8180887699127197
Epoch: 10, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.198 Vali Acc: 0.592 Test Loss: 1.198 Test Acc: 0.592
Validation loss decreased (-0.572356 --> -0.592093).  Saving model ...
Epoch: 11 cost time: 0.9112606048583984
Epoch: 11, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.166 Vali Acc: 0.599 Test Loss: 1.166 Test Acc: 0.599
Validation loss decreased (-0.592093 --> -0.598673).  Saving model ...
Epoch: 12 cost time: 0.9274077415466309
Epoch: 12, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.133 Vali Acc: 0.618 Test Loss: 1.133 Test Acc: 0.618
Validation loss decreased (-0.598673 --> -0.618410).  Saving model ...
Epoch: 13 cost time: 1.0860180854797363
Epoch: 13, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.098 Vali Acc: 0.618 Test Loss: 1.098 Test Acc: 0.618
Validation loss decreased (-0.618410 --> -0.618410).  Saving model ...
Epoch: 14 cost time: 0.9477710723876953
Epoch: 14, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.618410 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.9850921630859375
Epoch: 15, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.037 Vali Acc: 0.664 Test Loss: 1.037 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664463).  Saving model ...
Epoch: 16 cost time: 0.8281404972076416
Epoch: 16, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.007 Vali Acc: 0.684 Test Loss: 1.007 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684200).  Saving model ...
Epoch: 17 cost time: 0.8536968231201172
Epoch: 17, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.978 Vali Acc: 0.684 Test Loss: 0.978 Test Acc: 0.684
Validation loss decreased (-0.684200 --> -0.684201).  Saving model ...
Epoch: 18 cost time: 0.7688841819763184
Epoch: 18, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.950 Vali Acc: 0.684 Test Loss: 0.950 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684201).  Saving model ...
Epoch: 19 cost time: 0.6945071220397949
Epoch: 19, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.923 Vali Acc: 0.697 Test Loss: 0.923 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697359).  Saving model ...
Epoch: 20 cost time: 0.9596810340881348
Epoch: 20, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.895 Vali Acc: 0.704 Test Loss: 0.895 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 21 cost time: 0.7791016101837158
Epoch: 21, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.866 Vali Acc: 0.724 Test Loss: 0.866 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723676).  Saving model ...
Epoch: 22 cost time: 0.7033133506774902
Epoch: 22, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.840 Vali Acc: 0.737 Test Loss: 0.840 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736834).  Saving model ...
Epoch: 23 cost time: 0.7709810733795166
Epoch: 23, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.815 Vali Acc: 0.757 Test Loss: 0.815 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756571).  Saving model ...
Epoch: 24 cost time: 0.873039960861206
Epoch: 24, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.791 Vali Acc: 0.743 Test Loss: 0.791 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.149660587310791
Epoch: 25, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8696811199188232
Epoch: 26, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.746 Vali Acc: 0.743 Test Loss: 0.746 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0063540935516357
Epoch: 27, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 28 cost time: 0.8690280914306641
Epoch: 28, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.701 Vali Acc: 0.770 Test Loss: 0.701 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 29 cost time: 0.841310977935791
Epoch: 29, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.682 Vali Acc: 0.776 Test Loss: 0.682 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 30 cost time: 0.8382422924041748
Epoch: 30, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.663 Vali Acc: 0.776 Test Loss: 0.663 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 31 cost time: 0.9110217094421387
Epoch: 31, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 32 cost time: 0.8274650573730469
Epoch: 32, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.628 Vali Acc: 0.803 Test Loss: 0.628 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 33 cost time: 1.0873396396636963
Epoch: 33, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 34 cost time: 0.8483006954193115
Epoch: 34, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815784).  Saving model ...
Epoch: 35 cost time: 0.9324164390563965
Epoch: 35, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 0.9294672012329102
Epoch: 36, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 37 cost time: 0.9867868423461914
Epoch: 37, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 38 cost time: 1.0415079593658447
Epoch: 38, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8514816761016846
Epoch: 39, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 40 cost time: 0.8407089710235596
Epoch: 40, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 41 cost time: 0.8181111812591553
Epoch: 41, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 42 cost time: 0.936154842376709
Epoch: 42, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 43 cost time: 0.8689031600952148
Epoch: 43, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.506 Vali Acc: 0.816 Test Loss: 0.506 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7258684635162354
Epoch: 44, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 45 cost time: 0.880251407623291
Epoch: 45, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.498 Vali Acc: 0.829 Test Loss: 0.498 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 46 cost time: 0.8495275974273682
Epoch: 46, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.491 Vali Acc: 0.829 Test Loss: 0.491 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 47 cost time: 0.9105551242828369
Epoch: 47, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 48 cost time: 0.8887209892272949
Epoch: 48, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.482 Vali Acc: 0.836 Test Loss: 0.482 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 49 cost time: 0.8935737609863281
Epoch: 49, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.479 Vali Acc: 0.842 Test Loss: 0.479 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 50 cost time: 0.834479808807373
Epoch: 50, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.474 Vali Acc: 0.842 Test Loss: 0.474 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 51 cost time: 0.8774905204772949
Epoch: 51, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.471 Vali Acc: 0.842 Test Loss: 0.471 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 52 cost time: 0.8014774322509766
Epoch: 52, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.470 Vali Acc: 0.849 Test Loss: 0.470 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 53 cost time: 0.8116700649261475
Epoch: 53, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.470 Vali Acc: 0.836 Test Loss: 0.470 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7897863388061523
Epoch: 54, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.469 Vali Acc: 0.842 Test Loss: 0.469 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9580707550048828
Epoch: 55, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.467 Vali Acc: 0.842 Test Loss: 0.467 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9364109039306641
Epoch: 56, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.462 Vali Acc: 0.842 Test Loss: 0.462 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.7844619750976562
Epoch: 57, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.460 Vali Acc: 0.842 Test Loss: 0.460 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.7235889434814453
Epoch: 58, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.458 Vali Acc: 0.842 Test Loss: 0.458 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.83937668800354
Epoch: 59, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.457 Vali Acc: 0.836 Test Loss: 0.457 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7311172485351562
Epoch: 60, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.457 Vali Acc: 0.849 Test Loss: 0.457 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 61 cost time: 0.786823034286499
Epoch: 61, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 62 cost time: 0.8466665744781494
Epoch: 62, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 63 cost time: 0.7289621829986572
Epoch: 63, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8930118083953857
Epoch: 64, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 65 cost time: 0.8963062763214111
Epoch: 65, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8009793758392334
Epoch: 66, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.907437801361084
Epoch: 67, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 68 cost time: 0.8350913524627686
Epoch: 68, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7910537719726562
Epoch: 69, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9442391395568848
Epoch: 70, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.78568434715271
Epoch: 71, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.455 Vali Acc: 0.849 Test Loss: 0.455 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.8366427421569824
Epoch: 72, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.797548770904541
Epoch: 73, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.459 Vali Acc: 0.849 Test Loss: 0.459 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7668018341064453
Epoch: 74, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.460 Vali Acc: 0.849 Test Loss: 0.460 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7148623466491699
Epoch: 75, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.460 Vali Acc: 0.849 Test Loss: 0.460 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.7983438968658447
Epoch: 76, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.038036584854126
Epoch: 77, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w4_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 17320
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2722487449645996
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.456 Vali Acc: 0.257 Test Loss: 1.456 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 0.8465795516967773
Epoch: 2, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.439 Vali Acc: 0.270 Test Loss: 1.439 Test Acc: 0.270
Validation loss decreased (-0.256564 --> -0.269722).  Saving model ...
Epoch: 3 cost time: 0.8423709869384766
Epoch: 3, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.417 Vali Acc: 0.289 Test Loss: 1.417 Test Acc: 0.289
Validation loss decreased (-0.269722 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 0.9184536933898926
Epoch: 4, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.392 Vali Acc: 0.309 Test Loss: 1.392 Test Acc: 0.309
Validation loss decreased (-0.289460 --> -0.309197).  Saving model ...
Epoch: 5 cost time: 0.8477723598480225
Epoch: 5, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.363 Vali Acc: 0.368 Test Loss: 1.363 Test Acc: 0.368
Validation loss decreased (-0.309197 --> -0.368407).  Saving model ...
Epoch: 6 cost time: 0.7686560153961182
Epoch: 6, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.333 Vali Acc: 0.382 Test Loss: 1.333 Test Acc: 0.382
Validation loss decreased (-0.368407 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 0.803631067276001
Epoch: 7, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.302 Vali Acc: 0.454 Test Loss: 1.302 Test Acc: 0.454
Validation loss decreased (-0.381566 --> -0.453934).  Saving model ...
Epoch: 8 cost time: 0.9249701499938965
Epoch: 8, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.270 Vali Acc: 0.493 Test Loss: 1.270 Test Acc: 0.493
Validation loss decreased (-0.453934 --> -0.493408).  Saving model ...
Epoch: 9 cost time: 0.8623316287994385
Epoch: 9, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.239 Vali Acc: 0.533 Test Loss: 1.239 Test Acc: 0.533
Validation loss decreased (-0.493408 --> -0.532882).  Saving model ...
Epoch: 10 cost time: 0.9452500343322754
Epoch: 10, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.207 Vali Acc: 0.572 Test Loss: 1.207 Test Acc: 0.572
Validation loss decreased (-0.532882 --> -0.572356).  Saving model ...
Epoch: 11 cost time: 0.917412519454956
Epoch: 11, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.175 Vali Acc: 0.586 Test Loss: 1.175 Test Acc: 0.586
Validation loss decreased (-0.572356 --> -0.585515).  Saving model ...
Epoch: 12 cost time: 0.7633037567138672
Epoch: 12, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.144 Vali Acc: 0.592 Test Loss: 1.144 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592094).  Saving model ...
Epoch: 13 cost time: 1.106168508529663
Epoch: 13, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.113 Vali Acc: 0.632 Test Loss: 1.113 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631568).  Saving model ...
Epoch: 14 cost time: 0.8695440292358398
Epoch: 14, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.082 Vali Acc: 0.664 Test Loss: 1.082 Test Acc: 0.664
Validation loss decreased (-0.631568 --> -0.664463).  Saving model ...
Epoch: 15 cost time: 0.821955680847168
Epoch: 15, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.052 Vali Acc: 0.664 Test Loss: 1.052 Test Acc: 0.664
Validation loss decreased (-0.664463 --> -0.664463).  Saving model ...
Epoch: 16 cost time: 0.9183752536773682
Epoch: 16, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.024 Vali Acc: 0.658 Test Loss: 1.024 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.004042387008667
Epoch: 17, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.996 Vali Acc: 0.664 Test Loss: 0.996 Test Acc: 0.664
Validation loss decreased (-0.664463 --> -0.664464).  Saving model ...
Epoch: 18 cost time: 0.8738200664520264
Epoch: 18, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.969 Vali Acc: 0.664 Test Loss: 0.969 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664464).  Saving model ...
Epoch: 19 cost time: 0.8318595886230469
Epoch: 19, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.941 Vali Acc: 0.684 Test Loss: 0.941 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 20 cost time: 0.79366135597229
Epoch: 20, Steps: 10 | Train Loss: 0.693 Vali Loss: 0.913 Vali Acc: 0.684 Test Loss: 0.913 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684201).  Saving model ...
Epoch: 21 cost time: 0.7048511505126953
Epoch: 21, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.885 Vali Acc: 0.697 Test Loss: 0.885 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 22 cost time: 0.7233245372772217
Epoch: 22, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.859 Vali Acc: 0.704 Test Loss: 0.859 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703939).  Saving model ...
Epoch: 23 cost time: 0.8115792274475098
Epoch: 23, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 24 cost time: 0.86745285987854
Epoch: 24, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.810 Vali Acc: 0.717 Test Loss: 0.810 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717097).  Saving model ...
Epoch: 25 cost time: 0.8164117336273193
Epoch: 25, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.784 Vali Acc: 0.730 Test Loss: 0.784 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 26 cost time: 0.8304574489593506
Epoch: 26, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736834).  Saving model ...
Epoch: 27 cost time: 0.7537274360656738
Epoch: 27, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.742 Vali Acc: 0.724 Test Loss: 0.742 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7661278247833252
Epoch: 28, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 0.8070623874664307
Epoch: 29, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.835411548614502
Epoch: 30, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.677 Vali Acc: 0.757 Test Loss: 0.677 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 31 cost time: 0.812650203704834
Epoch: 31, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8380978107452393
Epoch: 32, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8260068893432617
Epoch: 33, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.629 Vali Acc: 0.743 Test Loss: 0.629 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9400930404663086
Epoch: 34, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.614 Vali Acc: 0.763 Test Loss: 0.614 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 35 cost time: 0.8539557456970215
Epoch: 35, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.599 Vali Acc: 0.770 Test Loss: 0.599 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 36 cost time: 0.8518304824829102
Epoch: 36, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 37 cost time: 0.9861929416656494
Epoch: 37, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 38 cost time: 0.8097949028015137
Epoch: 38, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 39 cost time: 0.8360748291015625
Epoch: 39, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 40 cost time: 1.004262924194336
Epoch: 40, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 41 cost time: 0.8806045055389404
Epoch: 41, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 42 cost time: 0.8180816173553467
Epoch: 42, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 43 cost time: 1.0521914958953857
Epoch: 43, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 44 cost time: 0.7660503387451172
Epoch: 44, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 45 cost time: 0.9827399253845215
Epoch: 45, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 46 cost time: 0.7170567512512207
Epoch: 46, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.879173994064331
Epoch: 47, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 48 cost time: 0.7926547527313232
Epoch: 48, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 49 cost time: 0.7716572284698486
Epoch: 49, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 50 cost time: 0.7795417308807373
Epoch: 50, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 51 cost time: 0.8432257175445557
Epoch: 51, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.486 Vali Acc: 0.829 Test Loss: 0.486 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 52 cost time: 0.7811715602874756
Epoch: 52, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7236967086791992
Epoch: 53, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.732058048248291
Epoch: 54, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.485 Vali Acc: 0.829 Test Loss: 0.485 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 55 cost time: 0.8377580642700195
Epoch: 55, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 56 cost time: 0.8423807621002197
Epoch: 56, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.478 Vali Acc: 0.829 Test Loss: 0.478 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 57 cost time: 0.8495151996612549
Epoch: 57, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842100).  Saving model ...
Epoch: 58 cost time: 0.7821526527404785
Epoch: 58, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.475 Vali Acc: 0.849 Test Loss: 0.475 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848679).  Saving model ...
Epoch: 59 cost time: 0.9158215522766113
Epoch: 59, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 60 cost time: 0.8771934509277344
Epoch: 60, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 61 cost time: 0.8332326412200928
Epoch: 61, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.470 Vali Acc: 0.849 Test Loss: 0.470 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 62 cost time: 0.7240877151489258
Epoch: 62, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.468 Vali Acc: 0.849 Test Loss: 0.468 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 63 cost time: 0.7730445861816406
Epoch: 63, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.466 Vali Acc: 0.849 Test Loss: 0.466 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 64 cost time: 0.7428712844848633
Epoch: 64, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.465 Vali Acc: 0.849 Test Loss: 0.465 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 65 cost time: 0.7436769008636475
Epoch: 65, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.469 Vali Acc: 0.849 Test Loss: 0.469 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7082476615905762
Epoch: 66, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.469 Vali Acc: 0.849 Test Loss: 0.469 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.813551664352417
Epoch: 67, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.468 Vali Acc: 0.849 Test Loss: 0.468 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7847542762756348
Epoch: 68, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.466 Vali Acc: 0.849 Test Loss: 0.466 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.8137392997741699
Epoch: 69, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.464 Vali Acc: 0.849 Test Loss: 0.464 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 70 cost time: 0.8041281700134277
Epoch: 70, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.462 Vali Acc: 0.849 Test Loss: 0.462 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 71 cost time: 0.8001959323883057
Epoch: 71, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 72 cost time: 0.8282856941223145
Epoch: 72, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 73 cost time: 0.8501870632171631
Epoch: 73, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.755751371383667
Epoch: 74, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.461 Vali Acc: 0.849 Test Loss: 0.461 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7178001403808594
Epoch: 75, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.462 Vali Acc: 0.849 Test Loss: 0.462 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.772860050201416
Epoch: 76, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.462 Vali Acc: 0.842 Test Loss: 0.462 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.7057375907897949
Epoch: 77, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.461 Vali Acc: 0.842 Test Loss: 0.461 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.7882864475250244
Epoch: 78, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.460 Vali Acc: 0.842 Test Loss: 0.460 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.8345131874084473
Epoch: 79, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.459 Vali Acc: 0.849 Test Loss: 0.459 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.7235045433044434
Epoch: 80, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.458 Vali Acc: 0.849 Test Loss: 0.458 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.8180396556854248
Epoch: 81, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.458 Vali Acc: 0.849 Test Loss: 0.458 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.8287224769592285
Epoch: 82, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.460 Vali Acc: 0.849 Test Loss: 0.460 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w3_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 17064
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.946915626525879
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.452 Vali Acc: 0.197 Test Loss: 1.452 Test Acc: 0.197
Validation loss decreased (inf --> -0.197354).  Saving model ...
Epoch: 2 cost time: 0.6697399616241455
Epoch: 2, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.436 Vali Acc: 0.230 Test Loss: 1.436 Test Acc: 0.230
Validation loss decreased (-0.197354 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 0.7804031372070312
Epoch: 3, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.413 Vali Acc: 0.250 Test Loss: 1.413 Test Acc: 0.250
Validation loss decreased (-0.230249 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.6731956005096436
Epoch: 4, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.387 Vali Acc: 0.289 Test Loss: 1.387 Test Acc: 0.289
Validation loss decreased (-0.249986 --> -0.289460).  Saving model ...
Epoch: 5 cost time: 0.6329338550567627
Epoch: 5, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.357 Vali Acc: 0.362 Test Loss: 1.357 Test Acc: 0.362
Validation loss decreased (-0.289460 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 0.6801419258117676
Epoch: 6, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.327 Vali Acc: 0.408 Test Loss: 1.327 Test Acc: 0.408
Validation loss decreased (-0.361829 --> -0.407881).  Saving model ...
Epoch: 7 cost time: 0.6374750137329102
Epoch: 7, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.296 Vali Acc: 0.434 Test Loss: 1.296 Test Acc: 0.434
Validation loss decreased (-0.407881 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 0.7068822383880615
Epoch: 8, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.263 Vali Acc: 0.520 Test Loss: 1.263 Test Acc: 0.520
Validation loss decreased (-0.434198 --> -0.519724).  Saving model ...
Epoch: 9 cost time: 0.7527997493743896
Epoch: 9, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.231 Vali Acc: 0.539 Test Loss: 1.231 Test Acc: 0.539
Validation loss decreased (-0.519724 --> -0.539461).  Saving model ...
Epoch: 10 cost time: 0.7663447856903076
Epoch: 10, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.197 Vali Acc: 0.586 Test Loss: 1.197 Test Acc: 0.586
Validation loss decreased (-0.539461 --> -0.585514).  Saving model ...
Epoch: 11 cost time: 0.6954219341278076
Epoch: 11, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.161 Vali Acc: 0.618 Test Loss: 1.161 Test Acc: 0.618
Validation loss decreased (-0.585514 --> -0.618409).  Saving model ...
Epoch: 12 cost time: 0.6821804046630859
Epoch: 12, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.126 Vali Acc: 0.638 Test Loss: 1.126 Test Acc: 0.638
Validation loss decreased (-0.618409 --> -0.638147).  Saving model ...
Epoch: 13 cost time: 0.640500545501709
Epoch: 13, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.090 Vali Acc: 0.664 Test Loss: 1.090 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664463).  Saving model ...
Epoch: 14 cost time: 0.6965348720550537
Epoch: 14, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.057 Vali Acc: 0.678 Test Loss: 1.057 Test Acc: 0.678
Validation loss decreased (-0.664463 --> -0.677621).  Saving model ...
Epoch: 15 cost time: 0.7315425872802734
Epoch: 15, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.025 Vali Acc: 0.684 Test Loss: 1.025 Test Acc: 0.684
Validation loss decreased (-0.677621 --> -0.684200).  Saving model ...
Epoch: 16 cost time: 0.6916821002960205
Epoch: 16, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.994 Vali Acc: 0.691 Test Loss: 0.994 Test Acc: 0.691
Validation loss decreased (-0.684200 --> -0.690780).  Saving model ...
Epoch: 17 cost time: 0.6199228763580322
Epoch: 17, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.965 Vali Acc: 0.684 Test Loss: 0.965 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6912667751312256
Epoch: 18, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.934 Vali Acc: 0.697 Test Loss: 0.934 Test Acc: 0.697
Validation loss decreased (-0.690780 --> -0.697359).  Saving model ...
Epoch: 19 cost time: 0.7302830219268799
Epoch: 19, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.902 Vali Acc: 0.730 Test Loss: 0.902 Test Acc: 0.730
Validation loss decreased (-0.697359 --> -0.730254).  Saving model ...
Epoch: 20 cost time: 0.6125802993774414
Epoch: 20, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.871 Vali Acc: 0.724 Test Loss: 0.871 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.642514705657959
Epoch: 21, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.842 Vali Acc: 0.724 Test Loss: 0.842 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6782782077789307
Epoch: 22, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7156016826629639
Epoch: 23, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.785 Vali Acc: 0.737 Test Loss: 0.785 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 24 cost time: 0.6589722633361816
Epoch: 24, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.760 Vali Acc: 0.737 Test Loss: 0.760 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736835).  Saving model ...
Epoch: 25 cost time: 0.6994130611419678
Epoch: 25, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.737 Vali Acc: 0.743 Test Loss: 0.737 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 26 cost time: 0.7566943168640137
Epoch: 26, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 27 cost time: 0.6957969665527344
Epoch: 27, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 0.7483682632446289
Epoch: 28, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.672 Vali Acc: 0.770 Test Loss: 0.672 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 29 cost time: 0.6535687446594238
Epoch: 29, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.654 Vali Acc: 0.776 Test Loss: 0.654 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 30 cost time: 0.7106525897979736
Epoch: 30, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 31 cost time: 0.7206089496612549
Epoch: 31, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7811124324798584
Epoch: 32, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7049591541290283
Epoch: 33, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.593 Vali Acc: 0.776 Test Loss: 0.593 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6549849510192871
Epoch: 34, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6571643352508545
Epoch: 35, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6650667190551758
Epoch: 36, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7191581726074219
Epoch: 37, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6272387504577637
Epoch: 38, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6574192047119141
Epoch: 39, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7153139114379883
Epoch: 40, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w2_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 16808
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.975799560546875
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.437 Vali Acc: 0.237 Test Loss: 1.437 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 0.6715638637542725
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
Validation loss decreased (-0.236828 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 0.6030998229980469
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.395 Vali Acc: 0.303 Test Loss: 1.395 Test Acc: 0.303
Validation loss decreased (-0.243407 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.7183773517608643
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.368 Vali Acc: 0.322 Test Loss: 1.368 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 0.6298801898956299
Epoch: 5, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.338 Vali Acc: 0.336 Test Loss: 1.338 Test Acc: 0.336
Validation loss decreased (-0.322355 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 0.6590499877929688
Epoch: 6, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.306 Vali Acc: 0.362 Test Loss: 1.306 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 7 cost time: 0.5596053600311279
Epoch: 7, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.273 Vali Acc: 0.434 Test Loss: 1.273 Test Acc: 0.434
Validation loss decreased (-0.361829 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 0.5927057266235352
Epoch: 8, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.238 Vali Acc: 0.513 Test Loss: 1.238 Test Acc: 0.513
Validation loss decreased (-0.434198 --> -0.513146).  Saving model ...
Epoch: 9 cost time: 0.5805528163909912
Epoch: 9, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.202 Vali Acc: 0.559 Test Loss: 1.202 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 10 cost time: 0.5718140602111816
Epoch: 10, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.167 Vali Acc: 0.618 Test Loss: 1.167 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618409).  Saving model ...
Epoch: 11 cost time: 0.6205096244812012
Epoch: 11, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.618409 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.6169185638427734
Epoch: 12, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.097 Vali Acc: 0.638 Test Loss: 1.097 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638147).  Saving model ...
Epoch: 13 cost time: 0.6243913173675537
Epoch: 13, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.062 Vali Acc: 0.645 Test Loss: 1.062 Test Acc: 0.645
Validation loss decreased (-0.638147 --> -0.644726).  Saving model ...
Epoch: 14 cost time: 0.5549092292785645
Epoch: 14, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.028 Vali Acc: 0.671 Test Loss: 1.028 Test Acc: 0.671
Validation loss decreased (-0.644726 --> -0.671042).  Saving model ...
Epoch: 15 cost time: 0.620805025100708
Epoch: 15, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.992 Vali Acc: 0.664 Test Loss: 0.992 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6677532196044922
Epoch: 16, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.958 Vali Acc: 0.691 Test Loss: 0.958 Test Acc: 0.691
Validation loss decreased (-0.671042 --> -0.690780).  Saving model ...
Epoch: 17 cost time: 0.6338670253753662
Epoch: 17, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.925 Vali Acc: 0.704 Test Loss: 0.925 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703938).  Saving model ...
Epoch: 18 cost time: 0.5993382930755615
Epoch: 18, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.888 Vali Acc: 0.704 Test Loss: 0.888 Test Acc: 0.704
Validation loss decreased (-0.703938 --> -0.703938).  Saving model ...
Epoch: 19 cost time: 0.657792329788208
Epoch: 19, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.854 Vali Acc: 0.717 Test Loss: 0.854 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717097).  Saving model ...
Epoch: 20 cost time: 0.6254391670227051
Epoch: 20, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.823 Vali Acc: 0.724 Test Loss: 0.823 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723676).  Saving model ...
Epoch: 21 cost time: 0.6673727035522461
Epoch: 21, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.794 Vali Acc: 0.724 Test Loss: 0.794 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 22 cost time: 0.664959192276001
Epoch: 22, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6866388320922852
Epoch: 23, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.739 Vali Acc: 0.730 Test Loss: 0.739 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 24 cost time: 0.6876013278961182
Epoch: 24, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.714 Vali Acc: 0.730 Test Loss: 0.714 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 25 cost time: 0.673337459564209
Epoch: 25, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 26 cost time: 0.7097904682159424
Epoch: 26, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 27 cost time: 0.6069638729095459
Epoch: 27, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 28 cost time: 0.5334868431091309
Epoch: 28, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 29 cost time: 0.666388750076294
Epoch: 29, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 30 cost time: 0.7185571193695068
Epoch: 30, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 0.621208667755127
Epoch: 31, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6014144420623779
Epoch: 32, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 0.7220873832702637
Epoch: 33, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 0.697343111038208
Epoch: 34, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 35 cost time: 0.6689453125
Epoch: 35, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 36 cost time: 0.5760917663574219
Epoch: 36, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 37 cost time: 0.73988938331604
Epoch: 37, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5959324836730957
Epoch: 38, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6311042308807373
Epoch: 39, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6292510032653809
Epoch: 40, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.496 Vali Acc: 0.796 Test Loss: 0.496 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6274735927581787
Epoch: 41, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5769526958465576
Epoch: 42, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 43 cost time: 0.6632053852081299
Epoch: 43, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 44 cost time: 0.6355903148651123
Epoch: 44, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 45 cost time: 0.6447312831878662
Epoch: 45, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5276827812194824
Epoch: 46, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6342911720275879
Epoch: 47, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5882425308227539
Epoch: 48, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5706052780151367
Epoch: 49, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 50 cost time: 0.7138018608093262
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.462 Vali Acc: 0.816 Test Loss: 0.462 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 51 cost time: 0.6459846496582031
Epoch: 51, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 52 cost time: 0.7010412216186523
Epoch: 52, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7199242115020752
Epoch: 53, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 54 cost time: 0.6792936325073242
Epoch: 54, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.456 Vali Acc: 0.822 Test Loss: 0.456 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 55 cost time: 0.6867976188659668
Epoch: 55, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 56 cost time: 0.6170811653137207
Epoch: 56, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 57 cost time: 0.648615837097168
Epoch: 57, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 58 cost time: 0.6336860656738281
Epoch: 58, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 59 cost time: 0.5712504386901855
Epoch: 59, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 60 cost time: 0.6110794544219971
Epoch: 60, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 61 cost time: 0.7413907051086426
Epoch: 61, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 62 cost time: 0.6822290420532227
Epoch: 62, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.445 Vali Acc: 0.829 Test Loss: 0.445 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 63 cost time: 0.8519418239593506
Epoch: 63, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6243770122528076
Epoch: 64, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.749544620513916
Epoch: 65, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.7088935375213623
Epoch: 66, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7754909992218018
Epoch: 67, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.6188366413116455
Epoch: 68, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.712857723236084
Epoch: 69, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.6231539249420166
Epoch: 70, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6641488075256348
Epoch: 71, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.448 Vali Acc: 0.816 Test Loss: 0.448 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.6113362312316895
Epoch: 72, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w1_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 16552
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               4                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.076488971710205
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.437 Vali Acc: 0.237 Test Loss: 1.437 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 0.6546154022216797
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
Validation loss decreased (-0.236828 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 0.6654419898986816
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.395 Vali Acc: 0.303 Test Loss: 1.395 Test Acc: 0.303
Validation loss decreased (-0.243407 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.8073911666870117
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.368 Vali Acc: 0.322 Test Loss: 1.368 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 0.6529076099395752
Epoch: 5, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.338 Vali Acc: 0.336 Test Loss: 1.338 Test Acc: 0.336
Validation loss decreased (-0.322355 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 0.6845178604125977
Epoch: 6, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.306 Vali Acc: 0.362 Test Loss: 1.306 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 7 cost time: 0.7146396636962891
Epoch: 7, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.273 Vali Acc: 0.434 Test Loss: 1.273 Test Acc: 0.434
Validation loss decreased (-0.361829 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 0.6783535480499268
Epoch: 8, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.238 Vali Acc: 0.513 Test Loss: 1.238 Test Acc: 0.513
Validation loss decreased (-0.434198 --> -0.513146).  Saving model ...
Epoch: 9 cost time: 0.5601420402526855
Epoch: 9, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.202 Vali Acc: 0.559 Test Loss: 1.202 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 10 cost time: 0.6769616603851318
Epoch: 10, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.167 Vali Acc: 0.618 Test Loss: 1.167 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618409).  Saving model ...
Epoch: 11 cost time: 0.581620454788208
Epoch: 11, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.618409 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.6806485652923584
Epoch: 12, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.097 Vali Acc: 0.638 Test Loss: 1.097 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638147).  Saving model ...
Epoch: 13 cost time: 0.6490523815155029
Epoch: 13, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.062 Vali Acc: 0.645 Test Loss: 1.062 Test Acc: 0.645
Validation loss decreased (-0.638147 --> -0.644726).  Saving model ...
Epoch: 14 cost time: 0.6149344444274902
Epoch: 14, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.028 Vali Acc: 0.671 Test Loss: 1.028 Test Acc: 0.671
Validation loss decreased (-0.644726 --> -0.671042).  Saving model ...
Epoch: 15 cost time: 0.574627161026001
Epoch: 15, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.992 Vali Acc: 0.664 Test Loss: 0.992 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5440173149108887
Epoch: 16, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.958 Vali Acc: 0.691 Test Loss: 0.958 Test Acc: 0.691
Validation loss decreased (-0.671042 --> -0.690780).  Saving model ...
Epoch: 17 cost time: 0.6686856746673584
Epoch: 17, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.925 Vali Acc: 0.704 Test Loss: 0.925 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703938).  Saving model ...
Epoch: 18 cost time: 0.8591020107269287
Epoch: 18, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.888 Vali Acc: 0.704 Test Loss: 0.888 Test Acc: 0.704
Validation loss decreased (-0.703938 --> -0.703938).  Saving model ...
Epoch: 19 cost time: 0.6207282543182373
Epoch: 19, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.854 Vali Acc: 0.717 Test Loss: 0.854 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717097).  Saving model ...
Epoch: 20 cost time: 0.6823399066925049
Epoch: 20, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.823 Vali Acc: 0.724 Test Loss: 0.823 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723676).  Saving model ...
Epoch: 21 cost time: 0.7315895557403564
Epoch: 21, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.794 Vali Acc: 0.724 Test Loss: 0.794 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 22 cost time: 0.6329519748687744
Epoch: 22, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6253445148468018
Epoch: 23, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.739 Vali Acc: 0.730 Test Loss: 0.739 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 24 cost time: 0.6214613914489746
Epoch: 24, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.714 Vali Acc: 0.730 Test Loss: 0.714 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 25 cost time: 0.5276930332183838
Epoch: 25, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 26 cost time: 0.6607296466827393
Epoch: 26, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 27 cost time: 0.556403636932373
Epoch: 27, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 28 cost time: 0.5777919292449951
Epoch: 28, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 29 cost time: 0.5477404594421387
Epoch: 29, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 30 cost time: 0.6315512657165527
Epoch: 30, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 0.5463709831237793
Epoch: 31, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5287399291992188
Epoch: 32, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 0.6292867660522461
Epoch: 33, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 34 cost time: 0.5498230457305908
Epoch: 34, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 35 cost time: 0.692051887512207
Epoch: 35, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 36 cost time: 0.7568628787994385
Epoch: 36, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 37 cost time: 0.5853068828582764
Epoch: 37, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5669817924499512
Epoch: 38, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.585949182510376
Epoch: 39, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7271499633789062
Epoch: 40, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.496 Vali Acc: 0.796 Test Loss: 0.496 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5144553184509277
Epoch: 41, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4961071014404297
Epoch: 42, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 43 cost time: 0.6781797409057617
Epoch: 43, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 44 cost time: 0.5964863300323486
Epoch: 44, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 45 cost time: 0.6595373153686523
Epoch: 45, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6663162708282471
Epoch: 46, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6740856170654297
Epoch: 47, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6851093769073486
Epoch: 48, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7475762367248535
Epoch: 49, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 50 cost time: 0.6485822200775146
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.462 Vali Acc: 0.816 Test Loss: 0.462 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 51 cost time: 0.6121585369110107
Epoch: 51, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 52 cost time: 0.6809296607971191
Epoch: 52, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5500333309173584
Epoch: 53, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 54 cost time: 0.627676248550415
Epoch: 54, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.456 Vali Acc: 0.822 Test Loss: 0.456 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 55 cost time: 0.6123285293579102
Epoch: 55, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 56 cost time: 0.552828311920166
Epoch: 56, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 57 cost time: 0.6395041942596436
Epoch: 57, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 58 cost time: 0.7523126602172852
Epoch: 58, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 59 cost time: 0.5841057300567627
Epoch: 59, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 60 cost time: 0.66152024269104
Epoch: 60, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 61 cost time: 0.6725420951843262
Epoch: 61, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 62 cost time: 0.6237545013427734
Epoch: 62, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.445 Vali Acc: 0.829 Test Loss: 0.445 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 63 cost time: 0.6002368927001953
Epoch: 63, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7236411571502686
Epoch: 64, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7120406627655029
Epoch: 65, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.6687169075012207
Epoch: 66, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.6688966751098633
Epoch: 67, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.7272210121154785
Epoch: 68, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.7178657054901123
Epoch: 69, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.448 Vali Acc: 0.822 Test Loss: 0.448 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.6488380432128906
Epoch: 70, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6604437828063965
Epoch: 71, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.448 Vali Acc: 0.816 Test Loss: 0.448 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.699826717376709
Epoch: 72, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT0_w0_fC1_df4_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 16552
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.732705593109131
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.452 Vali Acc: 0.171 Test Loss: 1.452 Test Acc: 0.171
Validation loss decreased (inf --> -0.171038).  Saving model ...
Epoch: 2 cost time: 0.7341630458831787
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.440 Vali Acc: 0.178 Test Loss: 1.440 Test Acc: 0.178
Validation loss decreased (-0.171038 --> -0.177617).  Saving model ...
Epoch: 3 cost time: 0.7033603191375732
Epoch: 3, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.424 Vali Acc: 0.211 Test Loss: 1.424 Test Acc: 0.211
Validation loss decreased (-0.177617 --> -0.210512).  Saving model ...
Epoch: 4 cost time: 0.7820558547973633
Epoch: 4, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.405 Vali Acc: 0.237 Test Loss: 1.405 Test Acc: 0.237
Validation loss decreased (-0.210512 --> -0.236828).  Saving model ...
Epoch: 5 cost time: 0.7570605278015137
Epoch: 5, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.386 Vali Acc: 0.243 Test Loss: 1.386 Test Acc: 0.243
Validation loss decreased (-0.236828 --> -0.243407).  Saving model ...
Epoch: 6 cost time: 0.7430546283721924
Epoch: 6, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.364 Vali Acc: 0.283 Test Loss: 1.364 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 7 cost time: 0.8062334060668945
Epoch: 7, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.343 Vali Acc: 0.342 Test Loss: 1.343 Test Acc: 0.342
Validation loss decreased (-0.282881 --> -0.342092).  Saving model ...
Epoch: 8 cost time: 0.776993989944458
Epoch: 8, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.320 Vali Acc: 0.375 Test Loss: 1.320 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 0.7501623630523682
Epoch: 9, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.295 Vali Acc: 0.401 Test Loss: 1.295 Test Acc: 0.401
Validation loss decreased (-0.374987 --> -0.401303).  Saving model ...
Epoch: 10 cost time: 0.8223764896392822
Epoch: 10, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.271 Vali Acc: 0.461 Test Loss: 1.271 Test Acc: 0.461
Validation loss decreased (-0.401303 --> -0.460514).  Saving model ...
Epoch: 11 cost time: 0.8306124210357666
Epoch: 11, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.460514 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 0.6680290699005127
Epoch: 12, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.224 Vali Acc: 0.539 Test Loss: 1.224 Test Acc: 0.539
Validation loss decreased (-0.499988 --> -0.539461).  Saving model ...
Epoch: 13 cost time: 0.7733240127563477
Epoch: 13, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.196 Vali Acc: 0.553 Test Loss: 1.196 Test Acc: 0.553
Validation loss decreased (-0.539461 --> -0.552620).  Saving model ...
Epoch: 14 cost time: 0.827197790145874
Epoch: 14, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.167 Vali Acc: 0.553 Test Loss: 1.167 Test Acc: 0.553
Validation loss decreased (-0.552620 --> -0.552620).  Saving model ...
Epoch: 15 cost time: 0.7343425750732422
Epoch: 15, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.141 Vali Acc: 0.559 Test Loss: 1.141 Test Acc: 0.559
Validation loss decreased (-0.552620 --> -0.559199).  Saving model ...
Epoch: 16 cost time: 0.7912003993988037
Epoch: 16, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.109 Vali Acc: 0.566 Test Loss: 1.109 Test Acc: 0.566
Validation loss decreased (-0.559199 --> -0.565778).  Saving model ...
Epoch: 17 cost time: 0.7756402492523193
Epoch: 17, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.077 Vali Acc: 0.612 Test Loss: 1.077 Test Acc: 0.612
Validation loss decreased (-0.565778 --> -0.611831).  Saving model ...
Epoch: 18 cost time: 0.7917947769165039
Epoch: 18, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.047 Vali Acc: 0.638 Test Loss: 1.047 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638147).  Saving model ...
Epoch: 19 cost time: 0.8023512363433838
Epoch: 19, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.017 Vali Acc: 0.658 Test Loss: 1.017 Test Acc: 0.658
Validation loss decreased (-0.638147 --> -0.657885).  Saving model ...
Epoch: 20 cost time: 0.8235692977905273
Epoch: 20, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.989 Vali Acc: 0.678 Test Loss: 0.989 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677622).  Saving model ...
Epoch: 21 cost time: 0.8016352653503418
Epoch: 21, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.959 Vali Acc: 0.678 Test Loss: 0.959 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677622).  Saving model ...
Epoch: 22 cost time: 0.8607051372528076
Epoch: 22, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.930 Vali Acc: 0.684 Test Loss: 0.930 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684201).  Saving model ...
Epoch: 23 cost time: 0.757652759552002
Epoch: 23, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.900 Vali Acc: 0.684 Test Loss: 0.900 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684202).  Saving model ...
Epoch: 24 cost time: 0.8630595207214355
Epoch: 24, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.874 Vali Acc: 0.691 Test Loss: 0.874 Test Acc: 0.691
Validation loss decreased (-0.684202 --> -0.690781).  Saving model ...
Epoch: 25 cost time: 0.871013879776001
Epoch: 25, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.850 Vali Acc: 0.691 Test Loss: 0.850 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690781).  Saving model ...
Epoch: 26 cost time: 0.7721211910247803
Epoch: 26, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.825 Vali Acc: 0.704 Test Loss: 0.825 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 27 cost time: 0.739497184753418
Epoch: 27, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.801 Vali Acc: 0.711 Test Loss: 0.801 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 28 cost time: 0.8160722255706787
Epoch: 28, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717097).  Saving model ...
Epoch: 29 cost time: 0.7991080284118652
Epoch: 29, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.761 Vali Acc: 0.724 Test Loss: 0.761 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 30 cost time: 0.8159818649291992
Epoch: 30, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.743 Vali Acc: 0.724 Test Loss: 0.743 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 31 cost time: 0.7762138843536377
Epoch: 31, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.725 Vali Acc: 0.724 Test Loss: 0.725 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 32 cost time: 0.7587985992431641
Epoch: 32, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 33 cost time: 0.6871201992034912
Epoch: 33, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 34 cost time: 0.7172486782073975
Epoch: 34, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.664 Vali Acc: 0.750 Test Loss: 0.664 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 35 cost time: 0.8808732032775879
Epoch: 35, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.650 Vali Acc: 0.750 Test Loss: 0.650 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 36 cost time: 0.8107552528381348
Epoch: 36, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.632 Vali Acc: 0.757 Test Loss: 0.632 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 37 cost time: 0.713263750076294
Epoch: 37, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 38 cost time: 0.7797858715057373
Epoch: 38, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.608 Vali Acc: 0.757 Test Loss: 0.608 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 39 cost time: 0.6962554454803467
Epoch: 39, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.598 Vali Acc: 0.750 Test Loss: 0.598 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8190464973449707
Epoch: 40, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 41 cost time: 0.78629469871521
Epoch: 41, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8376235961914062
Epoch: 42, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.571 Vali Acc: 0.757 Test Loss: 0.571 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7310223579406738
Epoch: 43, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 44 cost time: 0.6941225528717041
Epoch: 44, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 45 cost time: 0.7133097648620605
Epoch: 45, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 46 cost time: 0.9148252010345459
Epoch: 46, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 47 cost time: 0.7262678146362305
Epoch: 47, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 48 cost time: 0.7534050941467285
Epoch: 48, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7861604690551758
Epoch: 49, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8380541801452637
Epoch: 50, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7694902420043945
Epoch: 51, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 52 cost time: 0.695223331451416
Epoch: 52, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7847135066986084
Epoch: 53, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7964098453521729
Epoch: 54, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7045936584472656
Epoch: 55, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8112032413482666
Epoch: 56, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 57 cost time: 0.7011508941650391
Epoch: 57, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7022097110748291
Epoch: 58, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6379742622375488
Epoch: 59, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7996611595153809
Epoch: 60, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 61 cost time: 0.6734423637390137
Epoch: 61, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6673009395599365
Epoch: 62, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 63 cost time: 0.7497055530548096
Epoch: 63, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6453194618225098
Epoch: 64, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 65 cost time: 0.7897284030914307
Epoch: 65, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6859300136566162
Epoch: 66, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 67 cost time: 0.707284688949585
Epoch: 67, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6308331489562988
Epoch: 68, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7429234981536865
Epoch: 69, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 70 cost time: 0.6110777854919434
Epoch: 70, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.829 Test Loss: 0.488 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 71 cost time: 0.7113044261932373
Epoch: 71, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7104032039642334
Epoch: 72, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6934928894042969
Epoch: 73, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7376928329467773
Epoch: 74, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.6729521751403809
Epoch: 75, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.6995711326599121
Epoch: 76, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.7448601722717285
Epoch: 77, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.8890399932861328
Epoch: 78, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.865821123123169
Epoch: 79, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.8045642375946045
Epoch: 80, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w4_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 17268
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1287918090820312
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.417 Vali Acc: 0.263 Test Loss: 1.417 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 0.8573517799377441
Epoch: 2, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.401 Vali Acc: 0.276 Test Loss: 1.401 Test Acc: 0.276
Validation loss decreased (-0.263144 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 0.7537126541137695
Epoch: 3, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.379 Vali Acc: 0.303 Test Loss: 1.379 Test Acc: 0.303
Validation loss decreased (-0.276302 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.7318987846374512
Epoch: 4, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.352 Vali Acc: 0.349 Test Loss: 1.352 Test Acc: 0.349
Validation loss decreased (-0.302618 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 0.760439395904541
Epoch: 5, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.323 Vali Acc: 0.401 Test Loss: 1.323 Test Acc: 0.401
Validation loss decreased (-0.348671 --> -0.401303).  Saving model ...
Epoch: 6 cost time: 0.7133042812347412
Epoch: 6, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.293 Vali Acc: 0.480 Test Loss: 1.293 Test Acc: 0.480
Validation loss decreased (-0.401303 --> -0.480250).  Saving model ...
Epoch: 7 cost time: 0.7716238498687744
Epoch: 7, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.260 Vali Acc: 0.539 Test Loss: 1.260 Test Acc: 0.539
Validation loss decreased (-0.480250 --> -0.539461).  Saving model ...
Epoch: 8 cost time: 0.7896661758422852
Epoch: 8, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.228 Vali Acc: 0.586 Test Loss: 1.228 Test Acc: 0.586
Validation loss decreased (-0.539461 --> -0.585514).  Saving model ...
Epoch: 9 cost time: 0.7790181636810303
Epoch: 9, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.194 Vali Acc: 0.612 Test Loss: 1.194 Test Acc: 0.612
Validation loss decreased (-0.585514 --> -0.611830).  Saving model ...
Epoch: 10 cost time: 0.8245468139648438
Epoch: 10, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.158 Vali Acc: 0.691 Test Loss: 1.158 Test Acc: 0.691
Validation loss decreased (-0.611830 --> -0.690778).  Saving model ...
Epoch: 11 cost time: 0.7687788009643555
Epoch: 11, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.122 Vali Acc: 0.697 Test Loss: 1.122 Test Acc: 0.697
Validation loss decreased (-0.690778 --> -0.697357).  Saving model ...
Epoch: 12 cost time: 0.7364718914031982
Epoch: 12, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.085 Vali Acc: 0.730 Test Loss: 1.085 Test Acc: 0.730
Validation loss decreased (-0.697357 --> -0.730252).  Saving model ...
Epoch: 13 cost time: 0.7576971054077148
Epoch: 13, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.049 Vali Acc: 0.737 Test Loss: 1.049 Test Acc: 0.737
Validation loss decreased (-0.730252 --> -0.736832).  Saving model ...
Epoch: 14 cost time: 0.7725517749786377
Epoch: 14, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.013 Vali Acc: 0.757 Test Loss: 1.013 Test Acc: 0.757
Validation loss decreased (-0.736832 --> -0.756569).  Saving model ...
Epoch: 15 cost time: 0.7295503616333008
Epoch: 15, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.978 Vali Acc: 0.743 Test Loss: 0.978 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8271057605743408
Epoch: 16, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.944 Vali Acc: 0.763 Test Loss: 0.944 Test Acc: 0.763
Validation loss decreased (-0.756569 --> -0.763148).  Saving model ...
Epoch: 17 cost time: 0.7444331645965576
Epoch: 17, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.910 Vali Acc: 0.770 Test Loss: 0.910 Test Acc: 0.770
Validation loss decreased (-0.763148 --> -0.769728).  Saving model ...
Epoch: 18 cost time: 0.7172369956970215
Epoch: 18, Steps: 10 | Train Loss: 0.776 Vali Loss: 0.878 Vali Acc: 0.770 Test Loss: 0.878 Test Acc: 0.770
Validation loss decreased (-0.769728 --> -0.769728).  Saving model ...
Epoch: 19 cost time: 0.708319902420044
Epoch: 19, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.847 Vali Acc: 0.783 Test Loss: 0.847 Test Acc: 0.783
Validation loss decreased (-0.769728 --> -0.782886).  Saving model ...
Epoch: 20 cost time: 0.7634255886077881
Epoch: 20, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.820 Vali Acc: 0.776 Test Loss: 0.820 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8607892990112305
Epoch: 21, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
Validation loss decreased (-0.782886 --> -0.802624).  Saving model ...
Epoch: 22 cost time: 0.9673919677734375
Epoch: 22, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.766 Vali Acc: 0.809 Test Loss: 0.766 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 23 cost time: 0.682100772857666
Epoch: 23, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7312197685241699
Epoch: 24, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.716 Vali Acc: 0.816 Test Loss: 0.716 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815782).  Saving model ...
Epoch: 25 cost time: 0.8166491985321045
Epoch: 25, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7603347301483154
Epoch: 26, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
Validation loss decreased (-0.815782 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 0.7132632732391357
Epoch: 27, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.655 Vali Acc: 0.816 Test Loss: 0.655 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 28 cost time: 0.8791158199310303
Epoch: 28, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.887601375579834
Epoch: 29, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7637994289398193
Epoch: 30, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7724447250366211
Epoch: 31, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8094942569732666
Epoch: 32, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6492924690246582
Epoch: 33, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7091250419616699
Epoch: 34, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7152109146118164
Epoch: 35, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7306175231933594
Epoch: 36, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8013012409210205
Epoch: 37, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w3_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 17012
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3352291584014893
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.422 Vali Acc: 0.191 Test Loss: 1.422 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 0.7218496799468994
Epoch: 2, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.408 Vali Acc: 0.217 Test Loss: 1.408 Test Acc: 0.217
Validation loss decreased (-0.190775 --> -0.217091).  Saving model ...
Epoch: 3 cost time: 0.7314732074737549
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.389 Vali Acc: 0.230 Test Loss: 1.389 Test Acc: 0.230
Validation loss decreased (-0.217091 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 0.7040596008300781
Epoch: 4, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.366 Vali Acc: 0.250 Test Loss: 1.366 Test Acc: 0.250
Validation loss decreased (-0.230249 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.7566428184509277
Epoch: 5, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.342 Vali Acc: 0.283 Test Loss: 1.342 Test Acc: 0.283
Validation loss decreased (-0.249986 --> -0.282881).  Saving model ...
Epoch: 6 cost time: 0.6284873485565186
Epoch: 6, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.317 Vali Acc: 0.362 Test Loss: 1.317 Test Acc: 0.362
Validation loss decreased (-0.282881 --> -0.361829).  Saving model ...
Epoch: 7 cost time: 0.6078097820281982
Epoch: 7, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.290 Vali Acc: 0.461 Test Loss: 1.290 Test Acc: 0.461
Validation loss decreased (-0.361829 --> -0.460513).  Saving model ...
Epoch: 8 cost time: 0.67250657081604
Epoch: 8, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.263 Vali Acc: 0.487 Test Loss: 1.263 Test Acc: 0.487
Validation loss decreased (-0.460513 --> -0.486829).  Saving model ...
Epoch: 9 cost time: 0.7033340930938721
Epoch: 9, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.235 Vali Acc: 0.526 Test Loss: 1.235 Test Acc: 0.526
Validation loss decreased (-0.486829 --> -0.526303).  Saving model ...
Epoch: 10 cost time: 0.7525415420532227
Epoch: 10, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.207 Vali Acc: 0.559 Test Loss: 1.207 Test Acc: 0.559
Validation loss decreased (-0.526303 --> -0.559198).  Saving model ...
Epoch: 11 cost time: 0.9204921722412109
Epoch: 11, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.178 Vali Acc: 0.579 Test Loss: 1.178 Test Acc: 0.579
Validation loss decreased (-0.559198 --> -0.578936).  Saving model ...
Epoch: 12 cost time: 0.8150484561920166
Epoch: 12, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.148 Vali Acc: 0.592 Test Loss: 1.148 Test Acc: 0.592
Validation loss decreased (-0.578936 --> -0.592094).  Saving model ...
Epoch: 13 cost time: 0.851374626159668
Epoch: 13, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.115 Vali Acc: 0.586 Test Loss: 1.115 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7822189331054688
Epoch: 14, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.082 Vali Acc: 0.599 Test Loss: 1.082 Test Acc: 0.599
Validation loss decreased (-0.592094 --> -0.598673).  Saving model ...
Epoch: 15 cost time: 0.7579550743103027
Epoch: 15, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.050 Vali Acc: 0.618 Test Loss: 1.050 Test Acc: 0.618
Validation loss decreased (-0.598673 --> -0.618411).  Saving model ...
Epoch: 16 cost time: 0.8204441070556641
Epoch: 16, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.016 Vali Acc: 0.632 Test Loss: 1.016 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631569).  Saving model ...
Epoch: 17 cost time: 0.7363133430480957
Epoch: 17, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.983 Vali Acc: 0.645 Test Loss: 0.983 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644727).  Saving model ...
Epoch: 18 cost time: 0.796978235244751
Epoch: 18, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.948 Vali Acc: 0.658 Test Loss: 0.948 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657885).  Saving model ...
Epoch: 19 cost time: 0.8259303569793701
Epoch: 19, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.917 Vali Acc: 0.684 Test Loss: 0.917 Test Acc: 0.684
Validation loss decreased (-0.657885 --> -0.684201).  Saving model ...
Epoch: 20 cost time: 0.6199193000793457
Epoch: 20, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.885 Vali Acc: 0.697 Test Loss: 0.885 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 21 cost time: 0.7050302028656006
Epoch: 21, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.852 Vali Acc: 0.711 Test Loss: 0.852 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710518).  Saving model ...
Epoch: 22 cost time: 0.7105007171630859
Epoch: 22, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.820 Vali Acc: 0.730 Test Loss: 0.820 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 23 cost time: 0.7370173931121826
Epoch: 23, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.786 Vali Acc: 0.757 Test Loss: 0.786 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756571).  Saving model ...
Epoch: 24 cost time: 0.7014830112457275
Epoch: 24, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.754 Vali Acc: 0.770 Test Loss: 0.754 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 25 cost time: 0.8265402317047119
Epoch: 25, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
Validation loss decreased (-0.769729 --> -0.789466).  Saving model ...
Epoch: 26 cost time: 0.6755790710449219
Epoch: 26, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7300820350646973
Epoch: 27, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7276856899261475
Epoch: 28, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802625).  Saving model ...
Epoch: 29 cost time: 0.6949524879455566
Epoch: 29, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 30 cost time: 0.8083806037902832
Epoch: 30, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 31 cost time: 0.7675714492797852
Epoch: 31, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8121442794799805
Epoch: 32, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 33 cost time: 0.7490170001983643
Epoch: 33, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8418927192687988
Epoch: 34, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7620313167572021
Epoch: 35, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7454612255096436
Epoch: 36, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 37 cost time: 0.6726748943328857
Epoch: 37, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 38 cost time: 0.602588415145874
Epoch: 38, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7274312973022461
Epoch: 39, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 40 cost time: 0.7212989330291748
Epoch: 40, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6242861747741699
Epoch: 41, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 42 cost time: 0.7016854286193848
Epoch: 42, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.656691312789917
Epoch: 43, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7120234966278076
Epoch: 44, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 45 cost time: 0.7364590167999268
Epoch: 45, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 46 cost time: 0.7349491119384766
Epoch: 46, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7625784873962402
Epoch: 47, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7853515148162842
Epoch: 48, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 49 cost time: 0.7312695980072021
Epoch: 49, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 50 cost time: 0.8342249393463135
Epoch: 50, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8397493362426758
Epoch: 51, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.509 Vali Acc: 0.822 Test Loss: 0.509 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7601203918457031
Epoch: 52, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8201706409454346
Epoch: 53, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7937812805175781
Epoch: 54, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.7589731216430664
Epoch: 55, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.6723277568817139
Epoch: 56, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.7672574520111084
Epoch: 57, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.6892540454864502
Epoch: 58, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.8199896812438965
Epoch: 59, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w2_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 16756
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0662195682525635
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.6882956027984619
Epoch: 2, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.401 Vali Acc: 0.263 Test Loss: 1.401 Test Acc: 0.263
Validation loss decreased (-0.256565 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 0.6401927471160889
Epoch: 3, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.377 Vali Acc: 0.303 Test Loss: 1.377 Test Acc: 0.303
Validation loss decreased (-0.263144 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.6691920757293701
Epoch: 4, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.352 Vali Acc: 0.342 Test Loss: 1.352 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 0.8253693580627441
Epoch: 5, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.327 Vali Acc: 0.368 Test Loss: 1.327 Test Acc: 0.368
Validation loss decreased (-0.342092 --> -0.368408).  Saving model ...
Epoch: 6 cost time: 0.6653580665588379
Epoch: 6, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.302 Vali Acc: 0.382 Test Loss: 1.302 Test Acc: 0.382
Validation loss decreased (-0.368408 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 0.5815384387969971
Epoch: 7, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.277 Vali Acc: 0.461 Test Loss: 1.277 Test Acc: 0.461
Validation loss decreased (-0.381566 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 0.6381855010986328
Epoch: 8, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.460514 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.6494648456573486
Epoch: 9, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.223 Vali Acc: 0.572 Test Loss: 1.223 Test Acc: 0.572
Validation loss decreased (-0.499987 --> -0.572356).  Saving model ...
Epoch: 10 cost time: 0.5636961460113525
Epoch: 10, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.194 Vali Acc: 0.618 Test Loss: 1.194 Test Acc: 0.618
Validation loss decreased (-0.572356 --> -0.618409).  Saving model ...
Epoch: 11 cost time: 0.6228344440460205
Epoch: 11, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.166 Vali Acc: 0.638 Test Loss: 1.166 Test Acc: 0.638
Validation loss decreased (-0.618409 --> -0.638146).  Saving model ...
Epoch: 12 cost time: 0.6531882286071777
Epoch: 12, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.135 Vali Acc: 0.684 Test Loss: 1.135 Test Acc: 0.684
Validation loss decreased (-0.638146 --> -0.684199).  Saving model ...
Epoch: 13 cost time: 0.6261086463928223
Epoch: 13, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.106 Vali Acc: 0.697 Test Loss: 1.106 Test Acc: 0.697
Validation loss decreased (-0.684199 --> -0.697357).  Saving model ...
Epoch: 14 cost time: 0.5809142589569092
Epoch: 14, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.074 Vali Acc: 0.711 Test Loss: 1.074 Test Acc: 0.711
Validation loss decreased (-0.697357 --> -0.710516).  Saving model ...
Epoch: 15 cost time: 0.6435534954071045
Epoch: 15, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.041 Vali Acc: 0.711 Test Loss: 1.041 Test Acc: 0.711
Validation loss decreased (-0.710516 --> -0.710516).  Saving model ...
Epoch: 16 cost time: 0.6153097152709961
Epoch: 16, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.010 Vali Acc: 0.730 Test Loss: 1.010 Test Acc: 0.730
Validation loss decreased (-0.710516 --> -0.730253).  Saving model ...
Epoch: 17 cost time: 0.6281735897064209
Epoch: 17, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6833572387695312
Epoch: 18, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.942 Vali Acc: 0.730 Test Loss: 0.942 Test Acc: 0.730
Validation loss decreased (-0.730253 --> -0.730254).  Saving model ...
Epoch: 19 cost time: 0.6642017364501953
Epoch: 19, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.912 Vali Acc: 0.737 Test Loss: 0.912 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736833).  Saving model ...
Epoch: 20 cost time: 0.6884369850158691
Epoch: 20, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.5666930675506592
Epoch: 21, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.7071318626403809
Epoch: 22, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.820 Vali Acc: 0.743 Test Loss: 0.820 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6644248962402344
Epoch: 23, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.7115237712860107
Epoch: 24, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.768 Vali Acc: 0.763 Test Loss: 0.768 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 25 cost time: 0.5934858322143555
Epoch: 25, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.746 Vali Acc: 0.763 Test Loss: 0.746 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 26 cost time: 0.6037333011627197
Epoch: 26, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.728 Vali Acc: 0.757 Test Loss: 0.728 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5569274425506592
Epoch: 27, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.712 Vali Acc: 0.757 Test Loss: 0.712 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5449168682098389
Epoch: 28, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.694 Vali Acc: 0.757 Test Loss: 0.694 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5291249752044678
Epoch: 29, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 30 cost time: 0.5451581478118896
Epoch: 30, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.667 Vali Acc: 0.776 Test Loss: 0.667 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 31 cost time: 0.5650525093078613
Epoch: 31, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.652 Vali Acc: 0.770 Test Loss: 0.652 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6142106056213379
Epoch: 32, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6418514251708984
Epoch: 33, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 34 cost time: 0.5951981544494629
Epoch: 34, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.619 Vali Acc: 0.776 Test Loss: 0.619 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 0.6357715129852295
Epoch: 35, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4996461868286133
Epoch: 36, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 37 cost time: 0.5802173614501953
Epoch: 37, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 38 cost time: 0.4645497798919678
Epoch: 38, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5476069450378418
Epoch: 39, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.49272990226745605
Epoch: 40, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 41 cost time: 0.5553159713745117
Epoch: 41, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 42 cost time: 0.6232659816741943
Epoch: 42, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 43 cost time: 0.46108293533325195
Epoch: 43, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 44 cost time: 0.5825388431549072
Epoch: 44, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 45 cost time: 0.5777313709259033
Epoch: 45, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 46 cost time: 0.5424892902374268
Epoch: 46, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5846545696258545
Epoch: 47, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 48 cost time: 0.5857117176055908
Epoch: 48, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 49 cost time: 0.5209286212921143
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 50 cost time: 0.5510189533233643
Epoch: 50, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5346875190734863
Epoch: 51, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.533320426940918
Epoch: 52, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5810902118682861
Epoch: 53, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5551817417144775
Epoch: 54, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5769281387329102
Epoch: 55, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5651679039001465
Epoch: 56, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.6123979091644287
Epoch: 57, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.6581661701202393
Epoch: 58, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.5409069061279297
Epoch: 59, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w1_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 16500
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.866722583770752
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.6062142848968506
Epoch: 2, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.401 Vali Acc: 0.263 Test Loss: 1.401 Test Acc: 0.263
Validation loss decreased (-0.256565 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 0.5467495918273926
Epoch: 3, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.377 Vali Acc: 0.303 Test Loss: 1.377 Test Acc: 0.303
Validation loss decreased (-0.263144 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.6834819316864014
Epoch: 4, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.352 Vali Acc: 0.342 Test Loss: 1.352 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 0.6048202514648438
Epoch: 5, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.327 Vali Acc: 0.368 Test Loss: 1.327 Test Acc: 0.368
Validation loss decreased (-0.342092 --> -0.368408).  Saving model ...
Epoch: 6 cost time: 0.5669527053833008
Epoch: 6, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.302 Vali Acc: 0.382 Test Loss: 1.302 Test Acc: 0.382
Validation loss decreased (-0.368408 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 0.6113743782043457
Epoch: 7, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.277 Vali Acc: 0.461 Test Loss: 1.277 Test Acc: 0.461
Validation loss decreased (-0.381566 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 0.5683867931365967
Epoch: 8, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.460514 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.5391955375671387
Epoch: 9, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.223 Vali Acc: 0.572 Test Loss: 1.223 Test Acc: 0.572
Validation loss decreased (-0.499987 --> -0.572356).  Saving model ...
Epoch: 10 cost time: 0.5403382778167725
Epoch: 10, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.194 Vali Acc: 0.618 Test Loss: 1.194 Test Acc: 0.618
Validation loss decreased (-0.572356 --> -0.618409).  Saving model ...
Epoch: 11 cost time: 0.5664248466491699
Epoch: 11, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.166 Vali Acc: 0.638 Test Loss: 1.166 Test Acc: 0.638
Validation loss decreased (-0.618409 --> -0.638146).  Saving model ...
Epoch: 12 cost time: 0.5459306240081787
Epoch: 12, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.135 Vali Acc: 0.684 Test Loss: 1.135 Test Acc: 0.684
Validation loss decreased (-0.638146 --> -0.684199).  Saving model ...
Epoch: 13 cost time: 0.5518612861633301
Epoch: 13, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.106 Vali Acc: 0.697 Test Loss: 1.106 Test Acc: 0.697
Validation loss decreased (-0.684199 --> -0.697357).  Saving model ...
Epoch: 14 cost time: 0.6640708446502686
Epoch: 14, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.074 Vali Acc: 0.711 Test Loss: 1.074 Test Acc: 0.711
Validation loss decreased (-0.697357 --> -0.710516).  Saving model ...
Epoch: 15 cost time: 0.5152606964111328
Epoch: 15, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.041 Vali Acc: 0.711 Test Loss: 1.041 Test Acc: 0.711
Validation loss decreased (-0.710516 --> -0.710516).  Saving model ...
Epoch: 16 cost time: 0.5681195259094238
Epoch: 16, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.010 Vali Acc: 0.730 Test Loss: 1.010 Test Acc: 0.730
Validation loss decreased (-0.710516 --> -0.730253).  Saving model ...
Epoch: 17 cost time: 0.6081311702728271
Epoch: 17, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5385005474090576
Epoch: 18, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.942 Vali Acc: 0.730 Test Loss: 0.942 Test Acc: 0.730
Validation loss decreased (-0.730253 --> -0.730254).  Saving model ...
Epoch: 19 cost time: 0.6222960948944092
Epoch: 19, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.912 Vali Acc: 0.737 Test Loss: 0.912 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736833).  Saving model ...
Epoch: 20 cost time: 0.625762939453125
Epoch: 20, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.5541317462921143
Epoch: 21, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.570314884185791
Epoch: 22, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.820 Vali Acc: 0.743 Test Loss: 0.820 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5409736633300781
Epoch: 23, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.5384538173675537
Epoch: 24, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.768 Vali Acc: 0.763 Test Loss: 0.768 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 25 cost time: 0.5659918785095215
Epoch: 25, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.746 Vali Acc: 0.763 Test Loss: 0.746 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 26 cost time: 0.5763113498687744
Epoch: 26, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.728 Vali Acc: 0.757 Test Loss: 0.728 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5578560829162598
Epoch: 27, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.712 Vali Acc: 0.757 Test Loss: 0.712 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6775743961334229
Epoch: 28, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.694 Vali Acc: 0.757 Test Loss: 0.694 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4958302974700928
Epoch: 29, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 30 cost time: 0.5539398193359375
Epoch: 30, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.667 Vali Acc: 0.776 Test Loss: 0.667 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 31 cost time: 0.6251392364501953
Epoch: 31, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.652 Vali Acc: 0.770 Test Loss: 0.652 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6043767929077148
Epoch: 32, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5460376739501953
Epoch: 33, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 34 cost time: 0.5675575733184814
Epoch: 34, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.619 Vali Acc: 0.776 Test Loss: 0.619 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 0.5074148178100586
Epoch: 35, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5034294128417969
Epoch: 36, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 37 cost time: 0.5706713199615479
Epoch: 37, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 38 cost time: 0.5223183631896973
Epoch: 38, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5341095924377441
Epoch: 39, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5469691753387451
Epoch: 40, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 41 cost time: 0.5042591094970703
Epoch: 41, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 42 cost time: 0.5287759304046631
Epoch: 42, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 43 cost time: 0.5287477970123291
Epoch: 43, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 44 cost time: 0.5173969268798828
Epoch: 44, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 45 cost time: 0.5025289058685303
Epoch: 45, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 46 cost time: 0.5165324211120605
Epoch: 46, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6100358963012695
Epoch: 47, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 48 cost time: 0.5421617031097412
Epoch: 48, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 49 cost time: 0.5805494785308838
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 50 cost time: 0.572157621383667
Epoch: 50, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5477776527404785
Epoch: 51, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6185517311096191
Epoch: 52, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.597337007522583
Epoch: 53, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5363578796386719
Epoch: 54, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5849306583404541
Epoch: 55, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5635006427764893
Epoch: 56, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5634684562683105
Epoch: 57, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.5727570056915283
Epoch: 58, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.5435683727264404
Epoch: 59, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 16500
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.9963057041168213
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.488 Vali Acc: 0.263 Test Loss: 1.488 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 0.684988260269165
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.464 Vali Acc: 0.283 Test Loss: 1.464 Test Acc: 0.283
Validation loss decreased (-0.263143 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 0.6440603733062744
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.427 Vali Acc: 0.336 Test Loss: 1.427 Test Acc: 0.336
Validation loss decreased (-0.282880 --> -0.335512).  Saving model ...
Epoch: 4 cost time: 0.6372604370117188
Epoch: 4, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.384 Vali Acc: 0.362 Test Loss: 1.384 Test Acc: 0.362
Validation loss decreased (-0.335512 --> -0.361828).  Saving model ...
Epoch: 5 cost time: 0.591153621673584
Epoch: 5, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.342 Vali Acc: 0.382 Test Loss: 1.342 Test Acc: 0.382
Validation loss decreased (-0.361828 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 0.634465217590332
Epoch: 6, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.301 Vali Acc: 0.434 Test Loss: 1.301 Test Acc: 0.434
Validation loss decreased (-0.381566 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 0.5814118385314941
Epoch: 7, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.258 Vali Acc: 0.493 Test Loss: 1.258 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493408).  Saving model ...
Epoch: 8 cost time: 0.683610200881958
Epoch: 8, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.493408 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.5688419342041016
Epoch: 9, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.173 Vali Acc: 0.586 Test Loss: 1.173 Test Acc: 0.586
Validation loss decreased (-0.499988 --> -0.585515).  Saving model ...
Epoch: 10 cost time: 0.559420108795166
Epoch: 10, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.125 Vali Acc: 0.632 Test Loss: 1.125 Test Acc: 0.632
Validation loss decreased (-0.585515 --> -0.631568).  Saving model ...
Epoch: 11 cost time: 0.476635217666626
Epoch: 11, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.079 Vali Acc: 0.658 Test Loss: 1.079 Test Acc: 0.658
Validation loss decreased (-0.631568 --> -0.657884).  Saving model ...
Epoch: 12 cost time: 0.575115442276001
Epoch: 12, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.039 Vali Acc: 0.684 Test Loss: 1.039 Test Acc: 0.684
Validation loss decreased (-0.657884 --> -0.684200).  Saving model ...
Epoch: 13 cost time: 0.6895442008972168
Epoch: 13, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.003 Vali Acc: 0.711 Test Loss: 1.003 Test Acc: 0.711
Validation loss decreased (-0.684200 --> -0.710516).  Saving model ...
Epoch: 14 cost time: 0.5509665012359619
Epoch: 14, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.966 Vali Acc: 0.737 Test Loss: 0.966 Test Acc: 0.737
Validation loss decreased (-0.710516 --> -0.736832).  Saving model ...
Epoch: 15 cost time: 0.5864729881286621
Epoch: 15, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.932 Vali Acc: 0.737 Test Loss: 0.932 Test Acc: 0.737
Validation loss decreased (-0.736832 --> -0.736833).  Saving model ...
Epoch: 16 cost time: 0.5927729606628418
Epoch: 16, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.901 Vali Acc: 0.757 Test Loss: 0.901 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756570).  Saving model ...
Epoch: 17 cost time: 0.6246345043182373
Epoch: 17, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.869 Vali Acc: 0.776 Test Loss: 0.869 Test Acc: 0.776
Validation loss decreased (-0.756570 --> -0.776307).  Saving model ...
Epoch: 18 cost time: 0.6854984760284424
Epoch: 18, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.838 Vali Acc: 0.776 Test Loss: 0.838 Test Acc: 0.776
Validation loss decreased (-0.776307 --> -0.776307).  Saving model ...
Epoch: 19 cost time: 0.7132618427276611
Epoch: 19, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.811 Vali Acc: 0.809 Test Loss: 0.811 Test Acc: 0.809
Validation loss decreased (-0.776307 --> -0.809202).  Saving model ...
Epoch: 20 cost time: 0.6783785820007324
Epoch: 20, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.791 Vali Acc: 0.796 Test Loss: 0.791 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5651998519897461
Epoch: 21, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.767 Vali Acc: 0.816 Test Loss: 0.767 Test Acc: 0.816
Validation loss decreased (-0.809202 --> -0.815782).  Saving model ...
Epoch: 22 cost time: 0.5779805183410645
Epoch: 22, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.744 Vali Acc: 0.809 Test Loss: 0.744 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5946252346038818
Epoch: 23, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.728 Vali Acc: 0.816 Test Loss: 0.728 Test Acc: 0.816
Validation loss decreased (-0.815782 --> -0.815782).  Saving model ...
Epoch: 24 cost time: 0.6425635814666748
Epoch: 24, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.708 Vali Acc: 0.829 Test Loss: 0.708 Test Acc: 0.829
Validation loss decreased (-0.815782 --> -0.828940).  Saving model ...
Epoch: 25 cost time: 0.5340986251831055
Epoch: 25, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.688 Vali Acc: 0.829 Test Loss: 0.688 Test Acc: 0.829
Validation loss decreased (-0.828940 --> -0.828940).  Saving model ...
Epoch: 26 cost time: 0.559227466583252
Epoch: 26, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.531426191329956
Epoch: 27, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6328539848327637
Epoch: 28, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6082754135131836
Epoch: 29, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6647143363952637
Epoch: 30, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5505914688110352
Epoch: 31, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.620 Vali Acc: 0.816 Test Loss: 0.620 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5649330615997314
Epoch: 32, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5986368656158447
Epoch: 33, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.604 Vali Acc: 0.829 Test Loss: 0.604 Test Acc: 0.829
Validation loss decreased (-0.828940 --> -0.828941).  Saving model ...
Epoch: 34 cost time: 0.6315100193023682
Epoch: 34, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.598 Vali Acc: 0.829 Test Loss: 0.598 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828941).  Saving model ...
Epoch: 35 cost time: 0.6444051265716553
Epoch: 35, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.586 Vali Acc: 0.842 Test Loss: 0.586 Test Acc: 0.842
Validation loss decreased (-0.828941 --> -0.842099).  Saving model ...
Epoch: 36 cost time: 0.6718597412109375
Epoch: 36, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
Validation loss decreased (-0.842099 --> -0.855257).  Saving model ...
Epoch: 37 cost time: 0.6465592384338379
Epoch: 37, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.576 Vali Acc: 0.829 Test Loss: 0.576 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7122130393981934
Epoch: 38, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.566 Vali Acc: 0.836 Test Loss: 0.566 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6316943168640137
Epoch: 39, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.562 Vali Acc: 0.836 Test Loss: 0.562 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6051838397979736
Epoch: 40, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.557 Vali Acc: 0.836 Test Loss: 0.557 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6577684879302979
Epoch: 41, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.551 Vali Acc: 0.836 Test Loss: 0.551 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7205948829650879
Epoch: 42, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.549 Vali Acc: 0.829 Test Loss: 0.549 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5599663257598877
Epoch: 43, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.553 Vali Acc: 0.836 Test Loss: 0.553 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6263918876647949
Epoch: 44, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.549 Vali Acc: 0.836 Test Loss: 0.549 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6380794048309326
Epoch: 45, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.548 Vali Acc: 0.829 Test Loss: 0.548 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6525726318359375
Epoch: 46, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.546 Vali Acc: 0.829 Test Loss: 0.546 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w4_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 17204
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1644725799560547
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.412 Vali Acc: 0.237 Test Loss: 1.412 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 0.5774850845336914
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.381 Vali Acc: 0.283 Test Loss: 1.381 Test Acc: 0.283
Validation loss decreased (-0.236828 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 0.590186357498169
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.340 Vali Acc: 0.336 Test Loss: 1.340 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 0.6104779243469238
Epoch: 4, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.295 Vali Acc: 0.388 Test Loss: 1.295 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 0.5861310958862305
Epoch: 5, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.246 Vali Acc: 0.414 Test Loss: 1.246 Test Acc: 0.414
Validation loss decreased (-0.388145 --> -0.414461).  Saving model ...
Epoch: 6 cost time: 0.5057454109191895
Epoch: 6, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.199 Vali Acc: 0.428 Test Loss: 1.199 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427620).  Saving model ...
Epoch: 7 cost time: 0.5401711463928223
Epoch: 7, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.156 Vali Acc: 0.480 Test Loss: 1.156 Test Acc: 0.480
Validation loss decreased (-0.427620 --> -0.480252).  Saving model ...
Epoch: 8 cost time: 0.5455951690673828
Epoch: 8, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.113 Vali Acc: 0.513 Test Loss: 1.113 Test Acc: 0.513
Validation loss decreased (-0.480252 --> -0.513147).  Saving model ...
Epoch: 9 cost time: 0.5454442501068115
Epoch: 9, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.073 Vali Acc: 0.553 Test Loss: 1.073 Test Acc: 0.553
Validation loss decreased (-0.513147 --> -0.552621).  Saving model ...
Epoch: 10 cost time: 0.5325541496276855
Epoch: 10, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.037 Vali Acc: 0.566 Test Loss: 1.037 Test Acc: 0.566
Validation loss decreased (-0.552621 --> -0.565779).  Saving model ...
Epoch: 11 cost time: 0.5098106861114502
Epoch: 11, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.004 Vali Acc: 0.579 Test Loss: 1.004 Test Acc: 0.579
Validation loss decreased (-0.565779 --> -0.578937).  Saving model ...
Epoch: 12 cost time: 0.46123361587524414
Epoch: 12, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.973 Vali Acc: 0.638 Test Loss: 0.973 Test Acc: 0.638
Validation loss decreased (-0.578937 --> -0.638148).  Saving model ...
Epoch: 13 cost time: 0.5276057720184326
Epoch: 13, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.942 Vali Acc: 0.678 Test Loss: 0.942 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677622).  Saving model ...
Epoch: 14 cost time: 0.5475804805755615
Epoch: 14, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.915 Vali Acc: 0.697 Test Loss: 0.915 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697359).  Saving model ...
Epoch: 15 cost time: 0.5925114154815674
Epoch: 15, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.886 Vali Acc: 0.697 Test Loss: 0.886 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697360).  Saving model ...
Epoch: 16 cost time: 0.5566363334655762
Epoch: 16, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 17 cost time: 0.5712120532989502
Epoch: 17, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.837 Vali Acc: 0.743 Test Loss: 0.837 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743413).  Saving model ...
Epoch: 18 cost time: 0.5858874320983887
Epoch: 18, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.814 Vali Acc: 0.763 Test Loss: 0.814 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 19 cost time: 0.5785937309265137
Epoch: 19, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.792 Vali Acc: 0.770 Test Loss: 0.792 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 20 cost time: 0.540184736251831
Epoch: 20, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.772 Vali Acc: 0.763 Test Loss: 0.772 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5006792545318604
Epoch: 21, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.755 Vali Acc: 0.770 Test Loss: 0.755 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769729).  Saving model ...
Epoch: 22 cost time: 0.4806358814239502
Epoch: 22, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.737 Vali Acc: 0.763 Test Loss: 0.737 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4972422122955322
Epoch: 23, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5756983757019043
Epoch: 24, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.704 Vali Acc: 0.737 Test Loss: 0.704 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5092976093292236
Epoch: 25, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5747585296630859
Epoch: 26, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6255717277526855
Epoch: 27, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.631239652633667
Epoch: 28, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5229771137237549
Epoch: 29, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.643 Vali Acc: 0.730 Test Loss: 0.643 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6329967975616455
Epoch: 30, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.628 Vali Acc: 0.743 Test Loss: 0.628 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5637466907501221
Epoch: 31, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w3_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 16948
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.8028771877288818
Epoch: 1, Steps: 10 | Train Loss: 1.539 Vali Loss: 1.496 Vali Acc: 0.184 Test Loss: 1.496 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 0.5778651237487793
Epoch: 2, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.461 Vali Acc: 0.197 Test Loss: 1.461 Test Acc: 0.197
Validation loss decreased (-0.184196 --> -0.197354).  Saving model ...
Epoch: 3 cost time: 0.5434353351593018
Epoch: 3, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.414 Vali Acc: 0.263 Test Loss: 1.414 Test Acc: 0.263
Validation loss decreased (-0.197354 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 0.5617797374725342
Epoch: 4, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.360 Vali Acc: 0.309 Test Loss: 1.360 Test Acc: 0.309
Validation loss decreased (-0.263144 --> -0.309197).  Saving model ...
Epoch: 5 cost time: 0.5610256195068359
Epoch: 5, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.305 Vali Acc: 0.375 Test Loss: 1.305 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5743513107299805
Epoch: 6, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.248 Vali Acc: 0.467 Test Loss: 1.248 Test Acc: 0.467
Validation loss decreased (-0.374987 --> -0.467093).  Saving model ...
Epoch: 7 cost time: 0.5631248950958252
Epoch: 7, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.192 Vali Acc: 0.559 Test Loss: 1.192 Test Acc: 0.559
Validation loss decreased (-0.467093 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 0.5841865539550781
Epoch: 8, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.148 Vali Acc: 0.618 Test Loss: 1.148 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618410).  Saving model ...
Epoch: 9 cost time: 0.5671200752258301
Epoch: 9, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.107 Vali Acc: 0.625 Test Loss: 1.107 Test Acc: 0.625
Validation loss decreased (-0.618410 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.5842976570129395
Epoch: 10, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.071 Vali Acc: 0.664 Test Loss: 1.071 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664463).  Saving model ...
Epoch: 11 cost time: 0.6172263622283936
Epoch: 11, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.036 Vali Acc: 0.704 Test Loss: 1.036 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703937).  Saving model ...
Epoch: 12 cost time: 0.6846017837524414
Epoch: 12, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.002 Vali Acc: 0.724 Test Loss: 1.002 Test Acc: 0.724
Validation loss decreased (-0.703937 --> -0.723674).  Saving model ...
Epoch: 13 cost time: 0.707378625869751
Epoch: 13, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.969 Vali Acc: 0.730 Test Loss: 0.969 Test Acc: 0.730
Validation loss decreased (-0.723674 --> -0.730253).  Saving model ...
Epoch: 14 cost time: 0.6700115203857422
Epoch: 14, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.937 Vali Acc: 0.730 Test Loss: 0.937 Test Acc: 0.730
Validation loss decreased (-0.730253 --> -0.730254).  Saving model ...
Epoch: 15 cost time: 0.5236594676971436
Epoch: 15, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.904 Vali Acc: 0.743 Test Loss: 0.904 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743412).  Saving model ...
Epoch: 16 cost time: 0.6174411773681641
Epoch: 16, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.876 Vali Acc: 0.730 Test Loss: 0.876 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6408417224884033
Epoch: 17, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.850 Vali Acc: 0.737 Test Loss: 0.850 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6459038257598877
Epoch: 18, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.820 Vali Acc: 0.750 Test Loss: 0.820 Test Acc: 0.750
Validation loss decreased (-0.743412 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 0.5898280143737793
Epoch: 19, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.795 Vali Acc: 0.757 Test Loss: 0.795 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756571).  Saving model ...
Epoch: 20 cost time: 0.5495736598968506
Epoch: 20, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.769 Vali Acc: 0.743 Test Loss: 0.769 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6060647964477539
Epoch: 21, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.745 Vali Acc: 0.763 Test Loss: 0.745 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 22 cost time: 0.5947635173797607
Epoch: 22, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5636491775512695
Epoch: 23, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.705 Vali Acc: 0.757 Test Loss: 0.705 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.578831672668457
Epoch: 24, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.689 Vali Acc: 0.770 Test Loss: 0.689 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 0.5997872352600098
Epoch: 25, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.667 Vali Acc: 0.770 Test Loss: 0.667 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 26 cost time: 0.514348030090332
Epoch: 26, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.656 Vali Acc: 0.763 Test Loss: 0.656 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6115469932556152
Epoch: 27, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6075143814086914
Epoch: 28, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6221206188201904
Epoch: 29, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 30 cost time: 0.5973973274230957
Epoch: 30, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 31 cost time: 0.6043977737426758
Epoch: 31, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6517469882965088
Epoch: 32, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.597 Vali Acc: 0.770 Test Loss: 0.597 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5924732685089111
Epoch: 33, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6050662994384766
Epoch: 34, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.673253059387207
Epoch: 35, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.568 Vali Acc: 0.770 Test Loss: 0.568 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.65877366065979
Epoch: 36, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5777890682220459
Epoch: 37, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6110942363739014
Epoch: 38, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5991179943084717
Epoch: 39, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5737783908843994
Epoch: 40, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w2_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 16692
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.9945359230041504
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.407 Vali Acc: 0.303 Test Loss: 1.407 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.598038911819458
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.381 Vali Acc: 0.336 Test Loss: 1.381 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.615635871887207
Epoch: 3, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.347 Vali Acc: 0.408 Test Loss: 1.347 Test Acc: 0.408
Validation loss decreased (-0.335513 --> -0.407881).  Saving model ...
Epoch: 4 cost time: 0.5298209190368652
Epoch: 4, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.308 Vali Acc: 0.447 Test Loss: 1.308 Test Acc: 0.447
Validation loss decreased (-0.407881 --> -0.447355).  Saving model ...
Epoch: 5 cost time: 0.721771240234375
Epoch: 5, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.267 Vali Acc: 0.487 Test Loss: 1.267 Test Acc: 0.487
Validation loss decreased (-0.447355 --> -0.486829).  Saving model ...
Epoch: 6 cost time: 0.6769497394561768
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.225 Vali Acc: 0.533 Test Loss: 1.225 Test Acc: 0.533
Validation loss decreased (-0.486829 --> -0.532882).  Saving model ...
Epoch: 7 cost time: 0.695880651473999
Epoch: 7, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.183 Vali Acc: 0.539 Test Loss: 1.183 Test Acc: 0.539
Validation loss decreased (-0.532882 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 0.6405868530273438
Epoch: 8, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.140 Vali Acc: 0.559 Test Loss: 1.140 Test Acc: 0.559
Validation loss decreased (-0.539462 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 0.5903081893920898
Epoch: 9, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.099 Vali Acc: 0.592 Test Loss: 1.099 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 10 cost time: 0.6808922290802002
Epoch: 10, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.062 Vali Acc: 0.599 Test Loss: 1.062 Test Acc: 0.599
Validation loss decreased (-0.592094 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 0.6432750225067139
Epoch: 11, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.020 Vali Acc: 0.612 Test Loss: 1.020 Test Acc: 0.612
Validation loss decreased (-0.598674 --> -0.611832).  Saving model ...
Epoch: 12 cost time: 0.5613501071929932
Epoch: 12, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.983 Vali Acc: 0.645 Test Loss: 0.983 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644727).  Saving model ...
Epoch: 13 cost time: 0.6005282402038574
Epoch: 13, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.947 Vali Acc: 0.664 Test Loss: 0.947 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664464).  Saving model ...
Epoch: 14 cost time: 0.5978717803955078
Epoch: 14, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.911 Vali Acc: 0.684 Test Loss: 0.911 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 15 cost time: 0.5434308052062988
Epoch: 15, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.881 Vali Acc: 0.671 Test Loss: 0.881 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5150794982910156
Epoch: 16, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.850 Vali Acc: 0.684 Test Loss: 0.850 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 0.6509053707122803
Epoch: 17, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.821 Vali Acc: 0.697 Test Loss: 0.821 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697360).  Saving model ...
Epoch: 18 cost time: 0.7475090026855469
Epoch: 18, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.799 Vali Acc: 0.724 Test Loss: 0.799 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723676).  Saving model ...
Epoch: 19 cost time: 0.6457393169403076
Epoch: 19, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.778 Vali Acc: 0.724 Test Loss: 0.778 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 20 cost time: 0.5814402103424072
Epoch: 20, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.762 Vali Acc: 0.717 Test Loss: 0.762 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6178717613220215
Epoch: 21, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 0.5892610549926758
Epoch: 22, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.728 Vali Acc: 0.743 Test Loss: 0.728 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 0.4820997714996338
Epoch: 23, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.713 Vali Acc: 0.743 Test Loss: 0.713 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 24 cost time: 0.47035884857177734
Epoch: 24, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.703 Vali Acc: 0.743 Test Loss: 0.703 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 25 cost time: 0.5526506900787354
Epoch: 25, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 0.5569920539855957
Epoch: 26, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.686 Vali Acc: 0.757 Test Loss: 0.686 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 27 cost time: 0.5603394508361816
Epoch: 27, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4502677917480469
Epoch: 28, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.670 Vali Acc: 0.743 Test Loss: 0.670 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4916722774505615
Epoch: 29, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5548372268676758
Epoch: 30, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5426342487335205
Epoch: 31, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.656 Vali Acc: 0.757 Test Loss: 0.656 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 32 cost time: 0.39183664321899414
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.654 Vali Acc: 0.763 Test Loss: 0.654 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 33 cost time: 0.48662233352661133
Epoch: 33, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.46056413650512695
Epoch: 34, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4445352554321289
Epoch: 35, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5335369110107422
Epoch: 36, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5116949081420898
Epoch: 37, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.45153379440307617
Epoch: 38, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5466673374176025
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.640 Vali Acc: 0.743 Test Loss: 0.640 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.46268296241760254
Epoch: 40, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.638 Vali Acc: 0.743 Test Loss: 0.638 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.44971299171447754
Epoch: 41, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.4854698181152344
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT1_w1_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 16436
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.74949312210083
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.407 Vali Acc: 0.303 Test Loss: 1.407 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.5202484130859375
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.381 Vali Acc: 0.336 Test Loss: 1.381 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.5376002788543701
Epoch: 3, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.347 Vali Acc: 0.408 Test Loss: 1.347 Test Acc: 0.408
Validation loss decreased (-0.335513 --> -0.407881).  Saving model ...
Epoch: 4 cost time: 0.5038547515869141
Epoch: 4, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.308 Vali Acc: 0.447 Test Loss: 1.308 Test Acc: 0.447
Validation loss decreased (-0.407881 --> -0.447355).  Saving model ...
Epoch: 5 cost time: 0.5597286224365234
Epoch: 5, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.267 Vali Acc: 0.487 Test Loss: 1.267 Test Acc: 0.487
Validation loss decreased (-0.447355 --> -0.486829).  Saving model ...
Epoch: 6 cost time: 0.5292210578918457
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.225 Vali Acc: 0.533 Test Loss: 1.225 Test Acc: 0.533
Validation loss decreased (-0.486829 --> -0.532882).  Saving model ...
Epoch: 7 cost time: 0.5170149803161621
Epoch: 7, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.183 Vali Acc: 0.539 Test Loss: 1.183 Test Acc: 0.539
Validation loss decreased (-0.532882 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 0.48157715797424316
Epoch: 8, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.140 Vali Acc: 0.559 Test Loss: 1.140 Test Acc: 0.559
Validation loss decreased (-0.539462 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 0.47744059562683105
Epoch: 9, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.099 Vali Acc: 0.592 Test Loss: 1.099 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 10 cost time: 0.508660078048706
Epoch: 10, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.062 Vali Acc: 0.599 Test Loss: 1.062 Test Acc: 0.599
Validation loss decreased (-0.592094 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 0.5507462024688721
Epoch: 11, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.020 Vali Acc: 0.612 Test Loss: 1.020 Test Acc: 0.612
Validation loss decreased (-0.598674 --> -0.611832).  Saving model ...
Epoch: 12 cost time: 0.47551608085632324
Epoch: 12, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.983 Vali Acc: 0.645 Test Loss: 0.983 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644727).  Saving model ...
Epoch: 13 cost time: 0.501338005065918
Epoch: 13, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.947 Vali Acc: 0.664 Test Loss: 0.947 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664464).  Saving model ...
Epoch: 14 cost time: 0.5674376487731934
Epoch: 14, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.911 Vali Acc: 0.684 Test Loss: 0.911 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 15 cost time: 0.618725061416626
Epoch: 15, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.881 Vali Acc: 0.671 Test Loss: 0.881 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5918681621551514
Epoch: 16, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.850 Vali Acc: 0.684 Test Loss: 0.850 Test Acc: 0.684
Validation loss decreased (-0.684201 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 0.6242525577545166
Epoch: 17, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.821 Vali Acc: 0.697 Test Loss: 0.821 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697360).  Saving model ...
Epoch: 18 cost time: 0.5798690319061279
Epoch: 18, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.799 Vali Acc: 0.724 Test Loss: 0.799 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723676).  Saving model ...
Epoch: 19 cost time: 0.5921816825866699
Epoch: 19, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.778 Vali Acc: 0.724 Test Loss: 0.778 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 20 cost time: 0.48694276809692383
Epoch: 20, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.762 Vali Acc: 0.717 Test Loss: 0.762 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5413839817047119
Epoch: 21, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 0.5370051860809326
Epoch: 22, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.728 Vali Acc: 0.743 Test Loss: 0.728 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 0.48106813430786133
Epoch: 23, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.713 Vali Acc: 0.743 Test Loss: 0.713 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 24 cost time: 0.5437266826629639
Epoch: 24, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.703 Vali Acc: 0.743 Test Loss: 0.703 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 25 cost time: 0.5586771965026855
Epoch: 25, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 26 cost time: 0.553290605545044
Epoch: 26, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.686 Vali Acc: 0.757 Test Loss: 0.686 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 27 cost time: 0.5316953659057617
Epoch: 27, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5190515518188477
Epoch: 28, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.670 Vali Acc: 0.743 Test Loss: 0.670 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5657589435577393
Epoch: 29, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5125505924224854
Epoch: 30, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5554163455963135
Epoch: 31, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.656 Vali Acc: 0.757 Test Loss: 0.656 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 32 cost time: 0.5551772117614746
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.654 Vali Acc: 0.763 Test Loss: 0.654 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 33 cost time: 0.5331494808197021
Epoch: 33, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5374786853790283
Epoch: 34, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5067789554595947
Epoch: 35, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.42526698112487793
Epoch: 36, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.589705228805542
Epoch: 37, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5865235328674316
Epoch: 38, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5657949447631836
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.640 Vali Acc: 0.743 Test Loss: 0.640 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5850536823272705
Epoch: 40, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.638 Vali Acc: 0.743 Test Loss: 0.638 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5308759212493896
Epoch: 41, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5022401809692383
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_MTSMixer_UEA_ftM_sl30_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 16436
model size : 0.07MB
