Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9680449962615967
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 1.1186025142669678
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.0891335010528564
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0036594867706299
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.0009524822235107
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0163767337799072
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.012160301208496
Epoch: 7, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1842734813690186
Epoch: 8, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.024125099182129
Epoch: 9, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1049561500549316
Epoch: 10, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0514538288116455
Epoch: 11, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.186079502105713
Epoch: 12, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.0920794010162354
Epoch: 13, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0744707584381104
Epoch: 14, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2100310325622559
Epoch: 15, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2331435680389404
Epoch: 16, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1061129570007324
Epoch: 17, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 1.166489839553833
Epoch: 18, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2509071826934814
Epoch: 19, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.113698959350586
Epoch: 20, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2468032836914062
Epoch: 21, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0458762645721436
Epoch: 22, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.123622179031372
Epoch: 23, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2359354496002197
Epoch: 24, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.287644624710083
Epoch: 25, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1500349044799805
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5390830039978027
Epoch: 27, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 10916095
model size : 42.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1671714782714844
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 1.0937464237213135
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.96211838722229
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.1049797534942627
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.0412771701812744
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.1974189281463623
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 1.1318490505218506
Epoch: 7, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 1.3566832542419434
Epoch: 8, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3677380084991455
Epoch: 9, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1408517360687256
Epoch: 10, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.039968490600586
Epoch: 11, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8358771800994873
Epoch: 12, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9946146011352539
Epoch: 13, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.018 Vali Acc: 0.400 Test Loss: 1.018 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9366788864135742
Epoch: 14, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.018 Vali Acc: 0.333 Test Loss: 1.018 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9563813209533691
Epoch: 15, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.019 Vali Acc: 0.333 Test Loss: 1.019 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9586865901947021
Epoch: 16, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.020 Vali Acc: 0.333 Test Loss: 1.020 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1405808925628662
Epoch: 17, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.019 Vali Acc: 0.333 Test Loss: 1.019 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 10787071
model size : 41.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.675727128982544
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7509276866912842
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.210 Vali Acc: 0.067 Test Loss: 1.210 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.905667781829834
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.207 Vali Acc: 0.067 Test Loss: 1.207 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.879265308380127
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.206 Vali Acc: 0.133 Test Loss: 1.206 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9318673610687256
Epoch: 5, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.9458568096160889
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8477959632873535
Epoch: 7, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.9027783870697021
Epoch: 8, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.8883624076843262
Epoch: 9, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.9575073719024658
Epoch: 10, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8296515941619873
Epoch: 11, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.206 Vali Acc: 0.067 Test Loss: 1.206 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8605537414550781
Epoch: 12, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.208 Vali Acc: 0.067 Test Loss: 1.208 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8430571556091309
Epoch: 13, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.211 Vali Acc: 0.067 Test Loss: 1.211 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8541820049285889
Epoch: 14, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.216 Vali Acc: 0.133 Test Loss: 1.216 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8406286239624023
Epoch: 15, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.221 Vali Acc: 0.067 Test Loss: 1.221 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9275538921356201
Epoch: 16, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.226 Vali Acc: 0.133 Test Loss: 1.226 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3368799686431885
Epoch: 17, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.231 Vali Acc: 0.133 Test Loss: 1.231 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8971984386444092
Epoch: 18, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.826040506362915
Epoch: 19, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 10660095
model size : 41.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7539446353912354
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.205 Vali Acc: 0.133 Test Loss: 1.205 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.7099428176879883
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.196 Vali Acc: 0.067 Test Loss: 1.196 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6421356201171875
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.190 Vali Acc: 0.067 Test Loss: 1.190 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.597994327545166
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 5 cost time: 0.6290097236633301
Epoch: 5, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.7537257671356201
Epoch: 6, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.7082381248474121
Epoch: 7, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7989392280578613
Epoch: 8, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7628834247589111
Epoch: 9, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.792931318283081
Epoch: 10, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.7150969505310059
Epoch: 11, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7108042240142822
Epoch: 12, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6969025135040283
Epoch: 13, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.131 Vali Acc: 0.133 Test Loss: 1.131 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7438714504241943
Epoch: 14, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7831625938415527
Epoch: 15, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7626984119415283
Epoch: 16, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6843812465667725
Epoch: 17, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7433171272277832
Epoch: 18, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.680072546005249
Epoch: 19, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6547834873199463
Epoch: 20, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 10531071
model size : 40.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4478793144226074
Epoch: 1, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.515195369720459
Epoch: 2, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5687301158905029
Epoch: 3, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4964594841003418
Epoch: 4, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4952845573425293
Epoch: 5, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5094509124755859
Epoch: 6, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4524722099304199
Epoch: 7, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5049848556518555
Epoch: 8, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4546017646789551
Epoch: 9, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5321090221405029
Epoch: 10, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5372216701507568
Epoch: 11, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5446639060974121
Epoch: 12, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 10428671
model size : 40.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.394765853881836
Epoch: 1, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.200 Vali Acc: 0.067 Test Loss: 1.200 Test Acc: 0.067
Validation loss decreased (inf --> -0.066655).  Saving model ...
Epoch: 2 cost time: 0.3900892734527588
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.193 Vali Acc: 0.067 Test Loss: 1.193 Test Acc: 0.067
Validation loss decreased (-0.066655 --> -0.066655).  Saving model ...
Epoch: 3 cost time: 0.3984851837158203
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (-0.066655 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.42699170112609863
Epoch: 4, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.5121052265167236
Epoch: 5, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.4558141231536865
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.443143367767334
Epoch: 7, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5041978359222412
Epoch: 8, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5003056526184082
Epoch: 9, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.536931037902832
Epoch: 10, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5120458602905273
Epoch: 11, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.42698144912719727
Epoch: 12, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4201779365539551
Epoch: 13, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.44014644622802734
Epoch: 14, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.5409080982208252
Epoch: 15, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 16 cost time: 0.43564343452453613
Epoch: 16, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 17 cost time: 0.4657614231109619
Epoch: 17, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.511876106262207
Epoch: 18, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 19 cost time: 0.4827902317047119
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.4853475093841553
Epoch: 20, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.45978641510009766
Epoch: 21, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.45040202140808105
Epoch: 22, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.40351247787475586
Epoch: 23, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4502573013305664
Epoch: 24, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4089028835296631
Epoch: 25, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.38857388496398926
Epoch: 26, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 27 cost time: 0.4537522792816162
Epoch: 27, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 28 cost time: 0.5175285339355469
Epoch: 28, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47388195991516113
Epoch: 29, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6217384338378906
Epoch: 30, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4883599281311035
Epoch: 31, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5136191844940186
Epoch: 32, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.49657249450683594
Epoch: 33, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5216348171234131
Epoch: 34, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.46901392936706543
Epoch: 35, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.47116923332214355
Epoch: 36, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4868431091308594
Epoch: 37, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10377471
model size : 39.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.2723016738891602
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.32598352432250977
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.3920590877532959
Epoch: 3, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3752737045288086
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3801274299621582
Epoch: 5, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.42125439643859863
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.3449108600616455
Epoch: 7, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.33855772018432617
Epoch: 8, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.35796499252319336
Epoch: 9, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.37085747718811035
Epoch: 10, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.3676114082336426
Epoch: 11, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.34633946418762207
Epoch: 12, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10326271
model size : 39.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.2107112407684326
Epoch: 1, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.28510355949401855
Epoch: 2, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.3432903289794922
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.3025803565979004
Epoch: 4, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.3274099826812744
Epoch: 5, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.3054041862487793
Epoch: 6, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.30252647399902344
Epoch: 7, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3609306812286377
Epoch: 8, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.32020020484924316
Epoch: 9, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.3626699447631836
Epoch: 10, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.3414936065673828
Epoch: 11, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.34871888160705566
Epoch: 12, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.343672513961792
Epoch: 13, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.3060581684112549
Epoch: 14, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.3216886520385742
Epoch: 15, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.3851892948150635
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 10277119
model size : 39.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3365116119384766
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.2217285633087158
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1216914653778076
Epoch: 3, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.3887803554534912
Epoch: 4, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.3341822624206543
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.307607650756836
Epoch: 6, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.423537254333496
Epoch: 7, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2683920860290527
Epoch: 8, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0829534530639648
Epoch: 9, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.150033712387085
Epoch: 10, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2901041507720947
Epoch: 11, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4357860088348389
Epoch: 12, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2674438953399658
Epoch: 13, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2261059284210205
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.267730712890625
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3591363430023193
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10916051
model size : 42.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.096193552017212
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8999128341674805
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9020099639892578
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.9057891368865967
Epoch: 4, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.4323821067810059
Epoch: 5, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8896293640136719
Epoch: 6, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9915444850921631
Epoch: 7, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.9295039176940918
Epoch: 8, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0878748893737793
Epoch: 9, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0162286758422852
Epoch: 10, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.960381269454956
Epoch: 11, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9940905570983887
Epoch: 12, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1005594730377197
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9622683525085449
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9710466861724854
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1084651947021484
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0109381675720215
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 10787027
model size : 41.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.165579080581665
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.037301778793335
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9358747005462646
Epoch: 3, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.8959825038909912
Epoch: 4, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.8667042255401611
Epoch: 5, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.8465194702148438
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.947749137878418
Epoch: 7, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.980912446975708
Epoch: 8, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8876597881317139
Epoch: 9, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8063366413116455
Epoch: 10, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8068158626556396
Epoch: 11, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8973076343536377
Epoch: 12, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8307230472564697
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.324800968170166
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7979111671447754
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8167543411254883
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 10660051
model size : 41.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7707951068878174
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.7042810916900635
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.6957097053527832
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6559605598449707
Epoch: 4, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7134745121002197
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7278625965118408
Epoch: 6, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6186394691467285
Epoch: 7, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6741170883178711
Epoch: 8, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.692589521408081
Epoch: 9, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7877283096313477
Epoch: 10, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6390016078948975
Epoch: 11, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6782522201538086
Epoch: 12, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 10531027
model size : 40.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4484658241271973
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.48552894592285156
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.526883602142334
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5131957530975342
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.242 Vali Acc: 0.200 Test Loss: 1.242 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4987351894378662
Epoch: 5, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.240 Vali Acc: 0.200 Test Loss: 1.240 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5116605758666992
Epoch: 6, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5085046291351318
Epoch: 7, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49019765853881836
Epoch: 8, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5256285667419434
Epoch: 9, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.502903938293457
Epoch: 10, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5018131732940674
Epoch: 11, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5658719539642334
Epoch: 12, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5472393035888672
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4935617446899414
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4810013771057129
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.572446346282959
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5782649517059326
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.6281406879425049
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6060791015625
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5994653701782227
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5931851863861084
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5608015060424805
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5436086654663086
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5034546852111816
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5089144706726074
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5861308574676514
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5148830413818359
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 10428627
model size : 40.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.483459711074829
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4264507293701172
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5042686462402344
Epoch: 3, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.43103861808776855
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4720132350921631
Epoch: 5, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49548840522766113
Epoch: 6, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.579897403717041
Epoch: 7, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5534231662750244
Epoch: 8, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5657563209533691
Epoch: 9, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5067875385284424
Epoch: 10, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5234155654907227
Epoch: 11, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5257444381713867
Epoch: 12, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5986955165863037
Epoch: 13, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5440938472747803
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4954214096069336
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5260765552520752
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5101516246795654
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5080134868621826
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5209178924560547
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5411708354949951
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.558051586151123
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 10377427
model size : 39.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3861021995544434
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.3475499153137207
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.3303086757659912
Epoch: 3, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3435354232788086
Epoch: 4, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.32505011558532715
Epoch: 5, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.36760663986206055
Epoch: 6, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.36365342140197754
Epoch: 7, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.34162235260009766
Epoch: 8, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.36432886123657227
Epoch: 9, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.31353259086608887
Epoch: 10, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3311808109283447
Epoch: 11, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.32701635360717773
Epoch: 12, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3448786735534668
Epoch: 13, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.312197208404541
Epoch: 14, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.3043398857116699
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.38105010986328125
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.36866092681884766
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 10326227
model size : 39.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            1024                
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3208367824554443
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.30016303062438965
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.330580472946167
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.3462715148925781
Epoch: 4, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.35964035987854004
Epoch: 5, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.35170674324035645
Epoch: 6, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.31609582901000977
Epoch: 7, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.30925989151000977
Epoch: 8, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.2912273406982422
Epoch: 9, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.25972938537597656
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.265256404876709
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.24305295944213867
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.2602396011352539
Epoch: 13, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.2541799545288086
Epoch: 14, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.2594926357269287
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm1024_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 10277075
model size : 39.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.619323492050171
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.1362788677215576
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.3094661235809326
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.325207233428955
Epoch: 4, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 1.416335105895996
Epoch: 5, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 1.3620965480804443
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 1.2590763568878174
Epoch: 7, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.4077367782592773
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 1.392857313156128
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 1.1986699104309082
Epoch: 10, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 1.1132993698120117
Epoch: 11, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 1.3639400005340576
Epoch: 12, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 1.2996208667755127
Epoch: 13, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 1.3368184566497803
Epoch: 14, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 1.2197327613830566
Epoch: 15, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1752328872680664
Epoch: 16, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.371544599533081
Epoch: 17, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1684784889221191
Epoch: 18, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.358583927154541
Epoch: 19, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5184967517852783
Epoch: 20, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3076388835906982
Epoch: 21, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3325831890106201
Epoch: 22, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3887755870819092
Epoch: 23, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4261360168457031
Epoch: 24, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5475583
model size : 21.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8537318706512451
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8584249019622803
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9676163196563721
Epoch: 3, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9980432987213135
Epoch: 4, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8848860263824463
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.1044542789459229
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9322690963745117
Epoch: 7, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9586300849914551
Epoch: 8, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0412724018096924
Epoch: 9, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1039347648620605
Epoch: 10, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0948460102081299
Epoch: 11, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1673271656036377
Epoch: 12, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1386640071868896
Epoch: 13, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0132980346679688
Epoch: 14, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.037489891052246
Epoch: 15, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0823442935943604
Epoch: 16, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5411071
model size : 21.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6914212703704834
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.8351593017578125
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.752509593963623
Epoch: 3, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7845404148101807
Epoch: 4, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8247661590576172
Epoch: 5, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.7428133487701416
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7491261959075928
Epoch: 7, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.7272875308990479
Epoch: 8, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.8562753200531006
Epoch: 9, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.8847417831420898
Epoch: 10, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.017 Vali Acc: 0.600 Test Loss: 1.017 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.9763026237487793
Epoch: 11, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9666736125946045
Epoch: 12, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9139711856842041
Epoch: 13, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.978215217590332
Epoch: 14, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9489614963531494
Epoch: 15, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9453742504119873
Epoch: 16, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9064867496490479
Epoch: 17, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0399036407470703
Epoch: 18, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.019310712814331
Epoch: 19, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9961872100830078
Epoch: 20, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 5347583
model size : 20.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.779571771621704
Epoch: 1, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7110302448272705
Epoch: 2, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6450884342193604
Epoch: 3, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.159 Vali Acc: 0.133 Test Loss: 1.159 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6780412197113037
Epoch: 4, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.652822732925415
Epoch: 5, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7305302619934082
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8386693000793457
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.734058141708374
Epoch: 8, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6374557018280029
Epoch: 9, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7844953536987305
Epoch: 10, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6775109767913818
Epoch: 11, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 5283071
model size : 20.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6909542083740234
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5714354515075684
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5147998332977295
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.5900592803955078
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5457022190093994
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5532698631286621
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6128807067871094
Epoch: 7, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6477491855621338
Epoch: 8, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5679407119750977
Epoch: 9, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7316803932189941
Epoch: 10, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5371854305267334
Epoch: 11, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5044944286346436
Epoch: 12, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4456050395965576
Epoch: 13, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5231871
model size : 20.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4083130359649658
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.4637722969055176
Epoch: 2, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.44655346870422363
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.39943695068359375
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4577319622039795
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.42843031883239746
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.43994855880737305
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.46364307403564453
Epoch: 8, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.46953582763671875
Epoch: 9, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4969305992126465
Epoch: 10, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5463597774505615
Epoch: 11, Steps: 1 | Train Loss: 0.439 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5247650146484375
Epoch: 12, Steps: 1 | Train Loss: 0.315 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4800403118133545
Epoch: 13, Steps: 1 | Train Loss: 0.246 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.5220649242401123
Epoch: 14, Steps: 1 | Train Loss: 0.186 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.5447943210601807
Epoch: 15, Steps: 1 | Train Loss: 0.137 Vali Loss: 0.971 Vali Acc: 0.600 Test Loss: 0.971 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.5259289741516113
Epoch: 16, Steps: 1 | Train Loss: 0.100 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.5342137813568115
Epoch: 17, Steps: 1 | Train Loss: 0.070 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.5101420879364014
Epoch: 18, Steps: 1 | Train Loss: 0.054 Vali Loss: 0.958 Vali Acc: 0.600 Test Loss: 0.958 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 0.5505311489105225
Epoch: 19, Steps: 1 | Train Loss: 0.038 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 0.5065286159515381
Epoch: 20, Steps: 1 | Train Loss: 0.029 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 0.4823741912841797
Epoch: 21, Steps: 1 | Train Loss: 0.020 Vali Loss: 0.950 Vali Acc: 0.600 Test Loss: 0.950 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 22 cost time: 0.5356283187866211
Epoch: 22, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 23 cost time: 0.4740407466888428
Epoch: 23, Steps: 1 | Train Loss: 0.013 Vali Loss: 0.946 Vali Acc: 0.533 Test Loss: 0.946 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.47639918327331543
Epoch: 24, Steps: 1 | Train Loss: 0.009 Vali Loss: 0.945 Vali Acc: 0.533 Test Loss: 0.945 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5281574726104736
Epoch: 25, Steps: 1 | Train Loss: 0.008 Vali Loss: 0.944 Vali Acc: 0.533 Test Loss: 0.944 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5243968963623047
Epoch: 26, Steps: 1 | Train Loss: 0.006 Vali Loss: 0.944 Vali Acc: 0.533 Test Loss: 0.944 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5851454734802246
Epoch: 27, Steps: 1 | Train Loss: 0.005 Vali Loss: 0.944 Vali Acc: 0.533 Test Loss: 0.944 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5231397151947021
Epoch: 28, Steps: 1 | Train Loss: 0.004 Vali Loss: 0.944 Vali Acc: 0.533 Test Loss: 0.944 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.46314549446105957
Epoch: 29, Steps: 1 | Train Loss: 0.004 Vali Loss: 0.944 Vali Acc: 0.533 Test Loss: 0.944 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5127689838409424
Epoch: 30, Steps: 1 | Train Loss: 0.003 Vali Loss: 0.945 Vali Acc: 0.533 Test Loss: 0.945 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4769301414489746
Epoch: 31, Steps: 1 | Train Loss: 0.002 Vali Loss: 0.946 Vali Acc: 0.533 Test Loss: 0.946 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.47755002975463867
Epoch: 32, Steps: 1 | Train Loss: 0.002 Vali Loss: 0.947 Vali Acc: 0.467 Test Loss: 0.947 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 5206271
model size : 20.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.2047698497772217
Epoch: 1, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.36739277839660645
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3626747131347656
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3588402271270752
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.33986353874206543
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3848886489868164
Epoch: 6, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.35306668281555176
Epoch: 7, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4167654514312744
Epoch: 8, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.40189695358276367
Epoch: 9, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.39282798767089844
Epoch: 10, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.36247944831848145
Epoch: 11, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.39136624336242676
Epoch: 12, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.39466309547424316
Epoch: 13, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.40771961212158203
Epoch: 14, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.37641429901123047
Epoch: 15, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.41257762908935547
Epoch: 16, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.39050745964050293
Epoch: 17, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.40708041191101074
Epoch: 18, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5180671
model size : 19.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3704421520233154
Epoch: 1, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.2682480812072754
Epoch: 2, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.31830835342407227
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.30826354026794434
Epoch: 4, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.118 Vali Acc: 0.133 Test Loss: 1.118 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.2666816711425781
Epoch: 5, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.30879855155944824
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3051002025604248
Epoch: 7, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.3297102451324463
Epoch: 8, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.2636871337890625
Epoch: 9, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.2862551212310791
Epoch: 10, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.35759520530700684
Epoch: 11, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.34214115142822266
Epoch: 12, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.29187750816345215
Epoch: 13, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.28761768341064453
Epoch: 14, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.32227396965026855
Epoch: 15, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.2466442584991455
Epoch: 16, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.2645585536956787
Epoch: 17, Steps: 1 | Train Loss: 0.124 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.2826118469238281
Epoch: 18, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.2769968509674072
Epoch: 19, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 20 cost time: 0.2574343681335449
Epoch: 20, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 21 cost time: 0.3011331558227539
Epoch: 21, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3070197105407715
Epoch: 22, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 23 cost time: 0.3657076358795166
Epoch: 23, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.2609751224517822
Epoch: 24, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.31360483169555664
Epoch: 25, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.37009453773498535
Epoch: 26, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.2547180652618408
Epoch: 27, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.2541358470916748
Epoch: 28, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.27743053436279297
Epoch: 29, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.2838132381439209
Epoch: 30, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.2996940612792969
Epoch: 31, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3462963104248047
Epoch: 32, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5156095
model size : 19.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.687413215637207
Epoch: 1, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.2900974750518799
Epoch: 2, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.3015789985656738
Epoch: 3, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.1437585353851318
Epoch: 4, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.1984786987304688
Epoch: 5, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.3063726425170898
Epoch: 6, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.0803823471069336
Epoch: 7, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 1.2520499229431152
Epoch: 8, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 1.4972469806671143
Epoch: 9, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4501380920410156
Epoch: 10, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.350102186203003
Epoch: 11, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2612221240997314
Epoch: 12, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7474579811096191
Epoch: 13, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3554587364196777
Epoch: 14, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4880800247192383
Epoch: 15, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2382121086120605
Epoch: 16, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3105871677398682
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4169104099273682
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 5475539
model size : 21.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9263992309570312
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.9142866134643555
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.238 Vali Acc: 0.200 Test Loss: 1.238 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8677883148193359
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8892643451690674
Epoch: 4, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9021799564361572
Epoch: 5, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9487338066101074
Epoch: 6, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2511818408966064
Epoch: 7, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8771958351135254
Epoch: 8, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.019716501235962
Epoch: 9, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9613063335418701
Epoch: 10, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 1.0680489540100098
Epoch: 11, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1172080039978027
Epoch: 12, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0267643928527832
Epoch: 13, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0151357650756836
Epoch: 14, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.108238935470581
Epoch: 15, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.242 Vali Acc: 0.200 Test Loss: 1.242 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9811911582946777
Epoch: 16, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.034363031387329
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.248 Vali Acc: 0.200 Test Loss: 1.248 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1130354404449463
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.251 Vali Acc: 0.200 Test Loss: 1.251 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.959057092666626
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.254 Vali Acc: 0.200 Test Loss: 1.254 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9281027317047119
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.257 Vali Acc: 0.200 Test Loss: 1.257 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 5411027
model size : 21.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9412524700164795
Epoch: 1, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7859208583831787
Epoch: 2, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9256024360656738
Epoch: 3, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9607675075531006
Epoch: 4, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9381179809570312
Epoch: 5, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9342920780181885
Epoch: 6, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8886916637420654
Epoch: 7, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9773051738739014
Epoch: 8, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.8613312244415283
Epoch: 9, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.9057528972625732
Epoch: 10, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.9533674716949463
Epoch: 11, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0180411338806152
Epoch: 12, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1289467811584473
Epoch: 13, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9351439476013184
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9624834060668945
Epoch: 15, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9873578548431396
Epoch: 16, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0077309608459473
Epoch: 17, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0156493186950684
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8137917518615723
Epoch: 19, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0520930290222168
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5347539
model size : 20.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6369926929473877
Epoch: 1, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 0.7062652111053467
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 0.8224549293518066
Epoch: 3, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.5523333549499512
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 5 cost time: 0.5469818115234375
Epoch: 5, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 0.5895929336547852
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 0.5974841117858887
Epoch: 7, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.6454339027404785
Epoch: 8, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 9 cost time: 0.613732099533081
Epoch: 9, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 10 cost time: 0.6363964080810547
Epoch: 10, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.5828986167907715
Epoch: 11, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5664219856262207
Epoch: 12, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6050770282745361
Epoch: 13, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.602919340133667
Epoch: 14, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7738511562347412
Epoch: 15, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7828636169433594
Epoch: 16, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7355976104736328
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6793873310089111
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7046868801116943
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7055709362030029
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5283027
model size : 20.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.2774083614349365
Epoch: 1, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.46477651596069336
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5124225616455078
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5771207809448242
Epoch: 4, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.47188377380371094
Epoch: 5, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.48416972160339355
Epoch: 6, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.48398351669311523
Epoch: 7, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5014724731445312
Epoch: 8, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5031518936157227
Epoch: 9, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.46796679496765137
Epoch: 10, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4438755512237549
Epoch: 11, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5201842784881592
Epoch: 12, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6268265247344971
Epoch: 13, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5716347694396973
Epoch: 14, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5463457107543945
Epoch: 15, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5525615215301514
Epoch: 16, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5996661186218262
Epoch: 17, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5231827
model size : 20.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5283324718475342
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.48305296897888184
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.402850866317749
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4258699417114258
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4438469409942627
Epoch: 5, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4636046886444092
Epoch: 6, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.404468297958374
Epoch: 7, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4654531478881836
Epoch: 8, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.152 Vali Acc: 0.267 Test Loss: 1.152 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4562079906463623
Epoch: 9, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4544069766998291
Epoch: 10, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4140963554382324
Epoch: 11, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4696526527404785
Epoch: 12, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.44039273262023926
Epoch: 13, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4282534122467041
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5208704471588135
Epoch: 15, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.47924327850341797
Epoch: 16, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.481412410736084
Epoch: 17, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5314061641693115
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5063309669494629
Epoch: 19, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5206227
model size : 20.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.449270486831665
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.42713332176208496
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.35310935974121094
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.3262171745300293
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.3477177619934082
Epoch: 5, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.33980393409729004
Epoch: 6, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.3745689392089844
Epoch: 7, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.3787503242492676
Epoch: 8, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.3873147964477539
Epoch: 9, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.3979954719543457
Epoch: 10, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.33067822456359863
Epoch: 11, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.39829015731811523
Epoch: 12, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.34681200981140137
Epoch: 13, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.3748130798339844
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.3594207763671875
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.3505852222442627
Epoch: 16, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.3674936294555664
Epoch: 17, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.37491583824157715
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5180627
model size : 19.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3301594257354736
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.194 Vali Acc: 0.133 Test Loss: 1.194 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.3250606060028076
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.192 Vali Acc: 0.133 Test Loss: 1.192 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.35361480712890625
Epoch: 3, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.191 Vali Acc: 0.133 Test Loss: 1.191 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.33712053298950195
Epoch: 4, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 5 cost time: 0.3600001335144043
Epoch: 5, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 6 cost time: 0.3250608444213867
Epoch: 6, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 7 cost time: 0.3405916690826416
Epoch: 7, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.2618696689605713
Epoch: 8, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.194 Vali Acc: 0.067 Test Loss: 1.194 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.3226015567779541
Epoch: 9, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.200 Vali Acc: 0.067 Test Loss: 1.200 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.2731926441192627
Epoch: 10, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.209 Vali Acc: 0.133 Test Loss: 1.209 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.2886061668395996
Epoch: 11, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.224 Vali Acc: 0.133 Test Loss: 1.224 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.31973886489868164
Epoch: 12, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.243 Vali Acc: 0.133 Test Loss: 1.243 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.26436543464660645
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.260 Vali Acc: 0.133 Test Loss: 1.260 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.2686340808868408
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.274 Vali Acc: 0.133 Test Loss: 1.274 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.34140849113464355
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.285 Vali Acc: 0.133 Test Loss: 1.285 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.2641286849975586
Epoch: 16, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.291 Vali Acc: 0.133 Test Loss: 1.291 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm512_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.13333333333333333
model parameter : 5156051
model size : 19.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.51438307762146
Epoch: 1, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.4783082008361816
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.4442901611328125
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.4449286460876465
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.3608555793762207
Epoch: 5, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 1.5494799613952637
Epoch: 6, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2745132446289062
Epoch: 7, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2775523662567139
Epoch: 8, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2183938026428223
Epoch: 9, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4597687721252441
Epoch: 10, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4263489246368408
Epoch: 11, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.23002290725708
Epoch: 12, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3490443229675293
Epoch: 13, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3103203773498535
Epoch: 14, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3383996486663818
Epoch: 15, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2755327
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1873972415924072
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.1310923099517822
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9767687320709229
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.920097827911377
Epoch: 4, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9543206691741943
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.092052698135376
Epoch: 6, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0013985633850098
Epoch: 7, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9682009220123291
Epoch: 8, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.9013862609863281
Epoch: 9, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.007612705230713
Epoch: 10, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8711328506469727
Epoch: 11, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.9232261180877686
Epoch: 12, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 1.0248825550079346
Epoch: 13, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 14 cost time: 1.2678024768829346
Epoch: 14, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 15 cost time: 1.0608668327331543
Epoch: 15, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 16 cost time: 1.0428316593170166
Epoch: 16, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 17 cost time: 1.0508534908294678
Epoch: 17, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 18 cost time: 1.141103982925415
Epoch: 18, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 19 cost time: 1.0970048904418945
Epoch: 19, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 1.1491036415100098
Epoch: 20, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 1.0465302467346191
Epoch: 21, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 1.1202857494354248
Epoch: 22, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.9669404029846191
Epoch: 23, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9429962635040283
Epoch: 24, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8824887275695801
Epoch: 25, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.043306827545166
Epoch: 26, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0261623859405518
Epoch: 27, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9237415790557861
Epoch: 28, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9201679229736328
Epoch: 29, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1537415981292725
Epoch: 30, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1660821437835693
Epoch: 31, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0943517684936523
Epoch: 32, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2723071
model size : 11.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0619492530822754
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8498382568359375
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8952310085296631
Epoch: 3, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.821516752243042
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8534862995147705
Epoch: 5, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9115815162658691
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9141933917999268
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7336812019348145
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.833653450012207
Epoch: 9, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7479331493377686
Epoch: 10, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9101932048797607
Epoch: 11, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8974099159240723
Epoch: 12, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.9494428634643555
Epoch: 13, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.8921773433685303
Epoch: 14, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.9945118427276611
Epoch: 15, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.8774721622467041
Epoch: 16, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.8489487171173096
Epoch: 17, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.8973746299743652
Epoch: 18, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.9339213371276855
Epoch: 19, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.7094526290893555
Epoch: 20, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8362910747528076
Epoch: 21, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.935006856918335
Epoch: 22, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.885352373123169
Epoch: 23, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9450383186340332
Epoch: 24, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9236345291137695
Epoch: 25, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7990295886993408
Epoch: 26, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.95709228515625
Epoch: 27, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8319401741027832
Epoch: 28, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.794060230255127
Epoch: 29, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2691327
model size : 10.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7049033641815186
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7370078563690186
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7855737209320068
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7725768089294434
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7649886608123779
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6842408180236816
Epoch: 6, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7229385375976562
Epoch: 7, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7023298740386963
Epoch: 8, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6375789642333984
Epoch: 9, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7833423614501953
Epoch: 10, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.748267412185669
Epoch: 11, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2659071
model size : 10.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.464496374130249
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5941717624664307
Epoch: 2, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.61722731590271
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5820565223693848
Epoch: 4, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6161296367645264
Epoch: 5, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5912694931030273
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7009589672088623
Epoch: 7, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7205488681793213
Epoch: 8, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6106865406036377
Epoch: 9, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5900053977966309
Epoch: 10, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5703489780426025
Epoch: 11, Steps: 1 | Train Loss: 0.475 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6892521381378174
Epoch: 12, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.611830472946167
Epoch: 13, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.6076185703277588
Epoch: 14, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 15 cost time: 0.6402208805084229
Epoch: 15, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.4731752872467041
Epoch: 16, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 0.5372858047485352
Epoch: 17, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 18 cost time: 0.5023598670959473
Epoch: 18, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 19 cost time: 0.5989470481872559
Epoch: 19, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 20 cost time: 0.47280240058898926
Epoch: 20, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 21 cost time: 0.41347551345825195
Epoch: 21, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 22 cost time: 0.5237386226654053
Epoch: 22, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 23 cost time: 0.48363280296325684
Epoch: 23, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 24 cost time: 0.5074276924133301
Epoch: 24, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 25 cost time: 0.5373530387878418
Epoch: 25, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 26 cost time: 0.49584460258483887
Epoch: 26, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 27 cost time: 0.4917788505554199
Epoch: 27, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4950730800628662
Epoch: 28, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 29 cost time: 0.4836549758911133
Epoch: 29, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5440948009490967
Epoch: 30, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6290121078491211
Epoch: 31, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6151111125946045
Epoch: 32, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6179018020629883
Epoch: 33, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5716607570648193
Epoch: 34, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6151528358459473
Epoch: 35, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6638331413269043
Epoch: 36, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 37 cost time: 0.5903182029724121
Epoch: 37, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5852706432342529
Epoch: 38, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6065239906311035
Epoch: 39, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6041467189788818
Epoch: 40, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6923491954803467
Epoch: 41, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.661475419998169
Epoch: 42, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6655874252319336
Epoch: 43, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.648745059967041
Epoch: 44, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.638460636138916
Epoch: 45, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5252575874328613
Epoch: 46, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2633471
model size : 10.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3414421081542969
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4781491756439209
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48094844818115234
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47148942947387695
Epoch: 4, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.44614481925964355
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4964876174926758
Epoch: 6, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4894218444824219
Epoch: 7, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.540431022644043
Epoch: 8, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4580078125
Epoch: 9, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5067529678344727
Epoch: 10, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.503258228302002
Epoch: 11, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2620671
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5875391960144043
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.42791223526000977
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.420055627822876
Epoch: 3, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.44524550437927246
Epoch: 4, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.48076677322387695
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.47394323348999023
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.48024821281433105
Epoch: 7, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.3698866367340088
Epoch: 8, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.42277050018310547
Epoch: 9, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.4484889507293701
Epoch: 10, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.39496850967407227
Epoch: 11, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.44013190269470215
Epoch: 12, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4722445011138916
Epoch: 13, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.42919015884399414
Epoch: 14, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4279670715332031
Epoch: 15, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.43128418922424316
Epoch: 16, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.42580580711364746
Epoch: 17, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.3239402770996094
Epoch: 18, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3507697582244873
Epoch: 19, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.3546288013458252
Epoch: 20, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.3973197937011719
Epoch: 21, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2607871
model size : 10.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.2821087837219238
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3060135841369629
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3470113277435303
Epoch: 3, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.35988736152648926
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.40668821334838867
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.35022425651550293
Epoch: 6, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.33232760429382324
Epoch: 7, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.40567612648010254
Epoch: 8, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.43780040740966797
Epoch: 9, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.44158267974853516
Epoch: 10, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.34871792793273926
Epoch: 11, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.36557698249816895
Epoch: 12, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.40155482292175293
Epoch: 13, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3366210460662842
Epoch: 14, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.34393763542175293
Epoch: 15, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.38077592849731445
Epoch: 16, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.42430591583251953
Epoch: 17, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.3394148349761963
Epoch: 18, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.38698697090148926
Epoch: 19, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.3485066890716553
Epoch: 20, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.32182812690734863
Epoch: 21, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2595583
model size : 9.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8749761581420898
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
Validation loss decreased (inf --> -0.666657).  Saving model ...
Epoch: 2 cost time: 1.21720290184021
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 1.245995283126831
Epoch: 3, Steps: 1 | Train Loss: 1.084 Vali Loss: 0.986 Vali Acc: 0.667 Test Loss: 0.986 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 1.5877223014831543
Epoch: 4, Steps: 1 | Train Loss: 1.019 Vali Loss: 0.985 Vali Acc: 0.667 Test Loss: 0.985 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 1.1943202018737793
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 0.984 Vali Acc: 0.667 Test Loss: 0.984 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 1.211785078048706
Epoch: 6, Steps: 1 | Train Loss: 0.897 Vali Loss: 0.984 Vali Acc: 0.667 Test Loss: 0.984 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 7 cost time: 1.501756191253662
Epoch: 7, Steps: 1 | Train Loss: 0.742 Vali Loss: 0.984 Vali Acc: 0.667 Test Loss: 0.984 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.295344352722168
Epoch: 8, Steps: 1 | Train Loss: 0.569 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0930514335632324
Epoch: 9, Steps: 1 | Train Loss: 0.447 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1538972854614258
Epoch: 10, Steps: 1 | Train Loss: 0.323 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.011660099029541
Epoch: 11, Steps: 1 | Train Loss: 0.233 Vali Loss: 0.986 Vali Acc: 0.600 Test Loss: 0.986 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2234547138214111
Epoch: 12, Steps: 1 | Train Loss: 0.131 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1891450881958008
Epoch: 13, Steps: 1 | Train Loss: 0.087 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1139988899230957
Epoch: 14, Steps: 1 | Train Loss: 0.057 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2222731113433838
Epoch: 15, Steps: 1 | Train Loss: 0.037 Vali Loss: 0.998 Vali Acc: 0.667 Test Loss: 0.998 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3927862644195557
Epoch: 16, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.002 Vali Acc: 0.667 Test Loss: 1.002 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 2755283
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.481397867202759
Epoch: 1, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.1549255847930908
Epoch: 2, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.0585455894470215
Epoch: 3, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.1590263843536377
Epoch: 4, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 1.4762868881225586
Epoch: 5, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1933250427246094
Epoch: 6, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0151476860046387
Epoch: 7, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9841022491455078
Epoch: 8, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1951568126678467
Epoch: 9, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1824214458465576
Epoch: 10, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2179818153381348
Epoch: 11, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3133127689361572
Epoch: 12, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1671617031097412
Epoch: 13, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1856331825256348
Epoch: 14, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2723027
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6220569610595703
Epoch: 1, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8541817665100098
Epoch: 2, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.9522013664245605
Epoch: 3, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8463191986083984
Epoch: 4, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0764751434326172
Epoch: 5, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8903505802154541
Epoch: 6, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0200700759887695
Epoch: 7, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1796271800994873
Epoch: 8, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9378387928009033
Epoch: 9, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0549252033233643
Epoch: 10, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9735090732574463
Epoch: 11, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9198601245880127
Epoch: 12, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2691283
model size : 10.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4745779037475586
Epoch: 1, Steps: 1 | Train Loss: 1.276 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7510647773742676
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5777201652526855
Epoch: 3, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6718573570251465
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8295636177062988
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9488110542297363
Epoch: 6, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8520495891571045
Epoch: 7, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7347595691680908
Epoch: 8, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8673098087310791
Epoch: 9, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.840399980545044
Epoch: 10, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7859928607940674
Epoch: 11, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.819819450378418
Epoch: 12, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7883701324462891
Epoch: 13, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.909409761428833
Epoch: 14, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2659027
model size : 10.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5686309337615967
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5673308372497559
Epoch: 2, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6071445941925049
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6021318435668945
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5932269096374512
Epoch: 5, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6326906681060791
Epoch: 6, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7031993865966797
Epoch: 7, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7886207103729248
Epoch: 8, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7439794540405273
Epoch: 9, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6504971981048584
Epoch: 10, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6299576759338379
Epoch: 11, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4967925548553467
Epoch: 12, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7129080295562744
Epoch: 13, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7169389724731445
Epoch: 14, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.7285358905792236
Epoch: 15, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6603446006774902
Epoch: 16, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6383507251739502
Epoch: 17, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7130272388458252
Epoch: 18, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6617145538330078
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5750138759613037
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5245249271392822
Epoch: 21, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5162684917449951
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6042900085449219
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5781917572021484
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2633427
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.681328296661377
Epoch: 1, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.473407506942749
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.516974687576294
Epoch: 3, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5796875953674316
Epoch: 4, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5482826232910156
Epoch: 5, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.525019645690918
Epoch: 6, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4636116027832031
Epoch: 7, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.526984453201294
Epoch: 8, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5698051452636719
Epoch: 9, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6516644954681396
Epoch: 10, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5419495105743408
Epoch: 11, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5024330615997314
Epoch: 12, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5442044734954834
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5382788181304932
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5091564655303955
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4643399715423584
Epoch: 16, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5424752235412598
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.42838215827941895
Epoch: 18, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4969189167022705
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2620627
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6977322101593018
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.43680453300476074
Epoch: 2, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.39668750762939453
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44666385650634766
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.458834171295166
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43660616874694824
Epoch: 6, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5190057754516602
Epoch: 7, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4887547492980957
Epoch: 8, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.43607401847839355
Epoch: 9, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.490816593170166
Epoch: 10, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.154 Vali Acc: 0.067 Test Loss: 1.154 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.47519731521606445
Epoch: 11, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 2607827
model size : 10.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.2372939586639404
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.3604013919830322
Epoch: 2, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.27475666999816895
Epoch: 3, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.3394026756286621
Epoch: 4, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.2995750904083252
Epoch: 5, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.31684446334838867
Epoch: 6, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.30095982551574707
Epoch: 7, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.31885576248168945
Epoch: 8, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.29546570777893066
Epoch: 9, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.365567684173584
Epoch: 10, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.351076602935791
Epoch: 11, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.3357532024383545
Epoch: 12, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 13 cost time: 0.4167134761810303
Epoch: 13, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.37632250785827637
Epoch: 14, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.38521289825439453
Epoch: 15, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3820812702178955
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.34511232376098633
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3558528423309326
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3338162899017334
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.32725024223327637
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.225 Vali Acc: 0.267 Test Loss: 1.225 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.34368324279785156
Epoch: 21, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.3313291072845459
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.3905000686645508
Epoch: 23, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.242 Vali Acc: 0.133 Test Loss: 1.242 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm256_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 2595539
model size : 9.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.443608522415161
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.1595616340637207
Epoch: 2, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.1889960765838623
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2243232727050781
Epoch: 4, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.284986972808838
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2703750133514404
Epoch: 6, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.244685411453247
Epoch: 7, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4567170143127441
Epoch: 8, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4870121479034424
Epoch: 9, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.247626543045044
Epoch: 10, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0706777572631836
Epoch: 11, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0932371616363525
Epoch: 12, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w313_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1395199
model size : 6.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.214431047439575
Epoch: 1, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.1061515808105469
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9753940105438232
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.0447235107421875
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.1254754066467285
Epoch: 5, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8646218776702881
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9953577518463135
Epoch: 7, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.085340976715088
Epoch: 8, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 1.0473411083221436
Epoch: 9, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 1.1528398990631104
Epoch: 10, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 1.0145490169525146
Epoch: 11, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.9958181381225586
Epoch: 12, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.929161548614502
Epoch: 13, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1195108890533447
Epoch: 14, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.98500657081604
Epoch: 15, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0080280303955078
Epoch: 16, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0750558376312256
Epoch: 17, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.111881971359253
Epoch: 18, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9273135662078857
Epoch: 19, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0087993144989014
Epoch: 20, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9549651145935059
Epoch: 21, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1157073974609375
Epoch: 22, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w250_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1379071
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7919158935546875
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7373406887054443
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.837932825088501
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7792303562164307
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7458059787750244
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8385891914367676
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8672001361846924
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8737144470214844
Epoch: 8, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.099 Vali Acc: 0.200 Test Loss: 1.099 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9331073760986328
Epoch: 9, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0383129119873047
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8036041259765625
Epoch: 11, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.895172119140625
Epoch: 12, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9488601684570312
Epoch: 13, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0467042922973633
Epoch: 14, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1922800540924072
Epoch: 15, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w188_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1363199
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8087410926818848
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.7521731853485107
Epoch: 2, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7414095401763916
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7193398475646973
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7348785400390625
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7435622215270996
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7059862613677979
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7110810279846191
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.702552080154419
Epoch: 9, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7023351192474365
Epoch: 10, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6241581439971924
Epoch: 11, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.6491072177886963
Epoch: 12, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.6916050910949707
Epoch: 13, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.5942773818969727
Epoch: 14, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.638608455657959
Epoch: 15, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6383025646209717
Epoch: 16, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7878050804138184
Epoch: 17, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.023 Vali Acc: 0.533 Test Loss: 1.023 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.8511447906494141
Epoch: 18, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.020 Vali Acc: 0.533 Test Loss: 1.020 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 19 cost time: 0.7397840023040771
Epoch: 19, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 20 cost time: 0.7671501636505127
Epoch: 20, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 21 cost time: 0.7770700454711914
Epoch: 21, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.7637786865234375
Epoch: 22, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.778984785079956
Epoch: 23, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.7245731353759766
Epoch: 24, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.7837438583374023
Epoch: 25, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 26 cost time: 0.738419771194458
Epoch: 26, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.005 Vali Acc: 0.533 Test Loss: 1.005 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 27 cost time: 0.7845449447631836
Epoch: 27, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 28 cost time: 0.7134692668914795
Epoch: 28, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 29 cost time: 0.6912338733673096
Epoch: 29, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 30 cost time: 0.598935604095459
Epoch: 30, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 31 cost time: 0.6716525554656982
Epoch: 31, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 32 cost time: 0.742795467376709
Epoch: 32, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 33 cost time: 0.7437329292297363
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7575633525848389
Epoch: 34, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7258057594299316
Epoch: 35, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7656583786010742
Epoch: 36, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7657573223114014
Epoch: 37, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7669153213500977
Epoch: 38, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7537577152252197
Epoch: 39, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8334150314331055
Epoch: 40, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7090063095092773
Epoch: 41, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8109762668609619
Epoch: 42, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w125_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1347071
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4853756427764893
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5884976387023926
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.090 Vali Acc: 0.200 Test Loss: 1.090 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.558053731918335
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.47379088401794434
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.5396265983581543
Epoch: 5, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.5633082389831543
Epoch: 6, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.5518755912780762
Epoch: 7, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.5724024772644043
Epoch: 8, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.5785398483276367
Epoch: 9, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5981993675231934
Epoch: 10, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.5536689758300781
Epoch: 11, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5686924457550049
Epoch: 12, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.5538580417633057
Epoch: 13, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.5615642070770264
Epoch: 14, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.5206489562988281
Epoch: 15, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.5144789218902588
Epoch: 16, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 17 cost time: 0.5161290168762207
Epoch: 17, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 18 cost time: 0.5091125965118408
Epoch: 18, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 19 cost time: 0.43363237380981445
Epoch: 19, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 20 cost time: 0.45238518714904785
Epoch: 20, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 21 cost time: 0.4625434875488281
Epoch: 21, Steps: 1 | Train Loss: 0.124 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 22 cost time: 0.5518441200256348
Epoch: 22, Steps: 1 | Train Loss: 0.106 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 23 cost time: 0.4474601745605469
Epoch: 23, Steps: 1 | Train Loss: 0.088 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 24 cost time: 0.5581142902374268
Epoch: 24, Steps: 1 | Train Loss: 0.073 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 25 cost time: 0.5157461166381836
Epoch: 25, Steps: 1 | Train Loss: 0.061 Vali Loss: 0.981 Vali Acc: 0.533 Test Loss: 0.981 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 26 cost time: 0.644845724105835
Epoch: 26, Steps: 1 | Train Loss: 0.049 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 27 cost time: 0.5527040958404541
Epoch: 27, Steps: 1 | Train Loss: 0.041 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 28 cost time: 0.5692086219787598
Epoch: 28, Steps: 1 | Train Loss: 0.033 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 29 cost time: 0.6182613372802734
Epoch: 29, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 30 cost time: 0.628436803817749
Epoch: 30, Steps: 1 | Train Loss: 0.024 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 31 cost time: 0.6077854633331299
Epoch: 31, Steps: 1 | Train Loss: 0.022 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 32 cost time: 0.6533451080322266
Epoch: 32, Steps: 1 | Train Loss: 0.017 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 33 cost time: 0.5807604789733887
Epoch: 33, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 0.5881028175354004
Epoch: 34, Steps: 1 | Train Loss: 0.014 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 35 cost time: 0.5315630435943604
Epoch: 35, Steps: 1 | Train Loss: 0.013 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.531327486038208
Epoch: 36, Steps: 1 | Train Loss: 0.010 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.610358715057373
Epoch: 37, Steps: 1 | Train Loss: 0.009 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5843002796173096
Epoch: 38, Steps: 1 | Train Loss: 0.008 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4960765838623047
Epoch: 39, Steps: 1 | Train Loss: 0.007 Vali Loss: 0.974 Vali Acc: 0.533 Test Loss: 0.974 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5708727836608887
Epoch: 40, Steps: 1 | Train Loss: 0.007 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6896417140960693
Epoch: 41, Steps: 1 | Train Loss: 0.006 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.48463988304138184
Epoch: 42, Steps: 1 | Train Loss: 0.006 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5069992542266846
Epoch: 43, Steps: 1 | Train Loss: 0.005 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6200737953186035
Epoch: 44, Steps: 1 | Train Loss: 0.005 Vali Loss: 0.978 Vali Acc: 0.533 Test Loss: 0.978 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w75_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1334271
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6023755073547363
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5301814079284668
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5051381587982178
Epoch: 3, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4286642074584961
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.47773051261901855
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.38075852394104004
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4085655212402344
Epoch: 7, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.3802831172943115
Epoch: 8, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.42145514488220215
Epoch: 9, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.46823692321777344
Epoch: 10, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.512446403503418
Epoch: 11, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4408223628997803
Epoch: 12, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.39086222648620605
Epoch: 13, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 14 cost time: 0.410693883895874
Epoch: 14, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.4869260787963867
Epoch: 15, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.481060266494751
Epoch: 16, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 17 cost time: 0.45048975944519043
Epoch: 17, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.5122005939483643
Epoch: 18, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.515608549118042
Epoch: 19, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.46652698516845703
Epoch: 20, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5307950973510742
Epoch: 21, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4970061779022217
Epoch: 22, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.49158596992492676
Epoch: 23, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.49823999404907227
Epoch: 24, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.49597668647766113
Epoch: 25, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5281164646148682
Epoch: 26, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4911234378814697
Epoch: 27, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w50_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1327871
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.1630644798278809
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.33562350273132324
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4109766483306885
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.43575620651245117
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.4288370609283447
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4178483486175537
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.4344663619995117
Epoch: 7, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.391477108001709
Epoch: 8, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.40456509590148926
Epoch: 9, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.4024922847747803
Epoch: 10, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.40558886528015137
Epoch: 11, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.4091830253601074
Epoch: 12, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.458406925201416
Epoch: 13, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 14 cost time: 0.42909789085388184
Epoch: 14, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 15 cost time: 0.4069480895996094
Epoch: 15, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 16 cost time: 0.3042488098144531
Epoch: 16, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.3212704658508301
Epoch: 17, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 18 cost time: 0.3378109931945801
Epoch: 18, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.38086843490600586
Epoch: 19, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 20 cost time: 0.38889074325561523
Epoch: 20, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 21 cost time: 0.3834726810455322
Epoch: 21, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.34879469871520996
Epoch: 22, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 23 cost time: 0.36519312858581543
Epoch: 23, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 24 cost time: 0.36592864990234375
Epoch: 24, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 25 cost time: 0.32491326332092285
Epoch: 25, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.36345529556274414
Epoch: 26, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.37818384170532227
Epoch: 27, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.43172144889831543
Epoch: 28, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.44425463676452637
Epoch: 29, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.419964075088501
Epoch: 30, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.3868241310119629
Epoch: 31, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.3811769485473633
Epoch: 32, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4142477512359619
Epoch: 33, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4173867702484131
Epoch: 34, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w25_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1321471
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.2219867706298828
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3056354522705078
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.31680893898010254
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.2857091426849365
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.2944610118865967
Epoch: 5, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.32514333724975586
Epoch: 6, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.354750394821167
Epoch: 7, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.2940099239349365
Epoch: 8, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3966975212097168
Epoch: 9, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4276392459869385
Epoch: 10, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4091756343841553
Epoch: 11, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.4270498752593994
Epoch: 12, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.39917635917663574
Epoch: 13, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.392535924911499
Epoch: 14, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.4021003246307373
Epoch: 15, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 16 cost time: 0.3611483573913574
Epoch: 16, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.34375
Epoch: 17, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4073946475982666
Epoch: 18, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.44968318939208984
Epoch: 19, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.36060571670532227
Epoch: 20, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4248216152191162
Epoch: 21, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3951685428619385
Epoch: 22, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.3603842258453369
Epoch: 23, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.3810689449310303
Epoch: 24, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.36441469192504883
Epoch: 25, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT0_w0_fC1_df2_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1315327
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1973586082458496
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 1.2939479351043701
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 1.316039800643921
Epoch: 3, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 1.2890892028808594
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 1.4818053245544434
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 1.4824373722076416
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.250 Vali Acc: 0.267 Test Loss: 1.250 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 1.5745625495910645
Epoch: 7, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 1.3407528400421143
Epoch: 8, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2172930240631104
Epoch: 9, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1745250225067139
Epoch: 10, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0869619846343994
Epoch: 11, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2268874645233154
Epoch: 12, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.300964117050171
Epoch: 13, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 14 cost time: 1.5006287097930908
Epoch: 14, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.332650899887085
Epoch: 15, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3448536396026611
Epoch: 16, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 17 cost time: 1.2978863716125488
Epoch: 17, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 18 cost time: 1.2184233665466309
Epoch: 18, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 19 cost time: 1.2638342380523682
Epoch: 19, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 20 cost time: 1.1554722785949707
Epoch: 20, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 21 cost time: 1.1011369228363037
Epoch: 21, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 22 cost time: 1.31327486038208
Epoch: 22, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 23 cost time: 1.138312816619873
Epoch: 23, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 24 cost time: 1.2003872394561768
Epoch: 24, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2815301418304443
Epoch: 25, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2824287414550781
Epoch: 26, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1595823764801025
Epoch: 27, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1912779808044434
Epoch: 28, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.076789140701294
Epoch: 29, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2358429431915283
Epoch: 30, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4864592552185059
Epoch: 31, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.350043773651123
Epoch: 32, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4402854442596436
Epoch: 33, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w313_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1395155
model size : 6.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.05849552154541
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.123938798904419
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.1177289485931396
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.2634062767028809
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 1.687349557876587
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 1.22027587890625
Epoch: 6, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.1882877349853516
Epoch: 7, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.1480886936187744
Epoch: 8, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 1.1919066905975342
Epoch: 9, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 1.2046184539794922
Epoch: 10, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 1.031569242477417
Epoch: 11, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.1750538349151611
Epoch: 12, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.9349517822265625
Epoch: 13, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.97161865234375
Epoch: 14, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.223149299621582
Epoch: 15, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1460766792297363
Epoch: 16, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.128657579421997
Epoch: 17, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1854255199432373
Epoch: 18, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2007756233215332
Epoch: 19, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9897665977478027
Epoch: 20, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9968230724334717
Epoch: 21, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9544761180877686
Epoch: 22, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w250_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1379027
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.101900577545166
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.1898272037506104
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7677316665649414
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8323793411254883
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7395451068878174
Epoch: 5, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8321733474731445
Epoch: 6, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8735024929046631
Epoch: 7, Steps: 1 | Train Loss: 0.849 Vali Loss: 0.998 Vali Acc: 0.467 Test Loss: 0.998 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9090290069580078
Epoch: 8, Steps: 1 | Train Loss: 0.726 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0145678520202637
Epoch: 9, Steps: 1 | Train Loss: 0.596 Vali Loss: 0.993 Vali Acc: 0.467 Test Loss: 0.993 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9645957946777344
Epoch: 10, Steps: 1 | Train Loss: 0.472 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.8757073879241943
Epoch: 11, Steps: 1 | Train Loss: 0.352 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 1.0967872142791748
Epoch: 12, Steps: 1 | Train Loss: 0.271 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.000373363494873
Epoch: 13, Steps: 1 | Train Loss: 0.197 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9387674331665039
Epoch: 14, Steps: 1 | Train Loss: 0.125 Vali Loss: 0.990 Vali Acc: 0.467 Test Loss: 0.990 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8899874687194824
Epoch: 15, Steps: 1 | Train Loss: 0.087 Vali Loss: 0.991 Vali Acc: 0.467 Test Loss: 0.991 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8000423908233643
Epoch: 16, Steps: 1 | Train Loss: 0.061 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8200099468231201
Epoch: 17, Steps: 1 | Train Loss: 0.043 Vali Loss: 0.993 Vali Acc: 0.467 Test Loss: 0.993 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8278977870941162
Epoch: 18, Steps: 1 | Train Loss: 0.031 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7828686237335205
Epoch: 19, Steps: 1 | Train Loss: 0.022 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0057642459869385
Epoch: 20, Steps: 1 | Train Loss: 0.016 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.050405502319336
Epoch: 21, Steps: 1 | Train Loss: 0.012 Vali Loss: 0.999 Vali Acc: 0.467 Test Loss: 0.999 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w188_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1363155
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7822470664978027
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6172194480895996
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.637803316116333
Epoch: 3, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.684175968170166
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6465554237365723
Epoch: 5, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6012003421783447
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7818872928619385
Epoch: 7, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.8157801628112793
Epoch: 8, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9589290618896484
Epoch: 9, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7307894229888916
Epoch: 10, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7644879817962646
Epoch: 11, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7410249710083008
Epoch: 12, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8580925464630127
Epoch: 13, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7902090549468994
Epoch: 14, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8461005687713623
Epoch: 15, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7408261299133301
Epoch: 16, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6558771133422852
Epoch: 17, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w125_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1347027
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.786775827407837
Epoch: 1, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5597286224365234
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.646146297454834
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5609016418457031
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6190416812896729
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5690038204193115
Epoch: 6, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4522714614868164
Epoch: 7, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.44364309310913086
Epoch: 8, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.44734716415405273
Epoch: 9, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.543696403503418
Epoch: 10, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.5888729095458984
Epoch: 11, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.642634391784668
Epoch: 12, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5472517013549805
Epoch: 13, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.525148868560791
Epoch: 14, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5998008251190186
Epoch: 15, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6591143608093262
Epoch: 16, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5908975601196289
Epoch: 17, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5985658168792725
Epoch: 18, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6218545436859131
Epoch: 19, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5852236747741699
Epoch: 20, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w75_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1334227
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.283686876296997
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4296140670776367
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.4989643096923828
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4327664375305176
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4616258144378662
Epoch: 5, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.5395674705505371
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5375401973724365
Epoch: 7, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5564041137695312
Epoch: 8, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5641896724700928
Epoch: 9, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5745701789855957
Epoch: 10, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.218 Vali Acc: 0.200 Test Loss: 1.218 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5407683849334717
Epoch: 11, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4991610050201416
Epoch: 12, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5660231113433838
Epoch: 13, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5836105346679688
Epoch: 14, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6040074825286865
Epoch: 15, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w50_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1327827
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3210639953613281
Epoch: 1, Steps: 1 | Train Loss: 1.287 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.39508748054504395
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.3817014694213867
Epoch: 3, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.3600442409515381
Epoch: 4, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.46508216857910156
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.47231054306030273
Epoch: 6, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.45630764961242676
Epoch: 7, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4641149044036865
Epoch: 8, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.44316554069519043
Epoch: 9, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4352695941925049
Epoch: 10, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4207475185394287
Epoch: 11, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4240741729736328
Epoch: 12, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4703655242919922
Epoch: 13, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4939091205596924
Epoch: 14, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT1_w25_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1321427
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              MTSMixer            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               0                   
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.3323695659637451
Epoch: 1, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.3331298828125
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.097 Vali Acc: 0.533 Test Loss: 1.097 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.31498241424560547
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.31542134284973145
Epoch: 4, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.35497117042541504
Epoch: 5, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.2983560562133789
Epoch: 6, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.3618755340576172
Epoch: 7, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.3663206100463867
Epoch: 8, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.375931978225708
Epoch: 9, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.38131070137023926
Epoch: 10, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.40421295166015625
Epoch: 11, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.354902982711792
Epoch: 12, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.37801027297973633
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3400571346282959
Epoch: 14, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.36664462089538574
Epoch: 15, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.047 Vali Acc: 0.600 Test Loss: 1.047 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 0.3720865249633789
Epoch: 16, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3867065906524658
Epoch: 17, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3576335906982422
Epoch: 18, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.40079760551452637
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.3804304599761963
Epoch: 20, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.44270801544189453
Epoch: 21, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3276066780090332
Epoch: 22, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.29265904426574707
Epoch: 23, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.2973906993865967
Epoch: 24, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.3501148223876953
Epoch: 25, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_MTSMixer_UEA_ftM_sl2500_ll0_pl0_el2_dm128_fT0_w0_fC0_df0_rev0_n1_i0_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1315283
model size : 5.02MB
