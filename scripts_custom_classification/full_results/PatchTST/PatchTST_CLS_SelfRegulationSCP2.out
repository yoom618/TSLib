Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8078324794769287
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.987 Vali Acc: 0.494 Test Loss: 0.987 Test Acc: 0.494
Validation loss decreased (inf --> -0.494435).  Saving model ...
Epoch: 2 cost time: 2.445863723754883
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 1.276 Vali Acc: 0.478 Test Loss: 1.276 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.116025447845459
Epoch: 3, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.214 Vali Acc: 0.483 Test Loss: 1.214 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.876922845840454
Epoch: 4, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.532 Vali Acc: 0.489 Test Loss: 1.532 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8467023372650146
Epoch: 5, Steps: 13 | Train Loss: 0.419 Vali Loss: 1.862 Vali Acc: 0.489 Test Loss: 1.862 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1213531494140625
Epoch: 6, Steps: 13 | Train Loss: 0.425 Vali Loss: 2.329 Vali Acc: 0.483 Test Loss: 2.329 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.255930185317993
Epoch: 7, Steps: 13 | Train Loss: 0.392 Vali Loss: 2.371 Vali Acc: 0.467 Test Loss: 2.371 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8453342914581299
Epoch: 8, Steps: 13 | Train Loss: 0.380 Vali Loss: 2.943 Vali Acc: 0.456 Test Loss: 2.943 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.188298225402832
Epoch: 9, Steps: 13 | Train Loss: 0.288 Vali Loss: 3.462 Vali Acc: 0.472 Test Loss: 3.462 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1941795349121094
Epoch: 10, Steps: 13 | Train Loss: 0.434 Vali Loss: 3.466 Vali Acc: 0.467 Test Loss: 3.466 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.229357957839966
Epoch: 11, Steps: 13 | Train Loss: 0.197 Vali Loss: 3.506 Vali Acc: 0.489 Test Loss: 3.506 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 537602
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.133998155593872
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.772 Vali Acc: 0.556 Test Loss: 0.772 Test Acc: 0.556
Validation loss decreased (inf --> -0.555548).  Saving model ...
Epoch: 2 cost time: 1.4374399185180664
Epoch: 2, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.788 Vali Acc: 0.511 Test Loss: 0.788 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5959618091583252
Epoch: 3, Steps: 13 | Train Loss: 0.553 Vali Loss: 1.188 Vali Acc: 0.544 Test Loss: 1.188 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6841871738433838
Epoch: 4, Steps: 13 | Train Loss: 0.517 Vali Loss: 1.150 Vali Acc: 0.511 Test Loss: 1.150 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5602138042449951
Epoch: 5, Steps: 13 | Train Loss: 0.422 Vali Loss: 1.229 Vali Acc: 0.533 Test Loss: 1.229 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6675798892974854
Epoch: 6, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.524 Vali Acc: 0.522 Test Loss: 1.524 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.40028715133667
Epoch: 7, Steps: 13 | Train Loss: 0.347 Vali Loss: 2.026 Vali Acc: 0.539 Test Loss: 2.026 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5489518642425537
Epoch: 8, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.786 Vali Acc: 0.517 Test Loss: 1.786 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7232933044433594
Epoch: 9, Steps: 13 | Train Loss: 0.253 Vali Loss: 2.055 Vali Acc: 0.444 Test Loss: 2.055 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8210368156433105
Epoch: 10, Steps: 13 | Train Loss: 0.260 Vali Loss: 2.426 Vali Acc: 0.461 Test Loss: 2.426 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3442261219024658
Epoch: 11, Steps: 13 | Train Loss: 0.258 Vali Loss: 2.400 Vali Acc: 0.444 Test Loss: 2.400 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 475010
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3946573734283447
Epoch: 1, Steps: 13 | Train Loss: 0.818 Vali Loss: 0.685 Vali Acc: 0.544 Test Loss: 0.685 Test Acc: 0.544
Validation loss decreased (inf --> -0.544438).  Saving model ...
Epoch: 2 cost time: 1.484877347946167
Epoch: 2, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.738 Vali Acc: 0.494 Test Loss: 0.738 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.495948314666748
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.867 Vali Acc: 0.494 Test Loss: 0.867 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3721067905426025
Epoch: 4, Steps: 13 | Train Loss: 0.458 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.64436936378479
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.137 Vali Acc: 0.528 Test Loss: 1.137 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4653337001800537
Epoch: 6, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.270 Vali Acc: 0.528 Test Loss: 1.270 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6118695735931396
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.400 Vali Acc: 0.517 Test Loss: 1.400 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7665622234344482
Epoch: 8, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.499 Vali Acc: 0.511 Test Loss: 1.499 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6760642528533936
Epoch: 9, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.837 Vali Acc: 0.522 Test Loss: 1.837 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4113857746124268
Epoch: 10, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.792 Vali Acc: 0.483 Test Loss: 1.792 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2498884201049805
Epoch: 11, Steps: 13 | Train Loss: 0.168 Vali Loss: 2.001 Vali Acc: 0.478 Test Loss: 2.001 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 455426
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9296040534973145
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.716 Vali Acc: 0.528 Test Loss: 0.716 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 1.4787440299987793
Epoch: 2, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.725 Vali Acc: 0.539 Test Loss: 0.725 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.480109691619873
Epoch: 3, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.850 Vali Acc: 0.517 Test Loss: 0.850 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4767444133758545
Epoch: 4, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.951 Vali Acc: 0.533 Test Loss: 0.951 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6136155128479004
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.060 Vali Acc: 0.522 Test Loss: 1.060 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.523146152496338
Epoch: 6, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.115 Vali Acc: 0.522 Test Loss: 1.115 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5158984661102295
Epoch: 7, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.342 Vali Acc: 0.494 Test Loss: 1.342 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4532294273376465
Epoch: 8, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.317 Vali Acc: 0.489 Test Loss: 1.317 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6970603466033936
Epoch: 9, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.470 Vali Acc: 0.522 Test Loss: 1.470 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.392439842224121
Epoch: 10, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.774 Vali Acc: 0.517 Test Loss: 1.774 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4637298583984375
Epoch: 11, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.839 Vali Acc: 0.522 Test Loss: 1.839 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4605035781860352
Epoch: 12, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.913 Vali Acc: 0.472 Test Loss: 1.913 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 446594
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9290151596069336
Epoch: 1, Steps: 13 | Train Loss: 0.818 Vali Loss: 0.734 Vali Acc: 0.478 Test Loss: 0.734 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.4670908451080322
Epoch: 2, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.727 Vali Acc: 0.517 Test Loss: 0.727 Test Acc: 0.517
Validation loss decreased (-0.477770 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.3941376209259033
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.779 Vali Acc: 0.511 Test Loss: 0.779 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2732810974121094
Epoch: 4, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.853 Vali Acc: 0.500 Test Loss: 0.853 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5484495162963867
Epoch: 5, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.920 Vali Acc: 0.506 Test Loss: 0.920 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5663893222808838
Epoch: 6, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.030 Vali Acc: 0.522 Test Loss: 1.030 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522212).  Saving model ...
Epoch: 7 cost time: 1.3945515155792236
Epoch: 7, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.130 Vali Acc: 0.489 Test Loss: 1.130 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3569741249084473
Epoch: 8, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.191 Vali Acc: 0.489 Test Loss: 1.191 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4446237087249756
Epoch: 9, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.458 Vali Acc: 0.483 Test Loss: 1.458 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5352246761322021
Epoch: 10, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.390 Vali Acc: 0.494 Test Loss: 1.390 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3517069816589355
Epoch: 11, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.617 Vali Acc: 0.522 Test Loss: 1.617 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7121243476867676
Epoch: 12, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.629 Vali Acc: 0.483 Test Loss: 1.629 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5115408897399902
Epoch: 13, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.897 Vali Acc: 0.517 Test Loss: 1.897 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.562117338180542
Epoch: 14, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.944 Vali Acc: 0.500 Test Loss: 1.944 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9873912334442139
Epoch: 15, Steps: 13 | Train Loss: 0.139 Vali Loss: 2.142 Vali Acc: 0.522 Test Loss: 2.142 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.504281759262085
Epoch: 16, Steps: 13 | Train Loss: 0.146 Vali Loss: 2.161 Vali Acc: 0.500 Test Loss: 2.161 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 443138
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.503645181655884
Epoch: 1, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.724 Vali Acc: 0.517 Test Loss: 0.724 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 0.9427154064178467
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.706 Vali Acc: 0.528 Test Loss: 0.706 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.8741970062255859
Epoch: 3, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.746 Vali Acc: 0.539 Test Loss: 0.746 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 0.8953814506530762
Epoch: 4, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.787 Vali Acc: 0.522 Test Loss: 0.787 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8917548656463623
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.883 Vali Acc: 0.517 Test Loss: 0.883 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7980151176452637
Epoch: 6, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.940 Vali Acc: 0.506 Test Loss: 0.940 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7636744976043701
Epoch: 7, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.049 Vali Acc: 0.522 Test Loss: 1.049 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8444843292236328
Epoch: 8, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.059 Vali Acc: 0.494 Test Loss: 1.059 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8627142906188965
Epoch: 9, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.213 Vali Acc: 0.506 Test Loss: 1.213 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8914613723754883
Epoch: 10, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8448147773742676
Epoch: 11, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.444 Vali Acc: 0.533 Test Loss: 1.444 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.954390287399292
Epoch: 12, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.446 Vali Acc: 0.483 Test Loss: 1.446 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8963286876678467
Epoch: 13, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.684 Vali Acc: 0.494 Test Loss: 1.684 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 443394
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4085896015167236
Epoch: 1, Steps: 13 | Train Loss: 0.831 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.8416287899017334
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.808 Vali Acc: 0.517 Test Loss: 0.808 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 0.9545519351959229
Epoch: 3, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.755 Vali Acc: 0.467 Test Loss: 0.755 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.812079906463623
Epoch: 4, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.829 Vali Acc: 0.489 Test Loss: 0.829 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8705408573150635
Epoch: 5, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.896 Vali Acc: 0.478 Test Loss: 0.896 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7945353984832764
Epoch: 6, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.948 Vali Acc: 0.494 Test Loss: 0.948 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.846358060836792
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.002 Vali Acc: 0.483 Test Loss: 1.002 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9203381538391113
Epoch: 8, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.066 Vali Acc: 0.489 Test Loss: 1.066 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.892996072769165
Epoch: 9, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.157 Vali Acc: 0.489 Test Loss: 1.157 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9467170238494873
Epoch: 10, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.242 Vali Acc: 0.483 Test Loss: 1.242 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8360917568206787
Epoch: 11, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.310 Vali Acc: 0.483 Test Loss: 1.310 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.930452823638916
Epoch: 12, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.431 Vali Acc: 0.483 Test Loss: 1.431 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 448898
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3299975395202637
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.828 Vali Acc: 0.472 Test Loss: 0.828 Test Acc: 0.472
Validation loss decreased (inf --> -0.472214).  Saving model ...
Epoch: 2 cost time: 1.7611405849456787
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.864 Vali Acc: 0.472 Test Loss: 0.864 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.033125638961792
Epoch: 3, Steps: 13 | Train Loss: 0.509 Vali Loss: 1.251 Vali Acc: 0.483 Test Loss: 1.251 Test Acc: 0.483
Validation loss decreased (-0.472214 --> -0.483321).  Saving model ...
Epoch: 4 cost time: 1.7887027263641357
Epoch: 4, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.348 Vali Acc: 0.489 Test Loss: 1.348 Test Acc: 0.489
Validation loss decreased (-0.483321 --> -0.488875).  Saving model ...
Epoch: 5 cost time: 2.0856242179870605
Epoch: 5, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.916 Vali Acc: 0.528 Test Loss: 1.916 Test Acc: 0.528
Validation loss decreased (-0.488875 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 2.087998867034912
Epoch: 6, Steps: 13 | Train Loss: 0.455 Vali Loss: 2.218 Vali Acc: 0.467 Test Loss: 2.218 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0538649559020996
Epoch: 7, Steps: 13 | Train Loss: 0.479 Vali Loss: 2.614 Vali Acc: 0.444 Test Loss: 2.614 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.317138195037842
Epoch: 8, Steps: 13 | Train Loss: 0.328 Vali Loss: 2.700 Vali Acc: 0.489 Test Loss: 2.700 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0555245876312256
Epoch: 9, Steps: 13 | Train Loss: 0.190 Vali Loss: 2.941 Vali Acc: 0.450 Test Loss: 2.941 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.31134033203125
Epoch: 10, Steps: 13 | Train Loss: 0.200 Vali Loss: 3.087 Vali Acc: 0.456 Test Loss: 3.087 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.109281063079834
Epoch: 11, Steps: 13 | Train Loss: 0.285 Vali Loss: 3.487 Vali Acc: 0.450 Test Loss: 3.487 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.166099786758423
Epoch: 12, Steps: 13 | Train Loss: 0.192 Vali Loss: 3.590 Vali Acc: 0.478 Test Loss: 3.590 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2498672008514404
Epoch: 13, Steps: 13 | Train Loss: 0.175 Vali Loss: 3.996 Vali Acc: 0.500 Test Loss: 3.996 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9824411869049072
Epoch: 14, Steps: 13 | Train Loss: 0.108 Vali Loss: 4.516 Vali Acc: 0.494 Test Loss: 4.516 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1882920265197754
Epoch: 15, Steps: 13 | Train Loss: 0.131 Vali Loss: 4.833 Vali Acc: 0.461 Test Loss: 4.833 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 438914
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.291899919509888
Epoch: 1, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.855 Vali Acc: 0.506 Test Loss: 0.855 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 2.13915753364563
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.961 Vali Acc: 0.517 Test Loss: 0.961 Test Acc: 0.517
Validation loss decreased (-0.505547 --> -0.516657).  Saving model ...
Epoch: 3 cost time: 2.3775956630706787
Epoch: 3, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.976 Vali Acc: 0.472 Test Loss: 0.976 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9798147678375244
Epoch: 4, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.337 Vali Acc: 0.467 Test Loss: 1.337 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.627187490463257
Epoch: 5, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.519 Vali Acc: 0.506 Test Loss: 1.519 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.494694232940674
Epoch: 6, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.547 Vali Acc: 0.494 Test Loss: 1.547 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.528628349304199
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.675 Vali Acc: 0.478 Test Loss: 1.675 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3906216621398926
Epoch: 8, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.801 Vali Acc: 0.500 Test Loss: 1.801 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.327544927597046
Epoch: 9, Steps: 13 | Train Loss: 0.312 Vali Loss: 2.345 Vali Acc: 0.483 Test Loss: 2.345 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7971675395965576
Epoch: 10, Steps: 13 | Train Loss: 0.327 Vali Loss: 2.230 Vali Acc: 0.472 Test Loss: 2.230 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1811296939849854
Epoch: 11, Steps: 13 | Train Loss: 0.347 Vali Loss: 2.397 Vali Acc: 0.500 Test Loss: 2.397 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6443920135498047
Epoch: 12, Steps: 13 | Train Loss: 0.204 Vali Loss: 2.804 Vali Acc: 0.467 Test Loss: 2.804 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 376322
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.378007411956787
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.747 Vali Acc: 0.483 Test Loss: 0.747 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.660033941268921
Epoch: 2, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.811 Vali Acc: 0.467 Test Loss: 0.811 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9083187580108643
Epoch: 3, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.929 Vali Acc: 0.483 Test Loss: 0.929 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8258414268493652
Epoch: 4, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.083 Vali Acc: 0.517 Test Loss: 1.083 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516656).  Saving model ...
Epoch: 5 cost time: 1.7644872665405273
Epoch: 5, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.158 Vali Acc: 0.489 Test Loss: 1.158 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7441704273223877
Epoch: 6, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.305 Vali Acc: 0.544 Test Loss: 1.305 Test Acc: 0.544
Validation loss decreased (-0.516656 --> -0.544431).  Saving model ...
Epoch: 7 cost time: 1.710211992263794
Epoch: 7, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.414 Vali Acc: 0.511 Test Loss: 1.414 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2460367679595947
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.514 Vali Acc: 0.461 Test Loss: 1.514 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8344531059265137
Epoch: 9, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.686 Vali Acc: 0.506 Test Loss: 1.686 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0155768394470215
Epoch: 10, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.854 Vali Acc: 0.506 Test Loss: 1.854 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.157116174697876
Epoch: 11, Steps: 13 | Train Loss: 0.156 Vali Loss: 2.006 Vali Acc: 0.522 Test Loss: 2.006 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9602553844451904
Epoch: 12, Steps: 13 | Train Loss: 0.161 Vali Loss: 2.245 Vali Acc: 0.472 Test Loss: 2.245 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.14619517326355
Epoch: 13, Steps: 13 | Train Loss: 0.144 Vali Loss: 2.419 Vali Acc: 0.494 Test Loss: 2.419 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.231839179992676
Epoch: 14, Steps: 13 | Train Loss: 0.161 Vali Loss: 2.548 Vali Acc: 0.517 Test Loss: 2.548 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9289824962615967
Epoch: 15, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.782 Vali Acc: 0.494 Test Loss: 2.782 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.022604465484619
Epoch: 16, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.810 Vali Acc: 0.494 Test Loss: 2.810 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 356738
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4636847972869873
Epoch: 1, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.771 Vali Acc: 0.483 Test Loss: 0.771 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.9257211685180664
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.758 Vali Acc: 0.472 Test Loss: 0.758 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.242375135421753
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.831 Vali Acc: 0.456 Test Loss: 0.831 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0421299934387207
Epoch: 4, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.907 Vali Acc: 0.511 Test Loss: 0.907 Test Acc: 0.511
Validation loss decreased (-0.483326 --> -0.511102).  Saving model ...
Epoch: 5 cost time: 2.013744354248047
Epoch: 5, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.061 Vali Acc: 0.483 Test Loss: 1.061 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0772805213928223
Epoch: 6, Steps: 13 | Train Loss: 0.377 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.905461311340332
Epoch: 7, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.276 Vali Acc: 0.522 Test Loss: 1.276 Test Acc: 0.522
Validation loss decreased (-0.511102 --> -0.522209).  Saving model ...
Epoch: 8 cost time: 2.2960405349731445
Epoch: 8, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.406 Vali Acc: 0.528 Test Loss: 1.406 Test Acc: 0.528
Validation loss decreased (-0.522209 --> -0.527764).  Saving model ...
Epoch: 9 cost time: 1.8789827823638916
Epoch: 9, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.570 Vali Acc: 0.511 Test Loss: 1.570 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7895312309265137
Epoch: 10, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.678 Vali Acc: 0.456 Test Loss: 1.678 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1783294677734375
Epoch: 11, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.638 Vali Acc: 0.506 Test Loss: 1.638 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8688836097717285
Epoch: 12, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.088 Vali Acc: 0.489 Test Loss: 2.088 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7284727096557617
Epoch: 13, Steps: 13 | Train Loss: 0.196 Vali Loss: 2.147 Vali Acc: 0.506 Test Loss: 2.147 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.863732099533081
Epoch: 14, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.101 Vali Acc: 0.494 Test Loss: 2.101 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7906651496887207
Epoch: 15, Steps: 13 | Train Loss: 0.150 Vali Loss: 2.479 Vali Acc: 0.467 Test Loss: 2.479 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7442107200622559
Epoch: 16, Steps: 13 | Train Loss: 0.130 Vali Loss: 2.530 Vali Acc: 0.489 Test Loss: 2.530 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6277480125427246
Epoch: 17, Steps: 13 | Train Loss: 0.109 Vali Loss: 2.647 Vali Acc: 0.478 Test Loss: 2.647 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8570208549499512
Epoch: 18, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.807 Vali Acc: 0.444 Test Loss: 2.807 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 347906
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5512540340423584
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.722 Vali Acc: 0.561 Test Loss: 0.722 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 1.6897687911987305
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.731 Vali Acc: 0.539 Test Loss: 0.731 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7603824138641357
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.752 Vali Acc: 0.544 Test Loss: 0.752 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8977892398834229
Epoch: 4, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.826 Vali Acc: 0.494 Test Loss: 0.826 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7567307949066162
Epoch: 5, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8700737953186035
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.053 Vali Acc: 0.483 Test Loss: 1.053 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1971445083618164
Epoch: 7, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.060 Vali Acc: 0.506 Test Loss: 1.060 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7208659648895264
Epoch: 8, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.135 Vali Acc: 0.517 Test Loss: 1.135 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7749137878417969
Epoch: 9, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.249 Vali Acc: 0.483 Test Loss: 1.249 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9017221927642822
Epoch: 10, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.472 Vali Acc: 0.506 Test Loss: 1.472 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.82603120803833
Epoch: 11, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.502 Vali Acc: 0.511 Test Loss: 1.502 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 344450
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.70139741897583
Epoch: 1, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.699 Vali Acc: 0.606 Test Loss: 0.699 Test Acc: 0.606
Validation loss decreased (inf --> -0.605549).  Saving model ...
Epoch: 2 cost time: 1.098555564880371
Epoch: 2, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.716 Vali Acc: 0.544 Test Loss: 0.716 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1446330547332764
Epoch: 3, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.721 Vali Acc: 0.533 Test Loss: 0.721 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.094353199005127
Epoch: 4, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.817 Vali Acc: 0.478 Test Loss: 0.817 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0644760131835938
Epoch: 5, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.873 Vali Acc: 0.533 Test Loss: 0.873 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1870403289794922
Epoch: 6, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.928 Vali Acc: 0.500 Test Loss: 0.928 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1097157001495361
Epoch: 7, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.052 Vali Acc: 0.506 Test Loss: 1.052 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.094353199005127
Epoch: 8, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0096213817596436
Epoch: 9, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.150 Vali Acc: 0.483 Test Loss: 1.150 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9310941696166992
Epoch: 10, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.185 Vali Acc: 0.483 Test Loss: 1.185 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9849734306335449
Epoch: 11, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6055555555555555
model parameter : 344706
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1561732292175293
Epoch: 1, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.736 Vali Acc: 0.511 Test Loss: 0.736 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.0154433250427246
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.715 Vali Acc: 0.539 Test Loss: 0.715 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.2111270427703857
Epoch: 3, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.752 Vali Acc: 0.528 Test Loss: 0.752 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0139310359954834
Epoch: 4, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.776 Vali Acc: 0.511 Test Loss: 0.776 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0665602684020996
Epoch: 5, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.816 Vali Acc: 0.544 Test Loss: 0.816 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544436).  Saving model ...
Epoch: 6 cost time: 1.058763027191162
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.908 Vali Acc: 0.511 Test Loss: 0.908 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0357909202575684
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.944 Vali Acc: 0.500 Test Loss: 0.944 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.103398084640503
Epoch: 8, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.019 Vali Acc: 0.522 Test Loss: 1.019 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0073614120483398
Epoch: 9, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.256990909576416
Epoch: 10, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.155 Vali Acc: 0.544 Test Loss: 1.155 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.021392583847046
Epoch: 11, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.265 Vali Acc: 0.511 Test Loss: 1.265 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.167912483215332
Epoch: 12, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.397 Vali Acc: 0.528 Test Loss: 1.397 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3216350078582764
Epoch: 13, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.425 Vali Acc: 0.506 Test Loss: 1.425 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1050209999084473
Epoch: 14, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.589 Vali Acc: 0.483 Test Loss: 1.589 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2002923488616943
Epoch: 15, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.673 Vali Acc: 0.494 Test Loss: 1.673 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 350210
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8566653728485107
Epoch: 1, Steps: 13 | Train Loss: 0.881 Vali Loss: 0.841 Vali Acc: 0.528 Test Loss: 0.841 Test Acc: 0.528
Validation loss decreased (inf --> -0.527769).  Saving model ...
Epoch: 2 cost time: 1.973860502243042
Epoch: 2, Steps: 13 | Train Loss: 0.761 Vali Loss: 1.169 Vali Acc: 0.511 Test Loss: 1.169 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9387221336364746
Epoch: 3, Steps: 13 | Train Loss: 0.629 Vali Loss: 1.238 Vali Acc: 0.511 Test Loss: 1.238 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.084803342819214
Epoch: 4, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.323 Vali Acc: 0.511 Test Loss: 1.323 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.090651273727417
Epoch: 5, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.528 Vali Acc: 0.522 Test Loss: 1.528 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1069226264953613
Epoch: 6, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.815 Vali Acc: 0.489 Test Loss: 1.815 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3306031227111816
Epoch: 7, Steps: 13 | Train Loss: 0.285 Vali Loss: 2.665 Vali Acc: 0.506 Test Loss: 2.665 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.09114933013916
Epoch: 8, Steps: 13 | Train Loss: 0.320 Vali Loss: 2.611 Vali Acc: 0.472 Test Loss: 2.611 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9432129859924316
Epoch: 9, Steps: 13 | Train Loss: 0.278 Vali Loss: 3.216 Vali Acc: 0.511 Test Loss: 3.216 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9363658428192139
Epoch: 10, Steps: 13 | Train Loss: 0.324 Vali Loss: 3.273 Vali Acc: 0.472 Test Loss: 3.273 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0332868099212646
Epoch: 11, Steps: 13 | Train Loss: 0.267 Vali Loss: 4.170 Vali Acc: 0.456 Test Loss: 4.170 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 389570
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5041654109954834
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.752 Vali Acc: 0.511 Test Loss: 0.752 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.9553215503692627
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.824 Vali Acc: 0.511 Test Loss: 0.824 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8269236087799072
Epoch: 3, Steps: 13 | Train Loss: 0.550 Vali Loss: 1.060 Vali Acc: 0.472 Test Loss: 1.060 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0827889442443848
Epoch: 4, Steps: 13 | Train Loss: 0.486 Vali Loss: 1.053 Vali Acc: 0.461 Test Loss: 1.053 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2759268283843994
Epoch: 5, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.383 Vali Acc: 0.478 Test Loss: 1.383 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0377049446105957
Epoch: 6, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1111576557159424
Epoch: 7, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.471 Vali Acc: 0.506 Test Loss: 1.471 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.024221658706665
Epoch: 8, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.731 Vali Acc: 0.489 Test Loss: 1.731 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.027683734893799
Epoch: 9, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.965 Vali Acc: 0.506 Test Loss: 1.965 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9496443271636963
Epoch: 10, Steps: 13 | Train Loss: 0.212 Vali Loss: 2.145 Vali Acc: 0.483 Test Loss: 2.145 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9048104286193848
Epoch: 11, Steps: 13 | Train Loss: 0.184 Vali Loss: 2.473 Vali Acc: 0.511 Test Loss: 2.473 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 326978
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6338694095611572
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.952265977859497
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.780 Vali Acc: 0.517 Test Loss: 0.780 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.9153802394866943
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.888 Vali Acc: 0.506 Test Loss: 0.888 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9987468719482422
Epoch: 4, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.010 Vali Acc: 0.489 Test Loss: 1.010 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8007493019104004
Epoch: 5, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.176 Vali Acc: 0.528 Test Loss: 1.176 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527766).  Saving model ...
Epoch: 6 cost time: 1.8155086040496826
Epoch: 6, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.281 Vali Acc: 0.467 Test Loss: 1.281 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9326376914978027
Epoch: 7, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.482 Vali Acc: 0.478 Test Loss: 1.482 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8411612510681152
Epoch: 8, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.562 Vali Acc: 0.467 Test Loss: 1.562 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9557535648345947
Epoch: 9, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.638 Vali Acc: 0.528 Test Loss: 1.638 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.138030767440796
Epoch: 10, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.896 Vali Acc: 0.511 Test Loss: 1.896 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0203640460968018
Epoch: 11, Steps: 13 | Train Loss: 0.197 Vali Loss: 2.105 Vali Acc: 0.450 Test Loss: 2.105 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9168345928192139
Epoch: 12, Steps: 13 | Train Loss: 0.172 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8068535327911377
Epoch: 13, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.298 Vali Acc: 0.517 Test Loss: 2.298 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8346753120422363
Epoch: 14, Steps: 13 | Train Loss: 0.173 Vali Loss: 2.802 Vali Acc: 0.483 Test Loss: 2.802 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8804309368133545
Epoch: 15, Steps: 13 | Train Loss: 0.175 Vali Loss: 2.615 Vali Acc: 0.489 Test Loss: 2.615 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 307394
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2518973350524902
Epoch: 1, Steps: 13 | Train Loss: 0.841 Vali Loss: 0.793 Vali Acc: 0.478 Test Loss: 0.793 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.958634376525879
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.782 Vali Acc: 0.528 Test Loss: 0.782 Test Acc: 0.528
Validation loss decreased (-0.477770 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.990706443786621
Epoch: 3, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.886 Vali Acc: 0.500 Test Loss: 0.886 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.054655075073242
Epoch: 4, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.893 Vali Acc: 0.511 Test Loss: 0.893 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8375275135040283
Epoch: 5, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7066798210144043
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.173 Vali Acc: 0.506 Test Loss: 1.173 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8884413242340088
Epoch: 7, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.270 Vali Acc: 0.517 Test Loss: 1.270 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8780899047851562
Epoch: 8, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.332 Vali Acc: 0.472 Test Loss: 1.332 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8079280853271484
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.437 Vali Acc: 0.506 Test Loss: 1.437 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.025822639465332
Epoch: 10, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.643 Vali Acc: 0.522 Test Loss: 1.643 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8909504413604736
Epoch: 11, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.691 Vali Acc: 0.506 Test Loss: 1.691 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8486602306365967
Epoch: 12, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.837 Vali Acc: 0.506 Test Loss: 1.837 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 298562
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4341049194335938
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.754 Vali Acc: 0.489 Test Loss: 0.754 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.7089588642120361
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.748 Vali Acc: 0.511 Test Loss: 0.748 Test Acc: 0.511
Validation loss decreased (-0.488881 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.8119804859161377
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.803 Vali Acc: 0.489 Test Loss: 0.803 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6875536441802979
Epoch: 4, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.890 Vali Acc: 0.528 Test Loss: 0.890 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527769).  Saving model ...
Epoch: 5 cost time: 1.6203389167785645
Epoch: 5, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.950 Vali Acc: 0.472 Test Loss: 0.950 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6516335010528564
Epoch: 6, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.008 Vali Acc: 0.494 Test Loss: 1.008 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6833326816558838
Epoch: 7, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.105 Vali Acc: 0.506 Test Loss: 1.105 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.028473138809204
Epoch: 8, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.185 Vali Acc: 0.472 Test Loss: 1.185 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1154565811157227
Epoch: 9, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.363 Vali Acc: 0.522 Test Loss: 1.363 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7302253246307373
Epoch: 10, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.375 Vali Acc: 0.511 Test Loss: 1.375 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1073689460754395
Epoch: 11, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.483 Vali Acc: 0.506 Test Loss: 1.483 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8616156578063965
Epoch: 12, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.574 Vali Acc: 0.483 Test Loss: 1.574 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.153937578201294
Epoch: 13, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.709 Vali Acc: 0.539 Test Loss: 1.709 Test Acc: 0.539
Validation loss decreased (-0.527769 --> -0.538872).  Saving model ...
Epoch: 14 cost time: 1.8106365203857422
Epoch: 14, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.822 Vali Acc: 0.528 Test Loss: 1.822 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1138901710510254
Epoch: 15, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.836 Vali Acc: 0.511 Test Loss: 1.836 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9222216606140137
Epoch: 16, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.016 Vali Acc: 0.489 Test Loss: 2.016 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2901413440704346
Epoch: 17, Steps: 13 | Train Loss: 0.140 Vali Loss: 2.197 Vali Acc: 0.461 Test Loss: 2.197 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6519207954406738
Epoch: 18, Steps: 13 | Train Loss: 0.106 Vali Loss: 2.319 Vali Acc: 0.467 Test Loss: 2.319 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9244415760040283
Epoch: 19, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.370 Vali Acc: 0.478 Test Loss: 2.370 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5206444263458252
Epoch: 20, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.694 Vali Acc: 0.500 Test Loss: 2.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8948776721954346
Epoch: 21, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.652 Vali Acc: 0.500 Test Loss: 2.652 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6560814380645752
Epoch: 22, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.755 Vali Acc: 0.478 Test Loss: 2.755 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1317367553710938
Epoch: 23, Steps: 13 | Train Loss: 0.061 Vali Loss: 3.034 Vali Acc: 0.494 Test Loss: 3.034 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 295106
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8810153007507324
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1880066394805908
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.724 Vali Acc: 0.517 Test Loss: 0.724 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.1030621528625488
Epoch: 3, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.770 Vali Acc: 0.517 Test Loss: 0.770 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1263599395751953
Epoch: 4, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.796 Vali Acc: 0.506 Test Loss: 0.796 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1943016052246094
Epoch: 5, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.905 Vali Acc: 0.522 Test Loss: 0.905 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522213).  Saving model ...
Epoch: 6 cost time: 1.0266423225402832
Epoch: 6, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.904 Vali Acc: 0.494 Test Loss: 0.904 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1919620037078857
Epoch: 7, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.026 Vali Acc: 0.478 Test Loss: 1.026 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2655613422393799
Epoch: 8, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0178544521331787
Epoch: 9, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.120 Vali Acc: 0.489 Test Loss: 1.120 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.993088960647583
Epoch: 10, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.219 Vali Acc: 0.489 Test Loss: 1.219 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0790915489196777
Epoch: 11, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0481765270233154
Epoch: 12, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.404 Vali Acc: 0.489 Test Loss: 1.404 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1129367351531982
Epoch: 13, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.470 Vali Acc: 0.461 Test Loss: 1.470 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.089606761932373
Epoch: 14, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.566 Vali Acc: 0.472 Test Loss: 1.566 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0875234603881836
Epoch: 15, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.671 Vali Acc: 0.483 Test Loss: 1.671 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 295362
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7994749546051025
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.725 Vali Acc: 0.522 Test Loss: 0.725 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.0899217128753662
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.711 Vali Acc: 0.494 Test Loss: 0.711 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9758799076080322
Epoch: 3, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0963940620422363
Epoch: 4, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.783 Vali Acc: 0.511 Test Loss: 0.783 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0467562675476074
Epoch: 5, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.893 Vali Acc: 0.494 Test Loss: 0.893 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0589642524719238
Epoch: 6, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0556423664093018
Epoch: 7, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.974 Vali Acc: 0.517 Test Loss: 0.974 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1438264846801758
Epoch: 8, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.051 Vali Acc: 0.517 Test Loss: 1.051 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9839270114898682
Epoch: 9, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 1.1165385246276855
Epoch: 10, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.195 Vali Acc: 0.517 Test Loss: 1.195 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0844686031341553
Epoch: 11, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.271 Vali Acc: 0.506 Test Loss: 1.271 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9892487525939941
Epoch: 12, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.384 Vali Acc: 0.517 Test Loss: 1.384 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.030099630355835
Epoch: 13, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.585 Vali Acc: 0.528 Test Loss: 1.585 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1208596229553223
Epoch: 14, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.564 Vali Acc: 0.489 Test Loss: 1.564 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1013264656066895
Epoch: 15, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.627 Vali Acc: 0.478 Test Loss: 1.627 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9861061573028564
Epoch: 16, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.690 Vali Acc: 0.506 Test Loss: 1.690 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0190846920013428
Epoch: 17, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.801 Vali Acc: 0.494 Test Loss: 1.801 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0461149215698242
Epoch: 18, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.994 Vali Acc: 0.522 Test Loss: 1.994 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1084725856781006
Epoch: 19, Steps: 13 | Train Loss: 0.117 Vali Loss: 2.046 Vali Acc: 0.500 Test Loss: 2.046 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm128_nh16_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 300866
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7707107067108154
Epoch: 1, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.751 Vali Acc: 0.489 Test Loss: 0.751 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.8157508373260498
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.769 Vali Acc: 0.478 Test Loss: 0.769 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9213685989379883
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.973 Vali Acc: 0.506 Test Loss: 0.973 Test Acc: 0.506
Validation loss decreased (-0.488881 --> -0.505546).  Saving model ...
Epoch: 4 cost time: 1.8243603706359863
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.038 Vali Acc: 0.506 Test Loss: 1.038 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8430283069610596
Epoch: 5, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.417 Vali Acc: 0.494 Test Loss: 1.417 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.879502534866333
Epoch: 6, Steps: 13 | Train Loss: 0.443 Vali Loss: 1.385 Vali Acc: 0.461 Test Loss: 1.385 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.870229721069336
Epoch: 7, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.633 Vali Acc: 0.467 Test Loss: 1.633 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.963043212890625
Epoch: 8, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.646 Vali Acc: 0.478 Test Loss: 1.646 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.736135721206665
Epoch: 9, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.935 Vali Acc: 0.461 Test Loss: 1.935 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.257720708847046
Epoch: 10, Steps: 13 | Train Loss: 0.224 Vali Loss: 2.146 Vali Acc: 0.478 Test Loss: 2.146 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7275390625
Epoch: 11, Steps: 13 | Train Loss: 0.173 Vali Loss: 2.185 Vali Acc: 0.467 Test Loss: 2.185 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8677871227264404
Epoch: 12, Steps: 13 | Train Loss: 0.131 Vali Loss: 2.758 Vali Acc: 0.456 Test Loss: 2.758 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8562233448028564
Epoch: 13, Steps: 13 | Train Loss: 0.090 Vali Loss: 2.934 Vali Acc: 0.439 Test Loss: 2.934 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 220034
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3745367527008057
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.702 Vali Acc: 0.494 Test Loss: 0.702 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.4984245300292969
Epoch: 2, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.844 Vali Acc: 0.511 Test Loss: 0.844 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 1.45707106590271
Epoch: 3, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.799 Vali Acc: 0.494 Test Loss: 0.799 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7636346817016602
Epoch: 4, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.902 Vali Acc: 0.511 Test Loss: 0.902 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8478903770446777
Epoch: 5, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.952 Vali Acc: 0.456 Test Loss: 0.952 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.815310001373291
Epoch: 6, Steps: 13 | Train Loss: 0.515 Vali Loss: 1.121 Vali Acc: 0.511 Test Loss: 1.121 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9615027904510498
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.171 Vali Acc: 0.517 Test Loss: 1.171 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516655).  Saving model ...
Epoch: 8 cost time: 1.4304454326629639
Epoch: 8, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8635737895965576
Epoch: 9, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.259 Vali Acc: 0.494 Test Loss: 1.259 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6456518173217773
Epoch: 10, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.483 Vali Acc: 0.517 Test Loss: 1.483 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.600090503692627
Epoch: 11, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.599 Vali Acc: 0.478 Test Loss: 1.599 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6047534942626953
Epoch: 12, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.798 Vali Acc: 0.489 Test Loss: 1.798 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5840015411376953
Epoch: 13, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.883 Vali Acc: 0.461 Test Loss: 1.883 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9667413234710693
Epoch: 14, Steps: 13 | Train Loss: 0.147 Vali Loss: 2.180 Vali Acc: 0.478 Test Loss: 2.180 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.142042636871338
Epoch: 15, Steps: 13 | Train Loss: 0.135 Vali Loss: 2.093 Vali Acc: 0.500 Test Loss: 2.093 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6577179431915283
Epoch: 16, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.316 Vali Acc: 0.444 Test Loss: 2.316 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6014325618743896
Epoch: 17, Steps: 13 | Train Loss: 0.085 Vali Loss: 2.569 Vali Acc: 0.467 Test Loss: 2.569 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 188738
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.001230239868164
Epoch: 1, Steps: 13 | Train Loss: 0.785 Vali Loss: 0.705 Vali Acc: 0.556 Test Loss: 0.705 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 2.0072758197784424
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.682 Vali Acc: 0.544 Test Loss: 0.682 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9802577495574951
Epoch: 3, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.769 Vali Acc: 0.533 Test Loss: 0.769 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7708799839019775
Epoch: 4, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.787 Vali Acc: 0.533 Test Loss: 0.787 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6750032901763916
Epoch: 5, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.057264804840088
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.913 Vali Acc: 0.522 Test Loss: 0.913 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0876197814941406
Epoch: 7, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.004 Vali Acc: 0.533 Test Loss: 1.004 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9564743041992188
Epoch: 8, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.108 Vali Acc: 0.522 Test Loss: 1.108 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8111984729766846
Epoch: 9, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.264 Vali Acc: 0.539 Test Loss: 1.264 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9584228992462158
Epoch: 10, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.276 Vali Acc: 0.539 Test Loss: 1.276 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4046318531036377
Epoch: 11, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 178946
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4352970123291016
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.732 Vali Acc: 0.483 Test Loss: 0.732 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 2.0028655529022217
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.744 Vali Acc: 0.511 Test Loss: 0.744 Test Acc: 0.511
Validation loss decreased (-0.483326 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.5808789730072021
Epoch: 3, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.764 Vali Acc: 0.539 Test Loss: 0.764 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 1.6233644485473633
Epoch: 4, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.775 Vali Acc: 0.522 Test Loss: 0.775 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4053773880004883
Epoch: 5, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.818 Vali Acc: 0.511 Test Loss: 0.818 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4085776805877686
Epoch: 6, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.874 Vali Acc: 0.483 Test Loss: 0.874 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5347445011138916
Epoch: 7, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.941 Vali Acc: 0.478 Test Loss: 0.941 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5378475189208984
Epoch: 8, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.031 Vali Acc: 0.494 Test Loss: 1.031 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.721731424331665
Epoch: 9, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.094 Vali Acc: 0.489 Test Loss: 1.094 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4189050197601318
Epoch: 10, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.167 Vali Acc: 0.483 Test Loss: 1.167 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.735370397567749
Epoch: 11, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.245 Vali Acc: 0.528 Test Loss: 1.245 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.724797010421753
Epoch: 12, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.277 Vali Acc: 0.478 Test Loss: 1.277 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.600224494934082
Epoch: 13, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.361 Vali Acc: 0.489 Test Loss: 1.361 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 174530
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8908607959747314
Epoch: 1, Steps: 13 | Train Loss: 0.816 Vali Loss: 0.704 Vali Acc: 0.511 Test Loss: 0.704 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.9697904586791992
Epoch: 2, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.702 Vali Acc: 0.522 Test Loss: 0.702 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.0148794651031494
Epoch: 3, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.695 Vali Acc: 0.544 Test Loss: 0.695 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.0824694633483887
Epoch: 4, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.759 Vali Acc: 0.561 Test Loss: 0.759 Test Acc: 0.561
Validation loss decreased (-0.544437 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 0.8843750953674316
Epoch: 5, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.764 Vali Acc: 0.478 Test Loss: 0.764 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.030486822128296
Epoch: 6, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.844 Vali Acc: 0.511 Test Loss: 0.844 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0156071186065674
Epoch: 7, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.863 Vali Acc: 0.478 Test Loss: 0.863 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.063697338104248
Epoch: 8, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.913 Vali Acc: 0.522 Test Loss: 0.913 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0215959548950195
Epoch: 9, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.935 Vali Acc: 0.472 Test Loss: 0.935 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0939874649047852
Epoch: 10, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.077 Vali Acc: 0.567 Test Loss: 1.077 Test Acc: 0.567
Validation loss decreased (-0.561104 --> -0.566656).  Saving model ...
Epoch: 11 cost time: 0.9605638980865479
Epoch: 11, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.075 Vali Acc: 0.511 Test Loss: 1.075 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1095759868621826
Epoch: 12, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0078315734863281
Epoch: 13, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.208 Vali Acc: 0.506 Test Loss: 1.208 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9362695217132568
Epoch: 14, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.254 Vali Acc: 0.511 Test Loss: 1.254 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0089001655578613
Epoch: 15, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.352 Vali Acc: 0.467 Test Loss: 1.352 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1032984256744385
Epoch: 16, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0202069282531738
Epoch: 17, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.441 Vali Acc: 0.489 Test Loss: 1.441 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9650118350982666
Epoch: 18, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0283772945404053
Epoch: 19, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.619 Vali Acc: 0.494 Test Loss: 1.619 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0280461311340332
Epoch: 20, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 172802
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.693847894668579
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.758 Vali Acc: 0.478 Test Loss: 0.758 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.037611961364746
Epoch: 2, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.723 Vali Acc: 0.483 Test Loss: 0.723 Test Acc: 0.483
Validation loss decreased (-0.477770 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 0.9991843700408936
Epoch: 3, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.748 Vali Acc: 0.522 Test Loss: 0.748 Test Acc: 0.522
Validation loss decreased (-0.483326 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.0281870365142822
Epoch: 4, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.766 Vali Acc: 0.461 Test Loss: 0.766 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0734233856201172
Epoch: 5, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.796 Vali Acc: 0.489 Test Loss: 0.796 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0745787620544434
Epoch: 6, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.869 Vali Acc: 0.494 Test Loss: 0.869 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1366031169891357
Epoch: 7, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.867 Vali Acc: 0.478 Test Loss: 0.867 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0691370964050293
Epoch: 8, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.903 Vali Acc: 0.478 Test Loss: 0.903 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0973873138427734
Epoch: 9, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.987 Vali Acc: 0.494 Test Loss: 0.987 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.015242576599121
Epoch: 10, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.054 Vali Acc: 0.517 Test Loss: 1.054 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.137341022491455
Epoch: 11, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.070 Vali Acc: 0.522 Test Loss: 1.070 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.183115005493164
Epoch: 12, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.156 Vali Acc: 0.489 Test Loss: 1.156 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.132136583328247
Epoch: 13, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.140 Vali Acc: 0.506 Test Loss: 1.140 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 172930
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1748790740966797
Epoch: 1, Steps: 13 | Train Loss: 0.802 Vali Loss: 0.737 Vali Acc: 0.444 Test Loss: 0.737 Test Acc: 0.444
Validation loss decreased (inf --> -0.444437).  Saving model ...
Epoch: 2 cost time: 0.9640829563140869
Epoch: 2, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.739 Vali Acc: 0.478 Test Loss: 0.739 Test Acc: 0.478
Validation loss decreased (-0.444437 --> -0.477770).  Saving model ...
Epoch: 3 cost time: 1.0499749183654785
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.730 Vali Acc: 0.467 Test Loss: 0.730 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.981511116027832
Epoch: 4, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.745 Vali Acc: 0.483 Test Loss: 0.745 Test Acc: 0.483
Validation loss decreased (-0.477770 --> -0.483326).  Saving model ...
Epoch: 5 cost time: 1.0171401500701904
Epoch: 5, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.790 Vali Acc: 0.517 Test Loss: 0.790 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516659).  Saving model ...
Epoch: 6 cost time: 1.0194425582885742
Epoch: 6, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.842 Vali Acc: 0.494 Test Loss: 0.842 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9868130683898926
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.847 Vali Acc: 0.511 Test Loss: 0.847 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0438098907470703
Epoch: 8, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.912 Vali Acc: 0.500 Test Loss: 0.912 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0208122730255127
Epoch: 9, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.947 Vali Acc: 0.528 Test Loss: 0.947 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527768).  Saving model ...
Epoch: 10 cost time: 1.1076276302337646
Epoch: 10, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.980 Vali Acc: 0.517 Test Loss: 0.980 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0367326736450195
Epoch: 11, Steps: 13 | Train Loss: 0.377 Vali Loss: 1.064 Vali Acc: 0.511 Test Loss: 1.064 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2506253719329834
Epoch: 12, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.095 Vali Acc: 0.494 Test Loss: 1.095 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1593537330627441
Epoch: 13, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.146 Vali Acc: 0.494 Test Loss: 1.146 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1408836841583252
Epoch: 14, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.164 Vali Acc: 0.506 Test Loss: 1.164 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1288540363311768
Epoch: 15, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.238 Vali Acc: 0.517 Test Loss: 1.238 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0490963459014893
Epoch: 16, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.301 Vali Acc: 0.528 Test Loss: 1.301 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1018502712249756
Epoch: 17, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.388 Vali Acc: 0.506 Test Loss: 1.388 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.941979169845581
Epoch: 18, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.163158655166626
Epoch: 19, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.507 Vali Acc: 0.506 Test Loss: 1.507 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 175682
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1566178798675537
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.828 Vali Acc: 0.489 Test Loss: 0.828 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.4993181228637695
Epoch: 2, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.784 Vali Acc: 0.494 Test Loss: 0.784 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.507570505142212
Epoch: 3, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.924 Vali Acc: 0.472 Test Loss: 0.924 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.634087324142456
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.038 Vali Acc: 0.483 Test Loss: 1.038 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.590404748916626
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.199 Vali Acc: 0.472 Test Loss: 1.199 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.557373285293579
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.456 Vali Acc: 0.528 Test Loss: 1.456 Test Acc: 0.528
Validation loss decreased (-0.494437 --> -0.527763).  Saving model ...
Epoch: 7 cost time: 1.5741984844207764
Epoch: 7, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.661 Vali Acc: 0.478 Test Loss: 1.661 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6462528705596924
Epoch: 8, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.768 Vali Acc: 0.467 Test Loss: 1.768 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6499426364898682
Epoch: 9, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.901 Vali Acc: 0.450 Test Loss: 1.901 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6041672229766846
Epoch: 10, Steps: 13 | Train Loss: 0.183 Vali Loss: 2.121 Vali Acc: 0.461 Test Loss: 2.121 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5459344387054443
Epoch: 11, Steps: 13 | Train Loss: 0.174 Vali Loss: 2.290 Vali Acc: 0.450 Test Loss: 2.290 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.593294620513916
Epoch: 12, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.594 Vali Acc: 0.478 Test Loss: 2.594 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.599632740020752
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 2.737 Vali Acc: 0.439 Test Loss: 2.737 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6394095420837402
Epoch: 14, Steps: 13 | Train Loss: 0.089 Vali Loss: 3.316 Vali Acc: 0.456 Test Loss: 3.316 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5287883281707764
Epoch: 15, Steps: 13 | Train Loss: 0.059 Vali Loss: 3.332 Vali Acc: 0.478 Test Loss: 3.332 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6090927124023438
Epoch: 16, Steps: 13 | Train Loss: 0.082 Vali Loss: 3.692 Vali Acc: 0.450 Test Loss: 3.692 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 170498
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3287861347198486
Epoch: 1, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.739 Vali Acc: 0.478 Test Loss: 0.739 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.7472624778747559
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.745 Vali Acc: 0.522 Test Loss: 0.745 Test Acc: 0.522
Validation loss decreased (-0.477770 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.7006490230560303
Epoch: 3, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.824 Vali Acc: 0.483 Test Loss: 0.824 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5706634521484375
Epoch: 4, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.856 Vali Acc: 0.467 Test Loss: 0.856 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6016573905944824
Epoch: 5, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.981 Vali Acc: 0.472 Test Loss: 0.981 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6230738162994385
Epoch: 6, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.040 Vali Acc: 0.489 Test Loss: 1.040 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.749462604522705
Epoch: 7, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6885647773742676
Epoch: 8, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.238 Vali Acc: 0.489 Test Loss: 1.238 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.787804365158081
Epoch: 9, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.363 Vali Acc: 0.456 Test Loss: 1.363 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.889988660812378
Epoch: 10, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.601 Vali Acc: 0.500 Test Loss: 1.601 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.96174955368042
Epoch: 11, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.537 Vali Acc: 0.500 Test Loss: 1.537 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7244434356689453
Epoch: 12, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.722 Vali Acc: 0.478 Test Loss: 1.722 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 139202
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.439948797225952
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.713 Vali Acc: 0.517 Test Loss: 0.713 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.701509952545166
Epoch: 2, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.704 Vali Acc: 0.539 Test Loss: 0.704 Test Acc: 0.539
Validation loss decreased (-0.516660 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.688857078552246
Epoch: 3, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8197648525238037
Epoch: 4, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.786 Vali Acc: 0.511 Test Loss: 0.786 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6815588474273682
Epoch: 5, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.865 Vali Acc: 0.522 Test Loss: 0.865 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.781520128250122
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.948 Vali Acc: 0.517 Test Loss: 0.948 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.90437912940979
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.003 Vali Acc: 0.517 Test Loss: 1.003 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7706737518310547
Epoch: 8, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.134 Vali Acc: 0.506 Test Loss: 1.134 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8513784408569336
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.207 Vali Acc: 0.489 Test Loss: 1.207 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8303818702697754
Epoch: 10, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.306 Vali Acc: 0.544 Test Loss: 1.306 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544431).  Saving model ...
Epoch: 11 cost time: 1.8848369121551514
Epoch: 11, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.351 Vali Acc: 0.506 Test Loss: 1.351 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.815748929977417
Epoch: 12, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.506 Vali Acc: 0.478 Test Loss: 1.506 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.882021427154541
Epoch: 13, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.586 Vali Acc: 0.539 Test Loss: 1.586 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7958524227142334
Epoch: 14, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.638 Vali Acc: 0.494 Test Loss: 1.638 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7553308010101318
Epoch: 15, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.779 Vali Acc: 0.483 Test Loss: 1.779 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7008233070373535
Epoch: 16, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.946 Vali Acc: 0.522 Test Loss: 1.946 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6469404697418213
Epoch: 17, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.998 Vali Acc: 0.500 Test Loss: 1.998 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.700110912322998
Epoch: 18, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.982 Vali Acc: 0.506 Test Loss: 1.982 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7556793689727783
Epoch: 19, Steps: 13 | Train Loss: 0.075 Vali Loss: 2.273 Vali Acc: 0.489 Test Loss: 2.273 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6706161499023438
Epoch: 20, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.269 Vali Acc: 0.511 Test Loss: 2.269 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 129410
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4301259517669678
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.777 Vali Acc: 0.467 Test Loss: 0.777 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.8642065525054932
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.774 Vali Acc: 0.439 Test Loss: 0.774 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.701220989227295
Epoch: 3, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.764 Vali Acc: 0.522 Test Loss: 0.764 Test Acc: 0.522
Validation loss decreased (-0.466659 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.7291288375854492
Epoch: 4, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.812 Vali Acc: 0.489 Test Loss: 0.812 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.739286184310913
Epoch: 5, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.857 Vali Acc: 0.506 Test Loss: 0.857 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.66835618019104
Epoch: 6, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.941 Vali Acc: 0.483 Test Loss: 0.941 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7125718593597412
Epoch: 7, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.034 Vali Acc: 0.511 Test Loss: 1.034 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7611358165740967
Epoch: 8, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.083 Vali Acc: 0.478 Test Loss: 1.083 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6476314067840576
Epoch: 9, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5691282749176025
Epoch: 10, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.257 Vali Acc: 0.478 Test Loss: 1.257 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1229236125946045
Epoch: 11, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.221 Vali Acc: 0.489 Test Loss: 1.221 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.395719289779663
Epoch: 12, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.388 Vali Acc: 0.494 Test Loss: 1.388 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4026103019714355
Epoch: 13, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.394 Vali Acc: 0.478 Test Loss: 1.394 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 124994
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.809610366821289
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.747 Vali Acc: 0.456 Test Loss: 0.747 Test Acc: 0.456
Validation loss decreased (inf --> -0.455548).  Saving model ...
Epoch: 2 cost time: 1.2400095462799072
Epoch: 2, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.754 Vali Acc: 0.472 Test Loss: 0.754 Test Acc: 0.472
Validation loss decreased (-0.455548 --> -0.472215).  Saving model ...
Epoch: 3 cost time: 1.4345037937164307
Epoch: 3, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.758 Vali Acc: 0.467 Test Loss: 0.758 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3165292739868164
Epoch: 4, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.801 Vali Acc: 0.450 Test Loss: 0.801 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4389770030975342
Epoch: 5, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.836 Vali Acc: 0.494 Test Loss: 0.836 Test Acc: 0.494
Validation loss decreased (-0.472215 --> -0.494436).  Saving model ...
Epoch: 6 cost time: 1.351799726486206
Epoch: 6, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
Validation loss decreased (-0.494436 --> -0.499991).  Saving model ...
Epoch: 7 cost time: 1.2355318069458008
Epoch: 7, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.920 Vali Acc: 0.500 Test Loss: 0.920 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2681026458740234
Epoch: 8, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.016 Vali Acc: 0.494 Test Loss: 1.016 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3332197666168213
Epoch: 9, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.076 Vali Acc: 0.483 Test Loss: 1.076 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2647135257720947
Epoch: 10, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.138 Vali Acc: 0.489 Test Loss: 1.138 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.342820167541504
Epoch: 11, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.173 Vali Acc: 0.478 Test Loss: 1.173 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3069818019866943
Epoch: 12, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.258 Vali Acc: 0.489 Test Loss: 1.258 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.099217414855957
Epoch: 13, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.303 Vali Acc: 0.494 Test Loss: 1.303 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2715082168579102
Epoch: 14, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.328 Vali Acc: 0.489 Test Loss: 1.328 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3463141918182373
Epoch: 15, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.451 Vali Acc: 0.467 Test Loss: 1.451 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.312237024307251
Epoch: 16, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.535 Vali Acc: 0.511 Test Loss: 1.535 Test Acc: 0.511
Validation loss decreased (-0.499991 --> -0.511096).  Saving model ...
Epoch: 17 cost time: 1.2729239463806152
Epoch: 17, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.589 Vali Acc: 0.467 Test Loss: 1.589 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3252639770507812
Epoch: 18, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.729 Vali Acc: 0.528 Test Loss: 1.729 Test Acc: 0.528
Validation loss decreased (-0.511096 --> -0.527760).  Saving model ...
Epoch: 19 cost time: 1.0590877532958984
Epoch: 19, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.769 Vali Acc: 0.478 Test Loss: 1.769 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2863223552703857
Epoch: 20, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.825 Vali Acc: 0.483 Test Loss: 1.825 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.288764238357544
Epoch: 21, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.889 Vali Acc: 0.478 Test Loss: 1.889 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3075239658355713
Epoch: 22, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.966 Vali Acc: 0.517 Test Loss: 1.966 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.331782579421997
Epoch: 23, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.998 Vali Acc: 0.494 Test Loss: 1.998 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3505096435546875
Epoch: 24, Steps: 13 | Train Loss: 0.110 Vali Loss: 2.106 Vali Acc: 0.494 Test Loss: 2.106 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1194519996643066
Epoch: 25, Steps: 13 | Train Loss: 0.087 Vali Loss: 2.144 Vali Acc: 0.483 Test Loss: 2.144 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2687139511108398
Epoch: 26, Steps: 13 | Train Loss: 0.057 Vali Loss: 2.192 Vali Acc: 0.483 Test Loss: 2.192 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3148448467254639
Epoch: 27, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.318 Vali Acc: 0.483 Test Loss: 2.318 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2811119556427002
Epoch: 28, Steps: 13 | Train Loss: 0.037 Vali Loss: 2.396 Vali Acc: 0.489 Test Loss: 2.396 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 123266
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9632205963134766
Epoch: 1, Steps: 13 | Train Loss: 0.814 Vali Loss: 0.762 Vali Acc: 0.461 Test Loss: 0.762 Test Acc: 0.461
Validation loss decreased (inf --> -0.461103).  Saving model ...
Epoch: 2 cost time: 1.1888482570648193
Epoch: 2, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.731 Vali Acc: 0.461 Test Loss: 0.731 Test Acc: 0.461
Validation loss decreased (-0.461103 --> -0.461104).  Saving model ...
Epoch: 3 cost time: 1.2733376026153564
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.734 Vali Acc: 0.517 Test Loss: 0.734 Test Acc: 0.517
Validation loss decreased (-0.461104 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.229339599609375
Epoch: 4, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.777 Vali Acc: 0.517 Test Loss: 0.777 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2473070621490479
Epoch: 5, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.801 Vali Acc: 0.472 Test Loss: 0.801 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2230241298675537
Epoch: 6, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.844 Vali Acc: 0.517 Test Loss: 0.844 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2724659442901611
Epoch: 7, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.866 Vali Acc: 0.483 Test Loss: 0.866 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1954374313354492
Epoch: 8, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.962 Vali Acc: 0.511 Test Loss: 0.962 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0943467617034912
Epoch: 9, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.985 Vali Acc: 0.500 Test Loss: 0.985 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.053715705871582
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.009 Vali Acc: 0.500 Test Loss: 1.009 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1274383068084717
Epoch: 11, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.091 Vali Acc: 0.511 Test Loss: 1.091 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1748888492584229
Epoch: 12, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.253861665725708
Epoch: 13, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.183 Vali Acc: 0.478 Test Loss: 1.183 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 123394
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.689654588699341
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.686 Vali Acc: 0.483 Test Loss: 0.686 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.2023444175720215
Epoch: 2, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.678 Vali Acc: 0.539 Test Loss: 0.678 Test Acc: 0.539
Validation loss decreased (-0.483326 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.2365598678588867
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.682 Vali Acc: 0.556 Test Loss: 0.682 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555549).  Saving model ...
Epoch: 4 cost time: 1.251779317855835
Epoch: 4, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.700 Vali Acc: 0.533 Test Loss: 0.700 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.182865858078003
Epoch: 5, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.721 Vali Acc: 0.544 Test Loss: 0.721 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2230987548828125
Epoch: 6, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.759 Vali Acc: 0.544 Test Loss: 0.759 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.07187819480896
Epoch: 7, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.800 Vali Acc: 0.522 Test Loss: 0.800 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0689077377319336
Epoch: 8, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.843 Vali Acc: 0.522 Test Loss: 0.843 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2054367065429688
Epoch: 9, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.867 Vali Acc: 0.533 Test Loss: 0.867 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.186680555343628
Epoch: 10, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.934 Vali Acc: 0.522 Test Loss: 0.934 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.251431941986084
Epoch: 11, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.968 Vali Acc: 0.522 Test Loss: 0.968 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1216926574707031
Epoch: 12, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.009 Vali Acc: 0.517 Test Loss: 1.009 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.061039924621582
Epoch: 13, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.053 Vali Acc: 0.506 Test Loss: 1.053 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 126146
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.380397081375122
Epoch: 1, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.778261423110962
Epoch: 2, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.865 Vali Acc: 0.517 Test Loss: 0.865 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.449847459793091
Epoch: 3, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.963 Vali Acc: 0.489 Test Loss: 0.963 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7444872856140137
Epoch: 4, Steps: 13 | Train Loss: 0.718 Vali Loss: 1.512 Vali Acc: 0.522 Test Loss: 1.512 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6869196891784668
Epoch: 5, Steps: 13 | Train Loss: 0.591 Vali Loss: 1.530 Vali Acc: 0.511 Test Loss: 1.530 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0296335220336914
Epoch: 6, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.287 Vali Acc: 0.478 Test Loss: 1.287 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8212761878967285
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.433 Vali Acc: 0.450 Test Loss: 1.433 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9562358856201172
Epoch: 8, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.731 Vali Acc: 0.472 Test Loss: 1.731 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.092383623123169
Epoch: 9, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.777 Vali Acc: 0.494 Test Loss: 1.777 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.852344274520874
Epoch: 10, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.864 Vali Acc: 0.444 Test Loss: 1.864 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6454403400421143
Epoch: 11, Steps: 13 | Train Loss: 0.118 Vali Loss: 2.180 Vali Acc: 0.478 Test Loss: 2.180 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 145730
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.410395622253418
Epoch: 1, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.706 Vali Acc: 0.517 Test Loss: 0.706 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 2.4210219383239746
Epoch: 2, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.728 Vali Acc: 0.544 Test Loss: 0.728 Test Acc: 0.544
Validation loss decreased (-0.516660 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.8668818473815918
Epoch: 3, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.778 Vali Acc: 0.528 Test Loss: 0.778 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6446866989135742
Epoch: 4, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.810 Vali Acc: 0.494 Test Loss: 0.810 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.362928628921509
Epoch: 5, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.962 Vali Acc: 0.556 Test Loss: 0.962 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555546).  Saving model ...
Epoch: 6 cost time: 1.7888224124908447
Epoch: 6, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.015 Vali Acc: 0.517 Test Loss: 1.015 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.340406656265259
Epoch: 7, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.118 Vali Acc: 0.517 Test Loss: 1.118 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6957907676696777
Epoch: 8, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.147 Vali Acc: 0.494 Test Loss: 1.147 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2787764072418213
Epoch: 9, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.397 Vali Acc: 0.461 Test Loss: 1.397 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0026025772094727
Epoch: 10, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.490 Vali Acc: 0.511 Test Loss: 1.490 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5641918182373047
Epoch: 11, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.706 Vali Acc: 0.539 Test Loss: 1.706 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1813220977783203
Epoch: 12, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.653 Vali Acc: 0.500 Test Loss: 1.653 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5832996368408203
Epoch: 13, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.682 Vali Acc: 0.478 Test Loss: 1.682 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1823818683624268
Epoch: 14, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.856 Vali Acc: 0.494 Test Loss: 1.856 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7687420845031738
Epoch: 15, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.957 Vali Acc: 0.483 Test Loss: 1.957 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 114434
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.041124105453491
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.687 Vali Acc: 0.561 Test Loss: 0.687 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 2.2351646423339844
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.705 Vali Acc: 0.583 Test Loss: 0.705 Test Acc: 0.583
Validation loss decreased (-0.561104 --> -0.583326).  Saving model ...
Epoch: 3 cost time: 2.202505111694336
Epoch: 3, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.718 Vali Acc: 0.544 Test Loss: 0.718 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.302915573120117
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.781 Vali Acc: 0.544 Test Loss: 0.781 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9160621166229248
Epoch: 5, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.856 Vali Acc: 0.533 Test Loss: 0.856 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1220953464508057
Epoch: 6, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.926 Vali Acc: 0.544 Test Loss: 0.926 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0878214836120605
Epoch: 7, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.995 Vali Acc: 0.544 Test Loss: 0.995 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0829451084136963
Epoch: 8, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.099 Vali Acc: 0.494 Test Loss: 1.099 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.155151844024658
Epoch: 9, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.194 Vali Acc: 0.561 Test Loss: 1.194 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.727343797683716
Epoch: 10, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.236 Vali Acc: 0.511 Test Loss: 1.236 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0818581581115723
Epoch: 11, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.325 Vali Acc: 0.489 Test Loss: 1.325 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.541696786880493
Epoch: 12, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.408 Vali Acc: 0.511 Test Loss: 1.408 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 104642
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.171271324157715
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.700 Vali Acc: 0.544 Test Loss: 0.700 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.9939708709716797
Epoch: 2, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.714 Vali Acc: 0.528 Test Loss: 0.714 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.644124746322632
Epoch: 3, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.725 Vali Acc: 0.522 Test Loss: 0.725 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0761947631835938
Epoch: 4, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.781 Vali Acc: 0.517 Test Loss: 0.781 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.640268325805664
Epoch: 5, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.829 Vali Acc: 0.511 Test Loss: 0.829 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.235809803009033
Epoch: 6, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.950 Vali Acc: 0.528 Test Loss: 0.950 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2828269004821777
Epoch: 7, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.923 Vali Acc: 0.528 Test Loss: 0.923 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.354233741760254
Epoch: 8, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.990 Vali Acc: 0.506 Test Loss: 0.990 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0862557888031006
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.114 Vali Acc: 0.506 Test Loss: 1.114 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6516478061676025
Epoch: 10, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.140 Vali Acc: 0.556 Test Loss: 1.140 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555544).  Saving model ...
Epoch: 11 cost time: 1.66060471534729
Epoch: 11, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.261 Vali Acc: 0.522 Test Loss: 1.261 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.311960220336914
Epoch: 12, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.303 Vali Acc: 0.506 Test Loss: 1.303 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.800851821899414
Epoch: 13, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.403 Vali Acc: 0.478 Test Loss: 1.403 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2925565242767334
Epoch: 14, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.421 Vali Acc: 0.478 Test Loss: 1.421 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.338121175765991
Epoch: 15, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.571 Vali Acc: 0.522 Test Loss: 1.571 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.097810745239258
Epoch: 16, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.632 Vali Acc: 0.539 Test Loss: 1.632 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2715892791748047
Epoch: 17, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.760 Vali Acc: 0.450 Test Loss: 1.760 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9579601287841797
Epoch: 18, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.853 Vali Acc: 0.467 Test Loss: 1.853 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0955801010131836
Epoch: 19, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.869 Vali Acc: 0.500 Test Loss: 1.869 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8630435466766357
Epoch: 20, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.977 Vali Acc: 0.478 Test Loss: 1.977 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 100226
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8064653873443604
Epoch: 1, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.706 Vali Acc: 0.544 Test Loss: 0.706 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.0069036483764648
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.679 Vali Acc: 0.617 Test Loss: 0.679 Test Acc: 0.617
Validation loss decreased (-0.544437 --> -0.616660).  Saving model ...
Epoch: 3 cost time: 1.1777923107147217
Epoch: 3, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.666 Vali Acc: 0.561 Test Loss: 0.666 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1778113842010498
Epoch: 4, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.712 Vali Acc: 0.544 Test Loss: 0.712 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.22468900680542
Epoch: 5, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.725 Vali Acc: 0.517 Test Loss: 0.725 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2819645404815674
Epoch: 6, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.783 Vali Acc: 0.522 Test Loss: 0.783 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.091325283050537
Epoch: 7, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.813 Vali Acc: 0.494 Test Loss: 0.813 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.325249433517456
Epoch: 8, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.865 Vali Acc: 0.544 Test Loss: 0.865 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1965341567993164
Epoch: 9, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.885 Vali Acc: 0.511 Test Loss: 0.885 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2252600193023682
Epoch: 10, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.054 Vali Acc: 0.511 Test Loss: 1.054 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2483808994293213
Epoch: 11, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.988 Vali Acc: 0.511 Test Loss: 0.988 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1383578777313232
Epoch: 12, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.109 Vali Acc: 0.539 Test Loss: 1.109 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6166666666666667
model parameter : 98498
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0634000301361084
Epoch: 1, Steps: 13 | Train Loss: 0.802 Vali Loss: 0.733 Vali Acc: 0.472 Test Loss: 0.733 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 0.9942433834075928
Epoch: 2, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.741 Vali Acc: 0.533 Test Loss: 0.741 Test Acc: 0.533
Validation loss decreased (-0.472215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.1770548820495605
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.741 Vali Acc: 0.511 Test Loss: 0.741 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.207702398300171
Epoch: 4, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.760 Vali Acc: 0.506 Test Loss: 0.760 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3777410984039307
Epoch: 5, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.799 Vali Acc: 0.506 Test Loss: 0.799 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1323611736297607
Epoch: 6, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.832 Vali Acc: 0.494 Test Loss: 0.832 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1642351150512695
Epoch: 7, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.873 Vali Acc: 0.478 Test Loss: 0.873 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3086473941802979
Epoch: 8, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.939 Vali Acc: 0.511 Test Loss: 0.939 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1562068462371826
Epoch: 9, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.965 Vali Acc: 0.478 Test Loss: 0.965 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2978909015655518
Epoch: 10, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.025 Vali Acc: 0.478 Test Loss: 1.025 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1993234157562256
Epoch: 11, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3456952571868896
Epoch: 12, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.133 Vali Acc: 0.472 Test Loss: 1.133 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 98626
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5606329441070557
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.733 Vali Acc: 0.472 Test Loss: 0.733 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 0.9952845573425293
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.728 Vali Acc: 0.511 Test Loss: 0.728 Test Acc: 0.511
Validation loss decreased (-0.472215 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 0.9584522247314453
Epoch: 3, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.730 Vali Acc: 0.489 Test Loss: 0.730 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.960456371307373
Epoch: 4, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.747 Vali Acc: 0.494 Test Loss: 0.747 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0134189128875732
Epoch: 5, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.771 Vali Acc: 0.494 Test Loss: 0.771 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0849609375
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.796 Vali Acc: 0.461 Test Loss: 0.796 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.056894302368164
Epoch: 7, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9901652336120605
Epoch: 8, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1307528018951416
Epoch: 9, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.910 Vali Acc: 0.494 Test Loss: 0.910 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2286336421966553
Epoch: 10, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.958 Vali Acc: 0.489 Test Loss: 0.958 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0467925071716309
Epoch: 11, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.986 Vali Acc: 0.494 Test Loss: 0.986 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2459862232208252
Epoch: 12, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.047 Vali Acc: 0.489 Test Loss: 1.047 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm64_nh16_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 101378
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.887434244155884
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.834 Vali Acc: 0.506 Test Loss: 0.834 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 1.416917085647583
Epoch: 2, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.913 Vali Acc: 0.483 Test Loss: 0.913 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2406597137451172
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.799 Vali Acc: 0.444 Test Loss: 0.799 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4926011562347412
Epoch: 4, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.897 Vali Acc: 0.456 Test Loss: 0.897 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.362687587738037
Epoch: 5, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.954 Vali Acc: 0.461 Test Loss: 0.954 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.620344638824463
Epoch: 6, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.449411392211914
Epoch: 7, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.201 Vali Acc: 0.483 Test Loss: 1.201 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6960995197296143
Epoch: 8, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.296 Vali Acc: 0.494 Test Loss: 1.296 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.408686876296997
Epoch: 9, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.416 Vali Acc: 0.478 Test Loss: 1.416 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5814697742462158
Epoch: 10, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.588 Vali Acc: 0.467 Test Loss: 1.588 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4292948246002197
Epoch: 11, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.718 Vali Acc: 0.483 Test Loss: 1.718 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 98114
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6727185249328613
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.747 Vali Acc: 0.494 Test Loss: 0.747 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 2.013038158416748
Epoch: 2, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.757 Vali Acc: 0.517 Test Loss: 0.757 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.6991748809814453
Epoch: 3, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.758 Vali Acc: 0.522 Test Loss: 0.758 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.7315073013305664
Epoch: 4, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.784 Vali Acc: 0.472 Test Loss: 0.784 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7368063926696777
Epoch: 5, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.844 Vali Acc: 0.522 Test Loss: 0.844 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7392456531524658
Epoch: 6, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.861 Vali Acc: 0.472 Test Loss: 0.861 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.994150161743164
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.899 Vali Acc: 0.467 Test Loss: 0.899 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5193183422088623
Epoch: 8, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.969 Vali Acc: 0.461 Test Loss: 0.969 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4697537422180176
Epoch: 9, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.056 Vali Acc: 0.461 Test Loss: 1.056 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2336535453796387
Epoch: 10, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.109 Vali Acc: 0.461 Test Loss: 1.109 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3838844299316406
Epoch: 11, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.210 Vali Acc: 0.472 Test Loss: 1.210 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.577867031097412
Epoch: 12, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.307 Vali Acc: 0.483 Test Loss: 1.307 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3834598064422607
Epoch: 13, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.368 Vali Acc: 0.450 Test Loss: 1.368 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 82466
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.69518780708313
Epoch: 1, Steps: 13 | Train Loss: 0.804 Vali Loss: 0.739 Vali Acc: 0.450 Test Loss: 0.739 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.2283008098602295
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.717 Vali Acc: 0.506 Test Loss: 0.717 Test Acc: 0.506
Validation loss decreased (-0.449993 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.1235902309417725
Epoch: 3, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.719 Vali Acc: 0.467 Test Loss: 0.719 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1174390316009521
Epoch: 4, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3463525772094727
Epoch: 5, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.752 Vali Acc: 0.522 Test Loss: 0.752 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 6 cost time: 1.2888705730438232
Epoch: 6, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.775 Vali Acc: 0.517 Test Loss: 0.775 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.323225736618042
Epoch: 7, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.812 Vali Acc: 0.517 Test Loss: 0.812 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.302546501159668
Epoch: 8, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.909 Vali Acc: 0.522 Test Loss: 0.909 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3911547660827637
Epoch: 9, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.905 Vali Acc: 0.489 Test Loss: 0.905 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2479712963104248
Epoch: 10, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.976 Vali Acc: 0.544 Test Loss: 0.976 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544435).  Saving model ...
Epoch: 11 cost time: 1.4220004081726074
Epoch: 11, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.043 Vali Acc: 0.556 Test Loss: 1.043 Test Acc: 0.556
Validation loss decreased (-0.544435 --> -0.555545).  Saving model ...
Epoch: 12 cost time: 1.3723888397216797
Epoch: 12, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.354036569595337
Epoch: 13, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.220369577407837
Epoch: 14, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.182 Vali Acc: 0.506 Test Loss: 1.182 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2427153587341309
Epoch: 15, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.228 Vali Acc: 0.494 Test Loss: 1.228 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.248250961303711
Epoch: 16, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.263 Vali Acc: 0.511 Test Loss: 1.263 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2107527256011963
Epoch: 17, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.354 Vali Acc: 0.517 Test Loss: 1.354 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2454102039337158
Epoch: 18, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.416 Vali Acc: 0.494 Test Loss: 1.416 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1585168838500977
Epoch: 19, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.493 Vali Acc: 0.528 Test Loss: 1.493 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.25315260887146
Epoch: 20, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.519 Vali Acc: 0.472 Test Loss: 1.519 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.290834903717041
Epoch: 21, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.597 Vali Acc: 0.500 Test Loss: 1.597 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 77570
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8502588272094727
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.740 Vali Acc: 0.489 Test Loss: 0.740 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.2372498512268066
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.740 Vali Acc: 0.517 Test Loss: 0.740 Test Acc: 0.517
Validation loss decreased (-0.488881 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.2275495529174805
Epoch: 3, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.747 Vali Acc: 0.511 Test Loss: 0.747 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2683839797973633
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.749 Vali Acc: 0.478 Test Loss: 0.749 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2941694259643555
Epoch: 5, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.766 Vali Acc: 0.478 Test Loss: 0.766 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2465312480926514
Epoch: 6, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.785 Vali Acc: 0.506 Test Loss: 0.785 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.13356351852417
Epoch: 7, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3106920719146729
Epoch: 8, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.846 Vali Acc: 0.494 Test Loss: 0.846 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2638580799102783
Epoch: 9, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.913 Vali Acc: 0.500 Test Loss: 0.913 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2443311214447021
Epoch: 10, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.908 Vali Acc: 0.511 Test Loss: 0.908 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2183129787445068
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.956 Vali Acc: 0.517 Test Loss: 0.956 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.300342082977295
Epoch: 12, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.988 Vali Acc: 0.522 Test Loss: 0.988 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522212).  Saving model ...
Epoch: 13 cost time: 1.1602246761322021
Epoch: 13, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.036 Vali Acc: 0.500 Test Loss: 1.036 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.152916669845581
Epoch: 14, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.080 Vali Acc: 0.517 Test Loss: 1.080 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2597503662109375
Epoch: 15, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.137 Vali Acc: 0.494 Test Loss: 1.137 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2346019744873047
Epoch: 16, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.194 Vali Acc: 0.511 Test Loss: 1.194 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2485275268554688
Epoch: 17, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.228 Vali Acc: 0.483 Test Loss: 1.228 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.257059097290039
Epoch: 18, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.275 Vali Acc: 0.489 Test Loss: 1.275 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2328977584838867
Epoch: 19, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.323 Vali Acc: 0.450 Test Loss: 1.323 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1170687675476074
Epoch: 20, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.343 Vali Acc: 0.478 Test Loss: 1.343 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2750799655914307
Epoch: 21, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.403 Vali Acc: 0.472 Test Loss: 1.403 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2424874305725098
Epoch: 22, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.428 Vali Acc: 0.467 Test Loss: 1.428 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 75362
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0523300170898438
Epoch: 1, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.741 Vali Acc: 0.472 Test Loss: 0.741 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.1897521018981934
Epoch: 2, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
Validation loss decreased (-0.472215 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.2860703468322754
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.1395320892333984
Epoch: 4, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.751 Vali Acc: 0.489 Test Loss: 0.751 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1540110111236572
Epoch: 5, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.736 Vali Acc: 0.506 Test Loss: 0.736 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.184781551361084
Epoch: 6, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.749 Vali Acc: 0.517 Test Loss: 0.749 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 7 cost time: 1.0222084522247314
Epoch: 7, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.765 Vali Acc: 0.522 Test Loss: 0.765 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522215).  Saving model ...
Epoch: 8 cost time: 1.1682357788085938
Epoch: 8, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.811 Vali Acc: 0.528 Test Loss: 0.811 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527770).  Saving model ...
Epoch: 9 cost time: 1.0612854957580566
Epoch: 9, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.837 Vali Acc: 0.561 Test Loss: 0.837 Test Acc: 0.561
Validation loss decreased (-0.527770 --> -0.561103).  Saving model ...
Epoch: 10 cost time: 1.182802438735962
Epoch: 10, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.891 Vali Acc: 0.528 Test Loss: 0.891 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0718483924865723
Epoch: 11, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.910 Vali Acc: 0.511 Test Loss: 0.910 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.149735689163208
Epoch: 12, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.960 Vali Acc: 0.517 Test Loss: 0.960 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.201256275177002
Epoch: 13, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.968 Vali Acc: 0.528 Test Loss: 0.968 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1812152862548828
Epoch: 14, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.040 Vali Acc: 0.517 Test Loss: 1.040 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1027984619140625
Epoch: 15, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.040 Vali Acc: 0.506 Test Loss: 1.040 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1598172187805176
Epoch: 16, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.094 Vali Acc: 0.517 Test Loss: 1.094 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1712110042572021
Epoch: 17, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.164 Vali Acc: 0.528 Test Loss: 1.164 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0197017192840576
Epoch: 18, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.157 Vali Acc: 0.506 Test Loss: 1.157 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1647984981536865
Epoch: 19, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.217 Vali Acc: 0.494 Test Loss: 1.217 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 74498
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0818543434143066
Epoch: 1, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.722 Vali Acc: 0.506 Test Loss: 0.722 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3881778717041016
Epoch: 2, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.720 Vali Acc: 0.522 Test Loss: 0.720 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.228384017944336
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1664345264434814
Epoch: 4, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.724 Vali Acc: 0.494 Test Loss: 0.724 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3363609313964844
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.738 Vali Acc: 0.472 Test Loss: 0.738 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3532466888427734
Epoch: 6, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.758 Vali Acc: 0.494 Test Loss: 0.758 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.348334550857544
Epoch: 7, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.764 Vali Acc: 0.444 Test Loss: 0.764 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1850318908691406
Epoch: 8, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.799 Vali Acc: 0.467 Test Loss: 0.799 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3557300567626953
Epoch: 9, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.828 Vali Acc: 0.489 Test Loss: 0.828 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3932595252990723
Epoch: 10, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.877 Vali Acc: 0.489 Test Loss: 0.877 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4144959449768066
Epoch: 11, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4773263931274414
Epoch: 12, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.944 Vali Acc: 0.489 Test Loss: 0.944 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 74562
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.023916006088257
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.704 Vali Acc: 0.539 Test Loss: 0.704 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.3509159088134766
Epoch: 2, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.709 Vali Acc: 0.561 Test Loss: 0.709 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 1.1474499702453613
Epoch: 3, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.712 Vali Acc: 0.572 Test Loss: 0.712 Test Acc: 0.572
Validation loss decreased (-0.561104 --> -0.572215).  Saving model ...
Epoch: 4 cost time: 1.4366786479949951
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.719 Vali Acc: 0.528 Test Loss: 0.719 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3860313892364502
Epoch: 5, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.722 Vali Acc: 0.533 Test Loss: 0.722 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4699327945709229
Epoch: 6, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.752 Vali Acc: 0.522 Test Loss: 0.752 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4321675300598145
Epoch: 7, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.768 Vali Acc: 0.506 Test Loss: 0.768 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2899458408355713
Epoch: 8, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.799 Vali Acc: 0.517 Test Loss: 0.799 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4008007049560547
Epoch: 9, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.821 Vali Acc: 0.533 Test Loss: 0.821 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3653392791748047
Epoch: 10, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.841 Vali Acc: 0.517 Test Loss: 0.841 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3379600048065186
Epoch: 11, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3837275505065918
Epoch: 12, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.870 Vali Acc: 0.511 Test Loss: 0.870 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3881618976593018
Epoch: 13, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.905 Vali Acc: 0.511 Test Loss: 0.905 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 75938
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.42364501953125
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.783 Vali Acc: 0.494 Test Loss: 0.783 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.713538408279419
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.697 Vali Acc: 0.517 Test Loss: 0.697 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 1.6636450290679932
Epoch: 3, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.783 Vali Acc: 0.489 Test Loss: 0.783 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7257142066955566
Epoch: 4, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.864 Vali Acc: 0.522 Test Loss: 0.864 Test Acc: 0.522
Validation loss decreased (-0.516660 --> -0.522214).  Saving model ...
Epoch: 5 cost time: 1.761122226715088
Epoch: 5, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.887 Vali Acc: 0.483 Test Loss: 0.887 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8088641166687012
Epoch: 6, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.818535566329956
Epoch: 7, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.149 Vali Acc: 0.478 Test Loss: 1.149 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.950742244720459
Epoch: 8, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.132 Vali Acc: 0.489 Test Loss: 1.132 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.03511381149292
Epoch: 9, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.331 Vali Acc: 0.467 Test Loss: 1.331 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9690454006195068
Epoch: 10, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.345 Vali Acc: 0.489 Test Loss: 1.345 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9540843963623047
Epoch: 11, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.455 Vali Acc: 0.461 Test Loss: 1.455 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9497172832489014
Epoch: 12, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.606 Vali Acc: 0.467 Test Loss: 1.606 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9361965656280518
Epoch: 13, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.705 Vali Acc: 0.489 Test Loss: 1.705 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8087224960327148
Epoch: 14, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.961 Vali Acc: 0.483 Test Loss: 1.961 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 73154
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.237718105316162
Epoch: 1, Steps: 13 | Train Loss: 0.802 Vali Loss: 0.758 Vali Acc: 0.472 Test Loss: 0.758 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 3.1383421421051025
Epoch: 2, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
Validation loss decreased (-0.472215 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.2552826404571533
Epoch: 3, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.768 Vali Acc: 0.511 Test Loss: 0.768 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511103).  Saving model ...
Epoch: 4 cost time: 3.22420072555542
Epoch: 4, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.794 Vali Acc: 0.456 Test Loss: 0.794 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.859621047973633
Epoch: 5, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.831 Vali Acc: 0.461 Test Loss: 0.831 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.259270668029785
Epoch: 6, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.885 Vali Acc: 0.483 Test Loss: 0.885 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.228821277618408
Epoch: 7, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.926 Vali Acc: 0.500 Test Loss: 0.926 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3396520614624023
Epoch: 8, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.997 Vali Acc: 0.483 Test Loss: 0.997 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1464874744415283
Epoch: 9, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.060 Vali Acc: 0.483 Test Loss: 1.060 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1753833293914795
Epoch: 10, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.4096477031707764
Epoch: 11, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.159 Vali Acc: 0.511 Test Loss: 1.159 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.330260753631592
Epoch: 12, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.1714720726013184
Epoch: 13, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.312 Vali Acc: 0.467 Test Loss: 1.312 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 57506
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9586880207061768
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.776 Vali Acc: 0.506 Test Loss: 0.776 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.2214014530181885
Epoch: 2, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.743 Vali Acc: 0.539 Test Loss: 0.743 Test Acc: 0.539
Validation loss decreased (-0.505548 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 1.2860829830169678
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.727 Vali Acc: 0.456 Test Loss: 0.727 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2142624855041504
Epoch: 4, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.748 Vali Acc: 0.522 Test Loss: 0.748 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4299111366271973
Epoch: 5, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.781 Vali Acc: 0.472 Test Loss: 0.781 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.423292636871338
Epoch: 6, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.810 Vali Acc: 0.494 Test Loss: 0.810 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5264577865600586
Epoch: 7, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.873 Vali Acc: 0.472 Test Loss: 0.873 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4072482585906982
Epoch: 8, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.902 Vali Acc: 0.511 Test Loss: 0.902 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.631026029586792
Epoch: 9, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.948 Vali Acc: 0.483 Test Loss: 0.948 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5915725231170654
Epoch: 10, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.019 Vali Acc: 0.483 Test Loss: 1.019 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5864317417144775
Epoch: 11, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.073 Vali Acc: 0.506 Test Loss: 1.073 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5066523551940918
Epoch: 12, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.111 Vali Acc: 0.483 Test Loss: 1.111 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 52610
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.226720094680786
Epoch: 1, Steps: 13 | Train Loss: 0.844 Vali Loss: 0.738 Vali Acc: 0.472 Test Loss: 0.738 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.2098147869110107
Epoch: 2, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.712 Vali Acc: 0.506 Test Loss: 0.712 Test Acc: 0.506
Validation loss decreased (-0.472215 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.5318405628204346
Epoch: 3, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.714 Vali Acc: 0.533 Test Loss: 0.714 Test Acc: 0.533
Validation loss decreased (-0.505548 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.6143970489501953
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1877179145812988
Epoch: 5, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4269487857818604
Epoch: 6, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.799 Vali Acc: 0.483 Test Loss: 0.799 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4692022800445557
Epoch: 7, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.802 Vali Acc: 0.522 Test Loss: 0.802 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5278503894805908
Epoch: 8, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.850 Vali Acc: 0.517 Test Loss: 0.850 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3986728191375732
Epoch: 9, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.872 Vali Acc: 0.511 Test Loss: 0.872 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4316837787628174
Epoch: 10, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.926 Vali Acc: 0.494 Test Loss: 0.926 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3903510570526123
Epoch: 11, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.964 Vali Acc: 0.511 Test Loss: 0.964 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3498539924621582
Epoch: 12, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.042 Vali Acc: 0.494 Test Loss: 1.042 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5013775825500488
Epoch: 13, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.068 Vali Acc: 0.494 Test Loss: 1.068 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 50402
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.225947618484497
Epoch: 1, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.3255269527435303
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4931323528289795
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.721 Vali Acc: 0.506 Test Loss: 0.721 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5009942054748535
Epoch: 4, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.730 Vali Acc: 0.461 Test Loss: 0.730 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.425605058670044
Epoch: 5, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.737 Vali Acc: 0.489 Test Loss: 0.737 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.461482048034668
Epoch: 6, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.749 Vali Acc: 0.483 Test Loss: 0.749 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4707789421081543
Epoch: 7, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.772 Vali Acc: 0.483 Test Loss: 0.772 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4895415306091309
Epoch: 8, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.786 Vali Acc: 0.494 Test Loss: 0.786 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.21856689453125
Epoch: 9, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.826 Vali Acc: 0.483 Test Loss: 0.826 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3748507499694824
Epoch: 10, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.821 Vali Acc: 0.483 Test Loss: 0.821 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2816762924194336
Epoch: 11, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.841 Vali Acc: 0.511 Test Loss: 0.841 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 49538
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2582814693450928
Epoch: 1, Steps: 13 | Train Loss: 0.827 Vali Loss: 0.775 Vali Acc: 0.467 Test Loss: 0.775 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.3792738914489746
Epoch: 2, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.757 Vali Acc: 0.444 Test Loss: 0.757 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4964051246643066
Epoch: 3, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.751 Vali Acc: 0.456 Test Loss: 0.751 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3320107460021973
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.759 Vali Acc: 0.489 Test Loss: 0.759 Test Acc: 0.489
Validation loss decreased (-0.466659 --> -0.488881).  Saving model ...
Epoch: 5 cost time: 1.3812150955200195
Epoch: 5, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.764 Vali Acc: 0.489 Test Loss: 0.764 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.537644624710083
Epoch: 6, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.786 Vali Acc: 0.506 Test Loss: 0.786 Test Acc: 0.506
Validation loss decreased (-0.488881 --> -0.505548).  Saving model ...
Epoch: 7 cost time: 1.4225969314575195
Epoch: 7, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.797 Vali Acc: 0.478 Test Loss: 0.797 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4512693881988525
Epoch: 8, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.832 Vali Acc: 0.472 Test Loss: 0.832 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3825616836547852
Epoch: 9, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.847 Vali Acc: 0.483 Test Loss: 0.847 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3768060207366943
Epoch: 10, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.893 Vali Acc: 0.478 Test Loss: 0.893 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.446376085281372
Epoch: 11, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.924 Vali Acc: 0.494 Test Loss: 0.924 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4031529426574707
Epoch: 12, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.956 Vali Acc: 0.478 Test Loss: 0.956 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4347577095031738
Epoch: 13, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.983 Vali Acc: 0.483 Test Loss: 0.983 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4155151844024658
Epoch: 14, Steps: 13 | Train Loss: 0.377 Vali Loss: 1.021 Vali Acc: 0.511 Test Loss: 1.021 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511101).  Saving model ...
Epoch: 15 cost time: 1.1762149333953857
Epoch: 15, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.060 Vali Acc: 0.522 Test Loss: 1.060 Test Acc: 0.522
Validation loss decreased (-0.511101 --> -0.522212).  Saving model ...
Epoch: 16 cost time: 1.4362800121307373
Epoch: 16, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.072 Vali Acc: 0.494 Test Loss: 1.072 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3861043453216553
Epoch: 17, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.127 Vali Acc: 0.506 Test Loss: 1.127 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1754329204559326
Epoch: 18, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.167 Vali Acc: 0.489 Test Loss: 1.167 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.429572582244873
Epoch: 19, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.217 Vali Acc: 0.489 Test Loss: 1.217 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3904168605804443
Epoch: 20, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.222 Vali Acc: 0.511 Test Loss: 1.222 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6194729804992676
Epoch: 21, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.275 Vali Acc: 0.489 Test Loss: 1.275 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4421789646148682
Epoch: 22, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.335 Vali Acc: 0.494 Test Loss: 1.335 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2834880352020264
Epoch: 23, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.321 Vali Acc: 0.478 Test Loss: 1.321 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4875140190124512
Epoch: 24, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.353 Vali Acc: 0.483 Test Loss: 1.353 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3875041007995605
Epoch: 25, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.392 Vali Acc: 0.506 Test Loss: 1.392 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 49602
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.145890712738037
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.766 Vali Acc: 0.439 Test Loss: 0.766 Test Acc: 0.439
Validation loss decreased (inf --> -0.438881).  Saving model ...
Epoch: 2 cost time: 1.2677252292633057
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.748 Vali Acc: 0.494 Test Loss: 0.748 Test Acc: 0.494
Validation loss decreased (-0.438881 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.2390999794006348
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.751 Vali Acc: 0.511 Test Loss: 0.751 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.156609058380127
Epoch: 4, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.759 Vali Acc: 0.472 Test Loss: 0.759 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2469213008880615
Epoch: 5, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2041032314300537
Epoch: 6, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.759 Vali Acc: 0.494 Test Loss: 0.759 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3241219520568848
Epoch: 7, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.793 Vali Acc: 0.494 Test Loss: 0.793 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.361513376235962
Epoch: 8, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.812 Vali Acc: 0.506 Test Loss: 0.812 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1493685245513916
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.830 Vali Acc: 0.500 Test Loss: 0.830 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.484057903289795
Epoch: 10, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.845 Vali Acc: 0.478 Test Loss: 0.845 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4457294940948486
Epoch: 11, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.878 Vali Acc: 0.506 Test Loss: 0.878 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3156592845916748
Epoch: 12, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.883 Vali Acc: 0.506 Test Loss: 0.883 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.417144775390625
Epoch: 13, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.921 Vali Acc: 0.511 Test Loss: 0.921 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 50978
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.569315433502197
Epoch: 1, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.609356641769409
Epoch: 2, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.770 Vali Acc: 0.544 Test Loss: 0.770 Test Acc: 0.544
Validation loss decreased (-0.499993 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 2.8277018070220947
Epoch: 3, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.816 Vali Acc: 0.511 Test Loss: 0.816 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7048563957214355
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.884 Vali Acc: 0.506 Test Loss: 0.884 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.988037109375
Epoch: 5, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.915 Vali Acc: 0.461 Test Loss: 0.915 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9209511280059814
Epoch: 6, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.999 Vali Acc: 0.461 Test Loss: 0.999 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6534886360168457
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.183 Vali Acc: 0.483 Test Loss: 1.183 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2103047370910645
Epoch: 8, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.240 Vali Acc: 0.489 Test Loss: 1.240 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0191967487335205
Epoch: 9, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.324 Vali Acc: 0.444 Test Loss: 1.324 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.262972593307495
Epoch: 10, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.480 Vali Acc: 0.478 Test Loss: 1.480 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3021883964538574
Epoch: 11, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.504 Vali Acc: 0.489 Test Loss: 1.504 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.941082715988159
Epoch: 12, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.646 Vali Acc: 0.472 Test Loss: 1.646 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 60674
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.135623216629028
Epoch: 1, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.728 Vali Acc: 0.511 Test Loss: 0.728 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 2.928504467010498
Epoch: 2, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.606898307800293
Epoch: 3, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.760 Vali Acc: 0.528 Test Loss: 0.760 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 3.1110639572143555
Epoch: 4, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.791 Vali Acc: 0.489 Test Loss: 0.791 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5564587116241455
Epoch: 5, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.818 Vali Acc: 0.472 Test Loss: 0.818 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.860156536102295
Epoch: 6, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.851 Vali Acc: 0.461 Test Loss: 0.851 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6973800659179688
Epoch: 7, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.920 Vali Acc: 0.478 Test Loss: 0.920 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6763784885406494
Epoch: 8, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.964 Vali Acc: 0.461 Test Loss: 0.964 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7142932415008545
Epoch: 9, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.053 Vali Acc: 0.444 Test Loss: 1.053 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.688152551651001
Epoch: 10, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7590315341949463
Epoch: 11, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.214 Vali Acc: 0.494 Test Loss: 1.214 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7314324378967285
Epoch: 12, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.255 Vali Acc: 0.461 Test Loss: 1.255 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6779122352600098
Epoch: 13, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.325 Vali Acc: 0.461 Test Loss: 1.325 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 45026
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.005859375
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.719 Vali Acc: 0.506 Test Loss: 0.719 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3777499198913574
Epoch: 2, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (-0.505548 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.3497469425201416
Epoch: 3, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5116300582885742
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2873961925506592
Epoch: 5, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.759 Vali Acc: 0.533 Test Loss: 0.759 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5242211818695068
Epoch: 6, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.804 Vali Acc: 0.544 Test Loss: 0.804 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.438110113143921
Epoch: 7, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.804 Vali Acc: 0.533 Test Loss: 0.804 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5773184299468994
Epoch: 8, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.895 Vali Acc: 0.561 Test Loss: 0.895 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561102).  Saving model ...
Epoch: 9 cost time: 1.5090110301971436
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.903 Vali Acc: 0.533 Test Loss: 0.903 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4243316650390625
Epoch: 10, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.939 Vali Acc: 0.522 Test Loss: 0.939 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4019200801849365
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.993 Vali Acc: 0.528 Test Loss: 0.993 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4057104587554932
Epoch: 12, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.068 Vali Acc: 0.489 Test Loss: 1.068 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.339381456375122
Epoch: 13, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.147 Vali Acc: 0.539 Test Loss: 1.147 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4159917831420898
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.146 Vali Acc: 0.528 Test Loss: 1.146 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4595451354980469
Epoch: 15, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.273 Vali Acc: 0.517 Test Loss: 1.273 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3881821632385254
Epoch: 16, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.257 Vali Acc: 0.522 Test Loss: 1.257 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4073386192321777
Epoch: 17, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.320 Vali Acc: 0.522 Test Loss: 1.320 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2997303009033203
Epoch: 18, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.400 Vali Acc: 0.539 Test Loss: 1.400 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 40130
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8292176723480225
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.738 Vali Acc: 0.539 Test Loss: 0.738 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.069979190826416
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1396007537841797
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.744 Vali Acc: 0.506 Test Loss: 0.744 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1344664096832275
Epoch: 4, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.758 Vali Acc: 0.511 Test Loss: 0.758 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2187366485595703
Epoch: 5, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.772 Vali Acc: 0.506 Test Loss: 0.772 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.300766944885254
Epoch: 6, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.802 Vali Acc: 0.511 Test Loss: 0.802 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.214860200881958
Epoch: 7, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3307652473449707
Epoch: 8, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.868 Vali Acc: 0.500 Test Loss: 0.868 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3373048305511475
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.927 Vali Acc: 0.511 Test Loss: 0.927 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2816507816314697
Epoch: 10, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.968 Vali Acc: 0.483 Test Loss: 0.968 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3207199573516846
Epoch: 11, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.005 Vali Acc: 0.506 Test Loss: 1.005 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 37922
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7614264488220215
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.744 Vali Acc: 0.483 Test Loss: 0.744 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.271704912185669
Epoch: 2, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.749 Vali Acc: 0.461 Test Loss: 0.749 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1071338653564453
Epoch: 3, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.738 Vali Acc: 0.489 Test Loss: 0.738 Test Acc: 0.489
Validation loss decreased (-0.483326 --> -0.488882).  Saving model ...
Epoch: 4 cost time: 1.3923418521881104
Epoch: 4, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.735 Vali Acc: 0.506 Test Loss: 0.735 Test Acc: 0.506
Validation loss decreased (-0.488882 --> -0.505548).  Saving model ...
Epoch: 5 cost time: 1.2110676765441895
Epoch: 5, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.754 Vali Acc: 0.511 Test Loss: 0.754 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511104).  Saving model ...
Epoch: 6 cost time: 1.3571257591247559
Epoch: 6, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.767 Vali Acc: 0.511 Test Loss: 0.767 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.233199119567871
Epoch: 7, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.784 Vali Acc: 0.522 Test Loss: 0.784 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522214).  Saving model ...
Epoch: 8 cost time: 1.3165578842163086
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.829 Vali Acc: 0.517 Test Loss: 0.829 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2085185050964355
Epoch: 9, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.833 Vali Acc: 0.517 Test Loss: 0.833 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3585841655731201
Epoch: 10, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.875 Vali Acc: 0.511 Test Loss: 0.875 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2052686214447021
Epoch: 11, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.903 Vali Acc: 0.517 Test Loss: 0.903 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1203882694244385
Epoch: 12, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.926 Vali Acc: 0.522 Test Loss: 0.926 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0716636180877686
Epoch: 13, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.954 Vali Acc: 0.533 Test Loss: 0.954 Test Acc: 0.533
Validation loss decreased (-0.522214 --> -0.533324).  Saving model ...
Epoch: 14 cost time: 1.2491543292999268
Epoch: 14, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.975 Vali Acc: 0.511 Test Loss: 0.975 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1062633991241455
Epoch: 15, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.010 Vali Acc: 0.511 Test Loss: 1.010 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1421220302581787
Epoch: 16, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.063 Vali Acc: 0.528 Test Loss: 1.063 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.090843915939331
Epoch: 17, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.072 Vali Acc: 0.517 Test Loss: 1.072 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1031546592712402
Epoch: 18, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.126 Vali Acc: 0.539 Test Loss: 1.126 Test Acc: 0.539
Validation loss decreased (-0.533324 --> -0.538878).  Saving model ...
Epoch: 19 cost time: 1.1263821125030518
Epoch: 19, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.139559268951416
Epoch: 20, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.188 Vali Acc: 0.544 Test Loss: 1.188 Test Acc: 0.544
Validation loss decreased (-0.538878 --> -0.544433).  Saving model ...
Epoch: 21 cost time: 1.1860506534576416
Epoch: 21, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.251 Vali Acc: 0.511 Test Loss: 1.251 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2763187885284424
Epoch: 22, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.282 Vali Acc: 0.533 Test Loss: 1.282 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.287316083908081
Epoch: 23, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.318 Vali Acc: 0.522 Test Loss: 1.318 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2414958477020264
Epoch: 24, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.378 Vali Acc: 0.489 Test Loss: 1.378 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4462337493896484
Epoch: 25, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.404 Vali Acc: 0.478 Test Loss: 1.404 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2349963188171387
Epoch: 26, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.514 Vali Acc: 0.489 Test Loss: 1.514 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2791025638580322
Epoch: 27, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.506 Vali Acc: 0.478 Test Loss: 1.506 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1975817680358887
Epoch: 28, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.549 Vali Acc: 0.483 Test Loss: 1.549 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4039878845214844
Epoch: 29, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.626 Vali Acc: 0.500 Test Loss: 1.626 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2486324310302734
Epoch: 30, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.648 Vali Acc: 0.489 Test Loss: 1.648 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 37058
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.98382830619812
Epoch: 1, Steps: 13 | Train Loss: 0.798 Vali Loss: 0.706 Vali Acc: 0.467 Test Loss: 0.706 Test Acc: 0.467
Validation loss decreased (inf --> -0.466660).  Saving model ...
Epoch: 2 cost time: 1.1305315494537354
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.701 Vali Acc: 0.533 Test Loss: 0.701 Test Acc: 0.533
Validation loss decreased (-0.466660 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.2839665412902832
Epoch: 3, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.703 Vali Acc: 0.511 Test Loss: 0.703 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.230466365814209
Epoch: 4, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.698 Vali Acc: 0.533 Test Loss: 0.698 Test Acc: 0.533
Validation loss decreased (-0.533326 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 1.3346526622772217
Epoch: 5, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.706 Vali Acc: 0.506 Test Loss: 0.706 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2082576751708984
Epoch: 6, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.722 Vali Acc: 0.506 Test Loss: 0.722 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2998161315917969
Epoch: 7, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.726 Vali Acc: 0.511 Test Loss: 0.726 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1240761280059814
Epoch: 8, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.752 Vali Acc: 0.494 Test Loss: 0.752 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2171399593353271
Epoch: 9, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.771 Vali Acc: 0.483 Test Loss: 0.771 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2273070812225342
Epoch: 10, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.793 Vali Acc: 0.517 Test Loss: 0.793 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3852028846740723
Epoch: 11, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.805 Vali Acc: 0.511 Test Loss: 0.805 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.233232021331787
Epoch: 12, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.845 Vali Acc: 0.483 Test Loss: 0.845 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.350541353225708
Epoch: 13, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.871 Vali Acc: 0.483 Test Loss: 0.871 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1992878913879395
Epoch: 14, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.921 Vali Acc: 0.478 Test Loss: 0.921 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 37122
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7622337341308594
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.826 Vali Acc: 0.461 Test Loss: 0.826 Test Acc: 0.461
Validation loss decreased (inf --> -0.461103).  Saving model ...
Epoch: 2 cost time: 1.2250914573669434
Epoch: 2, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.799 Vali Acc: 0.472 Test Loss: 0.799 Test Acc: 0.472
Validation loss decreased (-0.461103 --> -0.472214).  Saving model ...
Epoch: 3 cost time: 1.2959415912628174
Epoch: 3, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.765 Vali Acc: 0.467 Test Loss: 0.765 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0964829921722412
Epoch: 4, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.760 Vali Acc: 0.467 Test Loss: 0.760 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4439537525177002
Epoch: 5, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.774 Vali Acc: 0.506 Test Loss: 0.774 Test Acc: 0.506
Validation loss decreased (-0.472214 --> -0.505548).  Saving model ...
Epoch: 6 cost time: 1.2648828029632568
Epoch: 6, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.784 Vali Acc: 0.494 Test Loss: 0.784 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3010046482086182
Epoch: 7, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.799 Vali Acc: 0.522 Test Loss: 0.799 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522214).  Saving model ...
Epoch: 8 cost time: 1.1604728698730469
Epoch: 8, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.797 Vali Acc: 0.506 Test Loss: 0.797 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.336594820022583
Epoch: 9, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.819 Vali Acc: 0.511 Test Loss: 0.819 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1755712032318115
Epoch: 10, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.857 Vali Acc: 0.522 Test Loss: 0.857 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.380284070968628
Epoch: 11, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.867 Vali Acc: 0.506 Test Loss: 0.867 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.216318130493164
Epoch: 12, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.888 Vali Acc: 0.494 Test Loss: 0.888 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4104061126708984
Epoch: 13, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.917 Vali Acc: 0.472 Test Loss: 0.917 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.23543119430542
Epoch: 14, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.945 Vali Acc: 0.517 Test Loss: 0.945 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2253570556640625
Epoch: 15, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2657411098480225
Epoch: 16, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.988 Vali Acc: 0.517 Test Loss: 0.988 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1400294303894043
Epoch: 17, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.018 Vali Acc: 0.511 Test Loss: 1.018 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm32_nh4_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 38498
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.222546100616455
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.715 Vali Acc: 0.506 Test Loss: 0.715 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.4373979568481445
Epoch: 2, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.720 Vali Acc: 0.517 Test Loss: 0.720 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.5000896453857422
Epoch: 3, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.738 Vali Acc: 0.539 Test Loss: 0.738 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.3975427150726318
Epoch: 4, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.785 Vali Acc: 0.522 Test Loss: 0.785 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5692064762115479
Epoch: 5, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.800 Vali Acc: 0.522 Test Loss: 0.800 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7086985111236572
Epoch: 6, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.819 Vali Acc: 0.522 Test Loss: 0.819 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5857157707214355
Epoch: 7, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.898 Vali Acc: 0.483 Test Loss: 0.898 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6597182750701904
Epoch: 8, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.944 Vali Acc: 0.511 Test Loss: 0.944 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5531425476074219
Epoch: 9, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.197 Vali Acc: 0.494 Test Loss: 1.197 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4442963600158691
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.077 Vali Acc: 0.511 Test Loss: 1.077 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6515791416168213
Epoch: 11, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.131 Vali Acc: 0.461 Test Loss: 1.131 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6085619926452637
Epoch: 12, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.173 Vali Acc: 0.456 Test Loss: 1.173 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6008195877075195
Epoch: 13, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.315 Vali Acc: 0.478 Test Loss: 1.315 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 46370
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.004031181335449
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.748 Vali Acc: 0.522 Test Loss: 0.748 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.500542163848877
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.757 Vali Acc: 0.494 Test Loss: 0.757 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3621582984924316
Epoch: 3, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.766 Vali Acc: 0.506 Test Loss: 0.766 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4311981201171875
Epoch: 4, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.767 Vali Acc: 0.494 Test Loss: 0.767 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4804985523223877
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.786 Vali Acc: 0.478 Test Loss: 0.786 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3922114372253418
Epoch: 6, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.815 Vali Acc: 0.472 Test Loss: 0.815 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2305026054382324
Epoch: 7, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.858 Vali Acc: 0.483 Test Loss: 0.858 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5251407623291016
Epoch: 8, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.909 Vali Acc: 0.467 Test Loss: 0.909 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5041322708129883
Epoch: 9, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.923 Vali Acc: 0.483 Test Loss: 0.923 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5290989875793457
Epoch: 10, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4115922451019287
Epoch: 11, Steps: 13 | Train Loss: 0.438 Vali Loss: 1.034 Vali Acc: 0.461 Test Loss: 1.034 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 38546
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.173964023590088
Epoch: 1, Steps: 13 | Train Loss: 0.876 Vali Loss: 0.771 Vali Acc: 0.511 Test Loss: 0.771 Test Acc: 0.511
Validation loss decreased (inf --> -0.511103).  Saving model ...
Epoch: 2 cost time: 1.1230688095092773
Epoch: 2, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.741 Vali Acc: 0.478 Test Loss: 0.741 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1891751289367676
Epoch: 3, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.739 Vali Acc: 0.478 Test Loss: 0.739 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3891472816467285
Epoch: 4, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.744 Vali Acc: 0.528 Test Loss: 0.744 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527770).  Saving model ...
Epoch: 5 cost time: 1.3639967441558838
Epoch: 5, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.738 Vali Acc: 0.511 Test Loss: 0.738 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4043300151824951
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.745 Vali Acc: 0.489 Test Loss: 0.745 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2899587154388428
Epoch: 7, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.770 Vali Acc: 0.517 Test Loss: 0.770 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2044947147369385
Epoch: 8, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.780 Vali Acc: 0.506 Test Loss: 0.780 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.395439863204956
Epoch: 9, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.799 Vali Acc: 0.483 Test Loss: 0.799 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.354245662689209
Epoch: 10, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.823 Vali Acc: 0.506 Test Loss: 0.823 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2758445739746094
Epoch: 11, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.855 Vali Acc: 0.528 Test Loss: 0.855 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3414311408996582
Epoch: 12, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.862 Vali Acc: 0.522 Test Loss: 0.862 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1798009872436523
Epoch: 13, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.886 Vali Acc: 0.556 Test Loss: 0.886 Test Acc: 0.556
Validation loss decreased (-0.527770 --> -0.555547).  Saving model ...
Epoch: 14 cost time: 1.416844367980957
Epoch: 14, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.922 Vali Acc: 0.528 Test Loss: 0.922 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4322609901428223
Epoch: 15, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.969 Vali Acc: 0.511 Test Loss: 0.969 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3947534561157227
Epoch: 16, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.994 Vali Acc: 0.506 Test Loss: 0.994 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4448282718658447
Epoch: 17, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.031 Vali Acc: 0.506 Test Loss: 1.031 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3883030414581299
Epoch: 18, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.055 Vali Acc: 0.522 Test Loss: 1.055 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2193269729614258
Epoch: 19, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.057 Vali Acc: 0.528 Test Loss: 1.057 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.289447546005249
Epoch: 20, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3948614597320557
Epoch: 21, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3483343124389648
Epoch: 22, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3676764965057373
Epoch: 23, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.240 Vali Acc: 0.483 Test Loss: 1.240 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 36098
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9650235176086426
Epoch: 1, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.754 Vali Acc: 0.506 Test Loss: 0.754 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3235464096069336
Epoch: 2, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.758 Vali Acc: 0.539 Test Loss: 0.758 Test Acc: 0.539
Validation loss decreased (-0.505548 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 1.3674306869506836
Epoch: 3, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.757 Vali Acc: 0.517 Test Loss: 0.757 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4421501159667969
Epoch: 4, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.744 Vali Acc: 0.506 Test Loss: 0.744 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2880549430847168
Epoch: 5, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.746 Vali Acc: 0.494 Test Loss: 0.746 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4194622039794922
Epoch: 6, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.746 Vali Acc: 0.528 Test Loss: 0.746 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3837289810180664
Epoch: 7, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (-0.538881 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.383998155593872
Epoch: 8, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.773 Vali Acc: 0.528 Test Loss: 0.773 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9711003303527832
Epoch: 9, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.770 Vali Acc: 0.556 Test Loss: 0.770 Test Acc: 0.556
Validation loss decreased (-0.549992 --> -0.555548).  Saving model ...
Epoch: 10 cost time: 1.3005056381225586
Epoch: 10, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.793 Vali Acc: 0.561 Test Loss: 0.793 Test Acc: 0.561
Validation loss decreased (-0.555548 --> -0.561103).  Saving model ...
Epoch: 11 cost time: 1.359466791152954
Epoch: 11, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.818 Vali Acc: 0.528 Test Loss: 0.818 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.44753098487854
Epoch: 12, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.835 Vali Acc: 0.517 Test Loss: 0.835 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2524056434631348
Epoch: 13, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.862 Vali Acc: 0.517 Test Loss: 0.862 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1305618286132812
Epoch: 14, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.886 Vali Acc: 0.506 Test Loss: 0.886 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.278653621673584
Epoch: 15, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.917 Vali Acc: 0.511 Test Loss: 0.917 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3397812843322754
Epoch: 16, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.944 Vali Acc: 0.489 Test Loss: 0.944 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4051787853240967
Epoch: 17, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.975 Vali Acc: 0.506 Test Loss: 0.975 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3206167221069336
Epoch: 18, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.015 Vali Acc: 0.483 Test Loss: 1.015 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2133245468139648
Epoch: 19, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.056 Vali Acc: 0.511 Test Loss: 1.056 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3696577548980713
Epoch: 20, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.069 Vali Acc: 0.478 Test Loss: 1.069 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 34994
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.962064266204834
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.716 Vali Acc: 0.483 Test Loss: 0.716 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.2231006622314453
Epoch: 2, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.705 Vali Acc: 0.483 Test Loss: 0.705 Test Acc: 0.483
Validation loss decreased (-0.483326 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 1.0445406436920166
Epoch: 3, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.700 Vali Acc: 0.517 Test Loss: 0.700 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.316591739654541
Epoch: 4, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5555994510650635
Epoch: 5, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1963391304016113
Epoch: 6, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.702 Vali Acc: 0.539 Test Loss: 0.702 Test Acc: 0.539
Validation loss decreased (-0.516660 --> -0.538882).  Saving model ...
Epoch: 7 cost time: 1.1256260871887207
Epoch: 7, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.715 Vali Acc: 0.539 Test Loss: 0.715 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4439914226531982
Epoch: 8, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.726 Vali Acc: 0.539 Test Loss: 0.726 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2883200645446777
Epoch: 9, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.738 Vali Acc: 0.522 Test Loss: 0.738 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3077361583709717
Epoch: 10, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.747 Vali Acc: 0.511 Test Loss: 0.747 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3376023769378662
Epoch: 11, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.762 Vali Acc: 0.522 Test Loss: 0.762 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4309773445129395
Epoch: 12, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.774 Vali Acc: 0.539 Test Loss: 0.774 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2212989330291748
Epoch: 13, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.794 Vali Acc: 0.506 Test Loss: 0.794 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4457595348358154
Epoch: 14, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.808 Vali Acc: 0.522 Test Loss: 0.808 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.385162591934204
Epoch: 15, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.831 Vali Acc: 0.494 Test Loss: 0.831 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4251887798309326
Epoch: 16, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.846 Vali Acc: 0.506 Test Loss: 0.846 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 34562
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6717514991760254
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.745 Vali Acc: 0.511 Test Loss: 0.745 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.256676435470581
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.736 Vali Acc: 0.511 Test Loss: 0.736 Test Acc: 0.511
Validation loss decreased (-0.511104 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.3545129299163818
Epoch: 3, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.733 Vali Acc: 0.522 Test Loss: 0.733 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.319101095199585
Epoch: 4, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.733 Vali Acc: 0.522 Test Loss: 0.733 Test Acc: 0.522
Validation loss decreased (-0.522215 --> -0.522215).  Saving model ...
Epoch: 5 cost time: 1.1469471454620361
Epoch: 5, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.741 Vali Acc: 0.511 Test Loss: 0.741 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.352367639541626
Epoch: 6, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.324798583984375
Epoch: 7, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.752 Vali Acc: 0.506 Test Loss: 0.752 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.336348533630371
Epoch: 8, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.754 Vali Acc: 0.511 Test Loss: 0.754 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1431801319122314
Epoch: 9, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.766 Vali Acc: 0.517 Test Loss: 0.766 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3278439044952393
Epoch: 10, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4957079887390137
Epoch: 11, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.782 Vali Acc: 0.539 Test Loss: 0.782 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538881).  Saving model ...
Epoch: 12 cost time: 1.3308448791503906
Epoch: 12, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.790 Vali Acc: 0.533 Test Loss: 0.790 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4453468322753906
Epoch: 13, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.810 Vali Acc: 0.522 Test Loss: 0.810 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.350743293762207
Epoch: 14, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.824 Vali Acc: 0.506 Test Loss: 0.824 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4401941299438477
Epoch: 15, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.824 Vali Acc: 0.533 Test Loss: 0.824 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.366758108139038
Epoch: 16, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.848 Vali Acc: 0.489 Test Loss: 0.848 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3283140659332275
Epoch: 17, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.869 Vali Acc: 0.522 Test Loss: 0.869 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2873845100402832
Epoch: 18, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.894 Vali Acc: 0.528 Test Loss: 0.894 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.311220407485962
Epoch: 19, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.901 Vali Acc: 0.544 Test Loss: 0.901 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544435).  Saving model ...
Epoch: 20 cost time: 1.3891048431396484
Epoch: 20, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.903 Vali Acc: 0.511 Test Loss: 0.903 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4077510833740234
Epoch: 21, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.919 Vali Acc: 0.522 Test Loss: 0.919 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.158506155014038
Epoch: 22, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.934 Vali Acc: 0.533 Test Loss: 0.934 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3349311351776123
Epoch: 23, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.953 Vali Acc: 0.539 Test Loss: 0.953 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2022650241851807
Epoch: 24, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1129083633422852
Epoch: 25, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.999 Vali Acc: 0.539 Test Loss: 0.999 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1270489692687988
Epoch: 26, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.009 Vali Acc: 0.517 Test Loss: 1.009 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1265454292297363
Epoch: 27, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.057 Vali Acc: 0.517 Test Loss: 1.057 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.131927728652954
Epoch: 28, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.074 Vali Acc: 0.522 Test Loss: 1.074 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.106924295425415
Epoch: 29, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.054 Vali Acc: 0.522 Test Loss: 1.054 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 34594
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8790159225463867
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3899483680725098
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2603108882904053
Epoch: 3, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.734 Vali Acc: 0.494 Test Loss: 0.734 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.263169527053833
Epoch: 4, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.731 Vali Acc: 0.483 Test Loss: 0.731 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3552038669586182
Epoch: 5, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 6 cost time: 1.2089686393737793
Epoch: 6, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.735 Vali Acc: 0.494 Test Loss: 0.735 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3845200538635254
Epoch: 7, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.745 Vali Acc: 0.489 Test Loss: 0.745 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2526228427886963
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.746 Vali Acc: 0.483 Test Loss: 0.746 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2749392986297607
Epoch: 9, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.759 Vali Acc: 0.489 Test Loss: 0.759 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2698967456817627
Epoch: 10, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.769 Vali Acc: 0.483 Test Loss: 0.769 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3039357662200928
Epoch: 11, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.779 Vali Acc: 0.489 Test Loss: 0.779 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.410111427307129
Epoch: 12, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.787 Vali Acc: 0.489 Test Loss: 0.787 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3821115493774414
Epoch: 13, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.825 Vali Acc: 0.506 Test Loss: 0.825 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505547).  Saving model ...
Epoch: 14 cost time: 1.395864725112915
Epoch: 14, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.841 Vali Acc: 0.489 Test Loss: 0.841 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4006621837615967
Epoch: 15, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.842 Vali Acc: 0.472 Test Loss: 0.842 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2754707336425781
Epoch: 16, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.857 Vali Acc: 0.494 Test Loss: 0.857 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.380523443222046
Epoch: 17, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.864 Vali Acc: 0.494 Test Loss: 0.864 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.294654130935669
Epoch: 18, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.881 Vali Acc: 0.494 Test Loss: 0.881 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4369981288909912
Epoch: 19, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.919 Vali Acc: 0.494 Test Loss: 0.919 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.294896125793457
Epoch: 20, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.950 Vali Acc: 0.533 Test Loss: 0.950 Test Acc: 0.533
Validation loss decreased (-0.505547 --> -0.533324).  Saving model ...
Epoch: 21 cost time: 1.3094048500061035
Epoch: 21, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.980 Vali Acc: 0.494 Test Loss: 0.980 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4923856258392334
Epoch: 22, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.984 Vali Acc: 0.511 Test Loss: 0.984 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3935120105743408
Epoch: 23, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.017 Vali Acc: 0.494 Test Loss: 1.017 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5145142078399658
Epoch: 24, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.025 Vali Acc: 0.511 Test Loss: 1.025 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.302483320236206
Epoch: 25, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.034 Vali Acc: 0.517 Test Loss: 1.034 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5089223384857178
Epoch: 26, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.044 Vali Acc: 0.511 Test Loss: 1.044 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3592555522918701
Epoch: 27, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.105 Vali Acc: 0.517 Test Loss: 1.105 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1449017524719238
Epoch: 28, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.134 Vali Acc: 0.483 Test Loss: 1.134 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.268235206604004
Epoch: 29, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2826604843139648
Epoch: 30, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.183 Vali Acc: 0.506 Test Loss: 1.183 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 35282
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.195106029510498
Epoch: 1, Steps: 13 | Train Loss: 0.779 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.7495179176330566
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.701 Vali Acc: 0.528 Test Loss: 0.701 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5989501476287842
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.735 Vali Acc: 0.511 Test Loss: 0.735 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6852333545684814
Epoch: 4, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3949675559997559
Epoch: 5, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.811 Vali Acc: 0.472 Test Loss: 0.811 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4918162822723389
Epoch: 6, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.874 Vali Acc: 0.483 Test Loss: 0.874 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.660663366317749
Epoch: 7, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.980 Vali Acc: 0.522 Test Loss: 0.980 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5215802192687988
Epoch: 8, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.986 Vali Acc: 0.483 Test Loss: 0.986 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6572849750518799
Epoch: 9, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.007 Vali Acc: 0.472 Test Loss: 1.007 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5079612731933594
Epoch: 10, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.045 Vali Acc: 0.450 Test Loss: 1.045 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6479482650756836
Epoch: 11, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.178 Vali Acc: 0.494 Test Loss: 1.178 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 33698
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.082308053970337
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.728 Vali Acc: 0.478 Test Loss: 0.728 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.2139050960540771
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.735 Vali Acc: 0.511 Test Loss: 0.735 Test Acc: 0.511
Validation loss decreased (-0.477770 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.3573765754699707
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.755 Vali Acc: 0.506 Test Loss: 0.755 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4859662055969238
Epoch: 4, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.753 Vali Acc: 0.511 Test Loss: 0.753 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2048020362854004
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.778 Vali Acc: 0.483 Test Loss: 0.778 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.482513189315796
Epoch: 6, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.772 Vali Acc: 0.478 Test Loss: 0.772 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.221665859222412
Epoch: 7, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.808 Vali Acc: 0.478 Test Loss: 0.808 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3228728771209717
Epoch: 8, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.852 Vali Acc: 0.461 Test Loss: 0.852 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.227323055267334
Epoch: 9, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.871 Vali Acc: 0.450 Test Loss: 0.871 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.215989589691162
Epoch: 10, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.928 Vali Acc: 0.489 Test Loss: 0.928 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4378454685211182
Epoch: 11, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.932 Vali Acc: 0.467 Test Loss: 0.932 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.216637372970581
Epoch: 12, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.964 Vali Acc: 0.472 Test Loss: 0.964 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 25874
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.988288164138794
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.728 Vali Acc: 0.506 Test Loss: 0.728 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3617756366729736
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.714 Vali Acc: 0.517 Test Loss: 0.714 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 1.334057331085205
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.702 Vali Acc: 0.561 Test Loss: 0.702 Test Acc: 0.561
Validation loss decreased (-0.516660 --> -0.561104).  Saving model ...
Epoch: 4 cost time: 1.1602611541748047
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.700 Vali Acc: 0.533 Test Loss: 0.700 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4298534393310547
Epoch: 5, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.715 Vali Acc: 0.544 Test Loss: 0.715 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2637887001037598
Epoch: 6, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.710 Vali Acc: 0.539 Test Loss: 0.710 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2469191551208496
Epoch: 7, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.725 Vali Acc: 0.522 Test Loss: 0.725 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3913631439208984
Epoch: 8, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.752 Vali Acc: 0.528 Test Loss: 0.752 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2493846416473389
Epoch: 9, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.757 Vali Acc: 0.533 Test Loss: 0.757 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3658673763275146
Epoch: 10, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.771 Vali Acc: 0.528 Test Loss: 0.771 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1903607845306396
Epoch: 11, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.807 Vali Acc: 0.533 Test Loss: 0.807 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2391951084136963
Epoch: 12, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.826 Vali Acc: 0.533 Test Loss: 0.826 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3020515441894531
Epoch: 13, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.874 Vali Acc: 0.539 Test Loss: 0.874 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 23426
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.015610456466675
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.694 Vali Acc: 0.561 Test Loss: 0.694 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 1.3325433731079102
Epoch: 2, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.701 Vali Acc: 0.539 Test Loss: 0.701 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.214094877243042
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.702 Vali Acc: 0.544 Test Loss: 0.702 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2947556972503662
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.699 Vali Acc: 0.511 Test Loss: 0.699 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0724647045135498
Epoch: 5, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.710 Vali Acc: 0.528 Test Loss: 0.710 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2661235332489014
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.713 Vali Acc: 0.522 Test Loss: 0.713 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.098567247390747
Epoch: 7, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.721 Vali Acc: 0.539 Test Loss: 0.721 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0249693393707275
Epoch: 8, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.732 Vali Acc: 0.522 Test Loss: 0.732 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.040454387664795
Epoch: 9, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.103691577911377
Epoch: 10, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.777 Vali Acc: 0.483 Test Loss: 0.777 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1746611595153809
Epoch: 11, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.783 Vali Acc: 0.528 Test Loss: 0.783 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 22322
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8591561317443848
Epoch: 1, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.740 Vali Acc: 0.511 Test Loss: 0.740 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.1081876754760742
Epoch: 2, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.747 Vali Acc: 0.494 Test Loss: 0.747 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0782229900360107
Epoch: 3, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.745 Vali Acc: 0.528 Test Loss: 0.745 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 1.1325910091400146
Epoch: 4, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.741 Vali Acc: 0.544 Test Loss: 0.741 Test Acc: 0.544
Validation loss decreased (-0.527770 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.1209335327148438
Epoch: 5, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.734 Vali Acc: 0.517 Test Loss: 0.734 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0433628559112549
Epoch: 6, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.736 Vali Acc: 0.517 Test Loss: 0.736 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1077277660369873
Epoch: 7, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.750 Vali Acc: 0.511 Test Loss: 0.750 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1823546886444092
Epoch: 8, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.756 Vali Acc: 0.539 Test Loss: 0.756 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1891975402832031
Epoch: 9, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.769 Vali Acc: 0.539 Test Loss: 0.769 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2708866596221924
Epoch: 10, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.764 Vali Acc: 0.533 Test Loss: 0.764 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0639004707336426
Epoch: 11, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.790 Vali Acc: 0.511 Test Loss: 0.790 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.258718729019165
Epoch: 12, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.801 Vali Acc: 0.528 Test Loss: 0.801 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1160926818847656
Epoch: 13, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.816 Vali Acc: 0.522 Test Loss: 0.816 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2906975746154785
Epoch: 14, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.820 Vali Acc: 0.522 Test Loss: 0.820 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 21890
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0756304264068604
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.776 Vali Acc: 0.489 Test Loss: 0.776 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.1968863010406494
Epoch: 2, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.771 Vali Acc: 0.494 Test Loss: 0.771 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.140010118484497
Epoch: 3, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.768 Vali Acc: 0.483 Test Loss: 0.768 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.068378210067749
Epoch: 4, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.757 Vali Acc: 0.494 Test Loss: 0.757 Test Acc: 0.494
Validation loss decreased (-0.494437 --> -0.494437).  Saving model ...
Epoch: 5 cost time: 1.2324655055999756
Epoch: 5, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.755 Vali Acc: 0.506 Test Loss: 0.755 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505548).  Saving model ...
Epoch: 6 cost time: 1.1437911987304688
Epoch: 6, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.751 Vali Acc: 0.517 Test Loss: 0.751 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516659).  Saving model ...
Epoch: 7 cost time: 1.252007246017456
Epoch: 7, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.755 Vali Acc: 0.483 Test Loss: 0.755 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0251638889312744
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.753 Vali Acc: 0.533 Test Loss: 0.753 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533326).  Saving model ...
Epoch: 9 cost time: 1.1414270401000977
Epoch: 9, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.758 Vali Acc: 0.533 Test Loss: 0.758 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.179032802581787
Epoch: 10, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.767 Vali Acc: 0.511 Test Loss: 0.767 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0738928318023682
Epoch: 11, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.783 Vali Acc: 0.489 Test Loss: 0.783 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1598193645477295
Epoch: 12, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.784 Vali Acc: 0.506 Test Loss: 0.784 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1852822303771973
Epoch: 13, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.799 Vali Acc: 0.506 Test Loss: 0.799 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1285991668701172
Epoch: 14, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.822 Vali Acc: 0.533 Test Loss: 0.822 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1599326133728027
Epoch: 15, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.819 Vali Acc: 0.522 Test Loss: 0.819 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.197145700454712
Epoch: 16, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.846 Vali Acc: 0.511 Test Loss: 0.846 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.147914171218872
Epoch: 17, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.877 Vali Acc: 0.511 Test Loss: 0.877 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1831657886505127
Epoch: 18, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.876 Vali Acc: 0.506 Test Loss: 0.876 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 21922
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7855701446533203
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.696 Vali Acc: 0.533 Test Loss: 0.696 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.1690247058868408
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.1172544956207275
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.681 Vali Acc: 0.544 Test Loss: 0.681 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1814501285552979
Epoch: 4, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.689 Vali Acc: 0.522 Test Loss: 0.689 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1511900424957275
Epoch: 5, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.683 Vali Acc: 0.533 Test Loss: 0.683 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1677358150482178
Epoch: 6, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.689 Vali Acc: 0.533 Test Loss: 0.689 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1377131938934326
Epoch: 7, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.694 Vali Acc: 0.522 Test Loss: 0.694 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.07161283493042
Epoch: 8, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.703 Vali Acc: 0.533 Test Loss: 0.703 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.198988437652588
Epoch: 9, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.710 Vali Acc: 0.533 Test Loss: 0.710 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0873477458953857
Epoch: 10, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.715 Vali Acc: 0.544 Test Loss: 0.715 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1185951232910156
Epoch: 11, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.726 Vali Acc: 0.544 Test Loss: 0.726 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0729527473449707
Epoch: 12, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.738 Vali Acc: 0.528 Test Loss: 0.738 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 22610
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.271117448806763
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.1840267181396484
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 2.131117105484009
Epoch: 3, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.359555959701538
Epoch: 4, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.774 Vali Acc: 0.494 Test Loss: 0.774 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3931221961975098
Epoch: 5, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.843 Vali Acc: 0.494 Test Loss: 0.843 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2418155670166016
Epoch: 6, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.893 Vali Acc: 0.472 Test Loss: 0.893 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1565439701080322
Epoch: 7, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.947 Vali Acc: 0.494 Test Loss: 0.947 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4164414405822754
Epoch: 8, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.971 Vali Acc: 0.500 Test Loss: 0.971 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3002192974090576
Epoch: 9, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.046 Vali Acc: 0.483 Test Loss: 1.046 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9505953788757324
Epoch: 10, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.102 Vali Acc: 0.472 Test Loss: 1.102 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.06992506980896
Epoch: 11, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.170 Vali Acc: 0.439 Test Loss: 1.170 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.065199851989746
Epoch: 12, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.236 Vali Acc: 0.494 Test Loss: 1.236 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 27362
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9861977100372314
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.742 Vali Acc: 0.461 Test Loss: 0.742 Test Acc: 0.461
Validation loss decreased (inf --> -0.461104).  Saving model ...
Epoch: 2 cost time: 1.2184994220733643
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.746 Vali Acc: 0.450 Test Loss: 0.746 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2529022693634033
Epoch: 3, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.753 Vali Acc: 0.478 Test Loss: 0.753 Test Acc: 0.478
Validation loss decreased (-0.461104 --> -0.477770).  Saving model ...
Epoch: 4 cost time: 1.1831638813018799
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.761 Vali Acc: 0.489 Test Loss: 0.761 Test Acc: 0.489
Validation loss decreased (-0.477770 --> -0.488881).  Saving model ...
Epoch: 5 cost time: 1.0717339515686035
Epoch: 5, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.772 Vali Acc: 0.467 Test Loss: 0.772 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1512870788574219
Epoch: 6, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.782 Vali Acc: 0.472 Test Loss: 0.782 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2373898029327393
Epoch: 7, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.830 Vali Acc: 0.494 Test Loss: 0.830 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494436).  Saving model ...
Epoch: 8 cost time: 1.2189664840698242
Epoch: 8, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.841 Vali Acc: 0.467 Test Loss: 0.841 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.09852933883667
Epoch: 9, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.896 Vali Acc: 0.472 Test Loss: 0.896 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2153387069702148
Epoch: 10, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.897 Vali Acc: 0.467 Test Loss: 0.897 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1265137195587158
Epoch: 11, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.936 Vali Acc: 0.467 Test Loss: 0.936 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2328567504882812
Epoch: 12, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.970 Vali Acc: 0.489 Test Loss: 0.970 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2507977485656738
Epoch: 13, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.099 Vali Acc: 0.472 Test Loss: 1.099 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1918692588806152
Epoch: 14, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.074 Vali Acc: 0.456 Test Loss: 1.074 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2941126823425293
Epoch: 15, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.087 Vali Acc: 0.489 Test Loss: 1.087 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1254642009735107
Epoch: 16, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.136 Vali Acc: 0.494 Test Loss: 1.136 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1467993259429932
Epoch: 17, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.153 Vali Acc: 0.483 Test Loss: 1.153 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 19538
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.902878522872925
Epoch: 1, Steps: 13 | Train Loss: 0.776 Vali Loss: 0.763 Vali Acc: 0.456 Test Loss: 0.763 Test Acc: 0.456
Validation loss decreased (inf --> -0.455548).  Saving model ...
Epoch: 2 cost time: 1.1793370246887207
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.753 Vali Acc: 0.478 Test Loss: 0.753 Test Acc: 0.478
Validation loss decreased (-0.455548 --> -0.477770).  Saving model ...
Epoch: 3 cost time: 1.2140836715698242
Epoch: 3, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.743 Vali Acc: 0.494 Test Loss: 0.743 Test Acc: 0.494
Validation loss decreased (-0.477770 --> -0.494437).  Saving model ...
Epoch: 4 cost time: 1.1017646789550781
Epoch: 4, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.739 Vali Acc: 0.494 Test Loss: 0.739 Test Acc: 0.494
Validation loss decreased (-0.494437 --> -0.494437).  Saving model ...
Epoch: 5 cost time: 1.120300054550171
Epoch: 5, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.745 Vali Acc: 0.528 Test Loss: 0.745 Test Acc: 0.528
Validation loss decreased (-0.494437 --> -0.527770).  Saving model ...
Epoch: 6 cost time: 1.2253127098083496
Epoch: 6, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0653314590454102
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.773 Vali Acc: 0.489 Test Loss: 0.773 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3204169273376465
Epoch: 8, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.790 Vali Acc: 0.506 Test Loss: 0.790 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1544811725616455
Epoch: 9, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.810 Vali Acc: 0.522 Test Loss: 0.810 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2229523658752441
Epoch: 10, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1824061870574951
Epoch: 11, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.873 Vali Acc: 0.494 Test Loss: 0.873 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3251628875732422
Epoch: 12, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1282103061676025
Epoch: 13, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.896 Vali Acc: 0.506 Test Loss: 0.896 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1688499450683594
Epoch: 14, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.925 Vali Acc: 0.506 Test Loss: 0.925 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1410419940948486
Epoch: 15, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.960 Vali Acc: 0.494 Test Loss: 0.960 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 17090
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7207143306732178
Epoch: 1, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.1235899925231934
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.691 Vali Acc: 0.578 Test Loss: 0.691 Test Acc: 0.578
Validation loss decreased (-0.549993 --> -0.577771).  Saving model ...
Epoch: 3 cost time: 1.1251702308654785
Epoch: 3, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.697 Vali Acc: 0.528 Test Loss: 0.697 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1950397491455078
Epoch: 4, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.695 Vali Acc: 0.600 Test Loss: 0.695 Test Acc: 0.600
Validation loss decreased (-0.577771 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 1.1197798252105713
Epoch: 5, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.698 Vali Acc: 0.572 Test Loss: 0.698 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1540346145629883
Epoch: 6, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1325907707214355
Epoch: 7, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.723 Vali Acc: 0.522 Test Loss: 0.723 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3804380893707275
Epoch: 8, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.736 Vali Acc: 0.506 Test Loss: 0.736 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3307077884674072
Epoch: 9, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.752 Vali Acc: 0.511 Test Loss: 0.752 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4243178367614746
Epoch: 10, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.769 Vali Acc: 0.506 Test Loss: 0.769 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3790395259857178
Epoch: 11, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.783 Vali Acc: 0.517 Test Loss: 0.783 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.300222635269165
Epoch: 12, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3338751792907715
Epoch: 13, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.822 Vali Acc: 0.511 Test Loss: 0.822 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3786861896514893
Epoch: 14, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.829 Vali Acc: 0.483 Test Loss: 0.829 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6
model parameter : 15986
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.049933671951294
Epoch: 1, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.719 Vali Acc: 0.511 Test Loss: 0.719 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.4030201435089111
Epoch: 2, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.715 Vali Acc: 0.561 Test Loss: 0.715 Test Acc: 0.561
Validation loss decreased (-0.511104 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 1.2800703048706055
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1614067554473877
Epoch: 4, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.721 Vali Acc: 0.522 Test Loss: 0.721 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3018043041229248
Epoch: 5, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.723 Vali Acc: 0.511 Test Loss: 0.723 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2919375896453857
Epoch: 6, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4347620010375977
Epoch: 7, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2607529163360596
Epoch: 8, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.730 Vali Acc: 0.511 Test Loss: 0.730 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2337217330932617
Epoch: 9, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.739 Vali Acc: 0.506 Test Loss: 0.739 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2884373664855957
Epoch: 10, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3798439502716064
Epoch: 11, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.764 Vali Acc: 0.522 Test Loss: 0.764 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3248333930969238
Epoch: 12, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.775 Vali Acc: 0.533 Test Loss: 0.775 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 15554
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9883954524993896
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.724 Vali Acc: 0.511 Test Loss: 0.724 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.1868126392364502
Epoch: 2, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.720 Vali Acc: 0.528 Test Loss: 0.720 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.39121413230896
Epoch: 3, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.718 Vali Acc: 0.533 Test Loss: 0.718 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.242288589477539
Epoch: 4, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.711 Vali Acc: 0.539 Test Loss: 0.711 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 5 cost time: 1.3745460510253906
Epoch: 5, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.330090045928955
Epoch: 6, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.708 Vali Acc: 0.517 Test Loss: 0.708 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3713362216949463
Epoch: 7, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.717 Vali Acc: 0.556 Test Loss: 0.717 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555548).  Saving model ...
Epoch: 8 cost time: 1.3055543899536133
Epoch: 8, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.715 Vali Acc: 0.589 Test Loss: 0.715 Test Acc: 0.589
Validation loss decreased (-0.555548 --> -0.588882).  Saving model ...
Epoch: 9 cost time: 1.3256289958953857
Epoch: 9, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.717 Vali Acc: 0.528 Test Loss: 0.717 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4096362590789795
Epoch: 10, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.714 Vali Acc: 0.533 Test Loss: 0.714 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.495319128036499
Epoch: 11, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.724 Vali Acc: 0.539 Test Loss: 0.724 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.448638677597046
Epoch: 12, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.739 Vali Acc: 0.544 Test Loss: 0.739 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.17781400680542
Epoch: 13, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.750 Vali Acc: 0.522 Test Loss: 0.750 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4893052577972412
Epoch: 14, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.770 Vali Acc: 0.528 Test Loss: 0.770 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.269334077835083
Epoch: 15, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.778 Vali Acc: 0.533 Test Loss: 0.778 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3575596809387207
Epoch: 16, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.788 Vali Acc: 0.528 Test Loss: 0.788 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2614774703979492
Epoch: 17, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.814 Vali Acc: 0.522 Test Loss: 0.814 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2929513454437256
Epoch: 18, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.830 Vali Acc: 0.511 Test Loss: 0.830 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 15586
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9934024810791016
Epoch: 1, Steps: 13 | Train Loss: 0.776 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3447585105895996
Epoch: 2, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.735 Vali Acc: 0.517 Test Loss: 0.735 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.284083366394043
Epoch: 3, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3581397533416748
Epoch: 4, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527771).  Saving model ...
Epoch: 5 cost time: 1.308462381362915
Epoch: 5, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.719 Vali Acc: 0.533 Test Loss: 0.719 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 1.1378722190856934
Epoch: 6, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.716 Vali Acc: 0.522 Test Loss: 0.716 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3014445304870605
Epoch: 7, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.736 Vali Acc: 0.517 Test Loss: 0.736 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.346174716949463
Epoch: 8, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.731 Vali Acc: 0.517 Test Loss: 0.731 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2713432312011719
Epoch: 9, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.748 Vali Acc: 0.517 Test Loss: 0.748 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3490033149719238
Epoch: 10, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.759 Vali Acc: 0.517 Test Loss: 0.759 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1797869205474854
Epoch: 11, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.753 Vali Acc: 0.506 Test Loss: 0.753 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3000056743621826
Epoch: 12, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.766 Vali Acc: 0.483 Test Loss: 0.766 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3311641216278076
Epoch: 13, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3198988437652588
Epoch: 14, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.796 Vali Acc: 0.511 Test Loss: 0.796 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.296077013015747
Epoch: 15, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el3_dm16_nh4_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 16274
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8777267932891846
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.739 Vali Acc: 0.494 Test Loss: 0.739 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 2.0136475563049316
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.996 Vali Acc: 0.506 Test Loss: 0.996 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505546).  Saving model ...
Epoch: 3 cost time: 2.1367409229278564
Epoch: 3, Steps: 13 | Train Loss: 0.564 Vali Loss: 1.335 Vali Acc: 0.494 Test Loss: 1.335 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.370636463165283
Epoch: 4, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.858 Vali Acc: 0.500 Test Loss: 1.858 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2899584770202637
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.817 Vali Acc: 0.478 Test Loss: 1.817 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.25163197517395
Epoch: 6, Steps: 13 | Train Loss: 0.450 Vali Loss: 2.261 Vali Acc: 0.461 Test Loss: 2.261 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0358595848083496
Epoch: 7, Steps: 13 | Train Loss: 0.265 Vali Loss: 3.599 Vali Acc: 0.511 Test Loss: 3.599 Test Acc: 0.511
Validation loss decreased (-0.505546 --> -0.511075).  Saving model ...
Epoch: 8 cost time: 2.214663505554199
Epoch: 8, Steps: 13 | Train Loss: 0.427 Vali Loss: 2.771 Vali Acc: 0.472 Test Loss: 2.771 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.213636875152588
Epoch: 9, Steps: 13 | Train Loss: 0.296 Vali Loss: 3.146 Vali Acc: 0.461 Test Loss: 3.146 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0568997859954834
Epoch: 10, Steps: 13 | Train Loss: 0.287 Vali Loss: 3.400 Vali Acc: 0.478 Test Loss: 3.400 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1348636150360107
Epoch: 11, Steps: 13 | Train Loss: 0.114 Vali Loss: 3.543 Vali Acc: 0.461 Test Loss: 3.543 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.251096725463867
Epoch: 12, Steps: 13 | Train Loss: 0.340 Vali Loss: 4.304 Vali Acc: 0.472 Test Loss: 4.304 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.382627487182617
Epoch: 13, Steps: 13 | Train Loss: 0.299 Vali Loss: 4.522 Vali Acc: 0.489 Test Loss: 4.522 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3483784198760986
Epoch: 14, Steps: 13 | Train Loss: 0.175 Vali Loss: 4.770 Vali Acc: 0.467 Test Loss: 4.770 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3171184062957764
Epoch: 15, Steps: 13 | Train Loss: 0.071 Vali Loss: 5.373 Vali Acc: 0.444 Test Loss: 5.373 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5901756286621094
Epoch: 16, Steps: 13 | Train Loss: 0.070 Vali Loss: 5.148 Vali Acc: 0.428 Test Loss: 5.148 Test Acc: 0.428
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.354771137237549
Epoch: 17, Steps: 13 | Train Loss: 0.063 Vali Loss: 5.177 Vali Acc: 0.456 Test Loss: 5.177 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 405122
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2242705821990967
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.773 Vali Acc: 0.478 Test Loss: 0.773 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.8088171482086182
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.855 Vali Acc: 0.528 Test Loss: 0.855 Test Acc: 0.528
Validation loss decreased (-0.477770 --> -0.527769).  Saving model ...
Epoch: 3 cost time: 1.7591567039489746
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.065 Vali Acc: 0.494 Test Loss: 1.065 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7982230186462402
Epoch: 4, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.280 Vali Acc: 0.483 Test Loss: 1.280 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8561241626739502
Epoch: 5, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.494 Vali Acc: 0.494 Test Loss: 1.494 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6050336360931396
Epoch: 6, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.638 Vali Acc: 0.494 Test Loss: 1.638 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7282323837280273
Epoch: 7, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.817 Vali Acc: 0.500 Test Loss: 1.817 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.86543869972229
Epoch: 8, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.896 Vali Acc: 0.489 Test Loss: 1.896 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7817137241363525
Epoch: 9, Steps: 13 | Train Loss: 0.269 Vali Loss: 2.058 Vali Acc: 0.478 Test Loss: 2.058 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7104685306549072
Epoch: 10, Steps: 13 | Train Loss: 0.229 Vali Loss: 2.316 Vali Acc: 0.472 Test Loss: 2.316 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.568575143814087
Epoch: 11, Steps: 13 | Train Loss: 0.204 Vali Loss: 2.355 Vali Acc: 0.494 Test Loss: 2.355 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3672492504119873
Epoch: 12, Steps: 13 | Train Loss: 0.183 Vali Loss: 2.711 Vali Acc: 0.494 Test Loss: 2.711 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 342530
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4119386672973633
Epoch: 1, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.723 Vali Acc: 0.522 Test Loss: 0.723 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.7607817649841309
Epoch: 2, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.743 Vali Acc: 0.533 Test Loss: 0.743 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.7315609455108643
Epoch: 3, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.849 Vali Acc: 0.472 Test Loss: 0.849 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6071958541870117
Epoch: 4, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.938 Vali Acc: 0.483 Test Loss: 0.938 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7500829696655273
Epoch: 5, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.157 Vali Acc: 0.489 Test Loss: 1.157 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7601912021636963
Epoch: 6, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.314 Vali Acc: 0.489 Test Loss: 1.314 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8976385593414307
Epoch: 7, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.449 Vali Acc: 0.522 Test Loss: 1.449 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5670075416564941
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.472 Vali Acc: 0.461 Test Loss: 1.472 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.699429988861084
Epoch: 9, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.766 Vali Acc: 0.506 Test Loss: 1.766 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8332831859588623
Epoch: 10, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.848 Vali Acc: 0.467 Test Loss: 1.848 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6862220764160156
Epoch: 11, Steps: 13 | Train Loss: 0.232 Vali Loss: 2.105 Vali Acc: 0.511 Test Loss: 2.105 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6655209064483643
Epoch: 12, Steps: 13 | Train Loss: 0.188 Vali Loss: 2.199 Vali Acc: 0.483 Test Loss: 2.199 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 322946
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0730347633361816
Epoch: 1, Steps: 13 | Train Loss: 0.846 Vali Loss: 0.777 Vali Acc: 0.417 Test Loss: 0.777 Test Acc: 0.417
Validation loss decreased (inf --> -0.416659).  Saving model ...
Epoch: 2 cost time: 1.314901351928711
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.780 Vali Acc: 0.489 Test Loss: 0.780 Test Acc: 0.489
Validation loss decreased (-0.416659 --> -0.488881).  Saving model ...
Epoch: 3 cost time: 1.2312064170837402
Epoch: 3, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.822 Vali Acc: 0.478 Test Loss: 0.822 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3405966758728027
Epoch: 4, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.924 Vali Acc: 0.517 Test Loss: 0.924 Test Acc: 0.517
Validation loss decreased (-0.488881 --> -0.516657).  Saving model ...
Epoch: 5 cost time: 1.2930989265441895
Epoch: 5, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.973 Vali Acc: 0.478 Test Loss: 0.973 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1263093948364258
Epoch: 6, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.125 Vali Acc: 0.494 Test Loss: 1.125 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1883697509765625
Epoch: 7, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.200 Vali Acc: 0.472 Test Loss: 1.200 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.290269374847412
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.649 Vali Acc: 0.506 Test Loss: 1.649 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2637605667114258
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.473 Vali Acc: 0.500 Test Loss: 1.473 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0822103023529053
Epoch: 10, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.575 Vali Acc: 0.494 Test Loss: 1.575 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2524809837341309
Epoch: 11, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.710 Vali Acc: 0.489 Test Loss: 1.710 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.148097276687622
Epoch: 12, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.797 Vali Acc: 0.511 Test Loss: 1.797 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4188244342803955
Epoch: 13, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.940 Vali Acc: 0.511 Test Loss: 1.940 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5898118019104004
Epoch: 14, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.065 Vali Acc: 0.528 Test Loss: 2.065 Test Acc: 0.528
Validation loss decreased (-0.516657 --> -0.527757).  Saving model ...
Epoch: 15 cost time: 1.3524415493011475
Epoch: 15, Steps: 13 | Train Loss: 0.189 Vali Loss: 2.259 Vali Acc: 0.500 Test Loss: 2.259 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.652597188949585
Epoch: 16, Steps: 13 | Train Loss: 0.133 Vali Loss: 2.508 Vali Acc: 0.522 Test Loss: 2.508 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.667722225189209
Epoch: 17, Steps: 13 | Train Loss: 0.095 Vali Loss: 2.493 Vali Acc: 0.506 Test Loss: 2.493 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3335175514221191
Epoch: 18, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.628 Vali Acc: 0.483 Test Loss: 2.628 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6385703086853027
Epoch: 19, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.692 Vali Acc: 0.483 Test Loss: 2.692 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6082379817962646
Epoch: 20, Steps: 13 | Train Loss: 0.060 Vali Loss: 2.936 Vali Acc: 0.478 Test Loss: 2.936 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4635536670684814
Epoch: 21, Steps: 13 | Train Loss: 0.064 Vali Loss: 3.044 Vali Acc: 0.517 Test Loss: 3.044 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.519406795501709
Epoch: 22, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.243 Vali Acc: 0.461 Test Loss: 3.243 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.423750877380371
Epoch: 23, Steps: 13 | Train Loss: 0.048 Vali Loss: 3.647 Vali Acc: 0.450 Test Loss: 3.647 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.403902530670166
Epoch: 24, Steps: 13 | Train Loss: 0.068 Vali Loss: 3.675 Vali Acc: 0.461 Test Loss: 3.675 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 314114
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.249284029006958
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.732 Vali Acc: 0.472 Test Loss: 0.732 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.3596296310424805
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.736 Vali Acc: 0.472 Test Loss: 0.736 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.455855369567871
Epoch: 3, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
Validation loss decreased (-0.472215 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 1.589336633682251
Epoch: 4, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3018431663513184
Epoch: 5, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.921 Vali Acc: 0.506 Test Loss: 0.921 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505546).  Saving model ...
Epoch: 6 cost time: 1.2488718032836914
Epoch: 6, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.011 Vali Acc: 0.500 Test Loss: 1.011 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.599987506866455
Epoch: 7, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.086 Vali Acc: 0.517 Test Loss: 1.086 Test Acc: 0.517
Validation loss decreased (-0.505546 --> -0.516656).  Saving model ...
Epoch: 8 cost time: 1.2976157665252686
Epoch: 8, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.273 Vali Acc: 0.506 Test Loss: 1.273 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3070991039276123
Epoch: 9, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.345 Vali Acc: 0.489 Test Loss: 1.345 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4890849590301514
Epoch: 10, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.462 Vali Acc: 0.494 Test Loss: 1.462 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4595932960510254
Epoch: 11, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2598295211791992
Epoch: 12, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.654 Vali Acc: 0.494 Test Loss: 1.654 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.550987720489502
Epoch: 13, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.732 Vali Acc: 0.494 Test Loss: 1.732 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.414501428604126
Epoch: 14, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.886 Vali Acc: 0.511 Test Loss: 1.886 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2831158638000488
Epoch: 15, Steps: 13 | Train Loss: 0.195 Vali Loss: 2.017 Vali Acc: 0.500 Test Loss: 2.017 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5352282524108887
Epoch: 16, Steps: 13 | Train Loss: 0.122 Vali Loss: 2.074 Vali Acc: 0.511 Test Loss: 2.074 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.501145601272583
Epoch: 17, Steps: 13 | Train Loss: 0.127 Vali Loss: 2.185 Vali Acc: 0.500 Test Loss: 2.185 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 310658
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5673515796661377
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.747 Vali Acc: 0.478 Test Loss: 0.747 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 0.8727548122406006
Epoch: 2, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.755 Vali Acc: 0.544 Test Loss: 0.755 Test Acc: 0.544
Validation loss decreased (-0.477770 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 0.8464751243591309
Epoch: 3, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.792 Vali Acc: 0.589 Test Loss: 0.792 Test Acc: 0.589
Validation loss decreased (-0.544437 --> -0.588881).  Saving model ...
Epoch: 4 cost time: 0.821697473526001
Epoch: 4, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.837 Vali Acc: 0.483 Test Loss: 0.837 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8402431011199951
Epoch: 5, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.952 Vali Acc: 0.572 Test Loss: 0.952 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7628259658813477
Epoch: 6, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.972 Vali Acc: 0.511 Test Loss: 0.972 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7667341232299805
Epoch: 7, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.087 Vali Acc: 0.539 Test Loss: 1.087 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8227834701538086
Epoch: 8, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.083 Vali Acc: 0.511 Test Loss: 1.083 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9320120811462402
Epoch: 9, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8062725067138672
Epoch: 10, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.253 Vali Acc: 0.483 Test Loss: 1.253 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8741321563720703
Epoch: 11, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.338 Vali Acc: 0.539 Test Loss: 1.338 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.796837329864502
Epoch: 12, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.412 Vali Acc: 0.467 Test Loss: 1.412 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7868692874908447
Epoch: 13, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.604 Vali Acc: 0.517 Test Loss: 1.604 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 310914
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6302013397216797
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.686 Vali Acc: 0.539 Test Loss: 0.686 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 0.8281710147857666
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 0.8219051361083984
Epoch: 3, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7827925682067871
Epoch: 4, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8096199035644531
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.835 Vali Acc: 0.544 Test Loss: 0.835 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7303645610809326
Epoch: 6, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.932 Vali Acc: 0.522 Test Loss: 0.932 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7806980609893799
Epoch: 7, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.979 Vali Acc: 0.483 Test Loss: 0.979 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8197171688079834
Epoch: 8, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.018 Vali Acc: 0.583 Test Loss: 1.018 Test Acc: 0.583
Validation loss decreased (-0.549993 --> -0.583323).  Saving model ...
Epoch: 9 cost time: 0.8335552215576172
Epoch: 9, Steps: 13 | Train Loss: 0.377 Vali Loss: 1.117 Vali Acc: 0.522 Test Loss: 1.117 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9136908054351807
Epoch: 10, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.171 Vali Acc: 0.522 Test Loss: 1.171 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8115904331207275
Epoch: 11, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.234 Vali Acc: 0.506 Test Loss: 1.234 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.773256778717041
Epoch: 12, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.287 Vali Acc: 0.517 Test Loss: 1.287 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9502930641174316
Epoch: 13, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.381 Vali Acc: 0.511 Test Loss: 1.381 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8932452201843262
Epoch: 14, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.490 Vali Acc: 0.511 Test Loss: 1.490 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7611980438232422
Epoch: 15, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.637 Vali Acc: 0.494 Test Loss: 1.637 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8422553539276123
Epoch: 16, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.682 Vali Acc: 0.478 Test Loss: 1.682 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.827155351638794
Epoch: 17, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.775 Vali Acc: 0.483 Test Loss: 1.775 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7460463047027588
Epoch: 18, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.959 Vali Acc: 0.478 Test Loss: 1.959 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 316418
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7641258239746094
Epoch: 1, Steps: 13 | Train Loss: 0.883 Vali Loss: 0.936 Vali Acc: 0.489 Test Loss: 0.936 Test Acc: 0.489
Validation loss decreased (inf --> -0.488880).  Saving model ...
Epoch: 2 cost time: 1.6398448944091797
Epoch: 2, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.968 Vali Acc: 0.500 Test Loss: 0.968 Test Acc: 0.500
Validation loss decreased (-0.488880 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 1.8885607719421387
Epoch: 3, Steps: 13 | Train Loss: 0.520 Vali Loss: 1.108 Vali Acc: 0.511 Test Loss: 1.108 Test Acc: 0.511
Validation loss decreased (-0.499990 --> -0.511100).  Saving model ...
Epoch: 4 cost time: 1.7398898601531982
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.390 Vali Acc: 0.483 Test Loss: 1.390 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8974850177764893
Epoch: 5, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.916 Vali Acc: 0.483 Test Loss: 1.916 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7037866115570068
Epoch: 6, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.896 Vali Acc: 0.478 Test Loss: 1.896 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9581530094146729
Epoch: 7, Steps: 13 | Train Loss: 0.307 Vali Loss: 2.088 Vali Acc: 0.472 Test Loss: 2.088 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.793783187866211
Epoch: 8, Steps: 13 | Train Loss: 0.306 Vali Loss: 2.494 Vali Acc: 0.444 Test Loss: 2.494 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.042522668838501
Epoch: 9, Steps: 13 | Train Loss: 0.379 Vali Loss: 3.305 Vali Acc: 0.483 Test Loss: 3.305 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6065831184387207
Epoch: 10, Steps: 13 | Train Loss: 0.342 Vali Loss: 3.646 Vali Acc: 0.506 Test Loss: 3.646 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7685401439666748
Epoch: 11, Steps: 13 | Train Loss: 0.294 Vali Loss: 3.804 Vali Acc: 0.478 Test Loss: 3.804 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.592076063156128
Epoch: 12, Steps: 13 | Train Loss: 0.287 Vali Loss: 4.005 Vali Acc: 0.461 Test Loss: 4.005 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8864414691925049
Epoch: 13, Steps: 13 | Train Loss: 0.181 Vali Loss: 4.312 Vali Acc: 0.456 Test Loss: 4.312 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 339330
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3928442001342773
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.759 Vali Acc: 0.539 Test Loss: 0.759 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 1.72684907913208
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.809 Vali Acc: 0.461 Test Loss: 0.809 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9203574657440186
Epoch: 3, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.990 Vali Acc: 0.494 Test Loss: 0.990 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7378511428833008
Epoch: 4, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.212 Vali Acc: 0.478 Test Loss: 1.212 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6905121803283691
Epoch: 5, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.336 Vali Acc: 0.483 Test Loss: 1.336 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6271812915802002
Epoch: 6, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.482 Vali Acc: 0.489 Test Loss: 1.482 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8125557899475098
Epoch: 7, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.641 Vali Acc: 0.439 Test Loss: 1.641 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.582840919494629
Epoch: 8, Steps: 13 | Train Loss: 0.234 Vali Loss: 2.071 Vali Acc: 0.461 Test Loss: 2.071 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8694815635681152
Epoch: 9, Steps: 13 | Train Loss: 0.240 Vali Loss: 2.024 Vali Acc: 0.494 Test Loss: 2.024 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.621335506439209
Epoch: 10, Steps: 13 | Train Loss: 0.182 Vali Loss: 2.247 Vali Acc: 0.500 Test Loss: 2.247 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6551291942596436
Epoch: 11, Steps: 13 | Train Loss: 0.250 Vali Loss: 2.259 Vali Acc: 0.500 Test Loss: 2.259 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 276738
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1285548210144043
Epoch: 1, Steps: 13 | Train Loss: 0.776 Vali Loss: 0.733 Vali Acc: 0.478 Test Loss: 0.733 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.8422365188598633
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.800 Vali Acc: 0.494 Test Loss: 0.800 Test Acc: 0.494
Validation loss decreased (-0.477770 --> -0.494436).  Saving model ...
Epoch: 3 cost time: 1.4470674991607666
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.920 Vali Acc: 0.478 Test Loss: 0.920 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7929084300994873
Epoch: 4, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.031 Vali Acc: 0.494 Test Loss: 1.031 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4949989318847656
Epoch: 5, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.214 Vali Acc: 0.489 Test Loss: 1.214 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7365615367889404
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.287 Vali Acc: 0.517 Test Loss: 1.287 Test Acc: 0.517
Validation loss decreased (-0.494436 --> -0.516654).  Saving model ...
Epoch: 7 cost time: 1.4315650463104248
Epoch: 7, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.455 Vali Acc: 0.511 Test Loss: 1.455 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6252710819244385
Epoch: 8, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.558 Vali Acc: 0.494 Test Loss: 1.558 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.486374855041504
Epoch: 9, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.644 Vali Acc: 0.494 Test Loss: 1.644 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4063341617584229
Epoch: 10, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.831 Vali Acc: 0.522 Test Loss: 1.831 Test Acc: 0.522
Validation loss decreased (-0.516654 --> -0.522204).  Saving model ...
Epoch: 11 cost time: 1.8469445705413818
Epoch: 11, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.991 Vali Acc: 0.506 Test Loss: 1.991 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3690261840820312
Epoch: 12, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.251 Vali Acc: 0.528 Test Loss: 2.251 Test Acc: 0.528
Validation loss decreased (-0.522204 --> -0.527755).  Saving model ...
Epoch: 13 cost time: 1.5881354808807373
Epoch: 13, Steps: 13 | Train Loss: 0.193 Vali Loss: 2.291 Vali Acc: 0.500 Test Loss: 2.291 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.137678623199463
Epoch: 14, Steps: 13 | Train Loss: 0.196 Vali Loss: 2.567 Vali Acc: 0.461 Test Loss: 2.567 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4843056201934814
Epoch: 15, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.812 Vali Acc: 0.506 Test Loss: 2.812 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2421605587005615
Epoch: 16, Steps: 13 | Train Loss: 0.149 Vali Loss: 2.899 Vali Acc: 0.500 Test Loss: 2.899 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7163081169128418
Epoch: 17, Steps: 13 | Train Loss: 0.143 Vali Loss: 3.090 Vali Acc: 0.456 Test Loss: 3.090 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3727750778198242
Epoch: 18, Steps: 13 | Train Loss: 0.081 Vali Loss: 3.021 Vali Acc: 0.494 Test Loss: 3.021 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5700788497924805
Epoch: 19, Steps: 13 | Train Loss: 0.069 Vali Loss: 3.447 Vali Acc: 0.467 Test Loss: 3.447 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6166198253631592
Epoch: 20, Steps: 13 | Train Loss: 0.039 Vali Loss: 3.492 Vali Acc: 0.478 Test Loss: 3.492 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4517598152160645
Epoch: 21, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.788 Vali Acc: 0.483 Test Loss: 3.788 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8056831359863281
Epoch: 22, Steps: 13 | Train Loss: 0.058 Vali Loss: 3.870 Vali Acc: 0.506 Test Loss: 3.870 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 257154
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1771507263183594
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.743 Vali Acc: 0.528 Test Loss: 0.743 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 1.397144079208374
Epoch: 2, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.754 Vali Acc: 0.511 Test Loss: 0.754 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3795819282531738
Epoch: 3, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.917 Vali Acc: 0.528 Test Loss: 0.917 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.417450189590454
Epoch: 4, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.937 Vali Acc: 0.483 Test Loss: 0.937 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3687660694122314
Epoch: 5, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.032 Vali Acc: 0.522 Test Loss: 1.032 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.42525315284729
Epoch: 6, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.188 Vali Acc: 0.483 Test Loss: 1.188 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4981579780578613
Epoch: 7, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.265 Vali Acc: 0.506 Test Loss: 1.265 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5921037197113037
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.395 Vali Acc: 0.467 Test Loss: 1.395 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.516150951385498
Epoch: 9, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.454 Vali Acc: 0.472 Test Loss: 1.454 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8597161769866943
Epoch: 10, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.562 Vali Acc: 0.522 Test Loss: 1.562 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.455024242401123
Epoch: 11, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.707 Vali Acc: 0.461 Test Loss: 1.707 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 248322
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.030130386352539
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.733 Vali Acc: 0.533 Test Loss: 0.733 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.594470739364624
Epoch: 2, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.728 Vali Acc: 0.506 Test Loss: 0.728 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.378239631652832
Epoch: 3, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.762 Vali Acc: 0.544 Test Loss: 0.762 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.692291259765625
Epoch: 4, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.920 Vali Acc: 0.467 Test Loss: 0.920 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.49784255027771
Epoch: 5, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.903 Vali Acc: 0.506 Test Loss: 0.903 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7051949501037598
Epoch: 6, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.001 Vali Acc: 0.494 Test Loss: 1.001 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4682388305664062
Epoch: 7, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.101 Vali Acc: 0.483 Test Loss: 1.101 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7099559307098389
Epoch: 8, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.156 Vali Acc: 0.489 Test Loss: 1.156 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.483499526977539
Epoch: 9, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.292 Vali Acc: 0.533 Test Loss: 1.292 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.724073886871338
Epoch: 10, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.410 Vali Acc: 0.522 Test Loss: 1.410 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4806945323944092
Epoch: 11, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.508 Vali Acc: 0.478 Test Loss: 1.508 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7550749778747559
Epoch: 12, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.589 Vali Acc: 0.511 Test Loss: 1.589 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.458367109298706
Epoch: 13, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.757 Vali Acc: 0.483 Test Loss: 1.757 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 244866
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6689772605895996
Epoch: 1, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.709 Vali Acc: 0.533 Test Loss: 0.709 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.0439221858978271
Epoch: 2, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.708 Vali Acc: 0.600 Test Loss: 0.708 Test Acc: 0.600
Validation loss decreased (-0.533326 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 0.9823412895202637
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.748 Vali Acc: 0.533 Test Loss: 0.748 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1034204959869385
Epoch: 4, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.828 Vali Acc: 0.539 Test Loss: 0.828 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9243645668029785
Epoch: 5, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.876 Vali Acc: 0.511 Test Loss: 0.876 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8138861656188965
Epoch: 6, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.927 Vali Acc: 0.506 Test Loss: 0.927 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9619793891906738
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.013 Vali Acc: 0.539 Test Loss: 1.013 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8372855186462402
Epoch: 8, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.092 Vali Acc: 0.506 Test Loss: 1.092 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9133076667785645
Epoch: 9, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.203 Vali Acc: 0.528 Test Loss: 1.203 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9715466499328613
Epoch: 10, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.303 Vali Acc: 0.506 Test Loss: 1.303 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9898619651794434
Epoch: 11, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.314 Vali Acc: 0.478 Test Loss: 1.314 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9034056663513184
Epoch: 12, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.473 Vali Acc: 0.511 Test Loss: 1.473 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6
model parameter : 245122
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5854334831237793
Epoch: 1, Steps: 13 | Train Loss: 0.814 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.985008716583252
Epoch: 2, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.721 Vali Acc: 0.489 Test Loss: 0.721 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9174156188964844
Epoch: 3, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.760 Vali Acc: 0.522 Test Loss: 0.760 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.0346424579620361
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.788 Vali Acc: 0.517 Test Loss: 0.788 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9325253963470459
Epoch: 5, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8475115299224854
Epoch: 6, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.915 Vali Acc: 0.494 Test Loss: 0.915 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8869082927703857
Epoch: 7, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.967 Vali Acc: 0.506 Test Loss: 0.967 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8956542015075684
Epoch: 8, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.023 Vali Acc: 0.494 Test Loss: 1.023 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9900226593017578
Epoch: 9, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.085 Vali Acc: 0.517 Test Loss: 1.085 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9079859256744385
Epoch: 10, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.199 Vali Acc: 0.489 Test Loss: 1.199 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0040605068206787
Epoch: 11, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.320 Vali Acc: 0.494 Test Loss: 1.320 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8993055820465088
Epoch: 12, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.320 Vali Acc: 0.522 Test Loss: 1.320 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9858672618865967
Epoch: 13, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 250626
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.216459274291992
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.766 Vali Acc: 0.528 Test Loss: 0.766 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 1.7782845497131348
Epoch: 2, Steps: 13 | Train Loss: 0.710 Vali Loss: 1.131 Vali Acc: 0.528 Test Loss: 1.131 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6937639713287354
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 1.169 Vali Acc: 0.517 Test Loss: 1.169 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7383379936218262
Epoch: 4, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.432 Vali Acc: 0.511 Test Loss: 1.432 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6857309341430664
Epoch: 5, Steps: 13 | Train Loss: 0.280 Vali Loss: 2.887 Vali Acc: 0.489 Test Loss: 2.887 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6325225830078125
Epoch: 6, Steps: 13 | Train Loss: 0.675 Vali Loss: 2.019 Vali Acc: 0.467 Test Loss: 2.019 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.63533616065979
Epoch: 7, Steps: 13 | Train Loss: 0.282 Vali Loss: 2.408 Vali Acc: 0.489 Test Loss: 2.408 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.590848684310913
Epoch: 8, Steps: 13 | Train Loss: 0.376 Vali Loss: 2.859 Vali Acc: 0.483 Test Loss: 2.859 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5703132152557373
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 2.962 Vali Acc: 0.489 Test Loss: 2.962 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5924081802368164
Epoch: 10, Steps: 13 | Train Loss: 0.257 Vali Loss: 3.093 Vali Acc: 0.444 Test Loss: 3.093 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6685311794281006
Epoch: 11, Steps: 13 | Train Loss: 0.154 Vali Loss: 3.567 Vali Acc: 0.483 Test Loss: 3.567 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 306434
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2412936687469482
Epoch: 1, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.738 Vali Acc: 0.472 Test Loss: 0.738 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.6257269382476807
Epoch: 2, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
Validation loss decreased (-0.472215 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.816687822341919
Epoch: 3, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.937 Vali Acc: 0.528 Test Loss: 0.937 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527768).  Saving model ...
Epoch: 4 cost time: 1.6356918811798096
Epoch: 4, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.188 Vali Acc: 0.533 Test Loss: 1.188 Test Acc: 0.533
Validation loss decreased (-0.527768 --> -0.533321).  Saving model ...
Epoch: 5 cost time: 1.6637966632843018
Epoch: 5, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.318 Vali Acc: 0.472 Test Loss: 1.318 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7561354637145996
Epoch: 6, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.378 Vali Acc: 0.483 Test Loss: 1.378 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.558035135269165
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.661 Vali Acc: 0.500 Test Loss: 1.661 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6767675876617432
Epoch: 8, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.883 Vali Acc: 0.506 Test Loss: 1.883 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6327159404754639
Epoch: 9, Steps: 13 | Train Loss: 0.371 Vali Loss: 2.355 Vali Acc: 0.517 Test Loss: 2.355 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.56425142288208
Epoch: 10, Steps: 13 | Train Loss: 0.359 Vali Loss: 2.437 Vali Acc: 0.506 Test Loss: 2.437 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6911931037902832
Epoch: 11, Steps: 13 | Train Loss: 0.266 Vali Loss: 2.318 Vali Acc: 0.494 Test Loss: 2.318 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5972936153411865
Epoch: 12, Steps: 13 | Train Loss: 0.198 Vali Loss: 2.720 Vali Acc: 0.478 Test Loss: 2.720 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5556902885437012
Epoch: 13, Steps: 13 | Train Loss: 0.248 Vali Loss: 2.710 Vali Acc: 0.489 Test Loss: 2.710 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6270561218261719
Epoch: 14, Steps: 13 | Train Loss: 0.145 Vali Loss: 2.907 Vali Acc: 0.478 Test Loss: 2.907 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 243842
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.956472396850586
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.5478906631469727
Epoch: 2, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.783 Vali Acc: 0.517 Test Loss: 0.783 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.4784059524536133
Epoch: 3, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.865 Vali Acc: 0.478 Test Loss: 0.865 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.606372356414795
Epoch: 4, Steps: 13 | Train Loss: 0.484 Vali Loss: 1.041 Vali Acc: 0.511 Test Loss: 1.041 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.382117509841919
Epoch: 5, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8966693878173828
Epoch: 6, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.287 Vali Acc: 0.522 Test Loss: 1.287 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522209).  Saving model ...
Epoch: 7 cost time: 1.3952257633209229
Epoch: 7, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.399 Vali Acc: 0.483 Test Loss: 1.399 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4117205142974854
Epoch: 8, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.715 Vali Acc: 0.478 Test Loss: 1.715 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.634997844696045
Epoch: 9, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.644 Vali Acc: 0.511 Test Loss: 1.644 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5213465690612793
Epoch: 10, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.840 Vali Acc: 0.500 Test Loss: 1.840 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5958821773529053
Epoch: 11, Steps: 13 | Train Loss: 0.243 Vali Loss: 2.065 Vali Acc: 0.522 Test Loss: 2.065 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5721049308776855
Epoch: 12, Steps: 13 | Train Loss: 0.174 Vali Loss: 2.273 Vali Acc: 0.467 Test Loss: 2.273 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4740898609161377
Epoch: 13, Steps: 13 | Train Loss: 0.208 Vali Loss: 2.387 Vali Acc: 0.467 Test Loss: 2.387 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.593003749847412
Epoch: 14, Steps: 13 | Train Loss: 0.134 Vali Loss: 2.587 Vali Acc: 0.506 Test Loss: 2.587 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5945711135864258
Epoch: 15, Steps: 13 | Train Loss: 0.136 Vali Loss: 2.827 Vali Acc: 0.483 Test Loss: 2.827 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.468219518661499
Epoch: 16, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.885 Vali Acc: 0.478 Test Loss: 2.885 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 224258
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.226919412612915
Epoch: 1, Steps: 13 | Train Loss: 0.798 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3640692234039307
Epoch: 2, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.755 Vali Acc: 0.528 Test Loss: 0.755 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.4827880859375
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.801 Vali Acc: 0.522 Test Loss: 0.801 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5512573719024658
Epoch: 4, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.865 Vali Acc: 0.528 Test Loss: 0.865 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.478006362915039
Epoch: 5, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.995 Vali Acc: 0.500 Test Loss: 0.995 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4814441204071045
Epoch: 6, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.121 Vali Acc: 0.506 Test Loss: 1.121 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4747505187988281
Epoch: 7, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.193 Vali Acc: 0.494 Test Loss: 1.193 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2817716598510742
Epoch: 8, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.363 Vali Acc: 0.517 Test Loss: 1.363 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5784084796905518
Epoch: 9, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.454 Vali Acc: 0.528 Test Loss: 1.454 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9350779056549072
Epoch: 10, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.456 Vali Acc: 0.478 Test Loss: 1.456 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9162354469299316
Epoch: 11, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.662 Vali Acc: 0.483 Test Loss: 1.662 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8265364170074463
Epoch: 12, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.916 Vali Acc: 0.500 Test Loss: 1.916 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 215426
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.496272563934326
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.869093656539917
Epoch: 2, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.747 Vali Acc: 0.489 Test Loss: 0.747 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.89670729637146
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.792 Vali Acc: 0.528 Test Loss: 0.792 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 1.6005330085754395
Epoch: 4, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9575014114379883
Epoch: 5, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.908 Vali Acc: 0.511 Test Loss: 0.908 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9201023578643799
Epoch: 6, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.028 Vali Acc: 0.500 Test Loss: 1.028 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9067652225494385
Epoch: 7, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.080 Vali Acc: 0.483 Test Loss: 1.080 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4897897243499756
Epoch: 8, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.157 Vali Acc: 0.489 Test Loss: 1.157 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8751716613769531
Epoch: 9, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.233 Vali Acc: 0.494 Test Loss: 1.233 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.945303201675415
Epoch: 10, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.362 Vali Acc: 0.500 Test Loss: 1.362 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.695974349975586
Epoch: 11, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6899714469909668
Epoch: 12, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.693 Vali Acc: 0.500 Test Loss: 1.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.820831537246704
Epoch: 13, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.598 Vali Acc: 0.522 Test Loss: 1.598 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 211970
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4362571239471436
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.737 Vali Acc: 0.517 Test Loss: 0.737 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 0.9004676342010498
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.749 Vali Acc: 0.511 Test Loss: 0.749 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0953950881958008
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.781 Vali Acc: 0.511 Test Loss: 0.781 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.077425479888916
Epoch: 4, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.818 Vali Acc: 0.489 Test Loss: 0.818 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0499539375305176
Epoch: 5, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.913 Vali Acc: 0.511 Test Loss: 0.913 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.846879243850708
Epoch: 6, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.004 Vali Acc: 0.494 Test Loss: 1.004 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9257538318634033
Epoch: 7, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.050 Vali Acc: 0.511 Test Loss: 1.050 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.044299840927124
Epoch: 8, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.122 Vali Acc: 0.511 Test Loss: 1.122 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.103484869003296
Epoch: 9, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.201 Vali Acc: 0.511 Test Loss: 1.201 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.060814380645752
Epoch: 10, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.264 Vali Acc: 0.511 Test Loss: 1.264 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0744249820709229
Epoch: 11, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.419 Vali Acc: 0.511 Test Loss: 1.419 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 212226
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.450247287750244
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.721 Vali Acc: 0.522 Test Loss: 0.721 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.0772969722747803
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.744 Vali Acc: 0.533 Test Loss: 0.744 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.0384654998779297
Epoch: 3, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.790 Vali Acc: 0.533 Test Loss: 0.790 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1426172256469727
Epoch: 4, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.831 Vali Acc: 0.539 Test Loss: 0.831 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538881).  Saving model ...
Epoch: 5 cost time: 1.0684359073638916
Epoch: 5, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.906 Vali Acc: 0.494 Test Loss: 0.906 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.122636079788208
Epoch: 6, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.933 Vali Acc: 0.522 Test Loss: 0.933 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0881052017211914
Epoch: 7, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.006 Vali Acc: 0.517 Test Loss: 1.006 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0058305263519287
Epoch: 8, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.091 Vali Acc: 0.506 Test Loss: 1.091 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.015521764755249
Epoch: 9, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.141 Vali Acc: 0.528 Test Loss: 1.141 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8988211154937744
Epoch: 10, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.218 Vali Acc: 0.506 Test Loss: 1.218 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9564850330352783
Epoch: 11, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.822512149810791
Epoch: 12, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.395 Vali Acc: 0.522 Test Loss: 1.395 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8999392986297607
Epoch: 13, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.552 Vali Acc: 0.494 Test Loss: 1.552 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8909189701080322
Epoch: 14, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.640 Vali Acc: 0.494 Test Loss: 1.640 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm128_nh16_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 217730
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.187598705291748
Epoch: 1, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.738 Vali Acc: 0.539 Test Loss: 0.738 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.956235408782959
Epoch: 2, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.879 Vali Acc: 0.489 Test Loss: 0.879 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6147780418395996
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.883 Vali Acc: 0.494 Test Loss: 0.883 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8848679065704346
Epoch: 4, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.075 Vali Acc: 0.489 Test Loss: 1.075 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4894983768463135
Epoch: 5, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.193 Vali Acc: 0.456 Test Loss: 1.193 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8158886432647705
Epoch: 6, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.416 Vali Acc: 0.478 Test Loss: 1.416 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.739591121673584
Epoch: 7, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.526 Vali Acc: 0.511 Test Loss: 1.526 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.871361494064331
Epoch: 8, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.773 Vali Acc: 0.444 Test Loss: 1.773 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7193191051483154
Epoch: 9, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.885 Vali Acc: 0.489 Test Loss: 1.885 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9604780673980713
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 2.048 Vali Acc: 0.500 Test Loss: 2.048 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7086665630340576
Epoch: 11, Steps: 13 | Train Loss: 0.138 Vali Loss: 2.387 Vali Acc: 0.489 Test Loss: 2.387 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 170050
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.593444585800171
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.781 Vali Acc: 0.506 Test Loss: 0.781 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.5371508598327637
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.745 Vali Acc: 0.522 Test Loss: 0.745 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 2.0900354385375977
Epoch: 3, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.799 Vali Acc: 0.506 Test Loss: 0.799 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6552472114562988
Epoch: 4, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.869 Vali Acc: 0.517 Test Loss: 0.869 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7109949588775635
Epoch: 5, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.966 Vali Acc: 0.500 Test Loss: 0.966 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5864176750183105
Epoch: 6, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.185 Vali Acc: 0.517 Test Loss: 1.185 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5788469314575195
Epoch: 7, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.195 Vali Acc: 0.483 Test Loss: 1.195 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8833425045013428
Epoch: 8, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.303 Vali Acc: 0.478 Test Loss: 1.303 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7395999431610107
Epoch: 9, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.421 Vali Acc: 0.478 Test Loss: 1.421 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0065219402313232
Epoch: 10, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.754 Vali Acc: 0.467 Test Loss: 1.754 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6057288646697998
Epoch: 11, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.676 Vali Acc: 0.472 Test Loss: 1.676 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.758026123046875
Epoch: 12, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.782 Vali Acc: 0.494 Test Loss: 1.782 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 138754
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2287344932556152
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.701 Vali Acc: 0.506 Test Loss: 0.701 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 1.5022718906402588
Epoch: 2, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.731 Vali Acc: 0.544 Test Loss: 0.731 Test Acc: 0.544
Validation loss decreased (-0.505549 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.702322006225586
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.802 Vali Acc: 0.517 Test Loss: 0.802 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5295333862304688
Epoch: 4, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.817 Vali Acc: 0.511 Test Loss: 0.817 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7513489723205566
Epoch: 5, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.889 Vali Acc: 0.522 Test Loss: 0.889 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5741162300109863
Epoch: 6, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.000 Vali Acc: 0.506 Test Loss: 1.000 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.771134614944458
Epoch: 7, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6552138328552246
Epoch: 8, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.195 Vali Acc: 0.494 Test Loss: 1.195 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6924479007720947
Epoch: 9, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.222 Vali Acc: 0.506 Test Loss: 1.222 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.71722412109375
Epoch: 10, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.392 Vali Acc: 0.522 Test Loss: 1.392 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6879966259002686
Epoch: 11, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.389 Vali Acc: 0.483 Test Loss: 1.389 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.366396188735962
Epoch: 12, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.577 Vali Acc: 0.489 Test Loss: 1.577 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 128962
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.716282367706299
Epoch: 1, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.721 Vali Acc: 0.533 Test Loss: 0.721 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.62198805809021
Epoch: 2, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.722 Vali Acc: 0.567 Test Loss: 0.722 Test Acc: 0.567
Validation loss decreased (-0.533326 --> -0.566659).  Saving model ...
Epoch: 3 cost time: 1.702223539352417
Epoch: 3, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.743 Vali Acc: 0.533 Test Loss: 0.743 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8321032524108887
Epoch: 4, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.795 Vali Acc: 0.528 Test Loss: 0.795 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7590999603271484
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.837 Vali Acc: 0.522 Test Loss: 0.837 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5313119888305664
Epoch: 6, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.911 Vali Acc: 0.517 Test Loss: 0.911 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7740600109100342
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.986 Vali Acc: 0.511 Test Loss: 0.986 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6624932289123535
Epoch: 8, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.019 Vali Acc: 0.489 Test Loss: 1.019 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.619488000869751
Epoch: 9, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.134 Vali Acc: 0.517 Test Loss: 1.134 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.596064805984497
Epoch: 10, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.170 Vali Acc: 0.489 Test Loss: 1.170 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8047869205474854
Epoch: 11, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.284 Vali Acc: 0.506 Test Loss: 1.284 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6352171897888184
Epoch: 12, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.378 Vali Acc: 0.506 Test Loss: 1.378 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 124546
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.669041156768799
Epoch: 1, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.718 Vali Acc: 0.544 Test Loss: 0.718 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 0.9591059684753418
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.0194580554962158
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1233952045440674
Epoch: 4, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.747 Vali Acc: 0.539 Test Loss: 0.747 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9938492774963379
Epoch: 5, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.769 Vali Acc: 0.517 Test Loss: 0.769 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1131649017333984
Epoch: 6, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.813 Vali Acc: 0.489 Test Loss: 0.813 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9610879421234131
Epoch: 7, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.854 Vali Acc: 0.533 Test Loss: 0.854 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.028714895248413
Epoch: 8, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.920 Vali Acc: 0.489 Test Loss: 0.920 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1375257968902588
Epoch: 9, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.999 Vali Acc: 0.506 Test Loss: 0.999 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9864294528961182
Epoch: 10, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.023 Vali Acc: 0.494 Test Loss: 1.023 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9389643669128418
Epoch: 11, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.129 Vali Acc: 0.506 Test Loss: 1.129 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9528360366821289
Epoch: 12, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 122818
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.692781925201416
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.776 Vali Acc: 0.511 Test Loss: 0.776 Test Acc: 0.511
Validation loss decreased (inf --> -0.511103).  Saving model ...
Epoch: 2 cost time: 0.9776034355163574
Epoch: 2, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.762 Vali Acc: 0.522 Test Loss: 0.762 Test Acc: 0.522
Validation loss decreased (-0.511103 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 0.9670281410217285
Epoch: 3, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.768 Vali Acc: 0.517 Test Loss: 0.768 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9563853740692139
Epoch: 4, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.779 Vali Acc: 0.511 Test Loss: 0.779 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0109732151031494
Epoch: 5, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.824 Vali Acc: 0.461 Test Loss: 0.824 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9589636325836182
Epoch: 6, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.855 Vali Acc: 0.506 Test Loss: 0.855 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.031569242477417
Epoch: 7, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.903 Vali Acc: 0.489 Test Loss: 0.903 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9726426601409912
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.968 Vali Acc: 0.489 Test Loss: 0.968 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1493051052093506
Epoch: 9, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.027 Vali Acc: 0.489 Test Loss: 1.027 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9432554244995117
Epoch: 10, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0022192001342773
Epoch: 11, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0925829410552979
Epoch: 12, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.210 Vali Acc: 0.522 Test Loss: 1.210 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 122946
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6372125148773193
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.746 Vali Acc: 0.483 Test Loss: 0.746 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 0.9112200736999512
Epoch: 2, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.746 Vali Acc: 0.483 Test Loss: 0.746 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.954883337020874
Epoch: 3, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.747 Vali Acc: 0.517 Test Loss: 0.747 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 0.8570256233215332
Epoch: 4, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.765 Vali Acc: 0.511 Test Loss: 0.765 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9978053569793701
Epoch: 5, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.790 Vali Acc: 0.489 Test Loss: 0.790 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9385032653808594
Epoch: 6, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.817 Vali Acc: 0.478 Test Loss: 0.817 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0069856643676758
Epoch: 7, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.829 Vali Acc: 0.494 Test Loss: 0.829 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.917161226272583
Epoch: 8, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9542477130889893
Epoch: 9, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.929 Vali Acc: 0.472 Test Loss: 0.929 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9585201740264893
Epoch: 10, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.982 Vali Acc: 0.489 Test Loss: 0.982 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9683566093444824
Epoch: 11, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9809854030609131
Epoch: 12, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.068 Vali Acc: 0.506 Test Loss: 1.068 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.941709041595459
Epoch: 13, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.097 Vali Acc: 0.483 Test Loss: 1.097 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 125698
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2937586307525635
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 1.3802664279937744
Epoch: 2, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.799 Vali Acc: 0.528 Test Loss: 0.799 Test Acc: 0.528
Validation loss decreased (-0.449992 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.4182140827178955
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 1.022 Vali Acc: 0.483 Test Loss: 1.022 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6044304370880127
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4439687728881836
Epoch: 5, Steps: 13 | Train Loss: 0.494 Vali Loss: 1.179 Vali Acc: 0.506 Test Loss: 1.179 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4487509727478027
Epoch: 6, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.397 Vali Acc: 0.467 Test Loss: 1.397 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5871367454528809
Epoch: 7, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.465 Vali Acc: 0.478 Test Loss: 1.465 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4319849014282227
Epoch: 8, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.652 Vali Acc: 0.467 Test Loss: 1.652 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4159038066864014
Epoch: 9, Steps: 13 | Train Loss: 0.365 Vali Loss: 2.138 Vali Acc: 0.467 Test Loss: 2.138 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.517874002456665
Epoch: 10, Steps: 13 | Train Loss: 0.282 Vali Loss: 2.169 Vali Acc: 0.450 Test Loss: 2.169 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3346781730651855
Epoch: 11, Steps: 13 | Train Loss: 0.250 Vali Loss: 2.415 Vali Acc: 0.444 Test Loss: 2.415 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.391270637512207
Epoch: 12, Steps: 13 | Train Loss: 0.185 Vali Loss: 2.645 Vali Acc: 0.444 Test Loss: 2.645 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 137026
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.150177240371704
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.742 Vali Acc: 0.539 Test Loss: 0.742 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 1.2968406677246094
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.736 Vali Acc: 0.522 Test Loss: 0.736 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6289961338043213
Epoch: 3, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.842 Vali Acc: 0.522 Test Loss: 0.842 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4506306648254395
Epoch: 4, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.862 Vali Acc: 0.511 Test Loss: 0.862 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.493318796157837
Epoch: 5, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.030 Vali Acc: 0.478 Test Loss: 1.030 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.580601453781128
Epoch: 6, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.084 Vali Acc: 0.483 Test Loss: 1.084 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4479663372039795
Epoch: 7, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.347 Vali Acc: 0.506 Test Loss: 1.347 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5027384757995605
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.309 Vali Acc: 0.456 Test Loss: 1.309 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8373527526855469
Epoch: 9, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.494 Vali Acc: 0.489 Test Loss: 1.494 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4817886352539062
Epoch: 10, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.575 Vali Acc: 0.489 Test Loss: 1.575 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6053459644317627
Epoch: 11, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.739 Vali Acc: 0.489 Test Loss: 1.739 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 105730
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8144943714141846
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.715 Vali Acc: 0.544 Test Loss: 0.715 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.6002955436706543
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.737 Vali Acc: 0.561 Test Loss: 0.737 Test Acc: 0.561
Validation loss decreased (-0.544437 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 1.482384443283081
Epoch: 3, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.764 Vali Acc: 0.528 Test Loss: 0.764 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.532041311264038
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.807 Vali Acc: 0.528 Test Loss: 0.807 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.497614860534668
Epoch: 5, Steps: 13 | Train Loss: 0.517 Vali Loss: 1.043 Vali Acc: 0.528 Test Loss: 1.043 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1544101238250732
Epoch: 6, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.951 Vali Acc: 0.522 Test Loss: 0.951 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.428194522857666
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.014 Vali Acc: 0.489 Test Loss: 1.014 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2654430866241455
Epoch: 8, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.111 Vali Acc: 0.522 Test Loss: 1.111 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4069783687591553
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.238 Vali Acc: 0.511 Test Loss: 1.238 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.332885503768921
Epoch: 10, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.362 Vali Acc: 0.528 Test Loss: 1.362 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3735408782958984
Epoch: 11, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.381 Vali Acc: 0.489 Test Loss: 1.381 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4077653884887695
Epoch: 12, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.524 Vali Acc: 0.506 Test Loss: 1.524 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 95938
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.091320753097534
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3674161434173584
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.734 Vali Acc: 0.511 Test Loss: 0.734 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.4878699779510498
Epoch: 3, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.763 Vali Acc: 0.506 Test Loss: 0.763 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6433672904968262
Epoch: 4, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.783 Vali Acc: 0.494 Test Loss: 0.783 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4856550693511963
Epoch: 5, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.850 Vali Acc: 0.500 Test Loss: 0.850 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5624232292175293
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.891 Vali Acc: 0.489 Test Loss: 0.891 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7265057563781738
Epoch: 7, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.924 Vali Acc: 0.489 Test Loss: 0.924 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5400526523590088
Epoch: 8, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.052 Vali Acc: 0.511 Test Loss: 1.052 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3964228630065918
Epoch: 9, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.068 Vali Acc: 0.489 Test Loss: 1.068 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4426891803741455
Epoch: 10, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.176 Vali Acc: 0.506 Test Loss: 1.176 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3950402736663818
Epoch: 11, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.259 Vali Acc: 0.533 Test Loss: 1.259 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533321).  Saving model ...
Epoch: 12 cost time: 1.5701541900634766
Epoch: 12, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.270 Vali Acc: 0.489 Test Loss: 1.270 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3034231662750244
Epoch: 13, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.384 Vali Acc: 0.489 Test Loss: 1.384 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3505473136901855
Epoch: 14, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.488 Vali Acc: 0.506 Test Loss: 1.488 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3164210319519043
Epoch: 15, Steps: 13 | Train Loss: 0.226 Vali Loss: 1.533 Vali Acc: 0.467 Test Loss: 1.533 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.321836233139038
Epoch: 16, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.617 Vali Acc: 0.489 Test Loss: 1.617 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6827120780944824
Epoch: 17, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.657 Vali Acc: 0.472 Test Loss: 1.657 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3868482112884521
Epoch: 18, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.785 Vali Acc: 0.489 Test Loss: 1.785 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.30387282371521
Epoch: 19, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.917 Vali Acc: 0.478 Test Loss: 1.917 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4139866828918457
Epoch: 20, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.031 Vali Acc: 0.483 Test Loss: 2.031 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2606532573699951
Epoch: 21, Steps: 13 | Train Loss: 0.115 Vali Loss: 2.058 Vali Acc: 0.489 Test Loss: 2.058 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 91522
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7734920978546143
Epoch: 1, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.762 Vali Acc: 0.478 Test Loss: 0.762 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 0.8670849800109863
Epoch: 2, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.765 Vali Acc: 0.517 Test Loss: 0.765 Test Acc: 0.517
Validation loss decreased (-0.477770 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 0.9434125423431396
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.754 Vali Acc: 0.522 Test Loss: 0.754 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.0142550468444824
Epoch: 4, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.789 Vali Acc: 0.533 Test Loss: 0.789 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533325).  Saving model ...
Epoch: 5 cost time: 0.867473840713501
Epoch: 5, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.795 Vali Acc: 0.494 Test Loss: 0.795 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9648227691650391
Epoch: 6, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.98150634765625
Epoch: 7, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.948 Vali Acc: 0.494 Test Loss: 0.948 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9087700843811035
Epoch: 8, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.956 Vali Acc: 0.478 Test Loss: 0.956 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.985344409942627
Epoch: 9, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.037 Vali Acc: 0.478 Test Loss: 1.037 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9537045955657959
Epoch: 10, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.070 Vali Acc: 0.522 Test Loss: 1.070 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1089627742767334
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.124 Vali Acc: 0.494 Test Loss: 1.124 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2490527629852295
Epoch: 12, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.216 Vali Acc: 0.506 Test Loss: 1.216 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0820894241333008
Epoch: 13, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.252 Vali Acc: 0.478 Test Loss: 1.252 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0506482124328613
Epoch: 14, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.347 Vali Acc: 0.494 Test Loss: 1.347 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 89794
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7367587089538574
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.723 Vali Acc: 0.544 Test Loss: 0.723 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.0670533180236816
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.063544511795044
Epoch: 3, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.719 Vali Acc: 0.528 Test Loss: 0.719 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9630343914031982
Epoch: 4, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.737 Vali Acc: 0.539 Test Loss: 0.737 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0203273296356201
Epoch: 5, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.762 Vali Acc: 0.544 Test Loss: 0.762 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0723578929901123
Epoch: 6, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.808 Vali Acc: 0.517 Test Loss: 0.808 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1391699314117432
Epoch: 7, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.845 Vali Acc: 0.517 Test Loss: 0.845 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2359905242919922
Epoch: 8, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.907 Vali Acc: 0.511 Test Loss: 0.907 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0614171028137207
Epoch: 9, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.954 Vali Acc: 0.494 Test Loss: 0.954 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0755274295806885
Epoch: 10, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1392560005187988
Epoch: 11, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.052776575088501
Epoch: 12, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.084 Vali Acc: 0.494 Test Loss: 1.084 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 89922
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8173913955688477
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.698 Vali Acc: 0.572 Test Loss: 0.698 Test Acc: 0.572
Validation loss decreased (inf --> -0.572215).  Saving model ...
Epoch: 2 cost time: 1.0900447368621826
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.689 Vali Acc: 0.556 Test Loss: 0.689 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.207650899887085
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.679 Vali Acc: 0.539 Test Loss: 0.679 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1467678546905518
Epoch: 4, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.703 Vali Acc: 0.572 Test Loss: 0.703 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0566740036010742
Epoch: 5, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.722 Vali Acc: 0.528 Test Loss: 0.722 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9960999488830566
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.766 Vali Acc: 0.533 Test Loss: 0.766 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9148728847503662
Epoch: 7, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.764 Vali Acc: 0.528 Test Loss: 0.764 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9854640960693359
Epoch: 8, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.842 Vali Acc: 0.522 Test Loss: 0.842 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9792008399963379
Epoch: 9, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.854 Vali Acc: 0.522 Test Loss: 0.854 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.024707317352295
Epoch: 10, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.938 Vali Acc: 0.517 Test Loss: 0.938 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0081079006195068
Epoch: 11, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.937 Vali Acc: 0.533 Test Loss: 0.937 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 92674
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.1781907081604
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.737 Vali Acc: 0.472 Test Loss: 0.737 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 2.1568827629089355
Epoch: 2, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.837 Vali Acc: 0.489 Test Loss: 0.837 Test Acc: 0.489
Validation loss decreased (-0.472215 --> -0.488881).  Saving model ...
Epoch: 3 cost time: 2.2200422286987305
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
Validation loss decreased (-0.488881 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 2.138953447341919
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.203 Vali Acc: 0.489 Test Loss: 1.203 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3155691623687744
Epoch: 5, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.186 Vali Acc: 0.478 Test Loss: 1.186 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7844252586364746
Epoch: 6, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.405 Vali Acc: 0.489 Test Loss: 1.405 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0484275817871094
Epoch: 7, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.584 Vali Acc: 0.450 Test Loss: 1.584 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.502547264099121
Epoch: 8, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.708 Vali Acc: 0.456 Test Loss: 1.708 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6292405128479004
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.729 Vali Acc: 0.489 Test Loss: 1.729 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6315078735351562
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 2.065 Vali Acc: 0.533 Test Loss: 2.065 Test Acc: 0.533
Validation loss decreased (-0.499991 --> -0.533313).  Saving model ...
Epoch: 11 cost time: 1.633955478668213
Epoch: 11, Steps: 13 | Train Loss: 0.178 Vali Loss: 2.405 Vali Acc: 0.483 Test Loss: 2.405 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6480169296264648
Epoch: 12, Steps: 13 | Train Loss: 0.306 Vali Loss: 2.992 Vali Acc: 0.472 Test Loss: 2.992 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5722262859344482
Epoch: 13, Steps: 13 | Train Loss: 0.270 Vali Loss: 2.934 Vali Acc: 0.511 Test Loss: 2.934 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.613779067993164
Epoch: 14, Steps: 13 | Train Loss: 0.337 Vali Loss: 3.027 Vali Acc: 0.517 Test Loss: 3.027 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7108643054962158
Epoch: 15, Steps: 13 | Train Loss: 0.197 Vali Loss: 3.232 Vali Acc: 0.478 Test Loss: 3.232 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0986180305480957
Epoch: 16, Steps: 13 | Train Loss: 0.146 Vali Loss: 3.522 Vali Acc: 0.489 Test Loss: 3.522 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.815828561782837
Epoch: 17, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.371 Vali Acc: 0.461 Test Loss: 3.371 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1212003231048584
Epoch: 18, Steps: 13 | Train Loss: 0.034 Vali Loss: 3.746 Vali Acc: 0.489 Test Loss: 3.746 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8126335144042969
Epoch: 19, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.808 Vali Acc: 0.483 Test Loss: 3.808 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0414927005767822
Epoch: 20, Steps: 13 | Train Loss: 0.038 Vali Loss: 4.226 Vali Acc: 0.472 Test Loss: 4.226 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 120514
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4649007320404053
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.719 Vali Acc: 0.522 Test Loss: 0.719 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.4601805210113525
Epoch: 2, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.748 Vali Acc: 0.489 Test Loss: 0.748 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8315815925598145
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.797 Vali Acc: 0.506 Test Loss: 0.797 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4968318939208984
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.891 Vali Acc: 0.483 Test Loss: 0.891 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6430308818817139
Epoch: 5, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.956 Vali Acc: 0.483 Test Loss: 0.956 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3684332370758057
Epoch: 6, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.106 Vali Acc: 0.478 Test Loss: 1.106 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2308738231658936
Epoch: 7, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6985445022583008
Epoch: 8, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2544081211090088
Epoch: 9, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.405 Vali Acc: 0.461 Test Loss: 1.405 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.70621919631958
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.525 Vali Acc: 0.478 Test Loss: 1.525 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1899609565734863
Epoch: 11, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.502 Vali Acc: 0.494 Test Loss: 1.502 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 89218
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1393628120422363
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.679 Vali Acc: 0.611 Test Loss: 0.679 Test Acc: 0.611
Validation loss decreased (inf --> -0.611104).  Saving model ...
Epoch: 2 cost time: 1.312122106552124
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.698 Vali Acc: 0.561 Test Loss: 0.698 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.63808274269104
Epoch: 3, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.736 Vali Acc: 0.561 Test Loss: 0.736 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4905688762664795
Epoch: 4, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.806 Vali Acc: 0.550 Test Loss: 0.806 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6757736206054688
Epoch: 5, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.903 Vali Acc: 0.556 Test Loss: 0.903 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.391601324081421
Epoch: 6, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.920 Vali Acc: 0.539 Test Loss: 0.920 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7470266819000244
Epoch: 7, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4950661659240723
Epoch: 8, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.100 Vali Acc: 0.461 Test Loss: 1.100 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6832993030548096
Epoch: 9, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.182 Vali Acc: 0.494 Test Loss: 1.182 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.594210147857666
Epoch: 10, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.280 Vali Acc: 0.539 Test Loss: 1.280 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6966142654418945
Epoch: 11, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.552 Vali Acc: 0.528 Test Loss: 1.552 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6111111111111112
model parameter : 79426
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2307207584381104
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.764 Vali Acc: 0.433 Test Loss: 0.764 Test Acc: 0.433
Validation loss decreased (inf --> -0.433326).  Saving model ...
Epoch: 2 cost time: 1.6770305633544922
Epoch: 2, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.783 Vali Acc: 0.461 Test Loss: 0.783 Test Acc: 0.461
Validation loss decreased (-0.433326 --> -0.461103).  Saving model ...
Epoch: 3 cost time: 1.4321856498718262
Epoch: 3, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.794 Vali Acc: 0.467 Test Loss: 0.794 Test Acc: 0.467
Validation loss decreased (-0.461103 --> -0.466659).  Saving model ...
Epoch: 4 cost time: 1.3905773162841797
Epoch: 4, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.844 Vali Acc: 0.439 Test Loss: 0.844 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3222200870513916
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.870 Vali Acc: 0.522 Test Loss: 0.870 Test Acc: 0.522
Validation loss decreased (-0.466659 --> -0.522214).  Saving model ...
Epoch: 6 cost time: 1.4114151000976562
Epoch: 6, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.941 Vali Acc: 0.489 Test Loss: 0.941 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3774826526641846
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.993 Vali Acc: 0.506 Test Loss: 0.993 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4280848503112793
Epoch: 8, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.041 Vali Acc: 0.494 Test Loss: 1.041 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3124721050262451
Epoch: 9, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.104 Vali Acc: 0.511 Test Loss: 1.104 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.336963415145874
Epoch: 10, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.186 Vali Acc: 0.511 Test Loss: 1.186 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.333850383758545
Epoch: 11, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.279 Vali Acc: 0.506 Test Loss: 1.279 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2480018138885498
Epoch: 12, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.352 Vali Acc: 0.489 Test Loss: 1.352 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8269727230072021
Epoch: 13, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.387 Vali Acc: 0.489 Test Loss: 1.387 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.527773141860962
Epoch: 14, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.589 Vali Acc: 0.506 Test Loss: 1.589 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6016156673431396
Epoch: 15, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.551 Vali Acc: 0.461 Test Loss: 1.551 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 75010
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.729494333267212
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.722 Vali Acc: 0.556 Test Loss: 0.722 Test Acc: 0.556
Validation loss decreased (inf --> -0.555548).  Saving model ...
Epoch: 2 cost time: 0.860518217086792
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.702 Vali Acc: 0.522 Test Loss: 0.702 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0468122959136963
Epoch: 3, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.719 Vali Acc: 0.556 Test Loss: 0.719 Test Acc: 0.556
Validation loss decreased (-0.555548 --> -0.555548).  Saving model ...
Epoch: 4 cost time: 1.017897367477417
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.742 Vali Acc: 0.539 Test Loss: 0.742 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.987189769744873
Epoch: 5, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.775 Vali Acc: 0.528 Test Loss: 0.775 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1242499351501465
Epoch: 6, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.827 Vali Acc: 0.550 Test Loss: 0.827 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1796531677246094
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.849 Vali Acc: 0.511 Test Loss: 0.849 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1617140769958496
Epoch: 8, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.893 Vali Acc: 0.522 Test Loss: 0.893 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0344796180725098
Epoch: 9, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.964 Vali Acc: 0.500 Test Loss: 0.964 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.061838150024414
Epoch: 10, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.007 Vali Acc: 0.517 Test Loss: 1.007 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1553404331207275
Epoch: 11, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.060 Vali Acc: 0.506 Test Loss: 1.060 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9865317344665527
Epoch: 12, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9693551063537598
Epoch: 13, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.187 Vali Acc: 0.489 Test Loss: 1.187 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 73282
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.841317892074585
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.708 Vali Acc: 0.539 Test Loss: 0.708 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 0.8491089344024658
Epoch: 2, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.704 Vali Acc: 0.578 Test Loss: 0.704 Test Acc: 0.578
Validation loss decreased (-0.538882 --> -0.577771).  Saving model ...
Epoch: 3 cost time: 0.9530172348022461
Epoch: 3, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.713 Vali Acc: 0.589 Test Loss: 0.713 Test Acc: 0.589
Validation loss decreased (-0.577771 --> -0.588882).  Saving model ...
Epoch: 4 cost time: 0.9217126369476318
Epoch: 4, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.722 Vali Acc: 0.528 Test Loss: 0.722 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9281606674194336
Epoch: 5, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.756 Vali Acc: 0.528 Test Loss: 0.756 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9766411781311035
Epoch: 6, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.788 Vali Acc: 0.472 Test Loss: 0.788 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9527995586395264
Epoch: 7, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.831 Vali Acc: 0.483 Test Loss: 0.831 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0849781036376953
Epoch: 8, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.879 Vali Acc: 0.478 Test Loss: 0.879 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.940680980682373
Epoch: 9, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.913 Vali Acc: 0.472 Test Loss: 0.913 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1239731311798096
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.955 Vali Acc: 0.500 Test Loss: 0.955 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.871330738067627
Epoch: 11, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.021 Vali Acc: 0.461 Test Loss: 1.021 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9756805896759033
Epoch: 12, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.050 Vali Acc: 0.500 Test Loss: 1.050 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9586203098297119
Epoch: 13, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.117 Vali Acc: 0.472 Test Loss: 1.117 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 73410
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8436152935028076
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.742 Vali Acc: 0.539 Test Loss: 0.742 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 1.008044719696045
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.722 Vali Acc: 0.561 Test Loss: 0.722 Test Acc: 0.561
Validation loss decreased (-0.538881 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 0.8952558040618896
Epoch: 3, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.720 Vali Acc: 0.522 Test Loss: 0.720 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0540122985839844
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.736 Vali Acc: 0.456 Test Loss: 0.736 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9800567626953125
Epoch: 5, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1033391952514648
Epoch: 6, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.807 Vali Acc: 0.461 Test Loss: 0.807 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9184036254882812
Epoch: 7, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.817 Vali Acc: 0.472 Test Loss: 0.817 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9626948833465576
Epoch: 8, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9877920150756836
Epoch: 9, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.909 Vali Acc: 0.494 Test Loss: 0.909 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9413876533508301
Epoch: 10, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.963 Vali Acc: 0.506 Test Loss: 0.963 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.955219030380249
Epoch: 11, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.994 Vali Acc: 0.506 Test Loss: 0.994 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0237658023834229
Epoch: 12, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.056 Vali Acc: 0.489 Test Loss: 1.056 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm64_nh16_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 76162
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1333484649658203
Epoch: 1, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.776 Vali Acc: 0.483 Test Loss: 0.776 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.1159374713897705
Epoch: 2, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.756 Vali Acc: 0.444 Test Loss: 0.756 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.269468069076538
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.764 Vali Acc: 0.483 Test Loss: 0.764 Test Acc: 0.483
Validation loss decreased (-0.483326 --> -0.483326).  Saving model ...
Epoch: 4 cost time: 1.2445080280303955
Epoch: 4, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.816 Vali Acc: 0.494 Test Loss: 0.816 Test Acc: 0.494
Validation loss decreased (-0.483326 --> -0.494436).  Saving model ...
Epoch: 5 cost time: 1.183833360671997
Epoch: 5, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.899 Vali Acc: 0.478 Test Loss: 0.899 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.240152359008789
Epoch: 6, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.055 Vali Acc: 0.461 Test Loss: 1.055 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.231544017791748
Epoch: 7, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.134 Vali Acc: 0.489 Test Loss: 1.134 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3307814598083496
Epoch: 8, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.285 Vali Acc: 0.489 Test Loss: 1.285 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2754037380218506
Epoch: 9, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.488 Vali Acc: 0.467 Test Loss: 1.488 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3532774448394775
Epoch: 10, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.541 Vali Acc: 0.478 Test Loss: 1.541 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3075127601623535
Epoch: 11, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.919 Vali Acc: 0.467 Test Loss: 1.919 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3825976848602295
Epoch: 12, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.882 Vali Acc: 0.472 Test Loss: 1.882 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.170839786529541
Epoch: 13, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.916 Vali Acc: 0.472 Test Loss: 1.916 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2537927627563477
Epoch: 14, Steps: 13 | Train Loss: 0.169 Vali Loss: 2.222 Vali Acc: 0.456 Test Loss: 2.222 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 77090
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.740658760070801
Epoch: 1, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.766 Vali Acc: 0.489 Test Loss: 0.766 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.3410577774047852
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.760 Vali Acc: 0.494 Test Loss: 0.760 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.397181510925293
Epoch: 3, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.769 Vali Acc: 0.472 Test Loss: 0.769 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4226362705230713
Epoch: 4, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.816 Vali Acc: 0.467 Test Loss: 0.816 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3510167598724365
Epoch: 5, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499991).  Saving model ...
Epoch: 6 cost time: 1.538459300994873
Epoch: 6, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.909 Vali Acc: 0.461 Test Loss: 0.909 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6130461692810059
Epoch: 7, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.952 Vali Acc: 0.461 Test Loss: 0.952 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.536097526550293
Epoch: 8, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.022 Vali Acc: 0.489 Test Loss: 1.022 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.384828805923462
Epoch: 9, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6499013900756836
Epoch: 10, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.288 Vali Acc: 0.511 Test Loss: 1.288 Test Acc: 0.511
Validation loss decreased (-0.499991 --> -0.511098).  Saving model ...
Epoch: 11 cost time: 1.522324800491333
Epoch: 11, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.214 Vali Acc: 0.467 Test Loss: 1.214 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.589447021484375
Epoch: 12, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.267 Vali Acc: 0.494 Test Loss: 1.267 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.685610055923462
Epoch: 13, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.504 Vali Acc: 0.539 Test Loss: 1.504 Test Acc: 0.539
Validation loss decreased (-0.511098 --> -0.538874).  Saving model ...
Epoch: 14 cost time: 1.4803647994995117
Epoch: 14, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.457 Vali Acc: 0.472 Test Loss: 1.457 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.630047082901001
Epoch: 15, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.554 Vali Acc: 0.467 Test Loss: 1.554 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6394352912902832
Epoch: 16, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.585 Vali Acc: 0.478 Test Loss: 1.585 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5792913436889648
Epoch: 17, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.732 Vali Acc: 0.517 Test Loss: 1.732 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8130841255187988
Epoch: 18, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.840 Vali Acc: 0.456 Test Loss: 1.840 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.645075798034668
Epoch: 19, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.842 Vali Acc: 0.472 Test Loss: 1.842 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.625582218170166
Epoch: 20, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.988 Vali Acc: 0.500 Test Loss: 1.988 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5519742965698242
Epoch: 21, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.986 Vali Acc: 0.444 Test Loss: 1.986 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5335750579833984
Epoch: 22, Steps: 13 | Train Loss: 0.102 Vali Loss: 2.180 Vali Acc: 0.450 Test Loss: 2.180 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6588919162750244
Epoch: 23, Steps: 13 | Train Loss: 0.097 Vali Loss: 2.193 Vali Acc: 0.461 Test Loss: 2.193 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 61442
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.893625259399414
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.112006664276123
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.712 Vali Acc: 0.517 Test Loss: 0.712 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 1.0742833614349365
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.085967779159546
Epoch: 4, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.731 Vali Acc: 0.533 Test Loss: 0.731 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 1.022057294845581
Epoch: 5, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.751 Vali Acc: 0.522 Test Loss: 0.751 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9639320373535156
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.779 Vali Acc: 0.533 Test Loss: 0.779 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9226102828979492
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.821 Vali Acc: 0.539 Test Loss: 0.821 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538881).  Saving model ...
Epoch: 8 cost time: 0.9819276332855225
Epoch: 8, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.854 Vali Acc: 0.517 Test Loss: 0.854 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1015093326568604
Epoch: 9, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.963 Vali Acc: 0.550 Test Loss: 0.963 Test Acc: 0.550
Validation loss decreased (-0.538881 --> -0.549990).  Saving model ...
Epoch: 10 cost time: 0.944293737411499
Epoch: 10, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.954 Vali Acc: 0.511 Test Loss: 0.954 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9963195323944092
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.026 Vali Acc: 0.522 Test Loss: 1.026 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.028449296951294
Epoch: 12, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.048 Vali Acc: 0.517 Test Loss: 1.048 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0074794292449951
Epoch: 13, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.226 Vali Acc: 0.522 Test Loss: 1.226 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.132861614227295
Epoch: 14, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.080244779586792
Epoch: 15, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.300 Vali Acc: 0.539 Test Loss: 1.300 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0881998538970947
Epoch: 16, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.325 Vali Acc: 0.517 Test Loss: 1.325 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0582165718078613
Epoch: 17, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.388 Vali Acc: 0.528 Test Loss: 1.388 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.008833646774292
Epoch: 18, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.429 Vali Acc: 0.517 Test Loss: 1.429 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9692726135253906
Epoch: 19, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.506 Vali Acc: 0.517 Test Loss: 1.506 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 56546
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7162370681762695
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.729 Vali Acc: 0.539 Test Loss: 0.729 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 0.9132630825042725
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.735 Vali Acc: 0.511 Test Loss: 0.735 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.959327220916748
Epoch: 3, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.734 Vali Acc: 0.511 Test Loss: 0.734 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9456582069396973
Epoch: 4, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.744 Vali Acc: 0.539 Test Loss: 0.744 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0734531879425049
Epoch: 5, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.784 Vali Acc: 0.506 Test Loss: 0.784 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.040553092956543
Epoch: 6, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.790 Vali Acc: 0.517 Test Loss: 0.790 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0288970470428467
Epoch: 7, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.834 Vali Acc: 0.522 Test Loss: 0.834 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.028766393661499
Epoch: 8, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.840 Vali Acc: 0.528 Test Loss: 0.840 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0724163055419922
Epoch: 9, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.917 Vali Acc: 0.511 Test Loss: 0.917 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9970250129699707
Epoch: 10, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.944580078125
Epoch: 11, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.045 Vali Acc: 0.511 Test Loss: 1.045 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 54338
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0215253829956055
Epoch: 1, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.770 Vali Acc: 0.422 Test Loss: 0.770 Test Acc: 0.422
Validation loss decreased (inf --> -0.422215).  Saving model ...
Epoch: 2 cost time: 1.0117955207824707
Epoch: 2, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.759 Vali Acc: 0.456 Test Loss: 0.759 Test Acc: 0.456
Validation loss decreased (-0.422215 --> -0.455548).  Saving model ...
Epoch: 3 cost time: 1.0277607440948486
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.741 Vali Acc: 0.472 Test Loss: 0.741 Test Acc: 0.472
Validation loss decreased (-0.455548 --> -0.472215).  Saving model ...
Epoch: 4 cost time: 0.9390585422515869
Epoch: 4, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.735 Vali Acc: 0.461 Test Loss: 0.735 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9663126468658447
Epoch: 5, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.727 Vali Acc: 0.489 Test Loss: 0.727 Test Acc: 0.489
Validation loss decreased (-0.472215 --> -0.488882).  Saving model ...
Epoch: 6 cost time: 0.9976296424865723
Epoch: 6, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
Validation loss decreased (-0.488882 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 0.9379093647003174
Epoch: 7, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.764 Vali Acc: 0.522 Test Loss: 0.764 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 8 cost time: 0.9777519702911377
Epoch: 8, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0027918815612793
Epoch: 9, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.806 Vali Acc: 0.511 Test Loss: 0.806 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0295593738555908
Epoch: 10, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.851 Vali Acc: 0.544 Test Loss: 0.851 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544436).  Saving model ...
Epoch: 11 cost time: 1.0047657489776611
Epoch: 11, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.891 Vali Acc: 0.511 Test Loss: 0.891 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1881637573242188
Epoch: 12, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.933 Vali Acc: 0.511 Test Loss: 0.933 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0826354026794434
Epoch: 13, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.962 Vali Acc: 0.511 Test Loss: 0.962 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2152049541473389
Epoch: 14, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.006 Vali Acc: 0.517 Test Loss: 1.006 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1417551040649414
Epoch: 15, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9972712993621826
Epoch: 16, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.082 Vali Acc: 0.489 Test Loss: 1.082 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0967247486114502
Epoch: 17, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.129 Vali Acc: 0.478 Test Loss: 1.129 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1282882690429688
Epoch: 18, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1079094409942627
Epoch: 19, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.170 Vali Acc: 0.489 Test Loss: 1.170 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1300573348999023
Epoch: 20, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.227 Vali Acc: 0.528 Test Loss: 1.227 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 53474
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.017535924911499
Epoch: 1, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.736 Vali Acc: 0.483 Test Loss: 0.736 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.083101749420166
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.729 Vali Acc: 0.456 Test Loss: 0.729 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.965472936630249
Epoch: 3, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
Validation loss decreased (-0.483326 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.130857229232788
Epoch: 4, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.740 Vali Acc: 0.483 Test Loss: 0.740 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0296375751495361
Epoch: 5, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.746 Vali Acc: 0.483 Test Loss: 0.746 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1081666946411133
Epoch: 6, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.779 Vali Acc: 0.506 Test Loss: 0.779 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505548).  Saving model ...
Epoch: 7 cost time: 0.9867496490478516
Epoch: 7, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.791 Vali Acc: 0.494 Test Loss: 0.791 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9982190132141113
Epoch: 8, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.816 Vali Acc: 0.494 Test Loss: 0.816 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1922781467437744
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.826 Vali Acc: 0.478 Test Loss: 0.826 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2010924816131592
Epoch: 10, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.20928955078125
Epoch: 11, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.884 Vali Acc: 0.506 Test Loss: 0.884 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.233642339706421
Epoch: 12, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.912 Vali Acc: 0.489 Test Loss: 0.912 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9844009876251221
Epoch: 13, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.979 Vali Acc: 0.494 Test Loss: 0.979 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0458729267120361
Epoch: 14, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.998 Vali Acc: 0.494 Test Loss: 0.998 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0708484649658203
Epoch: 15, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.017 Vali Acc: 0.483 Test Loss: 1.017 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0900912284851074
Epoch: 16, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.078 Vali Acc: 0.489 Test Loss: 1.078 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 53538
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7317349910736084
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.720 Vali Acc: 0.494 Test Loss: 0.720 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.1674721240997314
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.715 Vali Acc: 0.467 Test Loss: 0.715 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2101354598999023
Epoch: 3, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.704 Vali Acc: 0.494 Test Loss: 0.704 Test Acc: 0.494
Validation loss decreased (-0.494437 --> -0.494437).  Saving model ...
Epoch: 4 cost time: 1.41623854637146
Epoch: 4, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.706 Vali Acc: 0.511 Test Loss: 0.706 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511104).  Saving model ...
Epoch: 5 cost time: 1.288907527923584
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.719 Vali Acc: 0.483 Test Loss: 0.719 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.203096866607666
Epoch: 6, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.049039363861084
Epoch: 7, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.739 Vali Acc: 0.506 Test Loss: 0.739 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.044931173324585
Epoch: 8, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.762 Vali Acc: 0.506 Test Loss: 0.762 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1955974102020264
Epoch: 9, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.764 Vali Acc: 0.517 Test Loss: 0.764 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 10 cost time: 1.0509889125823975
Epoch: 10, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.785 Vali Acc: 0.506 Test Loss: 0.785 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0196499824523926
Epoch: 11, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.807 Vali Acc: 0.511 Test Loss: 0.807 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3070015907287598
Epoch: 12, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.857 Vali Acc: 0.506 Test Loss: 0.857 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.27012038230896
Epoch: 13, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.907 Vali Acc: 0.478 Test Loss: 0.907 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.541529893875122
Epoch: 14, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.924 Vali Acc: 0.489 Test Loss: 0.924 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.219017744064331
Epoch: 15, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.947 Vali Acc: 0.483 Test Loss: 0.947 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2780985832214355
Epoch: 16, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.347097635269165
Epoch: 17, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.992 Vali Acc: 0.489 Test Loss: 0.992 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5708503723144531
Epoch: 18, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.045 Vali Acc: 0.461 Test Loss: 1.045 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5138325691223145
Epoch: 19, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.056 Vali Acc: 0.478 Test Loss: 1.056 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 54914
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.195260524749756
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.748 Vali Acc: 0.494 Test Loss: 0.748 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.4550940990447998
Epoch: 2, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.772 Vali Acc: 0.494 Test Loss: 0.772 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.654008388519287
Epoch: 3, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.834 Vali Acc: 0.478 Test Loss: 0.834 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4762673377990723
Epoch: 4, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.887 Vali Acc: 0.472 Test Loss: 0.887 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5978176593780518
Epoch: 5, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.959 Vali Acc: 0.456 Test Loss: 0.959 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8276560306549072
Epoch: 6, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.053 Vali Acc: 0.456 Test Loss: 1.053 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.635115385055542
Epoch: 7, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.134 Vali Acc: 0.489 Test Loss: 1.134 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4593656063079834
Epoch: 8, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.239 Vali Acc: 0.494 Test Loss: 1.239 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6199464797973633
Epoch: 9, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.299 Vali Acc: 0.483 Test Loss: 1.299 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4791760444641113
Epoch: 10, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.381 Vali Acc: 0.472 Test Loss: 1.381 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4745512008666992
Epoch: 11, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.650 Vali Acc: 0.483 Test Loss: 1.650 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 60450
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.226949691772461
Epoch: 1, Steps: 13 | Train Loss: 0.814 Vali Loss: 0.759 Vali Acc: 0.517 Test Loss: 0.759 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.509129285812378
Epoch: 2, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.725 Vali Acc: 0.494 Test Loss: 0.725 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6538257598876953
Epoch: 3, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.728 Vali Acc: 0.522 Test Loss: 0.728 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.727841854095459
Epoch: 4, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.813 Vali Acc: 0.506 Test Loss: 0.813 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5161702632904053
Epoch: 5, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.815 Vali Acc: 0.494 Test Loss: 0.815 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5137863159179688
Epoch: 6, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.882 Vali Acc: 0.461 Test Loss: 0.882 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4103920459747314
Epoch: 7, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8630564212799072
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.020 Vali Acc: 0.494 Test Loss: 1.020 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4909441471099854
Epoch: 9, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.043 Vali Acc: 0.489 Test Loss: 1.043 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.759108304977417
Epoch: 10, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.126 Vali Acc: 0.489 Test Loss: 1.126 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4404876232147217
Epoch: 11, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.189 Vali Acc: 0.489 Test Loss: 1.189 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8464922904968262
Epoch: 12, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.298 Vali Acc: 0.489 Test Loss: 1.298 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6138229370117188
Epoch: 13, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.510 Vali Acc: 0.467 Test Loss: 1.510 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 44802
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6234073638916016
Epoch: 1, Steps: 13 | Train Loss: 0.813 Vali Loss: 0.731 Vali Acc: 0.494 Test Loss: 0.731 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.089724063873291
Epoch: 2, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.724 Vali Acc: 0.517 Test Loss: 0.724 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 0.9576163291931152
Epoch: 3, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
Validation loss decreased (-0.516659 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.1902227401733398
Epoch: 4, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.738 Vali Acc: 0.494 Test Loss: 0.738 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0227606296539307
Epoch: 5, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.773 Vali Acc: 0.533 Test Loss: 0.773 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9076769351959229
Epoch: 6, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1228413581848145
Epoch: 7, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.869 Vali Acc: 0.467 Test Loss: 0.869 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1161022186279297
Epoch: 8, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.875 Vali Acc: 0.494 Test Loss: 0.875 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.159123420715332
Epoch: 9, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.921 Vali Acc: 0.517 Test Loss: 0.921 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2144200801849365
Epoch: 10, Steps: 13 | Train Loss: 0.422 Vali Loss: 1.005 Vali Acc: 0.494 Test Loss: 1.005 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0825581550598145
Epoch: 11, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.022 Vali Acc: 0.494 Test Loss: 1.022 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.157235860824585
Epoch: 12, Steps: 13 | Train Loss: 0.377 Vali Loss: 1.137 Vali Acc: 0.522 Test Loss: 1.137 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3314306735992432
Epoch: 13, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 39906
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7847933769226074
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.722 Vali Acc: 0.494 Test Loss: 0.722 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.4131605625152588
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.1069161891937256
Epoch: 3, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.723 Vali Acc: 0.506 Test Loss: 0.723 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.359044075012207
Epoch: 4, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.731 Vali Acc: 0.528 Test Loss: 0.731 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527770).  Saving model ...
Epoch: 5 cost time: 1.1961119174957275
Epoch: 5, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
Validation loss decreased (-0.527770 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.3449625968933105
Epoch: 6, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.776 Vali Acc: 0.517 Test Loss: 0.776 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4560673236846924
Epoch: 7, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.803 Vali Acc: 0.528 Test Loss: 0.803 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.542508602142334
Epoch: 8, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.822 Vali Acc: 0.511 Test Loss: 0.822 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4220528602600098
Epoch: 9, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.898 Vali Acc: 0.494 Test Loss: 0.898 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2475416660308838
Epoch: 10, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.922 Vali Acc: 0.511 Test Loss: 0.922 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1381711959838867
Epoch: 11, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.954 Vali Acc: 0.517 Test Loss: 0.954 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3083252906799316
Epoch: 12, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.014 Vali Acc: 0.494 Test Loss: 1.014 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.279848575592041
Epoch: 13, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3108508586883545
Epoch: 14, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.542839765548706
Epoch: 15, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 37698
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.403292179107666
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.715 Vali Acc: 0.528 Test Loss: 0.715 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 1.3991365432739258
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.712 Vali Acc: 0.539 Test Loss: 0.712 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.3131637573242188
Epoch: 3, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.724 Vali Acc: 0.517 Test Loss: 0.724 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2780680656433105
Epoch: 4, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.725 Vali Acc: 0.467 Test Loss: 0.725 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1657867431640625
Epoch: 5, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1156935691833496
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.213169813156128
Epoch: 7, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.781 Vali Acc: 0.511 Test Loss: 0.781 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.677403211593628
Epoch: 8, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.795 Vali Acc: 0.517 Test Loss: 0.795 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3490228652954102
Epoch: 9, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.824 Vali Acc: 0.511 Test Loss: 0.824 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2425885200500488
Epoch: 10, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.865 Vali Acc: 0.511 Test Loss: 0.865 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.465735673904419
Epoch: 11, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.884 Vali Acc: 0.506 Test Loss: 0.884 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2580642700195312
Epoch: 12, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.936 Vali Acc: 0.522 Test Loss: 0.936 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 36834
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.278385639190674
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.743 Vali Acc: 0.472 Test Loss: 0.743 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.7096199989318848
Epoch: 2, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.746 Vali Acc: 0.522 Test Loss: 0.746 Test Acc: 0.522
Validation loss decreased (-0.472215 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.3927557468414307
Epoch: 3, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.744 Vali Acc: 0.528 Test Loss: 0.744 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 1.1800620555877686
Epoch: 4, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.758 Vali Acc: 0.483 Test Loss: 0.758 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1065211296081543
Epoch: 5, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.759 Vali Acc: 0.511 Test Loss: 0.759 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0697567462921143
Epoch: 6, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.771 Vali Acc: 0.522 Test Loss: 0.771 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9849512577056885
Epoch: 7, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.786 Vali Acc: 0.517 Test Loss: 0.786 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0602657794952393
Epoch: 8, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.814 Vali Acc: 0.528 Test Loss: 0.814 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3920261859893799
Epoch: 9, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.835 Vali Acc: 0.511 Test Loss: 0.835 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3534557819366455
Epoch: 10, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.869 Vali Acc: 0.522 Test Loss: 0.869 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3425712585449219
Epoch: 11, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.900 Vali Acc: 0.528 Test Loss: 0.900 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3702392578125
Epoch: 12, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.935 Vali Acc: 0.522 Test Loss: 0.935 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.404205083847046
Epoch: 13, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.946 Vali Acc: 0.522 Test Loss: 0.946 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 36898
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.957355499267578
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.742 Vali Acc: 0.450 Test Loss: 0.742 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.2118022441864014
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
Validation loss decreased (-0.449993 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 1.130479097366333
Epoch: 3, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.745 Vali Acc: 0.489 Test Loss: 0.745 Test Acc: 0.489
Validation loss decreased (-0.449993 --> -0.488881).  Saving model ...
Epoch: 4 cost time: 1.2622203826904297
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.732 Vali Acc: 0.456 Test Loss: 0.732 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2660036087036133
Epoch: 5, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.740 Vali Acc: 0.467 Test Loss: 0.740 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2982044219970703
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.752 Vali Acc: 0.494 Test Loss: 0.752 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494437).  Saving model ...
Epoch: 7 cost time: 1.383211374282837
Epoch: 7, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499992).  Saving model ...
Epoch: 8 cost time: 1.1510958671569824
Epoch: 8, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.778 Vali Acc: 0.517 Test Loss: 0.778 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516659).  Saving model ...
Epoch: 9 cost time: 1.3212172985076904
Epoch: 9, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.795 Vali Acc: 0.533 Test Loss: 0.795 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533325).  Saving model ...
Epoch: 10 cost time: 1.274261236190796
Epoch: 10, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.811 Vali Acc: 0.544 Test Loss: 0.811 Test Acc: 0.544
Validation loss decreased (-0.533325 --> -0.544436).  Saving model ...
Epoch: 11 cost time: 1.1906850337982178
Epoch: 11, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.857 Vali Acc: 0.500 Test Loss: 0.857 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2007684707641602
Epoch: 12, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.859 Vali Acc: 0.522 Test Loss: 0.859 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1984984874725342
Epoch: 13, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.942 Vali Acc: 0.544 Test Loss: 0.942 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1271002292633057
Epoch: 14, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.903 Vali Acc: 0.517 Test Loss: 0.903 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.133472204208374
Epoch: 15, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.955 Vali Acc: 0.522 Test Loss: 0.955 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1560254096984863
Epoch: 16, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.024 Vali Acc: 0.517 Test Loss: 1.024 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1156551837921143
Epoch: 17, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.010 Vali Acc: 0.522 Test Loss: 1.010 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2141780853271484
Epoch: 18, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.039 Vali Acc: 0.506 Test Loss: 1.039 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5656108856201172
Epoch: 19, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.063 Vali Acc: 0.517 Test Loss: 1.063 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.124800205230713
Epoch: 20, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.093 Vali Acc: 0.522 Test Loss: 1.093 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 38274
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.174828290939331
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.134843111038208
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.721 Vali Acc: 0.561 Test Loss: 0.721 Test Acc: 0.561
Validation loss decreased (-0.499992 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 1.9182095527648926
Epoch: 3, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.761 Vali Acc: 0.522 Test Loss: 0.761 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8905763626098633
Epoch: 4, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.814 Vali Acc: 0.494 Test Loss: 0.814 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.177922248840332
Epoch: 5, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.072 Vali Acc: 0.483 Test Loss: 1.072 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7471632957458496
Epoch: 6, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.978 Vali Acc: 0.500 Test Loss: 0.978 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6894209384918213
Epoch: 7, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8559091091156006
Epoch: 8, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.271 Vali Acc: 0.472 Test Loss: 1.271 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9644224643707275
Epoch: 9, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.303 Vali Acc: 0.472 Test Loss: 1.303 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.015787124633789
Epoch: 10, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0413293838500977
Epoch: 11, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.502 Vali Acc: 0.444 Test Loss: 1.502 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9157664775848389
Epoch: 12, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.619 Vali Acc: 0.461 Test Loss: 1.619 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 52130
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.443918704986572
Epoch: 1, Steps: 13 | Train Loss: 0.785 Vali Loss: 0.742 Vali Acc: 0.544 Test Loss: 0.742 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.4450833797454834
Epoch: 2, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.572178602218628
Epoch: 3, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.743 Vali Acc: 0.550 Test Loss: 0.743 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7875192165374756
Epoch: 4, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.782 Vali Acc: 0.511 Test Loss: 0.782 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7176401615142822
Epoch: 5, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.810 Vali Acc: 0.517 Test Loss: 0.810 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8072073459625244
Epoch: 6, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.882 Vali Acc: 0.550 Test Loss: 0.882 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6863257884979248
Epoch: 7, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.875 Vali Acc: 0.506 Test Loss: 0.875 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9447200298309326
Epoch: 8, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.967 Vali Acc: 0.517 Test Loss: 0.967 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7828423976898193
Epoch: 9, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7678792476654053
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.088 Vali Acc: 0.522 Test Loss: 1.088 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7591652870178223
Epoch: 11, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.157 Vali Acc: 0.511 Test Loss: 1.157 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.817373275756836
Epoch: 12, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.231 Vali Acc: 0.528 Test Loss: 1.231 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 36482
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0766873359680176
Epoch: 1, Steps: 13 | Train Loss: 0.796 Vali Loss: 0.724 Vali Acc: 0.517 Test Loss: 0.724 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.2597589492797852
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.706 Vali Acc: 0.522 Test Loss: 0.706 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.2300453186035156
Epoch: 3, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.709 Vali Acc: 0.506 Test Loss: 0.709 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1830337047576904
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
Validation loss decreased (-0.522215 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.1719532012939453
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.737 Vali Acc: 0.511 Test Loss: 0.737 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3577907085418701
Epoch: 6, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.794 Vali Acc: 0.539 Test Loss: 0.794 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.213073968887329
Epoch: 7, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.827 Vali Acc: 0.511 Test Loss: 0.827 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1560592651367188
Epoch: 8, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.909 Vali Acc: 0.522 Test Loss: 0.909 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4103305339813232
Epoch: 9, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.888 Vali Acc: 0.522 Test Loss: 0.888 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1621625423431396
Epoch: 10, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.21152925491333
Epoch: 11, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.068 Vali Acc: 0.544 Test Loss: 1.068 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3527472019195557
Epoch: 12, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.081 Vali Acc: 0.483 Test Loss: 1.081 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2428522109985352
Epoch: 13, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.111 Vali Acc: 0.556 Test Loss: 1.111 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555544).  Saving model ...
Epoch: 14 cost time: 1.255765438079834
Epoch: 14, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.165 Vali Acc: 0.567 Test Loss: 1.165 Test Acc: 0.567
Validation loss decreased (-0.555544 --> -0.566655).  Saving model ...
Epoch: 15 cost time: 1.3344826698303223
Epoch: 15, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.217 Vali Acc: 0.511 Test Loss: 1.217 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2216134071350098
Epoch: 16, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.283 Vali Acc: 0.561 Test Loss: 1.283 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.358950138092041
Epoch: 17, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.319 Vali Acc: 0.517 Test Loss: 1.319 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3707261085510254
Epoch: 18, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.417 Vali Acc: 0.483 Test Loss: 1.417 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3904962539672852
Epoch: 19, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.485 Vali Acc: 0.522 Test Loss: 1.485 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2550466060638428
Epoch: 20, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.536 Vali Acc: 0.506 Test Loss: 1.536 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4261794090270996
Epoch: 21, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.604 Vali Acc: 0.539 Test Loss: 1.604 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1042065620422363
Epoch: 22, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.692 Vali Acc: 0.489 Test Loss: 1.692 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0869700908660889
Epoch: 23, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.736 Vali Acc: 0.522 Test Loss: 1.736 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3724455833435059
Epoch: 24, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.848 Vali Acc: 0.522 Test Loss: 1.848 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 31586
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.958984375
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.720 Vali Acc: 0.483 Test Loss: 0.720 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.0876476764678955
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.730 Vali Acc: 0.489 Test Loss: 0.730 Test Acc: 0.489
Validation loss decreased (-0.483326 --> -0.488882).  Saving model ...
Epoch: 3 cost time: 1.3164198398590088
Epoch: 3, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.735 Vali Acc: 0.478 Test Loss: 0.735 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0902976989746094
Epoch: 4, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.754 Vali Acc: 0.483 Test Loss: 0.754 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.380674123764038
Epoch: 5, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.768 Vali Acc: 0.506 Test Loss: 0.768 Test Acc: 0.506
Validation loss decreased (-0.488882 --> -0.505548).  Saving model ...
Epoch: 6 cost time: 1.164550542831421
Epoch: 6, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.796 Vali Acc: 0.478 Test Loss: 0.796 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3833775520324707
Epoch: 7, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.829 Vali Acc: 0.517 Test Loss: 0.829 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516658).  Saving model ...
Epoch: 8 cost time: 1.062398910522461
Epoch: 8, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.863 Vali Acc: 0.511 Test Loss: 0.863 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1125457286834717
Epoch: 9, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1823618412017822
Epoch: 10, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.946 Vali Acc: 0.511 Test Loss: 0.946 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.430091142654419
Epoch: 11, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.990 Vali Acc: 0.511 Test Loss: 0.990 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2252585887908936
Epoch: 12, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.009 Vali Acc: 0.483 Test Loss: 1.009 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2290308475494385
Epoch: 13, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.053 Vali Acc: 0.511 Test Loss: 1.053 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2480099201202393
Epoch: 14, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.106 Vali Acc: 0.528 Test Loss: 1.106 Test Acc: 0.528
Validation loss decreased (-0.516658 --> -0.527767).  Saving model ...
Epoch: 15 cost time: 1.429027795791626
Epoch: 15, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2446975708007812
Epoch: 16, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1108427047729492
Epoch: 17, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.197 Vali Acc: 0.478 Test Loss: 1.197 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0635123252868652
Epoch: 18, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.289 Vali Acc: 0.494 Test Loss: 1.289 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1838910579681396
Epoch: 19, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.318 Vali Acc: 0.483 Test Loss: 1.318 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.344998836517334
Epoch: 20, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.356 Vali Acc: 0.500 Test Loss: 1.356 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2653961181640625
Epoch: 21, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.375 Vali Acc: 0.472 Test Loss: 1.375 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1565349102020264
Epoch: 22, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.457 Vali Acc: 0.483 Test Loss: 1.457 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.105773687362671
Epoch: 23, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.538 Vali Acc: 0.511 Test Loss: 1.538 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1531546115875244
Epoch: 24, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.558 Vali Acc: 0.467 Test Loss: 1.558 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 29378
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8801262378692627
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.1179163455963135
Epoch: 2, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.696 Vali Acc: 0.528 Test Loss: 0.696 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0752933025360107
Epoch: 3, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0861711502075195
Epoch: 4, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.700 Vali Acc: 0.533 Test Loss: 0.700 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2121071815490723
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.064209222793579
Epoch: 6, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.731 Vali Acc: 0.506 Test Loss: 0.731 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1951987743377686
Epoch: 7, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.751 Vali Acc: 0.522 Test Loss: 0.751 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0216140747070312
Epoch: 8, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.791 Vali Acc: 0.506 Test Loss: 0.791 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2735939025878906
Epoch: 9, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.795 Vali Acc: 0.506 Test Loss: 0.795 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1054391860961914
Epoch: 10, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.833 Vali Acc: 0.494 Test Loss: 0.833 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.246833086013794
Epoch: 11, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.865 Vali Acc: 0.517 Test Loss: 0.865 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 28514
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5940587520599365
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.700 Vali Acc: 0.528 Test Loss: 0.700 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 1.8432691097259521
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.697 Vali Acc: 0.472 Test Loss: 0.697 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1048309803009033
Epoch: 3, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.705 Vali Acc: 0.511 Test Loss: 0.705 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3255252838134766
Epoch: 4, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.691 Vali Acc: 0.478 Test Loss: 0.691 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3665242195129395
Epoch: 5, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.693 Vali Acc: 0.483 Test Loss: 0.693 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1994130611419678
Epoch: 6, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.707 Vali Acc: 0.467 Test Loss: 0.707 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2056386470794678
Epoch: 7, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.727 Vali Acc: 0.489 Test Loss: 0.727 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2390251159667969
Epoch: 8, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.745 Vali Acc: 0.483 Test Loss: 0.745 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1973776817321777
Epoch: 9, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.772 Vali Acc: 0.489 Test Loss: 0.772 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.162524938583374
Epoch: 10, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.808 Vali Acc: 0.511 Test Loss: 0.808 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.187795877456665
Epoch: 11, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.832 Vali Acc: 0.456 Test Loss: 0.832 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 28578
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.800103187561035
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.4008219242095947
Epoch: 2, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.708 Vali Acc: 0.533 Test Loss: 0.708 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.1622366905212402
Epoch: 3, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.701 Vali Acc: 0.533 Test Loss: 0.701 Test Acc: 0.533
Validation loss decreased (-0.533326 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.115696907043457
Epoch: 4, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.706 Vali Acc: 0.528 Test Loss: 0.706 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2648963928222656
Epoch: 5, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.720 Vali Acc: 0.489 Test Loss: 0.720 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1157841682434082
Epoch: 6, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.729 Vali Acc: 0.467 Test Loss: 0.729 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3358790874481201
Epoch: 7, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3585193157196045
Epoch: 8, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.774 Vali Acc: 0.467 Test Loss: 0.774 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4206562042236328
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.780 Vali Acc: 0.483 Test Loss: 0.780 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0997798442840576
Epoch: 10, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.794 Vali Acc: 0.506 Test Loss: 0.794 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4536583423614502
Epoch: 11, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.802 Vali Acc: 0.461 Test Loss: 0.802 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1129534244537354
Epoch: 12, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.835 Vali Acc: 0.467 Test Loss: 0.835 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5171833038330078
Epoch: 13, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.861 Vali Acc: 0.511 Test Loss: 0.861 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm32_nh4_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 29954
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.928664445877075
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.712 Vali Acc: 0.517 Test Loss: 0.712 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.7967238426208496
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.745 Vali Acc: 0.483 Test Loss: 0.745 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5895180702209473
Epoch: 3, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3116397857666016
Epoch: 4, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.792 Vali Acc: 0.478 Test Loss: 0.792 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.36704683303833
Epoch: 5, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.812 Vali Acc: 0.461 Test Loss: 0.812 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3981499671936035
Epoch: 6, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.853 Vali Acc: 0.478 Test Loss: 0.853 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4102699756622314
Epoch: 7, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.910 Vali Acc: 0.467 Test Loss: 0.910 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5959570407867432
Epoch: 8, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.989 Vali Acc: 0.483 Test Loss: 0.989 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2593038082122803
Epoch: 9, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.132 Vali Acc: 0.489 Test Loss: 1.132 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4795770645141602
Epoch: 10, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.112 Vali Acc: 0.483 Test Loss: 1.112 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.408909559249878
Epoch: 11, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.190 Vali Acc: 0.478 Test Loss: 1.190 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 36754
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6083521842956543
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.727 Vali Acc: 0.539 Test Loss: 0.727 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.321462631225586
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.713 Vali Acc: 0.533 Test Loss: 0.713 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2144615650177002
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.720 Vali Acc: 0.517 Test Loss: 0.720 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.14186692237854
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2414565086364746
Epoch: 5, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.762 Vali Acc: 0.472 Test Loss: 0.762 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2739708423614502
Epoch: 6, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.769 Vali Acc: 0.494 Test Loss: 0.769 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.361128568649292
Epoch: 7, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.793 Vali Acc: 0.456 Test Loss: 0.793 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1257641315460205
Epoch: 8, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.849 Vali Acc: 0.456 Test Loss: 0.849 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3109447956085205
Epoch: 9, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.880 Vali Acc: 0.461 Test Loss: 0.880 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3480470180511475
Epoch: 10, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.915 Vali Acc: 0.478 Test Loss: 0.915 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1629397869110107
Epoch: 11, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.973 Vali Acc: 0.478 Test Loss: 0.973 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 28930
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7225399017333984
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.794 Vali Acc: 0.483 Test Loss: 0.794 Test Acc: 0.483
Validation loss decreased (inf --> -0.483325).  Saving model ...
Epoch: 2 cost time: 1.343358039855957
Epoch: 2, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.791 Vali Acc: 0.467 Test Loss: 0.791 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5583546161651611
Epoch: 3, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.780 Vali Acc: 0.472 Test Loss: 0.780 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.417320966720581
Epoch: 4, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.765 Vali Acc: 0.456 Test Loss: 0.765 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4636766910552979
Epoch: 5, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.782 Vali Acc: 0.483 Test Loss: 0.782 Test Acc: 0.483
Validation loss decreased (-0.483325 --> -0.483326).  Saving model ...
Epoch: 6 cost time: 1.572538137435913
Epoch: 6, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.776 Vali Acc: 0.433 Test Loss: 0.776 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1984093189239502
Epoch: 7, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.783 Vali Acc: 0.489 Test Loss: 0.783 Test Acc: 0.489
Validation loss decreased (-0.483326 --> -0.488881).  Saving model ...
Epoch: 8 cost time: 1.2246065139770508
Epoch: 8, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.796 Vali Acc: 0.444 Test Loss: 0.796 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2558295726776123
Epoch: 9, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.825 Vali Acc: 0.456 Test Loss: 0.825 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2077076435089111
Epoch: 10, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.831 Vali Acc: 0.494 Test Loss: 0.831 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494436).  Saving model ...
Epoch: 11 cost time: 1.2938790321350098
Epoch: 11, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.847 Vali Acc: 0.472 Test Loss: 0.847 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.461639165878296
Epoch: 12, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.909 Vali Acc: 0.483 Test Loss: 0.909 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3923335075378418
Epoch: 13, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.928 Vali Acc: 0.483 Test Loss: 0.928 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3320214748382568
Epoch: 14, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.941 Vali Acc: 0.489 Test Loss: 0.941 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4302091598510742
Epoch: 15, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.985 Vali Acc: 0.478 Test Loss: 0.985 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1732416152954102
Epoch: 16, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.034 Vali Acc: 0.478 Test Loss: 1.034 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.361102819442749
Epoch: 17, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3819897174835205
Epoch: 18, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.085 Vali Acc: 0.494 Test Loss: 1.085 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.495481252670288
Epoch: 19, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.152 Vali Acc: 0.483 Test Loss: 1.152 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5401318073272705
Epoch: 20, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.205 Vali Acc: 0.483 Test Loss: 1.205 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.49444444444444446
model parameter : 26482
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.491424798965454
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.705 Vali Acc: 0.506 Test Loss: 0.705 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 1.4374115467071533
Epoch: 2, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.708 Vali Acc: 0.506 Test Loss: 0.708 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2363190650939941
Epoch: 3, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.708 Vali Acc: 0.511 Test Loss: 0.708 Test Acc: 0.511
Validation loss decreased (-0.505549 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.3878648281097412
Epoch: 4, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.705 Vali Acc: 0.522 Test Loss: 0.705 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 5 cost time: 1.5681796073913574
Epoch: 5, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.718 Vali Acc: 0.522 Test Loss: 0.718 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1647663116455078
Epoch: 6, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.718 Vali Acc: 0.528 Test Loss: 0.718 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527771).  Saving model ...
Epoch: 7 cost time: 1.3398785591125488
Epoch: 7, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.733 Vali Acc: 0.517 Test Loss: 0.733 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4236154556274414
Epoch: 8, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.743 Vali Acc: 0.544 Test Loss: 0.743 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544437).  Saving model ...
Epoch: 9 cost time: 1.4132757186889648
Epoch: 9, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.755 Vali Acc: 0.517 Test Loss: 0.755 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.415595531463623
Epoch: 10, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.786 Vali Acc: 0.528 Test Loss: 0.786 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5936031341552734
Epoch: 11, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.803 Vali Acc: 0.494 Test Loss: 0.803 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2474701404571533
Epoch: 12, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.832 Vali Acc: 0.517 Test Loss: 0.832 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3134329319000244
Epoch: 13, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.840 Vali Acc: 0.506 Test Loss: 0.840 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2576310634613037
Epoch: 14, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.872 Vali Acc: 0.511 Test Loss: 0.872 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3733997344970703
Epoch: 15, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.882 Vali Acc: 0.511 Test Loss: 0.882 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2447328567504883
Epoch: 16, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.908 Vali Acc: 0.522 Test Loss: 0.908 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.315185546875
Epoch: 17, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.935 Vali Acc: 0.522 Test Loss: 0.935 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2274324893951416
Epoch: 18, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.963 Vali Acc: 0.517 Test Loss: 0.963 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 25378
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.189539432525635
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.719 Vali Acc: 0.478 Test Loss: 0.719 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 1.3692772388458252
Epoch: 2, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.715 Vali Acc: 0.483 Test Loss: 0.715 Test Acc: 0.483
Validation loss decreased (-0.477771 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 1.3355538845062256
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.705 Vali Acc: 0.517 Test Loss: 0.705 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.2437973022460938
Epoch: 4, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.703 Vali Acc: 0.517 Test Loss: 0.703 Test Acc: 0.517
Validation loss decreased (-0.516660 --> -0.516660).  Saving model ...
Epoch: 5 cost time: 1.2781741619110107
Epoch: 5, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (-0.516660 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.5198559761047363
Epoch: 6, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.707 Vali Acc: 0.517 Test Loss: 0.707 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.13956880569458
Epoch: 7, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.705 Vali Acc: 0.511 Test Loss: 0.705 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3344948291778564
Epoch: 8, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.715 Vali Acc: 0.494 Test Loss: 0.715 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2954356670379639
Epoch: 9, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.743 Vali Acc: 0.517 Test Loss: 0.743 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2840986251831055
Epoch: 10, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.755 Vali Acc: 0.511 Test Loss: 0.755 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4499528408050537
Epoch: 11, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.773 Vali Acc: 0.489 Test Loss: 0.773 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.519195556640625
Epoch: 12, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.801 Vali Acc: 0.494 Test Loss: 0.801 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.503023386001587
Epoch: 13, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.811 Vali Acc: 0.483 Test Loss: 0.811 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1812198162078857
Epoch: 14, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.819 Vali Acc: 0.472 Test Loss: 0.819 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.411670446395874
Epoch: 15, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.850 Vali Acc: 0.489 Test Loss: 0.850 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 24946
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.038350343704224
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.721 Vali Acc: 0.517 Test Loss: 0.721 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 0.9916534423828125
Epoch: 2, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.719 Vali Acc: 0.494 Test Loss: 0.719 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2217178344726562
Epoch: 3, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.720 Vali Acc: 0.489 Test Loss: 0.720 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.098994493484497
Epoch: 4, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.721 Vali Acc: 0.528 Test Loss: 0.721 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527771).  Saving model ...
Epoch: 5 cost time: 1.2008302211761475
Epoch: 5, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.724 Vali Acc: 0.528 Test Loss: 0.724 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2330412864685059
Epoch: 6, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.730 Vali Acc: 0.522 Test Loss: 0.730 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2469050884246826
Epoch: 7, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.350696325302124
Epoch: 8, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.731 Vali Acc: 0.533 Test Loss: 0.731 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533326).  Saving model ...
Epoch: 9 cost time: 1.3501994609832764
Epoch: 9, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.732 Vali Acc: 0.494 Test Loss: 0.732 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.38787841796875
Epoch: 10, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.748 Vali Acc: 0.506 Test Loss: 0.748 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2029967308044434
Epoch: 11, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.767 Vali Acc: 0.494 Test Loss: 0.767 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2880547046661377
Epoch: 12, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.764 Vali Acc: 0.517 Test Loss: 0.764 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0635335445404053
Epoch: 13, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.773 Vali Acc: 0.533 Test Loss: 0.773 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.40171217918396
Epoch: 14, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.793 Vali Acc: 0.517 Test Loss: 0.793 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2208375930786133
Epoch: 15, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.804 Vali Acc: 0.522 Test Loss: 0.804 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3719289302825928
Epoch: 16, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.814 Vali Acc: 0.533 Test Loss: 0.814 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3350484371185303
Epoch: 17, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.839 Vali Acc: 0.511 Test Loss: 0.839 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.390273094177246
Epoch: 18, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.852 Vali Acc: 0.517 Test Loss: 0.852 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 24978
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4319841861724854
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.748 Vali Acc: 0.472 Test Loss: 0.748 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.1999380588531494
Epoch: 2, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.742 Vali Acc: 0.483 Test Loss: 0.742 Test Acc: 0.483
Validation loss decreased (-0.472215 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 1.0939905643463135
Epoch: 3, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.737 Vali Acc: 0.489 Test Loss: 0.737 Test Acc: 0.489
Validation loss decreased (-0.483326 --> -0.488882).  Saving model ...
Epoch: 4 cost time: 1.4375970363616943
Epoch: 4, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.736 Vali Acc: 0.494 Test Loss: 0.736 Test Acc: 0.494
Validation loss decreased (-0.488882 --> -0.494437).  Saving model ...
Epoch: 5 cost time: 1.1174283027648926
Epoch: 5, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.744 Vali Acc: 0.494 Test Loss: 0.744 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1287314891815186
Epoch: 6, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.739 Vali Acc: 0.472 Test Loss: 0.739 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.082944393157959
Epoch: 7, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.747 Vali Acc: 0.472 Test Loss: 0.747 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3097174167633057
Epoch: 8, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.752 Vali Acc: 0.483 Test Loss: 0.752 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5033867359161377
Epoch: 9, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.765 Vali Acc: 0.511 Test Loss: 0.765 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511103).  Saving model ...
Epoch: 10 cost time: 1.4096190929412842
Epoch: 10, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3172218799591064
Epoch: 11, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.793 Vali Acc: 0.489 Test Loss: 0.793 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.396559476852417
Epoch: 12, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.817 Vali Acc: 0.506 Test Loss: 0.817 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2736754417419434
Epoch: 13, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.823 Vali Acc: 0.528 Test Loss: 0.823 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527770).  Saving model ...
Epoch: 14 cost time: 1.3636062145233154
Epoch: 14, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5075392723083496
Epoch: 15, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.875 Vali Acc: 0.506 Test Loss: 0.875 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.464081048965454
Epoch: 16, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.878 Vali Acc: 0.517 Test Loss: 0.878 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.555009126663208
Epoch: 17, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.907 Vali Acc: 0.494 Test Loss: 0.907 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3417437076568604
Epoch: 18, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.920 Vali Acc: 0.528 Test Loss: 0.920 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.477792501449585
Epoch: 19, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.928 Vali Acc: 0.522 Test Loss: 0.928 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3340322971343994
Epoch: 20, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.944 Vali Acc: 0.500 Test Loss: 0.944 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4198517799377441
Epoch: 21, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.964 Vali Acc: 0.511 Test Loss: 0.964 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3937578201293945
Epoch: 22, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.998 Vali Acc: 0.517 Test Loss: 0.998 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4913771152496338
Epoch: 23, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.015 Vali Acc: 0.511 Test Loss: 1.015 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 25666
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.3441572189331055
Epoch: 1, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.712 Vali Acc: 0.533 Test Loss: 0.712 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.7286224365234375
Epoch: 2, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.722 Vali Acc: 0.522 Test Loss: 0.722 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4333868026733398
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.732 Vali Acc: 0.539 Test Loss: 0.732 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.170039415359497
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.745 Vali Acc: 0.489 Test Loss: 0.745 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4069738388061523
Epoch: 5, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.791 Vali Acc: 0.494 Test Loss: 0.791 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5287444591522217
Epoch: 6, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.824 Vali Acc: 0.467 Test Loss: 0.824 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5506551265716553
Epoch: 7, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.919 Vali Acc: 0.500 Test Loss: 0.919 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6165180206298828
Epoch: 8, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.959 Vali Acc: 0.456 Test Loss: 0.959 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.639378309249878
Epoch: 9, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.054 Vali Acc: 0.478 Test Loss: 1.054 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6042358875274658
Epoch: 10, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.386291742324829
Epoch: 11, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.133 Vali Acc: 0.461 Test Loss: 1.133 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5752997398376465
Epoch: 12, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.215 Vali Acc: 0.456 Test Loss: 1.215 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6575229167938232
Epoch: 13, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.321 Vali Acc: 0.483 Test Loss: 1.321 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 28306
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7170488834381104
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.684 Vali Acc: 0.567 Test Loss: 0.684 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 1.1698319911956787
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.691 Vali Acc: 0.533 Test Loss: 0.691 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2205097675323486
Epoch: 3, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.699 Vali Acc: 0.544 Test Loss: 0.699 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2946369647979736
Epoch: 4, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.712 Vali Acc: 0.533 Test Loss: 0.712 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3246071338653564
Epoch: 5, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5760068893432617
Epoch: 6, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.746 Vali Acc: 0.506 Test Loss: 0.746 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4930901527404785
Epoch: 7, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.806 Vali Acc: 0.506 Test Loss: 0.806 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4486863613128662
Epoch: 8, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.822 Vali Acc: 0.467 Test Loss: 0.822 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2431089878082275
Epoch: 9, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.860 Vali Acc: 0.467 Test Loss: 0.860 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4318957328796387
Epoch: 10, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.925 Vali Acc: 0.467 Test Loss: 0.925 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3611066341400146
Epoch: 11, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.945 Vali Acc: 0.472 Test Loss: 0.945 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 20482
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6888513565063477
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.719 Vali Acc: 0.494 Test Loss: 0.719 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.311265468597412
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.245572805404663
Epoch: 3, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.700 Vali Acc: 0.522 Test Loss: 0.700 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.0687196254730225
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.697 Vali Acc: 0.522 Test Loss: 0.697 Test Acc: 0.522
Validation loss decreased (-0.522215 --> -0.522215).  Saving model ...
Epoch: 5 cost time: 1.404024362564087
Epoch: 5, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.701 Vali Acc: 0.528 Test Loss: 0.701 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527771).  Saving model ...
Epoch: 6 cost time: 1.5147521495819092
Epoch: 6, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.710 Vali Acc: 0.539 Test Loss: 0.710 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 7 cost time: 1.3777992725372314
Epoch: 7, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.725 Vali Acc: 0.522 Test Loss: 0.725 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4832408428192139
Epoch: 8, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.744 Vali Acc: 0.561 Test Loss: 0.744 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561104).  Saving model ...
Epoch: 9 cost time: 1.4283194541931152
Epoch: 9, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.761 Vali Acc: 0.528 Test Loss: 0.761 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5579123497009277
Epoch: 10, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.776 Vali Acc: 0.533 Test Loss: 0.776 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3648779392242432
Epoch: 11, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.815 Vali Acc: 0.517 Test Loss: 0.815 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.571413516998291
Epoch: 12, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.831 Vali Acc: 0.517 Test Loss: 0.831 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4482276439666748
Epoch: 13, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.854 Vali Acc: 0.528 Test Loss: 0.854 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.387840986251831
Epoch: 14, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.885 Vali Acc: 0.544 Test Loss: 0.885 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4622936248779297
Epoch: 15, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.905 Vali Acc: 0.544 Test Loss: 0.905 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4725217819213867
Epoch: 16, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.932 Vali Acc: 0.517 Test Loss: 0.932 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2856080532073975
Epoch: 17, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2899160385131836
Epoch: 18, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.996 Vali Acc: 0.522 Test Loss: 0.996 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 18034
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.785818576812744
Epoch: 1, Steps: 13 | Train Loss: 0.793 Vali Loss: 0.704 Vali Acc: 0.567 Test Loss: 0.704 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 1.326399803161621
Epoch: 2, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.696 Vali Acc: 0.528 Test Loss: 0.696 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2266845703125
Epoch: 3, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.694 Vali Acc: 0.556 Test Loss: 0.694 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4357094764709473
Epoch: 4, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.694 Vali Acc: 0.539 Test Loss: 0.694 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.270085096359253
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.692 Vali Acc: 0.544 Test Loss: 0.692 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3273260593414307
Epoch: 6, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.693 Vali Acc: 0.539 Test Loss: 0.693 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2540953159332275
Epoch: 7, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.702 Vali Acc: 0.544 Test Loss: 0.702 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4064817428588867
Epoch: 8, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.717 Vali Acc: 0.533 Test Loss: 0.717 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3941338062286377
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.721 Vali Acc: 0.528 Test Loss: 0.721 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2792534828186035
Epoch: 10, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.743 Vali Acc: 0.511 Test Loss: 0.743 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5887112617492676
Epoch: 11, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.762 Vali Acc: 0.511 Test Loss: 0.762 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 16930
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3877015113830566
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.776 Vali Acc: 0.433 Test Loss: 0.776 Test Acc: 0.433
Validation loss decreased (inf --> -0.433326).  Saving model ...
Epoch: 2 cost time: 1.2322325706481934
Epoch: 2, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.780 Vali Acc: 0.444 Test Loss: 0.780 Test Acc: 0.444
Validation loss decreased (-0.433326 --> -0.444437).  Saving model ...
Epoch: 3 cost time: 1.2526869773864746
Epoch: 3, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.773 Vali Acc: 0.456 Test Loss: 0.773 Test Acc: 0.456
Validation loss decreased (-0.444437 --> -0.455548).  Saving model ...
Epoch: 4 cost time: 1.2594058513641357
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.761 Vali Acc: 0.450 Test Loss: 0.761 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5288305282592773
Epoch: 5, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.759 Vali Acc: 0.472 Test Loss: 0.759 Test Acc: 0.472
Validation loss decreased (-0.455548 --> -0.472215).  Saving model ...
Epoch: 6 cost time: 1.3509159088134766
Epoch: 6, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.771 Vali Acc: 0.472 Test Loss: 0.771 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1696217060089111
Epoch: 7, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.763 Vali Acc: 0.472 Test Loss: 0.763 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2215485572814941
Epoch: 8, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.771 Vali Acc: 0.494 Test Loss: 0.771 Test Acc: 0.494
Validation loss decreased (-0.472215 --> -0.494437).  Saving model ...
Epoch: 9 cost time: 1.2842788696289062
Epoch: 9, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499992).  Saving model ...
Epoch: 10 cost time: 1.2546935081481934
Epoch: 10, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.807 Vali Acc: 0.494 Test Loss: 0.807 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3746068477630615
Epoch: 11, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3242065906524658
Epoch: 12, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.822 Vali Acc: 0.494 Test Loss: 0.822 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4112422466278076
Epoch: 13, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.843 Vali Acc: 0.517 Test Loss: 0.843 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516658).  Saving model ...
Epoch: 14 cost time: 1.2214009761810303
Epoch: 14, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.843 Vali Acc: 0.483 Test Loss: 0.843 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4166150093078613
Epoch: 15, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.859 Vali Acc: 0.533 Test Loss: 0.859 Test Acc: 0.533
Validation loss decreased (-0.516658 --> -0.533325).  Saving model ...
Epoch: 16 cost time: 1.2189812660217285
Epoch: 16, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.904 Vali Acc: 0.494 Test Loss: 0.904 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2890172004699707
Epoch: 17, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.923 Vali Acc: 0.517 Test Loss: 0.923 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3444373607635498
Epoch: 18, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.911 Vali Acc: 0.522 Test Loss: 0.911 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3204529285430908
Epoch: 19, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.943 Vali Acc: 0.506 Test Loss: 0.943 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4221673011779785
Epoch: 20, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.970 Vali Acc: 0.500 Test Loss: 0.970 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2276179790496826
Epoch: 21, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.984 Vali Acc: 0.506 Test Loss: 0.984 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5223748683929443
Epoch: 22, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.997 Vali Acc: 0.511 Test Loss: 0.997 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.288623571395874
Epoch: 23, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.024 Vali Acc: 0.517 Test Loss: 1.024 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4626173973083496
Epoch: 24, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.049 Vali Acc: 0.511 Test Loss: 1.049 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1691200733184814
Epoch: 25, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.085 Vali Acc: 0.511 Test Loss: 1.085 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 16498
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8935608863830566
Epoch: 1, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.808 Vali Acc: 0.467 Test Loss: 0.808 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.302123785018921
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.808 Vali Acc: 0.456 Test Loss: 0.808 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4081871509552002
Epoch: 3, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.801 Vali Acc: 0.461 Test Loss: 0.801 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5385363101959229
Epoch: 4, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.804 Vali Acc: 0.478 Test Loss: 0.804 Test Acc: 0.478
Validation loss decreased (-0.466659 --> -0.477770).  Saving model ...
Epoch: 5 cost time: 1.630568265914917
Epoch: 5, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.800 Vali Acc: 0.467 Test Loss: 0.800 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2752459049224854
Epoch: 6, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.802 Vali Acc: 0.478 Test Loss: 0.802 Test Acc: 0.478
Validation loss decreased (-0.477770 --> -0.477770).  Saving model ...
Epoch: 7 cost time: 1.1171543598175049
Epoch: 7, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.798 Vali Acc: 0.511 Test Loss: 0.798 Test Acc: 0.511
Validation loss decreased (-0.477770 --> -0.511103).  Saving model ...
Epoch: 8 cost time: 1.5624327659606934
Epoch: 8, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.805 Vali Acc: 0.494 Test Loss: 0.805 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6431071758270264
Epoch: 9, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.811 Vali Acc: 0.511 Test Loss: 0.811 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4520671367645264
Epoch: 10, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7907273769378662
Epoch: 11, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.827 Vali Acc: 0.511 Test Loss: 0.827 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3891181945800781
Epoch: 12, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.830 Vali Acc: 0.511 Test Loss: 0.830 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8111250400543213
Epoch: 13, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.858 Vali Acc: 0.528 Test Loss: 0.858 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527769).  Saving model ...
Epoch: 14 cost time: 1.7142798900604248
Epoch: 14, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.860 Vali Acc: 0.522 Test Loss: 0.860 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4601759910583496
Epoch: 15, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.869 Vali Acc: 0.522 Test Loss: 0.869 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6972651481628418
Epoch: 16, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.888 Vali Acc: 0.533 Test Loss: 0.888 Test Acc: 0.533
Validation loss decreased (-0.527769 --> -0.533324).  Saving model ...
Epoch: 17 cost time: 1.4771437644958496
Epoch: 17, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.893 Vali Acc: 0.511 Test Loss: 0.893 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6022052764892578
Epoch: 18, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.913 Vali Acc: 0.517 Test Loss: 0.913 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8418970108032227
Epoch: 19, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.943 Vali Acc: 0.528 Test Loss: 0.943 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.533766508102417
Epoch: 20, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.944 Vali Acc: 0.522 Test Loss: 0.944 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4827139377593994
Epoch: 21, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.975 Vali Acc: 0.506 Test Loss: 0.975 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3828487396240234
Epoch: 22, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.986 Vali Acc: 0.522 Test Loss: 0.986 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.306387186050415
Epoch: 23, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.009 Vali Acc: 0.489 Test Loss: 1.009 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.330186128616333
Epoch: 24, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.042 Vali Acc: 0.494 Test Loss: 1.042 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2425565719604492
Epoch: 25, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4770333766937256
Epoch: 26, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.057 Vali Acc: 0.494 Test Loss: 1.057 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 16530
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.928903341293335
Epoch: 1, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.793 Vali Acc: 0.511 Test Loss: 0.793 Test Acc: 0.511
Validation loss decreased (inf --> -0.511103).  Saving model ...
Epoch: 2 cost time: 1.4295809268951416
Epoch: 2, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.754 Vali Acc: 0.517 Test Loss: 0.754 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.3670244216918945
Epoch: 3, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.736 Vali Acc: 0.544 Test Loss: 0.736 Test Acc: 0.544
Validation loss decreased (-0.516659 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.3015704154968262
Epoch: 4, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.4496479034423828
Epoch: 5, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.714 Vali Acc: 0.561 Test Loss: 0.714 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561104).  Saving model ...
Epoch: 6 cost time: 1.351022720336914
Epoch: 6, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.719 Vali Acc: 0.539 Test Loss: 0.719 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4913108348846436
Epoch: 7, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.727 Vali Acc: 0.544 Test Loss: 0.727 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5255200862884521
Epoch: 8, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.734 Vali Acc: 0.544 Test Loss: 0.734 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4418888092041016
Epoch: 9, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.734 Vali Acc: 0.533 Test Loss: 0.734 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.45155668258667
Epoch: 10, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.743 Vali Acc: 0.533 Test Loss: 0.743 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3487796783447266
Epoch: 11, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.768 Vali Acc: 0.544 Test Loss: 0.768 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.575716257095337
Epoch: 12, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.783 Vali Acc: 0.539 Test Loss: 0.783 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2517054080963135
Epoch: 13, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.793 Vali Acc: 0.556 Test Loss: 0.793 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8426284790039062
Epoch: 14, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.803 Vali Acc: 0.539 Test Loss: 0.803 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.214003324508667
Epoch: 15, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 17218
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.390117883682251
Epoch: 1, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.743 Vali Acc: 0.494 Test Loss: 0.743 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 2.1880505084991455
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.717 Vali Acc: 0.567 Test Loss: 0.717 Test Acc: 0.567
Validation loss decreased (-0.494437 --> -0.566659).  Saving model ...
Epoch: 3 cost time: 1.6588349342346191
Epoch: 3, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7551310062408447
Epoch: 4, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5957510471343994
Epoch: 5, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.844 Vali Acc: 0.494 Test Loss: 0.844 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7433621883392334
Epoch: 6, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.927 Vali Acc: 0.494 Test Loss: 0.927 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.733497142791748
Epoch: 7, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.940 Vali Acc: 0.444 Test Loss: 0.940 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8674061298370361
Epoch: 8, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9649591445922852
Epoch: 9, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.059 Vali Acc: 0.472 Test Loss: 1.059 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9912784099578857
Epoch: 10, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.080 Vali Acc: 0.472 Test Loss: 1.080 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8765947818756104
Epoch: 11, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.222 Vali Acc: 0.494 Test Loss: 1.222 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6712918281555176
Epoch: 12, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.165 Vali Acc: 0.478 Test Loss: 1.165 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 24082
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.544508218765259
Epoch: 1, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.743 Vali Acc: 0.489 Test Loss: 0.743 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.312736988067627
Epoch: 2, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.740 Vali Acc: 0.533 Test Loss: 0.740 Test Acc: 0.533
Validation loss decreased (-0.488881 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.5602047443389893
Epoch: 3, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.730 Vali Acc: 0.467 Test Loss: 0.730 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6361377239227295
Epoch: 4, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.743 Vali Acc: 0.522 Test Loss: 0.743 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.828956127166748
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.755 Vali Acc: 0.467 Test Loss: 0.755 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3713605403900146
Epoch: 6, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.782 Vali Acc: 0.467 Test Loss: 0.782 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4940533638000488
Epoch: 7, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.795 Vali Acc: 0.483 Test Loss: 0.795 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4810047149658203
Epoch: 8, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.851 Vali Acc: 0.456 Test Loss: 0.851 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.404984951019287
Epoch: 9, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.857 Vali Acc: 0.472 Test Loss: 0.857 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.497790813446045
Epoch: 10, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.940 Vali Acc: 0.478 Test Loss: 0.940 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6141104698181152
Epoch: 11, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.960 Vali Acc: 0.472 Test Loss: 0.960 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6403379440307617
Epoch: 12, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.966 Vali Acc: 0.461 Test Loss: 0.966 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 16258
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.4053955078125
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.744 Vali Acc: 0.489 Test Loss: 0.744 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.4218432903289795
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.742 Vali Acc: 0.494 Test Loss: 0.742 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.4525508880615234
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.749 Vali Acc: 0.489 Test Loss: 0.749 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5790362358093262
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.736 Vali Acc: 0.528 Test Loss: 0.736 Test Acc: 0.528
Validation loss decreased (-0.494437 --> -0.527770).  Saving model ...
Epoch: 5 cost time: 1.3909053802490234
Epoch: 5, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8171117305755615
Epoch: 6, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.750 Vali Acc: 0.472 Test Loss: 0.750 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.325101613998413
Epoch: 7, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.763 Vali Acc: 0.489 Test Loss: 0.763 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4113147258758545
Epoch: 8, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.777 Vali Acc: 0.494 Test Loss: 0.777 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9440629482269287
Epoch: 9, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.794 Vali Acc: 0.506 Test Loss: 0.794 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3662164211273193
Epoch: 10, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.837 Vali Acc: 0.506 Test Loss: 0.837 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6163437366485596
Epoch: 11, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.867 Vali Acc: 0.478 Test Loss: 0.867 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3261597156524658
Epoch: 12, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.914 Vali Acc: 0.494 Test Loss: 0.914 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7643439769744873
Epoch: 13, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.909 Vali Acc: 0.472 Test Loss: 0.909 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2626380920410156
Epoch: 14, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.950 Vali Acc: 0.489 Test Loss: 0.950 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 13810
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5556581020355225
Epoch: 1, Steps: 13 | Train Loss: 0.824 Vali Loss: 0.717 Vali Acc: 0.539 Test Loss: 0.717 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.4915850162506104
Epoch: 2, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.712 Vali Acc: 0.539 Test Loss: 0.712 Test Acc: 0.539
Validation loss decreased (-0.538882 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.4989192485809326
Epoch: 3, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.715 Vali Acc: 0.544 Test Loss: 0.715 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.4740631580352783
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.457862138748169
Epoch: 5, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.708 Vali Acc: 0.483 Test Loss: 0.708 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4125752449035645
Epoch: 6, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.719 Vali Acc: 0.533 Test Loss: 0.719 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3287091255187988
Epoch: 7, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.733 Vali Acc: 0.528 Test Loss: 0.733 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6473731994628906
Epoch: 8, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.737 Vali Acc: 0.522 Test Loss: 0.737 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9548630714416504
Epoch: 9, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.747 Vali Acc: 0.517 Test Loss: 0.747 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6537158489227295
Epoch: 10, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.766 Vali Acc: 0.478 Test Loss: 0.766 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.640984296798706
Epoch: 11, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.806 Vali Acc: 0.506 Test Loss: 0.806 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4586877822875977
Epoch: 12, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.329704761505127
Epoch: 13, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.838 Vali Acc: 0.511 Test Loss: 0.838 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 12706
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9328880310058594
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.752 Vali Acc: 0.467 Test Loss: 0.752 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.814260482788086
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.735 Vali Acc: 0.483 Test Loss: 0.735 Test Acc: 0.483
Validation loss decreased (-0.466659 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 1.3161540031433105
Epoch: 3, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.731 Vali Acc: 0.472 Test Loss: 0.731 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.543677568435669
Epoch: 4, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.721 Vali Acc: 0.478 Test Loss: 0.721 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4693472385406494
Epoch: 5, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.714 Vali Acc: 0.456 Test Loss: 0.714 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4182205200195312
Epoch: 6, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.721 Vali Acc: 0.456 Test Loss: 0.721 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4251596927642822
Epoch: 7, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
Validation loss decreased (-0.483326 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.3075885772705078
Epoch: 8, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505548).  Saving model ...
Epoch: 9 cost time: 1.4398047924041748
Epoch: 9, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.189934492111206
Epoch: 10, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.749 Vali Acc: 0.506 Test Loss: 0.749 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9054930210113525
Epoch: 11, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.737 Vali Acc: 0.483 Test Loss: 0.737 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3969388008117676
Epoch: 12, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.757 Vali Acc: 0.511 Test Loss: 0.757 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511104).  Saving model ...
Epoch: 13 cost time: 1.4088435173034668
Epoch: 13, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.772 Vali Acc: 0.517 Test Loss: 0.772 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 14 cost time: 1.3875982761383057
Epoch: 14, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.793 Vali Acc: 0.533 Test Loss: 0.793 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533325).  Saving model ...
Epoch: 15 cost time: 1.284862756729126
Epoch: 15, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.800 Vali Acc: 0.539 Test Loss: 0.800 Test Acc: 0.539
Validation loss decreased (-0.533325 --> -0.538881).  Saving model ...
Epoch: 16 cost time: 1.4216113090515137
Epoch: 16, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.803 Vali Acc: 0.539 Test Loss: 0.803 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3726086616516113
Epoch: 17, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.815 Vali Acc: 0.506 Test Loss: 0.815 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3905599117279053
Epoch: 18, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.840 Vali Acc: 0.511 Test Loss: 0.840 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5214002132415771
Epoch: 19, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.849 Vali Acc: 0.506 Test Loss: 0.849 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.330049991607666
Epoch: 20, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.870 Vali Acc: 0.517 Test Loss: 0.870 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.436586618423462
Epoch: 21, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.890 Vali Acc: 0.533 Test Loss: 0.890 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4085285663604736
Epoch: 22, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.917 Vali Acc: 0.517 Test Loss: 0.917 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3379735946655273
Epoch: 23, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.932 Vali Acc: 0.494 Test Loss: 0.932 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.518352746963501
Epoch: 24, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.957 Vali Acc: 0.522 Test Loss: 0.957 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.230936050415039
Epoch: 25, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.976 Vali Acc: 0.500 Test Loss: 0.976 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 12274
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.015956401824951
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.728 Vali Acc: 0.511 Test Loss: 0.728 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.415780782699585
Epoch: 2, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5723426342010498
Epoch: 3, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.718 Vali Acc: 0.522 Test Loss: 0.718 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.244626760482788
Epoch: 4, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.719 Vali Acc: 0.528 Test Loss: 0.719 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527771).  Saving model ...
Epoch: 5 cost time: 1.4209609031677246
Epoch: 5, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.717 Vali Acc: 0.533 Test Loss: 0.717 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 1.2516565322875977
Epoch: 6, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.5513207912445068
Epoch: 7, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.723 Vali Acc: 0.522 Test Loss: 0.723 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4703900814056396
Epoch: 8, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3460133075714111
Epoch: 9, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2872021198272705
Epoch: 10, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.767 Vali Acc: 0.522 Test Loss: 0.767 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3446424007415771
Epoch: 11, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.782 Vali Acc: 0.494 Test Loss: 0.782 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4224388599395752
Epoch: 12, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.787 Vali Acc: 0.511 Test Loss: 0.787 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5353612899780273
Epoch: 13, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.797 Vali Acc: 0.494 Test Loss: 0.797 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4306819438934326
Epoch: 14, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.821 Vali Acc: 0.506 Test Loss: 0.821 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3693828582763672
Epoch: 15, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.836 Vali Acc: 0.522 Test Loss: 0.836 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4809634685516357
Epoch: 16, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.855 Vali Acc: 0.533 Test Loss: 0.855 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 12306
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.739347457885742
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.724 Vali Acc: 0.533 Test Loss: 0.724 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.3801798820495605
Epoch: 2, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.699 Vali Acc: 0.539 Test Loss: 0.699 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.4747886657714844
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.698 Vali Acc: 0.550 Test Loss: 0.698 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.325937032699585
Epoch: 4, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.2020177841186523
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.695 Vali Acc: 0.550 Test Loss: 0.695 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.346386194229126
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6565525531768799
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.715 Vali Acc: 0.561 Test Loss: 0.715 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561104).  Saving model ...
Epoch: 8 cost time: 1.625885248184204
Epoch: 8, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.722 Vali Acc: 0.561 Test Loss: 0.722 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.639528512954712
Epoch: 9, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.725 Vali Acc: 0.556 Test Loss: 0.725 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5330321788787842
Epoch: 10, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7010669708251953
Epoch: 11, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.744 Vali Acc: 0.528 Test Loss: 0.744 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3516342639923096
Epoch: 12, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.764 Vali Acc: 0.528 Test Loss: 0.764 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4210436344146729
Epoch: 13, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.769 Vali Acc: 0.528 Test Loss: 0.769 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3739233016967773
Epoch: 14, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.781 Vali Acc: 0.517 Test Loss: 0.781 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.327709674835205
Epoch: 15, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.797 Vali Acc: 0.506 Test Loss: 0.797 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5098042488098145
Epoch: 16, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3572087287902832
Epoch: 17, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.839 Vali Acc: 0.517 Test Loss: 0.839 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el2_dm16_nh4_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 12994
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.3117759227752686
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.771 Vali Acc: 0.528 Test Loss: 0.771 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 1.7006137371063232
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.922 Vali Acc: 0.461 Test Loss: 0.922 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.109670639038086
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.283 Vali Acc: 0.494 Test Loss: 1.283 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9654910564422607
Epoch: 4, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.391 Vali Acc: 0.517 Test Loss: 1.391 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1212048530578613
Epoch: 5, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.693 Vali Acc: 0.511 Test Loss: 1.693 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0306599140167236
Epoch: 6, Steps: 13 | Train Loss: 0.510 Vali Loss: 2.214 Vali Acc: 0.467 Test Loss: 2.214 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.961979866027832
Epoch: 7, Steps: 13 | Train Loss: 0.319 Vali Loss: 2.373 Vali Acc: 0.472 Test Loss: 2.373 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7821671962738037
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 2.952 Vali Acc: 0.494 Test Loss: 2.952 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6445307731628418
Epoch: 9, Steps: 13 | Train Loss: 0.359 Vali Loss: 3.103 Vali Acc: 0.467 Test Loss: 3.103 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.848280668258667
Epoch: 10, Steps: 13 | Train Loss: 0.262 Vali Loss: 3.511 Vali Acc: 0.472 Test Loss: 3.511 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.705152988433838
Epoch: 11, Steps: 13 | Train Loss: 0.270 Vali Loss: 3.677 Vali Acc: 0.456 Test Loss: 3.677 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 272642
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.260964870452881
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.709 Vali Acc: 0.606 Test Loss: 0.709 Test Acc: 0.606
Validation loss decreased (inf --> -0.605548).  Saving model ...
Epoch: 2 cost time: 1.5987703800201416
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.886 Vali Acc: 0.533 Test Loss: 0.886 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.361384391784668
Epoch: 3, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.936 Vali Acc: 0.472 Test Loss: 0.936 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.571098804473877
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.147 Vali Acc: 0.489 Test Loss: 1.147 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3320906162261963
Epoch: 5, Steps: 13 | Train Loss: 0.443 Vali Loss: 1.322 Vali Acc: 0.500 Test Loss: 1.322 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3848905563354492
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.435 Vali Acc: 0.517 Test Loss: 1.435 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5235257148742676
Epoch: 7, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.690 Vali Acc: 0.483 Test Loss: 1.690 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.351576566696167
Epoch: 8, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.845 Vali Acc: 0.461 Test Loss: 1.845 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2491974830627441
Epoch: 9, Steps: 13 | Train Loss: 0.226 Vali Loss: 2.106 Vali Acc: 0.461 Test Loss: 2.106 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1250975131988525
Epoch: 10, Steps: 13 | Train Loss: 0.199 Vali Loss: 2.212 Vali Acc: 0.456 Test Loss: 2.212 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2131586074829102
Epoch: 11, Steps: 13 | Train Loss: 0.163 Vali Loss: 2.719 Vali Acc: 0.461 Test Loss: 2.719 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6055555555555555
model parameter : 210050
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1641952991485596
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.728 Vali Acc: 0.539 Test Loss: 0.728 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.2041854858398438
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.781 Vali Acc: 0.567 Test Loss: 0.781 Test Acc: 0.567
Validation loss decreased (-0.538882 --> -0.566659).  Saving model ...
Epoch: 3 cost time: 1.096933364868164
Epoch: 3, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.841 Vali Acc: 0.533 Test Loss: 0.841 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.180678129196167
Epoch: 4, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.971 Vali Acc: 0.489 Test Loss: 0.971 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2776765823364258
Epoch: 5, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5208661556243896
Epoch: 6, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.264 Vali Acc: 0.483 Test Loss: 1.264 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3848412036895752
Epoch: 7, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.419 Vali Acc: 0.528 Test Loss: 1.419 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5619513988494873
Epoch: 8, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.514 Vali Acc: 0.511 Test Loss: 1.514 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.487330675125122
Epoch: 9, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.961 Vali Acc: 0.517 Test Loss: 1.961 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2783405780792236
Epoch: 10, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.870 Vali Acc: 0.494 Test Loss: 1.870 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.342153549194336
Epoch: 11, Steps: 13 | Train Loss: 0.209 Vali Loss: 2.028 Vali Acc: 0.483 Test Loss: 2.028 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1710278987884521
Epoch: 12, Steps: 13 | Train Loss: 0.205 Vali Loss: 2.398 Vali Acc: 0.506 Test Loss: 2.398 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 190466
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.698826789855957
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.709 Vali Acc: 0.544 Test Loss: 0.709 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.281292200088501
Epoch: 2, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.755 Vali Acc: 0.528 Test Loss: 0.755 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2971575260162354
Epoch: 3, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.810 Vali Acc: 0.478 Test Loss: 0.810 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5835564136505127
Epoch: 4, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.999 Vali Acc: 0.500 Test Loss: 0.999 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2268385887145996
Epoch: 5, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.062 Vali Acc: 0.472 Test Loss: 1.062 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2859454154968262
Epoch: 6, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3496360778808594
Epoch: 7, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.234 Vali Acc: 0.528 Test Loss: 1.234 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2565572261810303
Epoch: 8, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.371 Vali Acc: 0.494 Test Loss: 1.371 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.527726173400879
Epoch: 9, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.558 Vali Acc: 0.522 Test Loss: 1.558 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.360886573791504
Epoch: 10, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.735 Vali Acc: 0.539 Test Loss: 1.735 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3890876770019531
Epoch: 11, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.776 Vali Acc: 0.472 Test Loss: 1.776 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 181634
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.246381759643555
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4149713516235352
Epoch: 2, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.771 Vali Acc: 0.444 Test Loss: 0.771 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.254741907119751
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.865 Vali Acc: 0.489 Test Loss: 0.865 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3858587741851807
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.905 Vali Acc: 0.489 Test Loss: 0.905 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.395261287689209
Epoch: 5, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.055 Vali Acc: 0.494 Test Loss: 1.055 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3918790817260742
Epoch: 6, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.148 Vali Acc: 0.489 Test Loss: 1.148 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4391512870788574
Epoch: 7, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.256 Vali Acc: 0.506 Test Loss: 1.256 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505543).  Saving model ...
Epoch: 8 cost time: 1.3730525970458984
Epoch: 8, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.362 Vali Acc: 0.494 Test Loss: 1.362 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.293454885482788
Epoch: 9, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.386 Vali Acc: 0.472 Test Loss: 1.386 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2977652549743652
Epoch: 10, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.511 Vali Acc: 0.494 Test Loss: 1.511 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3163435459136963
Epoch: 11, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3482666015625
Epoch: 12, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.685 Vali Acc: 0.528 Test Loss: 1.685 Test Acc: 0.528
Validation loss decreased (-0.505543 --> -0.527761).  Saving model ...
Epoch: 13 cost time: 1.3540594577789307
Epoch: 13, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.949 Vali Acc: 0.528 Test Loss: 1.949 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5247366428375244
Epoch: 14, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.869 Vali Acc: 0.494 Test Loss: 1.869 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1384730339050293
Epoch: 15, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.911 Vali Acc: 0.478 Test Loss: 1.911 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.433027982711792
Epoch: 16, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.083 Vali Acc: 0.494 Test Loss: 2.083 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2254064083099365
Epoch: 17, Steps: 13 | Train Loss: 0.180 Vali Loss: 2.229 Vali Acc: 0.472 Test Loss: 2.229 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2948105335235596
Epoch: 18, Steps: 13 | Train Loss: 0.135 Vali Loss: 2.307 Vali Acc: 0.489 Test Loss: 2.307 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0200185775756836
Epoch: 19, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.417 Vali Acc: 0.500 Test Loss: 2.417 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1418123245239258
Epoch: 20, Steps: 13 | Train Loss: 0.075 Vali Loss: 2.574 Vali Acc: 0.478 Test Loss: 2.574 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.09897780418396
Epoch: 21, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.667 Vali Acc: 0.472 Test Loss: 2.667 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4036149978637695
Epoch: 22, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.782 Vali Acc: 0.472 Test Loss: 2.782 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 178178
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.74869441986084
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.701 Vali Acc: 0.583 Test Loss: 0.701 Test Acc: 0.583
Validation loss decreased (inf --> -0.583326).  Saving model ...
Epoch: 2 cost time: 1.7411565780639648
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.727 Vali Acc: 0.544 Test Loss: 0.727 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4820737838745117
Epoch: 3, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.763 Vali Acc: 0.511 Test Loss: 0.763 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3889751434326172
Epoch: 4, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2351679801940918
Epoch: 5, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.921 Vali Acc: 0.511 Test Loss: 0.921 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.257594108581543
Epoch: 6, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.976 Vali Acc: 0.506 Test Loss: 0.976 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4744398593902588
Epoch: 7, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.046 Vali Acc: 0.489 Test Loss: 1.046 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4940953254699707
Epoch: 8, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.143 Vali Acc: 0.478 Test Loss: 1.143 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1995210647583008
Epoch: 9, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.198 Vali Acc: 0.494 Test Loss: 1.198 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3575146198272705
Epoch: 10, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.329 Vali Acc: 0.506 Test Loss: 1.329 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2177538871765137
Epoch: 11, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.364 Vali Acc: 0.506 Test Loss: 1.364 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 178434
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.508504629135132
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.736 Vali Acc: 0.478 Test Loss: 0.736 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.041140079498291
Epoch: 2, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.735 Vali Acc: 0.511 Test Loss: 0.735 Test Acc: 0.511
Validation loss decreased (-0.477770 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.2198879718780518
Epoch: 3, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.771 Vali Acc: 0.517 Test Loss: 0.771 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.3686785697937012
Epoch: 4, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2524099349975586
Epoch: 5, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.839 Vali Acc: 0.483 Test Loss: 0.839 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2974731922149658
Epoch: 6, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.967 Vali Acc: 0.506 Test Loss: 0.967 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2119879722595215
Epoch: 7, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.983 Vali Acc: 0.494 Test Loss: 0.983 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4279632568359375
Epoch: 8, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.067 Vali Acc: 0.500 Test Loss: 1.067 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1267857551574707
Epoch: 9, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.146 Vali Acc: 0.511 Test Loss: 1.146 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1400151252746582
Epoch: 10, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.188 Vali Acc: 0.489 Test Loss: 1.188 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.082841396331787
Epoch: 11, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.230 Vali Acc: 0.506 Test Loss: 1.230 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1734795570373535
Epoch: 12, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.424 Vali Acc: 0.494 Test Loss: 1.424 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.051764965057373
Epoch: 13, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.420 Vali Acc: 0.483 Test Loss: 1.420 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 183938
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6266627311706543
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 1.017 Vali Acc: 0.494 Test Loss: 1.017 Test Acc: 0.494
Validation loss decreased (inf --> -0.494434).  Saving model ...
Epoch: 2 cost time: 1.5398035049438477
Epoch: 2, Steps: 13 | Train Loss: 0.703 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.494434 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 1.6260762214660645
Epoch: 3, Steps: 13 | Train Loss: 0.515 Vali Loss: 1.182 Vali Acc: 0.478 Test Loss: 1.182 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5979197025299072
Epoch: 4, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.406 Vali Acc: 0.478 Test Loss: 1.406 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6755387783050537
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.731 Vali Acc: 0.467 Test Loss: 1.731 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4436562061309814
Epoch: 6, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.975 Vali Acc: 0.450 Test Loss: 1.975 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4995224475860596
Epoch: 7, Steps: 13 | Train Loss: 0.256 Vali Loss: 2.359 Vali Acc: 0.450 Test Loss: 2.359 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5722947120666504
Epoch: 8, Steps: 13 | Train Loss: 0.285 Vali Loss: 3.050 Vali Acc: 0.489 Test Loss: 3.050 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.459430456161499
Epoch: 9, Steps: 13 | Train Loss: 0.387 Vali Loss: 2.710 Vali Acc: 0.467 Test Loss: 2.710 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6377220153808594
Epoch: 10, Steps: 13 | Train Loss: 0.197 Vali Loss: 2.873 Vali Acc: 0.528 Test Loss: 2.873 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.624072790145874
Epoch: 11, Steps: 13 | Train Loss: 0.272 Vali Loss: 3.282 Vali Acc: 0.450 Test Loss: 3.282 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4504485130310059
Epoch: 12, Steps: 13 | Train Loss: 0.299 Vali Loss: 4.177 Vali Acc: 0.456 Test Loss: 4.177 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 239746
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.7095277309417725
Epoch: 1, Steps: 13 | Train Loss: 0.824 Vali Loss: 0.810 Vali Acc: 0.489 Test Loss: 0.810 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.4689826965332031
Epoch: 2, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.900 Vali Acc: 0.522 Test Loss: 0.900 Test Acc: 0.522
Validation loss decreased (-0.488881 --> -0.522213).  Saving model ...
Epoch: 3 cost time: 1.2997090816497803
Epoch: 3, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.023 Vali Acc: 0.511 Test Loss: 1.023 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4748539924621582
Epoch: 4, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.170 Vali Acc: 0.522 Test Loss: 1.170 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4763057231903076
Epoch: 5, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.223 Vali Acc: 0.494 Test Loss: 1.223 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4672038555145264
Epoch: 6, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.403 Vali Acc: 0.478 Test Loss: 1.403 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.354417085647583
Epoch: 7, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.593 Vali Acc: 0.539 Test Loss: 1.593 Test Acc: 0.539
Validation loss decreased (-0.522213 --> -0.538873).  Saving model ...
Epoch: 8 cost time: 1.6478683948516846
Epoch: 8, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.885 Vali Acc: 0.444 Test Loss: 1.885 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3767240047454834
Epoch: 9, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.987 Vali Acc: 0.483 Test Loss: 1.987 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3231472969055176
Epoch: 10, Steps: 13 | Train Loss: 0.215 Vali Loss: 2.137 Vali Acc: 0.511 Test Loss: 2.137 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4782352447509766
Epoch: 11, Steps: 13 | Train Loss: 0.178 Vali Loss: 2.333 Vali Acc: 0.528 Test Loss: 2.333 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3227307796478271
Epoch: 12, Steps: 13 | Train Loss: 0.182 Vali Loss: 2.765 Vali Acc: 0.461 Test Loss: 2.765 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2733242511749268
Epoch: 13, Steps: 13 | Train Loss: 0.168 Vali Loss: 2.796 Vali Acc: 0.494 Test Loss: 2.796 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3711726665496826
Epoch: 14, Steps: 13 | Train Loss: 0.179 Vali Loss: 3.122 Vali Acc: 0.444 Test Loss: 3.122 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3823955059051514
Epoch: 15, Steps: 13 | Train Loss: 0.158 Vali Loss: 3.144 Vali Acc: 0.494 Test Loss: 3.144 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5236186981201172
Epoch: 16, Steps: 13 | Train Loss: 0.067 Vali Loss: 3.322 Vali Acc: 0.494 Test Loss: 3.322 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2590110301971436
Epoch: 17, Steps: 13 | Train Loss: 0.051 Vali Loss: 3.644 Vali Acc: 0.506 Test Loss: 3.644 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 177154
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.955758810043335
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.763 Vali Acc: 0.494 Test Loss: 0.763 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.5731894969940186
Epoch: 2, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.783 Vali Acc: 0.517 Test Loss: 0.783 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.6798059940338135
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.962 Vali Acc: 0.472 Test Loss: 0.962 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4336249828338623
Epoch: 4, Steps: 13 | Train Loss: 0.556 Vali Loss: 1.049 Vali Acc: 0.472 Test Loss: 1.049 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5695433616638184
Epoch: 5, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.089 Vali Acc: 0.506 Test Loss: 1.089 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5262641906738281
Epoch: 6, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.338 Vali Acc: 0.528 Test Loss: 1.338 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527764).  Saving model ...
Epoch: 7 cost time: 1.5008690357208252
Epoch: 7, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.401 Vali Acc: 0.500 Test Loss: 1.401 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.279691219329834
Epoch: 8, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.473 Vali Acc: 0.472 Test Loss: 1.473 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1887001991271973
Epoch: 9, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2464959621429443
Epoch: 10, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.905 Vali Acc: 0.489 Test Loss: 1.905 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3721983432769775
Epoch: 11, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.931 Vali Acc: 0.472 Test Loss: 1.931 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4524195194244385
Epoch: 12, Steps: 13 | Train Loss: 0.193 Vali Loss: 2.141 Vali Acc: 0.522 Test Loss: 2.141 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.43717360496521
Epoch: 13, Steps: 13 | Train Loss: 0.150 Vali Loss: 2.546 Vali Acc: 0.500 Test Loss: 2.546 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3922722339630127
Epoch: 14, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.581 Vali Acc: 0.511 Test Loss: 2.581 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4872159957885742
Epoch: 15, Steps: 13 | Train Loss: 0.144 Vali Loss: 2.566 Vali Acc: 0.489 Test Loss: 2.566 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3404669761657715
Epoch: 16, Steps: 13 | Train Loss: 0.110 Vali Loss: 2.777 Vali Acc: 0.506 Test Loss: 2.777 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 157570
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9904420375823975
Epoch: 1, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.717 Vali Acc: 0.506 Test Loss: 0.717 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.4069411754608154
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.736 Vali Acc: 0.517 Test Loss: 0.736 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.3685638904571533
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.823 Vali Acc: 0.517 Test Loss: 0.823 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6313037872314453
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.936 Vali Acc: 0.500 Test Loss: 0.936 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.778543472290039
Epoch: 5, Steps: 13 | Train Loss: 0.489 Vali Loss: 1.022 Vali Acc: 0.511 Test Loss: 1.022 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.420186996459961
Epoch: 6, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.309 Vali Acc: 0.511 Test Loss: 1.309 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.335967779159546
Epoch: 7, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.242 Vali Acc: 0.528 Test Loss: 1.242 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527765).  Saving model ...
Epoch: 8 cost time: 1.5727899074554443
Epoch: 8, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.387 Vali Acc: 0.511 Test Loss: 1.387 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9128434658050537
Epoch: 9, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.470 Vali Acc: 0.478 Test Loss: 1.470 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5778484344482422
Epoch: 10, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.575 Vali Acc: 0.506 Test Loss: 1.575 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4354603290557861
Epoch: 11, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.716 Vali Acc: 0.489 Test Loss: 1.716 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6196835041046143
Epoch: 12, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.857 Vali Acc: 0.511 Test Loss: 1.857 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.468313455581665
Epoch: 13, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.941 Vali Acc: 0.467 Test Loss: 1.941 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.466747522354126
Epoch: 14, Steps: 13 | Train Loss: 0.211 Vali Loss: 2.052 Vali Acc: 0.478 Test Loss: 2.052 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3770241737365723
Epoch: 15, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.137 Vali Acc: 0.500 Test Loss: 2.137 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3288443088531494
Epoch: 16, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.416 Vali Acc: 0.489 Test Loss: 2.416 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2910332679748535
Epoch: 17, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.475 Vali Acc: 0.483 Test Loss: 2.475 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 148738
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9068121910095215
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.756 Vali Acc: 0.439 Test Loss: 0.756 Test Acc: 0.439
Validation loss decreased (inf --> -0.438881).  Saving model ...
Epoch: 2 cost time: 1.5785481929779053
Epoch: 2, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.746 Vali Acc: 0.461 Test Loss: 0.746 Test Acc: 0.461
Validation loss decreased (-0.438881 --> -0.461104).  Saving model ...
Epoch: 3 cost time: 1.3712856769561768
Epoch: 3, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.755 Vali Acc: 0.517 Test Loss: 0.755 Test Acc: 0.517
Validation loss decreased (-0.461104 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.2626843452453613
Epoch: 4, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2502615451812744
Epoch: 5, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.887 Vali Acc: 0.511 Test Loss: 0.887 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2600841522216797
Epoch: 6, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.2383787631988525
Epoch: 7, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.097 Vali Acc: 0.494 Test Loss: 1.097 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2658634185791016
Epoch: 8, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.268 Vali Acc: 0.494 Test Loss: 1.268 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.366454839706421
Epoch: 9, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.273 Vali Acc: 0.478 Test Loss: 1.273 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4628689289093018
Epoch: 10, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.448 Vali Acc: 0.517 Test Loss: 1.448 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4640061855316162
Epoch: 11, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.473 Vali Acc: 0.500 Test Loss: 1.473 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.322601318359375
Epoch: 12, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2742822170257568
Epoch: 13, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.649 Vali Acc: 0.472 Test Loss: 1.649 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3060908317565918
Epoch: 14, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.745 Vali Acc: 0.483 Test Loss: 1.745 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2900831699371338
Epoch: 15, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.898 Vali Acc: 0.522 Test Loss: 1.898 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5422933101654053
Epoch: 16, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.958 Vali Acc: 0.506 Test Loss: 1.958 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 145282
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.603079319000244
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.626009225845337
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.720 Vali Acc: 0.533 Test Loss: 0.720 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.362302303314209
Epoch: 3, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.760 Vali Acc: 0.539 Test Loss: 0.760 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4633522033691406
Epoch: 4, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.799 Vali Acc: 0.528 Test Loss: 0.799 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4659335613250732
Epoch: 5, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.848 Vali Acc: 0.506 Test Loss: 0.848 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1976945400238037
Epoch: 6, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.943 Vali Acc: 0.494 Test Loss: 0.943 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.627145767211914
Epoch: 7, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.983 Vali Acc: 0.511 Test Loss: 0.983 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8272254467010498
Epoch: 8, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.092 Vali Acc: 0.522 Test Loss: 1.092 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6789519786834717
Epoch: 9, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.129 Vali Acc: 0.483 Test Loss: 1.129 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0578653812408447
Epoch: 10, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.320 Vali Acc: 0.478 Test Loss: 1.320 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9744284152984619
Epoch: 11, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.324 Vali Acc: 0.522 Test Loss: 1.324 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 145538
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.179680585861206
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.727 Vali Acc: 0.478 Test Loss: 0.727 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 1.2721433639526367
Epoch: 2, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.714 Vali Acc: 0.511 Test Loss: 0.714 Test Acc: 0.511
Validation loss decreased (-0.477771 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.5139515399932861
Epoch: 3, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.718 Vali Acc: 0.522 Test Loss: 0.718 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.1885662078857422
Epoch: 4, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.782 Vali Acc: 0.511 Test Loss: 0.782 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2672572135925293
Epoch: 5, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.808 Vali Acc: 0.528 Test Loss: 0.808 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527770).  Saving model ...
Epoch: 6 cost time: 1.1877541542053223
Epoch: 6, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.882 Vali Acc: 0.528 Test Loss: 0.882 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2719178199768066
Epoch: 7, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.925 Vali Acc: 0.494 Test Loss: 0.925 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3951318264007568
Epoch: 8, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.988 Vali Acc: 0.517 Test Loss: 0.988 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.386345386505127
Epoch: 9, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.046 Vali Acc: 0.522 Test Loss: 1.046 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2455382347106934
Epoch: 10, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.100 Vali Acc: 0.489 Test Loss: 1.100 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.640303373336792
Epoch: 11, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.227 Vali Acc: 0.550 Test Loss: 1.227 Test Acc: 0.550
Validation loss decreased (-0.527770 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 1.3483426570892334
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.246 Vali Acc: 0.494 Test Loss: 1.246 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9858288764953613
Epoch: 13, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.348 Vali Acc: 0.494 Test Loss: 1.348 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0752668380737305
Epoch: 14, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.476 Vali Acc: 0.483 Test Loss: 1.476 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2816972732543945
Epoch: 15, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.477 Vali Acc: 0.511 Test Loss: 1.477 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1151633262634277
Epoch: 16, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.685 Vali Acc: 0.506 Test Loss: 1.685 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2653605937957764
Epoch: 17, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.714 Vali Acc: 0.494 Test Loss: 1.714 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.116102933883667
Epoch: 18, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.931 Vali Acc: 0.506 Test Loss: 1.931 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1733512878417969
Epoch: 19, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.999 Vali Acc: 0.500 Test Loss: 1.999 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3738429546356201
Epoch: 20, Steps: 13 | Train Loss: 0.156 Vali Loss: 2.031 Vali Acc: 0.483 Test Loss: 2.031 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3726222515106201
Epoch: 21, Steps: 13 | Train Loss: 0.145 Vali Loss: 2.200 Vali Acc: 0.472 Test Loss: 2.200 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 151042
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.1855995655059814
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.784 Vali Acc: 0.494 Test Loss: 0.784 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.6625022888183594
Epoch: 2, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.928 Vali Acc: 0.472 Test Loss: 0.928 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.419917345046997
Epoch: 3, Steps: 13 | Train Loss: 0.695 Vali Loss: 1.250 Vali Acc: 0.483 Test Loss: 1.250 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4975602626800537
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 2.017 Vali Acc: 0.489 Test Loss: 2.017 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9417476654052734
Epoch: 5, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.772 Vali Acc: 0.483 Test Loss: 1.772 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1342833042144775
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.940 Vali Acc: 0.517 Test Loss: 1.940 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516647).  Saving model ...
Epoch: 7 cost time: 1.8238089084625244
Epoch: 7, Steps: 13 | Train Loss: 0.398 Vali Loss: 2.388 Vali Acc: 0.472 Test Loss: 2.388 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4260532855987549
Epoch: 8, Steps: 13 | Train Loss: 0.288 Vali Loss: 2.722 Vali Acc: 0.467 Test Loss: 2.722 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9427015781402588
Epoch: 9, Steps: 13 | Train Loss: 0.287 Vali Loss: 3.157 Vali Acc: 0.478 Test Loss: 3.157 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5851166248321533
Epoch: 10, Steps: 13 | Train Loss: 0.389 Vali Loss: 3.299 Vali Acc: 0.461 Test Loss: 3.299 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8082423210144043
Epoch: 11, Steps: 13 | Train Loss: 0.308 Vali Loss: 4.061 Vali Acc: 0.467 Test Loss: 4.061 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5444188117980957
Epoch: 12, Steps: 13 | Train Loss: 0.563 Vali Loss: 4.644 Vali Acc: 0.467 Test Loss: 4.644 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.473867416381836
Epoch: 13, Steps: 13 | Train Loss: 0.301 Vali Loss: 4.403 Vali Acc: 0.467 Test Loss: 4.403 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8103044033050537
Epoch: 14, Steps: 13 | Train Loss: 0.116 Vali Loss: 4.753 Vali Acc: 0.478 Test Loss: 4.753 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8263158798217773
Epoch: 15, Steps: 13 | Train Loss: 0.109 Vali Loss: 4.902 Vali Acc: 0.506 Test Loss: 4.902 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9539213180541992
Epoch: 16, Steps: 13 | Train Loss: 0.198 Vali Loss: 6.321 Vali Acc: 0.472 Test Loss: 6.321 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 223298
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.410493850708008
Epoch: 1, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.816 Vali Acc: 0.561 Test Loss: 0.816 Test Acc: 0.561
Validation loss decreased (inf --> -0.561103).  Saving model ...
Epoch: 2 cost time: 1.427180528640747
Epoch: 2, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.805 Vali Acc: 0.511 Test Loss: 0.805 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3680026531219482
Epoch: 3, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.950 Vali Acc: 0.511 Test Loss: 0.950 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6389081478118896
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.485257625579834
Epoch: 5, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.455 Vali Acc: 0.500 Test Loss: 1.455 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3294274806976318
Epoch: 6, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.725 Vali Acc: 0.483 Test Loss: 1.725 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3587970733642578
Epoch: 7, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.690 Vali Acc: 0.483 Test Loss: 1.690 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4076638221740723
Epoch: 8, Steps: 13 | Train Loss: 0.318 Vali Loss: 2.260 Vali Acc: 0.467 Test Loss: 2.260 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.473278522491455
Epoch: 9, Steps: 13 | Train Loss: 0.410 Vali Loss: 2.127 Vali Acc: 0.461 Test Loss: 2.127 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.236236572265625
Epoch: 10, Steps: 13 | Train Loss: 0.265 Vali Loss: 2.274 Vali Acc: 0.478 Test Loss: 2.274 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6707799434661865
Epoch: 11, Steps: 13 | Train Loss: 0.216 Vali Loss: 2.463 Vali Acc: 0.489 Test Loss: 2.463 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 160706
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.130988121032715
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.741 Vali Acc: 0.511 Test Loss: 0.741 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.324409008026123
Epoch: 2, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.746 Vali Acc: 0.539 Test Loss: 0.746 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538881).  Saving model ...
Epoch: 3 cost time: 1.2683136463165283
Epoch: 3, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.866 Vali Acc: 0.483 Test Loss: 0.866 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.512927532196045
Epoch: 4, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.964 Vali Acc: 0.539 Test Loss: 0.964 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6932470798492432
Epoch: 5, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.086 Vali Acc: 0.522 Test Loss: 1.086 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6709294319152832
Epoch: 6, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.674304723739624
Epoch: 7, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.492 Vali Acc: 0.511 Test Loss: 1.492 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3510360717773438
Epoch: 8, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.701 Vali Acc: 0.506 Test Loss: 1.701 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.376617193222046
Epoch: 9, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.806 Vali Acc: 0.506 Test Loss: 1.806 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3576490879058838
Epoch: 10, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.889 Vali Acc: 0.517 Test Loss: 1.889 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.31605863571167
Epoch: 11, Steps: 13 | Train Loss: 0.188 Vali Loss: 2.110 Vali Acc: 0.456 Test Loss: 2.110 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.505568504333496
Epoch: 12, Steps: 13 | Train Loss: 0.177 Vali Loss: 2.231 Vali Acc: 0.522 Test Loss: 2.231 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 141122
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7254862785339355
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.699 Vali Acc: 0.556 Test Loss: 0.699 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 1.3470702171325684
Epoch: 2, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.735 Vali Acc: 0.578 Test Loss: 0.735 Test Acc: 0.578
Validation loss decreased (-0.555549 --> -0.577770).  Saving model ...
Epoch: 3 cost time: 1.3406362533569336
Epoch: 3, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.802 Vali Acc: 0.506 Test Loss: 0.802 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.645655870437622
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.908 Vali Acc: 0.489 Test Loss: 0.908 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.598829746246338
Epoch: 5, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.045 Vali Acc: 0.517 Test Loss: 1.045 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.658151388168335
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5023949146270752
Epoch: 7, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.289 Vali Acc: 0.494 Test Loss: 1.289 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.695340871810913
Epoch: 8, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.516 Vali Acc: 0.506 Test Loss: 1.516 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.572131872177124
Epoch: 9, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.512 Vali Acc: 0.500 Test Loss: 1.512 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.694737434387207
Epoch: 10, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.655 Vali Acc: 0.472 Test Loss: 1.655 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5492491722106934
Epoch: 11, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.731 Vali Acc: 0.478 Test Loss: 1.731 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5836122035980225
Epoch: 12, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.911 Vali Acc: 0.494 Test Loss: 1.911 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 132290
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.333279371261597
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.721 Vali Acc: 0.506 Test Loss: 0.721 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.3532366752624512
Epoch: 2, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7988135814666748
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.774 Vali Acc: 0.517 Test Loss: 0.774 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.2840137481689453
Epoch: 4, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.859 Vali Acc: 0.489 Test Loss: 0.859 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5708787441253662
Epoch: 5, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.926 Vali Acc: 0.494 Test Loss: 0.926 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6586508750915527
Epoch: 6, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.036 Vali Acc: 0.506 Test Loss: 1.036 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7192208766937256
Epoch: 7, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.056 Vali Acc: 0.539 Test Loss: 1.056 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538878).  Saving model ...
Epoch: 8 cost time: 1.6338849067687988
Epoch: 8, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.203 Vali Acc: 0.528 Test Loss: 1.203 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5309321880340576
Epoch: 9, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.595552921295166
Epoch: 10, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.369 Vali Acc: 0.478 Test Loss: 1.369 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4251363277435303
Epoch: 11, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.625 Vali Acc: 0.517 Test Loss: 1.625 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5687825679779053
Epoch: 12, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.593 Vali Acc: 0.472 Test Loss: 1.593 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.747323751449585
Epoch: 13, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.697 Vali Acc: 0.506 Test Loss: 1.697 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7209017276763916
Epoch: 14, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.772 Vali Acc: 0.522 Test Loss: 1.772 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4468638896942139
Epoch: 15, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.878 Vali Acc: 0.494 Test Loss: 1.878 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3063225746154785
Epoch: 16, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.968 Vali Acc: 0.517 Test Loss: 1.968 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.434251308441162
Epoch: 17, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.059 Vali Acc: 0.489 Test Loss: 2.059 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 128834
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.276666164398193
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.767 Vali Acc: 0.478 Test Loss: 0.767 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.1554789543151855
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.755 Vali Acc: 0.472 Test Loss: 0.755 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5761568546295166
Epoch: 3, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.777 Vali Acc: 0.483 Test Loss: 0.777 Test Acc: 0.483
Validation loss decreased (-0.477770 --> -0.483326).  Saving model ...
Epoch: 4 cost time: 1.1282446384429932
Epoch: 4, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.827 Vali Acc: 0.478 Test Loss: 0.827 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3178186416625977
Epoch: 5, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.882 Vali Acc: 0.511 Test Loss: 0.882 Test Acc: 0.511
Validation loss decreased (-0.483326 --> -0.511102).  Saving model ...
Epoch: 6 cost time: 1.4378056526184082
Epoch: 6, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.971 Vali Acc: 0.550 Test Loss: 0.971 Test Acc: 0.550
Validation loss decreased (-0.511102 --> -0.549990).  Saving model ...
Epoch: 7 cost time: 1.787001132965088
Epoch: 7, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.022 Vali Acc: 0.511 Test Loss: 1.022 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3263144493103027
Epoch: 8, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.171 Vali Acc: 0.517 Test Loss: 1.171 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6033413410186768
Epoch: 9, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.154 Vali Acc: 0.489 Test Loss: 1.154 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6406946182250977
Epoch: 10, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.324 Vali Acc: 0.506 Test Loss: 1.324 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3535652160644531
Epoch: 11, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.323 Vali Acc: 0.478 Test Loss: 1.323 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4114463329315186
Epoch: 12, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.451 Vali Acc: 0.483 Test Loss: 1.451 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4271471500396729
Epoch: 13, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.566 Vali Acc: 0.511 Test Loss: 1.566 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1418373584747314
Epoch: 14, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.604 Vali Acc: 0.489 Test Loss: 1.604 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.165356159210205
Epoch: 15, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.721 Vali Acc: 0.483 Test Loss: 1.721 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3498296737670898
Epoch: 16, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.811 Vali Acc: 0.494 Test Loss: 1.811 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 129090
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.676570177078247
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.685 Vali Acc: 0.600 Test Loss: 0.685 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 1.1297621726989746
Epoch: 2, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.686 Vali Acc: 0.539 Test Loss: 0.686 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.187208890914917
Epoch: 3, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.719 Vali Acc: 0.544 Test Loss: 0.719 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2801787853240967
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.769 Vali Acc: 0.550 Test Loss: 0.769 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2366383075714111
Epoch: 5, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.823 Vali Acc: 0.528 Test Loss: 0.823 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2476472854614258
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.868 Vali Acc: 0.522 Test Loss: 0.868 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2261250019073486
Epoch: 7, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.932 Vali Acc: 0.517 Test Loss: 0.932 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2314515113830566
Epoch: 8, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.990 Vali Acc: 0.494 Test Loss: 0.990 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3830993175506592
Epoch: 9, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.041 Vali Acc: 0.511 Test Loss: 1.041 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2971210479736328
Epoch: 10, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.248 Vali Acc: 0.544 Test Loss: 1.248 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0842111110687256
Epoch: 11, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.243 Vali Acc: 0.533 Test Loss: 1.243 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm128_nh16_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6
model parameter : 134594
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.815993547439575
Epoch: 1, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.744 Vali Acc: 0.528 Test Loss: 0.744 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 1.4958791732788086
Epoch: 2, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.786 Vali Acc: 0.478 Test Loss: 0.786 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5907964706420898
Epoch: 3, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.913 Vali Acc: 0.467 Test Loss: 0.913 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4282808303833008
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.422494649887085
Epoch: 5, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.216 Vali Acc: 0.506 Test Loss: 1.216 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4673354625701904
Epoch: 6, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.514 Vali Acc: 0.489 Test Loss: 1.514 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5777878761291504
Epoch: 7, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.763 Vali Acc: 0.472 Test Loss: 1.763 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6201539039611816
Epoch: 8, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.666 Vali Acc: 0.461 Test Loss: 1.666 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.578977346420288
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.919 Vali Acc: 0.506 Test Loss: 1.919 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6246449947357178
Epoch: 10, Steps: 13 | Train Loss: 0.200 Vali Loss: 2.034 Vali Acc: 0.456 Test Loss: 2.034 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.39677095413208
Epoch: 11, Steps: 13 | Train Loss: 0.143 Vali Loss: 2.296 Vali Acc: 0.456 Test Loss: 2.296 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 120066
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6688249111175537
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.750 Vali Acc: 0.461 Test Loss: 0.750 Test Acc: 0.461
Validation loss decreased (inf --> -0.461104).  Saving model ...
Epoch: 2 cost time: 1.7377774715423584
Epoch: 2, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.753 Vali Acc: 0.461 Test Loss: 0.753 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6960210800170898
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.827 Vali Acc: 0.489 Test Loss: 0.827 Test Acc: 0.489
Validation loss decreased (-0.461104 --> -0.488881).  Saving model ...
Epoch: 4 cost time: 1.551206350326538
Epoch: 4, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.932 Vali Acc: 0.478 Test Loss: 0.932 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5919008255004883
Epoch: 5, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.069 Vali Acc: 0.494 Test Loss: 1.069 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494434).  Saving model ...
Epoch: 6 cost time: 1.3174710273742676
Epoch: 6, Steps: 13 | Train Loss: 0.422 Vali Loss: 1.084 Vali Acc: 0.450 Test Loss: 1.084 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3293488025665283
Epoch: 7, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.494434 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.547102451324463
Epoch: 8, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.315 Vali Acc: 0.489 Test Loss: 1.315 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6073312759399414
Epoch: 9, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.458 Vali Acc: 0.494 Test Loss: 1.458 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6245429515838623
Epoch: 10, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.598 Vali Acc: 0.489 Test Loss: 1.598 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7437665462493896
Epoch: 11, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.710 Vali Acc: 0.500 Test Loss: 1.710 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5812439918518066
Epoch: 12, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.717 Vali Acc: 0.489 Test Loss: 1.717 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4457554817199707
Epoch: 13, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.882 Vali Acc: 0.500 Test Loss: 1.882 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4788424968719482
Epoch: 14, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.999 Vali Acc: 0.478 Test Loss: 1.999 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4645748138427734
Epoch: 15, Steps: 13 | Train Loss: 0.131 Vali Loss: 2.240 Vali Acc: 0.461 Test Loss: 2.240 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.633507251739502
Epoch: 16, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.285 Vali Acc: 0.489 Test Loss: 2.285 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7652745246887207
Epoch: 17, Steps: 13 | Train Loss: 0.171 Vali Loss: 2.436 Vali Acc: 0.489 Test Loss: 2.436 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5
model parameter : 88770
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8488166332244873
Epoch: 1, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.762 Vali Acc: 0.528 Test Loss: 0.762 Test Acc: 0.528
Validation loss decreased (inf --> -0.527770).  Saving model ...
Epoch: 2 cost time: 1.5548169612884521
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.718 Vali Acc: 0.539 Test Loss: 0.718 Test Acc: 0.539
Validation loss decreased (-0.527770 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.4404540061950684
Epoch: 3, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.761 Vali Acc: 0.539 Test Loss: 0.761 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5498895645141602
Epoch: 4, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.819 Vali Acc: 0.528 Test Loss: 0.819 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3910877704620361
Epoch: 5, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.870 Vali Acc: 0.506 Test Loss: 0.870 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7611024379730225
Epoch: 6, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.962 Vali Acc: 0.522 Test Loss: 0.962 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7327048778533936
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.512068748474121
Epoch: 8, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.143 Vali Acc: 0.483 Test Loss: 1.143 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6212966442108154
Epoch: 9, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.318 Vali Acc: 0.539 Test Loss: 1.318 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6534428596496582
Epoch: 10, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.289 Vali Acc: 0.483 Test Loss: 1.289 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.348731279373169
Epoch: 11, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.449 Vali Acc: 0.500 Test Loss: 1.449 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5668375492095947
Epoch: 12, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.488 Vali Acc: 0.506 Test Loss: 1.488 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 78978
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.15083909034729
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.696 Vali Acc: 0.544 Test Loss: 0.696 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.195023536682129
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.690 Vali Acc: 0.528 Test Loss: 0.690 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2921626567840576
Epoch: 3, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.724 Vali Acc: 0.517 Test Loss: 0.724 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3268492221832275
Epoch: 4, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.767 Vali Acc: 0.522 Test Loss: 0.767 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2339904308319092
Epoch: 5, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.808 Vali Acc: 0.506 Test Loss: 0.808 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1618678569793701
Epoch: 6, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3233494758605957
Epoch: 7, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.935 Vali Acc: 0.489 Test Loss: 0.935 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4403588771820068
Epoch: 8, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.026 Vali Acc: 0.539 Test Loss: 1.026 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.153627872467041
Epoch: 9, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.064 Vali Acc: 0.478 Test Loss: 1.064 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5391428470611572
Epoch: 10, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.194 Vali Acc: 0.528 Test Loss: 1.194 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4140081405639648
Epoch: 11, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.196 Vali Acc: 0.489 Test Loss: 1.196 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 74562
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.911423206329346
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3430848121643066
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.722 Vali Acc: 0.533 Test Loss: 0.722 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.2898831367492676
Epoch: 3, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7742738723754883
Epoch: 4, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.736 Vali Acc: 0.511 Test Loss: 0.736 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2751824855804443
Epoch: 5, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.780 Vali Acc: 0.494 Test Loss: 0.780 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.346113920211792
Epoch: 6, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.822 Vali Acc: 0.511 Test Loss: 0.822 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.649824619293213
Epoch: 7, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.864 Vali Acc: 0.494 Test Loss: 0.864 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4964308738708496
Epoch: 8, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.927 Vali Acc: 0.500 Test Loss: 0.927 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1960315704345703
Epoch: 9, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.988 Vali Acc: 0.494 Test Loss: 0.988 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.270676851272583
Epoch: 10, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.049 Vali Acc: 0.483 Test Loss: 1.049 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6070146560668945
Epoch: 11, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.119 Vali Acc: 0.489 Test Loss: 1.119 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4480865001678467
Epoch: 12, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.171 Vali Acc: 0.483 Test Loss: 1.171 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 72834
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.92692494392395
Epoch: 1, Steps: 13 | Train Loss: 0.816 Vali Loss: 0.733 Vali Acc: 0.494 Test Loss: 0.733 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.014693021774292
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.740 Vali Acc: 0.511 Test Loss: 0.740 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.3395249843597412
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.737 Vali Acc: 0.528 Test Loss: 0.737 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 1.0551581382751465
Epoch: 4, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.760 Vali Acc: 0.517 Test Loss: 0.760 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4972400665283203
Epoch: 5, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.771 Vali Acc: 0.494 Test Loss: 0.771 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0193912982940674
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.820 Vali Acc: 0.478 Test Loss: 0.820 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3682236671447754
Epoch: 7, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.865 Vali Acc: 0.467 Test Loss: 0.865 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.05507493019104
Epoch: 8, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.891 Vali Acc: 0.461 Test Loss: 0.891 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2077698707580566
Epoch: 9, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.977 Vali Acc: 0.478 Test Loss: 0.977 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1703948974609375
Epoch: 10, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.036 Vali Acc: 0.472 Test Loss: 1.036 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2843520641326904
Epoch: 11, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.107 Vali Acc: 0.483 Test Loss: 1.107 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3038041591644287
Epoch: 12, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.137 Vali Acc: 0.478 Test Loss: 1.137 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2883284091949463
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.214 Vali Acc: 0.533 Test Loss: 1.214 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533321).  Saving model ...
Epoch: 14 cost time: 1.3765153884887695
Epoch: 14, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4025189876556396
Epoch: 15, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.287 Vali Acc: 0.539 Test Loss: 1.287 Test Acc: 0.539
Validation loss decreased (-0.533321 --> -0.538876).  Saving model ...
Epoch: 16 cost time: 1.1655950546264648
Epoch: 16, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.302 Vali Acc: 0.528 Test Loss: 1.302 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2505576610565186
Epoch: 17, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.403 Vali Acc: 0.506 Test Loss: 1.403 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2499065399169922
Epoch: 18, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.399 Vali Acc: 0.472 Test Loss: 1.399 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1415669918060303
Epoch: 19, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.525 Vali Acc: 0.500 Test Loss: 1.525 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0881316661834717
Epoch: 20, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.569 Vali Acc: 0.500 Test Loss: 1.569 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1250042915344238
Epoch: 21, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.683 Vali Acc: 0.489 Test Loss: 1.683 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2005033493041992
Epoch: 22, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.685 Vali Acc: 0.467 Test Loss: 1.685 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4482743740081787
Epoch: 23, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.770 Vali Acc: 0.494 Test Loss: 1.770 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2967674732208252
Epoch: 24, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.758 Vali Acc: 0.478 Test Loss: 1.758 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3756322860717773
Epoch: 25, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.845 Vali Acc: 0.494 Test Loss: 1.845 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 72962
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.015985727310181
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.739 Vali Acc: 0.489 Test Loss: 0.739 Test Acc: 0.489
Validation loss decreased (inf --> -0.488881).  Saving model ...
Epoch: 2 cost time: 1.1270349025726318
Epoch: 2, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.733 Vali Acc: 0.494 Test Loss: 0.733 Test Acc: 0.494
Validation loss decreased (-0.488881 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.240684986114502
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.738 Vali Acc: 0.489 Test Loss: 0.738 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2623019218444824
Epoch: 4, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.729 Vali Acc: 0.494 Test Loss: 0.729 Test Acc: 0.494
Validation loss decreased (-0.494437 --> -0.494437).  Saving model ...
Epoch: 5 cost time: 1.2784202098846436
Epoch: 5, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.768 Vali Acc: 0.506 Test Loss: 0.768 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505548).  Saving model ...
Epoch: 6 cost time: 1.298689603805542
Epoch: 6, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.823 Vali Acc: 0.506 Test Loss: 0.823 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6674482822418213
Epoch: 7, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.839 Vali Acc: 0.506 Test Loss: 0.839 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2544708251953125
Epoch: 8, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.842 Vali Acc: 0.528 Test Loss: 0.842 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527769).  Saving model ...
Epoch: 9 cost time: 1.1175732612609863
Epoch: 9, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.909 Vali Acc: 0.544 Test Loss: 0.909 Test Acc: 0.544
Validation loss decreased (-0.527769 --> -0.544435).  Saving model ...
Epoch: 10 cost time: 1.1287198066711426
Epoch: 10, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.974 Vali Acc: 0.517 Test Loss: 0.974 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3775763511657715
Epoch: 11, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.004 Vali Acc: 0.528 Test Loss: 1.004 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.451709508895874
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.041 Vali Acc: 0.528 Test Loss: 1.041 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5580179691314697
Epoch: 13, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.081514596939087
Epoch: 14, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.188 Vali Acc: 0.489 Test Loss: 1.188 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.248197317123413
Epoch: 15, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.254 Vali Acc: 0.489 Test Loss: 1.254 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.411278486251831
Epoch: 16, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.294 Vali Acc: 0.511 Test Loss: 1.294 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.240269660949707
Epoch: 17, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2840666770935059
Epoch: 18, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.408 Vali Acc: 0.478 Test Loss: 1.408 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3642537593841553
Epoch: 19, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.493 Vali Acc: 0.489 Test Loss: 1.493 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 75714
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.078744411468506
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.946 Vali Acc: 0.500 Test Loss: 0.946 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.408498764038086
Epoch: 2, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.768 Vali Acc: 0.511 Test Loss: 0.768 Test Acc: 0.511
Validation loss decreased (-0.499991 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 1.2692537307739258
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.884 Vali Acc: 0.506 Test Loss: 0.884 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5544061660766602
Epoch: 4, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.994 Vali Acc: 0.500 Test Loss: 0.994 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4270305633544922
Epoch: 5, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.191 Vali Acc: 0.511 Test Loss: 1.191 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3688209056854248
Epoch: 6, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.315 Vali Acc: 0.461 Test Loss: 1.315 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4266149997711182
Epoch: 7, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.414 Vali Acc: 0.478 Test Loss: 1.414 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.580700159072876
Epoch: 8, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.819 Vali Acc: 0.506 Test Loss: 1.819 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3454620838165283
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.840 Vali Acc: 0.517 Test Loss: 1.840 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516648).  Saving model ...
Epoch: 10 cost time: 1.4742200374603271
Epoch: 10, Steps: 13 | Train Loss: 0.296 Vali Loss: 2.046 Vali Acc: 0.483 Test Loss: 2.046 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3942821025848389
Epoch: 11, Steps: 13 | Train Loss: 0.357 Vali Loss: 2.209 Vali Acc: 0.478 Test Loss: 2.209 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8119182586669922
Epoch: 12, Steps: 13 | Train Loss: 0.176 Vali Loss: 2.330 Vali Acc: 0.467 Test Loss: 2.330 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7411291599273682
Epoch: 13, Steps: 13 | Train Loss: 0.138 Vali Loss: 2.679 Vali Acc: 0.467 Test Loss: 2.679 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.325269937515259
Epoch: 14, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.910 Vali Acc: 0.472 Test Loss: 2.910 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4906625747680664
Epoch: 15, Steps: 13 | Train Loss: 0.166 Vali Loss: 3.316 Vali Acc: 0.467 Test Loss: 3.316 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4577243328094482
Epoch: 16, Steps: 13 | Train Loss: 0.194 Vali Loss: 3.347 Vali Acc: 0.444 Test Loss: 3.347 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.375455379486084
Epoch: 17, Steps: 13 | Train Loss: 0.107 Vali Loss: 3.468 Vali Acc: 0.444 Test Loss: 3.468 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5205442905426025
Epoch: 18, Steps: 13 | Train Loss: 0.043 Vali Loss: 3.542 Vali Acc: 0.478 Test Loss: 3.542 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.640885353088379
Epoch: 19, Steps: 13 | Train Loss: 0.070 Vali Loss: 3.795 Vali Acc: 0.478 Test Loss: 3.795 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 103554
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.117388486862183
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.761 Vali Acc: 0.433 Test Loss: 0.761 Test Acc: 0.433
Validation loss decreased (inf --> -0.433326).  Saving model ...
Epoch: 2 cost time: 1.2446727752685547
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.797 Vali Acc: 0.528 Test Loss: 0.797 Test Acc: 0.528
Validation loss decreased (-0.433326 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.777966022491455
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.842 Vali Acc: 0.506 Test Loss: 0.842 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.918581485748291
Epoch: 4, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.903 Vali Acc: 0.483 Test Loss: 0.903 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6110267639160156
Epoch: 5, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.038 Vali Acc: 0.472 Test Loss: 1.038 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6160950660705566
Epoch: 6, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.099 Vali Acc: 0.483 Test Loss: 1.099 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.451467514038086
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.238 Vali Acc: 0.483 Test Loss: 1.238 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6437764167785645
Epoch: 8, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.302 Vali Acc: 0.483 Test Loss: 1.302 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6638786792755127
Epoch: 9, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.466 Vali Acc: 0.494 Test Loss: 1.466 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7065749168395996
Epoch: 10, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.682 Vali Acc: 0.461 Test Loss: 1.682 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.68251371383667
Epoch: 11, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.662 Vali Acc: 0.456 Test Loss: 1.662 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7349576950073242
Epoch: 12, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.890 Vali Acc: 0.489 Test Loss: 1.890 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 72258
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9366276264190674
Epoch: 1, Steps: 13 | Train Loss: 0.819 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.4089539051055908
Epoch: 2, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.712 Vali Acc: 0.533 Test Loss: 0.712 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4259495735168457
Epoch: 3, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.753 Vali Acc: 0.533 Test Loss: 0.753 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4927935600280762
Epoch: 4, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.794 Vali Acc: 0.517 Test Loss: 0.794 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4105725288391113
Epoch: 5, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.912 Vali Acc: 0.539 Test Loss: 0.912 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3260397911071777
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.976 Vali Acc: 0.522 Test Loss: 0.976 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5702283382415771
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.380265235900879
Epoch: 8, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.119 Vali Acc: 0.517 Test Loss: 1.119 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4075617790222168
Epoch: 9, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.241 Vali Acc: 0.528 Test Loss: 1.241 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.494391679763794
Epoch: 10, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.261 Vali Acc: 0.494 Test Loss: 1.261 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.483917474746704
Epoch: 11, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.334 Vali Acc: 0.478 Test Loss: 1.334 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 62466
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.06872296333313
Epoch: 1, Steps: 13 | Train Loss: 0.830 Vali Loss: 0.746 Vali Acc: 0.467 Test Loss: 0.746 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.5780813694000244
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.713 Vali Acc: 0.494 Test Loss: 0.713 Test Acc: 0.494
Validation loss decreased (-0.466659 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.5059986114501953
Epoch: 3, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.719 Vali Acc: 0.539 Test Loss: 0.719 Test Acc: 0.539
Validation loss decreased (-0.494437 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.4479079246520996
Epoch: 4, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.779 Vali Acc: 0.511 Test Loss: 0.779 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1741487979888916
Epoch: 5, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.821 Vali Acc: 0.522 Test Loss: 0.821 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.328735113143921
Epoch: 6, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.884 Vali Acc: 0.522 Test Loss: 0.884 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.448728322982788
Epoch: 7, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.927 Vali Acc: 0.533 Test Loss: 0.927 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5085339546203613
Epoch: 8, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.988 Vali Acc: 0.467 Test Loss: 0.988 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.657724142074585
Epoch: 9, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.102 Vali Acc: 0.517 Test Loss: 1.102 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3003523349761963
Epoch: 10, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.100 Vali Acc: 0.489 Test Loss: 1.100 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4943578243255615
Epoch: 11, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.174 Vali Acc: 0.494 Test Loss: 1.174 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5556015968322754
Epoch: 12, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.289 Vali Acc: 0.506 Test Loss: 1.289 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2570297718048096
Epoch: 13, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.304 Vali Acc: 0.517 Test Loss: 1.304 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 58050
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.077388525009155
Epoch: 1, Steps: 13 | Train Loss: 0.812 Vali Loss: 0.699 Vali Acc: 0.517 Test Loss: 0.699 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.6660397052764893
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.710 Vali Acc: 0.533 Test Loss: 0.710 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.3738317489624023
Epoch: 3, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.711 Vali Acc: 0.556 Test Loss: 0.711 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555548).  Saving model ...
Epoch: 4 cost time: 1.4599390029907227
Epoch: 4, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.753 Vali Acc: 0.528 Test Loss: 0.753 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.297170639038086
Epoch: 5, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.777 Vali Acc: 0.528 Test Loss: 0.777 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6177678108215332
Epoch: 6, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.800 Vali Acc: 0.517 Test Loss: 0.800 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.275993824005127
Epoch: 7, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.862 Vali Acc: 0.528 Test Loss: 0.862 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2442889213562012
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.906 Vali Acc: 0.517 Test Loss: 0.906 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0896453857421875
Epoch: 9, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.000 Vali Acc: 0.511 Test Loss: 1.000 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0723803043365479
Epoch: 10, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.991 Vali Acc: 0.500 Test Loss: 0.991 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2707865238189697
Epoch: 11, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.092 Vali Acc: 0.517 Test Loss: 1.092 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0440130233764648
Epoch: 12, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.129 Vali Acc: 0.517 Test Loss: 1.129 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.440295696258545
Epoch: 13, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.242 Vali Acc: 0.522 Test Loss: 1.242 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 56322
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.52516770362854
Epoch: 1, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2540221214294434
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.699 Vali Acc: 0.522 Test Loss: 0.699 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.0745303630828857
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.711 Vali Acc: 0.533 Test Loss: 0.711 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.2526698112487793
Epoch: 4, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1937339305877686
Epoch: 5, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.750 Vali Acc: 0.522 Test Loss: 0.750 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2446656227111816
Epoch: 6, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.785 Vali Acc: 0.511 Test Loss: 0.785 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6692352294921875
Epoch: 7, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4145760536193848
Epoch: 8, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.879 Vali Acc: 0.494 Test Loss: 0.879 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3607368469238281
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.929 Vali Acc: 0.528 Test Loss: 0.929 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2044169902801514
Epoch: 10, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.976 Vali Acc: 0.506 Test Loss: 0.976 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.489664077758789
Epoch: 11, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.062 Vali Acc: 0.483 Test Loss: 1.062 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3182494640350342
Epoch: 12, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.095 Vali Acc: 0.478 Test Loss: 1.095 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4462900161743164
Epoch: 13, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.175 Vali Acc: 0.483 Test Loss: 1.175 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 56450
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.05867075920105
Epoch: 1, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.1527228355407715
Epoch: 2, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.720 Vali Acc: 0.528 Test Loss: 0.720 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.0510149002075195
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.717 Vali Acc: 0.478 Test Loss: 0.717 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0352704524993896
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.746 Vali Acc: 0.494 Test Loss: 0.746 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3253109455108643
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.762 Vali Acc: 0.522 Test Loss: 0.762 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.205641508102417
Epoch: 6, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.810 Vali Acc: 0.522 Test Loss: 0.810 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0685162544250488
Epoch: 7, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.809 Vali Acc: 0.506 Test Loss: 0.809 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4011907577514648
Epoch: 8, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.855 Vali Acc: 0.556 Test Loss: 0.855 Test Acc: 0.556
Validation loss decreased (-0.527771 --> -0.555547).  Saving model ...
Epoch: 9 cost time: 1.1839594841003418
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.874 Vali Acc: 0.528 Test Loss: 0.874 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.047194480895996
Epoch: 10, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.936 Vali Acc: 0.522 Test Loss: 0.936 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6653876304626465
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.987 Vali Acc: 0.517 Test Loss: 0.987 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4504830837249756
Epoch: 12, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.032 Vali Acc: 0.506 Test Loss: 1.032 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0997669696807861
Epoch: 13, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2681236267089844
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.132 Vali Acc: 0.489 Test Loss: 1.132 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9942865371704102
Epoch: 15, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1581950187683105
Epoch: 16, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.265 Vali Acc: 0.494 Test Loss: 1.265 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1951241493225098
Epoch: 17, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.317 Vali Acc: 0.478 Test Loss: 1.317 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2662253379821777
Epoch: 18, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.332 Vali Acc: 0.500 Test Loss: 1.332 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 59202
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.481980562210083
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.3534996509552002
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.6386876106262207
Epoch: 3, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.936 Vali Acc: 0.528 Test Loss: 0.936 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527768).  Saving model ...
Epoch: 4 cost time: 1.3632586002349854
Epoch: 4, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.209 Vali Acc: 0.489 Test Loss: 1.209 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3827197551727295
Epoch: 5, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.117 Vali Acc: 0.489 Test Loss: 1.117 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6401140689849854
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.322 Vali Acc: 0.483 Test Loss: 1.322 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5861289501190186
Epoch: 7, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.809 Vali Acc: 0.472 Test Loss: 1.809 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4005184173583984
Epoch: 8, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.711 Vali Acc: 0.511 Test Loss: 1.711 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6644556522369385
Epoch: 9, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.996 Vali Acc: 0.467 Test Loss: 1.996 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.501676321029663
Epoch: 10, Steps: 13 | Train Loss: 0.316 Vali Loss: 2.132 Vali Acc: 0.467 Test Loss: 2.132 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3823394775390625
Epoch: 11, Steps: 13 | Train Loss: 0.160 Vali Loss: 2.228 Vali Acc: 0.467 Test Loss: 2.228 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.712226152420044
Epoch: 12, Steps: 13 | Train Loss: 0.210 Vali Loss: 2.513 Vali Acc: 0.483 Test Loss: 2.513 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.457808256149292
Epoch: 13, Steps: 13 | Train Loss: 0.175 Vali Loss: 2.764 Vali Acc: 0.483 Test Loss: 2.764 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 95298
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.342052221298218
Epoch: 1, Steps: 13 | Train Loss: 0.827 Vali Loss: 0.744 Vali Acc: 0.494 Test Loss: 0.744 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.2569530010223389
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.758 Vali Acc: 0.478 Test Loss: 0.758 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6054856777191162
Epoch: 3, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.813 Vali Acc: 0.483 Test Loss: 0.813 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2638554573059082
Epoch: 4, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.901 Vali Acc: 0.483 Test Loss: 0.901 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4075062274932861
Epoch: 5, Steps: 13 | Train Loss: 0.427 Vali Loss: 1.011 Vali Acc: 0.472 Test Loss: 1.011 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.255533218383789
Epoch: 6, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.181 Vali Acc: 0.489 Test Loss: 1.181 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1455552577972412
Epoch: 7, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.179 Vali Acc: 0.483 Test Loss: 1.179 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.553393840789795
Epoch: 8, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.303 Vali Acc: 0.478 Test Loss: 1.303 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2410860061645508
Epoch: 9, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.525 Vali Acc: 0.494 Test Loss: 1.525 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3334245681762695
Epoch: 10, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.530 Vali Acc: 0.528 Test Loss: 1.530 Test Acc: 0.528
Validation loss decreased (-0.494437 --> -0.527762).  Saving model ...
Epoch: 11 cost time: 1.3120148181915283
Epoch: 11, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.900 Vali Acc: 0.528 Test Loss: 1.900 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2240281105041504
Epoch: 12, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.869 Vali Acc: 0.511 Test Loss: 1.869 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4807400703430176
Epoch: 13, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.837 Vali Acc: 0.478 Test Loss: 1.837 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3823561668395996
Epoch: 14, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.968 Vali Acc: 0.494 Test Loss: 1.968 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2995922565460205
Epoch: 15, Steps: 13 | Train Loss: 0.173 Vali Loss: 2.011 Vali Acc: 0.489 Test Loss: 2.011 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1833643913269043
Epoch: 16, Steps: 13 | Train Loss: 0.169 Vali Loss: 2.196 Vali Acc: 0.467 Test Loss: 2.196 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.423694133758545
Epoch: 17, Steps: 13 | Train Loss: 0.184 Vali Loss: 2.521 Vali Acc: 0.483 Test Loss: 2.521 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.358109951019287
Epoch: 18, Steps: 13 | Train Loss: 0.243 Vali Loss: 2.618 Vali Acc: 0.517 Test Loss: 2.618 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.367957353591919
Epoch: 19, Steps: 13 | Train Loss: 0.167 Vali Loss: 2.685 Vali Acc: 0.517 Test Loss: 2.685 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.428473949432373
Epoch: 20, Steps: 13 | Train Loss: 0.089 Vali Loss: 2.858 Vali Acc: 0.506 Test Loss: 2.858 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 64002
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.755817174911499
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.725 Vali Acc: 0.456 Test Loss: 0.725 Test Acc: 0.456
Validation loss decreased (inf --> -0.455548).  Saving model ...
Epoch: 2 cost time: 1.3842613697052002
Epoch: 2, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.726 Vali Acc: 0.533 Test Loss: 0.726 Test Acc: 0.533
Validation loss decreased (-0.455548 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.3690111637115479
Epoch: 3, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.804 Vali Acc: 0.522 Test Loss: 0.804 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3559958934783936
Epoch: 4, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.816 Vali Acc: 0.533 Test Loss: 0.816 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.482968807220459
Epoch: 5, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.911 Vali Acc: 0.550 Test Loss: 0.911 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 1.594757318496704
Epoch: 6, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.985 Vali Acc: 0.539 Test Loss: 0.985 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.378803014755249
Epoch: 7, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5605838298797607
Epoch: 8, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.190 Vali Acc: 0.539 Test Loss: 1.190 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5288474559783936
Epoch: 9, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.266 Vali Acc: 0.544 Test Loss: 1.266 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4055216312408447
Epoch: 10, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.584484577178955
Epoch: 11, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.374 Vali Acc: 0.550 Test Loss: 1.374 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.340780258178711
Epoch: 12, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.475 Vali Acc: 0.539 Test Loss: 1.475 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3695271015167236
Epoch: 13, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.590 Vali Acc: 0.544 Test Loss: 1.590 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2253146171569824
Epoch: 14, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.630 Vali Acc: 0.494 Test Loss: 1.630 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3229503631591797
Epoch: 15, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.728 Vali Acc: 0.522 Test Loss: 1.728 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 54210
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.021017551422119
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.708 Vali Acc: 0.572 Test Loss: 0.708 Test Acc: 0.572
Validation loss decreased (inf --> -0.572215).  Saving model ...
Epoch: 2 cost time: 1.4209864139556885
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.701 Vali Acc: 0.583 Test Loss: 0.701 Test Acc: 0.583
Validation loss decreased (-0.572215 --> -0.583326).  Saving model ...
Epoch: 3 cost time: 1.6987109184265137
Epoch: 3, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.730 Vali Acc: 0.561 Test Loss: 0.730 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3109040260314941
Epoch: 4, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.750 Vali Acc: 0.489 Test Loss: 0.750 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4252400398254395
Epoch: 5, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5676803588867188
Epoch: 6, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.865 Vali Acc: 0.511 Test Loss: 0.865 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3174309730529785
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.926 Vali Acc: 0.472 Test Loss: 0.926 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.43143630027771
Epoch: 8, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.008 Vali Acc: 0.539 Test Loss: 1.008 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.491663932800293
Epoch: 9, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.008 Vali Acc: 0.528 Test Loss: 1.008 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3785350322723389
Epoch: 10, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.090 Vali Acc: 0.489 Test Loss: 1.090 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3319685459136963
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.140 Vali Acc: 0.494 Test Loss: 1.140 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2806737422943115
Epoch: 12, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.252 Vali Acc: 0.533 Test Loss: 1.252 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 49794
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5388031005859375
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.739 Vali Acc: 0.472 Test Loss: 0.739 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.284226417541504
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.745 Vali Acc: 0.517 Test Loss: 0.745 Test Acc: 0.517
Validation loss decreased (-0.472215 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.4928789138793945
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.763 Vali Acc: 0.494 Test Loss: 0.763 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2227907180786133
Epoch: 4, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.774 Vali Acc: 0.517 Test Loss: 0.774 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3861396312713623
Epoch: 5, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1234540939331055
Epoch: 6, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1261391639709473
Epoch: 7, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.946 Vali Acc: 0.483 Test Loss: 0.946 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2413980960845947
Epoch: 8, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.950 Vali Acc: 0.511 Test Loss: 0.950 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0254499912261963
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.034 Vali Acc: 0.494 Test Loss: 1.034 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1463701725006104
Epoch: 10, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.049 Vali Acc: 0.517 Test Loss: 1.049 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.32120943069458
Epoch: 11, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.120 Vali Acc: 0.511 Test Loss: 1.120 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.276648759841919
Epoch: 12, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.177 Vali Acc: 0.489 Test Loss: 1.177 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 48066
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 5.014518737792969
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.713 Vali Acc: 0.528 Test Loss: 0.713 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 1.4811124801635742
Epoch: 2, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (-0.527771 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.1851067543029785
Epoch: 3, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1415503025054932
Epoch: 4, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.750 Vali Acc: 0.483 Test Loss: 0.750 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.263962745666504
Epoch: 5, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.780 Vali Acc: 0.506 Test Loss: 0.780 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0580692291259766
Epoch: 6, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.824 Vali Acc: 0.489 Test Loss: 0.824 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1337532997131348
Epoch: 7, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.865 Vali Acc: 0.517 Test Loss: 0.865 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4739043712615967
Epoch: 8, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.904 Vali Acc: 0.483 Test Loss: 0.904 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3853092193603516
Epoch: 9, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.958 Vali Acc: 0.506 Test Loss: 0.958 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3830485343933105
Epoch: 10, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.018 Vali Acc: 0.500 Test Loss: 1.018 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3120267391204834
Epoch: 11, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.068 Vali Acc: 0.483 Test Loss: 1.068 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0144929885864258
Epoch: 12, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 48194
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.660942316055298
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.682 Vali Acc: 0.544 Test Loss: 0.682 Test Acc: 0.544
Validation loss decreased (inf --> -0.544438).  Saving model ...
Epoch: 2 cost time: 1.455545425415039
Epoch: 2, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.679 Vali Acc: 0.544 Test Loss: 0.679 Test Acc: 0.544
Validation loss decreased (-0.544438 --> -0.544438).  Saving model ...
Epoch: 3 cost time: 1.1544218063354492
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.672 Vali Acc: 0.561 Test Loss: 0.672 Test Acc: 0.561
Validation loss decreased (-0.544438 --> -0.561104).  Saving model ...
Epoch: 4 cost time: 1.3359298706054688
Epoch: 4, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4028995037078857
Epoch: 5, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3702435493469238
Epoch: 6, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.765 Vali Acc: 0.489 Test Loss: 0.765 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2951807975769043
Epoch: 7, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.792 Vali Acc: 0.522 Test Loss: 0.792 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3461532592773438
Epoch: 8, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.816 Vali Acc: 0.528 Test Loss: 0.816 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2499897480010986
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.888 Vali Acc: 0.522 Test Loss: 0.888 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4407703876495361
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.443917989730835
Epoch: 11, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.959 Vali Acc: 0.550 Test Loss: 0.959 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4800620079040527
Epoch: 12, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.980 Vali Acc: 0.511 Test Loss: 0.980 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.491436243057251
Epoch: 13, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.017 Vali Acc: 0.522 Test Loss: 1.017 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm64_nh16_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 50946
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7684695720672607
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.692 Vali Acc: 0.522 Test Loss: 0.692 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.2014081478118896
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.760 Vali Acc: 0.522 Test Loss: 0.760 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2519786357879639
Epoch: 3, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.945 Vali Acc: 0.489 Test Loss: 0.945 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1159610748291016
Epoch: 4, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.820 Vali Acc: 0.506 Test Loss: 0.820 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3408434391021729
Epoch: 5, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.945 Vali Acc: 0.494 Test Loss: 0.945 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5414834022521973
Epoch: 6, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.160 Vali Acc: 0.506 Test Loss: 1.160 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3011140823364258
Epoch: 7, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.093 Vali Acc: 0.483 Test Loss: 1.093 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3899941444396973
Epoch: 8, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.151 Vali Acc: 0.506 Test Loss: 1.151 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2277016639709473
Epoch: 9, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.251 Vali Acc: 0.461 Test Loss: 1.251 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.280029535293579
Epoch: 10, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.420 Vali Acc: 0.494 Test Loss: 1.420 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4676861763000488
Epoch: 11, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.506 Vali Acc: 0.489 Test Loss: 1.506 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 56066
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.559940814971924
Epoch: 1, Steps: 13 | Train Loss: 0.785 Vali Loss: 0.683 Vali Acc: 0.578 Test Loss: 0.683 Test Acc: 0.578
Validation loss decreased (inf --> -0.577771).  Saving model ...
Epoch: 2 cost time: 1.3664638996124268
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.684 Vali Acc: 0.544 Test Loss: 0.684 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6414272785186768
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.718 Vali Acc: 0.533 Test Loss: 0.718 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2408630847930908
Epoch: 4, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.721 Vali Acc: 0.556 Test Loss: 0.721 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.296999216079712
Epoch: 5, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.750 Vali Acc: 0.522 Test Loss: 0.750 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.484466791152954
Epoch: 6, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.837 Vali Acc: 0.494 Test Loss: 0.837 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4272758960723877
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.866 Vali Acc: 0.483 Test Loss: 0.866 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5979859828948975
Epoch: 8, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.950 Vali Acc: 0.500 Test Loss: 0.950 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5483713150024414
Epoch: 9, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.025 Vali Acc: 0.506 Test Loss: 1.025 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.306246042251587
Epoch: 10, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.043 Vali Acc: 0.478 Test Loss: 1.043 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.243272304534912
Epoch: 11, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.165 Vali Acc: 0.456 Test Loss: 1.165 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 40418
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.246852159500122
Epoch: 1, Steps: 13 | Train Loss: 0.776 Vali Loss: 0.740 Vali Acc: 0.483 Test Loss: 0.740 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.4544315338134766
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.738 Vali Acc: 0.528 Test Loss: 0.738 Test Acc: 0.528
Validation loss decreased (-0.483326 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.311612844467163
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.741 Vali Acc: 0.506 Test Loss: 0.741 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2554972171783447
Epoch: 4, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.766 Vali Acc: 0.517 Test Loss: 0.766 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.333986759185791
Epoch: 5, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.799 Vali Acc: 0.506 Test Loss: 0.799 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6105093955993652
Epoch: 6, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.818 Vali Acc: 0.472 Test Loss: 0.818 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6548445224761963
Epoch: 7, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.866 Vali Acc: 0.489 Test Loss: 0.866 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7896368503570557
Epoch: 8, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.910 Vali Acc: 0.506 Test Loss: 0.910 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3993844985961914
Epoch: 9, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.910 Vali Acc: 0.511 Test Loss: 0.910 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4196043014526367
Epoch: 10, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.981 Vali Acc: 0.544 Test Loss: 0.981 Test Acc: 0.544
Validation loss decreased (-0.527770 --> -0.544435).  Saving model ...
Epoch: 11 cost time: 1.3341569900512695
Epoch: 11, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.063 Vali Acc: 0.567 Test Loss: 1.063 Test Acc: 0.567
Validation loss decreased (-0.544435 --> -0.566656).  Saving model ...
Epoch: 12 cost time: 1.4312217235565186
Epoch: 12, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.064 Vali Acc: 0.522 Test Loss: 1.064 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1853644847869873
Epoch: 13, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.356320858001709
Epoch: 14, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.220 Vali Acc: 0.528 Test Loss: 1.220 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6779205799102783
Epoch: 15, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.661564826965332
Epoch: 16, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.327 Vali Acc: 0.489 Test Loss: 1.327 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3882551193237305
Epoch: 17, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.406 Vali Acc: 0.494 Test Loss: 1.406 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2810091972351074
Epoch: 18, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.462 Vali Acc: 0.506 Test Loss: 1.462 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.139451026916504
Epoch: 19, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5569138526916504
Epoch: 20, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.614 Vali Acc: 0.517 Test Loss: 1.614 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5777974128723145
Epoch: 21, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.680 Vali Acc: 0.506 Test Loss: 1.680 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 35522
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8025126457214355
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.719 Vali Acc: 0.539 Test Loss: 0.719 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.3152034282684326
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.711 Vali Acc: 0.506 Test Loss: 0.711 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5294299125671387
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.704 Vali Acc: 0.533 Test Loss: 0.704 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5070488452911377
Epoch: 4, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.733 Vali Acc: 0.511 Test Loss: 0.733 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4588086605072021
Epoch: 5, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.749 Vali Acc: 0.522 Test Loss: 0.749 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2099685668945312
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.772 Vali Acc: 0.567 Test Loss: 0.772 Test Acc: 0.567
Validation loss decreased (-0.538882 --> -0.566659).  Saving model ...
Epoch: 7 cost time: 0.9738702774047852
Epoch: 7, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.785 Vali Acc: 0.506 Test Loss: 0.785 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.155165672302246
Epoch: 8, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.858 Vali Acc: 0.511 Test Loss: 0.858 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0914556980133057
Epoch: 9, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.863 Vali Acc: 0.522 Test Loss: 0.863 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.36552095413208
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.924 Vali Acc: 0.522 Test Loss: 0.924 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2347660064697266
Epoch: 11, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.950 Vali Acc: 0.500 Test Loss: 0.950 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2796599864959717
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.013 Vali Acc: 0.511 Test Loss: 1.013 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2176809310913086
Epoch: 13, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.046 Vali Acc: 0.500 Test Loss: 1.046 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2955493927001953
Epoch: 14, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.086 Vali Acc: 0.506 Test Loss: 1.086 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1673591136932373
Epoch: 15, Steps: 13 | Train Loss: 0.292 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4193551540374756
Epoch: 16, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.202 Vali Acc: 0.506 Test Loss: 1.202 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 33314
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.503990411758423
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.741 Vali Acc: 0.522 Test Loss: 0.741 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.2319324016571045
Epoch: 2, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.719 Vali Acc: 0.506 Test Loss: 0.719 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4790120124816895
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.719 Vali Acc: 0.533 Test Loss: 0.719 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.4526495933532715
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.752 Vali Acc: 0.506 Test Loss: 0.752 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1451125144958496
Epoch: 5, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.734 Vali Acc: 0.511 Test Loss: 0.734 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.374283790588379
Epoch: 6, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.744 Vali Acc: 0.522 Test Loss: 0.744 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.455552101135254
Epoch: 7, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.768 Vali Acc: 0.511 Test Loss: 0.768 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5737724304199219
Epoch: 8, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.770 Vali Acc: 0.522 Test Loss: 0.770 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3275783061981201
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.795 Vali Acc: 0.517 Test Loss: 0.795 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1606388092041016
Epoch: 10, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.841 Vali Acc: 0.539 Test Loss: 0.841 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538880).  Saving model ...
Epoch: 11 cost time: 1.1749844551086426
Epoch: 11, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.849 Vali Acc: 0.522 Test Loss: 0.849 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3241856098175049
Epoch: 12, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0729584693908691
Epoch: 13, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.923 Vali Acc: 0.511 Test Loss: 0.923 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4372243881225586
Epoch: 14, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.958 Vali Acc: 0.489 Test Loss: 0.958 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5123205184936523
Epoch: 15, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.000 Vali Acc: 0.500 Test Loss: 1.000 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1826832294464111
Epoch: 16, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.024 Vali Acc: 0.494 Test Loss: 1.024 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5669188499450684
Epoch: 17, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.069 Vali Acc: 0.489 Test Loss: 1.069 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.359663963317871
Epoch: 18, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.119 Vali Acc: 0.489 Test Loss: 1.119 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2880074977874756
Epoch: 19, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.144 Vali Acc: 0.483 Test Loss: 1.144 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2758009433746338
Epoch: 20, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.181 Vali Acc: 0.483 Test Loss: 1.181 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 32450
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.3255767822265625
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.705 Vali Acc: 0.544 Test Loss: 0.705 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.4498004913330078
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.696 Vali Acc: 0.572 Test Loss: 0.696 Test Acc: 0.572
Validation loss decreased (-0.544437 --> -0.572215).  Saving model ...
Epoch: 3 cost time: 1.1610112190246582
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.703 Vali Acc: 0.578 Test Loss: 0.703 Test Acc: 0.578
Validation loss decreased (-0.572215 --> -0.577771).  Saving model ...
Epoch: 4 cost time: 1.4193634986877441
Epoch: 4, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.701 Vali Acc: 0.539 Test Loss: 0.701 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1779937744140625
Epoch: 5, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.713 Vali Acc: 0.561 Test Loss: 0.713 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6851658821105957
Epoch: 6, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.724 Vali Acc: 0.528 Test Loss: 0.724 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0210533142089844
Epoch: 7, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.751 Vali Acc: 0.528 Test Loss: 0.751 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.030930995941162
Epoch: 8, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.770 Vali Acc: 0.539 Test Loss: 0.770 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0903902053833008
Epoch: 9, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.793 Vali Acc: 0.539 Test Loss: 0.793 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9576287269592285
Epoch: 10, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.839 Vali Acc: 0.522 Test Loss: 0.839 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.178959846496582
Epoch: 11, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.847 Vali Acc: 0.517 Test Loss: 0.847 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3671700954437256
Epoch: 12, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.894 Vali Acc: 0.528 Test Loss: 0.894 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.257610559463501
Epoch: 13, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.922 Vali Acc: 0.522 Test Loss: 0.922 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 32514
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.731288194656372
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.718 Vali Acc: 0.539 Test Loss: 0.718 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.1251215934753418
Epoch: 2, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.708 Vali Acc: 0.550 Test Loss: 0.708 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.2267205715179443
Epoch: 3, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.706 Vali Acc: 0.544 Test Loss: 0.706 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7271244525909424
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.699 Vali Acc: 0.533 Test Loss: 0.699 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4303367137908936
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.708 Vali Acc: 0.506 Test Loss: 0.708 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4810543060302734
Epoch: 6, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.711 Vali Acc: 0.517 Test Loss: 0.711 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1871531009674072
Epoch: 7, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.717 Vali Acc: 0.528 Test Loss: 0.717 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.169377326965332
Epoch: 8, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.736 Vali Acc: 0.556 Test Loss: 0.736 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555548).  Saving model ...
Epoch: 9 cost time: 1.4365768432617188
Epoch: 9, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.756 Vali Acc: 0.517 Test Loss: 0.756 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0582256317138672
Epoch: 10, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.781 Vali Acc: 0.517 Test Loss: 0.781 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0973551273345947
Epoch: 11, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.805 Vali Acc: 0.506 Test Loss: 0.805 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4770004749298096
Epoch: 12, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.823 Vali Acc: 0.533 Test Loss: 0.823 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.437678575515747
Epoch: 13, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.854 Vali Acc: 0.489 Test Loss: 0.854 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3669347763061523
Epoch: 14, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.882 Vali Acc: 0.506 Test Loss: 0.882 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5640692710876465
Epoch: 15, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.190601110458374
Epoch: 16, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.933 Vali Acc: 0.533 Test Loss: 0.933 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.263794183731079
Epoch: 17, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.976 Vali Acc: 0.511 Test Loss: 0.976 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.008711338043213
Epoch: 18, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.008 Vali Acc: 0.511 Test Loss: 1.008 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 33890
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.443037509918213
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.765 Vali Acc: 0.506 Test Loss: 0.765 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.2919111251831055
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.737 Vali Acc: 0.528 Test Loss: 0.737 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.2064931392669678
Epoch: 3, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.766 Vali Acc: 0.489 Test Loss: 0.766 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.268225908279419
Epoch: 4, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.862 Vali Acc: 0.478 Test Loss: 0.862 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4039242267608643
Epoch: 5, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.971 Vali Acc: 0.483 Test Loss: 0.971 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2938010692596436
Epoch: 6, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.003 Vali Acc: 0.478 Test Loss: 1.003 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.300654411315918
Epoch: 7, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2147395610809326
Epoch: 8, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.198 Vali Acc: 0.478 Test Loss: 1.198 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4522488117218018
Epoch: 9, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.289 Vali Acc: 0.478 Test Loss: 1.289 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2637770175933838
Epoch: 10, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.454 Vali Acc: 0.494 Test Loss: 1.454 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4970932006835938
Epoch: 11, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.520 Vali Acc: 0.472 Test Loss: 1.520 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.061126947402954
Epoch: 12, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.673 Vali Acc: 0.511 Test Loss: 1.673 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 47746
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9401302337646484
Epoch: 1, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.753 Vali Acc: 0.522 Test Loss: 0.753 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.1513919830322266
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.737 Vali Acc: 0.489 Test Loss: 0.737 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2425568103790283
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.758 Vali Acc: 0.544 Test Loss: 0.758 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.1369242668151855
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.811 Vali Acc: 0.489 Test Loss: 0.811 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.106985092163086
Epoch: 5, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.852 Vali Acc: 0.489 Test Loss: 0.852 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0867125988006592
Epoch: 6, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.882 Vali Acc: 0.456 Test Loss: 0.882 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.078993558883667
Epoch: 7, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.919 Vali Acc: 0.500 Test Loss: 0.919 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4235975742340088
Epoch: 8, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.980 Vali Acc: 0.483 Test Loss: 0.980 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2481348514556885
Epoch: 9, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.061 Vali Acc: 0.494 Test Loss: 1.061 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.279515266418457
Epoch: 10, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.348130226135254
Epoch: 11, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.147 Vali Acc: 0.494 Test Loss: 1.147 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1664557456970215
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.210 Vali Acc: 0.483 Test Loss: 1.210 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.16707444190979
Epoch: 13, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 32098
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.999131917953491
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.756 Vali Acc: 0.467 Test Loss: 0.756 Test Acc: 0.467
Validation loss decreased (inf --> -0.466659).  Saving model ...
Epoch: 2 cost time: 1.2596802711486816
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.723 Vali Acc: 0.489 Test Loss: 0.723 Test Acc: 0.489
Validation loss decreased (-0.466659 --> -0.488882).  Saving model ...
Epoch: 3 cost time: 1.2832367420196533
Epoch: 3, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.749 Vali Acc: 0.506 Test Loss: 0.749 Test Acc: 0.506
Validation loss decreased (-0.488882 --> -0.505548).  Saving model ...
Epoch: 4 cost time: 1.2199923992156982
Epoch: 4, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.747 Vali Acc: 0.494 Test Loss: 0.747 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0882627964019775
Epoch: 5, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.150418996810913
Epoch: 6, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.816 Vali Acc: 0.456 Test Loss: 0.816 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6305904388427734
Epoch: 7, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.856 Vali Acc: 0.511 Test Loss: 0.856 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511103).  Saving model ...
Epoch: 8 cost time: 1.340409517288208
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.898 Vali Acc: 0.483 Test Loss: 0.898 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.712609052658081
Epoch: 9, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.948 Vali Acc: 0.483 Test Loss: 0.948 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4153614044189453
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.012 Vali Acc: 0.511 Test Loss: 1.012 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2788212299346924
Epoch: 11, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.085 Vali Acc: 0.528 Test Loss: 1.085 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527767).  Saving model ...
Epoch: 12 cost time: 1.0699830055236816
Epoch: 12, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.094 Vali Acc: 0.506 Test Loss: 1.094 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.294416904449463
Epoch: 13, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.155 Vali Acc: 0.472 Test Loss: 1.155 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3851063251495361
Epoch: 14, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.218 Vali Acc: 0.522 Test Loss: 1.218 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3021807670593262
Epoch: 15, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.307 Vali Acc: 0.522 Test Loss: 1.307 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1394834518432617
Epoch: 16, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.354 Vali Acc: 0.472 Test Loss: 1.354 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2578155994415283
Epoch: 17, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.410 Vali Acc: 0.506 Test Loss: 1.410 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2042548656463623
Epoch: 18, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.519 Vali Acc: 0.522 Test Loss: 1.519 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2367711067199707
Epoch: 19, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.527 Vali Acc: 0.506 Test Loss: 1.527 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2901380062103271
Epoch: 20, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.581 Vali Acc: 0.533 Test Loss: 1.581 Test Acc: 0.533
Validation loss decreased (-0.527767 --> -0.533318).  Saving model ...
Epoch: 21 cost time: 0.9779775142669678
Epoch: 21, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.673 Vali Acc: 0.528 Test Loss: 1.673 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.216275691986084
Epoch: 22, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.743 Vali Acc: 0.456 Test Loss: 1.743 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.293653964996338
Epoch: 23, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.819 Vali Acc: 0.544 Test Loss: 1.819 Test Acc: 0.544
Validation loss decreased (-0.533318 --> -0.544426).  Saving model ...
Epoch: 24 cost time: 1.1400213241577148
Epoch: 24, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.876 Vali Acc: 0.511 Test Loss: 1.876 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5735201835632324
Epoch: 25, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.954 Vali Acc: 0.511 Test Loss: 1.954 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1683681011199951
Epoch: 26, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.002 Vali Acc: 0.489 Test Loss: 2.002 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2033309936523438
Epoch: 27, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.114 Vali Acc: 0.494 Test Loss: 2.114 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3018498420715332
Epoch: 28, Steps: 13 | Train Loss: 0.096 Vali Loss: 2.180 Vali Acc: 0.483 Test Loss: 2.180 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0416207313537598
Epoch: 29, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.193 Vali Acc: 0.500 Test Loss: 2.193 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5177724361419678
Epoch: 30, Steps: 13 | Train Loss: 0.071 Vali Loss: 2.244 Vali Acc: 0.472 Test Loss: 2.244 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0402553081512451
Epoch: 31, Steps: 13 | Train Loss: 0.060 Vali Loss: 2.360 Vali Acc: 0.483 Test Loss: 2.360 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.035449504852295
Epoch: 32, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.411 Vali Acc: 0.472 Test Loss: 2.411 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0659725666046143
Epoch: 33, Steps: 13 | Train Loss: 0.057 Vali Loss: 2.464 Vali Acc: 0.494 Test Loss: 2.464 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 27202
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.605353355407715
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.694 Vali Acc: 0.600 Test Loss: 0.694 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 1.3802433013916016
Epoch: 2, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.700 Vali Acc: 0.517 Test Loss: 0.700 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3934495449066162
Epoch: 3, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.702 Vali Acc: 0.567 Test Loss: 0.702 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4471194744110107
Epoch: 4, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.697 Vali Acc: 0.506 Test Loss: 0.697 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1636669635772705
Epoch: 5, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.720 Vali Acc: 0.522 Test Loss: 0.720 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1883902549743652
Epoch: 6, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.763 Vali Acc: 0.522 Test Loss: 0.763 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2976930141448975
Epoch: 7, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.789 Vali Acc: 0.506 Test Loss: 0.789 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.23551344871521
Epoch: 8, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.823 Vali Acc: 0.511 Test Loss: 0.823 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2475955486297607
Epoch: 9, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.859 Vali Acc: 0.511 Test Loss: 0.859 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1619086265563965
Epoch: 10, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.888 Vali Acc: 0.528 Test Loss: 0.888 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4338314533233643
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.929 Vali Acc: 0.511 Test Loss: 0.929 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6
model parameter : 24994
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.202762126922607
Epoch: 1, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1460793018341064
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.700 Vali Acc: 0.539 Test Loss: 0.700 Test Acc: 0.539
Validation loss decreased (-0.499993 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.125537395477295
Epoch: 3, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.699 Vali Acc: 0.550 Test Loss: 0.699 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.6771831512451172
Epoch: 4, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.704 Vali Acc: 0.506 Test Loss: 0.704 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2175993919372559
Epoch: 5, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.713 Vali Acc: 0.506 Test Loss: 0.713 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1604061126708984
Epoch: 6, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.729 Vali Acc: 0.483 Test Loss: 0.729 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3824048042297363
Epoch: 7, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.752 Vali Acc: 0.517 Test Loss: 0.752 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.242661476135254
Epoch: 8, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.780 Vali Acc: 0.522 Test Loss: 0.780 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2953200340270996
Epoch: 9, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.811 Vali Acc: 0.522 Test Loss: 0.811 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2180063724517822
Epoch: 10, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.832 Vali Acc: 0.533 Test Loss: 0.832 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2735648155212402
Epoch: 11, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.884 Vali Acc: 0.522 Test Loss: 0.884 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3526761531829834
Epoch: 12, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.908 Vali Acc: 0.511 Test Loss: 0.908 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2410354614257812
Epoch: 13, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.941 Vali Acc: 0.500 Test Loss: 0.941 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 24130
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.507737398147583
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.718 Vali Acc: 0.483 Test Loss: 0.718 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.4040865898132324
Epoch: 2, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.716 Vali Acc: 0.506 Test Loss: 0.716 Test Acc: 0.506
Validation loss decreased (-0.483326 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.306349277496338
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.718 Vali Acc: 0.528 Test Loss: 0.718 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 1.0975496768951416
Epoch: 4, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.727 Vali Acc: 0.544 Test Loss: 0.727 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.4441092014312744
Epoch: 5, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.735 Vali Acc: 0.511 Test Loss: 0.735 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0744516849517822
Epoch: 6, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.748 Vali Acc: 0.539 Test Loss: 0.748 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.321822166442871
Epoch: 7, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.780 Vali Acc: 0.517 Test Loss: 0.780 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2193927764892578
Epoch: 8, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.156400203704834
Epoch: 9, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.817 Vali Acc: 0.533 Test Loss: 0.817 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0875766277313232
Epoch: 10, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.844 Vali Acc: 0.528 Test Loss: 0.844 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1274867057800293
Epoch: 11, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.877 Vali Acc: 0.506 Test Loss: 0.877 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1591095924377441
Epoch: 12, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.901 Vali Acc: 0.511 Test Loss: 0.901 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1556062698364258
Epoch: 13, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.958 Vali Acc: 0.494 Test Loss: 0.958 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1948070526123047
Epoch: 14, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.960 Vali Acc: 0.506 Test Loss: 0.960 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 24194
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.44879150390625
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.2508506774902344
Epoch: 2, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.706 Vali Acc: 0.544 Test Loss: 0.706 Test Acc: 0.544
Validation loss decreased (-0.505548 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.471801519393921
Epoch: 3, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.703 Vali Acc: 0.528 Test Loss: 0.703 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2668673992156982
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.689 Vali Acc: 0.539 Test Loss: 0.689 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0586833953857422
Epoch: 5, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.700 Vali Acc: 0.522 Test Loss: 0.700 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3767681121826172
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.716 Vali Acc: 0.511 Test Loss: 0.716 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1158485412597656
Epoch: 7, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.744 Vali Acc: 0.522 Test Loss: 0.744 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2034270763397217
Epoch: 8, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.727 Vali Acc: 0.556 Test Loss: 0.727 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555548).  Saving model ...
Epoch: 9 cost time: 1.1867005825042725
Epoch: 9, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.768 Vali Acc: 0.522 Test Loss: 0.768 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3063545227050781
Epoch: 10, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.784 Vali Acc: 0.533 Test Loss: 0.784 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2805488109588623
Epoch: 11, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.806 Vali Acc: 0.539 Test Loss: 0.806 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.094139814376831
Epoch: 12, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.831 Vali Acc: 0.544 Test Loss: 0.831 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2165613174438477
Epoch: 13, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.889 Vali Acc: 0.539 Test Loss: 0.889 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1484007835388184
Epoch: 14, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.905 Vali Acc: 0.506 Test Loss: 0.905 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8809349536895752
Epoch: 15, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.947 Vali Acc: 0.533 Test Loss: 0.947 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2082359790802002
Epoch: 16, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.987 Vali Acc: 0.489 Test Loss: 0.987 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0910077095031738
Epoch: 17, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.016 Vali Acc: 0.494 Test Loss: 1.016 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4111592769622803
Epoch: 18, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.063 Vali Acc: 0.511 Test Loss: 1.063 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 25570
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.738847494125366
Epoch: 1, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.737 Vali Acc: 0.483 Test Loss: 0.737 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.3165485858917236
Epoch: 2, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.754 Vali Acc: 0.511 Test Loss: 0.754 Test Acc: 0.511
Validation loss decreased (-0.483326 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.1097400188446045
Epoch: 3, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.790 Vali Acc: 0.467 Test Loss: 0.790 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4060451984405518
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.989 Vali Acc: 0.489 Test Loss: 0.989 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2364089488983154
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.924 Vali Acc: 0.483 Test Loss: 0.924 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2974121570587158
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.280381441116333
Epoch: 7, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.117 Vali Acc: 0.444 Test Loss: 1.117 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2745673656463623
Epoch: 8, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.175 Vali Acc: 0.461 Test Loss: 1.175 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5625638961791992
Epoch: 9, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.277 Vali Acc: 0.467 Test Loss: 1.277 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.683985710144043
Epoch: 10, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.436 Vali Acc: 0.444 Test Loss: 1.436 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.329761028289795
Epoch: 11, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.548 Vali Acc: 0.472 Test Loss: 1.548 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5283193588256836
Epoch: 12, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.574 Vali Acc: 0.461 Test Loss: 1.574 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5111111111111111
model parameter : 43586
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.03223991394043
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.5553627014160156
Epoch: 2, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.714 Vali Acc: 0.489 Test Loss: 0.714 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3465702533721924
Epoch: 3, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.774 Vali Acc: 0.539 Test Loss: 0.774 Test Acc: 0.539
Validation loss decreased (-0.499992 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 1.2333097457885742
Epoch: 4, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.762 Vali Acc: 0.483 Test Loss: 0.762 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.502988338470459
Epoch: 5, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.826 Vali Acc: 0.528 Test Loss: 0.826 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.750072717666626
Epoch: 6, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.858 Vali Acc: 0.533 Test Loss: 0.858 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4627728462219238
Epoch: 7, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.892 Vali Acc: 0.511 Test Loss: 0.892 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3862409591674805
Epoch: 8, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.018 Vali Acc: 0.517 Test Loss: 1.018 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4317967891693115
Epoch: 9, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3379199504852295
Epoch: 10, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.146 Vali Acc: 0.511 Test Loss: 1.146 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.378861904144287
Epoch: 11, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4677951335906982
Epoch: 12, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4811275005340576
Epoch: 13, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.291 Vali Acc: 0.472 Test Loss: 1.291 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 27938
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6202735900878906
Epoch: 1, Steps: 13 | Train Loss: 0.779 Vali Loss: 0.735 Vali Acc: 0.506 Test Loss: 0.735 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.2775366306304932
Epoch: 2, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.754 Vali Acc: 0.489 Test Loss: 0.754 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0262620449066162
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.743 Vali Acc: 0.489 Test Loss: 0.743 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5952672958374023
Epoch: 4, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.752 Vali Acc: 0.528 Test Loss: 0.752 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527770).  Saving model ...
Epoch: 5 cost time: 1.2124803066253662
Epoch: 5, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.774 Vali Acc: 0.517 Test Loss: 0.774 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1240134239196777
Epoch: 6, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.808 Vali Acc: 0.533 Test Loss: 0.808 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533325).  Saving model ...
Epoch: 7 cost time: 1.2432234287261963
Epoch: 7, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.877 Vali Acc: 0.511 Test Loss: 0.877 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.452932596206665
Epoch: 8, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.887 Vali Acc: 0.517 Test Loss: 0.887 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0048949718475342
Epoch: 9, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.940 Vali Acc: 0.528 Test Loss: 0.940 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0721344947814941
Epoch: 10, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.977 Vali Acc: 0.528 Test Loss: 0.977 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0959699153900146
Epoch: 11, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.072 Vali Acc: 0.522 Test Loss: 1.072 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1976191997528076
Epoch: 12, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.079 Vali Acc: 0.522 Test Loss: 1.079 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1749651432037354
Epoch: 13, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.119 Vali Acc: 0.511 Test Loss: 1.119 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2204153537750244
Epoch: 14, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.239 Vali Acc: 0.539 Test Loss: 1.239 Test Acc: 0.539
Validation loss decreased (-0.533325 --> -0.538877).  Saving model ...
Epoch: 15 cost time: 1.0775275230407715
Epoch: 15, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.235 Vali Acc: 0.528 Test Loss: 1.235 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9996476173400879
Epoch: 16, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.270 Vali Acc: 0.517 Test Loss: 1.270 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3027477264404297
Epoch: 17, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.369 Vali Acc: 0.550 Test Loss: 1.369 Test Acc: 0.550
Validation loss decreased (-0.538877 --> -0.549986).  Saving model ...
Epoch: 18 cost time: 1.2021496295928955
Epoch: 18, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.423 Vali Acc: 0.489 Test Loss: 1.423 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0718133449554443
Epoch: 19, Steps: 13 | Train Loss: 0.226 Vali Loss: 1.526 Vali Acc: 0.522 Test Loss: 1.526 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2561376094818115
Epoch: 20, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.584 Vali Acc: 0.517 Test Loss: 1.584 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.20707368850708
Epoch: 21, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.673 Vali Acc: 0.544 Test Loss: 1.673 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1754627227783203
Epoch: 22, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.681 Vali Acc: 0.506 Test Loss: 1.681 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.303572416305542
Epoch: 23, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.726 Vali Acc: 0.489 Test Loss: 1.726 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0634593963623047
Epoch: 24, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.827 Vali Acc: 0.522 Test Loss: 1.827 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3046154975891113
Epoch: 25, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.951 Vali Acc: 0.539 Test Loss: 1.951 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3907058238983154
Epoch: 26, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.951 Vali Acc: 0.494 Test Loss: 1.951 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2510807514190674
Epoch: 27, Steps: 13 | Train Loss: 0.165 Vali Loss: 2.035 Vali Acc: 0.528 Test Loss: 2.035 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23042
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.769995927810669
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.685 Vali Acc: 0.583 Test Loss: 0.685 Test Acc: 0.583
Validation loss decreased (inf --> -0.583326).  Saving model ...
Epoch: 2 cost time: 1.2338407039642334
Epoch: 2, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.679 Vali Acc: 0.550 Test Loss: 0.679 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2001526355743408
Epoch: 3, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.708 Vali Acc: 0.556 Test Loss: 0.708 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.376018762588501
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.707 Vali Acc: 0.533 Test Loss: 0.707 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.570652961730957
Epoch: 5, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.730 Vali Acc: 0.517 Test Loss: 0.730 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.472318410873413
Epoch: 6, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.752 Vali Acc: 0.544 Test Loss: 0.752 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2556641101837158
Epoch: 7, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.782 Vali Acc: 0.528 Test Loss: 0.782 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9511165618896484
Epoch: 8, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.827 Vali Acc: 0.489 Test Loss: 0.827 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.341759204864502
Epoch: 9, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.843 Vali Acc: 0.533 Test Loss: 0.843 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1287989616394043
Epoch: 10, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.67942214012146
Epoch: 11, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.931 Vali Acc: 0.494 Test Loss: 0.931 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 20834
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.7287070751190186
Epoch: 1, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5987958908081055
Epoch: 2, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.709 Vali Acc: 0.561 Test Loss: 0.709 Test Acc: 0.561
Validation loss decreased (-0.499993 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 1.2511584758758545
Epoch: 3, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.709 Vali Acc: 0.544 Test Loss: 0.709 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3205440044403076
Epoch: 4, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.713 Vali Acc: 0.511 Test Loss: 0.713 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3055601119995117
Epoch: 5, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.715 Vali Acc: 0.478 Test Loss: 0.715 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5289888381958008
Epoch: 6, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5947375297546387
Epoch: 7, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.746 Vali Acc: 0.478 Test Loss: 0.746 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5993478298187256
Epoch: 8, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.777 Vali Acc: 0.506 Test Loss: 0.777 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.230377197265625
Epoch: 9, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.798 Vali Acc: 0.528 Test Loss: 0.798 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4973094463348389
Epoch: 10, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.850 Vali Acc: 0.533 Test Loss: 0.850 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.330935001373291
Epoch: 11, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2094833850860596
Epoch: 12, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.881 Vali Acc: 0.511 Test Loss: 0.881 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 19970
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4658238887786865
Epoch: 1, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.691 Vali Acc: 0.533 Test Loss: 0.691 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.1134192943572998
Epoch: 2, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.690 Vali Acc: 0.506 Test Loss: 0.690 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2811152935028076
Epoch: 3, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.690 Vali Acc: 0.533 Test Loss: 0.690 Test Acc: 0.533
Validation loss decreased (-0.533326 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.0775506496429443
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.685 Vali Acc: 0.550 Test Loss: 0.685 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.1165471076965332
Epoch: 5, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.691 Vali Acc: 0.567 Test Loss: 0.691 Test Acc: 0.567
Validation loss decreased (-0.549993 --> -0.566660).  Saving model ...
Epoch: 6 cost time: 1.3464157581329346
Epoch: 6, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.705 Vali Acc: 0.578 Test Loss: 0.705 Test Acc: 0.578
Validation loss decreased (-0.566660 --> -0.577771).  Saving model ...
Epoch: 7 cost time: 0.8131685256958008
Epoch: 7, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.726 Vali Acc: 0.561 Test Loss: 0.726 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2499349117279053
Epoch: 8, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1110835075378418
Epoch: 9, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.743 Vali Acc: 0.556 Test Loss: 0.743 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.134443998336792
Epoch: 10, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.761 Vali Acc: 0.539 Test Loss: 0.761 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1098921298980713
Epoch: 11, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.803 Vali Acc: 0.533 Test Loss: 0.803 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.989769697189331
Epoch: 12, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1914732456207275
Epoch: 13, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.828 Vali Acc: 0.533 Test Loss: 0.828 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2039680480957031
Epoch: 14, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.867 Vali Acc: 0.544 Test Loss: 0.867 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3160691261291504
Epoch: 15, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.912 Vali Acc: 0.528 Test Loss: 0.912 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.053473711013794
Epoch: 16, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.923 Vali Acc: 0.544 Test Loss: 0.923 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 20034
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.989994049072266
Epoch: 1, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.722 Vali Acc: 0.517 Test Loss: 0.722 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.5976536273956299
Epoch: 2, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.718 Vali Acc: 0.478 Test Loss: 0.718 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5735900402069092
Epoch: 3, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.720 Vali Acc: 0.472 Test Loss: 0.720 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0731520652770996
Epoch: 4, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.716 Vali Acc: 0.511 Test Loss: 0.716 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2468092441558838
Epoch: 5, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.730 Vali Acc: 0.456 Test Loss: 0.730 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.384103536605835
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.741 Vali Acc: 0.467 Test Loss: 0.741 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1474604606628418
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.763 Vali Acc: 0.489 Test Loss: 0.763 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.586989164352417
Epoch: 8, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2534759044647217
Epoch: 9, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.805 Vali Acc: 0.467 Test Loss: 0.805 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4305071830749512
Epoch: 10, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.828 Vali Acc: 0.489 Test Loss: 0.828 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.182422399520874
Epoch: 11, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.886 Vali Acc: 0.478 Test Loss: 0.886 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm32_nh4_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 21410
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.010793685913086
Epoch: 1, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.711 Vali Acc: 0.533 Test Loss: 0.711 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.100151538848877
Epoch: 2, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.685 Vali Acc: 0.533 Test Loss: 0.685 Test Acc: 0.533
Validation loss decreased (-0.533326 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.2859675884246826
Epoch: 3, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.755 Vali Acc: 0.539 Test Loss: 0.755 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 1.4547030925750732
Epoch: 4, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.731 Vali Acc: 0.528 Test Loss: 0.731 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1214442253112793
Epoch: 5, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.776 Vali Acc: 0.506 Test Loss: 0.776 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3433916568756104
Epoch: 6, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.811 Vali Acc: 0.517 Test Loss: 0.811 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4535703659057617
Epoch: 7, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4254176616668701
Epoch: 8, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.929 Vali Acc: 0.511 Test Loss: 0.929 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3518121242523193
Epoch: 9, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.024 Vali Acc: 0.483 Test Loss: 1.024 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.218078374862671
Epoch: 10, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.057 Vali Acc: 0.478 Test Loss: 1.057 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1865324974060059
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.085 Vali Acc: 0.506 Test Loss: 1.085 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1705150604248047
Epoch: 12, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.187 Vali Acc: 0.528 Test Loss: 1.187 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4099376201629639
Epoch: 13, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.220 Vali Acc: 0.483 Test Loss: 1.220 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 27138
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.691683053970337
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.710 Vali Acc: 0.511 Test Loss: 0.710 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.1209685802459717
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.711 Vali Acc: 0.556 Test Loss: 0.711 Test Acc: 0.556
Validation loss decreased (-0.511104 --> -0.555548).  Saving model ...
Epoch: 3 cost time: 1.1137120723724365
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.726 Vali Acc: 0.544 Test Loss: 0.726 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.095569372177124
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.732 Vali Acc: 0.522 Test Loss: 0.732 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.170302152633667
Epoch: 5, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.746 Vali Acc: 0.511 Test Loss: 0.746 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2570693492889404
Epoch: 6, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.773 Vali Acc: 0.506 Test Loss: 0.773 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1703250408172607
Epoch: 7, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.805 Vali Acc: 0.533 Test Loss: 0.805 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0584025382995605
Epoch: 8, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.829 Vali Acc: 0.489 Test Loss: 0.829 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.263455867767334
Epoch: 9, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.852 Vali Acc: 0.478 Test Loss: 0.852 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2868943214416504
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.885 Vali Acc: 0.472 Test Loss: 0.885 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.344672679901123
Epoch: 11, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.941 Vali Acc: 0.456 Test Loss: 0.941 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.213165283203125
Epoch: 12, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.964 Vali Acc: 0.483 Test Loss: 0.964 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 19314
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.187535524368286
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.758 Vali Acc: 0.483 Test Loss: 0.758 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.6284053325653076
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.758 Vali Acc: 0.489 Test Loss: 0.758 Test Acc: 0.489
Validation loss decreased (-0.483326 --> -0.488881).  Saving model ...
Epoch: 3 cost time: 1.2749059200286865
Epoch: 3, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.749 Vali Acc: 0.517 Test Loss: 0.749 Test Acc: 0.517
Validation loss decreased (-0.488881 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 0.9220061302185059
Epoch: 4, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.752 Vali Acc: 0.511 Test Loss: 0.752 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.134446382522583
Epoch: 5, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.756 Vali Acc: 0.511 Test Loss: 0.756 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1930866241455078
Epoch: 6, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.748 Vali Acc: 0.494 Test Loss: 0.748 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3801543712615967
Epoch: 7, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.769 Vali Acc: 0.511 Test Loss: 0.769 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7153525352478027
Epoch: 8, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.789 Vali Acc: 0.494 Test Loss: 0.789 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3188588619232178
Epoch: 9, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.809 Vali Acc: 0.506 Test Loss: 0.809 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2939014434814453
Epoch: 10, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.821 Vali Acc: 0.489 Test Loss: 0.821 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.411982536315918
Epoch: 11, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.847 Vali Acc: 0.489 Test Loss: 0.847 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4657704830169678
Epoch: 12, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.868 Vali Acc: 0.478 Test Loss: 0.868 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.392399787902832
Epoch: 13, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.906 Vali Acc: 0.494 Test Loss: 0.906 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 16866
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.166739225387573
Epoch: 1, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.698 Vali Acc: 0.556 Test Loss: 0.698 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 1.2962915897369385
Epoch: 2, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.695 Vali Acc: 0.578 Test Loss: 0.695 Test Acc: 0.578
Validation loss decreased (-0.555549 --> -0.577771).  Saving model ...
Epoch: 3 cost time: 1.2618825435638428
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.692 Vali Acc: 0.578 Test Loss: 0.692 Test Acc: 0.578
Validation loss decreased (-0.577771 --> -0.577771).  Saving model ...
Epoch: 4 cost time: 1.2273235321044922
Epoch: 4, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.681 Vali Acc: 0.589 Test Loss: 0.681 Test Acc: 0.589
Validation loss decreased (-0.577771 --> -0.588882).  Saving model ...
Epoch: 5 cost time: 1.0886313915252686
Epoch: 5, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.690 Vali Acc: 0.561 Test Loss: 0.690 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9707233905792236
Epoch: 6, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.690 Vali Acc: 0.561 Test Loss: 0.690 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0548396110534668
Epoch: 7, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.699 Vali Acc: 0.528 Test Loss: 0.699 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1112146377563477
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.713 Vali Acc: 0.533 Test Loss: 0.713 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3091607093811035
Epoch: 9, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.740 Vali Acc: 0.533 Test Loss: 0.740 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.303292989730835
Epoch: 10, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.743 Vali Acc: 0.544 Test Loss: 0.743 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.566763162612915
Epoch: 11, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.758 Vali Acc: 0.533 Test Loss: 0.758 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.185314655303955
Epoch: 12, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.776 Vali Acc: 0.511 Test Loss: 0.776 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2643182277679443
Epoch: 13, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.800 Vali Acc: 0.522 Test Loss: 0.800 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.018441915512085
Epoch: 14, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.817 Vali Acc: 0.511 Test Loss: 0.817 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 15762
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.650770902633667
Epoch: 1, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.739 Vali Acc: 0.506 Test Loss: 0.739 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.9928021430969238
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
Validation loss decreased (-0.505548 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.217040777206421
Epoch: 3, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.735 Vali Acc: 0.494 Test Loss: 0.735 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0770633220672607
Epoch: 4, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.726 Vali Acc: 0.489 Test Loss: 0.726 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0664114952087402
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.730 Vali Acc: 0.494 Test Loss: 0.730 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9754655361175537
Epoch: 6, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.733 Vali Acc: 0.506 Test Loss: 0.733 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1094672679901123
Epoch: 7, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.750 Vali Acc: 0.472 Test Loss: 0.750 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0852947235107422
Epoch: 8, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0002264976501465
Epoch: 9, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9571409225463867
Epoch: 10, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.755 Vali Acc: 0.506 Test Loss: 0.755 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.133915662765503
Epoch: 11, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.791 Vali Acc: 0.483 Test Loss: 0.791 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1877477169036865
Epoch: 12, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.792 Vali Acc: 0.489 Test Loss: 0.792 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5055555555555555
model parameter : 15330
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.687077045440674
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.4588003158569336
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.722 Vali Acc: 0.517 Test Loss: 0.722 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.5209143161773682
Epoch: 3, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.723 Vali Acc: 0.544 Test Loss: 0.723 Test Acc: 0.544
Validation loss decreased (-0.516659 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.308579921722412
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.717 Vali Acc: 0.533 Test Loss: 0.717 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2213807106018066
Epoch: 5, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.713 Vali Acc: 0.522 Test Loss: 0.713 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4234347343444824
Epoch: 6, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.59846830368042
Epoch: 7, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.721 Vali Acc: 0.539 Test Loss: 0.721 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8629961013793945
Epoch: 8, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.735 Vali Acc: 0.561 Test Loss: 0.735 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561104).  Saving model ...
Epoch: 9 cost time: 1.4945068359375
Epoch: 9, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.735 Vali Acc: 0.528 Test Loss: 0.735 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6621134281158447
Epoch: 10, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.741 Vali Acc: 0.528 Test Loss: 0.741 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9623465538024902
Epoch: 11, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.747 Vali Acc: 0.522 Test Loss: 0.747 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5309221744537354
Epoch: 12, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2806429862976074
Epoch: 13, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.777 Vali Acc: 0.522 Test Loss: 0.777 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4193682670593262
Epoch: 14, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.783 Vali Acc: 0.517 Test Loss: 0.783 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5363340377807617
Epoch: 15, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.804 Vali Acc: 0.517 Test Loss: 0.804 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4742012023925781
Epoch: 16, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.818 Vali Acc: 0.522 Test Loss: 0.818 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6386597156524658
Epoch: 17, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.833 Vali Acc: 0.533 Test Loss: 0.833 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2109270095825195
Epoch: 18, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.854 Vali Acc: 0.511 Test Loss: 0.854 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 15362
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.252272844314575
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.726 Vali Acc: 0.506 Test Loss: 0.726 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.1952505111694336
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.724 Vali Acc: 0.461 Test Loss: 0.724 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1184074878692627
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.720 Vali Acc: 0.483 Test Loss: 0.720 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3265821933746338
Epoch: 4, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.719 Vali Acc: 0.472 Test Loss: 0.719 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0939576625823975
Epoch: 5, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.722 Vali Acc: 0.489 Test Loss: 0.722 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4784166812896729
Epoch: 6, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.725 Vali Acc: 0.506 Test Loss: 0.725 Test Acc: 0.506
Validation loss decreased (-0.505548 --> -0.505548).  Saving model ...
Epoch: 7 cost time: 1.5049939155578613
Epoch: 7, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.719 Vali Acc: 0.522 Test Loss: 0.719 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 8 cost time: 1.3440556526184082
Epoch: 8, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.730 Vali Acc: 0.511 Test Loss: 0.730 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5543367862701416
Epoch: 9, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.737 Vali Acc: 0.511 Test Loss: 0.737 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2882771492004395
Epoch: 10, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.747 Vali Acc: 0.517 Test Loss: 0.747 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5788710117340088
Epoch: 11, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.760 Vali Acc: 0.494 Test Loss: 0.760 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2522368431091309
Epoch: 12, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.763 Vali Acc: 0.522 Test Loss: 0.763 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4299046993255615
Epoch: 13, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.782 Vali Acc: 0.506 Test Loss: 0.782 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6088593006134033
Epoch: 14, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3886101245880127
Epoch: 15, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4233672618865967
Epoch: 16, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.837 Vali Acc: 0.511 Test Loss: 0.837 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3244976997375488
Epoch: 17, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df256_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 16050
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.285952568054199
Epoch: 1, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.7692925930023193
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.723 Vali Acc: 0.494 Test Loss: 0.723 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7996511459350586
Epoch: 3, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.737 Vali Acc: 0.472 Test Loss: 0.737 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5796611309051514
Epoch: 4, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.830 Vali Acc: 0.489 Test Loss: 0.830 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8240277767181396
Epoch: 5, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.897 Vali Acc: 0.494 Test Loss: 0.897 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5237250328063965
Epoch: 6, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.864 Vali Acc: 0.483 Test Loss: 0.864 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7145795822143555
Epoch: 7, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.965 Vali Acc: 0.489 Test Loss: 0.965 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.624772548675537
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.973 Vali Acc: 0.483 Test Loss: 0.973 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5749657154083252
Epoch: 9, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.014 Vali Acc: 0.483 Test Loss: 1.014 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5621614456176758
Epoch: 10, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.092 Vali Acc: 0.461 Test Loss: 1.092 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.639223337173462
Epoch: 11, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.176 Vali Acc: 0.450 Test Loss: 1.176 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5
model parameter : 22914
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6350772380828857
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.746 Vali Acc: 0.544 Test Loss: 0.746 Test Acc: 0.544
Validation loss decreased (inf --> -0.544437).  Saving model ...
Epoch: 2 cost time: 1.3742334842681885
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.713 Vali Acc: 0.583 Test Loss: 0.713 Test Acc: 0.583
Validation loss decreased (-0.544437 --> -0.583326).  Saving model ...
Epoch: 3 cost time: 1.2838540077209473
Epoch: 3, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.718 Vali Acc: 0.589 Test Loss: 0.718 Test Acc: 0.589
Validation loss decreased (-0.583326 --> -0.588882).  Saving model ...
Epoch: 4 cost time: 1.1055445671081543
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.709 Vali Acc: 0.578 Test Loss: 0.709 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5931034088134766
Epoch: 5, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.730 Vali Acc: 0.561 Test Loss: 0.730 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6142632961273193
Epoch: 6, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0940120220184326
Epoch: 7, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.780 Vali Acc: 0.506 Test Loss: 0.780 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4575154781341553
Epoch: 8, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.805 Vali Acc: 0.489 Test Loss: 0.805 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2523727416992188
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.838 Vali Acc: 0.478 Test Loss: 0.838 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5195481777191162
Epoch: 10, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.877 Vali Acc: 0.472 Test Loss: 0.877 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.41349458694458
Epoch: 11, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.919 Vali Acc: 0.461 Test Loss: 0.919 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4480628967285156
Epoch: 12, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.978 Vali Acc: 0.478 Test Loss: 0.978 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2175753116607666
Epoch: 13, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.007 Vali Acc: 0.456 Test Loss: 1.007 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 15090
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.379623651504517
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.705 Vali Acc: 0.511 Test Loss: 0.705 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.2169716358184814
Epoch: 2, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.714 Vali Acc: 0.506 Test Loss: 0.714 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.508906364440918
Epoch: 3, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.710 Vali Acc: 0.489 Test Loss: 0.710 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0511856079101562
Epoch: 4, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.709 Vali Acc: 0.511 Test Loss: 0.709 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3749759197235107
Epoch: 5, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.713 Vali Acc: 0.494 Test Loss: 0.713 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2586901187896729
Epoch: 6, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.724 Vali Acc: 0.522 Test Loss: 0.724 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 7 cost time: 1.1581616401672363
Epoch: 7, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.744 Vali Acc: 0.494 Test Loss: 0.744 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5227909088134766
Epoch: 8, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.750 Vali Acc: 0.522 Test Loss: 0.750 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1080939769744873
Epoch: 9, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.768 Vali Acc: 0.517 Test Loss: 0.768 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5074412822723389
Epoch: 10, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.789 Vali Acc: 0.517 Test Loss: 0.789 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2240571975708008
Epoch: 11, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.845 Vali Acc: 0.522 Test Loss: 0.845 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1841657161712646
Epoch: 12, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.858 Vali Acc: 0.528 Test Loss: 0.858 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527769).  Saving model ...
Epoch: 13 cost time: 1.4747214317321777
Epoch: 13, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.889 Vali Acc: 0.511 Test Loss: 0.889 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3713974952697754
Epoch: 14, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.887 Vali Acc: 0.533 Test Loss: 0.887 Test Acc: 0.533
Validation loss decreased (-0.527769 --> -0.533324).  Saving model ...
Epoch: 15 cost time: 1.2421820163726807
Epoch: 15, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.939 Vali Acc: 0.522 Test Loss: 0.939 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5695617198944092
Epoch: 16, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.955 Vali Acc: 0.517 Test Loss: 0.955 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2006056308746338
Epoch: 17, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4563047885894775
Epoch: 18, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.016 Vali Acc: 0.489 Test Loss: 1.016 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2444052696228027
Epoch: 19, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.043 Vali Acc: 0.528 Test Loss: 1.043 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.757622480392456
Epoch: 20, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.091 Vali Acc: 0.511 Test Loss: 1.091 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2752039432525635
Epoch: 21, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.116 Vali Acc: 0.494 Test Loss: 1.116 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4836719036102295
Epoch: 22, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.166 Vali Acc: 0.494 Test Loss: 1.166 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5563130378723145
Epoch: 23, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.238 Vali Acc: 0.533 Test Loss: 1.238 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.330268383026123
Epoch: 24, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.254 Vali Acc: 0.483 Test Loss: 1.254 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 12642
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.270939111709595
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3172359466552734
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.5931460857391357
Epoch: 3, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.639514446258545
Epoch: 4, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.721 Vali Acc: 0.517 Test Loss: 0.721 Test Acc: 0.517
Validation loss decreased (-0.516659 --> -0.516659).  Saving model ...
Epoch: 5 cost time: 1.3279180526733398
Epoch: 5, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.173051118850708
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.737 Vali Acc: 0.511 Test Loss: 0.737 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3416788578033447
Epoch: 7, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.738 Vali Acc: 0.494 Test Loss: 0.738 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.545874834060669
Epoch: 8, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.760 Vali Acc: 0.483 Test Loss: 0.760 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1343567371368408
Epoch: 9, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.779 Vali Acc: 0.478 Test Loss: 0.779 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3021430969238281
Epoch: 10, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.788 Vali Acc: 0.450 Test Loss: 0.788 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4531340599060059
Epoch: 11, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.792 Vali Acc: 0.489 Test Loss: 0.792 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3495829105377197
Epoch: 12, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.817 Vali Acc: 0.472 Test Loss: 0.817 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1546745300292969
Epoch: 13, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.845 Vali Acc: 0.506 Test Loss: 0.845 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.510563611984253
Epoch: 14, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.851 Vali Acc: 0.489 Test Loss: 0.851 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5166666666666667
model parameter : 11538
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.291409969329834
Epoch: 1, Steps: 13 | Train Loss: 0.804 Vali Loss: 0.768 Vali Acc: 0.428 Test Loss: 0.768 Test Acc: 0.428
Validation loss decreased (inf --> -0.427770).  Saving model ...
Epoch: 2 cost time: 1.5636837482452393
Epoch: 2, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.755 Vali Acc: 0.450 Test Loss: 0.755 Test Acc: 0.450
Validation loss decreased (-0.427770 --> -0.449992).  Saving model ...
Epoch: 3 cost time: 1.3868427276611328
Epoch: 3, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.739 Vali Acc: 0.472 Test Loss: 0.739 Test Acc: 0.472
Validation loss decreased (-0.449992 --> -0.472215).  Saving model ...
Epoch: 4 cost time: 1.1645784378051758
Epoch: 4, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.734 Vali Acc: 0.456 Test Loss: 0.734 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3560175895690918
Epoch: 5, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.731 Vali Acc: 0.456 Test Loss: 0.731 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1871442794799805
Epoch: 6, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.735 Vali Acc: 0.489 Test Loss: 0.735 Test Acc: 0.489
Validation loss decreased (-0.472215 --> -0.488882).  Saving model ...
Epoch: 7 cost time: 1.2787139415740967
Epoch: 7, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.732 Vali Acc: 0.561 Test Loss: 0.732 Test Acc: 0.561
Validation loss decreased (-0.488882 --> -0.561104).  Saving model ...
Epoch: 8 cost time: 1.129798412322998
Epoch: 8, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.746 Vali Acc: 0.483 Test Loss: 0.746 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.463667869567871
Epoch: 9, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.751 Vali Acc: 0.489 Test Loss: 0.751 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2188167572021484
Epoch: 10, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.753 Vali Acc: 0.506 Test Loss: 0.753 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.714158296585083
Epoch: 11, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.771 Vali Acc: 0.483 Test Loss: 0.771 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0881521701812744
Epoch: 12, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.789 Vali Acc: 0.494 Test Loss: 0.789 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5276007652282715
Epoch: 13, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.786 Vali Acc: 0.483 Test Loss: 0.786 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4851171970367432
Epoch: 14, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.808 Vali Acc: 0.494 Test Loss: 0.808 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2808105945587158
Epoch: 15, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.822 Vali Acc: 0.489 Test Loss: 0.822 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4037041664123535
Epoch: 16, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2485435009002686
Epoch: 17, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 11106
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.7273595333099365
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.708 Vali Acc: 0.533 Test Loss: 0.708 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.433548927307129
Epoch: 2, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.700 Vali Acc: 0.539 Test Loss: 0.700 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.213493824005127
Epoch: 3, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.698 Vali Acc: 0.544 Test Loss: 0.698 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.6360106468200684
Epoch: 4, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.700 Vali Acc: 0.544 Test Loss: 0.700 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4535155296325684
Epoch: 5, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.697 Vali Acc: 0.539 Test Loss: 0.697 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2540936470031738
Epoch: 6, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.691 Vali Acc: 0.567 Test Loss: 0.691 Test Acc: 0.567
Validation loss decreased (-0.544437 --> -0.566660).  Saving model ...
Epoch: 7 cost time: 0.9856276512145996
Epoch: 7, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.693 Vali Acc: 0.544 Test Loss: 0.693 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2475690841674805
Epoch: 8, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.704 Vali Acc: 0.517 Test Loss: 0.704 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.336289882659912
Epoch: 9, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.706 Vali Acc: 0.533 Test Loss: 0.706 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2206313610076904
Epoch: 10, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.711 Vali Acc: 0.544 Test Loss: 0.711 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7432539463043213
Epoch: 11, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.716 Vali Acc: 0.511 Test Loss: 0.716 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3653557300567627
Epoch: 12, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.725 Vali Acc: 0.506 Test Loss: 0.725 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5477113723754883
Epoch: 13, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.743 Vali Acc: 0.533 Test Loss: 0.743 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3452239036560059
Epoch: 14, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.749 Vali Acc: 0.522 Test Loss: 0.749 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2092630863189697
Epoch: 15, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.754 Vali Acc: 0.556 Test Loss: 0.754 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2036843299865723
Epoch: 16, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.776 Vali Acc: 0.522 Test Loss: 0.776 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 11138
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.614755630493164
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.732 Vali Acc: 0.556 Test Loss: 0.732 Test Acc: 0.556
Validation loss decreased (inf --> -0.555548).  Saving model ...
Epoch: 2 cost time: 1.4887583255767822
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.731 Vali Acc: 0.533 Test Loss: 0.731 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4966206550598145
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.728 Vali Acc: 0.533 Test Loss: 0.728 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2997760772705078
Epoch: 4, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3019180297851562
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.731 Vali Acc: 0.517 Test Loss: 0.731 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0605034828186035
Epoch: 6, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.735 Vali Acc: 0.522 Test Loss: 0.735 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1587255001068115
Epoch: 7, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.741 Vali Acc: 0.511 Test Loss: 0.741 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6996409893035889
Epoch: 8, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.750 Vali Acc: 0.528 Test Loss: 0.750 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5356025695800781
Epoch: 9, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.770 Vali Acc: 0.533 Test Loss: 0.770 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.181358814239502
Epoch: 10, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.781 Vali Acc: 0.528 Test Loss: 0.781 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3783419132232666
Epoch: 11, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.801 Vali Acc: 0.494 Test Loss: 0.801 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df128_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 11826
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.162766933441162
Epoch: 1, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.715 Vali Acc: 0.539 Test Loss: 0.715 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.312608003616333
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.716 Vali Acc: 0.506 Test Loss: 0.716 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5358037948608398
Epoch: 3, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6849052906036377
Epoch: 4, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.767 Vali Acc: 0.483 Test Loss: 0.767 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6332192420959473
Epoch: 5, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.818 Vali Acc: 0.478 Test Loss: 0.818 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5535547733306885
Epoch: 6, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.908 Vali Acc: 0.478 Test Loss: 0.908 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4417810440063477
Epoch: 7, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.916 Vali Acc: 0.478 Test Loss: 0.916 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2735133171081543
Epoch: 8, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.003 Vali Acc: 0.450 Test Loss: 1.003 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4155876636505127
Epoch: 9, Steps: 13 | Train Loss: 0.415 Vali Loss: 1.136 Vali Acc: 0.444 Test Loss: 1.136 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7580411434173584
Epoch: 10, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.064 Vali Acc: 0.494 Test Loss: 1.064 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7347328662872314
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.136 Vali Acc: 0.506 Test Loss: 1.136 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 20802
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.610592603683472
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2254652976989746
Epoch: 2, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.707 Vali Acc: 0.528 Test Loss: 0.707 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.0819625854492188
Epoch: 3, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.715 Vali Acc: 0.528 Test Loss: 0.715 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1794712543487549
Epoch: 4, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.723 Vali Acc: 0.556 Test Loss: 0.723 Test Acc: 0.556
Validation loss decreased (-0.527771 --> -0.555548).  Saving model ...
Epoch: 5 cost time: 1.4376559257507324
Epoch: 5, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.737 Vali Acc: 0.528 Test Loss: 0.737 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4469072818756104
Epoch: 6, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.769 Vali Acc: 0.478 Test Loss: 0.769 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5145282745361328
Epoch: 7, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.787 Vali Acc: 0.511 Test Loss: 0.787 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2542064189910889
Epoch: 8, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.825 Vali Acc: 0.467 Test Loss: 0.825 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2191812992095947
Epoch: 9, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.883 Vali Acc: 0.494 Test Loss: 0.883 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2427635192871094
Epoch: 10, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.908 Vali Acc: 0.472 Test Loss: 0.908 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3659913539886475
Epoch: 11, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.937 Vali Acc: 0.472 Test Loss: 0.937 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3706624507904053
Epoch: 12, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.990 Vali Acc: 0.483 Test Loss: 0.990 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.356640100479126
Epoch: 13, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.016 Vali Acc: 0.494 Test Loss: 1.016 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4094743728637695
Epoch: 14, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.056 Vali Acc: 0.489 Test Loss: 1.056 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 12978
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps87_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.040377140045166
Epoch: 1, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.747 Vali Acc: 0.539 Test Loss: 0.747 Test Acc: 0.539
Validation loss decreased (inf --> -0.538881).  Saving model ...
Epoch: 2 cost time: 1.4934489727020264
Epoch: 2, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2719600200653076
Epoch: 3, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.741 Vali Acc: 0.539 Test Loss: 0.741 Test Acc: 0.539
Validation loss decreased (-0.538881 --> -0.538881).  Saving model ...
Epoch: 4 cost time: 1.3197052478790283
Epoch: 4, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.738 Vali Acc: 0.533 Test Loss: 0.738 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2669858932495117
Epoch: 5, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.741 Vali Acc: 0.506 Test Loss: 0.741 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1458489894866943
Epoch: 6, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.762 Vali Acc: 0.506 Test Loss: 0.762 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4422423839569092
Epoch: 7, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.760 Vali Acc: 0.489 Test Loss: 0.760 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.55149245262146
Epoch: 8, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.774 Vali Acc: 0.483 Test Loss: 0.774 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.333993911743164
Epoch: 9, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.815 Vali Acc: 0.489 Test Loss: 0.815 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2100322246551514
Epoch: 10, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2661263942718506
Epoch: 11, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.847 Vali Acc: 0.494 Test Loss: 0.847 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1965713500976562
Epoch: 12, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.606848955154419
Epoch: 13, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.918 Vali Acc: 0.494 Test Loss: 0.918 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps87_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 10530
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.057521820068359
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.754 Vali Acc: 0.483 Test Loss: 0.754 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.5642633438110352
Epoch: 2, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.749 Vali Acc: 0.478 Test Loss: 0.749 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2387564182281494
Epoch: 3, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.745 Vali Acc: 0.511 Test Loss: 0.745 Test Acc: 0.511
Validation loss decreased (-0.483326 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.1132402420043945
Epoch: 4, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.740 Vali Acc: 0.517 Test Loss: 0.740 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 5 cost time: 1.136533498764038
Epoch: 5, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2331817150115967
Epoch: 6, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3014380931854248
Epoch: 7, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.757 Vali Acc: 0.506 Test Loss: 0.757 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0580062866210938
Epoch: 8, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.764 Vali Acc: 0.533 Test Loss: 0.764 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533326).  Saving model ...
Epoch: 9 cost time: 1.1789722442626953
Epoch: 9, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.773 Vali Acc: 0.506 Test Loss: 0.773 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3592133522033691
Epoch: 10, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.783 Vali Acc: 0.528 Test Loss: 0.783 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3819317817687988
Epoch: 11, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.812 Vali Acc: 0.522 Test Loss: 0.812 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3602781295776367
Epoch: 12, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.822 Vali Acc: 0.544 Test Loss: 0.822 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544436).  Saving model ...
Epoch: 13 cost time: 1.2553718090057373
Epoch: 13, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.837 Vali Acc: 0.522 Test Loss: 0.837 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1335749626159668
Epoch: 14, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.859 Vali Acc: 0.522 Test Loss: 0.859 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9943768978118896
Epoch: 15, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.887 Vali Acc: 0.522 Test Loss: 0.887 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2146492004394531
Epoch: 16, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.911 Vali Acc: 0.517 Test Loss: 0.911 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.381176471710205
Epoch: 17, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.921 Vali Acc: 0.506 Test Loss: 0.921 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.259296178817749
Epoch: 18, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.943 Vali Acc: 0.489 Test Loss: 0.943 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3567872047424316
Epoch: 19, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5054333209991455
Epoch: 20, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.008 Vali Acc: 0.511 Test Loss: 1.008 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.514831781387329
Epoch: 21, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.045 Vali Acc: 0.511 Test Loss: 1.045 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3798449039459229
Epoch: 22, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.083 Vali Acc: 0.511 Test Loss: 1.083 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 9426
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps173_str87_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.0272216796875
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.806 Vali Acc: 0.506 Test Loss: 0.806 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.2547025680541992
Epoch: 2, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.742 Vali Acc: 0.528 Test Loss: 0.742 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 1.263455867767334
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.726 Vali Acc: 0.511 Test Loss: 0.726 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2017903327941895
Epoch: 4, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.740 Vali Acc: 0.494 Test Loss: 0.740 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2118284702301025
Epoch: 5, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.739 Vali Acc: 0.483 Test Loss: 0.739 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.031371593475342
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.734 Vali Acc: 0.483 Test Loss: 0.734 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4036364555358887
Epoch: 7, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.745 Vali Acc: 0.522 Test Loss: 0.745 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.322746753692627
Epoch: 8, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.766 Vali Acc: 0.489 Test Loss: 0.766 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3239481449127197
Epoch: 9, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.769 Vali Acc: 0.528 Test Loss: 0.769 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1572771072387695
Epoch: 10, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.777 Vali Acc: 0.522 Test Loss: 0.777 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.065370798110962
Epoch: 11, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.807 Vali Acc: 0.511 Test Loss: 0.807 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2049298286437988
Epoch: 12, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.827 Vali Acc: 0.494 Test Loss: 0.827 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps173_str87_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 8994
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.544210433959961
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.706 Vali Acc: 0.506 Test Loss: 0.706 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.2173290252685547
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.698 Vali Acc: 0.522 Test Loss: 0.698 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.3245220184326172
Epoch: 3, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.697 Vali Acc: 0.539 Test Loss: 0.697 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.2143170833587646
Epoch: 4, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.698 Vali Acc: 0.517 Test Loss: 0.698 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2131352424621582
Epoch: 5, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.693 Vali Acc: 0.528 Test Loss: 0.693 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2927064895629883
Epoch: 6, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.691 Vali Acc: 0.533 Test Loss: 0.691 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2375767230987549
Epoch: 7, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.696 Vali Acc: 0.556 Test Loss: 0.696 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555549).  Saving model ...
Epoch: 8 cost time: 1.1022241115570068
Epoch: 8, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.704 Vali Acc: 0.544 Test Loss: 0.704 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3673555850982666
Epoch: 9, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.721 Vali Acc: 0.539 Test Loss: 0.721 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1732563972473145
Epoch: 10, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.723 Vali Acc: 0.544 Test Loss: 0.723 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9860846996307373
Epoch: 11, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.730 Vali Acc: 0.517 Test Loss: 0.730 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.327725887298584
Epoch: 12, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.739 Vali Acc: 0.522 Test Loss: 0.739 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5630555152893066
Epoch: 13, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.764 Vali Acc: 0.533 Test Loss: 0.764 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1965351104736328
Epoch: 14, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.768 Vali Acc: 0.539 Test Loss: 0.768 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1714603900909424
Epoch: 15, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.789 Vali Acc: 0.533 Test Loss: 0.789 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.127171516418457
Epoch: 16, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.806 Vali Acc: 0.506 Test Loss: 0.806 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.352428913116455
Epoch: 17, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.814 Vali Acc: 0.511 Test Loss: 0.814 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 9026
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps288_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.131706237792969
Epoch: 1, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.759 Vali Acc: 0.533 Test Loss: 0.759 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.0438060760498047
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.744 Vali Acc: 0.517 Test Loss: 0.744 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2454733848571777
Epoch: 3, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.729 Vali Acc: 0.567 Test Loss: 0.729 Test Acc: 0.567
Validation loss decreased (-0.533326 --> -0.566659).  Saving model ...
Epoch: 4 cost time: 1.308164119720459
Epoch: 4, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.724 Vali Acc: 0.556 Test Loss: 0.724 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6019327640533447
Epoch: 5, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.501115322113037
Epoch: 6, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5577688217163086
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.725 Vali Acc: 0.539 Test Loss: 0.725 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5547404289245605
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2815759181976318
Epoch: 9, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.721 Vali Acc: 0.528 Test Loss: 0.721 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2477881908416748
Epoch: 10, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.732 Vali Acc: 0.511 Test Loss: 0.732 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4984157085418701
Epoch: 11, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.741 Vali Acc: 0.533 Test Loss: 0.741 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.476855993270874
Epoch: 12, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.749 Vali Acc: 0.539 Test Loss: 0.749 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.455162763595581
Epoch: 13, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.768 Vali Acc: 0.511 Test Loss: 0.768 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_PatchTST_UEA_ftM_sl1152_ll0_pl0_el1_dm16_nh4_df64_ps288_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 9714
model size : 0.35MB
